Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 26.059704303741455
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.285 Vali Acc: 0.408 Test Loss: 1.285 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 23.66809058189392
Epoch: 2, Steps: 10 | Train Loss: 1.075 Vali Loss: 0.938 Vali Acc: 0.711 Test Loss: 0.938 Test Acc: 0.711
Validation loss decreased (-0.407882 --> -0.710517).  Saving model ...
Epoch: 3 cost time: 24.246716022491455
Epoch: 3, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.710517 --> -0.802625).  Saving model ...
Epoch: 4 cost time: 23.87848448753357
Epoch: 4, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.419 Vali Acc: 0.836 Test Loss: 0.419 Test Acc: 0.836
Validation loss decreased (-0.802625 --> -0.835522).  Saving model ...
Epoch: 5 cost time: 23.441813468933105
Epoch: 5, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.386 Vali Acc: 0.868 Test Loss: 0.386 Test Acc: 0.868
Validation loss decreased (-0.835522 --> -0.868417).  Saving model ...
Epoch: 6 cost time: 24.28775429725647
Epoch: 6, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.29490327835083
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.506 Vali Acc: 0.855 Test Loss: 0.506 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.69859790802002
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.539 Vali Acc: 0.836 Test Loss: 0.539 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.90265703201294
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.849 Test Loss: 0.594 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.504138946533203
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.849 Test Loss: 0.579 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 24.22295641899109
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.836 Test Loss: 0.581 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.32143235206604
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.625 Vali Acc: 0.849 Test Loss: 0.625 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 25.11731743812561
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.682 Vali Acc: 0.849 Test Loss: 0.682 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 25.745331525802612
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.836 Test Loss: 0.742 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 25.083041429519653
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.836 Test Loss: 0.778 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 75000836
model size : 288.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 10.62674069404602
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.333 Vali Acc: 0.368 Test Loss: 1.333 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 9.02337121963501
Epoch: 2, Steps: 10 | Train Loss: 1.120 Vali Loss: 0.965 Vali Acc: 0.737 Test Loss: 0.965 Test Acc: 0.737
Validation loss decreased (-0.368408 --> -0.736832).  Saving model ...
Epoch: 3 cost time: 8.969929218292236
Epoch: 3, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
Validation loss decreased (-0.736832 --> -0.782889).  Saving model ...
Epoch: 4 cost time: 8.232348203659058
Epoch: 4, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
Validation loss decreased (-0.782889 --> -0.855259).  Saving model ...
Epoch: 5 cost time: 8.721789598464966
Epoch: 5, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.349 Vali Acc: 0.849 Test Loss: 0.349 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.475204467773438
Epoch: 6, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.277549982070923
Epoch: 7, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.365 Vali Acc: 0.849 Test Loss: 0.365 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.201820135116577
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.365 Vali Acc: 0.868 Test Loss: 0.365 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 9 cost time: 8.577706575393677
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.493206262588501
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.059111595153809
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.269047260284424
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.361 Vali Acc: 0.849 Test Loss: 0.361 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.278544902801514
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.080546617507935
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 8.607341766357422
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.483 Vali Acc: 0.849 Test Loss: 0.483 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.701952457427979
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.836 Test Loss: 0.488 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.146084785461426
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.842 Test Loss: 0.494 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.82411789894104
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.842 Test Loss: 0.503 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.652005672454834
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.849 Test Loss: 0.515 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.721449851989746
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.849 Test Loss: 0.518 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.583369016647339
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.849 Test Loss: 0.532 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.81398868560791
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.849 Test Loss: 0.535 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.316181421279907
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.849 Test Loss: 0.538 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.25508189201355
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.842 Test Loss: 0.542 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 22044676
model size : 86.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 19.749408960342407
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.302 Vali Acc: 0.414 Test Loss: 1.302 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 18.38753914833069
Epoch: 2, Steps: 10 | Train Loss: 1.134 Vali Loss: 0.991 Vali Acc: 0.684 Test Loss: 0.991 Test Acc: 0.684
Validation loss decreased (-0.414461 --> -0.684201).  Saving model ...
Epoch: 3 cost time: 18.34027910232544
Epoch: 3, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
Validation loss decreased (-0.684201 --> -0.809204).  Saving model ...
Epoch: 4 cost time: 16.80223035812378
Epoch: 4, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809206).  Saving model ...
Epoch: 5 cost time: 18.507606983184814
Epoch: 5, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
Validation loss decreased (-0.809206 --> -0.855259).  Saving model ...
Epoch: 6 cost time: 18.406806707382202
Epoch: 6, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.29457402229309
Epoch: 7, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.216429471969604
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.88320016860962
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.637 Vali Acc: 0.842 Test Loss: 0.637 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 16.706310987472534
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.595 Vali Acc: 0.836 Test Loss: 0.595 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 16.449885368347168
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.613 Vali Acc: 0.829 Test Loss: 0.613 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.392670154571533
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.849 Test Loss: 0.625 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 17.138686180114746
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.605 Vali Acc: 0.836 Test Loss: 0.605 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.98323154449463
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.640 Vali Acc: 0.842 Test Loss: 0.640 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 17.830477476119995
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.862 Test Loss: 0.666 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861835).  Saving model ...
Epoch: 16 cost time: 17.809454202651978
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.686 Vali Acc: 0.855 Test Loss: 0.686 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.928105354309082
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.842 Test Loss: 0.702 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 17.959011793136597
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.849 Test Loss: 0.716 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 18.268213272094727
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.842 Test Loss: 0.721 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 17.558655261993408
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.829 Test Loss: 0.747 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 15.579127788543701
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.816 Test Loss: 0.766 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 18.62251305580139
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.816 Test Loss: 0.773 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 18.70890760421753
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.816 Test Loss: 0.779 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 18.400820016860962
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.821 Vali Acc: 0.816 Test Loss: 0.821 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 18.98444104194641
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 75000836
model size : 288.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 8.876344203948975
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.342 Vali Acc: 0.355 Test Loss: 1.342 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 6.89701771736145
Epoch: 2, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.010 Vali Acc: 0.737 Test Loss: 1.010 Test Acc: 0.737
Validation loss decreased (-0.355250 --> -0.736832).  Saving model ...
Epoch: 3 cost time: 6.375523805618286
Epoch: 3, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.684 Vali Acc: 0.816 Test Loss: 0.684 Test Acc: 0.816
Validation loss decreased (-0.736832 --> -0.815783).  Saving model ...
Epoch: 4 cost time: 6.507646322250366
Epoch: 4, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.474 Vali Acc: 0.842 Test Loss: 0.474 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842101).  Saving model ...
Epoch: 5 cost time: 6.5488903522491455
Epoch: 5, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 6 cost time: 6.324264287948608
Epoch: 6, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.019847869873047
Epoch: 7, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
Validation loss decreased (-0.842101 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 5.331348896026611
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.464 Vali Acc: 0.829 Test Loss: 0.464 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.905048847198486
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.466 Vali Acc: 0.849 Test Loss: 0.466 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.984268426895142
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.564 Vali Acc: 0.836 Test Loss: 0.564 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.795719146728516
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.528 Vali Acc: 0.842 Test Loss: 0.528 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.187683343887329
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.071072578430176
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.868 Test Loss: 0.493 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.354626178741455
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.484 Vali Acc: 0.842 Test Loss: 0.484 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.364640951156616
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.515 Vali Acc: 0.849 Test Loss: 0.515 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.360755443572998
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.298513412475586
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.842 Test Loss: 0.537 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 22044676
model size : 86.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 13.265326976776123
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.339 Vali Acc: 0.342 Test Loss: 1.339 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 11.632993459701538
Epoch: 2, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.070 Vali Acc: 0.618 Test Loss: 1.070 Test Acc: 0.618
Validation loss decreased (-0.342092 --> -0.618410).  Saving model ...
Epoch: 3 cost time: 12.331777811050415
Epoch: 3, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.777 Vali Acc: 0.770 Test Loss: 0.777 Test Acc: 0.770
Validation loss decreased (-0.618410 --> -0.769729).  Saving model ...
Epoch: 4 cost time: 12.433968782424927
Epoch: 4, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.769729 --> -0.802626).  Saving model ...
Epoch: 5 cost time: 11.701094150543213
Epoch: 5, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.408 Vali Acc: 0.836 Test Loss: 0.408 Test Acc: 0.836
Validation loss decreased (-0.802626 --> -0.835522).  Saving model ...
Epoch: 6 cost time: 11.976112127304077
Epoch: 6, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.354 Vali Acc: 0.849 Test Loss: 0.354 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848681).  Saving model ...
Epoch: 7 cost time: 11.533299446105957
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.336 Vali Acc: 0.868 Test Loss: 0.336 Test Acc: 0.868
Validation loss decreased (-0.848681 --> -0.868418).  Saving model ...
Epoch: 8 cost time: 11.681986331939697
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.332 Vali Acc: 0.862 Test Loss: 0.332 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.28947639465332
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.768950462341309
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.356 Vali Acc: 0.849 Test Loss: 0.356 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.348474264144897
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.965502977371216
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.131170511245728
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.635 Vali Acc: 0.796 Test Loss: 0.635 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.11608099937439
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.435759544372559
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.858 Vali Acc: 0.776 Test Loss: 0.858 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.324623584747314
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.889 Vali Acc: 0.783 Test Loss: 0.889 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.22739863395691
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.919 Vali Acc: 0.770 Test Loss: 0.919 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 75000836
model size : 288.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.731270790100098
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.363 Vali Acc: 0.322 Test Loss: 1.363 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 4.54900860786438
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.096 Vali Acc: 0.717 Test Loss: 1.096 Test Acc: 0.717
Validation loss decreased (-0.322355 --> -0.717094).  Saving model ...
Epoch: 3 cost time: 5.473214864730835
Epoch: 3, Steps: 10 | Train Loss: 0.876 Vali Loss: 0.803 Vali Acc: 0.809 Test Loss: 0.803 Test Acc: 0.809
Validation loss decreased (-0.717094 --> -0.809202).  Saving model ...
Epoch: 4 cost time: 5.149665594100952
Epoch: 4, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
Validation loss decreased (-0.809202 --> -0.815784).  Saving model ...
Epoch: 5 cost time: 5.191634654998779
Epoch: 5, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.434 Vali Acc: 0.842 Test Loss: 0.434 Test Acc: 0.842
Validation loss decreased (-0.815784 --> -0.842101).  Saving model ...
Epoch: 6 cost time: 5.278450965881348
Epoch: 6, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.376 Vali Acc: 0.849 Test Loss: 0.376 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 7 cost time: 5.4000654220581055
Epoch: 7, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.344 Vali Acc: 0.842 Test Loss: 0.344 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.485816955566406
Epoch: 8, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.338 Vali Acc: 0.849 Test Loss: 0.338 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848681).  Saving model ...
Epoch: 9 cost time: 5.238895654678345
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.331 Vali Acc: 0.849 Test Loss: 0.331 Test Acc: 0.849
Validation loss decreased (-0.848681 --> -0.848681).  Saving model ...
Epoch: 10 cost time: 5.05694842338562
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
Validation loss decreased (-0.848681 --> -0.874997).  Saving model ...
Epoch: 11 cost time: 5.41052508354187
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.353 Vali Acc: 0.849 Test Loss: 0.353 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.115108013153076
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.355 Vali Acc: 0.868 Test Loss: 0.355 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.882411479949951
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.899874210357666
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.921142578125
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.407 Vali Acc: 0.849 Test Loss: 0.407 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.56161904335022
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.937880754470825
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.278854846954346
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.46251916885376
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.40302300453186
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.449 Vali Acc: 0.868 Test Loss: 0.449 Test Acc: 0.868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 22044676
model size : 86.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 15.497480630874634
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.317 Vali Acc: 0.395 Test Loss: 1.317 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 13.870352506637573
Epoch: 2, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.065 Vali Acc: 0.612 Test Loss: 1.065 Test Acc: 0.612
Validation loss decreased (-0.394724 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 12.924267053604126
Epoch: 3, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
Validation loss decreased (-0.611831 --> -0.796045).  Saving model ...
Epoch: 4 cost time: 13.625991344451904
Epoch: 4, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.478 Vali Acc: 0.849 Test Loss: 0.478 Test Acc: 0.849
Validation loss decreased (-0.796045 --> -0.848679).  Saving model ...
Epoch: 5 cost time: 11.832651138305664
Epoch: 5, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855259).  Saving model ...
Epoch: 6 cost time: 13.245802879333496
Epoch: 6, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.374 Vali Acc: 0.849 Test Loss: 0.374 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.08858060836792
Epoch: 7, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.384 Vali Acc: 0.842 Test Loss: 0.384 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.397206544876099
Epoch: 8, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 9 cost time: 13.295501470565796
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.880987405776978
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.411 Vali Acc: 0.849 Test Loss: 0.411 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.803186416625977
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.393075942993164
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.959362745285034
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.849 Test Loss: 0.454 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.696178197860718
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.849 Test Loss: 0.471 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.278947591781616
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.849 Test Loss: 0.494 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.921920537948608
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.849 Test Loss: 0.519 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.661210775375366
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.849 Test Loss: 0.534 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.181074619293213
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.849 Test Loss: 0.545 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 37511172
model size : 145.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.142072916030884
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.328 Vali Acc: 0.296 Test Loss: 1.328 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 5.179657936096191
Epoch: 2, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.065 Vali Acc: 0.691 Test Loss: 1.065 Test Acc: 0.691
Validation loss decreased (-0.296039 --> -0.690779).  Saving model ...
Epoch: 3 cost time: 5.006920576095581
Epoch: 3, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.780 Vali Acc: 0.776 Test Loss: 0.780 Test Acc: 0.776
Validation loss decreased (-0.690779 --> -0.776308).  Saving model ...
Epoch: 4 cost time: 5.309741735458374
Epoch: 4, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.542 Vali Acc: 0.836 Test Loss: 0.542 Test Acc: 0.836
Validation loss decreased (-0.776308 --> -0.835521).  Saving model ...
Epoch: 5 cost time: 5.389446258544922
Epoch: 5, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
Validation loss decreased (-0.835521 --> -0.855259).  Saving model ...
Epoch: 6 cost time: 5.502634048461914
Epoch: 6, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.333 Vali Acc: 0.855 Test Loss: 0.333 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855260).  Saving model ...
Epoch: 7 cost time: 5.552539110183716
Epoch: 7, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.691138744354248
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.350 Vali Acc: 0.862 Test Loss: 0.350 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861839).  Saving model ...
Epoch: 9 cost time: 5.348063707351685
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.421 Vali Acc: 0.849 Test Loss: 0.421 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.293761730194092
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.861839 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 5.672995328903198
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.849 Test Loss: 0.409 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.675488233566284
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.513139486312866
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.849 Test Loss: 0.458 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.723543167114258
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.428 Vali Acc: 0.868 Test Loss: 0.428 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.7990264892578125
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.430 Vali Acc: 0.868 Test Loss: 0.430 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.937162399291992
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.508 Vali Acc: 0.849 Test Loss: 0.508 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.721208810806274
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.882 Test Loss: 0.465 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881574).  Saving model ...
Epoch: 18 cost time: 5.436204195022583
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.849 Test Loss: 0.501 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.601241827011108
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.849 Test Loss: 0.510 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.474867820739746
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.855 Test Loss: 0.526 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.0055201053619385
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.842 Test Loss: 0.557 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.200217962265015
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.849 Test Loss: 0.568 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.366238117218018
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.842 Test Loss: 0.594 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.944292068481445
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.842 Test Loss: 0.616 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.165085077285767
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.836 Test Loss: 0.619 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.151184797286987
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.829 Test Loss: 0.624 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.486023187637329
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.862 Test Loss: 0.660 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 11032580
model size : 44.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 12.230806827545166
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.332 Vali Acc: 0.375 Test Loss: 1.332 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 10.094262838363647
Epoch: 2, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.107 Vali Acc: 0.605 Test Loss: 1.107 Test Acc: 0.605
Validation loss decreased (-0.374987 --> -0.605252).  Saving model ...
Epoch: 3 cost time: 9.268691778182983
Epoch: 3, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.805 Vali Acc: 0.757 Test Loss: 0.805 Test Acc: 0.757
Validation loss decreased (-0.605252 --> -0.756571).  Saving model ...
Epoch: 4 cost time: 9.55871057510376
Epoch: 4, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.530 Vali Acc: 0.849 Test Loss: 0.530 Test Acc: 0.849
Validation loss decreased (-0.756571 --> -0.848679).  Saving model ...
Epoch: 5 cost time: 9.117584943771362
Epoch: 5, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.417 Vali Acc: 0.849 Test Loss: 0.417 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 6 cost time: 8.846781492233276
Epoch: 6, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.389 Vali Acc: 0.842 Test Loss: 0.389 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.884763240814209
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.414 Vali Acc: 0.836 Test Loss: 0.414 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.59230923652649
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 9 cost time: 9.80045461654663
Epoch: 9, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.449 Vali Acc: 0.842 Test Loss: 0.449 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.74548053741455
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.508 Vali Acc: 0.842 Test Loss: 0.508 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.599908828735352
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.506 Vali Acc: 0.836 Test Loss: 0.506 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.945743322372437
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.462 Vali Acc: 0.849 Test Loss: 0.462 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.548839092254639
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.849 Test Loss: 0.454 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.870653867721558
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.493 Vali Acc: 0.849 Test Loss: 0.493 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.285236597061157
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.842 Test Loss: 0.522 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.718855619430542
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.849 Test Loss: 0.551 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.556174993515015
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.425344228744507
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.855 Test Loss: 0.582 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 37511172
model size : 145.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.930197715759277
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.338 Vali Acc: 0.296 Test Loss: 1.338 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 3.9977385997772217
Epoch: 2, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.096 Vali Acc: 0.658 Test Loss: 1.096 Test Acc: 0.658
Validation loss decreased (-0.296039 --> -0.657884).  Saving model ...
Epoch: 3 cost time: 3.867906093597412
Epoch: 3, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.834 Vali Acc: 0.776 Test Loss: 0.834 Test Acc: 0.776
Validation loss decreased (-0.657884 --> -0.776307).  Saving model ...
Epoch: 4 cost time: 3.2380926609039307
Epoch: 4, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.609 Vali Acc: 0.816 Test Loss: 0.609 Test Acc: 0.816
Validation loss decreased (-0.776307 --> -0.815783).  Saving model ...
Epoch: 5 cost time: 3.1676971912384033
Epoch: 5, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.464 Vali Acc: 0.842 Test Loss: 0.464 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842101).  Saving model ...
Epoch: 6 cost time: 3.908358335494995
Epoch: 6, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.403 Vali Acc: 0.849 Test Loss: 0.403 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 7 cost time: 3.2997426986694336
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 8 cost time: 3.5247859954833984
Epoch: 8, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.406 Vali Acc: 0.842 Test Loss: 0.406 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.320233345031738
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 10 cost time: 4.368885517120361
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.445 Vali Acc: 0.849 Test Loss: 0.445 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.189067840576172
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.449 Vali Acc: 0.849 Test Loss: 0.449 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.265395402908325
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.2755513191223145
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.639 Vali Acc: 0.862 Test Loss: 0.639 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861836).  Saving model ...
Epoch: 14 cost time: 4.0058276653289795
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.531 Vali Acc: 0.882 Test Loss: 0.531 Test Acc: 0.882
Validation loss decreased (-0.861836 --> -0.881574).  Saving model ...
Epoch: 15 cost time: 4.464641571044922
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.959365129470825
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.869246244430542
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.458 Vali Acc: 0.842 Test Loss: 0.458 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.2341437339782715
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.890108585357666
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.849 Test Loss: 0.576 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.211252689361572
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.855 Test Loss: 0.520 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6655805110931396
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7497079372406006
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.868 Test Loss: 0.513 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8320295810699463
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5581159591674805
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 11032580
model size : 44.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.828248023986816
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.348 Vali Acc: 0.362 Test Loss: 1.348 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 5.887031316757202
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.154 Vali Acc: 0.599 Test Loss: 1.154 Test Acc: 0.599
Validation loss decreased (-0.361829 --> -0.598673).  Saving model ...
Epoch: 3 cost time: 6.144970655441284
Epoch: 3, Steps: 10 | Train Loss: 0.962 Vali Loss: 0.903 Vali Acc: 0.737 Test Loss: 0.903 Test Acc: 0.737
Validation loss decreased (-0.598673 --> -0.736833).  Saving model ...
Epoch: 4 cost time: 6.076303482055664
Epoch: 4, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.736833 --> -0.809204).  Saving model ...
Epoch: 5 cost time: 6.120612144470215
Epoch: 5, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.467 Vali Acc: 0.849 Test Loss: 0.467 Test Acc: 0.849
Validation loss decreased (-0.809204 --> -0.848680).  Saving model ...
Epoch: 6 cost time: 5.953626871109009
Epoch: 6, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.368 Vali Acc: 0.836 Test Loss: 0.368 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.07292366027832
Epoch: 7, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.342 Vali Acc: 0.855 Test Loss: 0.342 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855260).  Saving model ...
Epoch: 8 cost time: 5.7618982791900635
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.340 Vali Acc: 0.855 Test Loss: 0.340 Test Acc: 0.855
Validation loss decreased (-0.855260 --> -0.855260).  Saving model ...
Epoch: 9 cost time: 5.391067028045654
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.346 Vali Acc: 0.842 Test Loss: 0.346 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.344905138015747
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
Validation loss decreased (-0.855260 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 5.537213087081909
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.356 Vali Acc: 0.855 Test Loss: 0.356 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.14297342300415
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.043877601623535
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.232287168502808
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.849 Test Loss: 0.407 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.005354166030884
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.413 Vali Acc: 0.855 Test Loss: 0.413 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.927263498306274
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.1043970584869385
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.916011333465576
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.374038457870483
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.447 Vali Acc: 0.849 Test Loss: 0.447 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.522648334503174
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.440 Vali Acc: 0.849 Test Loss: 0.440 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 37511172
model size : 145.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.493122816085815
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.356 Vali Acc: 0.303 Test Loss: 1.356 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 2.363581418991089
Epoch: 2, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.148 Vali Acc: 0.612 Test Loss: 1.148 Test Acc: 0.612
Validation loss decreased (-0.302618 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 2.3222603797912598
Epoch: 3, Steps: 10 | Train Loss: 0.971 Vali Loss: 0.914 Vali Acc: 0.724 Test Loss: 0.914 Test Acc: 0.724
Validation loss decreased (-0.611831 --> -0.723675).  Saving model ...
Epoch: 4 cost time: 2.8377201557159424
Epoch: 4, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.698 Vali Acc: 0.776 Test Loss: 0.698 Test Acc: 0.776
Validation loss decreased (-0.723675 --> -0.776309).  Saving model ...
Epoch: 5 cost time: 2.723057985305786
Epoch: 5, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.535 Vali Acc: 0.829 Test Loss: 0.535 Test Acc: 0.829
Validation loss decreased (-0.776309 --> -0.828942).  Saving model ...
Epoch: 6 cost time: 2.805356502532959
Epoch: 6, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.425 Vali Acc: 0.822 Test Loss: 0.425 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7762389183044434
Epoch: 7, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.382 Vali Acc: 0.868 Test Loss: 0.382 Test Acc: 0.868
Validation loss decreased (-0.828942 --> -0.868417).  Saving model ...
Epoch: 8 cost time: 2.66278338432312
Epoch: 8, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.369 Vali Acc: 0.849 Test Loss: 0.369 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8865480422973633
Epoch: 9, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.906925916671753
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8934967517852783
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.769692897796631
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.641214609146118
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.385 Vali Acc: 0.842 Test Loss: 0.385 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8665363788604736
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.106107711791992
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.081597089767456
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.402 Vali Acc: 0.868 Test Loss: 0.402 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6275272369384766
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 11032580
model size : 44.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 16.26682710647583
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.348 Vali Acc: 0.289 Test Loss: 1.348 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 15.293869256973267
Epoch: 2, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.109 Vali Acc: 0.605 Test Loss: 1.109 Test Acc: 0.605
Validation loss decreased (-0.289460 --> -0.605252).  Saving model ...
Epoch: 3 cost time: 14.878366231918335
Epoch: 3, Steps: 10 | Train Loss: 0.880 Vali Loss: 0.832 Vali Acc: 0.776 Test Loss: 0.832 Test Acc: 0.776
Validation loss decreased (-0.605252 --> -0.776307).  Saving model ...
Epoch: 4 cost time: 14.836633920669556
Epoch: 4, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
Validation loss decreased (-0.776307 --> -0.809205).  Saving model ...
Epoch: 5 cost time: 13.605315685272217
Epoch: 5, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.445 Vali Acc: 0.809 Test Loss: 0.445 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 6 cost time: 12.742641925811768
Epoch: 6, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.393 Vali Acc: 0.822 Test Loss: 0.393 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 14.920259237289429
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.405 Vali Acc: 0.822 Test Loss: 0.405 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.462066888809204
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.431 Vali Acc: 0.809 Test Loss: 0.431 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.422813892364502
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.441224813461304
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.524 Vali Acc: 0.849 Test Loss: 0.524 Test Acc: 0.849
Validation loss decreased (-0.822364 --> -0.848679).  Saving model ...
Epoch: 11 cost time: 14.63206434249878
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.590 Vali Acc: 0.829 Test Loss: 0.590 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.830626726150513
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.829 Test Loss: 0.602 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.894918203353882
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.836 Test Loss: 0.538 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.929044485092163
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855257).  Saving model ...
Epoch: 15 cost time: 14.788183689117432
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.849 Test Loss: 0.595 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.48997187614441
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.677 Vali Acc: 0.836 Test Loss: 0.677 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.233970403671265
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.849 Test Loss: 0.703 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.798526525497437
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.836 Test Loss: 0.718 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.374119758605957
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.816 Test Loss: 0.758 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.305917978286743
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.842 Test Loss: 0.739 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 13.529289484024048
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.842 Test Loss: 0.747 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 13.1607506275177
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.829 Test Loss: 0.764 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 13.074863195419312
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.794809818267822
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.822 Test Loss: 0.775 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 37503492
model size : 144.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.220255136489868
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.365 Vali Acc: 0.316 Test Loss: 1.365 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 5.012739419937134
Epoch: 2, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.158 Vali Acc: 0.507 Test Loss: 1.158 Test Acc: 0.507
Validation loss decreased (-0.315776 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 5.635807275772095
Epoch: 3, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.921 Vali Acc: 0.697 Test Loss: 0.921 Test Acc: 0.697
Validation loss decreased (-0.506567 --> -0.697359).  Saving model ...
Epoch: 4 cost time: 5.728739261627197
Epoch: 4, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.711 Vali Acc: 0.743 Test Loss: 0.711 Test Acc: 0.743
Validation loss decreased (-0.697359 --> -0.743414).  Saving model ...
Epoch: 5 cost time: 5.460259437561035
Epoch: 5, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 5.161066293716431
Epoch: 6, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.455 Vali Acc: 0.796 Test Loss: 0.455 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796048).  Saving model ...
Epoch: 7 cost time: 5.0876994132995605
Epoch: 7, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.422 Vali Acc: 0.816 Test Loss: 0.422 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815785).  Saving model ...
Epoch: 8 cost time: 4.346463680267334
Epoch: 8, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.422 Vali Acc: 0.822 Test Loss: 0.422 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 9 cost time: 5.411959886550903
Epoch: 9, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.533030033111572
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.422515630722046
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.984878778457642
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.512 Vali Acc: 0.842 Test Loss: 0.512 Test Acc: 0.842
Validation loss decreased (-0.822364 --> -0.842100).  Saving model ...
Epoch: 13 cost time: 5.97576904296875
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.1062257289886475
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.836 Test Loss: 0.579 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.514986515045166
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.589 Vali Acc: 0.842 Test Loss: 0.589 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.2341978549957275
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.595 Vali Acc: 0.842 Test Loss: 0.595 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.022604703903198
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.620 Vali Acc: 0.829 Test Loss: 0.620 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.026749134063721
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.663 Vali Acc: 0.829 Test Loss: 0.663 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.028671741485596
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.002116680145264
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.822 Test Loss: 0.718 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.2937912940979
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.822 Test Loss: 0.709 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.703148365020752
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.822 Test Loss: 0.725 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 11024388
model size : 43.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 12.401096820831299
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.364 Vali Acc: 0.276 Test Loss: 1.364 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 10.858380794525146
Epoch: 2, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.158 Vali Acc: 0.539 Test Loss: 1.158 Test Acc: 0.539
Validation loss decreased (-0.276302 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 11.36632490158081
Epoch: 3, Steps: 10 | Train Loss: 0.963 Vali Loss: 0.913 Vali Acc: 0.737 Test Loss: 0.913 Test Acc: 0.737
Validation loss decreased (-0.539462 --> -0.736833).  Saving model ...
Epoch: 4 cost time: 9.68657112121582
Epoch: 4, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
Validation loss decreased (-0.736833 --> -0.815783).  Saving model ...
Epoch: 5 cost time: 11.597293615341187
Epoch: 5, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822364).  Saving model ...
Epoch: 6 cost time: 12.06094479560852
Epoch: 6, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 7 cost time: 11.418469190597534
Epoch: 7, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.423 Vali Acc: 0.816 Test Loss: 0.423 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.034949541091919
Epoch: 8, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.35297155380249
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.485 Vali Acc: 0.842 Test Loss: 0.485 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842100).  Saving model ...
Epoch: 10 cost time: 10.021226644515991
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.517 Vali Acc: 0.822 Test Loss: 0.517 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.73787808418274
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.54116153717041
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.579 Vali Acc: 0.836 Test Loss: 0.579 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.636043787002563
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.77651834487915
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.998519897460938
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.332730293273926
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.425 Vali Acc: 0.829 Test Loss: 0.425 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.349812984466553
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.613313913345337
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.525 Vali Acc: 0.829 Test Loss: 0.525 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.12929916381836
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.563 Vali Acc: 0.829 Test Loss: 0.563 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 37503492
model size : 144.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.573554277420044
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.374 Vali Acc: 0.303 Test Loss: 1.374 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 4.978518724441528
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.187 Vali Acc: 0.474 Test Loss: 1.187 Test Acc: 0.474
Validation loss decreased (-0.302618 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 4.477111101150513
Epoch: 3, Steps: 10 | Train Loss: 0.992 Vali Loss: 0.978 Vali Acc: 0.658 Test Loss: 0.978 Test Acc: 0.658
Validation loss decreased (-0.473672 --> -0.657885).  Saving model ...
Epoch: 4 cost time: 4.312440872192383
Epoch: 4, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
Validation loss decreased (-0.657885 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 4.446333408355713
Epoch: 5, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.749992 --> -0.802626).  Saving model ...
Epoch: 6 cost time: 4.709097623825073
Epoch: 6, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.472 Vali Acc: 0.842 Test Loss: 0.472 Test Acc: 0.842
Validation loss decreased (-0.802626 --> -0.842101).  Saving model ...
Epoch: 7 cost time: 4.510970115661621
Epoch: 7, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.421 Vali Acc: 0.868 Test Loss: 0.421 Test Acc: 0.868
Validation loss decreased (-0.842101 --> -0.868417).  Saving model ...
Epoch: 8 cost time: 4.56477165222168
Epoch: 8, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.392 Vali Acc: 0.868 Test Loss: 0.392 Test Acc: 0.868
Validation loss decreased (-0.868417 --> -0.868417).  Saving model ...
Epoch: 9 cost time: 4.671337127685547
Epoch: 9, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.438 Vali Acc: 0.868 Test Loss: 0.438 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.481081247329712
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.432 Vali Acc: 0.842 Test Loss: 0.432 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.726972818374634
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.457 Vali Acc: 0.849 Test Loss: 0.457 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.305271625518799
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.462 Vali Acc: 0.849 Test Loss: 0.462 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.802915334701538
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.6114349365234375
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.501919507980347
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.474 Vali Acc: 0.842 Test Loss: 0.474 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.000784397125244
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.487 Vali Acc: 0.849 Test Loss: 0.487 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.967963933944702
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.492 Vali Acc: 0.842 Test Loss: 0.492 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.109433174133301
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.519 Vali Acc: 0.836 Test Loss: 0.519 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 11024388
model size : 43.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 10.459529161453247
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.379 Vali Acc: 0.276 Test Loss: 1.379 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 8.112333059310913
Epoch: 2, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.219 Vali Acc: 0.507 Test Loss: 1.219 Test Acc: 0.507
Validation loss decreased (-0.276302 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 7.894834518432617
Epoch: 3, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.021 Vali Acc: 0.724 Test Loss: 1.021 Test Acc: 0.724
Validation loss decreased (-0.506567 --> -0.723674).  Saving model ...
Epoch: 4 cost time: 7.891782283782959
Epoch: 4, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.812 Vali Acc: 0.822 Test Loss: 0.812 Test Acc: 0.822
Validation loss decreased (-0.723674 --> -0.822360).  Saving model ...
Epoch: 5 cost time: 7.403850793838501
Epoch: 5, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.33794093132019
Epoch: 6, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.463 Vali Acc: 0.836 Test Loss: 0.463 Test Acc: 0.836
Validation loss decreased (-0.822360 --> -0.835522).  Saving model ...
Epoch: 7 cost time: 7.699083089828491
Epoch: 7, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.382 Vali Acc: 0.849 Test Loss: 0.382 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
Epoch: 8 cost time: 7.2875707149505615
Epoch: 8, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.848680 --> -0.874997).  Saving model ...
Epoch: 9 cost time: 6.728578329086304
Epoch: 9, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.311950445175171
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.405 Vali Acc: 0.829 Test Loss: 0.405 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.375556945800781
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.364 Vali Acc: 0.836 Test Loss: 0.364 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.077853918075562
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.475111484527588
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.388 Vali Acc: 0.836 Test Loss: 0.388 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.315596103668213
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.094177722930908
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.755490303039551
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.940005302429199
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.905374765396118
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 37503492
model size : 144.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.209516286849976
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.382 Vali Acc: 0.263 Test Loss: 1.382 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 3.590444803237915
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.233 Vali Acc: 0.421 Test Loss: 1.233 Test Acc: 0.421
Validation loss decreased (-0.263144 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 3.313673496246338
Epoch: 3, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.059 Vali Acc: 0.605 Test Loss: 1.059 Test Acc: 0.605
Validation loss decreased (-0.421040 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 3.172318935394287
Epoch: 4, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.900 Vali Acc: 0.684 Test Loss: 0.900 Test Acc: 0.684
Validation loss decreased (-0.605253 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 3.5773842334747314
Epoch: 5, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.734 Vali Acc: 0.770 Test Loss: 0.734 Test Acc: 0.770
Validation loss decreased (-0.684202 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 3.729776620864868
Epoch: 6, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
Validation loss decreased (-0.769730 --> -0.809205).  Saving model ...
Epoch: 7 cost time: 3.4368410110473633
Epoch: 7, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.490 Vali Acc: 0.836 Test Loss: 0.490 Test Acc: 0.836
Validation loss decreased (-0.809205 --> -0.835521).  Saving model ...
Epoch: 8 cost time: 3.1958277225494385
Epoch: 8, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.422 Vali Acc: 0.836 Test Loss: 0.422 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 9 cost time: 3.459476947784424
Epoch: 9, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.405 Vali Acc: 0.849 Test Loss: 0.405 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
Epoch: 10 cost time: 3.600886821746826
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 11 cost time: 3.2173192501068115
Epoch: 11, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.360 Vali Acc: 0.829 Test Loss: 0.360 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0256035327911377
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.347 Vali Acc: 0.868 Test Loss: 0.347 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868418).  Saving model ...
Epoch: 13 cost time: 3.2722580432891846
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.367 Vali Acc: 0.868 Test Loss: 0.367 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.772386312484741
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.355 Vali Acc: 0.829 Test Loss: 0.355 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.531468629837036
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.366 Vali Acc: 0.868 Test Loss: 0.366 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.503014087677002
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.366 Vali Acc: 0.842 Test Loss: 0.366 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6470022201538086
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.376 Vali Acc: 0.842 Test Loss: 0.376 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.241959571838379
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.371 Vali Acc: 0.842 Test Loss: 0.371 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1210787296295166
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.7780280113220215
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7220401763916016
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.424 Vali Acc: 0.842 Test Loss: 0.424 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.602726936340332
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.421 Vali Acc: 0.849 Test Loss: 0.421 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 11024388
model size : 43.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 8.76148796081543
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.312 Vali Acc: 0.428 Test Loss: 1.312 Test Acc: 0.428
Validation loss decreased (inf --> -0.427618).  Saving model ...
Epoch: 2 cost time: 7.670593738555908
Epoch: 2, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.177 Vali Acc: 0.507 Test Loss: 1.177 Test Acc: 0.507
Validation loss decreased (-0.427618 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 7.619998216629028
Epoch: 3, Steps: 10 | Train Loss: 1.036 Vali Loss: 0.972 Vali Acc: 0.671 Test Loss: 0.972 Test Acc: 0.671
Validation loss decreased (-0.506567 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 6.99816107749939
Epoch: 4, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
Validation loss decreased (-0.671043 --> -0.789466).  Saving model ...
Epoch: 5 cost time: 7.125905275344849
Epoch: 5, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
Validation loss decreased (-0.789466 --> -0.815784).  Saving model ...
Epoch: 6 cost time: 7.296805143356323
Epoch: 6, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.432 Vali Acc: 0.842 Test Loss: 0.432 Test Acc: 0.842
Validation loss decreased (-0.815784 --> -0.842101).  Saving model ...
Epoch: 7 cost time: 6.989203214645386
Epoch: 7, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.385 Vali Acc: 0.836 Test Loss: 0.385 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.251820802688599
Epoch: 8, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.367 Vali Acc: 0.882 Test Loss: 0.367 Test Acc: 0.882
Validation loss decreased (-0.842101 --> -0.881575).  Saving model ...
Epoch: 9 cost time: 6.9169511795043945
Epoch: 9, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.458 Vali Acc: 0.855 Test Loss: 0.458 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.823602199554443
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.912888050079346
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.019664764404297
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.486 Vali Acc: 0.882 Test Loss: 0.486 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.489685297012329
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.862 Test Loss: 0.498 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.6420488357543945
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.109287738800049
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.530 Vali Acc: 0.868 Test Loss: 0.530 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.7102556228637695
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.699741840362549
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.612 Vali Acc: 0.868 Test Loss: 0.612 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.49254035949707
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.862 Test Loss: 0.573 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 18757124
model size : 72.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.27052116394043
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.413 Vali Acc: 0.283 Test Loss: 1.413 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 3.2751598358154297
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.243 Vali Acc: 0.493 Test Loss: 1.243 Test Acc: 0.493
Validation loss decreased (-0.282881 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 3.408193588256836
Epoch: 3, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.044 Vali Acc: 0.678 Test Loss: 1.044 Test Acc: 0.678
Validation loss decreased (-0.493409 --> -0.677621).  Saving model ...
Epoch: 4 cost time: 3.4112367630004883
Epoch: 4, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.829 Vali Acc: 0.737 Test Loss: 0.829 Test Acc: 0.737
Validation loss decreased (-0.677621 --> -0.736834).  Saving model ...
Epoch: 5 cost time: 3.129382371902466
Epoch: 5, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
Validation loss decreased (-0.736834 --> -0.822362).  Saving model ...
Epoch: 6 cost time: 3.3461430072784424
Epoch: 6, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.487 Vali Acc: 0.842 Test Loss: 0.487 Test Acc: 0.842
Validation loss decreased (-0.822362 --> -0.842100).  Saving model ...
Epoch: 7 cost time: 2.9085001945495605
Epoch: 7, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.421 Vali Acc: 0.849 Test Loss: 0.421 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 8 cost time: 3.015211582183838
Epoch: 8, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 9 cost time: 2.989529609680176
Epoch: 9, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2776939868927
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7151060104370117
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.424 Vali Acc: 0.849 Test Loss: 0.424 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8701014518737793
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.424 Vali Acc: 0.842 Test Loss: 0.424 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.647324562072754
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.449 Vali Acc: 0.842 Test Loss: 0.449 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.641364336013794
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.446 Vali Acc: 0.842 Test Loss: 0.446 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8324339389801025
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.463 Vali Acc: 0.849 Test Loss: 0.463 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6796255111694336
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.836 Test Loss: 0.502 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.780792713165283
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.504 Vali Acc: 0.842 Test Loss: 0.504 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7130203247070312
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.517 Vali Acc: 0.849 Test Loss: 0.517 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 5517316
model size : 22.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.375040292739868
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.320 Vali Acc: 0.414 Test Loss: 1.320 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 5.665637016296387
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.197 Vali Acc: 0.526 Test Loss: 1.197 Test Acc: 0.526
Validation loss decreased (-0.414460 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 5.750379323959351
Epoch: 3, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.012 Vali Acc: 0.671 Test Loss: 1.012 Test Acc: 0.671
Validation loss decreased (-0.526304 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 5.736064195632935
Epoch: 4, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.807 Vali Acc: 0.750 Test Loss: 0.807 Test Acc: 0.750
Validation loss decreased (-0.671043 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 5.535845756530762
Epoch: 5, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.609 Vali Acc: 0.829 Test Loss: 0.609 Test Acc: 0.829
Validation loss decreased (-0.749992 --> -0.828941).  Saving model ...
Epoch: 6 cost time: 5.75477147102356
Epoch: 6, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.464 Vali Acc: 0.849 Test Loss: 0.464 Test Acc: 0.849
Validation loss decreased (-0.828941 --> -0.848680).  Saving model ...
Epoch: 7 cost time: 5.954365968704224
Epoch: 7, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 8 cost time: 6.079862594604492
Epoch: 8, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 6.046713829040527
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.873979091644287
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.415 Vali Acc: 0.849 Test Loss: 0.415 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.789917707443237
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.590054750442505
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.91522741317749
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.478 Vali Acc: 0.842 Test Loss: 0.478 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.84013032913208
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.605768918991089
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.479 Vali Acc: 0.849 Test Loss: 0.479 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.007782697677612
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.600006341934204
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.564 Vali Acc: 0.849 Test Loss: 0.564 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.799612283706665
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.539 Vali Acc: 0.862 Test Loss: 0.539 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 18757124
model size : 72.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.320542335510254
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 3.6399807929992676
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.268 Vali Acc: 0.474 Test Loss: 1.268 Test Acc: 0.474
Validation loss decreased (-0.269723 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 3.2841572761535645
Epoch: 3, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.087 Vali Acc: 0.645 Test Loss: 1.087 Test Acc: 0.645
Validation loss decreased (-0.473672 --> -0.644726).  Saving model ...
Epoch: 4 cost time: 3.4102771282196045
Epoch: 4, Steps: 10 | Train Loss: 0.885 Vali Loss: 0.890 Vali Acc: 0.737 Test Loss: 0.890 Test Acc: 0.737
Validation loss decreased (-0.644726 --> -0.736833).  Saving model ...
Epoch: 5 cost time: 3.4235706329345703
Epoch: 5, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
Validation loss decreased (-0.736833 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 3.5719375610351562
Epoch: 6, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
Validation loss decreased (-0.769730 --> -0.822363).  Saving model ...
Epoch: 7 cost time: 3.7521326541900635
Epoch: 7, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.467 Vali Acc: 0.842 Test Loss: 0.467 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842101).  Saving model ...
Epoch: 8 cost time: 3.5921905040740967
Epoch: 8, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.423 Vali Acc: 0.849 Test Loss: 0.423 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 9 cost time: 3.772742748260498
Epoch: 9, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.394 Vali Acc: 0.842 Test Loss: 0.394 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6473429203033447
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.441 Vali Acc: 0.842 Test Loss: 0.441 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6417391300201416
Epoch: 11, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.749816417694092
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4453155994415283
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5557141304016113
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.476 Vali Acc: 0.836 Test Loss: 0.476 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.303785562515259
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2530624866485596
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.476 Vali Acc: 0.836 Test Loss: 0.476 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.43255877494812
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2414016723632812
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.842 Test Loss: 0.498 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 5517316
model size : 22.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.138430833816528
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.335 Vali Acc: 0.401 Test Loss: 1.335 Test Acc: 0.401
Validation loss decreased (inf --> -0.401302).  Saving model ...
Epoch: 2 cost time: 4.32441782951355
Epoch: 2, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.228 Vali Acc: 0.493 Test Loss: 1.228 Test Acc: 0.493
Validation loss decreased (-0.401302 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 4.286591053009033
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.073 Vali Acc: 0.645 Test Loss: 1.073 Test Acc: 0.645
Validation loss decreased (-0.493409 --> -0.644726).  Saving model ...
Epoch: 4 cost time: 4.28738260269165
Epoch: 4, Steps: 10 | Train Loss: 0.942 Vali Loss: 0.900 Vali Acc: 0.704 Test Loss: 0.900 Test Acc: 0.704
Validation loss decreased (-0.644726 --> -0.703938).  Saving model ...
Epoch: 5 cost time: 4.415748596191406
Epoch: 5, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.738 Vali Acc: 0.796 Test Loss: 0.738 Test Acc: 0.796
Validation loss decreased (-0.703938 --> -0.796045).  Saving model ...
Epoch: 6 cost time: 4.473301887512207
Epoch: 6, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 4.285698652267456
Epoch: 7, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
Validation loss decreased (-0.802626 --> -0.835522).  Saving model ...
Epoch: 8 cost time: 4.414421558380127
Epoch: 8, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.384 Vali Acc: 0.836 Test Loss: 0.384 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 9 cost time: 4.41174578666687
Epoch: 9, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.349 Vali Acc: 0.855 Test Loss: 0.349 Test Acc: 0.855
Validation loss decreased (-0.835522 --> -0.855260).  Saving model ...
Epoch: 10 cost time: 4.459106922149658
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.334 Vali Acc: 0.849 Test Loss: 0.334 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.3445143699646
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.337 Vali Acc: 0.842 Test Loss: 0.337 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9263105392456055
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.340 Vali Acc: 0.849 Test Loss: 0.340 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6999874114990234
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.328 Vali Acc: 0.862 Test Loss: 0.328 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861839).  Saving model ...
Epoch: 14 cost time: 4.226551532745361
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.339 Vali Acc: 0.842 Test Loss: 0.339 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.414798021316528
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.348 Vali Acc: 0.868 Test Loss: 0.348 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868418).  Saving model ...
Epoch: 16 cost time: 4.163726806640625
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.354 Vali Acc: 0.855 Test Loss: 0.354 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.773210048675537
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7052743434906006
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.041284799575806
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.3039186000823975
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.045878648757935
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.870059013366699
Epoch: 22, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.062696933746338
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.328289985656738
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.01179838180542
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.417 Vali Acc: 0.868 Test Loss: 0.417 Test Acc: 0.868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 18757124
model size : 72.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.310481309890747
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.423 Vali Acc: 0.263 Test Loss: 1.423 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.5171380043029785
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.303 Vali Acc: 0.434 Test Loss: 1.303 Test Acc: 0.434
Validation loss decreased (-0.263144 --> -0.434197).  Saving model ...
Epoch: 3 cost time: 2.532034158706665
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.157 Vali Acc: 0.579 Test Loss: 1.157 Test Acc: 0.579
Validation loss decreased (-0.434197 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 2.4534201622009277
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 0.998 Vali Acc: 0.684 Test Loss: 0.998 Test Acc: 0.684
Validation loss decreased (-0.578936 --> -0.684201).  Saving model ...
Epoch: 5 cost time: 2.388584852218628
Epoch: 5, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.839 Vali Acc: 0.776 Test Loss: 0.839 Test Acc: 0.776
Validation loss decreased (-0.684201 --> -0.776307).  Saving model ...
Epoch: 6 cost time: 2.526233673095703
Epoch: 6, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.687 Vali Acc: 0.816 Test Loss: 0.687 Test Acc: 0.816
Validation loss decreased (-0.776307 --> -0.815783).  Saving model ...
Epoch: 7 cost time: 2.4076876640319824
Epoch: 7, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.570 Vali Acc: 0.842 Test Loss: 0.570 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842100).  Saving model ...
Epoch: 8 cost time: 2.54168438911438
Epoch: 8, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.480 Vali Acc: 0.842 Test Loss: 0.480 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 9 cost time: 2.3434438705444336
Epoch: 9, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.430 Vali Acc: 0.849 Test Loss: 0.430 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 10 cost time: 2.518695116043091
Epoch: 10, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.421 Vali Acc: 0.849 Test Loss: 0.421 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 11 cost time: 2.35644268989563
Epoch: 11, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.354743003845215
Epoch: 12, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.429 Vali Acc: 0.822 Test Loss: 0.429 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3029184341430664
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.436 Vali Acc: 0.829 Test Loss: 0.436 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.156259059906006
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.414 Vali Acc: 0.829 Test Loss: 0.414 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.072911024093628
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.392 Vali Acc: 0.849 Test Loss: 0.392 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 16 cost time: 2.7565619945526123
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 17 cost time: 2.5769882202148438
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.395 Vali Acc: 0.849 Test Loss: 0.395 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5006844997406006
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.406 Vali Acc: 0.868 Test Loss: 0.406 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 19 cost time: 2.510896921157837
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.391 Vali Acc: 0.862 Test Loss: 0.391 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.496670722961426
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6140549182891846
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3828022480010986
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.5943281650543213
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.413318395614624
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4574031829833984
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.4991512298583984
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.455 Vali Acc: 0.849 Test Loss: 0.455 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.582793951034546
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.485008478164673
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.448 Vali Acc: 0.842 Test Loss: 0.448 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 5517316
model size : 22.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.93168044090271
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.323 Vali Acc: 0.349 Test Loss: 1.323 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 5.394129514694214
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.201 Vali Acc: 0.474 Test Loss: 1.201 Test Acc: 0.474
Validation loss decreased (-0.348671 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 5.388399124145508
Epoch: 3, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.036 Vali Acc: 0.691 Test Loss: 1.036 Test Acc: 0.691
Validation loss decreased (-0.473672 --> -0.690779).  Saving model ...
Epoch: 4 cost time: 5.553548574447632
Epoch: 4, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.841 Vali Acc: 0.770 Test Loss: 0.841 Test Acc: 0.770
Validation loss decreased (-0.690779 --> -0.769728).  Saving model ...
Epoch: 5 cost time: 5.560261964797974
Epoch: 5, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
Validation loss decreased (-0.769728 --> -0.815783).  Saving model ...
Epoch: 6 cost time: 5.562284708023071
Epoch: 6, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.488 Vali Acc: 0.842 Test Loss: 0.488 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842100).  Saving model ...
Epoch: 7 cost time: 5.592481851577759
Epoch: 7, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.425 Vali Acc: 0.849 Test Loss: 0.425 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 8 cost time: 5.719576358795166
Epoch: 8, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.424 Vali Acc: 0.836 Test Loss: 0.424 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.928749322891235
Epoch: 9, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.415 Vali Acc: 0.809 Test Loss: 0.415 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.77630352973938
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.355551719665527
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.430 Vali Acc: 0.842 Test Loss: 0.430 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.3752830028533936
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.452 Vali Acc: 0.842 Test Loss: 0.452 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.870896816253662
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.415177822113037
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.552 Vali Acc: 0.842 Test Loss: 0.552 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.5596044063568115
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.912755727767944
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.599 Vali Acc: 0.836 Test Loss: 0.599 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.847869634628296
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.836 Test Loss: 0.568 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 9383940
model size : 37.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.937294960021973
Epoch: 1, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.297 Vali Acc: 0.428 Test Loss: 1.297 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 3.1024508476257324
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.186 Vali Acc: 0.559 Test Loss: 1.186 Test Acc: 0.559
Validation loss decreased (-0.427619 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 2.9992921352386475
Epoch: 3, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.049 Vali Acc: 0.671 Test Loss: 1.049 Test Acc: 0.671
Validation loss decreased (-0.559199 --> -0.671042).  Saving model ...
Epoch: 4 cost time: 3.0858383178710938
Epoch: 4, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.895 Vali Acc: 0.796 Test Loss: 0.895 Test Acc: 0.796
Validation loss decreased (-0.671042 --> -0.796044).  Saving model ...
Epoch: 5 cost time: 3.0770909786224365
Epoch: 5, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.732 Vali Acc: 0.849 Test Loss: 0.732 Test Acc: 0.849
Validation loss decreased (-0.796044 --> -0.848677).  Saving model ...
Epoch: 6 cost time: 3.072672128677368
Epoch: 6, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.580 Vali Acc: 0.862 Test Loss: 0.580 Test Acc: 0.862
Validation loss decreased (-0.848677 --> -0.861836).  Saving model ...
Epoch: 7 cost time: 3.2149927616119385
Epoch: 7, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.167402744293213
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.402 Vali Acc: 0.849 Test Loss: 0.402 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.039520025253296
Epoch: 9, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9806227684020996
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.354 Vali Acc: 0.849 Test Loss: 0.354 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.028153419494629
Epoch: 11, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.369 Vali Acc: 0.842 Test Loss: 0.369 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.170703411102295
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.391 Vali Acc: 0.842 Test Loss: 0.391 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.006596803665161
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.403 Vali Acc: 0.829 Test Loss: 0.403 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.038804292678833
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.409 Vali Acc: 0.849 Test Loss: 0.409 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.9457345008850098
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.423 Vali Acc: 0.842 Test Loss: 0.423 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.792009115219116
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 2763780
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.50507926940918
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.323 Vali Acc: 0.362 Test Loss: 1.323 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 4.304088592529297
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
Validation loss decreased (-0.361829 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 4.154316425323486
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.063 Vali Acc: 0.664 Test Loss: 1.063 Test Acc: 0.664
Validation loss decreased (-0.467093 --> -0.664463).  Saving model ...
Epoch: 4 cost time: 4.389963388442993
Epoch: 4, Steps: 10 | Train Loss: 0.928 Vali Loss: 0.893 Vali Acc: 0.717 Test Loss: 0.893 Test Acc: 0.717
Validation loss decreased (-0.664463 --> -0.717096).  Saving model ...
Epoch: 5 cost time: 4.3300769329071045
Epoch: 5, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.709 Vali Acc: 0.737 Test Loss: 0.709 Test Acc: 0.737
Validation loss decreased (-0.717096 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 4.513886213302612
Epoch: 6, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
Validation loss decreased (-0.736835 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 4.577460289001465
Epoch: 7, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 8 cost time: 4.795055627822876
Epoch: 8, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.444 Vali Acc: 0.822 Test Loss: 0.444 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 9 cost time: 4.663661956787109
Epoch: 9, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.425 Vali Acc: 0.809 Test Loss: 0.425 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.7250518798828125
Epoch: 10, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.480 Vali Acc: 0.822 Test Loss: 0.480 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.761944055557251
Epoch: 11, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.442 Vali Acc: 0.809 Test Loss: 0.442 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.675614356994629
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.429 Vali Acc: 0.849 Test Loss: 0.429 Test Acc: 0.849
Validation loss decreased (-0.822364 --> -0.848680).  Saving model ...
Epoch: 13 cost time: 4.883509397506714
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855258).  Saving model ...
Epoch: 14 cost time: 4.5268235206604
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861838).  Saving model ...
Epoch: 15 cost time: 4.931888580322266
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 4.5239787101745605
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.687212705612183
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.842 Test Loss: 0.531 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.3520777225494385
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.4815404415130615
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.868 Test Loss: 0.553 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.367725849151611
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.559 Vali Acc: 0.868 Test Loss: 0.559 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.42990779876709
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.570 Vali Acc: 0.862 Test Loss: 0.570 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.426995277404785
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.583 Vali Acc: 0.855 Test Loss: 0.583 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.44836163520813
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.606 Vali Acc: 0.842 Test Loss: 0.606 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.665453910827637
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.849 Test Loss: 0.627 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.482040643692017
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 9383940
model size : 37.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.702938795089722
Epoch: 1, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.302 Vali Acc: 0.441 Test Loss: 1.302 Test Acc: 0.441
Validation loss decreased (inf --> -0.440776).  Saving model ...
Epoch: 2 cost time: 2.8245887756347656
Epoch: 2, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.200 Vali Acc: 0.559 Test Loss: 1.200 Test Acc: 0.559
Validation loss decreased (-0.440776 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 2.672071695327759
Epoch: 3, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.073 Vali Acc: 0.671 Test Loss: 1.073 Test Acc: 0.671
Validation loss decreased (-0.559199 --> -0.671042).  Saving model ...
Epoch: 4 cost time: 2.5447399616241455
Epoch: 4, Steps: 10 | Train Loss: 0.955 Vali Loss: 0.933 Vali Acc: 0.757 Test Loss: 0.933 Test Acc: 0.757
Validation loss decreased (-0.671042 --> -0.756570).  Saving model ...
Epoch: 5 cost time: 2.8224027156829834
Epoch: 5, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.787 Vali Acc: 0.829 Test Loss: 0.787 Test Acc: 0.829
Validation loss decreased (-0.756570 --> -0.828940).  Saving model ...
Epoch: 6 cost time: 2.463866949081421
Epoch: 6, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.646 Vali Acc: 0.849 Test Loss: 0.646 Test Acc: 0.849
Validation loss decreased (-0.828940 --> -0.848678).  Saving model ...
Epoch: 7 cost time: 2.7414309978485107
Epoch: 7, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.525 Vali Acc: 0.829 Test Loss: 0.525 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.725470781326294
Epoch: 8, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5454344749450684
Epoch: 9, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6936826705932617
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.403 Vali Acc: 0.822 Test Loss: 0.403 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5148794651031494
Epoch: 11, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.401 Vali Acc: 0.836 Test Loss: 0.401 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6238653659820557
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.411 Vali Acc: 0.842 Test Loss: 0.411 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6742961406707764
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.433 Vali Acc: 0.842 Test Loss: 0.433 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5265004634857178
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.471 Vali Acc: 0.836 Test Loss: 0.471 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.535043716430664
Epoch: 15, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.486 Vali Acc: 0.842 Test Loss: 0.486 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.651663064956665
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 2763780
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.19538950920105
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.328 Vali Acc: 0.336 Test Loss: 1.328 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 3.180032968521118
Epoch: 2, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.239 Vali Acc: 0.441 Test Loss: 1.239 Test Acc: 0.441
Validation loss decreased (-0.335513 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 3.136751174926758
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.440777 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 3.186558485031128
Epoch: 4, Steps: 10 | Train Loss: 1.005 Vali Loss: 0.990 Vali Acc: 0.697 Test Loss: 0.990 Test Acc: 0.697
Validation loss decreased (-0.624989 --> -0.697359).  Saving model ...
Epoch: 5 cost time: 3.2438671588897705
Epoch: 5, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.839 Vali Acc: 0.743 Test Loss: 0.839 Test Acc: 0.743
Validation loss decreased (-0.697359 --> -0.743413).  Saving model ...
Epoch: 6 cost time: 3.1364481449127197
Epoch: 6, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
Validation loss decreased (-0.743413 --> -0.802625).  Saving model ...
Epoch: 7 cost time: 3.391982316970825
Epoch: 7, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.802625 --> -0.822363).  Saving model ...
Epoch: 8 cost time: 3.1865286827087402
Epoch: 8, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.452 Vali Acc: 0.842 Test Loss: 0.452 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842101).  Saving model ...
Epoch: 9 cost time: 3.4255285263061523
Epoch: 9, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.418 Vali Acc: 0.849 Test Loss: 0.418 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 10 cost time: 3.113553047180176
Epoch: 10, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 11 cost time: 3.291701078414917
Epoch: 11, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.354 Vali Acc: 0.855 Test Loss: 0.354 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855260).  Saving model ...
Epoch: 12 cost time: 3.419670820236206
Epoch: 12, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.364 Vali Acc: 0.836 Test Loss: 0.364 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1960248947143555
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.342 Vali Acc: 0.862 Test Loss: 0.342 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861839).  Saving model ...
Epoch: 14 cost time: 3.3798515796661377
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.433 Vali Acc: 0.829 Test Loss: 0.433 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8932228088378906
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.442 Vali Acc: 0.822 Test Loss: 0.442 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3696377277374268
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.118602752685547
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.243342161178589
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.402 Vali Acc: 0.822 Test Loss: 0.402 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2342538833618164
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2433836460113525
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.397 Vali Acc: 0.842 Test Loss: 0.397 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.3770811557769775
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.417 Vali Acc: 0.849 Test Loss: 0.417 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.2975447177886963
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.423 Vali Acc: 0.849 Test Loss: 0.423 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.2497615814208984
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.443 Vali Acc: 0.849 Test Loss: 0.443 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 9383940
model size : 37.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.844668388366699
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.316 Vali Acc: 0.421 Test Loss: 1.316 Test Acc: 0.421
Validation loss decreased (inf --> -0.421039).  Saving model ...
Epoch: 2 cost time: 2.1960625648498535
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.228 Vali Acc: 0.526 Test Loss: 1.228 Test Acc: 0.526
Validation loss decreased (-0.421039 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 2.0882391929626465
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.117 Vali Acc: 0.632 Test Loss: 1.117 Test Acc: 0.632
Validation loss decreased (-0.526304 --> -0.631568).  Saving model ...
Epoch: 4 cost time: 1.9298901557922363
Epoch: 4, Steps: 10 | Train Loss: 1.030 Vali Loss: 0.994 Vali Acc: 0.724 Test Loss: 0.994 Test Acc: 0.724
Validation loss decreased (-0.631568 --> -0.723674).  Saving model ...
Epoch: 5 cost time: 1.8065221309661865
Epoch: 5, Steps: 10 | Train Loss: 0.882 Vali Loss: 0.862 Vali Acc: 0.776 Test Loss: 0.862 Test Acc: 0.776
Validation loss decreased (-0.723674 --> -0.776307).  Saving model ...
Epoch: 6 cost time: 1.7986018657684326
Epoch: 6, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.731 Vali Acc: 0.849 Test Loss: 0.731 Test Acc: 0.849
Validation loss decreased (-0.776307 --> -0.848677).  Saving model ...
Epoch: 7 cost time: 2.0891764163970947
Epoch: 7, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.604 Vali Acc: 0.836 Test Loss: 0.604 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.183288335800171
Epoch: 8, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.513 Vali Acc: 0.842 Test Loss: 0.513 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.041435480117798
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.435 Vali Acc: 0.849 Test Loss: 0.435 Test Acc: 0.849
Validation loss decreased (-0.848677 --> -0.848680).  Saving model ...
Epoch: 10 cost time: 2.1376585960388184
Epoch: 10, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 11 cost time: 2.0611279010772705
Epoch: 11, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.357 Vali Acc: 0.868 Test Loss: 0.357 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 12 cost time: 2.0575854778289795
Epoch: 12, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.345 Vali Acc: 0.855 Test Loss: 0.345 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1559712886810303
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.332 Vali Acc: 0.882 Test Loss: 0.332 Test Acc: 0.882
Validation loss decreased (-0.868417 --> -0.881576).  Saving model ...
Epoch: 14 cost time: 1.9647915363311768
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.213711977005005
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0631234645843506
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.346 Vali Acc: 0.862 Test Loss: 0.346 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.239241361618042
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.403 Vali Acc: 0.849 Test Loss: 0.403 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.054816722869873
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.430 Vali Acc: 0.836 Test Loss: 0.430 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.270972728729248
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.440 Vali Acc: 0.816 Test Loss: 0.440 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1669557094573975
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.452 Vali Acc: 0.822 Test Loss: 0.452 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.156176805496216
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1407907009124756
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1877601146698
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 2763780
model size : 11.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.66606593132019
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 5.581331253051758
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.291 Vali Acc: 0.322 Test Loss: 1.291 Test Acc: 0.322
Validation loss decreased (-0.269723 --> -0.322356).  Saving model ...
Epoch: 3 cost time: 5.303696155548096
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.187 Vali Acc: 0.461 Test Loss: 1.187 Test Acc: 0.461
Validation loss decreased (-0.322356 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 5.2049267292022705
Epoch: 4, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.060 Vali Acc: 0.605 Test Loss: 1.060 Test Acc: 0.605
Validation loss decreased (-0.460514 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 5.066499948501587
Epoch: 5, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.901 Vali Acc: 0.711 Test Loss: 0.901 Test Acc: 0.711
Validation loss decreased (-0.605253 --> -0.710517).  Saving model ...
Epoch: 6 cost time: 5.25565767288208
Epoch: 6, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.732 Vali Acc: 0.776 Test Loss: 0.732 Test Acc: 0.776
Validation loss decreased (-0.710517 --> -0.776308).  Saving model ...
Epoch: 7 cost time: 5.08049750328064
Epoch: 7, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
Validation loss decreased (-0.776308 --> -0.815784).  Saving model ...
Epoch: 8 cost time: 5.167091608047485
Epoch: 8, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.505 Vali Acc: 0.836 Test Loss: 0.505 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 9 cost time: 5.103945970535278
Epoch: 9, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.447 Vali Acc: 0.829 Test Loss: 0.447 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.1850879192352295
Epoch: 10, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
Validation loss decreased (-0.835521 --> -0.855259).  Saving model ...
Epoch: 11 cost time: 5.01747727394104
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 12 cost time: 5.458641290664673
Epoch: 12, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.626954078674316
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 5.871371507644653
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.463 Vali Acc: 0.849 Test Loss: 0.463 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.772468090057373
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.836 Test Loss: 0.531 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.320277690887451
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.613 Vali Acc: 0.836 Test Loss: 0.613 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.776034116744995
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.829 Test Loss: 0.579 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.183199167251587
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.684 Vali Acc: 0.849 Test Loss: 0.684 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.859415531158447
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.640 Vali Acc: 0.829 Test Loss: 0.640 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.9893505573272705
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.831824779510498
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.703 Vali Acc: 0.862 Test Loss: 0.703 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.5076823234558105
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.855 Test Loss: 0.598 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.424025058746338
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.591 Vali Acc: 0.842 Test Loss: 0.591 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 9380100
model size : 36.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.89141583442688
Epoch: 1, Steps: 10 | Train Loss: 1.547 Vali Loss: 1.455 Vali Acc: 0.211 Test Loss: 1.455 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 3.0204687118530273
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.358 Vali Acc: 0.276 Test Loss: 1.358 Test Acc: 0.276
Validation loss decreased (-0.210512 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 3.0321860313415527
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.237 Vali Acc: 0.461 Test Loss: 1.237 Test Acc: 0.461
Validation loss decreased (-0.276302 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 3.034505605697632
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.104 Vali Acc: 0.612 Test Loss: 1.104 Test Acc: 0.612
Validation loss decreased (-0.460514 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 3.205343008041382
Epoch: 5, Steps: 10 | Train Loss: 0.922 Vali Loss: 0.955 Vali Acc: 0.691 Test Loss: 0.955 Test Acc: 0.691
Validation loss decreased (-0.611831 --> -0.690780).  Saving model ...
Epoch: 6 cost time: 3.2472593784332275
Epoch: 6, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.808 Vali Acc: 0.730 Test Loss: 0.808 Test Acc: 0.730
Validation loss decreased (-0.690780 --> -0.730255).  Saving model ...
Epoch: 7 cost time: 3.373204469680786
Epoch: 7, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 3.170029878616333
Epoch: 8, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 3.3456716537475586
Epoch: 9, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
Validation loss decreased (-0.756573 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 3.2425968647003174
Epoch: 10, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 11 cost time: 3.348609209060669
Epoch: 11, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.439 Vali Acc: 0.829 Test Loss: 0.439 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 12 cost time: 3.301412343978882
Epoch: 12, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.461 Vali Acc: 0.836 Test Loss: 0.461 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 13 cost time: 3.315701723098755
Epoch: 13, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.444 Vali Acc: 0.822 Test Loss: 0.444 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1932945251464844
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.439 Vali Acc: 0.829 Test Loss: 0.439 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.131352186203003
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.213545799255371
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.491 Vali Acc: 0.842 Test Loss: 0.491 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842100).  Saving model ...
Epoch: 17 cost time: 3.249805212020874
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.251659393310547
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.261496067047119
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3134117126464844
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.652 Vali Acc: 0.816 Test Loss: 0.652 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1140804290771484
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
Validation loss decreased (-0.842100 --> -0.861837).  Saving model ...
Epoch: 22 cost time: 3.30074405670166
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.577 Vali Acc: 0.836 Test Loss: 0.577 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.040619134902954
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.483 Vali Acc: 0.849 Test Loss: 0.483 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3872334957122803
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.530 Vali Acc: 0.842 Test Loss: 0.530 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0304508209228516
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.583 Vali Acc: 0.836 Test Loss: 0.583 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.444054365158081
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.558 Vali Acc: 0.836 Test Loss: 0.558 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.026211738586426
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.842 Test Loss: 0.563 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.4207937717437744
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.612 Vali Acc: 0.829 Test Loss: 0.612 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.6850650310516357
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.623 Vali Acc: 0.829 Test Loss: 0.623 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.3575334548950195
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.680 Vali Acc: 0.836 Test Loss: 0.680 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 2759684
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.855360984802246
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.394 Vali Acc: 0.263 Test Loss: 1.394 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 4.4933953285217285
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.314 Vali Acc: 0.289 Test Loss: 1.314 Test Acc: 0.289
Validation loss decreased (-0.263144 --> -0.289461).  Saving model ...
Epoch: 3 cost time: 4.602357625961304
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.227 Vali Acc: 0.421 Test Loss: 1.227 Test Acc: 0.421
Validation loss decreased (-0.289461 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 4.944461345672607
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.123 Vali Acc: 0.513 Test Loss: 1.123 Test Acc: 0.513
Validation loss decreased (-0.421040 --> -0.513147).  Saving model ...
Epoch: 5 cost time: 4.701657295227051
Epoch: 5, Steps: 10 | Train Loss: 0.970 Vali Loss: 0.992 Vali Acc: 0.658 Test Loss: 0.992 Test Acc: 0.658
Validation loss decreased (-0.513147 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 4.6447248458862305
Epoch: 6, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.836 Vali Acc: 0.724 Test Loss: 0.836 Test Acc: 0.724
Validation loss decreased (-0.657885 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 4.581605672836304
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 0.689 Vali Acc: 0.796 Test Loss: 0.689 Test Acc: 0.796
Validation loss decreased (-0.723676 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 4.739238739013672
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815784).  Saving model ...
Epoch: 9 cost time: 4.536847114562988
Epoch: 9, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.497 Vali Acc: 0.842 Test Loss: 0.497 Test Acc: 0.842
Validation loss decreased (-0.815784 --> -0.842100).  Saving model ...
Epoch: 10 cost time: 3.6360504627227783
Epoch: 10, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.457 Vali Acc: 0.842 Test Loss: 0.457 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 11 cost time: 3.7326266765594482
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
Validation loss decreased (-0.842101 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 4.045064687728882
Epoch: 12, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.449 Vali Acc: 0.849 Test Loss: 0.449 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.397478103637695
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.520863771438599
Epoch: 14, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.343034029006958
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.203330755233765
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.1566925048828125
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.410297870635986
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.505 Vali Acc: 0.849 Test Loss: 0.505 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.495894193649292
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 4.584675073623657
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.399 Vali Acc: 0.849 Test Loss: 0.399 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.501683235168457
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.461792707443237
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.509565830230713
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.451 Vali Acc: 0.868 Test Loss: 0.451 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.596523761749268
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.649442434310913
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.464864253997803
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.492 Vali Acc: 0.842 Test Loss: 0.492 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.660175085067749
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.554 Vali Acc: 0.855 Test Loss: 0.554 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.690169811248779
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.340378999710083
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.527 Vali Acc: 0.842 Test Loss: 0.527 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 9380100
model size : 36.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.63619327545166
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.460 Vali Acc: 0.204 Test Loss: 1.460 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 2.5133962631225586
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.373 Vali Acc: 0.243 Test Loss: 1.373 Test Acc: 0.243
Validation loss decreased (-0.203933 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 2.5645933151245117
Epoch: 3, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.264 Vali Acc: 0.401 Test Loss: 1.264 Test Acc: 0.401
Validation loss decreased (-0.243407 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 2.6559691429138184
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.146 Vali Acc: 0.579 Test Loss: 1.146 Test Acc: 0.579
Validation loss decreased (-0.401303 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 2.7229111194610596
Epoch: 5, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.017 Vali Acc: 0.645 Test Loss: 1.017 Test Acc: 0.645
Validation loss decreased (-0.578936 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 2.555274248123169
Epoch: 6, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.881 Vali Acc: 0.684 Test Loss: 0.881 Test Acc: 0.684
Validation loss decreased (-0.644727 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 2.3640875816345215
Epoch: 7, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.765 Vali Acc: 0.724 Test Loss: 0.765 Test Acc: 0.724
Validation loss decreased (-0.684202 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 2.743413209915161
Epoch: 8, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.679 Vali Acc: 0.730 Test Loss: 0.679 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 2.909367322921753
Epoch: 9, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
Validation loss decreased (-0.730256 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 2.876418113708496
Epoch: 10, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.531 Vali Acc: 0.829 Test Loss: 0.531 Test Acc: 0.829
Validation loss decreased (-0.796047 --> -0.828942).  Saving model ...
Epoch: 11 cost time: 2.9161527156829834
Epoch: 11, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.483 Vali Acc: 0.842 Test Loss: 0.483 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842100).  Saving model ...
Epoch: 12 cost time: 2.7666921615600586
Epoch: 12, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.618673086166382
Epoch: 13, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855259).  Saving model ...
Epoch: 14 cost time: 3.1177611351013184
Epoch: 14, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.408 Vali Acc: 0.842 Test Loss: 0.408 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8944790363311768
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 16 cost time: 2.76771879196167
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.372 Vali Acc: 0.868 Test Loss: 0.372 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 17 cost time: 3.001016616821289
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.461 Vali Acc: 0.829 Test Loss: 0.461 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.863468885421753
Epoch: 18, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.357 Vali Acc: 0.868 Test Loss: 0.357 Test Acc: 0.868
Validation loss decreased (-0.868417 --> -0.868417).  Saving model ...
Epoch: 19 cost time: 2.9743573665618896
Epoch: 19, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.372 Vali Acc: 0.842 Test Loss: 0.372 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9900693893432617
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.366 Vali Acc: 0.868 Test Loss: 0.366 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.893519401550293
Epoch: 21, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.339 Vali Acc: 0.842 Test Loss: 0.339 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.951321840286255
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.296 Vali Acc: 0.895 Test Loss: 0.296 Test Acc: 0.895
Validation loss decreased (-0.868417 --> -0.894734).  Saving model ...
Epoch: 23 cost time: 2.877075433731079
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.437 Vali Acc: 0.842 Test Loss: 0.437 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8486618995666504
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.741187810897827
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.422 Vali Acc: 0.836 Test Loss: 0.422 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.773455858230591
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.417 Vali Acc: 0.849 Test Loss: 0.417 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.7188165187835693
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.430 Vali Acc: 0.842 Test Loss: 0.430 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.5795419216156006
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.421 Vali Acc: 0.842 Test Loss: 0.421 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.5621867179870605
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.366 Vali Acc: 0.888 Test Loss: 0.366 Test Acc: 0.888
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.561211109161377
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.354 Vali Acc: 0.868 Test Loss: 0.354 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8947368421052632
model parameter : 2759684
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.820154428482056
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.401 Vali Acc: 0.250 Test Loss: 1.401 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 3.1452155113220215
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.332 Vali Acc: 0.276 Test Loss: 1.332 Test Acc: 0.276
Validation loss decreased (-0.249986 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 3.4157752990722656
Epoch: 3, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.258 Vali Acc: 0.395 Test Loss: 1.258 Test Acc: 0.395
Validation loss decreased (-0.276302 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 3.388059377670288
Epoch: 4, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
Validation loss decreased (-0.394724 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 3.358184337615967
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.071 Vali Acc: 0.605 Test Loss: 1.071 Test Acc: 0.605
Validation loss decreased (-0.493409 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 3.3885884284973145
Epoch: 6, Steps: 10 | Train Loss: 0.968 Vali Loss: 0.948 Vali Acc: 0.704 Test Loss: 0.948 Test Acc: 0.704
Validation loss decreased (-0.605252 --> -0.703938).  Saving model ...
Epoch: 7 cost time: 3.3770148754119873
Epoch: 7, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.830 Vali Acc: 0.763 Test Loss: 0.830 Test Acc: 0.763
Validation loss decreased (-0.703938 --> -0.763150).  Saving model ...
Epoch: 8 cost time: 3.218017339706421
Epoch: 8, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.722 Vali Acc: 0.809 Test Loss: 0.722 Test Acc: 0.809
Validation loss decreased (-0.763150 --> -0.809203).  Saving model ...
Epoch: 9 cost time: 3.3514184951782227
Epoch: 9, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.605 Vali Acc: 0.822 Test Loss: 0.605 Test Acc: 0.822
Validation loss decreased (-0.809203 --> -0.822362).  Saving model ...
Epoch: 10 cost time: 3.423732280731201
Epoch: 10, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.525 Vali Acc: 0.842 Test Loss: 0.525 Test Acc: 0.842
Validation loss decreased (-0.822362 --> -0.842100).  Saving model ...
Epoch: 11 cost time: 3.530247449874878
Epoch: 11, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.455 Vali Acc: 0.849 Test Loss: 0.455 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 12 cost time: 3.638373851776123
Epoch: 12, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.421 Vali Acc: 0.842 Test Loss: 0.421 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.651625633239746
Epoch: 13, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 14 cost time: 3.5401108264923096
Epoch: 14, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.362 Vali Acc: 0.836 Test Loss: 0.362 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.514864444732666
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.366 Vali Acc: 0.855 Test Loss: 0.366 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.421773910522461
Epoch: 16, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.350 Vali Acc: 0.855 Test Loss: 0.350 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3332455158233643
Epoch: 17, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.350 Vali Acc: 0.836 Test Loss: 0.350 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.386939525604248
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.354 Vali Acc: 0.855 Test Loss: 0.354 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2696969509124756
Epoch: 19, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.352 Vali Acc: 0.849 Test Loss: 0.352 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.470362424850464
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.362 Vali Acc: 0.849 Test Loss: 0.362 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.3599042892456055
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.341468572616577
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.382 Vali Acc: 0.849 Test Loss: 0.382 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.334270477294922
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 9380100
model size : 36.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.066636323928833
Epoch: 1, Steps: 10 | Train Loss: 1.546 Vali Loss: 1.458 Vali Acc: 0.211 Test Loss: 1.458 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 2.308018445968628
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.383 Vali Acc: 0.237 Test Loss: 1.383 Test Acc: 0.237
Validation loss decreased (-0.210512 --> -0.236828).  Saving model ...
Epoch: 3 cost time: 2.1669082641601562
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.291 Vali Acc: 0.368 Test Loss: 1.291 Test Acc: 0.368
Validation loss decreased (-0.236828 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.185513734817505
Epoch: 4, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.192 Vali Acc: 0.533 Test Loss: 1.192 Test Acc: 0.533
Validation loss decreased (-0.368408 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 2.139521598815918
Epoch: 5, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.083 Vali Acc: 0.638 Test Loss: 1.083 Test Acc: 0.638
Validation loss decreased (-0.532883 --> -0.638147).  Saving model ...
Epoch: 6 cost time: 2.187709331512451
Epoch: 6, Steps: 10 | Train Loss: 0.971 Vali Loss: 0.963 Vali Acc: 0.697 Test Loss: 0.963 Test Acc: 0.697
Validation loss decreased (-0.638147 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 2.2680470943450928
Epoch: 7, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.848 Vali Acc: 0.757 Test Loss: 0.848 Test Acc: 0.757
Validation loss decreased (-0.697359 --> -0.756570).  Saving model ...
Epoch: 8 cost time: 2.072730302810669
Epoch: 8, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.751 Vali Acc: 0.776 Test Loss: 0.751 Test Acc: 0.776
Validation loss decreased (-0.756570 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 1.944211721420288
Epoch: 9, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
Validation loss decreased (-0.776308 --> -0.796046).  Saving model ...
Epoch: 10 cost time: 2.1313772201538086
Epoch: 10, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 2.1172854900360107
Epoch: 11, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 2.198111057281494
Epoch: 12, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828943).  Saving model ...
Epoch: 13 cost time: 2.123765707015991
Epoch: 13, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.443 Vali Acc: 0.809 Test Loss: 0.443 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0969314575195312
Epoch: 14, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 2.105943202972412
Epoch: 15, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.400 Vali Acc: 0.809 Test Loss: 0.400 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.217257261276245
Epoch: 16, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.375 Vali Acc: 0.836 Test Loss: 0.375 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1093051433563232
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.360 Vali Acc: 0.862 Test Loss: 0.360 Test Acc: 0.862
Validation loss decreased (-0.842101 --> -0.861839).  Saving model ...
Epoch: 18 cost time: 2.0873703956604004
Epoch: 18, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.363 Vali Acc: 0.849 Test Loss: 0.363 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.069528579711914
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.351 Vali Acc: 0.862 Test Loss: 0.351 Test Acc: 0.862
Validation loss decreased (-0.861839 --> -0.861839).  Saving model ...
Epoch: 20 cost time: 2.0869946479797363
Epoch: 20, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.344 Vali Acc: 0.868 Test Loss: 0.344 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868418).  Saving model ...
Epoch: 21 cost time: 1.963413953781128
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.341 Vali Acc: 0.868 Test Loss: 0.341 Test Acc: 0.868
Validation loss decreased (-0.868418 --> -0.868418).  Saving model ...
Epoch: 22 cost time: 2.0598411560058594
Epoch: 22, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.335 Vali Acc: 0.849 Test Loss: 0.335 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1335623264312744
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.342 Vali Acc: 0.855 Test Loss: 0.342 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1837267875671387
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.343 Vali Acc: 0.868 Test Loss: 0.343 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.183518171310425
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.329 Vali Acc: 0.862 Test Loss: 0.329 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1464388370513916
Epoch: 26, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.868418 --> -0.874997).  Saving model ...
Epoch: 27 cost time: 2.0606272220611572
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.356 Vali Acc: 0.868 Test Loss: 0.356 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.063814878463745
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.339 Vali Acc: 0.849 Test Loss: 0.339 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1710400581359863
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.324 Vali Acc: 0.842 Test Loss: 0.324 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.0827975273132324
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.328 Vali Acc: 0.855 Test Loss: 0.328 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 2759684
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.870817422866821
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.402 Vali Acc: 0.250 Test Loss: 1.402 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 4.224846124649048
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.320 Vali Acc: 0.388 Test Loss: 1.320 Test Acc: 0.388
Validation loss decreased (-0.249986 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 4.279908657073975
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.215 Vali Acc: 0.526 Test Loss: 1.215 Test Acc: 0.526
Validation loss decreased (-0.388145 --> -0.526304).  Saving model ...
Epoch: 4 cost time: 4.263697147369385
Epoch: 4, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.089 Vali Acc: 0.651 Test Loss: 1.089 Test Acc: 0.651
Validation loss decreased (-0.526304 --> -0.651305).  Saving model ...
Epoch: 5 cost time: 4.129202365875244
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 0.939 Vali Acc: 0.737 Test Loss: 0.939 Test Acc: 0.737
Validation loss decreased (-0.651305 --> -0.736833).  Saving model ...
Epoch: 6 cost time: 4.342157363891602
Epoch: 6, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.791 Vali Acc: 0.789 Test Loss: 0.791 Test Acc: 0.789
Validation loss decreased (-0.736833 --> -0.789466).  Saving model ...
Epoch: 7 cost time: 3.925609588623047
Epoch: 7, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.677 Vali Acc: 0.796 Test Loss: 0.677 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 4.549042224884033
Epoch: 8, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
Validation loss decreased (-0.796046 --> -0.822363).  Saving model ...
Epoch: 9 cost time: 4.347375154495239
Epoch: 9, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 10 cost time: 4.592372179031372
Epoch: 10, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 11 cost time: 4.388778209686279
Epoch: 11, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.428 Vali Acc: 0.849 Test Loss: 0.428 Test Acc: 0.849
Validation loss decreased (-0.822364 --> -0.848680).  Saving model ...
Epoch: 12 cost time: 4.449700355529785
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.441 Vali Acc: 0.849 Test Loss: 0.441 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9111573696136475
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.467 Vali Acc: 0.836 Test Loss: 0.467 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8779759407043457
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.480 Vali Acc: 0.842 Test Loss: 0.480 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.016542196273804
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.505 Vali Acc: 0.836 Test Loss: 0.505 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.211487054824829
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.505 Vali Acc: 0.849 Test Loss: 0.505 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.9922335147857666
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.583 Vali Acc: 0.849 Test Loss: 0.583 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.347484111785889
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.587 Vali Acc: 0.842 Test Loss: 0.587 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.22085165977478
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.640 Vali Acc: 0.836 Test Loss: 0.640 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.336286783218384
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.634 Vali Acc: 0.836 Test Loss: 0.634 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.105853796005249
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.651 Vali Acc: 0.836 Test Loss: 0.651 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 4692740
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.188313722610474
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.378 Vali Acc: 0.342 Test Loss: 1.378 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 3.0250790119171143
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.285 Vali Acc: 0.474 Test Loss: 1.285 Test Acc: 0.474
Validation loss decreased (-0.342091 --> -0.473671).  Saving model ...
Epoch: 3 cost time: 3.067281723022461
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.185 Vali Acc: 0.592 Test Loss: 1.185 Test Acc: 0.592
Validation loss decreased (-0.473671 --> -0.592093).  Saving model ...
Epoch: 4 cost time: 2.582037925720215
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.087 Vali Acc: 0.638 Test Loss: 1.087 Test Acc: 0.638
Validation loss decreased (-0.592093 --> -0.638147).  Saving model ...
Epoch: 5 cost time: 2.512338876724243
Epoch: 5, Steps: 10 | Train Loss: 0.996 Vali Loss: 0.983 Vali Acc: 0.704 Test Loss: 0.983 Test Acc: 0.704
Validation loss decreased (-0.638147 --> -0.703938).  Saving model ...
Epoch: 6 cost time: 2.9960508346557617
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.873 Vali Acc: 0.757 Test Loss: 0.873 Test Acc: 0.757
Validation loss decreased (-0.703938 --> -0.756570).  Saving model ...
Epoch: 7 cost time: 3.1283023357391357
Epoch: 7, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.754 Vali Acc: 0.796 Test Loss: 0.754 Test Acc: 0.796
Validation loss decreased (-0.756570 --> -0.796045).  Saving model ...
Epoch: 8 cost time: 3.074432611465454
Epoch: 8, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.639 Vali Acc: 0.829 Test Loss: 0.639 Test Acc: 0.829
Validation loss decreased (-0.796045 --> -0.828941).  Saving model ...
Epoch: 9 cost time: 2.988391637802124
Epoch: 9, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.554 Vali Acc: 0.855 Test Loss: 0.554 Test Acc: 0.855
Validation loss decreased (-0.828941 --> -0.855258).  Saving model ...
Epoch: 10 cost time: 3.110869884490967
Epoch: 10, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.491 Vali Acc: 0.842 Test Loss: 0.491 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0162906646728516
Epoch: 11, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855259).  Saving model ...
Epoch: 12 cost time: 3.1262717247009277
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.423 Vali Acc: 0.849 Test Loss: 0.423 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6215038299560547
Epoch: 13, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 14 cost time: 2.687342643737793
Epoch: 14, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
Validation loss decreased (-0.855259 --> -0.874996).  Saving model ...
Epoch: 15 cost time: 2.543095588684082
Epoch: 15, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4010677337646484
Epoch: 16, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.378 Vali Acc: 0.882 Test Loss: 0.378 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881575).  Saving model ...
Epoch: 17 cost time: 2.7593159675598145
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.419 Vali Acc: 0.862 Test Loss: 0.419 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6754727363586426
Epoch: 18, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.409 Vali Acc: 0.882 Test Loss: 0.409 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8331871032714844
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7367970943450928
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.907496929168701
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.400 Vali Acc: 0.882 Test Loss: 0.400 Test Acc: 0.882
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6967966556549072
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.442 Vali Acc: 0.862 Test Loss: 0.442 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.576206922531128
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.420 Vali Acc: 0.882 Test Loss: 0.420 Test Acc: 0.882
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.8673205375671387
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.436 Vali Acc: 0.888 Test Loss: 0.436 Test Acc: 0.888
Validation loss decreased (-0.881575 --> -0.888154).  Saving model ...
Epoch: 25 cost time: 2.8037259578704834
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.477 Vali Acc: 0.868 Test Loss: 0.477 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7370827198028564
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.492 Vali Acc: 0.862 Test Loss: 0.492 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7712676525115967
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.467 Vali Acc: 0.882 Test Loss: 0.467 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9343936443328857
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.504 Vali Acc: 0.868 Test Loss: 0.504 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.7615268230438232
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.862 Test Loss: 0.527 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.7755930423736572
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.499 Vali Acc: 0.875 Test Loss: 0.499 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 1382404
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.842955112457275
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.404 Vali Acc: 0.250 Test Loss: 1.404 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 3.7708804607391357
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.332 Vali Acc: 0.388 Test Loss: 1.332 Test Acc: 0.388
Validation loss decreased (-0.249986 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 3.9270975589752197
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.240 Vali Acc: 0.526 Test Loss: 1.240 Test Acc: 0.526
Validation loss decreased (-0.388145 --> -0.526303).  Saving model ...
Epoch: 4 cost time: 3.706280469894409
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.131 Vali Acc: 0.586 Test Loss: 1.131 Test Acc: 0.586
Validation loss decreased (-0.526303 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 3.9492900371551514
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.002 Vali Acc: 0.717 Test Loss: 1.002 Test Acc: 0.717
Validation loss decreased (-0.585515 --> -0.717095).  Saving model ...
Epoch: 6 cost time: 3.6864864826202393
Epoch: 6, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.860 Vali Acc: 0.783 Test Loss: 0.860 Test Acc: 0.783
Validation loss decreased (-0.717095 --> -0.782886).  Saving model ...
Epoch: 7 cost time: 3.6736178398132324
Epoch: 7, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.730 Vali Acc: 0.796 Test Loss: 0.730 Test Acc: 0.796
Validation loss decreased (-0.782886 --> -0.796045).  Saving model ...
Epoch: 8 cost time: 3.4292612075805664
Epoch: 8, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.619 Vali Acc: 0.822 Test Loss: 0.619 Test Acc: 0.822
Validation loss decreased (-0.796045 --> -0.822362).  Saving model ...
Epoch: 9 cost time: 3.270397424697876
Epoch: 9, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 10 cost time: 3.3243966102600098
Epoch: 10, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.457 Vali Acc: 0.849 Test Loss: 0.457 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848680).  Saving model ...
Epoch: 11 cost time: 3.4831383228302
Epoch: 11, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.408 Vali Acc: 0.842 Test Loss: 0.408 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0953338146209717
Epoch: 12, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.390 Vali Acc: 0.849 Test Loss: 0.390 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 13 cost time: 3.614168882369995
Epoch: 13, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.388 Vali Acc: 0.849 Test Loss: 0.388 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 14 cost time: 3.410382032394409
Epoch: 14, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.377 Vali Acc: 0.836 Test Loss: 0.377 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.067424774169922
Epoch: 15, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.374 Vali Acc: 0.842 Test Loss: 0.374 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9957380294799805
Epoch: 16, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.483 Vali Acc: 0.816 Test Loss: 0.483 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.365219831466675
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.426 Vali Acc: 0.822 Test Loss: 0.426 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.2077996730804443
Epoch: 18, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.399 Vali Acc: 0.842 Test Loss: 0.399 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.155965566635132
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.427 Vali Acc: 0.849 Test Loss: 0.427 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.139650821685791
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.450 Vali Acc: 0.849 Test Loss: 0.450 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.2894482612609863
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.498 Vali Acc: 0.842 Test Loss: 0.498 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.2763442993164062
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.494 Vali Acc: 0.836 Test Loss: 0.494 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.256639003753662
Epoch: 23, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.521 Vali Acc: 0.842 Test Loss: 0.521 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 4692740
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.41094183921814
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.382 Vali Acc: 0.349 Test Loss: 1.382 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 2.370072603225708
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.297 Vali Acc: 0.454 Test Loss: 1.297 Test Acc: 0.454
Validation loss decreased (-0.348670 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 2.4386892318725586
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.206 Vali Acc: 0.572 Test Loss: 1.206 Test Acc: 0.572
Validation loss decreased (-0.453934 --> -0.572356).  Saving model ...
Epoch: 4 cost time: 2.412889003753662
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.572356 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 2.3258237838745117
Epoch: 5, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.018 Vali Acc: 0.697 Test Loss: 1.018 Test Acc: 0.697
Validation loss decreased (-0.624989 --> -0.697358).  Saving model ...
Epoch: 6 cost time: 2.252967357635498
Epoch: 6, Steps: 10 | Train Loss: 0.892 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
Validation loss decreased (-0.697358 --> -0.717096).  Saving model ...
Epoch: 7 cost time: 2.072748899459839
Epoch: 7, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.809 Vali Acc: 0.763 Test Loss: 0.809 Test Acc: 0.763
Validation loss decreased (-0.717096 --> -0.763150).  Saving model ...
Epoch: 8 cost time: 2.4058821201324463
Epoch: 8, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.707 Vali Acc: 0.796 Test Loss: 0.707 Test Acc: 0.796
Validation loss decreased (-0.763150 --> -0.796046).  Saving model ...
Epoch: 9 cost time: 1.749727487564087
Epoch: 9, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
Epoch: 10 cost time: 2.302342653274536
Epoch: 10, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
Validation loss decreased (-0.809204 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 2.1339409351348877
Epoch: 11, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.142157554626465
Epoch: 12, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1509602069854736
Epoch: 13, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.428 Vali Acc: 0.822 Test Loss: 0.428 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 14 cost time: 2.3619914054870605
Epoch: 14, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.399 Vali Acc: 0.842 Test Loss: 0.399 Test Acc: 0.842
Validation loss decreased (-0.822364 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 2.4729762077331543
Epoch: 15, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.383 Vali Acc: 0.842 Test Loss: 0.383 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 16 cost time: 2.2321860790252686
Epoch: 16, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.364 Vali Acc: 0.855 Test Loss: 0.364 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855260).  Saving model ...
Epoch: 17 cost time: 2.3838815689086914
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.366 Vali Acc: 0.868 Test Loss: 0.366 Test Acc: 0.868
Validation loss decreased (-0.855260 --> -0.868417).  Saving model ...
Epoch: 18 cost time: 2.237349033355713
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 1.7851078510284424
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.350 Vali Acc: 0.868 Test Loss: 0.350 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.54890775680542
Epoch: 20, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 2.0225441455841064
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.352 Vali Acc: 0.882 Test Loss: 0.352 Test Acc: 0.882
Validation loss decreased (-0.874997 --> -0.881575).  Saving model ...
Epoch: 22 cost time: 2.499831199645996
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1932132244110107
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.362 Vali Acc: 0.868 Test Loss: 0.362 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.208618402481079
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.338542938232422
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.342 Vali Acc: 0.862 Test Loss: 0.342 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1775879859924316
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.356 Vali Acc: 0.882 Test Loss: 0.356 Test Acc: 0.882
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.219306468963623
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.358 Vali Acc: 0.868 Test Loss: 0.358 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2505578994750977
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.396 Vali Acc: 0.868 Test Loss: 0.396 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3901562690734863
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.572540521621704
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.384 Vali Acc: 0.868 Test Loss: 0.384 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 1382404
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.6391541957855225
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.408 Vali Acc: 0.250 Test Loss: 1.408 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.667410373687744
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.345 Vali Acc: 0.362 Test Loss: 1.345 Test Acc: 0.362
Validation loss decreased (-0.249986 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 2.6778786182403564
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.266 Vali Acc: 0.474 Test Loss: 1.266 Test Acc: 0.474
Validation loss decreased (-0.361829 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 2.702786684036255
Epoch: 4, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.177 Vali Acc: 0.605 Test Loss: 1.177 Test Acc: 0.605
Validation loss decreased (-0.473672 --> -0.605251).  Saving model ...
Epoch: 5 cost time: 2.623297929763794
Epoch: 5, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.078 Vali Acc: 0.678 Test Loss: 1.078 Test Acc: 0.678
Validation loss decreased (-0.605251 --> -0.677621).  Saving model ...
Epoch: 6 cost time: 2.373574733734131
Epoch: 6, Steps: 10 | Train Loss: 0.963 Vali Loss: 0.969 Vali Acc: 0.743 Test Loss: 0.969 Test Acc: 0.743
Validation loss decreased (-0.677621 --> -0.743411).  Saving model ...
Epoch: 7 cost time: 2.3810033798217773
Epoch: 7, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.865 Vali Acc: 0.783 Test Loss: 0.865 Test Acc: 0.783
Validation loss decreased (-0.743411 --> -0.782886).  Saving model ...
Epoch: 8 cost time: 2.8476641178131104
Epoch: 8, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.758 Vali Acc: 0.809 Test Loss: 0.758 Test Acc: 0.809
Validation loss decreased (-0.782886 --> -0.809203).  Saving model ...
Epoch: 9 cost time: 2.8070404529571533
Epoch: 9, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.655 Vali Acc: 0.829 Test Loss: 0.655 Test Acc: 0.829
Validation loss decreased (-0.809203 --> -0.828941).  Saving model ...
Epoch: 10 cost time: 3.0350353717803955
Epoch: 10, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.577 Vali Acc: 0.829 Test Loss: 0.577 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828942).  Saving model ...
Epoch: 11 cost time: 2.8502731323242188
Epoch: 11, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.516 Vali Acc: 0.836 Test Loss: 0.516 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 12 cost time: 2.9961812496185303
Epoch: 12, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
Validation loss decreased (-0.835521 --> -0.861837).  Saving model ...
Epoch: 13 cost time: 2.8513331413269043
Epoch: 13, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.434 Vali Acc: 0.849 Test Loss: 0.434 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.558112382888794
Epoch: 14, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861838).  Saving model ...
Epoch: 15 cost time: 2.8616185188293457
Epoch: 15, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.380 Vali Acc: 0.875 Test Loss: 0.380 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 16 cost time: 2.033362627029419
Epoch: 16, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.371 Vali Acc: 0.855 Test Loss: 0.371 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.06931471824646
Epoch: 17, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.353 Vali Acc: 0.862 Test Loss: 0.353 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6755609512329102
Epoch: 18, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.354 Vali Acc: 0.882 Test Loss: 0.354 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881575).  Saving model ...
Epoch: 19 cost time: 2.0232696533203125
Epoch: 19, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.352 Vali Acc: 0.849 Test Loss: 0.352 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4964497089385986
Epoch: 20, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.342 Vali Acc: 0.849 Test Loss: 0.342 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.423663854598999
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.350 Vali Acc: 0.855 Test Loss: 0.350 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.595975875854492
Epoch: 22, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.348 Vali Acc: 0.842 Test Loss: 0.348 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6582157611846924
Epoch: 23, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7813034057617188
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.360 Vali Acc: 0.855 Test Loss: 0.360 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7838332653045654
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.369 Vali Acc: 0.836 Test Loss: 0.369 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7519943714141846
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.747366428375244
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.378 Vali Acc: 0.849 Test Loss: 0.378 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7481541633605957
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 4692740
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.01196813583374
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.374 Vali Acc: 0.349 Test Loss: 1.374 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.7749545574188232
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.301 Vali Acc: 0.454 Test Loss: 1.301 Test Acc: 0.454
Validation loss decreased (-0.348670 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.8340728282928467
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.219 Vali Acc: 0.572 Test Loss: 1.219 Test Acc: 0.572
Validation loss decreased (-0.453934 --> -0.572356).  Saving model ...
Epoch: 4 cost time: 1.632272481918335
Epoch: 4, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.139 Vali Acc: 0.632 Test Loss: 1.139 Test Acc: 0.632
Validation loss decreased (-0.572356 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 2.1195881366729736
Epoch: 5, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.058 Vali Acc: 0.678 Test Loss: 1.058 Test Acc: 0.678
Validation loss decreased (-0.631568 --> -0.677621).  Saving model ...
Epoch: 6 cost time: 2.141498327255249
Epoch: 6, Steps: 10 | Train Loss: 0.965 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
Validation loss decreased (-0.677621 --> -0.717096).  Saving model ...
Epoch: 7 cost time: 1.8629186153411865
Epoch: 7, Steps: 10 | Train Loss: 0.907 Vali Loss: 0.880 Vali Acc: 0.724 Test Loss: 0.880 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 8 cost time: 2.3225290775299072
Epoch: 8, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.723675 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 2.1201093196868896
Epoch: 9, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.703 Vali Acc: 0.776 Test Loss: 0.703 Test Acc: 0.776
Validation loss decreased (-0.749992 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 2.0629966259002686
Epoch: 10, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 11 cost time: 2.309255599975586
Epoch: 11, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
Validation loss decreased (-0.782888 --> -0.822363).  Saving model ...
Epoch: 12 cost time: 2.0924055576324463
Epoch: 12, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.523 Vali Acc: 0.829 Test Loss: 0.523 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 13 cost time: 2.2294626235961914
Epoch: 13, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.472 Vali Acc: 0.842 Test Loss: 0.472 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842101).  Saving model ...
Epoch: 14 cost time: 2.0935022830963135
Epoch: 14, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 15 cost time: 2.1400952339172363
Epoch: 15, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 16 cost time: 2.21290922164917
Epoch: 16, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 17 cost time: 1.9667389392852783
Epoch: 17, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 2.184983730316162
Epoch: 18, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.372 Vali Acc: 0.868 Test Loss: 0.372 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1559500694274902
Epoch: 19, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.354 Vali Acc: 0.868 Test Loss: 0.354 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.080742597579956
Epoch: 20, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.340 Vali Acc: 0.868 Test Loss: 0.340 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1987392902374268
Epoch: 21, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.340 Vali Acc: 0.849 Test Loss: 0.340 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.097639799118042
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.330 Vali Acc: 0.855 Test Loss: 0.330 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.074389696121216
Epoch: 23, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.331 Vali Acc: 0.882 Test Loss: 0.331 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881576).  Saving model ...
Epoch: 24 cost time: 1.9886152744293213
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.326 Vali Acc: 0.855 Test Loss: 0.326 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1068296432495117
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.333 Vali Acc: 0.849 Test Loss: 0.333 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.933664083480835
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.332 Vali Acc: 0.855 Test Loss: 0.332 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.16117525100708
Epoch: 27, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.325 Vali Acc: 0.849 Test Loss: 0.325 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2285470962524414
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.1113033294677734
Epoch: 29, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.323 Vali Acc: 0.862 Test Loss: 0.323 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.065847158432007
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.332 Vali Acc: 0.862 Test Loss: 0.332 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 1382404
model size : 5.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 10.065465927124023
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 8.014742374420166
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.337 Vali Acc: 0.303 Test Loss: 1.337 Test Acc: 0.303
Validation loss decreased (-0.269723 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 8.141839504241943
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.262 Vali Acc: 0.336 Test Loss: 1.262 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335514).  Saving model ...
Epoch: 4 cost time: 9.25636911392212
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.167 Vali Acc: 0.441 Test Loss: 1.167 Test Acc: 0.441
Validation loss decreased (-0.335514 --> -0.440778).  Saving model ...
Epoch: 5 cost time: 9.151182889938354
Epoch: 5, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.063 Vali Acc: 0.605 Test Loss: 1.063 Test Acc: 0.605
Validation loss decreased (-0.440778 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 8.019917249679565
Epoch: 6, Steps: 10 | Train Loss: 0.895 Vali Loss: 0.938 Vali Acc: 0.704 Test Loss: 0.938 Test Acc: 0.704
Validation loss decreased (-0.605253 --> -0.703938).  Saving model ...
Epoch: 7 cost time: 8.74347472190857
Epoch: 7, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.804 Vali Acc: 0.763 Test Loss: 0.804 Test Acc: 0.763
Validation loss decreased (-0.703938 --> -0.763150).  Saving model ...
Epoch: 8 cost time: 7.78268575668335
Epoch: 8, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
Validation loss decreased (-0.763150 --> -0.789467).  Saving model ...
Epoch: 9 cost time: 8.45261812210083
Epoch: 9, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 8.472535371780396
Epoch: 10, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809206).  Saving model ...
Epoch: 11 cost time: 9.072641611099243
Epoch: 11, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 12 cost time: 8.475346565246582
Epoch: 12, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.439831972122192
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.431 Vali Acc: 0.836 Test Loss: 0.431 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 14 cost time: 7.901306390762329
Epoch: 14, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.424 Vali Acc: 0.822 Test Loss: 0.424 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.42116379737854
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.420 Vali Acc: 0.836 Test Loss: 0.420 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 16 cost time: 6.7246599197387695
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.320864677429199
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.418855905532837
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.989468574523926
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.574 Vali Acc: 0.842 Test Loss: 0.574 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842100).  Saving model ...
Epoch: 20 cost time: 9.03357458114624
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.624 Vali Acc: 0.829 Test Loss: 0.624 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.43255090713501
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.755577564239502
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.6873939037323
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.685 Vali Acc: 0.816 Test Loss: 0.685 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.671952724456787
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.759 Vali Acc: 0.809 Test Loss: 0.759 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 9.308496236801147
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 9.26485562324524
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.561103343963623
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.715 Vali Acc: 0.816 Test Loss: 0.715 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.021605491638184
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.726 Vali Acc: 0.816 Test Loss: 0.726 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.969661235809326
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 2349060
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.633410453796387
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.420 Vali Acc: 0.230 Test Loss: 1.420 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 4.734256029129028
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.371 Vali Acc: 0.283 Test Loss: 1.371 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 4.789583683013916
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.304 Vali Acc: 0.388 Test Loss: 1.304 Test Acc: 0.388
Validation loss decreased (-0.282881 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 4.887730360031128
Epoch: 4, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
Validation loss decreased (-0.388145 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 5.131870269775391
Epoch: 5, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.142 Vali Acc: 0.586 Test Loss: 1.142 Test Acc: 0.586
Validation loss decreased (-0.467093 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 4.715734958648682
Epoch: 6, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.048 Vali Acc: 0.664 Test Loss: 1.048 Test Acc: 0.664
Validation loss decreased (-0.585515 --> -0.664463).  Saving model ...
Epoch: 7 cost time: 4.407076597213745
Epoch: 7, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.944 Vali Acc: 0.717 Test Loss: 0.944 Test Acc: 0.717
Validation loss decreased (-0.664463 --> -0.717096).  Saving model ...
Epoch: 8 cost time: 4.482506990432739
Epoch: 8, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.829 Vali Acc: 0.776 Test Loss: 0.829 Test Acc: 0.776
Validation loss decreased (-0.717096 --> -0.776307).  Saving model ...
Epoch: 9 cost time: 4.644103527069092
Epoch: 9, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.718 Vali Acc: 0.829 Test Loss: 0.718 Test Acc: 0.829
Validation loss decreased (-0.776307 --> -0.828940).  Saving model ...
Epoch: 10 cost time: 4.953272342681885
Epoch: 10, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.621 Vali Acc: 0.836 Test Loss: 0.621 Test Acc: 0.836
Validation loss decreased (-0.828940 --> -0.835520).  Saving model ...
Epoch: 11 cost time: 4.639308929443359
Epoch: 11, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.540 Vali Acc: 0.849 Test Loss: 0.540 Test Acc: 0.849
Validation loss decreased (-0.835520 --> -0.848679).  Saving model ...
Epoch: 12 cost time: 4.748845338821411
Epoch: 12, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855258).  Saving model ...
Epoch: 13 cost time: 4.693836212158203
Epoch: 13, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.433 Vali Acc: 0.849 Test Loss: 0.433 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.971597671508789
Epoch: 14, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855259).  Saving model ...
Epoch: 15 cost time: 3.2146739959716797
Epoch: 15, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 16 cost time: 3.5820488929748535
Epoch: 16, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 17 cost time: 5.453288793563843
Epoch: 17, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 18 cost time: 5.261216402053833
Epoch: 18, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 5.018542289733887
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.423126935958862
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.398 Vali Acc: 0.875 Test Loss: 0.398 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.513884544372559
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.45538854598999
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.956410646438599
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.794934272766113
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.230661630630493
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.480 Vali Acc: 0.868 Test Loss: 0.480 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.1858906745910645
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.477 Vali Acc: 0.868 Test Loss: 0.477 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.2470948696136475
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.397932767868042
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.485 Vali Acc: 0.875 Test Loss: 0.485 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 693764
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 9.399292469024658
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 7.104827165603638
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.341 Vali Acc: 0.309 Test Loss: 1.341 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 6.098440647125244
Epoch: 3, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.271 Vali Acc: 0.329 Test Loss: 1.271 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328935).  Saving model ...
Epoch: 4 cost time: 6.667598009109497
Epoch: 4, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.184 Vali Acc: 0.441 Test Loss: 1.184 Test Acc: 0.441
Validation loss decreased (-0.328935 --> -0.440778).  Saving model ...
Epoch: 5 cost time: 6.199711799621582
Epoch: 5, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.090 Vali Acc: 0.579 Test Loss: 1.090 Test Acc: 0.579
Validation loss decreased (-0.440778 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 6.602415084838867
Epoch: 6, Steps: 10 | Train Loss: 0.968 Vali Loss: 0.980 Vali Acc: 0.678 Test Loss: 0.980 Test Acc: 0.678
Validation loss decreased (-0.578936 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 6.405130863189697
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.858 Vali Acc: 0.730 Test Loss: 0.858 Test Acc: 0.730
Validation loss decreased (-0.677622 --> -0.730255).  Saving model ...
Epoch: 8 cost time: 6.492750644683838
Epoch: 8, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.737 Vali Acc: 0.796 Test Loss: 0.737 Test Acc: 0.796
Validation loss decreased (-0.730255 --> -0.796045).  Saving model ...
Epoch: 9 cost time: 6.73496413230896
Epoch: 9, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
Validation loss decreased (-0.796045 --> -0.809204).  Saving model ...
Epoch: 10 cost time: 6.619316339492798
Epoch: 10, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 6.681181907653809
Epoch: 11, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 12 cost time: 6.790295124053955
Epoch: 12, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.445 Vali Acc: 0.829 Test Loss: 0.445 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 13 cost time: 6.772413730621338
Epoch: 13, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.416 Vali Acc: 0.829 Test Loss: 0.416 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 14 cost time: 6.559492588043213
Epoch: 14, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.402 Vali Acc: 0.836 Test Loss: 0.402 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 15 cost time: 6.578243970870972
Epoch: 15, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.389 Vali Acc: 0.842 Test Loss: 0.389 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 16 cost time: 6.57887601852417
Epoch: 16, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.398 Vali Acc: 0.836 Test Loss: 0.398 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.595334529876709
Epoch: 17, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.425 Vali Acc: 0.822 Test Loss: 0.425 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.536545515060425
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.436 Vali Acc: 0.849 Test Loss: 0.436 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 19 cost time: 7.131199598312378
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.987545967102051
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855258).  Saving model ...
Epoch: 21 cost time: 6.670114278793335
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.474 Vali Acc: 0.849 Test Loss: 0.474 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.717374563217163
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.507 Vali Acc: 0.849 Test Loss: 0.507 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.141054153442383
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.6490960121154785
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.478 Vali Acc: 0.849 Test Loss: 0.478 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.263985872268677
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.388582944869995
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.509 Vali Acc: 0.862 Test Loss: 0.509 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861837).  Saving model ...
Epoch: 27 cost time: 6.6578779220581055
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.553 Vali Acc: 0.862 Test Loss: 0.553 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.813254117965698
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.550 Vali Acc: 0.842 Test Loss: 0.550 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.670367956161499
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.543 Vali Acc: 0.862 Test Loss: 0.543 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.790232181549072
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 2349060
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.249770879745483
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.419 Vali Acc: 0.217 Test Loss: 1.419 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 3.9648261070251465
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.373 Vali Acc: 0.289 Test Loss: 1.373 Test Acc: 0.289
Validation loss decreased (-0.217091 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 3.8270413875579834
Epoch: 3, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.310 Vali Acc: 0.375 Test Loss: 1.310 Test Acc: 0.375
Validation loss decreased (-0.289460 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 4.174909353256226
Epoch: 4, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.243 Vali Acc: 0.454 Test Loss: 1.243 Test Acc: 0.454
Validation loss decreased (-0.374987 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 3.8686249256134033
Epoch: 5, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.161 Vali Acc: 0.546 Test Loss: 1.161 Test Acc: 0.546
Validation loss decreased (-0.453935 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 4.016552925109863
Epoch: 6, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.076 Vali Acc: 0.645 Test Loss: 1.076 Test Acc: 0.645
Validation loss decreased (-0.546041 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 4.094351053237915
Epoch: 7, Steps: 10 | Train Loss: 0.926 Vali Loss: 0.983 Vali Acc: 0.691 Test Loss: 0.983 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 4.006767272949219
Epoch: 8, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.878 Vali Acc: 0.789 Test Loss: 0.878 Test Acc: 0.789
Validation loss decreased (-0.690780 --> -0.789465).  Saving model ...
Epoch: 9 cost time: 4.431466579437256
Epoch: 9, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.772 Vali Acc: 0.803 Test Loss: 0.772 Test Acc: 0.803
Validation loss decreased (-0.789465 --> -0.802624).  Saving model ...
Epoch: 10 cost time: 4.195892333984375
Epoch: 10, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.673 Vali Acc: 0.829 Test Loss: 0.673 Test Acc: 0.829
Validation loss decreased (-0.802624 --> -0.828941).  Saving model ...
Epoch: 11 cost time: 4.215173959732056
Epoch: 11, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.588 Vali Acc: 0.829 Test Loss: 0.588 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828941).  Saving model ...
Epoch: 12 cost time: 4.189752101898193
Epoch: 12, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.521 Vali Acc: 0.849 Test Loss: 0.521 Test Acc: 0.849
Validation loss decreased (-0.828941 --> -0.848679).  Saving model ...
Epoch: 13 cost time: 4.091050386428833
Epoch: 13, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
Validation loss decreased (-0.848679 --> -0.861837).  Saving model ...
Epoch: 14 cost time: 4.160098075866699
Epoch: 14, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.436 Vali Acc: 0.868 Test Loss: 0.436 Test Acc: 0.868
Validation loss decreased (-0.861837 --> -0.868417).  Saving model ...
Epoch: 15 cost time: 4.054811477661133
Epoch: 15, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.401 Vali Acc: 0.882 Test Loss: 0.401 Test Acc: 0.882
Validation loss decreased (-0.868417 --> -0.881575).  Saving model ...
Epoch: 16 cost time: 4.053541660308838
Epoch: 16, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.730088472366333
Epoch: 17, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.367 Vali Acc: 0.888 Test Loss: 0.367 Test Acc: 0.888
Validation loss decreased (-0.881575 --> -0.888154).  Saving model ...
Epoch: 18 cost time: 4.013717889785767
Epoch: 18, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7707910537719727
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.356 Vali Acc: 0.875 Test Loss: 0.356 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.054402589797974
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.354 Vali Acc: 0.888 Test Loss: 0.354 Test Acc: 0.888
Validation loss decreased (-0.888154 --> -0.888154).  Saving model ...
Epoch: 21 cost time: 4.124492883682251
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.390 Vali Acc: 0.868 Test Loss: 0.390 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.899013042449951
Epoch: 22, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.508737564086914
Epoch: 23, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.403 Vali Acc: 0.868 Test Loss: 0.403 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.336616039276123
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.432528257369995
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.416 Vali Acc: 0.868 Test Loss: 0.416 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.3635077476501465
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.356496572494507
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.457 Vali Acc: 0.862 Test Loss: 0.457 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.450709819793701
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.328097581863403
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.288201332092285
Epoch: 30, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 693764
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.942859888076782
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.400 Vali Acc: 0.263 Test Loss: 1.400 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 4.054330348968506
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.353 Vali Acc: 0.303 Test Loss: 1.353 Test Acc: 0.303
Validation loss decreased (-0.263144 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 4.332299470901489
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.294 Vali Acc: 0.316 Test Loss: 1.294 Test Acc: 0.316
Validation loss decreased (-0.302618 --> -0.315777).  Saving model ...
Epoch: 4 cost time: 4.045135974884033
Epoch: 4, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.218 Vali Acc: 0.395 Test Loss: 1.218 Test Acc: 0.395
Validation loss decreased (-0.315777 --> -0.394725).  Saving model ...
Epoch: 5 cost time: 4.442570209503174
Epoch: 5, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.133 Vali Acc: 0.553 Test Loss: 1.133 Test Acc: 0.553
Validation loss decreased (-0.394725 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 4.202984571456909
Epoch: 6, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.038 Vali Acc: 0.664 Test Loss: 1.038 Test Acc: 0.664
Validation loss decreased (-0.552620 --> -0.664463).  Saving model ...
Epoch: 7 cost time: 4.2387847900390625
Epoch: 7, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.939 Vali Acc: 0.704 Test Loss: 0.939 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703938).  Saving model ...
Epoch: 8 cost time: 4.213616609573364
Epoch: 8, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.831 Vali Acc: 0.763 Test Loss: 0.831 Test Acc: 0.763
Validation loss decreased (-0.703938 --> -0.763150).  Saving model ...
Epoch: 9 cost time: 4.127931118011475
Epoch: 9, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782887).  Saving model ...
Epoch: 10 cost time: 4.441927671432495
Epoch: 10, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802625).  Saving model ...
Epoch: 11 cost time: 4.07720685005188
Epoch: 11, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 3.5524611473083496
Epoch: 12, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.507 Vali Acc: 0.836 Test Loss: 0.507 Test Acc: 0.836
Validation loss decreased (-0.809205 --> -0.835521).  Saving model ...
Epoch: 13 cost time: 3.120194911956787
Epoch: 13, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.060281991958618
Epoch: 14, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.427 Vali Acc: 0.842 Test Loss: 0.427 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 3.8169777393341064
Epoch: 15, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.401 Vali Acc: 0.849 Test Loss: 0.401 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 16 cost time: 3.7921435832977295
Epoch: 16, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.946608781814575
Epoch: 17, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.380 Vali Acc: 0.842 Test Loss: 0.380 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5793495178222656
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.367 Vali Acc: 0.855 Test Loss: 0.367 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 19 cost time: 4.170179843902588
Epoch: 19, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.358 Vali Acc: 0.849 Test Loss: 0.358 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.297273397445679
Epoch: 20, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.366 Vali Acc: 0.836 Test Loss: 0.366 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.3806984424591064
Epoch: 21, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.383 Vali Acc: 0.836 Test Loss: 0.383 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.403375864028931
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.339979410171509
Epoch: 23, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.379 Vali Acc: 0.829 Test Loss: 0.379 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.264562129974365
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.365 Vali Acc: 0.829 Test Loss: 0.365 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.2113940715789795
Epoch: 25, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.385 Vali Acc: 0.836 Test Loss: 0.385 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.02625846862793
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.392 Vali Acc: 0.849 Test Loss: 0.392 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.837986707687378
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.407 Vali Acc: 0.849 Test Loss: 0.407 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.212732791900635
Epoch: 28, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 29 cost time: 4.1824798583984375
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 30 cost time: 4.135914325714111
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 2349060
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5776617527008057
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.424 Vali Acc: 0.243 Test Loss: 1.424 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.1378936767578125
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.382 Vali Acc: 0.283 Test Loss: 1.382 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.8268375396728516
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
Validation loss decreased (-0.282881 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 2.746741533279419
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.262 Vali Acc: 0.454 Test Loss: 1.262 Test Acc: 0.454
Validation loss decreased (-0.374987 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 2.7326865196228027
Epoch: 5, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.189 Vali Acc: 0.526 Test Loss: 1.189 Test Acc: 0.526
Validation loss decreased (-0.453935 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 2.8983943462371826
Epoch: 6, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.114 Vali Acc: 0.612 Test Loss: 1.114 Test Acc: 0.612
Validation loss decreased (-0.526304 --> -0.611831).  Saving model ...
Epoch: 7 cost time: 2.707759141921997
Epoch: 7, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.034 Vali Acc: 0.645 Test Loss: 1.034 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 2.577237844467163
Epoch: 8, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.946 Vali Acc: 0.704 Test Loss: 0.946 Test Acc: 0.704
Validation loss decreased (-0.644727 --> -0.703938).  Saving model ...
Epoch: 9 cost time: 2.5184500217437744
Epoch: 9, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.858 Vali Acc: 0.737 Test Loss: 0.858 Test Acc: 0.737
Validation loss decreased (-0.703938 --> -0.736834).  Saving model ...
Epoch: 10 cost time: 2.7753946781158447
Epoch: 10, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.772 Vali Acc: 0.783 Test Loss: 0.772 Test Acc: 0.783
Validation loss decreased (-0.736834 --> -0.782887).  Saving model ...
Epoch: 11 cost time: 2.767641544342041
Epoch: 11, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
Validation loss decreased (-0.782887 --> -0.822362).  Saving model ...
Epoch: 12 cost time: 2.601651906967163
Epoch: 12, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.613 Vali Acc: 0.829 Test Loss: 0.613 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 13 cost time: 2.97306752204895
Epoch: 13, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.542 Vali Acc: 0.829 Test Loss: 0.542 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828942).  Saving model ...
Epoch: 14 cost time: 2.6176748275756836
Epoch: 14, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.492 Vali Acc: 0.849 Test Loss: 0.492 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848679).  Saving model ...
Epoch: 15 cost time: 2.6741015911102295
Epoch: 15, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.452 Vali Acc: 0.842 Test Loss: 0.452 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.762235403060913
Epoch: 16, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.414 Vali Acc: 0.868 Test Loss: 0.414 Test Acc: 0.868
Validation loss decreased (-0.848679 --> -0.868417).  Saving model ...
Epoch: 17 cost time: 2.8921546936035156
Epoch: 17, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 2.562222957611084
Epoch: 18, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.365 Vali Acc: 0.868 Test Loss: 0.365 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8158798217773438
Epoch: 19, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.364 Vali Acc: 0.868 Test Loss: 0.364 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8709259033203125
Epoch: 20, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 21 cost time: 2.578508138656616
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.342 Vali Acc: 0.868 Test Loss: 0.342 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.564413547515869
Epoch: 22, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.337 Vali Acc: 0.862 Test Loss: 0.337 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7982633113861084
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.330 Vali Acc: 0.868 Test Loss: 0.330 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7251241207122803
Epoch: 24, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.327 Vali Acc: 0.875 Test Loss: 0.327 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 25 cost time: 2.7186591625213623
Epoch: 25, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.928375244140625
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.324 Vali Acc: 0.855 Test Loss: 0.324 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7540316581726074
Epoch: 27, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.332 Vali Acc: 0.855 Test Loss: 0.332 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.6106643676757812
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.333 Vali Acc: 0.849 Test Loss: 0.333 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.709204912185669
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.551254987716675
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.331 Vali Acc: 0.862 Test Loss: 0.331 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 693764
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.4548020362854
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.363 Vali Acc: 0.303 Test Loss: 1.363 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 3.493699312210083
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.325 Vali Acc: 0.362 Test Loss: 1.325 Test Acc: 0.362
Validation loss decreased (-0.302618 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 3.7053511142730713
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.273 Vali Acc: 0.428 Test Loss: 1.273 Test Acc: 0.428
Validation loss decreased (-0.361829 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 3.573613166809082
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.213 Vali Acc: 0.526 Test Loss: 1.213 Test Acc: 0.526
Validation loss decreased (-0.427619 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 3.4948294162750244
Epoch: 5, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.148 Vali Acc: 0.586 Test Loss: 1.148 Test Acc: 0.586
Validation loss decreased (-0.526304 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 3.559643507003784
Epoch: 6, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.071 Vali Acc: 0.651 Test Loss: 1.071 Test Acc: 0.651
Validation loss decreased (-0.585515 --> -0.651305).  Saving model ...
Epoch: 7 cost time: 3.6031949520111084
Epoch: 7, Steps: 10 | Train Loss: 0.989 Vali Loss: 0.991 Vali Acc: 0.678 Test Loss: 0.991 Test Acc: 0.678
Validation loss decreased (-0.651305 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 3.417738914489746
Epoch: 8, Steps: 10 | Train Loss: 0.893 Vali Loss: 0.906 Vali Acc: 0.691 Test Loss: 0.906 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 9 cost time: 3.5113072395324707
Epoch: 9, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.816 Vali Acc: 0.724 Test Loss: 0.816 Test Acc: 0.724
Validation loss decreased (-0.690780 --> -0.723676).  Saving model ...
Epoch: 10 cost time: 3.550419330596924
Epoch: 10, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.733 Vali Acc: 0.743 Test Loss: 0.733 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743414).  Saving model ...
Epoch: 11 cost time: 3.627737283706665
Epoch: 11, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.664 Vali Acc: 0.789 Test Loss: 0.664 Test Acc: 0.789
Validation loss decreased (-0.743414 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 3.4146640300750732
Epoch: 12, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.587 Vali Acc: 0.829 Test Loss: 0.587 Test Acc: 0.829
Validation loss decreased (-0.789467 --> -0.828941).  Saving model ...
Epoch: 13 cost time: 3.576606512069702
Epoch: 13, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7967145442962646
Epoch: 14, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9933013916015625
Epoch: 15, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.629762887954712
Epoch: 16, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
Validation loss decreased (-0.828941 --> -0.855259).  Saving model ...
Epoch: 17 cost time: 3.7220325469970703
Epoch: 17, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8349602222442627
Epoch: 18, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 19 cost time: 4.056022644042969
Epoch: 19, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.437 Vali Acc: 0.822 Test Loss: 0.437 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6519391536712646
Epoch: 20, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.425328493118286
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.454 Vali Acc: 0.842 Test Loss: 0.454 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.836801052093506
Epoch: 22, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 23 cost time: 4.010679483413696
Epoch: 23, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.416 Vali Acc: 0.868 Test Loss: 0.416 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 24 cost time: 3.4784023761749268
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3091821670532227
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0506436824798584
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.792282819747925
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.7614192962646484
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.553 Vali Acc: 0.849 Test Loss: 0.553 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.603504180908203
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.591 Vali Acc: 0.836 Test Loss: 0.591 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.147459983825684
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.609 Vali Acc: 0.836 Test Loss: 0.609 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 2347140
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.383311986923218
Epoch: 1, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.426 Vali Acc: 0.289 Test Loss: 1.426 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 2.373588800430298
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.383 Vali Acc: 0.329 Test Loss: 1.383 Test Acc: 0.329
Validation loss decreased (-0.289459 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 2.657440423965454
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.328 Vali Acc: 0.401 Test Loss: 1.328 Test Acc: 0.401
Validation loss decreased (-0.328934 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 2.4491028785705566
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.266 Vali Acc: 0.454 Test Loss: 1.266 Test Acc: 0.454
Validation loss decreased (-0.401303 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 2.400519609451294
Epoch: 5, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.198 Vali Acc: 0.487 Test Loss: 1.198 Test Acc: 0.487
Validation loss decreased (-0.453935 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 2.3681862354278564
Epoch: 6, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.127 Vali Acc: 0.539 Test Loss: 1.127 Test Acc: 0.539
Validation loss decreased (-0.486830 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 2.4940080642700195
Epoch: 7, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.051 Vali Acc: 0.599 Test Loss: 1.051 Test Acc: 0.599
Validation loss decreased (-0.539462 --> -0.598674).  Saving model ...
Epoch: 8 cost time: 2.4580490589141846
Epoch: 8, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.965 Vali Acc: 0.651 Test Loss: 0.965 Test Acc: 0.651
Validation loss decreased (-0.598674 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 2.3279197216033936
Epoch: 9, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.876 Vali Acc: 0.730 Test Loss: 0.876 Test Acc: 0.730
Validation loss decreased (-0.651306 --> -0.730254).  Saving model ...
Epoch: 10 cost time: 2.369046926498413
Epoch: 10, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.779 Vali Acc: 0.770 Test Loss: 0.779 Test Acc: 0.770
Validation loss decreased (-0.730254 --> -0.769729).  Saving model ...
Epoch: 11 cost time: 2.413252353668213
Epoch: 11, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.697 Vali Acc: 0.770 Test Loss: 0.697 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 2.443084478378296
Epoch: 12, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 13 cost time: 2.5458011627197266
Epoch: 13, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.782888 --> -0.822363).  Saving model ...
Epoch: 14 cost time: 2.4172463417053223
Epoch: 14, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.448261022567749
Epoch: 15, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5814054012298584
Epoch: 16, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4451751708984375
Epoch: 17, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.456007242202759
Epoch: 18, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.434 Vali Acc: 0.822 Test Loss: 0.434 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 19 cost time: 2.3879685401916504
Epoch: 19, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 20 cost time: 2.474614381790161
Epoch: 20, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.397 Vali Acc: 0.816 Test Loss: 0.397 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5183966159820557
Epoch: 21, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.398 Vali Acc: 0.836 Test Loss: 0.398 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 22 cost time: 2.298635721206665
Epoch: 22, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.409 Vali Acc: 0.829 Test Loss: 0.409 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2597498893737793
Epoch: 23, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.390 Vali Acc: 0.829 Test Loss: 0.390 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.327308177947998
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.389 Vali Acc: 0.829 Test Loss: 0.389 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3706488609313965
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.402 Vali Acc: 0.836 Test Loss: 0.402 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3327932357788086
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.406 Vali Acc: 0.822 Test Loss: 0.406 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3580315113067627
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.405 Vali Acc: 0.829 Test Loss: 0.405 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2098445892333984
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.412 Vali Acc: 0.842 Test Loss: 0.412 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 29 cost time: 2.403576135635376
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.417 Vali Acc: 0.829 Test Loss: 0.417 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5286433696746826
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 691716
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.973731994628906
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.365 Vali Acc: 0.309 Test Loss: 1.365 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.83358097076416
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 2.798560857772827
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.281 Vali Acc: 0.414 Test Loss: 1.281 Test Acc: 0.414
Validation loss decreased (-0.374987 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 2.8326947689056396
Epoch: 4, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.228 Vali Acc: 0.507 Test Loss: 1.228 Test Acc: 0.507
Validation loss decreased (-0.414461 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 2.9796864986419678
Epoch: 5, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.170 Vali Acc: 0.546 Test Loss: 1.170 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 2.7347376346588135
Epoch: 6, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.100 Vali Acc: 0.625 Test Loss: 1.100 Test Acc: 0.625
Validation loss decreased (-0.546041 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 2.511009931564331
Epoch: 7, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.026 Vali Acc: 0.638 Test Loss: 1.026 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638148).  Saving model ...
Epoch: 8 cost time: 2.587031841278076
Epoch: 8, Steps: 10 | Train Loss: 0.944 Vali Loss: 0.942 Vali Acc: 0.704 Test Loss: 0.942 Test Acc: 0.704
Validation loss decreased (-0.638148 --> -0.703938).  Saving model ...
Epoch: 9 cost time: 2.7251038551330566
Epoch: 9, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.858 Vali Acc: 0.743 Test Loss: 0.858 Test Acc: 0.743
Validation loss decreased (-0.703938 --> -0.743412).  Saving model ...
Epoch: 10 cost time: 2.8671555519104004
Epoch: 10, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.776 Vali Acc: 0.737 Test Loss: 0.776 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0159428119659424
Epoch: 11, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.711 Vali Acc: 0.770 Test Loss: 0.711 Test Acc: 0.770
Validation loss decreased (-0.743412 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 2.905012845993042
Epoch: 12, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
Validation loss decreased (-0.769730 --> -0.815783).  Saving model ...
Epoch: 13 cost time: 3.0022940635681152
Epoch: 13, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.585 Vali Acc: 0.842 Test Loss: 0.585 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842099).  Saving model ...
Epoch: 14 cost time: 3.0824618339538574
Epoch: 14, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.529 Vali Acc: 0.829 Test Loss: 0.529 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.989447832107544
Epoch: 15, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0653154850006104
Epoch: 16, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.990091562271118
Epoch: 17, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.425 Vali Acc: 0.849 Test Loss: 0.425 Test Acc: 0.849
Validation loss decreased (-0.842099 --> -0.848680).  Saving model ...
Epoch: 18 cost time: 3.0901734828948975
Epoch: 18, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.401 Vali Acc: 0.842 Test Loss: 0.401 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.054521083831787
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 20 cost time: 2.79054856300354
Epoch: 20, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 21 cost time: 2.9321608543395996
Epoch: 21, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9248485565185547
Epoch: 22, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 23 cost time: 2.764427900314331
Epoch: 23, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.85689377784729
Epoch: 24, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.430 Vali Acc: 0.849 Test Loss: 0.430 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8536629676818848
Epoch: 25, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.439 Vali Acc: 0.829 Test Loss: 0.439 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1451175212860107
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.454 Vali Acc: 0.836 Test Loss: 0.454 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.099578857421875
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.457 Vali Acc: 0.842 Test Loss: 0.457 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.9833598136901855
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.443 Vali Acc: 0.849 Test Loss: 0.443 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.947991132736206
Epoch: 29, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.2491345405578613
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.507 Vali Acc: 0.849 Test Loss: 0.507 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 2347140
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.546106576919556
Epoch: 1, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.427 Vali Acc: 0.296 Test Loss: 1.427 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 2.214761257171631
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.391 Vali Acc: 0.322 Test Loss: 1.391 Test Acc: 0.322
Validation loss decreased (-0.296038 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.7544212341308594
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.341 Vali Acc: 0.388 Test Loss: 1.341 Test Acc: 0.388
Validation loss decreased (-0.322355 --> -0.388144).  Saving model ...
Epoch: 4 cost time: 2.3249919414520264
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.284 Vali Acc: 0.434 Test Loss: 1.284 Test Acc: 0.434
Validation loss decreased (-0.388144 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 2.2121942043304443
Epoch: 5, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.223 Vali Acc: 0.493 Test Loss: 1.223 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.984757423400879
Epoch: 6, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.156 Vali Acc: 0.553 Test Loss: 1.156 Test Acc: 0.553
Validation loss decreased (-0.493409 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 2.257143020629883
Epoch: 7, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.084 Vali Acc: 0.572 Test Loss: 1.084 Test Acc: 0.572
Validation loss decreased (-0.552620 --> -0.572358).  Saving model ...
Epoch: 8 cost time: 2.099034070968628
Epoch: 8, Steps: 10 | Train Loss: 0.880 Vali Loss: 0.993 Vali Acc: 0.651 Test Loss: 0.993 Test Acc: 0.651
Validation loss decreased (-0.572358 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 2.1377499103546143
Epoch: 9, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.906 Vali Acc: 0.724 Test Loss: 0.906 Test Acc: 0.724
Validation loss decreased (-0.651306 --> -0.723675).  Saving model ...
Epoch: 10 cost time: 2.1248996257781982
Epoch: 10, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.723675 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 2.2488808631896973
Epoch: 11, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.735 Vali Acc: 0.757 Test Loss: 0.735 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 2.2384700775146484
Epoch: 12, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
Validation loss decreased (-0.756572 --> -0.789467).  Saving model ...
Epoch: 13 cost time: 2.4200656414031982
Epoch: 13, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809204).  Saving model ...
Epoch: 14 cost time: 2.3282618522644043
Epoch: 14, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.559 Vali Acc: 0.842 Test Loss: 0.559 Test Acc: 0.842
Validation loss decreased (-0.809204 --> -0.842100).  Saving model ...
Epoch: 15 cost time: 2.2485554218292236
Epoch: 15, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.517 Vali Acc: 0.836 Test Loss: 0.517 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.433049201965332
Epoch: 16, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.479 Vali Acc: 0.842 Test Loss: 0.479 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 17 cost time: 2.2207722663879395
Epoch: 17, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.451 Vali Acc: 0.849 Test Loss: 0.451 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 18 cost time: 2.1579649448394775
Epoch: 18, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.432 Vali Acc: 0.849 Test Loss: 0.432 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 19 cost time: 2.129037618637085
Epoch: 19, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.425 Vali Acc: 0.822 Test Loss: 0.425 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0638222694396973
Epoch: 20, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.413 Vali Acc: 0.789 Test Loss: 0.413 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.041595458984375
Epoch: 21, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.400 Vali Acc: 0.829 Test Loss: 0.400 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2208361625671387
Epoch: 22, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.398 Vali Acc: 0.829 Test Loss: 0.398 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.110424518585205
Epoch: 23, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.397 Vali Acc: 0.836 Test Loss: 0.397 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.214048147201538
Epoch: 24, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.404 Vali Acc: 0.816 Test Loss: 0.404 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.009740114212036
Epoch: 25, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9958527088165283
Epoch: 26, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.415 Vali Acc: 0.809 Test Loss: 0.415 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1405622959136963
Epoch: 27, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.237978458404541
Epoch: 28, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.390 Vali Acc: 0.816 Test Loss: 0.390 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 691716
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.077460289001465
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.367 Vali Acc: 0.289 Test Loss: 1.367 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.9203481674194336
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.339 Vali Acc: 0.336 Test Loss: 1.339 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 2.203293800354004
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.298 Vali Acc: 0.388 Test Loss: 1.298 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 2.1959664821624756
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.254 Vali Acc: 0.480 Test Loss: 1.254 Test Acc: 0.480
Validation loss decreased (-0.388145 --> -0.480251).  Saving model ...
Epoch: 5 cost time: 2.312770366668701
Epoch: 5, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.211 Vali Acc: 0.539 Test Loss: 1.211 Test Acc: 0.539
Validation loss decreased (-0.480251 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 2.2413318157196045
Epoch: 6, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.156 Vali Acc: 0.605 Test Loss: 1.156 Test Acc: 0.605
Validation loss decreased (-0.539462 --> -0.605252).  Saving model ...
Epoch: 7 cost time: 2.337576389312744
Epoch: 7, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.095 Vali Acc: 0.605 Test Loss: 1.095 Test Acc: 0.605
Validation loss decreased (-0.605252 --> -0.605252).  Saving model ...
Epoch: 8 cost time: 2.2342989444732666
Epoch: 8, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.030 Vali Acc: 0.658 Test Loss: 1.030 Test Acc: 0.658
Validation loss decreased (-0.605252 --> -0.657884).  Saving model ...
Epoch: 9 cost time: 2.1825344562530518
Epoch: 9, Steps: 10 | Train Loss: 0.968 Vali Loss: 0.955 Vali Acc: 0.737 Test Loss: 0.955 Test Acc: 0.737
Validation loss decreased (-0.657884 --> -0.736833).  Saving model ...
Epoch: 10 cost time: 1.897519826889038
Epoch: 10, Steps: 10 | Train Loss: 0.909 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 2.062877655029297
Epoch: 11, Steps: 10 | Train Loss: 0.797 Vali Loss: 0.818 Vali Acc: 0.737 Test Loss: 0.818 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.150961399078369
Epoch: 12, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.757 Vali Acc: 0.750 Test Loss: 0.757 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 2.238058567047119
Epoch: 13, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 2.3057360649108887
Epoch: 14, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 15 cost time: 2.4793193340301514
Epoch: 15, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.649 Vali Acc: 0.763 Test Loss: 0.649 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 2.3226568698883057
Epoch: 16, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.601 Vali Acc: 0.776 Test Loss: 0.601 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 2.374856948852539
Epoch: 17, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 2.216747999191284
Epoch: 18, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
Validation loss decreased (-0.789468 --> -0.822363).  Saving model ...
Epoch: 19 cost time: 1.9647116661071777
Epoch: 19, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.233827829360962
Epoch: 20, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.429 Vali Acc: 0.842 Test Loss: 0.429 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842101).  Saving model ...
Epoch: 21 cost time: 2.1460413932800293
Epoch: 21, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.425 Vali Acc: 0.836 Test Loss: 0.425 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0139899253845215
Epoch: 22, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 23 cost time: 2.178867816925049
Epoch: 23, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 24 cost time: 2.227945327758789
Epoch: 24, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 2.251063585281372
Epoch: 25, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.351 Vali Acc: 0.862 Test Loss: 0.351 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.208249092102051
Epoch: 26, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.364 Vali Acc: 0.849 Test Loss: 0.364 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9208297729492188
Epoch: 27, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.372 Vali Acc: 0.849 Test Loss: 0.372 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0008747577667236
Epoch: 28, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.362 Vali Acc: 0.868 Test Loss: 0.362 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.152305841445923
Epoch: 29, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.348 Vali Acc: 0.849 Test Loss: 0.348 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.4204626083374023
Epoch: 30, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.363 Vali Acc: 0.862 Test Loss: 0.363 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 2347140
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.866828680038452
Epoch: 1, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.426 Vali Acc: 0.303 Test Loss: 1.426 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 2.1264684200286865
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.396 Vali Acc: 0.316 Test Loss: 1.396 Test Acc: 0.316
Validation loss decreased (-0.302617 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 2.1638853549957275
Epoch: 3, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (-0.315776 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 2.0097904205322266
Epoch: 4, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.307 Vali Acc: 0.421 Test Loss: 1.307 Test Acc: 0.421
Validation loss decreased (-0.374986 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 2.1336567401885986
Epoch: 5, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.255 Vali Acc: 0.474 Test Loss: 1.255 Test Acc: 0.474
Validation loss decreased (-0.421040 --> -0.473672).  Saving model ...
Epoch: 6 cost time: 1.9257066249847412
Epoch: 6, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.199 Vali Acc: 0.507 Test Loss: 1.199 Test Acc: 0.507
Validation loss decreased (-0.473672 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.9995841979980469
Epoch: 7, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.142 Vali Acc: 0.553 Test Loss: 1.142 Test Acc: 0.553
Validation loss decreased (-0.506567 --> -0.552620).  Saving model ...
Epoch: 8 cost time: 1.8019633293151855
Epoch: 8, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.068 Vali Acc: 0.618 Test Loss: 1.068 Test Acc: 0.618
Validation loss decreased (-0.552620 --> -0.618410).  Saving model ...
Epoch: 9 cost time: 1.8630404472351074
Epoch: 9, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.998 Vali Acc: 0.632 Test Loss: 0.998 Test Acc: 0.632
Validation loss decreased (-0.618410 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 1.9094576835632324
Epoch: 10, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.917 Vali Acc: 0.697 Test Loss: 0.917 Test Acc: 0.697
Validation loss decreased (-0.631569 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 2.0778815746307373
Epoch: 11, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.838 Vali Acc: 0.770 Test Loss: 0.838 Test Acc: 0.770
Validation loss decreased (-0.697359 --> -0.769728).  Saving model ...
Epoch: 12 cost time: 2.2419111728668213
Epoch: 12, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.770 Vali Acc: 0.776 Test Loss: 0.770 Test Acc: 0.776
Validation loss decreased (-0.769728 --> -0.776308).  Saving model ...
Epoch: 13 cost time: 2.0851595401763916
Epoch: 13, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
Validation loss decreased (-0.776308 --> -0.802625).  Saving model ...
Epoch: 14 cost time: 2.2078213691711426
Epoch: 14, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 15 cost time: 1.9207217693328857
Epoch: 15, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.607 Vali Acc: 0.816 Test Loss: 0.607 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 16 cost time: 1.5919041633605957
Epoch: 16, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.559 Vali Acc: 0.836 Test Loss: 0.559 Test Acc: 0.836
Validation loss decreased (-0.815783 --> -0.835521).  Saving model ...
Epoch: 17 cost time: 1.7552144527435303
Epoch: 17, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.532 Vali Acc: 0.836 Test Loss: 0.532 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 18 cost time: 1.877587080001831
Epoch: 18, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.494 Vali Acc: 0.868 Test Loss: 0.494 Test Acc: 0.868
Validation loss decreased (-0.835521 --> -0.868416).  Saving model ...
Epoch: 19 cost time: 2.032942771911621
Epoch: 19, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.467 Vali Acc: 0.868 Test Loss: 0.467 Test Acc: 0.868
Validation loss decreased (-0.868416 --> -0.868416).  Saving model ...
Epoch: 20 cost time: 1.7779805660247803
Epoch: 20, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.450 Vali Acc: 0.862 Test Loss: 0.450 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.129974365234375
Epoch: 21, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
Validation loss decreased (-0.868416 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 2.0346102714538574
Epoch: 22, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0990872383117676
Epoch: 23, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.383 Vali Acc: 0.882 Test Loss: 0.383 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881575).  Saving model ...
Epoch: 24 cost time: 2.059500217437744
Epoch: 24, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.372 Vali Acc: 0.875 Test Loss: 0.372 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.016674518585205
Epoch: 25, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0582022666931152
Epoch: 26, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.344 Vali Acc: 0.868 Test Loss: 0.344 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8766164779663086
Epoch: 27, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1764943599700928
Epoch: 28, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.327 Vali Acc: 0.882 Test Loss: 0.327 Test Acc: 0.882
Validation loss decreased (-0.881575 --> -0.881576).  Saving model ...
Epoch: 29 cost time: 2.0475215911865234
Epoch: 29, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.342 Vali Acc: 0.855 Test Loss: 0.342 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9164321422576904
Epoch: 30, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.364 Vali Acc: 0.849 Test Loss: 0.364 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 691716
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 9.117618799209595
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.392 Vali Acc: 0.250 Test Loss: 1.392 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 5.16870903968811
Epoch: 2, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.349 Vali Acc: 0.316 Test Loss: 1.349 Test Acc: 0.316
Validation loss decreased (-0.249986 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 5.699051856994629
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.295 Vali Acc: 0.362 Test Loss: 1.295 Test Acc: 0.362
Validation loss decreased (-0.315776 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 7.9190545082092285
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.239 Vali Acc: 0.467 Test Loss: 1.239 Test Acc: 0.467
Validation loss decreased (-0.361829 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 8.700913667678833
Epoch: 5, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.183 Vali Acc: 0.546 Test Loss: 1.183 Test Acc: 0.546
Validation loss decreased (-0.467093 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 8.370035171508789
Epoch: 6, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.120 Vali Acc: 0.645 Test Loss: 1.120 Test Acc: 0.645
Validation loss decreased (-0.546041 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 8.077117443084717
Epoch: 7, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.053 Vali Acc: 0.684 Test Loss: 1.053 Test Acc: 0.684
Validation loss decreased (-0.644726 --> -0.684200).  Saving model ...
Epoch: 8 cost time: 6.814018964767456
Epoch: 8, Steps: 10 | Train Loss: 0.938 Vali Loss: 0.981 Vali Acc: 0.737 Test Loss: 0.981 Test Acc: 0.737
Validation loss decreased (-0.684200 --> -0.736832).  Saving model ...
Epoch: 9 cost time: 7.5556864738464355
Epoch: 9, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.899 Vali Acc: 0.724 Test Loss: 0.899 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.538197755813599
Epoch: 10, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.821 Vali Acc: 0.776 Test Loss: 0.821 Test Acc: 0.776
Validation loss decreased (-0.736832 --> -0.776308).  Saving model ...
Epoch: 11 cost time: 7.916432619094849
Epoch: 11, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789466).  Saving model ...
Epoch: 12 cost time: 7.835779666900635
Epoch: 12, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802625).  Saving model ...
Epoch: 13 cost time: 7.656667709350586
Epoch: 13, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.615 Vali Acc: 0.789 Test Loss: 0.615 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.263121366500854
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 8.249222993850708
Epoch: 15, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.534 Vali Acc: 0.829 Test Loss: 0.534 Test Acc: 0.829
Validation loss decreased (-0.802626 --> -0.828942).  Saving model ...
Epoch: 16 cost time: 7.579618453979492
Epoch: 16, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.582234144210815
Epoch: 17, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 18 cost time: 8.011841773986816
Epoch: 18, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.202795267105103
Epoch: 19, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.458 Vali Acc: 0.842 Test Loss: 0.458 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842101).  Saving model ...
Epoch: 20 cost time: 8.357374429702759
Epoch: 20, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.7499494552612305
Epoch: 21, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.473 Vali Acc: 0.842 Test Loss: 0.473 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.777892589569092
Epoch: 22, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.227267742156982
Epoch: 23, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.227843999862671
Epoch: 24, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.565597295761108
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.603733777999878
Epoch: 26, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 27 cost time: 7.135183334350586
Epoch: 27, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.439 Vali Acc: 0.849 Test Loss: 0.439 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.1519575119018555
Epoch: 28, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 29 cost time: 7.413209676742554
Epoch: 29, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.763084650039673
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.500 Vali Acc: 0.849 Test Loss: 0.500 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 1174916
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.737368583679199
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.427 Vali Acc: 0.151 Test Loss: 1.427 Test Acc: 0.151
Validation loss decreased (inf --> -0.151302).  Saving model ...
Epoch: 2 cost time: 4.364537239074707
Epoch: 2, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.383 Vali Acc: 0.224 Test Loss: 1.383 Test Acc: 0.224
Validation loss decreased (-0.151302 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 4.465437889099121
Epoch: 3, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.333 Vali Acc: 0.329 Test Loss: 1.333 Test Acc: 0.329
Validation loss decreased (-0.223670 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 4.530941009521484
Epoch: 4, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.279 Vali Acc: 0.375 Test Loss: 1.279 Test Acc: 0.375
Validation loss decreased (-0.328934 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 4.053231239318848
Epoch: 5, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.225 Vali Acc: 0.441 Test Loss: 1.225 Test Acc: 0.441
Validation loss decreased (-0.374987 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 4.094736337661743
Epoch: 6, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.440777 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 3.5540401935577393
Epoch: 7, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.095 Vali Acc: 0.572 Test Loss: 1.095 Test Acc: 0.572
Validation loss decreased (-0.499988 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 3.4068188667297363
Epoch: 8, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.024 Vali Acc: 0.664 Test Loss: 1.024 Test Acc: 0.664
Validation loss decreased (-0.572357 --> -0.664463).  Saving model ...
Epoch: 9 cost time: 4.290666580200195
Epoch: 9, Steps: 10 | Train Loss: 0.949 Vali Loss: 0.946 Vali Acc: 0.697 Test Loss: 0.946 Test Acc: 0.697
Validation loss decreased (-0.664463 --> -0.697359).  Saving model ...
Epoch: 10 cost time: 4.343581914901733
Epoch: 10, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
Validation loss decreased (-0.697359 --> -0.763149).  Saving model ...
Epoch: 11 cost time: 4.368129253387451
Epoch: 11, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.791 Vali Acc: 0.776 Test Loss: 0.791 Test Acc: 0.776
Validation loss decreased (-0.763149 --> -0.776308).  Saving model ...
Epoch: 12 cost time: 4.13175892829895
Epoch: 12, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789466).  Saving model ...
Epoch: 13 cost time: 4.1642067432403564
Epoch: 13, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.670 Vali Acc: 0.783 Test Loss: 0.670 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.17986798286438
Epoch: 14, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 3.7879087924957275
Epoch: 15, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.539584398269653
Epoch: 16, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.442238092422485
Epoch: 17, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 4.660938262939453
Epoch: 18, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
Validation loss decreased (-0.802626 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 4.2420878410339355
Epoch: 19, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.14132833480835
Epoch: 20, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.130330801010132
Epoch: 21, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.92087721824646
Epoch: 22, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6936986446380615
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.461 Vali Acc: 0.822 Test Loss: 0.461 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.6963698863983154
Epoch: 24, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.30790638923645
Epoch: 25, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 26 cost time: 4.343591928482056
Epoch: 26, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.462 Vali Acc: 0.842 Test Loss: 0.462 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 27 cost time: 5.174749135971069
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 28 cost time: 5.396059513092041
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.465 Vali Acc: 0.842 Test Loss: 0.465 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.5858237743377686
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.319954872131348
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 347140
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 9.018275737762451
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 6.9678144454956055
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.357 Vali Acc: 0.283 Test Loss: 1.357 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 6.739071846008301
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.308 Vali Acc: 0.342 Test Loss: 1.308 Test Acc: 0.342
Validation loss decreased (-0.282881 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 6.380180358886719
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.258 Vali Acc: 0.447 Test Loss: 1.258 Test Acc: 0.447
Validation loss decreased (-0.342092 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 6.232320308685303
Epoch: 5, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.206 Vali Acc: 0.533 Test Loss: 1.206 Test Acc: 0.533
Validation loss decreased (-0.447356 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 6.357242822647095
Epoch: 6, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.148 Vali Acc: 0.599 Test Loss: 1.148 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 6.2462241649627686
Epoch: 7, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.084 Vali Acc: 0.645 Test Loss: 1.084 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 6.213914394378662
Epoch: 8, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.014 Vali Acc: 0.711 Test Loss: 1.014 Test Acc: 0.711
Validation loss decreased (-0.644726 --> -0.710516).  Saving model ...
Epoch: 9 cost time: 6.53638482093811
Epoch: 9, Steps: 10 | Train Loss: 0.921 Vali Loss: 0.933 Vali Acc: 0.743 Test Loss: 0.933 Test Acc: 0.743
Validation loss decreased (-0.710516 --> -0.743412).  Saving model ...
Epoch: 10 cost time: 6.50949764251709
Epoch: 10, Steps: 10 | Train Loss: 0.798 Vali Loss: 0.850 Vali Acc: 0.763 Test Loss: 0.850 Test Acc: 0.763
Validation loss decreased (-0.743412 --> -0.763149).  Saving model ...
Epoch: 11 cost time: 6.504610300064087
Epoch: 11, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.770 Vali Acc: 0.776 Test Loss: 0.770 Test Acc: 0.776
Validation loss decreased (-0.763149 --> -0.776308).  Saving model ...
Epoch: 12 cost time: 6.876251220703125
Epoch: 12, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
Validation loss decreased (-0.776308 --> -0.802625).  Saving model ...
Epoch: 13 cost time: 6.67730188369751
Epoch: 13, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.659312963485718
Epoch: 14, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.469830274581909
Epoch: 15, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.687016248703003
Epoch: 16, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 6.831737518310547
Epoch: 17, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822364).  Saving model ...
Epoch: 18 cost time: 6.920478105545044
Epoch: 18, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.471 Vali Acc: 0.836 Test Loss: 0.471 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 19 cost time: 7.0441529750823975
Epoch: 19, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.448 Vali Acc: 0.809 Test Loss: 0.448 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.549732208251953
Epoch: 20, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.1775500774383545
Epoch: 21, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.445 Vali Acc: 0.829 Test Loss: 0.445 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.047887086868286
Epoch: 22, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.449 Vali Acc: 0.816 Test Loss: 0.449 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.1797566413879395
Epoch: 23, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.446 Vali Acc: 0.842 Test Loss: 0.446 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 24 cost time: 6.31306004524231
Epoch: 24, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.444 Vali Acc: 0.822 Test Loss: 0.444 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.103308200836182
Epoch: 25, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.427 Vali Acc: 0.842 Test Loss: 0.427 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 26 cost time: 6.466834783554077
Epoch: 26, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.903804063796997
Epoch: 27, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.116735458374023
Epoch: 28, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.457 Vali Acc: 0.836 Test Loss: 0.457 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.629335403442383
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.451 Vali Acc: 0.849 Test Loss: 0.451 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 30 cost time: 6.452040672302246
Epoch: 30, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.483 Vali Acc: 0.849 Test Loss: 0.483 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 1174916
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.125176668167114
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.429 Vali Acc: 0.164 Test Loss: 1.429 Test Acc: 0.164
Validation loss decreased (inf --> -0.164459).  Saving model ...
Epoch: 2 cost time: 4.053170204162598
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.393 Vali Acc: 0.224 Test Loss: 1.393 Test Acc: 0.224
Validation loss decreased (-0.164459 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 3.9948413372039795
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.351 Vali Acc: 0.309 Test Loss: 1.351 Test Acc: 0.309
Validation loss decreased (-0.223670 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 3.8840527534484863
Epoch: 4, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.306 Vali Acc: 0.355 Test Loss: 1.306 Test Acc: 0.355
Validation loss decreased (-0.309197 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 3.7187440395355225
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.261 Vali Acc: 0.408 Test Loss: 1.261 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 3.694101333618164
Epoch: 6, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.212 Vali Acc: 0.480 Test Loss: 1.212 Test Acc: 0.480
Validation loss decreased (-0.407882 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 3.2759318351745605
Epoch: 7, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.162 Vali Acc: 0.533 Test Loss: 1.162 Test Acc: 0.533
Validation loss decreased (-0.480251 --> -0.532883).  Saving model ...
Epoch: 8 cost time: 2.714606761932373
Epoch: 8, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.109 Vali Acc: 0.586 Test Loss: 1.109 Test Acc: 0.586
Validation loss decreased (-0.532883 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 2.5670385360717773
Epoch: 9, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.048 Vali Acc: 0.645 Test Loss: 1.048 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 10 cost time: 3.5113437175750732
Epoch: 10, Steps: 10 | Train Loss: 0.982 Vali Loss: 0.981 Vali Acc: 0.724 Test Loss: 0.981 Test Acc: 0.724
Validation loss decreased (-0.644726 --> -0.723674).  Saving model ...
Epoch: 11 cost time: 3.7792656421661377
Epoch: 11, Steps: 10 | Train Loss: 0.899 Vali Loss: 0.919 Vali Acc: 0.757 Test Loss: 0.919 Test Acc: 0.757
Validation loss decreased (-0.723674 --> -0.756570).  Saving model ...
Epoch: 12 cost time: 3.7186789512634277
Epoch: 12, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.862 Vali Acc: 0.743 Test Loss: 0.862 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4814586639404297
Epoch: 13, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.858980655670166
Epoch: 14, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.746 Vali Acc: 0.730 Test Loss: 0.746 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8695297241210938
Epoch: 15, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.698 Vali Acc: 0.743 Test Loss: 0.698 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6853952407836914
Epoch: 16, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.644 Vali Acc: 0.770 Test Loss: 0.644 Test Acc: 0.770
Validation loss decreased (-0.756570 --> -0.769730).  Saving model ...
Epoch: 17 cost time: 3.6671347618103027
Epoch: 17, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 3.7677109241485596
Epoch: 18, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 3.7902424335479736
Epoch: 19, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 3.815115213394165
Epoch: 20, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 21 cost time: 3.719940662384033
Epoch: 21, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.481 Vali Acc: 0.829 Test Loss: 0.481 Test Acc: 0.829
Validation loss decreased (-0.796048 --> -0.828943).  Saving model ...
Epoch: 22 cost time: 3.6833159923553467
Epoch: 22, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.033911466598511
Epoch: 23, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.455 Vali Acc: 0.816 Test Loss: 0.455 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8808810710906982
Epoch: 24, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.7855846881866455
Epoch: 25, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.434 Vali Acc: 0.803 Test Loss: 0.434 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.8633816242218018
Epoch: 26, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.425 Vali Acc: 0.796 Test Loss: 0.425 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.6458070278167725
Epoch: 27, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.676083564758301
Epoch: 28, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.428 Vali Acc: 0.796 Test Loss: 0.428 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.11857271194458
Epoch: 29, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.4956090450286865
Epoch: 30, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.436 Vali Acc: 0.809 Test Loss: 0.436 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 347140
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.121096134185791
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 3.7613391876220703
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.366 Vali Acc: 0.257 Test Loss: 1.366 Test Acc: 0.257
Validation loss decreased (-0.243407 --> -0.256565).  Saving model ...
Epoch: 3 cost time: 3.9939467906951904
Epoch: 3, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.326 Vali Acc: 0.342 Test Loss: 1.326 Test Acc: 0.342
Validation loss decreased (-0.256565 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 4.092721939086914
Epoch: 4, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.283 Vali Acc: 0.408 Test Loss: 1.283 Test Acc: 0.408
Validation loss decreased (-0.342092 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 4.166357517242432
Epoch: 5, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.241 Vali Acc: 0.480 Test Loss: 1.241 Test Acc: 0.480
Validation loss decreased (-0.407882 --> -0.480251).  Saving model ...
Epoch: 6 cost time: 4.000944137573242
Epoch: 6, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.196 Vali Acc: 0.553 Test Loss: 1.196 Test Acc: 0.553
Validation loss decreased (-0.480251 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 3.8716487884521484
Epoch: 7, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.151 Vali Acc: 0.632 Test Loss: 1.151 Test Acc: 0.632
Validation loss decreased (-0.552620 --> -0.631567).  Saving model ...
Epoch: 8 cost time: 4.162303686141968
Epoch: 8, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.104 Vali Acc: 0.671 Test Loss: 1.104 Test Acc: 0.671
Validation loss decreased (-0.631567 --> -0.671042).  Saving model ...
Epoch: 9 cost time: 4.108662366867065
Epoch: 9, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.052 Vali Acc: 0.711 Test Loss: 1.052 Test Acc: 0.711
Validation loss decreased (-0.671042 --> -0.710516).  Saving model ...
Epoch: 10 cost time: 4.042390584945679
Epoch: 10, Steps: 10 | Train Loss: 0.964 Vali Loss: 0.996 Vali Acc: 0.750 Test Loss: 0.996 Test Acc: 0.750
Validation loss decreased (-0.710516 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 3.9737343788146973
Epoch: 11, Steps: 10 | Train Loss: 0.905 Vali Loss: 0.936 Vali Acc: 0.763 Test Loss: 0.936 Test Acc: 0.763
Validation loss decreased (-0.749990 --> -0.763149).  Saving model ...
Epoch: 12 cost time: 4.114469528198242
Epoch: 12, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.874 Vali Acc: 0.783 Test Loss: 0.874 Test Acc: 0.783
Validation loss decreased (-0.763149 --> -0.782886).  Saving model ...
Epoch: 13 cost time: 4.128695011138916
Epoch: 13, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.807 Vali Acc: 0.796 Test Loss: 0.807 Test Acc: 0.796
Validation loss decreased (-0.782886 --> -0.796045).  Saving model ...
Epoch: 14 cost time: 3.7001595497131348
Epoch: 14, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7195494174957275
Epoch: 15, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 3.680767059326172
Epoch: 16, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
Validation loss decreased (-0.796046 --> -0.822362).  Saving model ...
Epoch: 17 cost time: 3.9631638526916504
Epoch: 17, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.578 Vali Acc: 0.829 Test Loss: 0.578 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 18 cost time: 3.8589048385620117
Epoch: 18, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.538 Vali Acc: 0.836 Test Loss: 0.538 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 19 cost time: 3.8035213947296143
Epoch: 19, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5111963748931885
Epoch: 20, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.472 Vali Acc: 0.842 Test Loss: 0.472 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842101).  Saving model ...
Epoch: 21 cost time: 3.9648935794830322
Epoch: 21, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.951688766479492
Epoch: 22, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.433 Vali Acc: 0.842 Test Loss: 0.433 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 23 cost time: 3.770676612854004
Epoch: 23, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.418 Vali Acc: 0.842 Test Loss: 0.418 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 24 cost time: 3.9618256092071533
Epoch: 24, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 25 cost time: 4.251066446304321
Epoch: 25, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 26 cost time: 4.020692348480225
Epoch: 26, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.367 Vali Acc: 0.855 Test Loss: 0.367 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 27 cost time: 4.018706321716309
Epoch: 27, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861839).  Saving model ...
Epoch: 28 cost time: 4.209711313247681
Epoch: 28, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.347 Vali Acc: 0.875 Test Loss: 0.347 Test Acc: 0.875
Validation loss decreased (-0.861839 --> -0.874997).  Saving model ...
Epoch: 29 cost time: 4.106704473495483
Epoch: 29, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.342 Vali Acc: 0.868 Test Loss: 0.342 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.0266313552856445
Epoch: 30, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.339 Vali Acc: 0.868 Test Loss: 0.339 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 1174916
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.9574501514434814
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.447 Vali Acc: 0.158 Test Loss: 1.447 Test Acc: 0.158
Validation loss decreased (inf --> -0.157880).  Saving model ...
Epoch: 2 cost time: 2.8001463413238525
Epoch: 2, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.417 Vali Acc: 0.204 Test Loss: 1.417 Test Acc: 0.204
Validation loss decreased (-0.157880 --> -0.203933).  Saving model ...
Epoch: 3 cost time: 2.811556339263916
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.380 Vali Acc: 0.243 Test Loss: 1.380 Test Acc: 0.243
Validation loss decreased (-0.203933 --> -0.243407).  Saving model ...
Epoch: 4 cost time: 2.5325746536254883
Epoch: 4, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.342 Vali Acc: 0.316 Test Loss: 1.342 Test Acc: 0.316
Validation loss decreased (-0.243407 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 2.116520643234253
Epoch: 5, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.302 Vali Acc: 0.349 Test Loss: 1.302 Test Acc: 0.349
Validation loss decreased (-0.315776 --> -0.348671).  Saving model ...
Epoch: 6 cost time: 2.699009418487549
Epoch: 6, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.258 Vali Acc: 0.414 Test Loss: 1.258 Test Acc: 0.414
Validation loss decreased (-0.348671 --> -0.414461).  Saving model ...
Epoch: 7 cost time: 2.5408952236175537
Epoch: 7, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.213 Vali Acc: 0.493 Test Loss: 1.213 Test Acc: 0.493
Validation loss decreased (-0.414461 --> -0.493409).  Saving model ...
Epoch: 8 cost time: 2.350436210632324
Epoch: 8, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.168 Vali Acc: 0.533 Test Loss: 1.168 Test Acc: 0.533
Validation loss decreased (-0.493409 --> -0.532883).  Saving model ...
Epoch: 9 cost time: 2.22975754737854
Epoch: 9, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.116 Vali Acc: 0.605 Test Loss: 1.116 Test Acc: 0.605
Validation loss decreased (-0.532883 --> -0.605252).  Saving model ...
Epoch: 10 cost time: 2.408644437789917
Epoch: 10, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.060 Vali Acc: 0.658 Test Loss: 1.060 Test Acc: 0.658
Validation loss decreased (-0.605252 --> -0.657884).  Saving model ...
Epoch: 11 cost time: 2.5709950923919678
Epoch: 11, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.007 Vali Acc: 0.717 Test Loss: 1.007 Test Acc: 0.717
Validation loss decreased (-0.657884 --> -0.717095).  Saving model ...
Epoch: 12 cost time: 2.572441339492798
Epoch: 12, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.959 Vali Acc: 0.711 Test Loss: 0.959 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.466338872909546
Epoch: 13, Steps: 10 | Train Loss: 0.841 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
Validation loss decreased (-0.717095 --> -0.717096).  Saving model ...
Epoch: 14 cost time: 2.186519145965576
Epoch: 14, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.862 Vali Acc: 0.750 Test Loss: 0.862 Test Acc: 0.750
Validation loss decreased (-0.717096 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 2.6929421424865723
Epoch: 15, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 2.6740329265594482
Epoch: 16, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 2.706679582595825
Epoch: 17, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.734 Vali Acc: 0.770 Test Loss: 0.734 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 2.6514642238616943
Epoch: 18, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.693 Vali Acc: 0.770 Test Loss: 0.693 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 19 cost time: 2.6406338214874268
Epoch: 19, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.657 Vali Acc: 0.776 Test Loss: 0.657 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 20 cost time: 2.7865729331970215
Epoch: 20, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 21 cost time: 2.7633681297302246
Epoch: 21, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 2.6439692974090576
Epoch: 22, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5678837299346924
Epoch: 23, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.524 Vali Acc: 0.829 Test Loss: 0.524 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 24 cost time: 2.6545372009277344
Epoch: 24, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.715543746948242
Epoch: 25, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 26 cost time: 2.746833324432373
Epoch: 26, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.477 Vali Acc: 0.829 Test Loss: 0.477 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 27 cost time: 2.6018600463867188
Epoch: 27, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8128933906555176
Epoch: 28, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.449 Vali Acc: 0.829 Test Loss: 0.449 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 29 cost time: 2.5592353343963623
Epoch: 29, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.440 Vali Acc: 0.836 Test Loss: 0.440 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 30 cost time: 2.498271942138672
Epoch: 30, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.438 Vali Acc: 0.849 Test Loss: 0.438 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 347140
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 9.953751564025879
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 7.6797356605529785
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.396 Vali Acc: 0.329 Test Loss: 1.396 Test Acc: 0.329
Validation loss decreased (-0.269723 --> -0.328933).  Saving model ...
Epoch: 3 cost time: 8.065366506576538
Epoch: 3, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.359 Vali Acc: 0.368 Test Loss: 1.359 Test Acc: 0.368
Validation loss decreased (-0.328933 --> -0.368407).  Saving model ...
Epoch: 4 cost time: 8.479378700256348
Epoch: 4, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.316 Vali Acc: 0.388 Test Loss: 1.316 Test Acc: 0.388
Validation loss decreased (-0.368407 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 7.907850027084351
Epoch: 5, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.272 Vali Acc: 0.461 Test Loss: 1.272 Test Acc: 0.461
Validation loss decreased (-0.388145 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 8.815616607666016
Epoch: 6, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.225 Vali Acc: 0.507 Test Loss: 1.225 Test Acc: 0.507
Validation loss decreased (-0.460514 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 7.29692816734314
Epoch: 7, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.168 Vali Acc: 0.559 Test Loss: 1.168 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 8.74799656867981
Epoch: 8, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.107 Vali Acc: 0.572 Test Loss: 1.107 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 8.746695756912231
Epoch: 9, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.035 Vali Acc: 0.658 Test Loss: 1.035 Test Acc: 0.658
Validation loss decreased (-0.572357 --> -0.657884).  Saving model ...
Epoch: 10 cost time: 8.634213924407959
Epoch: 10, Steps: 10 | Train Loss: 0.929 Vali Loss: 0.968 Vali Acc: 0.711 Test Loss: 0.968 Test Acc: 0.711
Validation loss decreased (-0.657884 --> -0.710517).  Saving model ...
Epoch: 11 cost time: 8.421251773834229
Epoch: 11, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.891 Vali Acc: 0.730 Test Loss: 0.891 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730254).  Saving model ...
Epoch: 12 cost time: 7.922968864440918
Epoch: 12, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.814 Vali Acc: 0.737 Test Loss: 0.814 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 13 cost time: 8.567247152328491
Epoch: 13, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
Validation loss decreased (-0.736834 --> -0.782887).  Saving model ...
Epoch: 14 cost time: 7.776949644088745
Epoch: 14, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.678 Vali Acc: 0.789 Test Loss: 0.678 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 8.784953832626343
Epoch: 15, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 8.6270911693573
Epoch: 16, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.558 Vali Acc: 0.796 Test Loss: 0.558 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 9.102272987365723
Epoch: 17, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 8.741960287094116
Epoch: 18, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.008007287979126
Epoch: 19, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.470 Vali Acc: 0.783 Test Loss: 0.470 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.909900665283203
Epoch: 20, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
Validation loss decreased (-0.802626 --> -0.828943).  Saving model ...
Epoch: 21 cost time: 8.34504222869873
Epoch: 21, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.445 Vali Acc: 0.809 Test Loss: 0.445 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.922849416732788
Epoch: 22, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.454 Vali Acc: 0.809 Test Loss: 0.454 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.928329706192017
Epoch: 23, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.28220272064209
Epoch: 24, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.456 Vali Acc: 0.836 Test Loss: 0.456 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 25 cost time: 8.450072765350342
Epoch: 25, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.447 Vali Acc: 0.836 Test Loss: 0.447 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 26 cost time: 8.152897119522095
Epoch: 26, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.413 Vali Acc: 0.829 Test Loss: 0.413 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.710507869720459
Epoch: 27, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.420 Vali Acc: 0.849 Test Loss: 0.420 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
Epoch: 28 cost time: 8.367415189743042
Epoch: 28, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.404 Vali Acc: 0.849 Test Loss: 0.404 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 29 cost time: 8.179570198059082
Epoch: 29, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.117600440979004
Epoch: 30, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 588804
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.236260414123535
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.359 Vali Acc: 0.322 Test Loss: 1.359 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 4.7762062549591064
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.335 Vali Acc: 0.349 Test Loss: 1.335 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 4.8616180419921875
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.302 Vali Acc: 0.428 Test Loss: 1.302 Test Acc: 0.428
Validation loss decreased (-0.348671 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 4.784714221954346
Epoch: 4, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.267 Vali Acc: 0.480 Test Loss: 1.267 Test Acc: 0.480
Validation loss decreased (-0.427619 --> -0.480250).  Saving model ...
Epoch: 5 cost time: 4.548800468444824
Epoch: 5, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.225 Vali Acc: 0.559 Test Loss: 1.225 Test Acc: 0.559
Validation loss decreased (-0.480250 --> -0.559198).  Saving model ...
Epoch: 6 cost time: 4.568276643753052
Epoch: 6, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.181 Vali Acc: 0.592 Test Loss: 1.181 Test Acc: 0.592
Validation loss decreased (-0.559198 --> -0.592093).  Saving model ...
Epoch: 7 cost time: 4.578680753707886
Epoch: 7, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.592093 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 4.214722156524658
Epoch: 8, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.083 Vali Acc: 0.638 Test Loss: 1.083 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 4.431540489196777
Epoch: 9, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.031 Vali Acc: 0.684 Test Loss: 1.031 Test Acc: 0.684
Validation loss decreased (-0.638147 --> -0.684200).  Saving model ...
Epoch: 10 cost time: 4.570592164993286
Epoch: 10, Steps: 10 | Train Loss: 0.942 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
Validation loss decreased (-0.684200 --> -0.717096).  Saving model ...
Epoch: 11 cost time: 4.407008647918701
Epoch: 11, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
Validation loss decreased (-0.717096 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 4.527270317077637
Epoch: 12, Steps: 10 | Train Loss: 0.797 Vali Loss: 0.860 Vali Acc: 0.789 Test Loss: 0.860 Test Acc: 0.789
Validation loss decreased (-0.749991 --> -0.789465).  Saving model ...
Epoch: 13 cost time: 4.575596570968628
Epoch: 13, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.800 Vali Acc: 0.822 Test Loss: 0.800 Test Acc: 0.822
Validation loss decreased (-0.789465 --> -0.822360).  Saving model ...
Epoch: 14 cost time: 4.683385372161865
Epoch: 14, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.745 Vali Acc: 0.829 Test Loss: 0.745 Test Acc: 0.829
Validation loss decreased (-0.822360 --> -0.828940).  Saving model ...
Epoch: 15 cost time: 4.776327848434448
Epoch: 15, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.690 Vali Acc: 0.829 Test Loss: 0.690 Test Acc: 0.829
Validation loss decreased (-0.828940 --> -0.828940).  Saving model ...
Epoch: 16 cost time: 4.320214033126831
Epoch: 16, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.637 Vali Acc: 0.849 Test Loss: 0.637 Test Acc: 0.849
Validation loss decreased (-0.828940 --> -0.848678).  Saving model ...
Epoch: 17 cost time: 4.284050703048706
Epoch: 17, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.588 Vali Acc: 0.842 Test Loss: 0.588 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.036467790603638
Epoch: 18, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.545 Vali Acc: 0.849 Test Loss: 0.545 Test Acc: 0.849
Validation loss decreased (-0.848678 --> -0.848679).  Saving model ...
Epoch: 19 cost time: 4.848477840423584
Epoch: 19, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.141810655593872
Epoch: 20, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855258).  Saving model ...
Epoch: 21 cost time: 5.139735460281372
Epoch: 21, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.455 Vali Acc: 0.849 Test Loss: 0.455 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.195281744003296
Epoch: 22, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.437 Vali Acc: 0.842 Test Loss: 0.437 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.189120769500732
Epoch: 23, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.422 Vali Acc: 0.836 Test Loss: 0.422 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.922311544418335
Epoch: 24, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.406 Vali Acc: 0.829 Test Loss: 0.406 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.822699546813965
Epoch: 25, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.391 Vali Acc: 0.842 Test Loss: 0.391 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.843090295791626
Epoch: 26, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.381 Vali Acc: 0.842 Test Loss: 0.381 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.806230306625366
Epoch: 27, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.371 Vali Acc: 0.829 Test Loss: 0.371 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.7657434940338135
Epoch: 28, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.364 Vali Acc: 0.842 Test Loss: 0.364 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.99501371383667
Epoch: 29, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.352 Vali Acc: 0.836 Test Loss: 0.352 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.968563795089722
Epoch: 30, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.356 Vali Acc: 0.816 Test Loss: 0.356 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 174852
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 8.426206350326538
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 6.280000686645508
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.400 Vali Acc: 0.322 Test Loss: 1.400 Test Acc: 0.322
Validation loss decreased (-0.269723 --> -0.322354).  Saving model ...
Epoch: 3 cost time: 6.402055025100708
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.366 Vali Acc: 0.375 Test Loss: 1.366 Test Acc: 0.375
Validation loss decreased (-0.322354 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 6.4600653648376465
Epoch: 4, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.329 Vali Acc: 0.408 Test Loss: 1.329 Test Acc: 0.408
Validation loss decreased (-0.374986 --> -0.407881).  Saving model ...
Epoch: 5 cost time: 6.2117133140563965
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.290 Vali Acc: 0.447 Test Loss: 1.290 Test Acc: 0.447
Validation loss decreased (-0.407881 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 6.343271493911743
Epoch: 6, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.249 Vali Acc: 0.480 Test Loss: 1.249 Test Acc: 0.480
Validation loss decreased (-0.447356 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 6.311960458755493
Epoch: 7, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.202 Vali Acc: 0.526 Test Loss: 1.202 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526304).  Saving model ...
Epoch: 8 cost time: 6.237311840057373
Epoch: 8, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.156 Vali Acc: 0.546 Test Loss: 1.156 Test Acc: 0.546
Validation loss decreased (-0.526304 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 6.170384407043457
Epoch: 9, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.100 Vali Acc: 0.592 Test Loss: 1.100 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592094).  Saving model ...
Epoch: 10 cost time: 5.934030771255493
Epoch: 10, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.044 Vali Acc: 0.651 Test Loss: 1.044 Test Acc: 0.651
Validation loss decreased (-0.592094 --> -0.651305).  Saving model ...
Epoch: 11 cost time: 6.0466132164001465
Epoch: 11, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.980 Vali Acc: 0.697 Test Loss: 0.980 Test Acc: 0.697
Validation loss decreased (-0.651305 --> -0.697359).  Saving model ...
Epoch: 12 cost time: 6.141294479370117
Epoch: 12, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.911 Vali Acc: 0.704 Test Loss: 0.911 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 13 cost time: 5.979467868804932
Epoch: 13, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.836 Vali Acc: 0.763 Test Loss: 0.836 Test Acc: 0.763
Validation loss decreased (-0.703938 --> -0.763150).  Saving model ...
Epoch: 14 cost time: 5.799537897109985
Epoch: 14, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.765 Vali Acc: 0.757 Test Loss: 0.765 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.546229124069214
Epoch: 15, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.689 Vali Acc: 0.776 Test Loss: 0.689 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 5.298647403717041
Epoch: 16, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.623 Vali Acc: 0.796 Test Loss: 0.623 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 17 cost time: 5.755488395690918
Epoch: 17, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.298470497131348
Epoch: 18, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.228756427764893
Epoch: 19, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 6.146285533905029
Epoch: 20, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.452 Vali Acc: 0.816 Test Loss: 0.452 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 21 cost time: 6.220628023147583
Epoch: 21, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.449 Vali Acc: 0.842 Test Loss: 0.449 Test Acc: 0.842
Validation loss decreased (-0.815785 --> -0.842101).  Saving model ...
Epoch: 22 cost time: 6.217228889465332
Epoch: 22, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.422 Vali Acc: 0.836 Test Loss: 0.422 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.950927257537842
Epoch: 23, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.390 Vali Acc: 0.842 Test Loss: 0.390 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 24 cost time: 6.165913820266724
Epoch: 24, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.389 Vali Acc: 0.842 Test Loss: 0.389 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 25 cost time: 6.073977708816528
Epoch: 25, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 26 cost time: 5.92311692237854
Epoch: 26, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.852617979049683
Epoch: 27, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.370 Vali Acc: 0.842 Test Loss: 0.370 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.87177300453186
Epoch: 28, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 29 cost time: 5.78205680847168
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.359 Vali Acc: 0.868 Test Loss: 0.359 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 30 cost time: 5.725322246551514
Epoch: 30, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.374 Vali Acc: 0.868 Test Loss: 0.374 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 588804
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.2643938064575195
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.360 Vali Acc: 0.309 Test Loss: 1.360 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 3.4167487621307373
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.337 Vali Acc: 0.336 Test Loss: 1.337 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 3.7073936462402344
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.305 Vali Acc: 0.408 Test Loss: 1.305 Test Acc: 0.408
Validation loss decreased (-0.335513 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 3.6935079097747803
Epoch: 4, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.270 Vali Acc: 0.461 Test Loss: 1.270 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 3.619338274002075
Epoch: 5, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.230 Vali Acc: 0.526 Test Loss: 1.230 Test Acc: 0.526
Validation loss decreased (-0.460514 --> -0.526303).  Saving model ...
Epoch: 6 cost time: 3.511183023452759
Epoch: 6, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.187 Vali Acc: 0.559 Test Loss: 1.187 Test Acc: 0.559
Validation loss decreased (-0.526303 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 3.5378224849700928
Epoch: 7, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.140 Vali Acc: 0.599 Test Loss: 1.140 Test Acc: 0.599
Validation loss decreased (-0.559199 --> -0.598673).  Saving model ...
Epoch: 8 cost time: 3.791146755218506
Epoch: 8, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.094 Vali Acc: 0.638 Test Loss: 1.094 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 3.8011257648468018
Epoch: 9, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.045 Vali Acc: 0.684 Test Loss: 1.045 Test Acc: 0.684
Validation loss decreased (-0.638147 --> -0.684200).  Saving model ...
Epoch: 10 cost time: 3.537656545639038
Epoch: 10, Steps: 10 | Train Loss: 0.950 Vali Loss: 0.993 Vali Acc: 0.737 Test Loss: 0.993 Test Acc: 0.737
Validation loss decreased (-0.684200 --> -0.736832).  Saving model ...
Epoch: 11 cost time: 3.567518472671509
Epoch: 11, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.940 Vali Acc: 0.757 Test Loss: 0.940 Test Acc: 0.757
Validation loss decreased (-0.736832 --> -0.756570).  Saving model ...
Epoch: 12 cost time: 3.9486162662506104
Epoch: 12, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.885 Vali Acc: 0.789 Test Loss: 0.885 Test Acc: 0.789
Validation loss decreased (-0.756570 --> -0.789465).  Saving model ...
Epoch: 13 cost time: 4.042759656906128
Epoch: 13, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
Validation loss decreased (-0.789465 --> -0.802623).  Saving model ...
Epoch: 14 cost time: 3.8364508152008057
Epoch: 14, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.782 Vali Acc: 0.829 Test Loss: 0.782 Test Acc: 0.829
Validation loss decreased (-0.802623 --> -0.828940).  Saving model ...
Epoch: 15 cost time: 3.7983007431030273
Epoch: 15, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.734 Vali Acc: 0.829 Test Loss: 0.734 Test Acc: 0.829
Validation loss decreased (-0.828940 --> -0.828940).  Saving model ...
Epoch: 16 cost time: 3.6483728885650635
Epoch: 16, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.688 Vali Acc: 0.836 Test Loss: 0.688 Test Acc: 0.836
Validation loss decreased (-0.828940 --> -0.835519).  Saving model ...
Epoch: 17 cost time: 3.65092134475708
Epoch: 17, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.644 Vali Acc: 0.829 Test Loss: 0.644 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.623833179473877
Epoch: 18, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.604 Vali Acc: 0.829 Test Loss: 0.604 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6164066791534424
Epoch: 19, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7460954189300537
Epoch: 20, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.537 Vali Acc: 0.836 Test Loss: 0.537 Test Acc: 0.836
Validation loss decreased (-0.835519 --> -0.835521).  Saving model ...
Epoch: 21 cost time: 3.8327229022979736
Epoch: 21, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7336838245391846
Epoch: 22, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5040910243988037
Epoch: 23, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.440429925918579
Epoch: 24, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 25 cost time: 3.8712663650512695
Epoch: 25, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8419158458709717
Epoch: 26, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.418 Vali Acc: 0.842 Test Loss: 0.418 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 27 cost time: 4.0879902839660645
Epoch: 27, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.139165163040161
Epoch: 28, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.083893775939941
Epoch: 29, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.395 Vali Acc: 0.836 Test Loss: 0.395 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.9425182342529297
Epoch: 30, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.394 Vali Acc: 0.829 Test Loss: 0.394 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 174852
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.896867275238037
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.428 Vali Acc: 0.250 Test Loss: 1.428 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 4.040944814682007
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.404 Vali Acc: 0.309 Test Loss: 1.404 Test Acc: 0.309
Validation loss decreased (-0.249986 --> -0.309196).  Saving model ...
Epoch: 3 cost time: 4.137187480926514
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.373 Vali Acc: 0.349 Test Loss: 1.373 Test Acc: 0.349
Validation loss decreased (-0.309196 --> -0.348670).  Saving model ...
Epoch: 4 cost time: 3.7913503646850586
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.338 Vali Acc: 0.395 Test Loss: 1.338 Test Acc: 0.395
Validation loss decreased (-0.348670 --> -0.394723).  Saving model ...
Epoch: 5 cost time: 3.705735921859741
Epoch: 5, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.303 Vali Acc: 0.414 Test Loss: 1.303 Test Acc: 0.414
Validation loss decreased (-0.394723 --> -0.414461).  Saving model ...
Epoch: 6 cost time: 3.507573127746582
Epoch: 6, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.266 Vali Acc: 0.487 Test Loss: 1.266 Test Acc: 0.487
Validation loss decreased (-0.414461 --> -0.486829).  Saving model ...
Epoch: 7 cost time: 3.652350902557373
Epoch: 7, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.224 Vali Acc: 0.533 Test Loss: 1.224 Test Acc: 0.533
Validation loss decreased (-0.486829 --> -0.532882).  Saving model ...
Epoch: 8 cost time: 3.7823429107666016
Epoch: 8, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.183 Vali Acc: 0.546 Test Loss: 1.183 Test Acc: 0.546
Validation loss decreased (-0.532882 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 3.7444396018981934
Epoch: 9, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 4.056870698928833
Epoch: 10, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.088 Vali Acc: 0.638 Test Loss: 1.088 Test Acc: 0.638
Validation loss decreased (-0.572357 --> -0.638147).  Saving model ...
Epoch: 11 cost time: 3.9577364921569824
Epoch: 11, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.036 Vali Acc: 0.671 Test Loss: 1.036 Test Acc: 0.671
Validation loss decreased (-0.638147 --> -0.671042).  Saving model ...
Epoch: 12 cost time: 3.8732175827026367
Epoch: 12, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.979 Vali Acc: 0.691 Test Loss: 0.979 Test Acc: 0.691
Validation loss decreased (-0.671042 --> -0.690780).  Saving model ...
Epoch: 13 cost time: 3.791534185409546
Epoch: 13, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.921 Vali Acc: 0.717 Test Loss: 0.921 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717096).  Saving model ...
Epoch: 14 cost time: 3.839912176132202
Epoch: 14, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.863 Vali Acc: 0.743 Test Loss: 0.863 Test Acc: 0.743
Validation loss decreased (-0.717096 --> -0.743412).  Saving model ...
Epoch: 15 cost time: 3.771592617034912
Epoch: 15, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.802 Vali Acc: 0.757 Test Loss: 0.802 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756571).  Saving model ...
Epoch: 16 cost time: 3.619997978210449
Epoch: 16, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.744 Vali Acc: 0.776 Test Loss: 0.744 Test Acc: 0.776
Validation loss decreased (-0.756571 --> -0.776308).  Saving model ...
Epoch: 17 cost time: 3.8003768920898438
Epoch: 17, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.700 Vali Acc: 0.776 Test Loss: 0.700 Test Acc: 0.776
Validation loss decreased (-0.776308 --> -0.776309).  Saving model ...
Epoch: 18 cost time: 3.671797752380371
Epoch: 18, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 19 cost time: 3.9667534828186035
Epoch: 19, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 3.9042253494262695
Epoch: 20, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 3.956169366836548
Epoch: 21, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 22 cost time: 4.344380855560303
Epoch: 22, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828943).  Saving model ...
Epoch: 23 cost time: 4.013261795043945
Epoch: 23, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.446 Vali Acc: 0.842 Test Loss: 0.446 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 24 cost time: 4.097996234893799
Epoch: 24, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.406 Vali Acc: 0.842 Test Loss: 0.406 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 25 cost time: 4.011396646499634
Epoch: 25, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 26 cost time: 3.914067268371582
Epoch: 26, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 27 cost time: 3.8798561096191406
Epoch: 27, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.362 Vali Acc: 0.868 Test Loss: 0.362 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 28 cost time: 3.837764263153076
Epoch: 28, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874997).  Saving model ...
Epoch: 29 cost time: 3.7073590755462646
Epoch: 29, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.334 Vali Acc: 0.868 Test Loss: 0.334 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.893949508666992
Epoch: 30, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 588804
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.603291749954224
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.350 Vali Acc: 0.322 Test Loss: 1.350 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 2.740586519241333
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.328 Vali Acc: 0.349 Test Loss: 1.328 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 2.7881791591644287
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.299 Vali Acc: 0.395 Test Loss: 1.299 Test Acc: 0.395
Validation loss decreased (-0.348671 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 2.6238553524017334
Epoch: 4, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.266 Vali Acc: 0.480 Test Loss: 1.266 Test Acc: 0.480
Validation loss decreased (-0.394724 --> -0.480251).  Saving model ...
Epoch: 5 cost time: 2.7196619510650635
Epoch: 5, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.228 Vali Acc: 0.533 Test Loss: 1.228 Test Acc: 0.533
Validation loss decreased (-0.480251 --> -0.532882).  Saving model ...
Epoch: 6 cost time: 2.823617458343506
Epoch: 6, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.188 Vali Acc: 0.572 Test Loss: 1.188 Test Acc: 0.572
Validation loss decreased (-0.532882 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 2.7517778873443604
Epoch: 7, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 2.7536659240722656
Epoch: 8, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.103 Vali Acc: 0.664 Test Loss: 1.103 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664463).  Saving model ...
Epoch: 9 cost time: 2.8759047985076904
Epoch: 9, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.057 Vali Acc: 0.684 Test Loss: 1.057 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684200).  Saving model ...
Epoch: 10 cost time: 2.860480308532715
Epoch: 10, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.009 Vali Acc: 0.724 Test Loss: 1.009 Test Acc: 0.724
Validation loss decreased (-0.684200 --> -0.723674).  Saving model ...
Epoch: 11 cost time: 2.7510764598846436
Epoch: 11, Steps: 10 | Train Loss: 0.908 Vali Loss: 0.961 Vali Acc: 0.763 Test Loss: 0.961 Test Acc: 0.763
Validation loss decreased (-0.723674 --> -0.763148).  Saving model ...
Epoch: 12 cost time: 2.2511024475097656
Epoch: 12, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.912 Vali Acc: 0.789 Test Loss: 0.912 Test Acc: 0.789
Validation loss decreased (-0.763148 --> -0.789465).  Saving model ...
Epoch: 13 cost time: 2.1089963912963867
Epoch: 13, Steps: 10 | Train Loss: 0.797 Vali Loss: 0.864 Vali Acc: 0.809 Test Loss: 0.864 Test Acc: 0.809
Validation loss decreased (-0.789465 --> -0.809202).  Saving model ...
Epoch: 14 cost time: 2.2169747352600098
Epoch: 14, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.820 Vali Acc: 0.809 Test Loss: 0.820 Test Acc: 0.809
Validation loss decreased (-0.809202 --> -0.809202).  Saving model ...
Epoch: 15 cost time: 2.8266682624816895
Epoch: 15, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.778 Vali Acc: 0.809 Test Loss: 0.778 Test Acc: 0.809
Validation loss decreased (-0.809202 --> -0.809203).  Saving model ...
Epoch: 16 cost time: 2.9462368488311768
Epoch: 16, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.737 Vali Acc: 0.809 Test Loss: 0.737 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809203).  Saving model ...
Epoch: 17 cost time: 2.849724531173706
Epoch: 17, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.698 Vali Acc: 0.816 Test Loss: 0.698 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815782).  Saving model ...
Epoch: 18 cost time: 2.5973575115203857
Epoch: 18, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.660 Vali Acc: 0.836 Test Loss: 0.660 Test Acc: 0.836
Validation loss decreased (-0.815782 --> -0.835520).  Saving model ...
Epoch: 19 cost time: 2.5712826251983643
Epoch: 19, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.626 Vali Acc: 0.829 Test Loss: 0.626 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.516981840133667
Epoch: 20, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8520772457122803
Epoch: 21, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9857521057128906
Epoch: 22, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.869600772857666
Epoch: 23, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.523 Vali Acc: 0.829 Test Loss: 0.523 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8009846210479736
Epoch: 24, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.500 Vali Acc: 0.836 Test Loss: 0.500 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835521).  Saving model ...
Epoch: 25 cost time: 2.675901174545288
Epoch: 25, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7420644760131836
Epoch: 26, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.454 Vali Acc: 0.849 Test Loss: 0.454 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848680).  Saving model ...
Epoch: 27 cost time: 2.78987455368042
Epoch: 27, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.438 Vali Acc: 0.849 Test Loss: 0.438 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 28 cost time: 2.6599953174591064
Epoch: 28, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.426 Vali Acc: 0.836 Test Loss: 0.426 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.842879056930542
Epoch: 29, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.407 Vali Acc: 0.836 Test Loss: 0.407 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8663976192474365
Epoch: 30, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 174852
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.052448749542236
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.357 Vali Acc: 0.349 Test Loss: 1.357 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 3.6270854473114014
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.323 Vali Acc: 0.395 Test Loss: 1.323 Test Acc: 0.395
Validation loss decreased (-0.348671 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 3.784097671508789
Epoch: 3, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.283 Vali Acc: 0.408 Test Loss: 1.283 Test Acc: 0.408
Validation loss decreased (-0.394724 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 3.8935370445251465
Epoch: 4, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.236 Vali Acc: 0.441 Test Loss: 1.236 Test Acc: 0.441
Validation loss decreased (-0.407882 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 3.6300716400146484
Epoch: 5, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.184 Vali Acc: 0.480 Test Loss: 1.184 Test Acc: 0.480
Validation loss decreased (-0.440777 --> -0.480251).  Saving model ...
Epoch: 6 cost time: 3.820286512374878
Epoch: 6, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.132 Vali Acc: 0.546 Test Loss: 1.132 Test Acc: 0.546
Validation loss decreased (-0.480251 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 3.7602767944335938
Epoch: 7, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.071 Vali Acc: 0.618 Test Loss: 1.071 Test Acc: 0.618
Validation loss decreased (-0.546041 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 3.7053701877593994
Epoch: 8, Steps: 10 | Train Loss: 0.968 Vali Loss: 0.998 Vali Acc: 0.717 Test Loss: 0.998 Test Acc: 0.717
Validation loss decreased (-0.618410 --> -0.717095).  Saving model ...
Epoch: 9 cost time: 3.8165442943573
Epoch: 9, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.918 Vali Acc: 0.737 Test Loss: 0.918 Test Acc: 0.737
Validation loss decreased (-0.717095 --> -0.736833).  Saving model ...
Epoch: 10 cost time: 3.4985032081604004
Epoch: 10, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.840 Vali Acc: 0.776 Test Loss: 0.840 Test Acc: 0.776
Validation loss decreased (-0.736833 --> -0.776307).  Saving model ...
Epoch: 11 cost time: 3.3156943321228027
Epoch: 11, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.761 Vali Acc: 0.796 Test Loss: 0.761 Test Acc: 0.796
Validation loss decreased (-0.776307 --> -0.796045).  Saving model ...
Epoch: 12 cost time: 3.3417253494262695
Epoch: 12, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.694 Vali Acc: 0.789 Test Loss: 0.694 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.744112253189087
Epoch: 13, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6289334297180176
Epoch: 14, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
Validation loss decreased (-0.796045 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 3.418381929397583
Epoch: 15, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6117045879364014
Epoch: 16, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.851184844970703
Epoch: 17, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6724987030029297
Epoch: 18, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7604336738586426
Epoch: 19, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.490 Vali Acc: 0.776 Test Loss: 0.490 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.41923451423645
Epoch: 20, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6539146900177
Epoch: 21, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.766129493713379
Epoch: 22, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.611639976501465
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5217976570129395
Epoch: 24, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1174340
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.047423601150513
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.405 Vali Acc: 0.237 Test Loss: 1.405 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 2.6188433170318604
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.373 Vali Acc: 0.283 Test Loss: 1.373 Test Acc: 0.283
Validation loss decreased (-0.236828 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.2641069889068604
Epoch: 3, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.333 Vali Acc: 0.336 Test Loss: 1.333 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 2.254199743270874
Epoch: 4, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.287 Vali Acc: 0.362 Test Loss: 1.287 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 2.5466763973236084
Epoch: 5, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.237 Vali Acc: 0.447 Test Loss: 1.237 Test Acc: 0.447
Validation loss decreased (-0.361829 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 2.4100160598754883
Epoch: 6, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.178 Vali Acc: 0.539 Test Loss: 1.178 Test Acc: 0.539
Validation loss decreased (-0.447356 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 2.755199909210205
Epoch: 7, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.107 Vali Acc: 0.553 Test Loss: 1.107 Test Acc: 0.553
Validation loss decreased (-0.539462 --> -0.552621).  Saving model ...
Epoch: 8 cost time: 2.5423779487609863
Epoch: 8, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.037 Vali Acc: 0.599 Test Loss: 1.037 Test Acc: 0.599
Validation loss decreased (-0.552621 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 2.4417762756347656
Epoch: 9, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.960 Vali Acc: 0.625 Test Loss: 0.960 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 2.5010881423950195
Epoch: 10, Steps: 10 | Train Loss: 0.841 Vali Loss: 0.886 Vali Acc: 0.671 Test Loss: 0.886 Test Acc: 0.671
Validation loss decreased (-0.624990 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 2.6495201587677
Epoch: 11, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.832 Vali Acc: 0.697 Test Loss: 0.832 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697360).  Saving model ...
Epoch: 12 cost time: 2.6243650913238525
Epoch: 12, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.773 Vali Acc: 0.743 Test Loss: 0.773 Test Acc: 0.743
Validation loss decreased (-0.697360 --> -0.743413).  Saving model ...
Epoch: 13 cost time: 2.710009813308716
Epoch: 13, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.705 Vali Acc: 0.763 Test Loss: 0.705 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 2.3618428707122803
Epoch: 14, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 15 cost time: 2.3069534301757812
Epoch: 15, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.646 Vali Acc: 0.776 Test Loss: 0.646 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 2.7384657859802246
Epoch: 16, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 2.6888480186462402
Epoch: 17, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 2.66912579536438
Epoch: 18, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 2.646986961364746
Epoch: 19, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 2.565084934234619
Epoch: 20, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 2.55513596534729
Epoch: 21, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5321547985076904
Epoch: 22, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 2.249913454055786
Epoch: 23, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 24 cost time: 2.154590129852295
Epoch: 24, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.055361747741699
Epoch: 25, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.988133430480957
Epoch: 26, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.531 Vali Acc: 0.816 Test Loss: 0.531 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.733036994934082
Epoch: 27, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.64681077003479
Epoch: 28, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.9150662422180176
Epoch: 29, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.8038017749786377
Epoch: 30, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 346372
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.600134611129761
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.355 Vali Acc: 0.336 Test Loss: 1.355 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 3.3108017444610596
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.321 Vali Acc: 0.388 Test Loss: 1.321 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 3.523799419403076
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.280 Vali Acc: 0.408 Test Loss: 1.280 Test Acc: 0.408
Validation loss decreased (-0.388145 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 3.288383722305298
Epoch: 4, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.234 Vali Acc: 0.447 Test Loss: 1.234 Test Acc: 0.447
Validation loss decreased (-0.407882 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 3.2113449573516846
Epoch: 5, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.180 Vali Acc: 0.487 Test Loss: 1.180 Test Acc: 0.487
Validation loss decreased (-0.447356 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 3.706031322479248
Epoch: 6, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.122 Vali Acc: 0.553 Test Loss: 1.122 Test Acc: 0.553
Validation loss decreased (-0.486830 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 3.641054630279541
Epoch: 7, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.065 Vali Acc: 0.638 Test Loss: 1.065 Test Acc: 0.638
Validation loss decreased (-0.552620 --> -0.638147).  Saving model ...
Epoch: 8 cost time: 3.3322031497955322
Epoch: 8, Steps: 10 | Train Loss: 0.952 Vali Loss: 0.987 Vali Acc: 0.724 Test Loss: 0.987 Test Acc: 0.724
Validation loss decreased (-0.638147 --> -0.723674).  Saving model ...
Epoch: 9 cost time: 3.655003070831299
Epoch: 9, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.903 Vali Acc: 0.743 Test Loss: 0.903 Test Acc: 0.743
Validation loss decreased (-0.723674 --> -0.743412).  Saving model ...
Epoch: 10 cost time: 3.4931771755218506
Epoch: 10, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.825 Vali Acc: 0.783 Test Loss: 0.825 Test Acc: 0.783
Validation loss decreased (-0.743412 --> -0.782886).  Saving model ...
Epoch: 11 cost time: 3.5879125595092773
Epoch: 11, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
Validation loss decreased (-0.782886 --> -0.789466).  Saving model ...
Epoch: 12 cost time: 3.4127137660980225
Epoch: 12, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.691 Vali Acc: 0.783 Test Loss: 0.691 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0751609802246094
Epoch: 13, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6820878982543945
Epoch: 14, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.690976619720459
Epoch: 15, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7437641620635986
Epoch: 16, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.5997767448425293
Epoch: 17, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.195910692214966
Epoch: 18, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.378161907196045
Epoch: 19, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 3.194061040878296
Epoch: 20, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 3.08476185798645
Epoch: 21, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 3.3461461067199707
Epoch: 22, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 23 cost time: 2.921529769897461
Epoch: 23, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2830824851989746
Epoch: 24, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7326908111572266
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.50250506401062
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 27 cost time: 3.4037563800811768
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.453462600708008
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 29 cost time: 3.2892422676086426
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.00008225440979
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1174340
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.460984945297241
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.5199103355407715
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.364 Vali Acc: 0.289 Test Loss: 1.364 Test Acc: 0.289
Validation loss decreased (-0.243407 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 2.6091620922088623
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.321 Vali Acc: 0.342 Test Loss: 1.321 Test Acc: 0.342
Validation loss decreased (-0.289460 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 2.453298568725586
Epoch: 4, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.273 Vali Acc: 0.375 Test Loss: 1.273 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 2.343216896057129
Epoch: 5, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.220 Vali Acc: 0.454 Test Loss: 1.220 Test Acc: 0.454
Validation loss decreased (-0.374987 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 2.2123169898986816
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.157 Vali Acc: 0.546 Test Loss: 1.157 Test Acc: 0.546
Validation loss decreased (-0.453935 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 2.7778451442718506
Epoch: 7, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.085 Vali Acc: 0.612 Test Loss: 1.085 Test Acc: 0.612
Validation loss decreased (-0.546041 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 2.225114583969116
Epoch: 8, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.017 Vali Acc: 0.638 Test Loss: 1.017 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638148).  Saving model ...
Epoch: 9 cost time: 2.340059995651245
Epoch: 9, Steps: 10 | Train Loss: 0.906 Vali Loss: 0.941 Vali Acc: 0.678 Test Loss: 0.941 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677622).  Saving model ...
Epoch: 10 cost time: 2.1863319873809814
Epoch: 10, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.868 Vali Acc: 0.717 Test Loss: 0.868 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 11 cost time: 2.401840925216675
Epoch: 11, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.815 Vali Acc: 0.724 Test Loss: 0.815 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723676).  Saving model ...
Epoch: 12 cost time: 2.4711508750915527
Epoch: 12, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.767 Vali Acc: 0.724 Test Loss: 0.767 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 13 cost time: 2.6751296520233154
Epoch: 13, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 2.2029221057891846
Epoch: 14, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 15 cost time: 2.311539649963379
Epoch: 15, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 16 cost time: 2.4137985706329346
Epoch: 16, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 2.2986037731170654
Epoch: 17, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
Validation loss decreased (-0.769731 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 2.300579786300659
Epoch: 18, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 2.3687503337860107
Epoch: 19, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5019583702087402
Epoch: 20, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 21 cost time: 2.5111477375030518
Epoch: 21, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5595908164978027
Epoch: 22, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4522223472595215
Epoch: 23, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.486478328704834
Epoch: 24, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6703109741210938
Epoch: 25, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6935651302337646
Epoch: 26, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.280195474624634
Epoch: 27, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5702362060546875
Epoch: 28, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.770782709121704
Epoch: 29, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5036113262176514
Epoch: 30, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 346372
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.336616039276123
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.358 Vali Acc: 0.322 Test Loss: 1.358 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 2.766610622406006
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.335 Vali Acc: 0.355 Test Loss: 1.335 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 3.0201289653778076
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.318 Vali Acc: 0.368 Test Loss: 1.318 Test Acc: 0.368
Validation loss decreased (-0.355250 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.5395402908325195
Epoch: 4, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.296 Vali Acc: 0.388 Test Loss: 1.296 Test Acc: 0.388
Validation loss decreased (-0.368408 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 2.4786863327026367
Epoch: 5, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.271 Vali Acc: 0.421 Test Loss: 1.271 Test Acc: 0.421
Validation loss decreased (-0.388145 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 2.560568332672119
Epoch: 6, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.243 Vali Acc: 0.480 Test Loss: 1.243 Test Acc: 0.480
Validation loss decreased (-0.421040 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 2.5749802589416504
Epoch: 7, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.212 Vali Acc: 0.526 Test Loss: 1.212 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526304).  Saving model ...
Epoch: 8 cost time: 2.93697190284729
Epoch: 8, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.160 Vali Acc: 0.599 Test Loss: 1.160 Test Acc: 0.599
Validation loss decreased (-0.526304 --> -0.598673).  Saving model ...
Epoch: 9 cost time: 2.9177539348602295
Epoch: 9, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.082 Vali Acc: 0.645 Test Loss: 1.082 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644726).  Saving model ...
Epoch: 10 cost time: 2.775120258331299
Epoch: 10, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.035 Vali Acc: 0.684 Test Loss: 1.035 Test Acc: 0.684
Validation loss decreased (-0.644726 --> -0.684200).  Saving model ...
Epoch: 11 cost time: 2.752091884613037
Epoch: 11, Steps: 10 | Train Loss: 0.960 Vali Loss: 0.988 Vali Acc: 0.684 Test Loss: 0.988 Test Acc: 0.684
Validation loss decreased (-0.684200 --> -0.684201).  Saving model ...
Epoch: 12 cost time: 2.691258192062378
Epoch: 12, Steps: 10 | Train Loss: 0.934 Vali Loss: 0.959 Vali Acc: 0.664 Test Loss: 0.959 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7471601963043213
Epoch: 13, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.912 Vali Acc: 0.704 Test Loss: 0.912 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703938).  Saving model ...
Epoch: 14 cost time: 2.8887999057769775
Epoch: 14, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.884 Vali Acc: 0.704 Test Loss: 0.884 Test Acc: 0.704
Validation loss decreased (-0.703938 --> -0.703939).  Saving model ...
Epoch: 15 cost time: 2.7348713874816895
Epoch: 15, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.851 Vali Acc: 0.737 Test Loss: 0.851 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736834).  Saving model ...
Epoch: 16 cost time: 2.711282253265381
Epoch: 16, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.811 Vali Acc: 0.743 Test Loss: 0.811 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 17 cost time: 2.7328298091888428
Epoch: 17, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.762 Vali Acc: 0.757 Test Loss: 0.762 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756571).  Saving model ...
Epoch: 18 cost time: 2.733900547027588
Epoch: 18, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2054152488708496
Epoch: 19, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
Validation loss decreased (-0.756571 --> -0.789466).  Saving model ...
Epoch: 20 cost time: 2.1882522106170654
Epoch: 20, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
Validation loss decreased (-0.789466 --> -0.789467).  Saving model ...
Epoch: 21 cost time: 2.3545730113983154
Epoch: 21, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7383623123168945
Epoch: 22, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.660686492919922
Epoch: 23, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 2.668708562850952
Epoch: 24, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.756436586380005
Epoch: 25, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.634662628173828
Epoch: 26, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.828946590423584
Epoch: 27, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5078344345092773
Epoch: 28, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.623744249343872
Epoch: 29, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.4671616554260254
Epoch: 30, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1174340
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.031533241271973
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.395 Vali Acc: 0.250 Test Loss: 1.395 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.255992889404297
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.376 Vali Acc: 0.276 Test Loss: 1.376 Test Acc: 0.276
Validation loss decreased (-0.249986 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 2.366732358932495
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.345 Vali Acc: 0.289 Test Loss: 1.345 Test Acc: 0.289
Validation loss decreased (-0.276302 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 2.1063649654388428
Epoch: 4, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.322 Vali Acc: 0.316 Test Loss: 1.322 Test Acc: 0.316
Validation loss decreased (-0.289460 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 2.266092300415039
Epoch: 5, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.296 Vali Acc: 0.355 Test Loss: 1.296 Test Acc: 0.355
Validation loss decreased (-0.315776 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 2.1523337364196777
Epoch: 6, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.267 Vali Acc: 0.428 Test Loss: 1.267 Test Acc: 0.428
Validation loss decreased (-0.355250 --> -0.427619).  Saving model ...
Epoch: 7 cost time: 2.3045737743377686
Epoch: 7, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.230 Vali Acc: 0.467 Test Loss: 1.230 Test Acc: 0.467
Validation loss decreased (-0.427619 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 2.1324174404144287
Epoch: 8, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.196 Vali Acc: 0.507 Test Loss: 1.196 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 9 cost time: 2.2819621562957764
Epoch: 9, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.157 Vali Acc: 0.572 Test Loss: 1.157 Test Acc: 0.572
Validation loss decreased (-0.506567 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 2.1192870140075684
Epoch: 10, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.120 Vali Acc: 0.572 Test Loss: 1.120 Test Acc: 0.572
Validation loss decreased (-0.572357 --> -0.572357).  Saving model ...
Epoch: 11 cost time: 2.155728340148926
Epoch: 11, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.088 Vali Acc: 0.586 Test Loss: 1.088 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 12 cost time: 2.2494285106658936
Epoch: 12, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.052 Vali Acc: 0.605 Test Loss: 1.052 Test Acc: 0.605
Validation loss decreased (-0.585515 --> -0.605253).  Saving model ...
Epoch: 13 cost time: 2.0697810649871826
Epoch: 13, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.010 Vali Acc: 0.586 Test Loss: 1.010 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.676245927810669
Epoch: 14, Steps: 10 | Train Loss: 0.987 Vali Loss: 0.967 Vali Acc: 0.592 Test Loss: 0.967 Test Acc: 0.592
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8956918716430664
Epoch: 15, Steps: 10 | Train Loss: 0.960 Vali Loss: 0.928 Vali Acc: 0.632 Test Loss: 0.928 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631570).  Saving model ...
Epoch: 16 cost time: 2.0526063442230225
Epoch: 16, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.892 Vali Acc: 0.645 Test Loss: 0.892 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 17 cost time: 1.8688771724700928
Epoch: 17, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.857 Vali Acc: 0.664 Test Loss: 0.857 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664465).  Saving model ...
Epoch: 18 cost time: 2.128283977508545
Epoch: 18, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.828 Vali Acc: 0.684 Test Loss: 0.828 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 19 cost time: 2.1543538570404053
Epoch: 19, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.788 Vali Acc: 0.697 Test Loss: 0.788 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 2.054696559906006
Epoch: 20, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 21 cost time: 2.097710609436035
Epoch: 21, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717098).  Saving model ...
Epoch: 22 cost time: 2.115058183670044
Epoch: 22, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.719 Vali Acc: 0.743 Test Loss: 0.719 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 2.0878496170043945
Epoch: 23, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.700 Vali Acc: 0.724 Test Loss: 0.700 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.115117073059082
Epoch: 24, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 25 cost time: 2.1532044410705566
Epoch: 25, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.625 Vali Acc: 0.776 Test Loss: 0.625 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 2.170614004135132
Epoch: 26, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.952871322631836
Epoch: 27, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0084609985351562
Epoch: 28, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 2.024620532989502
Epoch: 29, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9542694091796875
Epoch: 30, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 346372
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.6951282024383545
Epoch: 1, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.325 Vali Acc: 0.336 Test Loss: 1.325 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 3.4302501678466797
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.335513 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 3.555485248565674
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.277 Vali Acc: 0.434 Test Loss: 1.277 Test Acc: 0.434
Validation loss decreased (-0.374987 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 3.375332832336426
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.242 Vali Acc: 0.487 Test Loss: 1.242 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 3.9314591884613037
Epoch: 5, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.203 Vali Acc: 0.533 Test Loss: 1.203 Test Acc: 0.533
Validation loss decreased (-0.486830 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 3.70005464553833
Epoch: 6, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.157 Vali Acc: 0.546 Test Loss: 1.157 Test Acc: 0.546
Validation loss decreased (-0.532883 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 3.112896680831909
Epoch: 7, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.107 Vali Acc: 0.579 Test Loss: 1.107 Test Acc: 0.579
Validation loss decreased (-0.546041 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 3.3034489154815674
Epoch: 8, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.054 Vali Acc: 0.605 Test Loss: 1.054 Test Acc: 0.605
Validation loss decreased (-0.578936 --> -0.605253).  Saving model ...
Epoch: 9 cost time: 3.376187801361084
Epoch: 9, Steps: 10 | Train Loss: 0.986 Vali Loss: 0.995 Vali Acc: 0.638 Test Loss: 0.995 Test Acc: 0.638
Validation loss decreased (-0.605253 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 3.2411086559295654
Epoch: 10, Steps: 10 | Train Loss: 0.899 Vali Loss: 0.935 Vali Acc: 0.658 Test Loss: 0.935 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 11 cost time: 3.06410551071167
Epoch: 11, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.881 Vali Acc: 0.711 Test Loss: 0.881 Test Acc: 0.711
Validation loss decreased (-0.657885 --> -0.710518).  Saving model ...
Epoch: 12 cost time: 3.205620527267456
Epoch: 12, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.830 Vali Acc: 0.730 Test Loss: 0.830 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 13 cost time: 3.3402061462402344
Epoch: 13, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.780 Vali Acc: 0.724 Test Loss: 0.780 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.463192939758301
Epoch: 14, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.737 Vali Acc: 0.743 Test Loss: 0.737 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 15 cost time: 2.54042387008667
Epoch: 15, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.703 Vali Acc: 0.757 Test Loss: 0.703 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 3.296769618988037
Epoch: 16, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2350704669952393
Epoch: 17, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 18 cost time: 3.237494468688965
Epoch: 18, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 2.958040475845337
Epoch: 19, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 3.1899375915527344
Epoch: 20, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 3.6059741973876953
Epoch: 21, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 3.2079718112945557
Epoch: 22, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4600672721862793
Epoch: 23, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815784).  Saving model ...
Epoch: 24 cost time: 3.530555248260498
Epoch: 24, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.560256004333496
Epoch: 25, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5794007778167725
Epoch: 26, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.750746250152588
Epoch: 27, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.677130699157715
Epoch: 28, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.33917498588562
Epoch: 29, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0602190494537354
Epoch: 30, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 587844
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.471421003341675
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.424 Vali Acc: 0.250 Test Loss: 1.424 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.3463151454925537
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.382 Vali Acc: 0.263 Test Loss: 1.382 Test Acc: 0.263
Validation loss decreased (-0.249986 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 2.6500368118286133
Epoch: 3, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.329 Vali Acc: 0.303 Test Loss: 1.329 Test Acc: 0.303
Validation loss decreased (-0.263144 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 2.513664960861206
Epoch: 4, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.276 Vali Acc: 0.395 Test Loss: 1.276 Test Acc: 0.395
Validation loss decreased (-0.302618 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 2.4430766105651855
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.225 Vali Acc: 0.493 Test Loss: 1.225 Test Acc: 0.493
Validation loss decreased (-0.394724 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 2.589492082595825
Epoch: 6, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.177 Vali Acc: 0.553 Test Loss: 1.177 Test Acc: 0.553
Validation loss decreased (-0.493409 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 2.653932809829712
Epoch: 7, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.134 Vali Acc: 0.559 Test Loss: 1.134 Test Acc: 0.559
Validation loss decreased (-0.552620 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 2.5869505405426025
Epoch: 8, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.559199 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 2.3369767665863037
Epoch: 9, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.037 Vali Acc: 0.638 Test Loss: 1.037 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 2.3321661949157715
Epoch: 10, Steps: 10 | Train Loss: 0.987 Vali Loss: 0.987 Vali Acc: 0.651 Test Loss: 0.987 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 2.3605828285217285
Epoch: 11, Steps: 10 | Train Loss: 0.939 Vali Loss: 0.935 Vali Acc: 0.717 Test Loss: 0.935 Test Acc: 0.717
Validation loss decreased (-0.651306 --> -0.717096).  Saving model ...
Epoch: 12 cost time: 2.388359546661377
Epoch: 12, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
Validation loss decreased (-0.717096 --> -0.717096).  Saving model ...
Epoch: 13 cost time: 2.4926297664642334
Epoch: 13, Steps: 10 | Train Loss: 0.784 Vali Loss: 0.850 Vali Acc: 0.743 Test Loss: 0.850 Test Acc: 0.743
Validation loss decreased (-0.717096 --> -0.743413).  Saving model ...
Epoch: 14 cost time: 2.421205520629883
Epoch: 14, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.799 Vali Acc: 0.770 Test Loss: 0.799 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769729).  Saving model ...
Epoch: 15 cost time: 2.3046247959136963
Epoch: 15, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.763 Vali Acc: 0.757 Test Loss: 0.763 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1748180389404297
Epoch: 16, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.746 Vali Acc: 0.770 Test Loss: 0.746 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769729).  Saving model ...
Epoch: 17 cost time: 2.619868040084839
Epoch: 17, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782888).  Saving model ...
Epoch: 18 cost time: 2.7618114948272705
Epoch: 18, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 19 cost time: 2.481269359588623
Epoch: 19, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 20 cost time: 2.784475564956665
Epoch: 20, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.584414482116699
Epoch: 21, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.679703950881958
Epoch: 22, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.587090253829956
Epoch: 23, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 24 cost time: 2.4483375549316406
Epoch: 24, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.635067939758301
Epoch: 25, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5628838539123535
Epoch: 26, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.393216133117676
Epoch: 27, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 28 cost time: 2.4254698753356934
Epoch: 28, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6268789768218994
Epoch: 29, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.762838125228882
Epoch: 30, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 173828
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.034796953201294
Epoch: 1, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.325 Vali Acc: 0.342 Test Loss: 1.325 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 2.788675546646118
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.304 Vali Acc: 0.395 Test Loss: 1.304 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 2.6227622032165527
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.275 Vali Acc: 0.441 Test Loss: 1.275 Test Acc: 0.441
Validation loss decreased (-0.394724 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 2.2018344402313232
Epoch: 4, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.240 Vali Acc: 0.507 Test Loss: 1.240 Test Acc: 0.507
Validation loss decreased (-0.440777 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 2.065078020095825
Epoch: 5, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.198 Vali Acc: 0.533 Test Loss: 1.198 Test Acc: 0.533
Validation loss decreased (-0.506567 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 2.0382535457611084
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.152 Vali Acc: 0.539 Test Loss: 1.152 Test Acc: 0.539
Validation loss decreased (-0.532883 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.9856984615325928
Epoch: 7, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.102 Vali Acc: 0.586 Test Loss: 1.102 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 2.498461961746216
Epoch: 8, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.048 Vali Acc: 0.592 Test Loss: 1.048 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592095).  Saving model ...
Epoch: 9 cost time: 2.5979554653167725
Epoch: 9, Steps: 10 | Train Loss: 0.986 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
Validation loss decreased (-0.592095 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 2.718585968017578
Epoch: 10, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.931 Vali Acc: 0.658 Test Loss: 0.931 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657885).  Saving model ...
Epoch: 11 cost time: 2.5946383476257324
Epoch: 11, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.879 Vali Acc: 0.697 Test Loss: 0.879 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697360).  Saving model ...
Epoch: 12 cost time: 2.7140016555786133
Epoch: 12, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.823 Vali Acc: 0.711 Test Loss: 0.823 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710518).  Saving model ...
Epoch: 13 cost time: 2.5395548343658447
Epoch: 13, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.774 Vali Acc: 0.724 Test Loss: 0.774 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723676).  Saving model ...
Epoch: 14 cost time: 2.767408847808838
Epoch: 14, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.726 Vali Acc: 0.730 Test Loss: 0.726 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 2.580918550491333
Epoch: 15, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.680 Vali Acc: 0.757 Test Loss: 0.680 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 2.9095962047576904
Epoch: 16, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.550471305847168
Epoch: 17, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 18 cost time: 2.832733631134033
Epoch: 18, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 2.653052568435669
Epoch: 19, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 2.4014337062835693
Epoch: 20, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 2.6588120460510254
Epoch: 21, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.046431064605713
Epoch: 22, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.561509847640991
Epoch: 23, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.801018714904785
Epoch: 24, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.0178394317626953
Epoch: 25, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 2.9127037525177
Epoch: 26, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 2.7832159996032715
Epoch: 27, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2252745628356934
Epoch: 28, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8933024406433105
Epoch: 29, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.547 Vali Acc: 0.822 Test Loss: 0.547 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 30 cost time: 2.543238639831543
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 587844
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.588919639587402
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.2757458686828613
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (-0.249986 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.446150779724121
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.327 Vali Acc: 0.296 Test Loss: 1.327 Test Acc: 0.296
Validation loss decreased (-0.269723 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 2.5280861854553223
Epoch: 4, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.271 Vali Acc: 0.382 Test Loss: 1.271 Test Acc: 0.382
Validation loss decreased (-0.296039 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 2.5088820457458496
Epoch: 5, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.217 Vali Acc: 0.520 Test Loss: 1.217 Test Acc: 0.520
Validation loss decreased (-0.381566 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 2.626300573348999
Epoch: 6, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.167 Vali Acc: 0.559 Test Loss: 1.167 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 2.6328983306884766
Epoch: 7, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.121 Vali Acc: 0.592 Test Loss: 1.121 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 2.365739107131958
Epoch: 8, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.075 Vali Acc: 0.632 Test Loss: 1.075 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631568).  Saving model ...
Epoch: 9 cost time: 2.777294397354126
Epoch: 9, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.025 Vali Acc: 0.658 Test Loss: 1.025 Test Acc: 0.658
Validation loss decreased (-0.631568 --> -0.657884).  Saving model ...
Epoch: 10 cost time: 2.6702075004577637
Epoch: 10, Steps: 10 | Train Loss: 0.982 Vali Loss: 0.980 Vali Acc: 0.684 Test Loss: 0.980 Test Acc: 0.684
Validation loss decreased (-0.657884 --> -0.684201).  Saving model ...
Epoch: 11 cost time: 2.536409854888916
Epoch: 11, Steps: 10 | Train Loss: 0.932 Vali Loss: 0.929 Vali Acc: 0.711 Test Loss: 0.929 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710517).  Saving model ...
Epoch: 12 cost time: 2.425013303756714
Epoch: 12, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.881 Vali Acc: 0.724 Test Loss: 0.881 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723675).  Saving model ...
Epoch: 13 cost time: 2.5976879596710205
Epoch: 13, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.855 Vali Acc: 0.737 Test Loss: 0.855 Test Acc: 0.737
Validation loss decreased (-0.723675 --> -0.736834).  Saving model ...
Epoch: 14 cost time: 2.6117827892303467
Epoch: 14, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.807 Vali Acc: 0.730 Test Loss: 0.807 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.472947120666504
Epoch: 15, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.773 Vali Acc: 0.757 Test Loss: 0.773 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756571).  Saving model ...
Epoch: 16 cost time: 2.6558566093444824
Epoch: 16, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.757 Vali Acc: 0.757 Test Loss: 0.757 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756571).  Saving model ...
Epoch: 17 cost time: 2.6700894832611084
Epoch: 17, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.715 Vali Acc: 0.763 Test Loss: 0.715 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763151).  Saving model ...
Epoch: 18 cost time: 2.5048892498016357
Epoch: 18, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.706 Vali Acc: 0.763 Test Loss: 0.706 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 19 cost time: 2.684486150741577
Epoch: 19, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 2.57914400100708
Epoch: 20, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 21 cost time: 2.6228063106536865
Epoch: 21, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 22 cost time: 2.94919490814209
Epoch: 22, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 23 cost time: 2.730095148086548
Epoch: 23, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6844632625579834
Epoch: 24, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.704648017883301
Epoch: 25, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.519380569458008
Epoch: 26, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.649 Vali Acc: 0.776 Test Loss: 0.649 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.469935894012451
Epoch: 27, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.6824822425842285
Epoch: 28, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.485678195953369
Epoch: 29, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.674 Vali Acc: 0.770 Test Loss: 0.674 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3709492683410645
Epoch: 30, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.673 Vali Acc: 0.783 Test Loss: 0.673 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 173828
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.046116352081299
Epoch: 1, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.321 Vali Acc: 0.342 Test Loss: 1.321 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 2.496227502822876
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.311 Vali Acc: 0.362 Test Loss: 1.311 Test Acc: 0.362
Validation loss decreased (-0.342092 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 2.73683500289917
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.292 Vali Acc: 0.428 Test Loss: 1.292 Test Acc: 0.428
Validation loss decreased (-0.361829 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 2.392080783843994
Epoch: 4, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.267 Vali Acc: 0.454 Test Loss: 1.267 Test Acc: 0.454
Validation loss decreased (-0.427619 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 2.630030870437622
Epoch: 5, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.235 Vali Acc: 0.513 Test Loss: 1.235 Test Acc: 0.513
Validation loss decreased (-0.453935 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 2.38574481010437
Epoch: 6, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.204 Vali Acc: 0.513 Test Loss: 1.204 Test Acc: 0.513
Validation loss decreased (-0.513146 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 2.19415020942688
Epoch: 7, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.170 Vali Acc: 0.553 Test Loss: 1.170 Test Acc: 0.553
Validation loss decreased (-0.513146 --> -0.552620).  Saving model ...
Epoch: 8 cost time: 2.277974843978882
Epoch: 8, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.134 Vali Acc: 0.605 Test Loss: 1.134 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605252).  Saving model ...
Epoch: 9 cost time: 2.3652989864349365
Epoch: 9, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.091 Vali Acc: 0.618 Test Loss: 1.091 Test Acc: 0.618
Validation loss decreased (-0.605252 --> -0.618410).  Saving model ...
Epoch: 10 cost time: 2.33193039894104
Epoch: 10, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.043 Vali Acc: 0.618 Test Loss: 1.043 Test Acc: 0.618
Validation loss decreased (-0.618410 --> -0.618411).  Saving model ...
Epoch: 11 cost time: 2.2375543117523193
Epoch: 11, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.000 Vali Acc: 0.671 Test Loss: 1.000 Test Acc: 0.671
Validation loss decreased (-0.618411 --> -0.671043).  Saving model ...
Epoch: 12 cost time: 2.4017045497894287
Epoch: 12, Steps: 10 | Train Loss: 0.968 Vali Loss: 0.949 Vali Acc: 0.691 Test Loss: 0.949 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690780).  Saving model ...
Epoch: 13 cost time: 2.137836217880249
Epoch: 13, Steps: 10 | Train Loss: 0.966 Vali Loss: 0.896 Vali Acc: 0.750 Test Loss: 0.896 Test Acc: 0.750
Validation loss decreased (-0.690780 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 2.7885043621063232
Epoch: 14, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.846 Vali Acc: 0.757 Test Loss: 0.846 Test Acc: 0.757
Validation loss decreased (-0.749991 --> -0.756570).  Saving model ...
Epoch: 15 cost time: 2.7049429416656494
Epoch: 15, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.815 Vali Acc: 0.763 Test Loss: 0.815 Test Acc: 0.763
Validation loss decreased (-0.756570 --> -0.763150).  Saving model ...
Epoch: 16 cost time: 2.944554328918457
Epoch: 16, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.783 Vali Acc: 0.770 Test Loss: 0.783 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769729).  Saving model ...
Epoch: 17 cost time: 2.4003424644470215
Epoch: 17, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.753 Vali Acc: 0.757 Test Loss: 0.753 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.593438148498535
Epoch: 18, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.714 Vali Acc: 0.763 Test Loss: 0.714 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4084386825561523
Epoch: 19, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.693 Vali Acc: 0.783 Test Loss: 0.693 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782888).  Saving model ...
Epoch: 20 cost time: 2.275784492492676
Epoch: 20, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 2.128171682357788
Epoch: 21, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 22 cost time: 2.5235939025878906
Epoch: 22, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.501582384109497
Epoch: 23, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809205).  Saving model ...
Epoch: 24 cost time: 2.4984376430511475
Epoch: 24, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 25 cost time: 2.2536211013793945
Epoch: 25, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.528 Vali Acc: 0.822 Test Loss: 0.528 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 26 cost time: 2.196662664413452
Epoch: 26, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.494 Vali Acc: 0.829 Test Loss: 0.494 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 27 cost time: 2.314450263977051
Epoch: 27, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 28 cost time: 2.5405306816101074
Epoch: 28, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4157423973083496
Epoch: 29, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3082547187805176
Epoch: 30, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 587844
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.177281618118286
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.423 Vali Acc: 0.263 Test Loss: 1.423 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.158144950866699
Epoch: 2, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 2.0685524940490723
Epoch: 3, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.360 Vali Acc: 0.283 Test Loss: 1.360 Test Acc: 0.283
Validation loss decreased (-0.269723 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 1.730398416519165
Epoch: 4, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.326 Vali Acc: 0.322 Test Loss: 1.326 Test Acc: 0.322
Validation loss decreased (-0.282881 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 1.547518253326416
Epoch: 5, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.295 Vali Acc: 0.408 Test Loss: 1.295 Test Acc: 0.408
Validation loss decreased (-0.322355 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 1.4201931953430176
Epoch: 6, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.269 Vali Acc: 0.441 Test Loss: 1.269 Test Acc: 0.441
Validation loss decreased (-0.407882 --> -0.440777).  Saving model ...
Epoch: 7 cost time: 1.7226574420928955
Epoch: 7, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.242 Vali Acc: 0.474 Test Loss: 1.242 Test Acc: 0.474
Validation loss decreased (-0.440777 --> -0.473672).  Saving model ...
Epoch: 8 cost time: 2.050584316253662
Epoch: 8, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.219 Vali Acc: 0.493 Test Loss: 1.219 Test Acc: 0.493
Validation loss decreased (-0.473672 --> -0.493409).  Saving model ...
Epoch: 9 cost time: 2.2912790775299072
Epoch: 9, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.200 Vali Acc: 0.493 Test Loss: 1.200 Test Acc: 0.493
Validation loss decreased (-0.493409 --> -0.493409).  Saving model ...
Epoch: 10 cost time: 2.0731372833251953
Epoch: 10, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.175 Vali Acc: 0.493 Test Loss: 1.175 Test Acc: 0.493
Validation loss decreased (-0.493409 --> -0.493409).  Saving model ...
Epoch: 11 cost time: 2.2607762813568115
Epoch: 11, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.147 Vali Acc: 0.526 Test Loss: 1.147 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 12 cost time: 2.226412057876587
Epoch: 12, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.526304 --> -0.572357).  Saving model ...
Epoch: 13 cost time: 2.4309070110321045
Epoch: 13, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.082 Vali Acc: 0.566 Test Loss: 1.082 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2677242755889893
Epoch: 14, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.044 Vali Acc: 0.586 Test Loss: 1.044 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585516).  Saving model ...
Epoch: 15 cost time: 2.208503484725952
Epoch: 15, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.008 Vali Acc: 0.599 Test Loss: 1.008 Test Acc: 0.599
Validation loss decreased (-0.585516 --> -0.598674).  Saving model ...
Epoch: 16 cost time: 2.032939910888672
Epoch: 16, Steps: 10 | Train Loss: 0.985 Vali Loss: 0.983 Vali Acc: 0.586 Test Loss: 0.983 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2674741744995117
Epoch: 17, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.955 Vali Acc: 0.605 Test Loss: 0.955 Test Acc: 0.605
Validation loss decreased (-0.598674 --> -0.605254).  Saving model ...
Epoch: 18 cost time: 2.056971549987793
Epoch: 18, Steps: 10 | Train Loss: 0.798 Vali Loss: 0.911 Vali Acc: 0.612 Test Loss: 0.911 Test Acc: 0.612
Validation loss decreased (-0.605254 --> -0.611833).  Saving model ...
Epoch: 19 cost time: 2.0910451412200928
Epoch: 19, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.875 Vali Acc: 0.638 Test Loss: 0.875 Test Acc: 0.638
Validation loss decreased (-0.611833 --> -0.638149).  Saving model ...
Epoch: 20 cost time: 2.3282406330108643
Epoch: 20, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.851 Vali Acc: 0.645 Test Loss: 0.851 Test Acc: 0.645
Validation loss decreased (-0.638149 --> -0.644728).  Saving model ...
Epoch: 21 cost time: 2.1660518646240234
Epoch: 21, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.819 Vali Acc: 0.651 Test Loss: 0.819 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651308).  Saving model ...
Epoch: 22 cost time: 1.939063310623169
Epoch: 22, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.794 Vali Acc: 0.678 Test Loss: 0.794 Test Acc: 0.678
Validation loss decreased (-0.651308 --> -0.677624).  Saving model ...
Epoch: 23 cost time: 2.137840747833252
Epoch: 23, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.767 Vali Acc: 0.697 Test Loss: 0.767 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 24 cost time: 2.265137195587158
Epoch: 24, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.782 Vali Acc: 0.691 Test Loss: 0.782 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.16325306892395
Epoch: 25, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.754 Vali Acc: 0.704 Test Loss: 0.754 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 26 cost time: 2.2462058067321777
Epoch: 26, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.707 Vali Acc: 0.730 Test Loss: 0.707 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730256).  Saving model ...
Epoch: 27 cost time: 2.280083417892456
Epoch: 27, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2061119079589844
Epoch: 28, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.686 Vali Acc: 0.697 Test Loss: 0.686 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1739702224731445
Epoch: 29, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.682 Vali Acc: 0.711 Test Loss: 0.682 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2007625102996826
Epoch: 30, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.662 Vali Acc: 0.697 Test Loss: 0.662 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7302631578947368
model parameter : 173828
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.821511507034302
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 2.7974302768707275
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.362 Vali Acc: 0.289 Test Loss: 1.362 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 2.648818254470825
Epoch: 3, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.334 Vali Acc: 0.322 Test Loss: 1.334 Test Acc: 0.322
Validation loss decreased (-0.289460 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 2.808634042739868
Epoch: 4, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.301 Vali Acc: 0.349 Test Loss: 1.301 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 2.7414872646331787
Epoch: 5, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.268 Vali Acc: 0.401 Test Loss: 1.268 Test Acc: 0.401
Validation loss decreased (-0.348671 --> -0.401303).  Saving model ...
Epoch: 6 cost time: 2.809112787246704
Epoch: 6, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.234 Vali Acc: 0.447 Test Loss: 1.234 Test Acc: 0.447
Validation loss decreased (-0.401303 --> -0.447356).  Saving model ...
Epoch: 7 cost time: 2.944977283477783
Epoch: 7, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.447356 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.9001808166503906
Epoch: 8, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.155 Vali Acc: 0.579 Test Loss: 1.155 Test Acc: 0.579
Validation loss decreased (-0.499988 --> -0.578936).  Saving model ...
Epoch: 9 cost time: 3.06278920173645
Epoch: 9, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.110 Vali Acc: 0.612 Test Loss: 1.110 Test Acc: 0.612
Validation loss decreased (-0.578936 --> -0.611831).  Saving model ...
Epoch: 10 cost time: 2.991565227508545
Epoch: 10, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.060 Vali Acc: 0.618 Test Loss: 1.060 Test Acc: 0.618
Validation loss decreased (-0.611831 --> -0.618410).  Saving model ...
Epoch: 11 cost time: 2.921518325805664
Epoch: 11, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.009 Vali Acc: 0.684 Test Loss: 1.009 Test Acc: 0.684
Validation loss decreased (-0.618410 --> -0.684200).  Saving model ...
Epoch: 12 cost time: 2.533888339996338
Epoch: 12, Steps: 10 | Train Loss: 0.958 Vali Loss: 0.956 Vali Acc: 0.711 Test Loss: 0.956 Test Acc: 0.711
Validation loss decreased (-0.684200 --> -0.710517).  Saving model ...
Epoch: 13 cost time: 2.300154209136963
Epoch: 13, Steps: 10 | Train Loss: 0.906 Vali Loss: 0.899 Vali Acc: 0.763 Test Loss: 0.899 Test Acc: 0.763
Validation loss decreased (-0.710517 --> -0.763149).  Saving model ...
Epoch: 14 cost time: 2.3401260375976562
Epoch: 14, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.840 Vali Acc: 0.770 Test Loss: 0.840 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769728).  Saving model ...
Epoch: 15 cost time: 2.2154288291931152
Epoch: 15, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.780 Vali Acc: 0.796 Test Loss: 0.780 Test Acc: 0.796
Validation loss decreased (-0.769728 --> -0.796045).  Saving model ...
Epoch: 16 cost time: 2.5893423557281494
Epoch: 16, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7741048336029053
Epoch: 17, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8695926666259766
Epoch: 18, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.624 Vali Acc: 0.763 Test Loss: 0.624 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9139556884765625
Epoch: 19, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 2.56512451171875
Epoch: 20, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.465378999710083
Epoch: 21, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
Validation loss decreased (-0.796047 --> -0.822363).  Saving model ...
Epoch: 22 cost time: 2.3865373134613037
Epoch: 22, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.345867872238159
Epoch: 23, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 24 cost time: 2.3353421688079834
Epoch: 24, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.448 Vali Acc: 0.842 Test Loss: 0.448 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 25 cost time: 2.344576120376587
Epoch: 25, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.446 Vali Acc: 0.816 Test Loss: 0.446 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.017993927001953
Epoch: 26, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.804643392562866
Epoch: 27, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7471182346343994
Epoch: 28, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.421 Vali Acc: 0.829 Test Loss: 0.421 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9209890365600586
Epoch: 29, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.1543376445770264
Epoch: 30, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.444 Vali Acc: 0.803 Test Loss: 0.444 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 294596
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.837713003158569
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.411 Vali Acc: 0.296 Test Loss: 1.411 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 2.351569414138794
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.391 Vali Acc: 0.316 Test Loss: 1.391 Test Acc: 0.316
Validation loss decreased (-0.296039 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 2.340430498123169
Epoch: 3, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.365 Vali Acc: 0.349 Test Loss: 1.365 Test Acc: 0.349
Validation loss decreased (-0.315776 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 2.403153657913208
Epoch: 4, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.336 Vali Acc: 0.368 Test Loss: 1.336 Test Acc: 0.368
Validation loss decreased (-0.348671 --> -0.368408).  Saving model ...
Epoch: 5 cost time: 2.3570847511291504
Epoch: 5, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.306 Vali Acc: 0.388 Test Loss: 1.306 Test Acc: 0.388
Validation loss decreased (-0.368408 --> -0.388145).  Saving model ...
Epoch: 6 cost time: 2.3516740798950195
Epoch: 6, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.275 Vali Acc: 0.414 Test Loss: 1.275 Test Acc: 0.414
Validation loss decreased (-0.388145 --> -0.414461).  Saving model ...
Epoch: 7 cost time: 2.320178508758545
Epoch: 7, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.245 Vali Acc: 0.428 Test Loss: 1.245 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 2.0924625396728516
Epoch: 8, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.211 Vali Acc: 0.480 Test Loss: 1.211 Test Acc: 0.480
Validation loss decreased (-0.427619 --> -0.480251).  Saving model ...
Epoch: 9 cost time: 2.1979856491088867
Epoch: 9, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.176 Vali Acc: 0.507 Test Loss: 1.176 Test Acc: 0.507
Validation loss decreased (-0.480251 --> -0.506567).  Saving model ...
Epoch: 10 cost time: 2.3962981700897217
Epoch: 10, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.138 Vali Acc: 0.553 Test Loss: 1.138 Test Acc: 0.553
Validation loss decreased (-0.506567 --> -0.552620).  Saving model ...
Epoch: 11 cost time: 2.3616461753845215
Epoch: 11, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.098 Vali Acc: 0.605 Test Loss: 1.098 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605252).  Saving model ...
Epoch: 12 cost time: 2.4861903190612793
Epoch: 12, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.057 Vali Acc: 0.632 Test Loss: 1.057 Test Acc: 0.632
Validation loss decreased (-0.605252 --> -0.631568).  Saving model ...
Epoch: 13 cost time: 2.399886131286621
Epoch: 13, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.013 Vali Acc: 0.618 Test Loss: 1.013 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5002310276031494
Epoch: 14, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.970 Vali Acc: 0.645 Test Loss: 0.970 Test Acc: 0.645
Validation loss decreased (-0.631568 --> -0.644727).  Saving model ...
Epoch: 15 cost time: 2.343266487121582
Epoch: 15, Steps: 10 | Train Loss: 0.863 Vali Loss: 0.927 Vali Acc: 0.658 Test Loss: 0.927 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657885).  Saving model ...
Epoch: 16 cost time: 2.350944995880127
Epoch: 16, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.884 Vali Acc: 0.697 Test Loss: 0.884 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697360).  Saving model ...
Epoch: 17 cost time: 2.148026943206787
Epoch: 17, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.849 Vali Acc: 0.704 Test Loss: 0.849 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703939).  Saving model ...
Epoch: 18 cost time: 2.0759658813476562
Epoch: 18, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 19 cost time: 2.409109354019165
Epoch: 19, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.792 Vali Acc: 0.717 Test Loss: 0.792 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717097).  Saving model ...
Epoch: 20 cost time: 2.3369059562683105
Epoch: 20, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.769 Vali Acc: 0.711 Test Loss: 0.769 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.108651876449585
Epoch: 21, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.738 Vali Acc: 0.750 Test Loss: 0.738 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 2.370565891265869
Epoch: 22, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 23 cost time: 2.189676523208618
Epoch: 23, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.706 Vali Acc: 0.757 Test Loss: 0.706 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 2.3282079696655273
Epoch: 24, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 25 cost time: 2.4407033920288086
Epoch: 25, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.664 Vali Acc: 0.776 Test Loss: 0.664 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 26 cost time: 2.114351272583008
Epoch: 26, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.668 Vali Acc: 0.783 Test Loss: 0.668 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 27 cost time: 2.3556618690490723
Epoch: 27, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.664 Vali Acc: 0.789 Test Loss: 0.664 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 28 cost time: 2.434680223464966
Epoch: 28, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4377989768981934
Epoch: 29, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.427405595779419
Epoch: 30, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.643 Vali Acc: 0.776 Test Loss: 0.643 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 87556
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.402293920516968
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.376 Vali Acc: 0.270 Test Loss: 1.376 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 2.250767230987549
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.357 Vali Acc: 0.283 Test Loss: 1.357 Test Acc: 0.283
Validation loss decreased (-0.269723 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 2.0835912227630615
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.331 Vali Acc: 0.322 Test Loss: 1.331 Test Acc: 0.322
Validation loss decreased (-0.282881 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 2.2530384063720703
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.301 Vali Acc: 0.349 Test Loss: 1.301 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 2.3855745792388916
Epoch: 5, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.269 Vali Acc: 0.382 Test Loss: 1.269 Test Acc: 0.382
Validation loss decreased (-0.348671 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 2.3469021320343018
Epoch: 6, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.237 Vali Acc: 0.434 Test Loss: 1.237 Test Acc: 0.434
Validation loss decreased (-0.381566 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 2.3061649799346924
Epoch: 7, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.199 Vali Acc: 0.493 Test Loss: 1.199 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493409).  Saving model ...
Epoch: 8 cost time: 2.4667344093322754
Epoch: 8, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.161 Vali Acc: 0.559 Test Loss: 1.161 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 2.4111671447753906
Epoch: 9, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.117 Vali Acc: 0.579 Test Loss: 1.117 Test Acc: 0.579
Validation loss decreased (-0.559199 --> -0.578936).  Saving model ...
Epoch: 10 cost time: 2.510317802429199
Epoch: 10, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.069 Vali Acc: 0.618 Test Loss: 1.069 Test Acc: 0.618
Validation loss decreased (-0.578936 --> -0.618410).  Saving model ...
Epoch: 11 cost time: 2.3513545989990234
Epoch: 11, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.019 Vali Acc: 0.651 Test Loss: 1.019 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651306).  Saving model ...
Epoch: 12 cost time: 2.2792444229125977
Epoch: 12, Steps: 10 | Train Loss: 0.970 Vali Loss: 0.963 Vali Acc: 0.697 Test Loss: 0.963 Test Acc: 0.697
Validation loss decreased (-0.651306 --> -0.697359).  Saving model ...
Epoch: 13 cost time: 2.372532367706299
Epoch: 13, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.903 Vali Acc: 0.743 Test Loss: 0.903 Test Acc: 0.743
Validation loss decreased (-0.697359 --> -0.743412).  Saving model ...
Epoch: 14 cost time: 2.3089869022369385
Epoch: 14, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.842 Vali Acc: 0.776 Test Loss: 0.842 Test Acc: 0.776
Validation loss decreased (-0.743412 --> -0.776307).  Saving model ...
Epoch: 15 cost time: 2.4414403438568115
Epoch: 15, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
Validation loss decreased (-0.776307 --> -0.789466).  Saving model ...
Epoch: 16 cost time: 2.3689563274383545
Epoch: 16, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.710 Vali Acc: 0.809 Test Loss: 0.710 Test Acc: 0.809
Validation loss decreased (-0.789466 --> -0.809203).  Saving model ...
Epoch: 17 cost time: 2.524451494216919
Epoch: 17, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3732476234436035
Epoch: 18, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.441690444946289
Epoch: 19, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.549 Vali Acc: 0.829 Test Loss: 0.549 Test Acc: 0.829
Validation loss decreased (-0.809203 --> -0.828942).  Saving model ...
Epoch: 20 cost time: 2.5397863388061523
Epoch: 20, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4145336151123047
Epoch: 21, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 22 cost time: 2.498037576675415
Epoch: 22, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4446628093719482
Epoch: 23, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
Validation loss decreased (-0.828943 --> -0.855259).  Saving model ...
Epoch: 24 cost time: 2.4669525623321533
Epoch: 24, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.415 Vali Acc: 0.849 Test Loss: 0.415 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2459564208984375
Epoch: 25, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.404 Vali Acc: 0.829 Test Loss: 0.404 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2317938804626465
Epoch: 26, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.389 Vali Acc: 0.842 Test Loss: 0.389 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3197524547576904
Epoch: 27, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.384 Vali Acc: 0.842 Test Loss: 0.384 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4930267333984375
Epoch: 28, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.390 Vali Acc: 0.842 Test Loss: 0.390 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.288332223892212
Epoch: 29, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.398 Vali Acc: 0.868 Test Loss: 0.398 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 30 cost time: 2.2396299839019775
Epoch: 30, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 294596
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.466541528701782
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.411 Vali Acc: 0.322 Test Loss: 1.411 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.8610389232635498
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.392 Vali Acc: 0.322 Test Loss: 1.392 Test Acc: 0.322
Validation loss decreased (-0.322354 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 2.171862840652466
Epoch: 3, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.368 Vali Acc: 0.336 Test Loss: 1.368 Test Acc: 0.336
Validation loss decreased (-0.322355 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 2.0452678203582764
Epoch: 4, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.338 Vali Acc: 0.368 Test Loss: 1.338 Test Acc: 0.368
Validation loss decreased (-0.335513 --> -0.368408).  Saving model ...
Epoch: 5 cost time: 2.0880672931671143
Epoch: 5, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.309 Vali Acc: 0.401 Test Loss: 1.309 Test Acc: 0.401
Validation loss decreased (-0.368408 --> -0.401303).  Saving model ...
Epoch: 6 cost time: 2.0432205200195312
Epoch: 6, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.279 Vali Acc: 0.414 Test Loss: 1.279 Test Acc: 0.414
Validation loss decreased (-0.401303 --> -0.414461).  Saving model ...
Epoch: 7 cost time: 1.986255407333374
Epoch: 7, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.250 Vali Acc: 0.428 Test Loss: 1.250 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 2.018566370010376
Epoch: 8, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.220 Vali Acc: 0.474 Test Loss: 1.220 Test Acc: 0.474
Validation loss decreased (-0.427619 --> -0.473672).  Saving model ...
Epoch: 9 cost time: 1.917374849319458
Epoch: 9, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.189 Vali Acc: 0.520 Test Loss: 1.189 Test Acc: 0.520
Validation loss decreased (-0.473672 --> -0.519725).  Saving model ...
Epoch: 10 cost time: 2.00217342376709
Epoch: 10, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.153 Vali Acc: 0.572 Test Loss: 1.153 Test Acc: 0.572
Validation loss decreased (-0.519725 --> -0.572357).  Saving model ...
Epoch: 11 cost time: 2.0759356021881104
Epoch: 11, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.117 Vali Acc: 0.599 Test Loss: 1.117 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598673).  Saving model ...
Epoch: 12 cost time: 1.999730110168457
Epoch: 12, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.079 Vali Acc: 0.638 Test Loss: 1.079 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638147).  Saving model ...
Epoch: 13 cost time: 2.1956145763397217
Epoch: 13, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.040 Vali Acc: 0.632 Test Loss: 1.040 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.266103506088257
Epoch: 14, Steps: 10 | Train Loss: 0.944 Vali Loss: 1.000 Vali Acc: 0.651 Test Loss: 1.000 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 15 cost time: 2.1306064128875732
Epoch: 15, Steps: 10 | Train Loss: 0.942 Vali Loss: 0.962 Vali Acc: 0.671 Test Loss: 0.962 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 16 cost time: 2.142984628677368
Epoch: 16, Steps: 10 | Train Loss: 0.892 Vali Loss: 0.924 Vali Acc: 0.691 Test Loss: 0.924 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690780).  Saving model ...
Epoch: 17 cost time: 2.158308744430542
Epoch: 17, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.890 Vali Acc: 0.704 Test Loss: 0.890 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703938).  Saving model ...
Epoch: 18 cost time: 2.0042428970336914
Epoch: 18, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.854 Vali Acc: 0.717 Test Loss: 0.854 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717097).  Saving model ...
Epoch: 19 cost time: 2.37665057182312
Epoch: 19, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.827 Vali Acc: 0.737 Test Loss: 0.827 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 20 cost time: 1.7286927700042725
Epoch: 20, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.798 Vali Acc: 0.737 Test Loss: 0.798 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736834).  Saving model ...
Epoch: 21 cost time: 2.0575342178344727
Epoch: 21, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.773 Vali Acc: 0.724 Test Loss: 0.773 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.068617820739746
Epoch: 22, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 2.0157337188720703
Epoch: 23, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 24 cost time: 2.0651164054870605
Epoch: 24, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.709 Vali Acc: 0.757 Test Loss: 0.709 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 25 cost time: 2.2297756671905518
Epoch: 25, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 26 cost time: 2.003345489501953
Epoch: 26, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.663 Vali Acc: 0.776 Test Loss: 0.663 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 27 cost time: 1.955833911895752
Epoch: 27, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.647 Vali Acc: 0.776 Test Loss: 0.647 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 28 cost time: 1.981879711151123
Epoch: 28, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.309028148651123
Epoch: 29, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.622 Vali Acc: 0.796 Test Loss: 0.622 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 30 cost time: 2.169412136077881
Epoch: 30, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 87556
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.313565492630005
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.365 Vali Acc: 0.283 Test Loss: 1.365 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.3318562507629395
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.352 Vali Acc: 0.296 Test Loss: 1.352 Test Acc: 0.296
Validation loss decreased (-0.282881 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 2.2163703441619873
Epoch: 3, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.332 Vali Acc: 0.336 Test Loss: 1.332 Test Acc: 0.336
Validation loss decreased (-0.296039 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 2.274024486541748
Epoch: 4, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.311 Vali Acc: 0.362 Test Loss: 1.311 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 2.240323543548584
Epoch: 5, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.287 Vali Acc: 0.395 Test Loss: 1.287 Test Acc: 0.395
Validation loss decreased (-0.361829 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 2.206568956375122
Epoch: 6, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.263 Vali Acc: 0.434 Test Loss: 1.263 Test Acc: 0.434
Validation loss decreased (-0.394724 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 2.2528271675109863
Epoch: 7, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.235 Vali Acc: 0.461 Test Loss: 1.235 Test Acc: 0.461
Validation loss decreased (-0.434198 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 2.344050645828247
Epoch: 8, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.209 Vali Acc: 0.467 Test Loss: 1.209 Test Acc: 0.467
Validation loss decreased (-0.460514 --> -0.467093).  Saving model ...
Epoch: 9 cost time: 2.2085044384002686
Epoch: 9, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.180 Vali Acc: 0.526 Test Loss: 1.180 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526304).  Saving model ...
Epoch: 10 cost time: 2.261098623275757
Epoch: 10, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.148 Vali Acc: 0.553 Test Loss: 1.148 Test Acc: 0.553
Validation loss decreased (-0.526304 --> -0.552620).  Saving model ...
Epoch: 11 cost time: 2.2071704864501953
Epoch: 11, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.117 Vali Acc: 0.592 Test Loss: 1.117 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 12 cost time: 1.9399666786193848
Epoch: 12, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.084 Vali Acc: 0.632 Test Loss: 1.084 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631568).  Saving model ...
Epoch: 13 cost time: 2.1271955966949463
Epoch: 13, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.049 Vali Acc: 0.638 Test Loss: 1.049 Test Acc: 0.638
Validation loss decreased (-0.631568 --> -0.638147).  Saving model ...
Epoch: 14 cost time: 2.0923848152160645
Epoch: 14, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.011 Vali Acc: 0.664 Test Loss: 1.011 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664464).  Saving model ...
Epoch: 15 cost time: 2.0485622882843018
Epoch: 15, Steps: 10 | Train Loss: 0.954 Vali Loss: 0.973 Vali Acc: 0.697 Test Loss: 0.973 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697359).  Saving model ...
Epoch: 16 cost time: 2.1822259426116943
Epoch: 16, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.932 Vali Acc: 0.711 Test Loss: 0.932 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710517).  Saving model ...
Epoch: 17 cost time: 1.6843018531799316
Epoch: 17, Steps: 10 | Train Loss: 0.886 Vali Loss: 0.893 Vali Acc: 0.730 Test Loss: 0.893 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730254).  Saving model ...
Epoch: 18 cost time: 2.158557891845703
Epoch: 18, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.854 Vali Acc: 0.737 Test Loss: 0.854 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 19 cost time: 2.201984405517578
Epoch: 19, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.817 Vali Acc: 0.763 Test Loss: 0.817 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763150).  Saving model ...
Epoch: 20 cost time: 2.0687053203582764
Epoch: 20, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0635082721710205
Epoch: 21, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.742 Vali Acc: 0.763 Test Loss: 0.742 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 22 cost time: 2.25723934173584
Epoch: 22, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782888).  Saving model ...
Epoch: 23 cost time: 2.1601510047912598
Epoch: 23, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 24 cost time: 2.240447998046875
Epoch: 24, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
Validation loss decreased (-0.802625 --> -0.822362).  Saving model ...
Epoch: 25 cost time: 2.1619293689727783
Epoch: 25, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.606 Vali Acc: 0.836 Test Loss: 0.606 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835520).  Saving model ...
Epoch: 26 cost time: 2.1022872924804688
Epoch: 26, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.579 Vali Acc: 0.842 Test Loss: 0.579 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 27 cost time: 2.1218011379241943
Epoch: 27, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.551 Vali Acc: 0.836 Test Loss: 0.551 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.218991756439209
Epoch: 28, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.525 Vali Acc: 0.836 Test Loss: 0.525 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.113464832305908
Epoch: 29, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
Validation loss decreased (-0.842099 --> -0.855258).  Saving model ...
Epoch: 30 cost time: 2.2362728118896484
Epoch: 30, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.478 Vali Acc: 0.842 Test Loss: 0.478 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 294596
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.024376392364502
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.434 Vali Acc: 0.257 Test Loss: 1.434 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.8960704803466797
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.423 Vali Acc: 0.276 Test Loss: 1.423 Test Acc: 0.276
Validation loss decreased (-0.256565 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.6129910945892334
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.404 Vali Acc: 0.289 Test Loss: 1.404 Test Acc: 0.289
Validation loss decreased (-0.276302 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 2.040144920349121
Epoch: 4, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.382 Vali Acc: 0.303 Test Loss: 1.382 Test Acc: 0.303
Validation loss decreased (-0.289460 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 1.9836759567260742
Epoch: 5, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.359 Vali Acc: 0.296 Test Loss: 1.359 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.086841106414795
Epoch: 6, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.336 Vali Acc: 0.336 Test Loss: 1.336 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 7 cost time: 2.0983211994171143
Epoch: 7, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.307 Vali Acc: 0.388 Test Loss: 1.307 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 8 cost time: 1.913816213607788
Epoch: 8, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.277 Vali Acc: 0.408 Test Loss: 1.277 Test Acc: 0.408
Validation loss decreased (-0.388145 --> -0.407882).  Saving model ...
Epoch: 9 cost time: 1.9135384559631348
Epoch: 9, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.251 Vali Acc: 0.447 Test Loss: 1.251 Test Acc: 0.447
Validation loss decreased (-0.407882 --> -0.447356).  Saving model ...
Epoch: 10 cost time: 2.0406973361968994
Epoch: 10, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.226 Vali Acc: 0.493 Test Loss: 1.226 Test Acc: 0.493
Validation loss decreased (-0.447356 --> -0.493409).  Saving model ...
Epoch: 11 cost time: 1.9578828811645508
Epoch: 11, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.202 Vali Acc: 0.533 Test Loss: 1.202 Test Acc: 0.533
Validation loss decreased (-0.493409 --> -0.532883).  Saving model ...
Epoch: 12 cost time: 2.095853805541992
Epoch: 12, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.180 Vali Acc: 0.559 Test Loss: 1.180 Test Acc: 0.559
Validation loss decreased (-0.532883 --> -0.559199).  Saving model ...
Epoch: 13 cost time: 2.169593095779419
Epoch: 13, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.153 Vali Acc: 0.579 Test Loss: 1.153 Test Acc: 0.579
Validation loss decreased (-0.559199 --> -0.578936).  Saving model ...
Epoch: 14 cost time: 2.175269842147827
Epoch: 14, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.110 Vali Acc: 0.645 Test Loss: 1.110 Test Acc: 0.645
Validation loss decreased (-0.578936 --> -0.644726).  Saving model ...
Epoch: 15 cost time: 2.0120952129364014
Epoch: 15, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.085 Vali Acc: 0.625 Test Loss: 1.085 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.104203701019287
Epoch: 16, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.054 Vali Acc: 0.632 Test Loss: 1.054 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.086216926574707
Epoch: 17, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.025 Vali Acc: 0.625 Test Loss: 1.025 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0523123741149902
Epoch: 18, Steps: 10 | Train Loss: 0.921 Vali Loss: 0.994 Vali Acc: 0.651 Test Loss: 0.994 Test Acc: 0.651
Validation loss decreased (-0.644726 --> -0.651306).  Saving model ...
Epoch: 19 cost time: 2.173539400100708
Epoch: 19, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.964 Vali Acc: 0.671 Test Loss: 0.964 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 20 cost time: 2.003416061401367
Epoch: 20, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.935 Vali Acc: 0.697 Test Loss: 0.935 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697359).  Saving model ...
Epoch: 21 cost time: 2.021655559539795
Epoch: 21, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.906 Vali Acc: 0.704 Test Loss: 0.906 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703938).  Saving model ...
Epoch: 22 cost time: 2.0641393661499023
Epoch: 22, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.876 Vali Acc: 0.704 Test Loss: 0.876 Test Acc: 0.704
Validation loss decreased (-0.703938 --> -0.703939).  Saving model ...
Epoch: 23 cost time: 2.0732221603393555
Epoch: 23, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.838 Vali Acc: 0.724 Test Loss: 0.838 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723676).  Saving model ...
Epoch: 24 cost time: 1.850283145904541
Epoch: 24, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.037733793258667
Epoch: 25, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.785 Vali Acc: 0.730 Test Loss: 0.785 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 26 cost time: 1.866962194442749
Epoch: 26, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 27 cost time: 1.9330556392669678
Epoch: 27, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.729 Vali Acc: 0.757 Test Loss: 0.729 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 28 cost time: 1.997480869293213
Epoch: 28, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.704 Vali Acc: 0.776 Test Loss: 0.704 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 29 cost time: 1.786745548248291
Epoch: 29, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.677 Vali Acc: 0.796 Test Loss: 0.677 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 30 cost time: 1.867107629776001
Epoch: 30, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 87556
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 17.02214503288269
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.352 Vali Acc: 0.309 Test Loss: 1.352 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 15.28866457939148
Epoch: 2, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.022 Vali Acc: 0.724 Test Loss: 1.022 Test Acc: 0.724
Validation loss decreased (-0.309197 --> -0.723674).  Saving model ...
Epoch: 3 cost time: 14.944971561431885
Epoch: 3, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
Validation loss decreased (-0.723674 --> -0.809204).  Saving model ...
Epoch: 4 cost time: 14.126880884170532
Epoch: 4, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.673761129379272
Epoch: 5, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
Validation loss decreased (-0.809204 --> -0.828943).  Saving model ...
Epoch: 6 cost time: 15.870944499969482
Epoch: 6, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.370 Vali Acc: 0.829 Test Loss: 0.370 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828944).  Saving model ...
Epoch: 7 cost time: 16.036543369293213
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.401 Vali Acc: 0.849 Test Loss: 0.401 Test Acc: 0.849
Validation loss decreased (-0.828944 --> -0.848680).  Saving model ...
Epoch: 8 cost time: 15.731882572174072
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.460 Vali Acc: 0.849 Test Loss: 0.460 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.210725784301758
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861837).  Saving model ...
Epoch: 10 cost time: 14.826493263244629
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.470 Vali Acc: 0.849 Test Loss: 0.470 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.390446186065674
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.518 Vali Acc: 0.836 Test Loss: 0.518 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.989657878875732
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.862 Test Loss: 0.537 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.645465612411499
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.822 Test Loss: 0.639 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.699923992156982
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.662 Vali Acc: 0.849 Test Loss: 0.662 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.98341703414917
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.685 Vali Acc: 0.849 Test Loss: 0.685 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.841001033782959
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.566 Vali Acc: 0.868 Test Loss: 0.566 Test Acc: 0.868
Validation loss decreased (-0.861837 --> -0.868415).  Saving model ...
Epoch: 17 cost time: 15.270081758499146
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.626 Vali Acc: 0.842 Test Loss: 0.626 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.024231433868408
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 15.477309703826904
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.620 Vali Acc: 0.836 Test Loss: 0.620 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 15.205686330795288
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.732 Vali Acc: 0.829 Test Loss: 0.732 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.257092714309692
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.836 Test Loss: 0.651 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 16.096134424209595
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.849 Test Loss: 0.702 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 15.66892385482788
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.788 Vali Acc: 0.816 Test Loss: 0.788 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 15.76313591003418
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.816 Test Loss: 0.805 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 14.615897417068481
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.822 Test Loss: 0.787 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 14.141741275787354
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.822 Test Loss: 0.764 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 56255236
model size : 217.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.46038031578064
Epoch: 1, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.248 Vali Acc: 0.434 Test Loss: 1.248 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 5.461211681365967
Epoch: 2, Steps: 10 | Train Loss: 1.048 Vali Loss: 0.965 Vali Acc: 0.737 Test Loss: 0.965 Test Acc: 0.737
Validation loss decreased (-0.434198 --> -0.736832).  Saving model ...
Epoch: 3 cost time: 5.664921760559082
Epoch: 3, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.736832 --> -0.809204).  Saving model ...
Epoch: 4 cost time: 5.5393805503845215
Epoch: 4, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.483 Vali Acc: 0.842 Test Loss: 0.483 Test Acc: 0.842
Validation loss decreased (-0.809204 --> -0.842100).  Saving model ...
Epoch: 5 cost time: 5.778231620788574
Epoch: 5, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.411 Vali Acc: 0.842 Test Loss: 0.411 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 6 cost time: 5.271401643753052
Epoch: 6, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
Validation loss decreased (-0.842101 --> -0.861838).  Saving model ...
Epoch: 7 cost time: 5.212006568908691
Epoch: 7, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 8 cost time: 5.277719020843506
Epoch: 8, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.428 Vali Acc: 0.868 Test Loss: 0.428 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 9 cost time: 5.420953273773193
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.440 Vali Acc: 0.888 Test Loss: 0.440 Test Acc: 0.888
Validation loss decreased (-0.868417 --> -0.888153).  Saving model ...
Epoch: 10 cost time: 5.614492654800415
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.436 Vali Acc: 0.882 Test Loss: 0.436 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.54399847984314
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.506 Vali Acc: 0.842 Test Loss: 0.506 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.970500707626343
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.590 Vali Acc: 0.849 Test Loss: 0.590 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.923907518386841
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.510 Vali Acc: 0.842 Test Loss: 0.510 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.731103181838989
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.504 Vali Acc: 0.849 Test Loss: 0.504 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.694820404052734
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.852097988128662
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.454 Vali Acc: 0.868 Test Loss: 0.454 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.746304988861084
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.356008052825928
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.2436442375183105
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 16538116
model size : 65.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 11.548981428146362
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.362 Vali Acc: 0.283 Test Loss: 1.362 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 9.524303197860718
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.060 Vali Acc: 0.691 Test Loss: 1.060 Test Acc: 0.691
Validation loss decreased (-0.282881 --> -0.690779).  Saving model ...
Epoch: 3 cost time: 9.522629737854004
Epoch: 3, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.722 Vali Acc: 0.776 Test Loss: 0.722 Test Acc: 0.776
Validation loss decreased (-0.690779 --> -0.776309).  Saving model ...
Epoch: 4 cost time: 9.307802438735962
Epoch: 4, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802626).  Saving model ...
Epoch: 5 cost time: 9.518270015716553
Epoch: 5, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 8.830912590026855
Epoch: 6, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.519 Vali Acc: 0.849 Test Loss: 0.519 Test Acc: 0.849
Validation loss decreased (-0.809205 --> -0.848679).  Saving model ...
Epoch: 7 cost time: 8.868378639221191
Epoch: 7, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.559 Vali Acc: 0.836 Test Loss: 0.559 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.663556337356567
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.447 Vali Acc: 0.849 Test Loss: 0.447 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 9 cost time: 9.644121646881104
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.461 Vali Acc: 0.862 Test Loss: 0.461 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861837).  Saving model ...
Epoch: 10 cost time: 10.3399658203125
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.494 Vali Acc: 0.829 Test Loss: 0.494 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.510497093200684
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.547300815582275
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.514 Vali Acc: 0.849 Test Loss: 0.514 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.133674621582031
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.842 Test Loss: 0.567 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.066200971603394
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.876887559890747
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.9292631149292
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.732 Vali Acc: 0.829 Test Loss: 0.732 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.61915397644043
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.650 Vali Acc: 0.849 Test Loss: 0.650 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.745737075805664
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.660 Vali Acc: 0.842 Test Loss: 0.660 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.731574296951294
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.719 Vali Acc: 0.842 Test Loss: 0.719 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 56255236
model size : 217.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.315622806549072
Epoch: 1, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.266 Vali Acc: 0.408 Test Loss: 1.266 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 4.3404529094696045
Epoch: 2, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.010 Vali Acc: 0.691 Test Loss: 1.010 Test Acc: 0.691
Validation loss decreased (-0.407882 --> -0.690779).  Saving model ...
Epoch: 3 cost time: 4.478809356689453
Epoch: 3, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
Validation loss decreased (-0.690779 --> -0.789466).  Saving model ...
Epoch: 4 cost time: 4.428121328353882
Epoch: 4, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.537 Vali Acc: 0.829 Test Loss: 0.537 Test Acc: 0.829
Validation loss decreased (-0.789466 --> -0.828942).  Saving model ...
Epoch: 5 cost time: 4.485347509384155
Epoch: 5, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.423 Vali Acc: 0.822 Test Loss: 0.423 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.160313129425049
Epoch: 6, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.410 Vali Acc: 0.842 Test Loss: 0.410 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842101).  Saving model ...
Epoch: 7 cost time: 2.796635866165161
Epoch: 7, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.390 Vali Acc: 0.849 Test Loss: 0.390 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 8 cost time: 4.208970069885254
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.394 Vali Acc: 0.842 Test Loss: 0.394 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.444465637207031
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.430 Vali Acc: 0.836 Test Loss: 0.430 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.526203393936157
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.457 Vali Acc: 0.842 Test Loss: 0.457 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.470784664154053
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855258).  Saving model ...
Epoch: 12 cost time: 4.269290447235107
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.434144735336304
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.549143314361572
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.836 Test Loss: 0.551 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.246031045913696
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.568 Vali Acc: 0.842 Test Loss: 0.568 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.4701197147369385
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.559 Vali Acc: 0.849 Test Loss: 0.559 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.075565576553345
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.560 Vali Acc: 0.849 Test Loss: 0.560 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.31764817237854
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.829 Test Loss: 0.574 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.251831531524658
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.836 Test Loss: 0.603 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.451975584030151
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.836 Test Loss: 0.615 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.242973566055298
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.619 Vali Acc: 0.829 Test Loss: 0.619 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 16538116
model size : 65.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 9.710375308990479
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.381 Vali Acc: 0.276 Test Loss: 1.381 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 7.745397090911865
Epoch: 2, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.276302 --> -0.624989).  Saving model ...
Epoch: 3 cost time: 8.039422750473022
Epoch: 3, Steps: 10 | Train Loss: 0.920 Vali Loss: 0.857 Vali Acc: 0.776 Test Loss: 0.857 Test Acc: 0.776
Validation loss decreased (-0.624989 --> -0.776307).  Saving model ...
Epoch: 4 cost time: 8.054401874542236
Epoch: 4, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
Validation loss decreased (-0.776307 --> -0.822362).  Saving model ...
Epoch: 5 cost time: 7.452115058898926
Epoch: 5, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.459 Vali Acc: 0.849 Test Loss: 0.459 Test Acc: 0.849
Validation loss decreased (-0.822362 --> -0.848680).  Saving model ...
Epoch: 6 cost time: 7.308691024780273
Epoch: 6, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 7 cost time: 7.362968921661377
Epoch: 7, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 8 cost time: 7.058037042617798
Epoch: 8, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.356 Vali Acc: 0.855 Test Loss: 0.356 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855260).  Saving model ...
Epoch: 9 cost time: 7.7946436405181885
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861838).  Saving model ...
Epoch: 10 cost time: 7.662633180618286
Epoch: 10, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.367 Vali Acc: 0.849 Test Loss: 0.367 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.516995429992676
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.509 Vali Acc: 0.842 Test Loss: 0.509 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.894092082977295
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.646553039550781
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.823812007904053
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.321964263916016
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.868 Test Loss: 0.424 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 16 cost time: 7.507435083389282
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.435 Vali Acc: 0.868 Test Loss: 0.435 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.992672443389893
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.796531677246094
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.458 Vali Acc: 0.868 Test Loss: 0.458 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.673318386077881
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.063129186630249
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.796 Test Loss: 0.692 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.572293996810913
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.24029541015625
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.816 Test Loss: 0.701 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.996039628982544
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.75287938117981
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.809 Test Loss: 0.760 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.973790645599365
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.816 Test Loss: 0.760 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 56255236
model size : 217.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.152540922164917
Epoch: 1, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.281 Vali Acc: 0.395 Test Loss: 1.281 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 3.025085687637329
Epoch: 2, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.064 Vali Acc: 0.612 Test Loss: 1.064 Test Acc: 0.612
Validation loss decreased (-0.394724 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 3.2001190185546875
Epoch: 3, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.802 Vali Acc: 0.770 Test Loss: 0.802 Test Acc: 0.770
Validation loss decreased (-0.611831 --> -0.769729).  Saving model ...
Epoch: 4 cost time: 3.213238000869751
Epoch: 4, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
Validation loss decreased (-0.769729 --> -0.815784).  Saving model ...
Epoch: 5 cost time: 3.1743156909942627
Epoch: 5, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828943).  Saving model ...
Epoch: 6 cost time: 3.0197787284851074
Epoch: 6, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.828943 --> -0.861838).  Saving model ...
Epoch: 7 cost time: 2.91681170463562
Epoch: 7, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.338 Vali Acc: 0.862 Test Loss: 0.338 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861839).  Saving model ...
Epoch: 8 cost time: 3.2232675552368164
Epoch: 8, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.385 Vali Acc: 0.842 Test Loss: 0.385 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2561285495758057
Epoch: 9, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.452 Vali Acc: 0.816 Test Loss: 0.452 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.271608352661133
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.156813859939575
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.394 Vali Acc: 0.842 Test Loss: 0.394 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.0257411003112793
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.940582275390625
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.399 Vali Acc: 0.842 Test Loss: 0.399 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.294466018676758
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.380964994430542
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.162114381790161
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.358 Vali Acc: 0.849 Test Loss: 0.358 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.97829532623291
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.387 Vali Acc: 0.862 Test Loss: 0.387 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 16538116
model size : 65.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 9.572022199630737
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.306 Vali Acc: 0.388 Test Loss: 1.306 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 7.331785440444946
Epoch: 2, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.074 Vali Acc: 0.651 Test Loss: 1.074 Test Acc: 0.651
Validation loss decreased (-0.388145 --> -0.651305).  Saving model ...
Epoch: 3 cost time: 8.049849271774292
Epoch: 3, Steps: 10 | Train Loss: 0.872 Vali Loss: 0.792 Vali Acc: 0.783 Test Loss: 0.792 Test Acc: 0.783
Validation loss decreased (-0.651305 --> -0.782887).  Saving model ...
Epoch: 4 cost time: 8.289768695831299
Epoch: 4, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.514 Vali Acc: 0.849 Test Loss: 0.514 Test Acc: 0.849
Validation loss decreased (-0.782887 --> -0.848679).  Saving model ...
Epoch: 5 cost time: 7.894090175628662
Epoch: 5, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.397 Vali Acc: 0.849 Test Loss: 0.397 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 6 cost time: 8.547177791595459
Epoch: 6, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.341 Vali Acc: 0.862 Test Loss: 0.341 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861839).  Saving model ...
Epoch: 7 cost time: 8.317507982254028
Epoch: 7, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.353 Vali Acc: 0.868 Test Loss: 0.353 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868418).  Saving model ...
Epoch: 8 cost time: 8.264411449432373
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.868418 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 8.104203939437866
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.428 Vali Acc: 0.875 Test Loss: 0.428 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.777011394500732
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.462 Vali Acc: 0.882 Test Loss: 0.462 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881574).  Saving model ...
Epoch: 11 cost time: 8.305618286132812
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.496 Vali Acc: 0.888 Test Loss: 0.496 Test Acc: 0.888
Validation loss decreased (-0.881574 --> -0.888153).  Saving model ...
Epoch: 12 cost time: 8.480093717575073
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.543 Vali Acc: 0.882 Test Loss: 0.543 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.253061294555664
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.584 Vali Acc: 0.855 Test Loss: 0.584 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.161279916763306
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.605 Vali Acc: 0.855 Test Loss: 0.605 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.85146689414978
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.855 Test Loss: 0.655 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.272235870361328
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.862 Test Loss: 0.667 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.5579798221588135
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.855 Test Loss: 0.674 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.229330062866211
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.862 Test Loss: 0.701 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.822977066040039
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.694 Vali Acc: 0.849 Test Loss: 0.694 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.53192138671875
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.855 Test Loss: 0.718 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.670745372772217
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.868 Test Loss: 0.646 Test Acc: 0.868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 28137988
model size : 109.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.391533374786377
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.363 Vali Acc: 0.342 Test Loss: 1.363 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 3.3157718181610107
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.139 Vali Acc: 0.586 Test Loss: 1.139 Test Acc: 0.586
Validation loss decreased (-0.342092 --> -0.585515).  Saving model ...
Epoch: 3 cost time: 3.4359207153320312
Epoch: 3, Steps: 10 | Train Loss: 0.922 Vali Loss: 0.896 Vali Acc: 0.704 Test Loss: 0.896 Test Acc: 0.704
Validation loss decreased (-0.585515 --> -0.703938).  Saving model ...
Epoch: 4 cost time: 3.3259081840515137
Epoch: 4, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
Validation loss decreased (-0.703938 --> -0.822362).  Saving model ...
Epoch: 5 cost time: 3.2973575592041016
Epoch: 5, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.459 Vali Acc: 0.842 Test Loss: 0.459 Test Acc: 0.842
Validation loss decreased (-0.822362 --> -0.842101).  Saving model ...
Epoch: 6 cost time: 3.297515869140625
Epoch: 6, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.336 Vali Acc: 0.868 Test Loss: 0.336 Test Acc: 0.868
Validation loss decreased (-0.842101 --> -0.868418).  Saving model ...
Epoch: 7 cost time: 3.2348411083221436
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.333 Vali Acc: 0.842 Test Loss: 0.333 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4051294326782227
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.312 Vali Acc: 0.882 Test Loss: 0.312 Test Acc: 0.882
Validation loss decreased (-0.868418 --> -0.881576).  Saving model ...
Epoch: 9 cost time: 3.339716672897339
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.321 Vali Acc: 0.855 Test Loss: 0.321 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.411015033721924
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.882 Test Loss: 0.310 Test Acc: 0.882
Validation loss decreased (-0.881576 --> -0.881576).  Saving model ...
Epoch: 11 cost time: 3.4268243312835693
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.656363010406494
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.360 Vali Acc: 0.849 Test Loss: 0.360 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4743850231170654
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.404 Vali Acc: 0.868 Test Loss: 0.404 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4832651615142822
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.338683843612671
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.396 Vali Acc: 0.868 Test Loss: 0.396 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.4903318881988525
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.183201551437378
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.855 Test Loss: 0.483 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.578054904937744
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.855 Test Loss: 0.485 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.454543113708496
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.868 Test Loss: 0.488 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4710447788238525
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 8279044
model size : 34.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.5540454387664795
Epoch: 1, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.312 Vali Acc: 0.401 Test Loss: 1.312 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 5.51325249671936
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.099 Vali Acc: 0.638 Test Loss: 1.099 Test Acc: 0.638
Validation loss decreased (-0.401303 --> -0.638147).  Saving model ...
Epoch: 3 cost time: 5.4588727951049805
Epoch: 3, Steps: 10 | Train Loss: 0.937 Vali Loss: 0.840 Vali Acc: 0.796 Test Loss: 0.840 Test Acc: 0.796
Validation loss decreased (-0.638147 --> -0.796044).  Saving model ...
Epoch: 4 cost time: 5.48569393157959
Epoch: 4, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.572 Vali Acc: 0.836 Test Loss: 0.572 Test Acc: 0.836
Validation loss decreased (-0.796044 --> -0.835521).  Saving model ...
Epoch: 5 cost time: 5.867769956588745
Epoch: 5, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.419 Vali Acc: 0.849 Test Loss: 0.419 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848680).  Saving model ...
Epoch: 6 cost time: 5.789999485015869
Epoch: 6, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.514799118041992
Epoch: 7, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.354 Vali Acc: 0.868 Test Loss: 0.354 Test Acc: 0.868
Validation loss decreased (-0.848680 --> -0.868418).  Saving model ...
Epoch: 8 cost time: 5.660144090652466
Epoch: 8, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.372 Vali Acc: 0.849 Test Loss: 0.372 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.421519994735718
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.281029939651489
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.384691953659058
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.425868988037109
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.518 Vali Acc: 0.842 Test Loss: 0.518 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.373745441436768
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.594930171966553
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.862 Test Loss: 0.546 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.649973392486572
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.842 Test Loss: 0.588 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.95905065536499
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.862 Test Loss: 0.570 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.936359405517578
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.849 Test Loss: 0.596 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 28137988
model size : 109.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.647352933883667
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.374 Vali Acc: 0.342 Test Loss: 1.374 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 2.758192539215088
Epoch: 2, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.166 Vali Acc: 0.566 Test Loss: 1.166 Test Acc: 0.566
Validation loss decreased (-0.342092 --> -0.565778).  Saving model ...
Epoch: 3 cost time: 2.8635711669921875
Epoch: 3, Steps: 10 | Train Loss: 0.978 Vali Loss: 0.944 Vali Acc: 0.678 Test Loss: 0.944 Test Acc: 0.678
Validation loss decreased (-0.565778 --> -0.677622).  Saving model ...
Epoch: 4 cost time: 2.843977928161621
Epoch: 4, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
Validation loss decreased (-0.677622 --> -0.789467).  Saving model ...
Epoch: 5 cost time: 2.570385694503784
Epoch: 5, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.528 Vali Acc: 0.829 Test Loss: 0.528 Test Acc: 0.829
Validation loss decreased (-0.789467 --> -0.828942).  Saving model ...
Epoch: 6 cost time: 2.789876699447632
Epoch: 6, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.828942 --> -0.861838).  Saving model ...
Epoch: 7 cost time: 2.665133476257324
Epoch: 7, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.376 Vali Acc: 0.842 Test Loss: 0.376 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8267297744750977
Epoch: 8, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.323 Vali Acc: 0.862 Test Loss: 0.323 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861839).  Saving model ...
Epoch: 9 cost time: 2.5081210136413574
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.344 Vali Acc: 0.849 Test Loss: 0.344 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7175517082214355
Epoch: 10, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.352 Vali Acc: 0.849 Test Loss: 0.352 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6931533813476562
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6952364444732666
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.770653009414673
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.478 Vali Acc: 0.836 Test Loss: 0.478 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.843083620071411
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.447 Vali Acc: 0.842 Test Loss: 0.447 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.745382308959961
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.432 Vali Acc: 0.849 Test Loss: 0.432 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.721439838409424
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.862 Test Loss: 0.424 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.781662702560425
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.439 Vali Acc: 0.868 Test Loss: 0.439 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868417).  Saving model ...
Epoch: 18 cost time: 2.798733711242676
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.522 Vali Acc: 0.862 Test Loss: 0.522 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7076029777526855
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.574 Vali Acc: 0.842 Test Loss: 0.574 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6712613105773926
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.525 Vali Acc: 0.868 Test Loss: 0.525 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.791761636734009
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.595 Vali Acc: 0.829 Test Loss: 0.595 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6901822090148926
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.553 Vali Acc: 0.836 Test Loss: 0.553 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7665767669677734
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.6159961223602295
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.849 Test Loss: 0.557 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.7771501541137695
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.836 Test Loss: 0.583 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.693636417388916
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.849 Test Loss: 0.589 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.720039129257202
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.849 Test Loss: 0.594 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 8279044
model size : 34.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.494862079620361
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.322 Vali Acc: 0.395 Test Loss: 1.322 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 3.716362237930298
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.140 Vali Acc: 0.599 Test Loss: 1.140 Test Acc: 0.599
Validation loss decreased (-0.394724 --> -0.598673).  Saving model ...
Epoch: 3 cost time: 3.9564077854156494
Epoch: 3, Steps: 10 | Train Loss: 1.008 Vali Loss: 0.919 Vali Acc: 0.737 Test Loss: 0.919 Test Acc: 0.737
Validation loss decreased (-0.598673 --> -0.736833).  Saving model ...
Epoch: 4 cost time: 3.88667368888855
Epoch: 4, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.682 Vali Acc: 0.796 Test Loss: 0.682 Test Acc: 0.796
Validation loss decreased (-0.736833 --> -0.796046).  Saving model ...
Epoch: 5 cost time: 4.016686677932739
Epoch: 5, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.480 Vali Acc: 0.849 Test Loss: 0.480 Test Acc: 0.849
Validation loss decreased (-0.796046 --> -0.848679).  Saving model ...
Epoch: 6 cost time: 4.1252665519714355
Epoch: 6, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
Validation loss decreased (-0.848679 --> -0.861838).  Saving model ...
Epoch: 7 cost time: 4.040924310684204
Epoch: 7, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.323 Vali Acc: 0.888 Test Loss: 0.323 Test Acc: 0.888
Validation loss decreased (-0.861838 --> -0.888155).  Saving model ...
Epoch: 8 cost time: 3.925524950027466
Epoch: 8, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.323 Vali Acc: 0.849 Test Loss: 0.323 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.997572898864746
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.341 Vali Acc: 0.895 Test Loss: 0.341 Test Acc: 0.895
Validation loss decreased (-0.888155 --> -0.894733).  Saving model ...
Epoch: 10 cost time: 3.5674493312835693
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.341 Vali Acc: 0.855 Test Loss: 0.341 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.784942388534546
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.349 Vali Acc: 0.849 Test Loss: 0.349 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.838498830795288
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.376 Vali Acc: 0.882 Test Loss: 0.376 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7510600090026855
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8551018238067627
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.748722553253174
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.8422844409942627
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.409 Vali Acc: 0.842 Test Loss: 0.409 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.81510853767395
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.849 Test Loss: 0.408 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.9459950923919678
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.422 Vali Acc: 0.849 Test Loss: 0.422 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.9915623664855957
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.424 Vali Acc: 0.842 Test Loss: 0.424 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8947368421052632
model parameter : 28137988
model size : 109.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.013216495513916
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.377 Vali Acc: 0.349 Test Loss: 1.377 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 2.115612506866455
Epoch: 2, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.196 Vali Acc: 0.546 Test Loss: 1.196 Test Acc: 0.546
Validation loss decreased (-0.348670 --> -0.546041).  Saving model ...
Epoch: 3 cost time: 2.0387187004089355
Epoch: 3, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.001 Vali Acc: 0.638 Test Loss: 1.001 Test Acc: 0.638
Validation loss decreased (-0.546041 --> -0.638148).  Saving model ...
Epoch: 4 cost time: 2.0476174354553223
Epoch: 4, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.785 Vali Acc: 0.776 Test Loss: 0.785 Test Acc: 0.776
Validation loss decreased (-0.638148 --> -0.776308).  Saving model ...
Epoch: 5 cost time: 2.0361995697021484
Epoch: 5, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.603 Vali Acc: 0.836 Test Loss: 0.603 Test Acc: 0.836
Validation loss decreased (-0.776308 --> -0.835520).  Saving model ...
Epoch: 6 cost time: 2.0744431018829346
Epoch: 6, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.449 Vali Acc: 0.842 Test Loss: 0.449 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842101).  Saving model ...
Epoch: 7 cost time: 1.9923121929168701
Epoch: 7, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.366 Vali Acc: 0.842 Test Loss: 0.366 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842102).  Saving model ...
Epoch: 8 cost time: 2.022449016571045
Epoch: 8, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.325 Vali Acc: 0.855 Test Loss: 0.325 Test Acc: 0.855
Validation loss decreased (-0.842102 --> -0.855260).  Saving model ...
Epoch: 9 cost time: 1.8909008502960205
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.279 Vali Acc: 0.888 Test Loss: 0.279 Test Acc: 0.888
Validation loss decreased (-0.855260 --> -0.888155).  Saving model ...
Epoch: 10 cost time: 2.0005462169647217
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.280 Vali Acc: 0.882 Test Loss: 0.280 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.960357427597046
Epoch: 11, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.941831350326538
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.323 Vali Acc: 0.868 Test Loss: 0.323 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9939589500427246
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6856300830841064
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.318 Vali Acc: 0.855 Test Loss: 0.318 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8804619312286377
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.326 Vali Acc: 0.868 Test Loss: 0.326 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8997023105621338
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.338 Vali Acc: 0.882 Test Loss: 0.338 Test Acc: 0.882
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9508862495422363
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.855 Test Loss: 0.332 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0272281169891357
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.355 Vali Acc: 0.868 Test Loss: 0.355 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0555319786071777
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 8279044
model size : 34.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 11.190644979476929
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.418 Vali Acc: 0.237 Test Loss: 1.418 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 9.031856775283813
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.231 Vali Acc: 0.382 Test Loss: 1.231 Test Acc: 0.382
Validation loss decreased (-0.236828 --> -0.381567).  Saving model ...
Epoch: 3 cost time: 8.94684362411499
Epoch: 3, Steps: 10 | Train Loss: 1.038 Vali Loss: 0.988 Vali Acc: 0.664 Test Loss: 0.988 Test Acc: 0.664
Validation loss decreased (-0.381567 --> -0.664464).  Saving model ...
Epoch: 4 cost time: 9.117206811904907
Epoch: 4, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
Validation loss decreased (-0.664464 --> -0.782888).  Saving model ...
Epoch: 5 cost time: 8.909399032592773
Epoch: 5, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.508 Vali Acc: 0.829 Test Loss: 0.508 Test Acc: 0.829
Validation loss decreased (-0.782888 --> -0.828942).  Saving model ...
Epoch: 6 cost time: 8.88524341583252
Epoch: 6, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.395 Vali Acc: 0.829 Test Loss: 0.395 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 7 cost time: 7.31658673286438
Epoch: 7, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.333 Vali Acc: 0.862 Test Loss: 0.333 Test Acc: 0.862
Validation loss decreased (-0.828943 --> -0.861839).  Saving model ...
Epoch: 8 cost time: 9.920459985733032
Epoch: 8, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.386 Vali Acc: 0.849 Test Loss: 0.386 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.98320722579956
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.856340885162354
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.419 Vali Acc: 0.849 Test Loss: 0.419 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.144455671310425
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.445 Vali Acc: 0.882 Test Loss: 0.445 Test Acc: 0.882
Validation loss decreased (-0.861839 --> -0.881575).  Saving model ...
Epoch: 12 cost time: 8.668021202087402
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.422 Vali Acc: 0.888 Test Loss: 0.422 Test Acc: 0.888
Validation loss decreased (-0.881575 --> -0.888154).  Saving model ...
Epoch: 13 cost time: 9.322651624679565
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.398849487304688
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.820820808410645
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.650235176086426
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.610 Vali Acc: 0.849 Test Loss: 0.610 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.812163829803467
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.625 Vali Acc: 0.836 Test Loss: 0.625 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.547838687896729
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.672 Vali Acc: 0.849 Test Loss: 0.672 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.338251829147339
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.531 Vali Acc: 0.836 Test Loss: 0.531 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.242680549621582
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.360365152359009
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.555 Vali Acc: 0.868 Test Loss: 0.555 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.192787170410156
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.829 Test Loss: 0.680 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 28129924
model size : 108.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.240050315856934
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.364 Vali Acc: 0.296 Test Loss: 1.364 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 3.224123001098633
Epoch: 2, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
Validation loss decreased (-0.296039 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 3.7658863067626953
Epoch: 3, Steps: 10 | Train Loss: 0.967 Vali Loss: 0.971 Vali Acc: 0.697 Test Loss: 0.971 Test Acc: 0.697
Validation loss decreased (-0.519725 --> -0.697359).  Saving model ...
Epoch: 4 cost time: 3.7001519203186035
Epoch: 4, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.756 Vali Acc: 0.776 Test Loss: 0.756 Test Acc: 0.776
Validation loss decreased (-0.697359 --> -0.776308).  Saving model ...
Epoch: 5 cost time: 3.6220321655273438
Epoch: 5, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.776308 --> -0.802626).  Saving model ...
Epoch: 6 cost time: 3.677900791168213
Epoch: 6, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.467 Vali Acc: 0.842 Test Loss: 0.467 Test Acc: 0.842
Validation loss decreased (-0.802626 --> -0.842101).  Saving model ...
Epoch: 7 cost time: 3.5825467109680176
Epoch: 7, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.430 Vali Acc: 0.836 Test Loss: 0.430 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.558255910873413
Epoch: 8, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
Validation loss decreased (-0.842101 --> -0.861838).  Saving model ...
Epoch: 9 cost time: 3.480985641479492
Epoch: 9, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.401 Vali Acc: 0.868 Test Loss: 0.401 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 10 cost time: 3.7224814891815186
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 3.8678290843963623
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.420 Vali Acc: 0.868 Test Loss: 0.420 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.80586838722229
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.674995183944702
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.474 Vali Acc: 0.849 Test Loss: 0.474 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8292887210845947
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.600397825241089
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.502 Vali Acc: 0.829 Test Loss: 0.502 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.499861717224121
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.463 Vali Acc: 0.849 Test Loss: 0.463 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4587273597717285
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.862 Test Loss: 0.558 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.6464643478393555
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.621905565261841
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.999950647354126
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.594 Vali Acc: 0.862 Test Loss: 0.594 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 8270596
model size : 32.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.66202449798584
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.424 Vali Acc: 0.237 Test Loss: 1.424 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 6.647782325744629
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.260 Vali Acc: 0.408 Test Loss: 1.260 Test Acc: 0.408
Validation loss decreased (-0.236828 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 6.845092535018921
Epoch: 3, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.047 Vali Acc: 0.638 Test Loss: 1.047 Test Acc: 0.638
Validation loss decreased (-0.407882 --> -0.638147).  Saving model ...
Epoch: 4 cost time: 7.280839443206787
Epoch: 4, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.802 Vali Acc: 0.776 Test Loss: 0.802 Test Acc: 0.776
Validation loss decreased (-0.638147 --> -0.776308).  Saving model ...
Epoch: 5 cost time: 7.172211408615112
Epoch: 5, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.776308 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 6.350906133651733
Epoch: 6, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.448 Vali Acc: 0.809 Test Loss: 0.448 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 7 cost time: 6.628327131271362
Epoch: 7, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.358 Vali Acc: 0.829 Test Loss: 0.358 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828944).  Saving model ...
Epoch: 8 cost time: 6.5868353843688965
Epoch: 8, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.360 Vali Acc: 0.842 Test Loss: 0.360 Test Acc: 0.842
Validation loss decreased (-0.828944 --> -0.842102).  Saving model ...
Epoch: 9 cost time: 7.224333763122559
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.378 Vali Acc: 0.829 Test Loss: 0.378 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.286922454833984
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.004666090011597
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.435 Vali Acc: 0.842 Test Loss: 0.435 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.967187166213989
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.441 Vali Acc: 0.829 Test Loss: 0.441 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.99646782875061
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.431 Vali Acc: 0.849 Test Loss: 0.431 Test Acc: 0.849
Validation loss decreased (-0.842102 --> -0.848680).  Saving model ...
Epoch: 14 cost time: 7.144306659698486
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.3711628913879395
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.484 Vali Acc: 0.836 Test Loss: 0.484 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.491471290588379
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.563 Vali Acc: 0.836 Test Loss: 0.563 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.899556875228882
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.488 Vali Acc: 0.842 Test Loss: 0.488 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.677744388580322
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.524 Vali Acc: 0.836 Test Loss: 0.524 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.910463571548462
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.586890935897827
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.571 Vali Acc: 0.842 Test Loss: 0.571 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.202683448791504
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.533 Vali Acc: 0.849 Test Loss: 0.533 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.79349422454834
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.520 Vali Acc: 0.849 Test Loss: 0.520 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.734766244888306
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 28129924
model size : 108.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.158548355102539
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.368 Vali Acc: 0.296 Test Loss: 1.368 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 3.192195177078247
Epoch: 2, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.208 Vali Acc: 0.539 Test Loss: 1.208 Test Acc: 0.539
Validation loss decreased (-0.296039 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 3.177945852279663
Epoch: 3, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.013 Vali Acc: 0.664 Test Loss: 1.013 Test Acc: 0.664
Validation loss decreased (-0.539462 --> -0.664464).  Saving model ...
Epoch: 4 cost time: 3.091221332550049
Epoch: 4, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.815 Vali Acc: 0.757 Test Loss: 0.815 Test Acc: 0.757
Validation loss decreased (-0.664464 --> -0.756571).  Saving model ...
Epoch: 5 cost time: 2.9361939430236816
Epoch: 5, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
Validation loss decreased (-0.756571 --> -0.796046).  Saving model ...
Epoch: 6 cost time: 2.8821654319763184
Epoch: 6, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.506 Vali Acc: 0.836 Test Loss: 0.506 Test Acc: 0.836
Validation loss decreased (-0.796046 --> -0.835521).  Saving model ...
Epoch: 7 cost time: 2.9468941688537598
Epoch: 7, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.451 Vali Acc: 0.829 Test Loss: 0.451 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.827755928039551
Epoch: 8, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.405 Vali Acc: 0.842 Test Loss: 0.405 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842101).  Saving model ...
Epoch: 9 cost time: 2.850785493850708
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.409 Vali Acc: 0.849 Test Loss: 0.409 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 10 cost time: 3.2169549465179443
Epoch: 10, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.408 Vali Acc: 0.849 Test Loss: 0.408 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 11 cost time: 3.0099148750305176
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.404 Vali Acc: 0.836 Test Loss: 0.404 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0752816200256348
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 13 cost time: 2.265071392059326
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.439 Vali Acc: 0.836 Test Loss: 0.439 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.195132255554199
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.444 Vali Acc: 0.842 Test Loss: 0.444 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.471608877182007
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.444 Vali Acc: 0.842 Test Loss: 0.444 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7970938682556152
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.815126419067383
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.478 Vali Acc: 0.855 Test Loss: 0.478 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8695881366729736
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861837).  Saving model ...
Epoch: 19 cost time: 3.0764999389648438
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.520 Vali Acc: 0.836 Test Loss: 0.520 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.130723476409912
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.178476572036743
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1701533794403076
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.842 Test Loss: 0.525 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9035837650299072
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.842 Test Loss: 0.541 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6571590900421143
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.842 Test Loss: 0.550 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9502604007720947
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.568 Vali Acc: 0.849 Test Loss: 0.568 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.9636363983154297
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.842 Test Loss: 0.585 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.9477128982543945
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.634 Vali Acc: 0.829 Test Loss: 0.634 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9179306030273438
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.620 Vali Acc: 0.849 Test Loss: 0.620 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 8270596
model size : 32.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.653475522994995
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.436 Vali Acc: 0.204 Test Loss: 1.436 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 4.307787656784058
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.305 Vali Acc: 0.349 Test Loss: 1.305 Test Acc: 0.349
Validation loss decreased (-0.203933 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 4.620229244232178
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.139 Vali Acc: 0.592 Test Loss: 1.139 Test Acc: 0.592
Validation loss decreased (-0.348671 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 4.560637474060059
Epoch: 4, Steps: 10 | Train Loss: 0.973 Vali Loss: 0.935 Vali Acc: 0.737 Test Loss: 0.935 Test Acc: 0.737
Validation loss decreased (-0.592094 --> -0.736833).  Saving model ...
Epoch: 5 cost time: 4.340423345565796
Epoch: 5, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.731 Vali Acc: 0.796 Test Loss: 0.731 Test Acc: 0.796
Validation loss decreased (-0.736833 --> -0.796045).  Saving model ...
Epoch: 6 cost time: 5.0121564865112305
Epoch: 6, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 4.999388217926025
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.443 Vali Acc: 0.836 Test Loss: 0.443 Test Acc: 0.836
Validation loss decreased (-0.802626 --> -0.835522).  Saving model ...
Epoch: 8 cost time: 5.011294841766357
Epoch: 8, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.390 Vali Acc: 0.849 Test Loss: 0.390 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
Epoch: 9 cost time: 4.813840389251709
Epoch: 9, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 10 cost time: 4.70728611946106
Epoch: 10, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.360 Vali Acc: 0.822 Test Loss: 0.360 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.59001612663269
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.360 Vali Acc: 0.829 Test Loss: 0.360 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.711816072463989
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.366 Vali Acc: 0.829 Test Loss: 0.366 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.113248348236084
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.360 Vali Acc: 0.829 Test Loss: 0.360 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.000787973403931
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.359 Vali Acc: 0.836 Test Loss: 0.359 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.7130796909332275
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.369 Vali Acc: 0.836 Test Loss: 0.369 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.9451003074646
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.385 Vali Acc: 0.842 Test Loss: 0.385 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.653321981430054
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.394 Vali Acc: 0.842 Test Loss: 0.394 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.481240510940552
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.363751411437988
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.411 Vali Acc: 0.842 Test Loss: 0.411 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 28129924
model size : 108.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.351045370101929
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.371 Vali Acc: 0.289 Test Loss: 1.371 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.594121217727661
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.239 Vali Acc: 0.533 Test Loss: 1.239 Test Acc: 0.533
Validation loss decreased (-0.289460 --> -0.532882).  Saving model ...
Epoch: 3 cost time: 2.597430467605591
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.078 Vali Acc: 0.638 Test Loss: 1.078 Test Acc: 0.638
Validation loss decreased (-0.532882 --> -0.638147).  Saving model ...
Epoch: 4 cost time: 2.457068681716919
Epoch: 4, Steps: 10 | Train Loss: 0.920 Vali Loss: 0.905 Vali Acc: 0.691 Test Loss: 0.905 Test Acc: 0.691
Validation loss decreased (-0.638147 --> -0.690780).  Saving model ...
Epoch: 5 cost time: 2.4357028007507324
Epoch: 5, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
Validation loss decreased (-0.690780 --> -0.789466).  Saving model ...
Epoch: 6 cost time: 2.016531467437744
Epoch: 6, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
Validation loss decreased (-0.789466 --> -0.822363).  Saving model ...
Epoch: 7 cost time: 2.339306354522705
Epoch: 7, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.330012798309326
Epoch: 8, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.412 Vali Acc: 0.816 Test Loss: 0.412 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4467647075653076
Epoch: 9, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.379 Vali Acc: 0.829 Test Loss: 0.379 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828944).  Saving model ...
Epoch: 10 cost time: 2.4309606552124023
Epoch: 10, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.348 Vali Acc: 0.829 Test Loss: 0.348 Test Acc: 0.829
Validation loss decreased (-0.828944 --> -0.828944).  Saving model ...
Epoch: 11 cost time: 2.569953680038452
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.348 Vali Acc: 0.836 Test Loss: 0.348 Test Acc: 0.836
Validation loss decreased (-0.828944 --> -0.835523).  Saving model ...
Epoch: 12 cost time: 2.632079839706421
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.331 Vali Acc: 0.842 Test Loss: 0.331 Test Acc: 0.842
Validation loss decreased (-0.835523 --> -0.842102).  Saving model ...
Epoch: 13 cost time: 2.4901442527770996
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.323 Vali Acc: 0.855 Test Loss: 0.323 Test Acc: 0.855
Validation loss decreased (-0.842102 --> -0.855260).  Saving model ...
Epoch: 14 cost time: 2.403510570526123
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.322 Vali Acc: 0.855 Test Loss: 0.322 Test Acc: 0.855
Validation loss decreased (-0.855260 --> -0.855260).  Saving model ...
Epoch: 15 cost time: 2.4144287109375
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.317 Vali Acc: 0.855 Test Loss: 0.317 Test Acc: 0.855
Validation loss decreased (-0.855260 --> -0.855260).  Saving model ...
Epoch: 16 cost time: 2.457291603088379
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.322 Vali Acc: 0.855 Test Loss: 0.322 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3957319259643555
Epoch: 17, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.344 Vali Acc: 0.855 Test Loss: 0.344 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4792144298553467
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.332 Vali Acc: 0.855 Test Loss: 0.332 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.306137800216675
Epoch: 19, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.346 Vali Acc: 0.849 Test Loss: 0.346 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.356275796890259
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.347 Vali Acc: 0.842 Test Loss: 0.347 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5409493446350098
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.343 Vali Acc: 0.855 Test Loss: 0.343 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.6567673683166504
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861839).  Saving model ...
Epoch: 23 cost time: 2.5348784923553467
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.364 Vali Acc: 0.868 Test Loss: 0.364 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868417).  Saving model ...
Epoch: 24 cost time: 2.2301175594329834
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.558952808380127
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.368 Vali Acc: 0.862 Test Loss: 0.368 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.428600549697876
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.421389102935791
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.373 Vali Acc: 0.868 Test Loss: 0.373 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1207563877105713
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.501227855682373
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.381 Vali Acc: 0.868 Test Loss: 0.381 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7738308906555176
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 8270596
model size : 32.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.911144971847534
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.324 Vali Acc: 0.296 Test Loss: 1.324 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 4.989819288253784
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.167 Vali Acc: 0.586 Test Loss: 1.167 Test Acc: 0.586
Validation loss decreased (-0.296039 --> -0.585515).  Saving model ...
Epoch: 3 cost time: 4.953335285186768
Epoch: 3, Steps: 10 | Train Loss: 1.013 Vali Loss: 0.966 Vali Acc: 0.822 Test Loss: 0.966 Test Acc: 0.822
Validation loss decreased (-0.585515 --> -0.822359).  Saving model ...
Epoch: 4 cost time: 4.772910118103027
Epoch: 4, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.743 Vali Acc: 0.836 Test Loss: 0.743 Test Acc: 0.836
Validation loss decreased (-0.822359 --> -0.835519).  Saving model ...
Epoch: 5 cost time: 5.400127649307251
Epoch: 5, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.554 Vali Acc: 0.829 Test Loss: 0.554 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.442746877670288
Epoch: 6, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.174957752227783
Epoch: 7, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.414 Vali Acc: 0.849 Test Loss: 0.414 Test Acc: 0.849
Validation loss decreased (-0.835519 --> -0.848680).  Saving model ...
Epoch: 8 cost time: 5.045446872711182
Epoch: 8, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.97566294670105
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 10 cost time: 4.823671817779541
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.470 Vali Acc: 0.849 Test Loss: 0.470 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.136751174926758
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.512288570404053
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.517 Vali Acc: 0.849 Test Loss: 0.517 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.0056610107421875
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.541 Vali Acc: 0.862 Test Loss: 0.541 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861837).  Saving model ...
Epoch: 14 cost time: 4.832103252410889
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.583 Vali Acc: 0.862 Test Loss: 0.583 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.992954730987549
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.855 Test Loss: 0.609 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.78901743888855
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.584 Vali Acc: 0.855 Test Loss: 0.584 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.812386989593506
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.612 Vali Acc: 0.855 Test Loss: 0.612 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8238697052001953
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.900 Vali Acc: 0.757 Test Loss: 0.900 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.555645942687988
Epoch: 19, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.476 Vali Acc: 0.862 Test Loss: 0.476 Test Acc: 0.862
Validation loss decreased (-0.861837 --> -0.861837).  Saving model ...
Epoch: 20 cost time: 4.551934242248535
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.500 Vali Acc: 0.849 Test Loss: 0.500 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.473547458648682
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.560 Vali Acc: 0.849 Test Loss: 0.560 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.168503761291504
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.21289587020874
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.16490626335144
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.621 Vali Acc: 0.849 Test Loss: 0.621 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.7532548904418945
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.849 Test Loss: 0.654 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.57169246673584
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.668 Vali Acc: 0.849 Test Loss: 0.668 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.67241096496582
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.666 Vali Acc: 0.849 Test Loss: 0.666 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.91531229019165
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.666 Vali Acc: 0.849 Test Loss: 0.666 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.126468896865845
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.862 Test Loss: 0.633 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 14070148
model size : 54.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.242324113845825
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.377 Vali Acc: 0.263 Test Loss: 1.377 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.3335704803466797
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
Validation loss decreased (-0.263144 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 2.4587011337280273
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.090 Vali Acc: 0.658 Test Loss: 1.090 Test Acc: 0.658
Validation loss decreased (-0.467093 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 2.223829746246338
Epoch: 4, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.921 Vali Acc: 0.743 Test Loss: 0.921 Test Acc: 0.743
Validation loss decreased (-0.657884 --> -0.743412).  Saving model ...
Epoch: 5 cost time: 2.3835339546203613
Epoch: 5, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.742 Vali Acc: 0.816 Test Loss: 0.742 Test Acc: 0.816
Validation loss decreased (-0.743412 --> -0.815782).  Saving model ...
Epoch: 6 cost time: 2.3528072834014893
Epoch: 6, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
Validation loss decreased (-0.815782 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 2.2997965812683105
Epoch: 7, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6630122661590576
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
Validation loss decreased (-0.815784 --> -0.855259).  Saving model ...
Epoch: 9 cost time: 2.479332447052002
Epoch: 9, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.377 Vali Acc: 0.849 Test Loss: 0.377 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.566821575164795
Epoch: 10, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.358 Vali Acc: 0.855 Test Loss: 0.358 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855260).  Saving model ...
Epoch: 11 cost time: 2.487342357635498
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.359 Vali Acc: 0.849 Test Loss: 0.359 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.618391513824463
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.404 Vali Acc: 0.836 Test Loss: 0.404 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.560131788253784
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.376 Vali Acc: 0.849 Test Loss: 0.376 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3779189586639404
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.393 Vali Acc: 0.842 Test Loss: 0.393 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.919173002243042
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.409 Vali Acc: 0.842 Test Loss: 0.409 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5185353755950928
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.422 Vali Acc: 0.842 Test Loss: 0.422 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.544590950012207
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.427 Vali Acc: 0.842 Test Loss: 0.427 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.4327595233917236
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.461 Vali Acc: 0.842 Test Loss: 0.461 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4683847427368164
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.849 Test Loss: 0.493 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.45723557472229
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 4140292
model size : 17.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.223433971405029
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.328 Vali Acc: 0.309 Test Loss: 1.328 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 4.001410484313965
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.188 Vali Acc: 0.539 Test Loss: 1.188 Test Acc: 0.539
Validation loss decreased (-0.309197 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 3.871201753616333
Epoch: 3, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.013 Vali Acc: 0.776 Test Loss: 1.013 Test Acc: 0.776
Validation loss decreased (-0.539462 --> -0.776306).  Saving model ...
Epoch: 4 cost time: 3.5273027420043945
Epoch: 4, Steps: 10 | Train Loss: 0.855 Vali Loss: 0.817 Vali Acc: 0.822 Test Loss: 0.817 Test Acc: 0.822
Validation loss decreased (-0.776306 --> -0.822360).  Saving model ...
Epoch: 5 cost time: 3.8432390689849854
Epoch: 5, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.631 Vali Acc: 0.836 Test Loss: 0.631 Test Acc: 0.836
Validation loss decreased (-0.822360 --> -0.835520).  Saving model ...
Epoch: 6 cost time: 3.7703263759613037
Epoch: 6, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.799766778945923
Epoch: 7, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.427 Vali Acc: 0.836 Test Loss: 0.427 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835522).  Saving model ...
Epoch: 8 cost time: 3.9401321411132812
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
Validation loss decreased (-0.835522 --> -0.855259).  Saving model ...
Epoch: 9 cost time: 3.773291826248169
Epoch: 9, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 10 cost time: 4.078523397445679
Epoch: 10, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.456 Vali Acc: 0.842 Test Loss: 0.456 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.122918128967285
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 4.085043668746948
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.478 Vali Acc: 0.862 Test Loss: 0.478 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.668447971343994
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6285548210144043
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.509 Vali Acc: 0.849 Test Loss: 0.509 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7806713581085205
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.527 Vali Acc: 0.855 Test Loss: 0.527 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.87263822555542
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.822540521621704
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.558 Vali Acc: 0.868 Test Loss: 0.558 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.989837408065796
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.783114433288574
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.535 Vali Acc: 0.855 Test Loss: 0.535 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.495361328125
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.556 Vali Acc: 0.862 Test Loss: 0.556 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.952354669570923
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.849 Test Loss: 0.565 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 14070148
model size : 54.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.247031927108765
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.243675470352173
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.269 Vali Acc: 0.434 Test Loss: 1.269 Test Acc: 0.434
Validation loss decreased (-0.249986 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.7572720050811768
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.123 Vali Acc: 0.618 Test Loss: 1.123 Test Acc: 0.618
Validation loss decreased (-0.434198 --> -0.618410).  Saving model ...
Epoch: 4 cost time: 2.0973989963531494
Epoch: 4, Steps: 10 | Train Loss: 0.979 Vali Loss: 0.971 Vali Acc: 0.704 Test Loss: 0.971 Test Acc: 0.704
Validation loss decreased (-0.618410 --> -0.703938).  Saving model ...
Epoch: 5 cost time: 2.2174906730651855
Epoch: 5, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.807 Vali Acc: 0.763 Test Loss: 0.807 Test Acc: 0.763
Validation loss decreased (-0.703938 --> -0.763150).  Saving model ...
Epoch: 6 cost time: 2.2186293601989746
Epoch: 6, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
Validation loss decreased (-0.763150 --> -0.796046).  Saving model ...
Epoch: 7 cost time: 2.375314235687256
Epoch: 7, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.517 Vali Acc: 0.836 Test Loss: 0.517 Test Acc: 0.836
Validation loss decreased (-0.796046 --> -0.835521).  Saving model ...
Epoch: 8 cost time: 2.2314345836639404
Epoch: 8, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.835521 --> -0.855259).  Saving model ...
Epoch: 9 cost time: 2.053781032562256
Epoch: 9, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.425 Vali Acc: 0.822 Test Loss: 0.425 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3868236541748047
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.402 Vali Acc: 0.842 Test Loss: 0.402 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3660171031951904
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.377 Vali Acc: 0.842 Test Loss: 0.377 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1479809284210205
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.147923707962036
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.407 Vali Acc: 0.829 Test Loss: 0.407 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0608322620391846
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.407 Vali Acc: 0.849 Test Loss: 0.407 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1669325828552246
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.028341054916382
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1355464458465576
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.505 Vali Acc: 0.836 Test Loss: 0.505 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9071457386016846
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.487 Vali Acc: 0.822 Test Loss: 0.487 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 4140292
model size : 17.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.858546257019043
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.332 Vali Acc: 0.289 Test Loss: 1.332 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.8509087562561035
Epoch: 2, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.212 Vali Acc: 0.533 Test Loss: 1.212 Test Acc: 0.533
Validation loss decreased (-0.289460 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 2.802572727203369
Epoch: 3, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.071 Vali Acc: 0.737 Test Loss: 1.071 Test Acc: 0.737
Validation loss decreased (-0.532883 --> -0.736831).  Saving model ...
Epoch: 4 cost time: 2.5896809101104736
Epoch: 4, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.915 Vali Acc: 0.803 Test Loss: 0.915 Test Acc: 0.803
Validation loss decreased (-0.736831 --> -0.802622).  Saving model ...
Epoch: 5 cost time: 2.5869083404541016
Epoch: 5, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.766 Vali Acc: 0.809 Test Loss: 0.766 Test Acc: 0.809
Validation loss decreased (-0.802622 --> -0.809203).  Saving model ...
Epoch: 6 cost time: 2.717550754547119
Epoch: 6, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815783).  Saving model ...
Epoch: 7 cost time: 2.538195848464966
Epoch: 7, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.506 Vali Acc: 0.849 Test Loss: 0.506 Test Acc: 0.849
Validation loss decreased (-0.815783 --> -0.848679).  Saving model ...
Epoch: 8 cost time: 2.5489869117736816
Epoch: 8, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.428 Vali Acc: 0.842 Test Loss: 0.428 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7046570777893066
Epoch: 9, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855259).  Saving model ...
Epoch: 10 cost time: 2.7923295497894287
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.371 Vali Acc: 0.849 Test Loss: 0.371 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.830934762954712
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.362 Vali Acc: 0.849 Test Loss: 0.362 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8162355422973633
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.363 Vali Acc: 0.855 Test Loss: 0.363 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855260).  Saving model ...
Epoch: 13 cost time: 3.0325918197631836
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.360 Vali Acc: 0.842 Test Loss: 0.360 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8972041606903076
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861838).  Saving model ...
Epoch: 15 cost time: 2.9614133834838867
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.366 Vali Acc: 0.855 Test Loss: 0.366 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8008410930633545
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.379 Vali Acc: 0.855 Test Loss: 0.379 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.714454174041748
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8857638835906982
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.713956356048584
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.7341296672821045
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.403 Vali Acc: 0.868 Test Loss: 0.403 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 21 cost time: 2.6976358890533447
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7527127265930176
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.756889581680298
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.0005581378936768
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.446 Vali Acc: 0.842 Test Loss: 0.446 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.950533628463745
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.507 Vali Acc: 0.836 Test Loss: 0.507 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.895324230194092
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.449 Vali Acc: 0.836 Test Loss: 0.449 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.9556334018707275
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.470 Vali Acc: 0.842 Test Loss: 0.470 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.704780340194702
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.7494585514068604
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.54184889793396
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.502 Vali Acc: 0.842 Test Loss: 0.502 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 14070148
model size : 54.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.230351209640503
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.380 Vali Acc: 0.263 Test Loss: 1.380 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.8362717628479004
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.283 Vali Acc: 0.441 Test Loss: 1.283 Test Acc: 0.441
Validation loss decreased (-0.263144 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 1.857682228088379
Epoch: 3, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.156 Vali Acc: 0.599 Test Loss: 1.156 Test Acc: 0.599
Validation loss decreased (-0.440777 --> -0.598673).  Saving model ...
Epoch: 4 cost time: 1.7250628471374512
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.024 Vali Acc: 0.691 Test Loss: 1.024 Test Acc: 0.691
Validation loss decreased (-0.598673 --> -0.690779).  Saving model ...
Epoch: 5 cost time: 1.8179895877838135
Epoch: 5, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.881 Vali Acc: 0.737 Test Loss: 0.881 Test Acc: 0.737
Validation loss decreased (-0.690779 --> -0.736833).  Saving model ...
Epoch: 6 cost time: 1.8231048583984375
Epoch: 6, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.741 Vali Acc: 0.776 Test Loss: 0.741 Test Acc: 0.776
Validation loss decreased (-0.736833 --> -0.776308).  Saving model ...
Epoch: 7 cost time: 1.8051962852478027
Epoch: 7, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
Validation loss decreased (-0.776308 --> -0.809204).  Saving model ...
Epoch: 8 cost time: 1.8259520530700684
Epoch: 8, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.502 Vali Acc: 0.836 Test Loss: 0.502 Test Acc: 0.836
Validation loss decreased (-0.809204 --> -0.835521).  Saving model ...
Epoch: 9 cost time: 1.8198063373565674
Epoch: 9, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.434 Vali Acc: 0.849 Test Loss: 0.434 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848680).  Saving model ...
Epoch: 10 cost time: 1.724318265914917
Epoch: 10, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.383 Vali Acc: 0.855 Test Loss: 0.383 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 11 cost time: 1.6114416122436523
Epoch: 11, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861839).  Saving model ...
Epoch: 12 cost time: 1.7669811248779297
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.338 Vali Acc: 0.868 Test Loss: 0.338 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868418).  Saving model ...
Epoch: 13 cost time: 1.4671897888183594
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.336 Vali Acc: 0.868 Test Loss: 0.336 Test Acc: 0.868
Validation loss decreased (-0.868418 --> -0.868418).  Saving model ...
Epoch: 14 cost time: 1.5004115104675293
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
Validation loss decreased (-0.868418 --> -0.874997).  Saving model ...
Epoch: 15 cost time: 1.6519148349761963
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.333 Vali Acc: 0.862 Test Loss: 0.333 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7252757549285889
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.342 Vali Acc: 0.855 Test Loss: 0.342 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7307567596435547
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.337 Vali Acc: 0.842 Test Loss: 0.337 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6311774253845215
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.797137975692749
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.354 Vali Acc: 0.855 Test Loss: 0.354 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.817326307296753
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.373 Vali Acc: 0.868 Test Loss: 0.373 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.786163330078125
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.777953863143921
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7410166263580322
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6154661178588867
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.380 Vali Acc: 0.868 Test Loss: 0.380 Test Acc: 0.868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 4140292
model size : 17.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.903635501861572
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 3.183969736099243
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.279 Vali Acc: 0.454 Test Loss: 1.279 Test Acc: 0.454
Validation loss decreased (-0.243407 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 3.0114078521728516
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.119 Vali Acc: 0.645 Test Loss: 1.119 Test Acc: 0.645
Validation loss decreased (-0.453935 --> -0.644726).  Saving model ...
Epoch: 4 cost time: 3.0013346672058105
Epoch: 4, Steps: 10 | Train Loss: 0.999 Vali Loss: 0.935 Vali Acc: 0.796 Test Loss: 0.935 Test Acc: 0.796
Validation loss decreased (-0.644726 --> -0.796043).  Saving model ...
Epoch: 5 cost time: 2.984220266342163
Epoch: 5, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.796043 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 3.1725006103515625
Epoch: 6, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.557 Vali Acc: 0.868 Test Loss: 0.557 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2590043544769287
Epoch: 7, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7324867248535156
Epoch: 8, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.374 Vali Acc: 0.836 Test Loss: 0.374 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.898317337036133
Epoch: 9, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.340 Vali Acc: 0.855 Test Loss: 0.340 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3091063499450684
Epoch: 10, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.374 Vali Acc: 0.868 Test Loss: 0.374 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.39278244972229
Epoch: 11, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2898051738739014
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0550479888916016
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.393 Vali Acc: 0.842 Test Loss: 0.393 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.02915096282959
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.413 Vali Acc: 0.836 Test Loss: 0.413 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1330478191375732
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.430 Vali Acc: 0.829 Test Loss: 0.430 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 7040260
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3163576126098633
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.380 Vali Acc: 0.303 Test Loss: 1.380 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.9529151916503906
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.258 Vali Acc: 0.421 Test Loss: 1.258 Test Acc: 0.421
Validation loss decreased (-0.302618 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.8105039596557617
Epoch: 3, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.127 Vali Acc: 0.605 Test Loss: 1.127 Test Acc: 0.605
Validation loss decreased (-0.421040 --> -0.605252).  Saving model ...
Epoch: 4 cost time: 1.7435739040374756
Epoch: 4, Steps: 10 | Train Loss: 0.948 Vali Loss: 0.973 Vali Acc: 0.770 Test Loss: 0.973 Test Acc: 0.770
Validation loss decreased (-0.605252 --> -0.769727).  Saving model ...
Epoch: 5 cost time: 1.962764024734497
Epoch: 5, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.797 Vali Acc: 0.816 Test Loss: 0.797 Test Acc: 0.816
Validation loss decreased (-0.769727 --> -0.815782).  Saving model ...
Epoch: 6 cost time: 2.0053517818450928
Epoch: 6, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822362).  Saving model ...
Epoch: 7 cost time: 2.0246922969818115
Epoch: 7, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.523 Vali Acc: 0.849 Test Loss: 0.523 Test Acc: 0.849
Validation loss decreased (-0.822362 --> -0.848679).  Saving model ...
Epoch: 8 cost time: 2.0128321647644043
Epoch: 8, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.436 Vali Acc: 0.849 Test Loss: 0.436 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 9 cost time: 2.05914044380188
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.393 Vali Acc: 0.842 Test Loss: 0.393 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.919337511062622
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.377 Vali Acc: 0.842 Test Loss: 0.377 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8172461986541748
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.367 Vali Acc: 0.842 Test Loss: 0.367 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.967406988143921
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.369 Vali Acc: 0.842 Test Loss: 0.369 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.007047176361084
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 14 cost time: 1.9155018329620361
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.25494647026062
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.442 Vali Acc: 0.822 Test Loss: 0.442 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.144887685775757
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 17 cost time: 2.0733964443206787
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.436 Vali Acc: 0.842 Test Loss: 0.436 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0506181716918945
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.436 Vali Acc: 0.868 Test Loss: 0.436 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 19 cost time: 1.9450879096984863
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7904765605926514
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.114406108856201
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.086895227432251
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.464 Vali Acc: 0.849 Test Loss: 0.464 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1403117179870605
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.996476411819458
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1220364570617676
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.09315824508667
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.514 Vali Acc: 0.855 Test Loss: 0.514 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8788535594940186
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.1056296825408936
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.542 Vali Acc: 0.849 Test Loss: 0.542 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 2075140
model size : 9.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.371860027313232
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.460770845413208
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.288 Vali Acc: 0.441 Test Loss: 1.288 Test Acc: 0.441
Validation loss decreased (-0.243407 --> -0.440777).  Saving model ...
Epoch: 3 cost time: 2.714848518371582
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.440777 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 2.505326271057129
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 0.973 Vali Acc: 0.783 Test Loss: 0.973 Test Acc: 0.783
Validation loss decreased (-0.624989 --> -0.782885).  Saving model ...
Epoch: 5 cost time: 2.514439821243286
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.785 Vali Acc: 0.875 Test Loss: 0.785 Test Acc: 0.875
Validation loss decreased (-0.782885 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 2.5004794597625732
Epoch: 6, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 2.511780261993408
Epoch: 7, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.460 Vali Acc: 0.849 Test Loss: 0.460 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.560696601867676
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.676793098449707
Epoch: 9, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.354 Vali Acc: 0.849 Test Loss: 0.354 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6560513973236084
Epoch: 10, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.344 Vali Acc: 0.849 Test Loss: 0.344 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5083444118499756
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.377 Vali Acc: 0.836 Test Loss: 0.377 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.446688652038574
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.366 Vali Acc: 0.855 Test Loss: 0.366 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5415866374969482
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.399824857711792
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5316405296325684
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.387 Vali Acc: 0.855 Test Loss: 0.387 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5819203853607178
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.428 Vali Acc: 0.816 Test Loss: 0.428 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 7040260
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.909552574157715
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.388 Vali Acc: 0.283 Test Loss: 1.388 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.5661704540252686
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.273 Vali Acc: 0.408 Test Loss: 1.273 Test Acc: 0.408
Validation loss decreased (-0.282881 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.6187665462493896
Epoch: 3, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.154 Vali Acc: 0.579 Test Loss: 1.154 Test Acc: 0.579
Validation loss decreased (-0.407882 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 1.571052074432373
Epoch: 4, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.014 Vali Acc: 0.724 Test Loss: 1.014 Test Acc: 0.724
Validation loss decreased (-0.578936 --> -0.723674).  Saving model ...
Epoch: 5 cost time: 1.5425331592559814
Epoch: 5, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.854 Vali Acc: 0.796 Test Loss: 0.854 Test Acc: 0.796
Validation loss decreased (-0.723674 --> -0.796044).  Saving model ...
Epoch: 6 cost time: 1.6475937366485596
Epoch: 6, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.704 Vali Acc: 0.829 Test Loss: 0.704 Test Acc: 0.829
Validation loss decreased (-0.796044 --> -0.828940).  Saving model ...
Epoch: 7 cost time: 1.5972635746002197
Epoch: 7, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
Validation loss decreased (-0.828940 --> -0.855257).  Saving model ...
Epoch: 8 cost time: 1.5770950317382812
Epoch: 8, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.479 Vali Acc: 0.862 Test Loss: 0.479 Test Acc: 0.862
Validation loss decreased (-0.855257 --> -0.861837).  Saving model ...
Epoch: 9 cost time: 1.6445071697235107
Epoch: 9, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.421 Vali Acc: 0.849 Test Loss: 0.421 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.696972370147705
Epoch: 10, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.406 Vali Acc: 0.842 Test Loss: 0.406 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.535186767578125
Epoch: 11, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.369 Vali Acc: 0.829 Test Loss: 0.369 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5322060585021973
Epoch: 12, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.371 Vali Acc: 0.829 Test Loss: 0.371 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.601508617401123
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.354 Vali Acc: 0.849 Test Loss: 0.354 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5859205722808838
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.373 Vali Acc: 0.849 Test Loss: 0.373 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5237102508544922
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.386 Vali Acc: 0.842 Test Loss: 0.386 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6079869270324707
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.435 Vali Acc: 0.842 Test Loss: 0.435 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6649374961853027
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.442 Vali Acc: 0.842 Test Loss: 0.442 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7018840312957764
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 2075140
model size : 9.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2938575744628906
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.8770179748535156
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.313 Vali Acc: 0.368 Test Loss: 1.313 Test Acc: 0.368
Validation loss decreased (-0.243407 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.8052270412445068
Epoch: 3, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.185 Vali Acc: 0.559 Test Loss: 1.185 Test Acc: 0.559
Validation loss decreased (-0.368408 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.480492115020752
Epoch: 4, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.043 Vali Acc: 0.724 Test Loss: 1.043 Test Acc: 0.724
Validation loss decreased (-0.559199 --> -0.723674).  Saving model ...
Epoch: 5 cost time: 1.47548508644104
Epoch: 5, Steps: 10 | Train Loss: 0.932 Vali Loss: 0.885 Vali Acc: 0.816 Test Loss: 0.885 Test Acc: 0.816
Validation loss decreased (-0.723674 --> -0.815781).  Saving model ...
Epoch: 6 cost time: 1.4633986949920654
Epoch: 6, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.719 Vali Acc: 0.875 Test Loss: 0.719 Test Acc: 0.875
Validation loss decreased (-0.815781 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 1.7361128330230713
Epoch: 7, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.562 Vali Acc: 0.868 Test Loss: 0.562 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7726497650146484
Epoch: 8, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9262778759002686
Epoch: 9, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.383 Vali Acc: 0.868 Test Loss: 0.383 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.823946475982666
Epoch: 10, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.344 Vali Acc: 0.882 Test Loss: 0.344 Test Acc: 0.882
Validation loss decreased (-0.874993 --> -0.881576).  Saving model ...
Epoch: 11 cost time: 1.8747262954711914
Epoch: 11, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.332 Vali Acc: 0.882 Test Loss: 0.332 Test Acc: 0.882
Validation loss decreased (-0.881576 --> -0.881576).  Saving model ...
Epoch: 12 cost time: 1.8455698490142822
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.318 Vali Acc: 0.862 Test Loss: 0.318 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8099594116210938
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.321 Vali Acc: 0.888 Test Loss: 0.321 Test Acc: 0.888
Validation loss decreased (-0.881576 --> -0.888155).  Saving model ...
Epoch: 14 cost time: 1.9819104671478271
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.323 Vali Acc: 0.849 Test Loss: 0.323 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7862703800201416
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9366424083709717
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.321 Vali Acc: 0.849 Test Loss: 0.321 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0438218116760254
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.331 Vali Acc: 0.842 Test Loss: 0.331 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0200541019439697
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.347 Vali Acc: 0.849 Test Loss: 0.347 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9970643520355225
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.358 Vali Acc: 0.849 Test Loss: 0.358 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0125832557678223
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.362 Vali Acc: 0.868 Test Loss: 0.362 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9393823146820068
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.967494010925293
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.374 Vali Acc: 0.868 Test Loss: 0.374 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0187652111053467
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 7040260
model size : 28.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9839870929718018
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.391 Vali Acc: 0.283 Test Loss: 1.391 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.4601523876190186
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.286 Vali Acc: 0.388 Test Loss: 1.286 Test Acc: 0.388
Validation loss decreased (-0.282881 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.4434583187103271
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.181 Vali Acc: 0.586 Test Loss: 1.181 Test Acc: 0.586
Validation loss decreased (-0.388145 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.421452283859253
Epoch: 4, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.064 Vali Acc: 0.691 Test Loss: 1.064 Test Acc: 0.691
Validation loss decreased (-0.585515 --> -0.690779).  Saving model ...
Epoch: 5 cost time: 1.4568512439727783
Epoch: 5, Steps: 10 | Train Loss: 0.887 Vali Loss: 0.926 Vali Acc: 0.783 Test Loss: 0.926 Test Acc: 0.783
Validation loss decreased (-0.690779 --> -0.782885).  Saving model ...
Epoch: 6 cost time: 1.4431824684143066
Epoch: 6, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
Validation loss decreased (-0.782885 --> -0.782887).  Saving model ...
Epoch: 7 cost time: 1.515639305114746
Epoch: 7, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.668 Vali Acc: 0.862 Test Loss: 0.668 Test Acc: 0.862
Validation loss decreased (-0.782887 --> -0.861835).  Saving model ...
Epoch: 8 cost time: 1.5013396739959717
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.567 Vali Acc: 0.862 Test Loss: 0.567 Test Acc: 0.862
Validation loss decreased (-0.861835 --> -0.861836).  Saving model ...
Epoch: 9 cost time: 1.5253207683563232
Epoch: 9, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.479 Vali Acc: 0.849 Test Loss: 0.479 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5032916069030762
Epoch: 10, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4510607719421387
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.385 Vali Acc: 0.829 Test Loss: 0.385 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3878629207611084
Epoch: 12, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.370 Vali Acc: 0.836 Test Loss: 0.370 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4523026943206787
Epoch: 13, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.346 Vali Acc: 0.849 Test Loss: 0.346 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.373946189880371
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.338 Vali Acc: 0.842 Test Loss: 0.338 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4568819999694824
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.338 Vali Acc: 0.855 Test Loss: 0.338 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4267373085021973
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.350 Vali Acc: 0.842 Test Loss: 0.350 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.397230625152588
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.338 Vali Acc: 0.842 Test Loss: 0.338 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5719964504241943
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.340 Vali Acc: 0.855 Test Loss: 0.340 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 2075140
model size : 9.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.063426971435547
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.418 Vali Acc: 0.270 Test Loss: 1.418 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 3.461717367172241
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.323 Vali Acc: 0.362 Test Loss: 1.323 Test Acc: 0.362
Validation loss decreased (-0.269723 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 3.4037208557128906
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.212 Vali Acc: 0.507 Test Loss: 1.212 Test Acc: 0.507
Validation loss decreased (-0.361829 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 3.596956729888916
Epoch: 4, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.087 Vali Acc: 0.618 Test Loss: 1.087 Test Acc: 0.618
Validation loss decreased (-0.506567 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 3.750683069229126
Epoch: 5, Steps: 10 | Train Loss: 0.898 Vali Loss: 0.939 Vali Acc: 0.730 Test Loss: 0.939 Test Acc: 0.730
Validation loss decreased (-0.618410 --> -0.730254).  Saving model ...
Epoch: 6 cost time: 3.6522295475006104
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.798 Vali Acc: 0.757 Test Loss: 0.798 Test Acc: 0.757
Validation loss decreased (-0.730254 --> -0.756571).  Saving model ...
Epoch: 7 cost time: 3.496835231781006
Epoch: 7, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
Validation loss decreased (-0.756571 --> -0.789467).  Saving model ...
Epoch: 8 cost time: 3.3879566192626953
Epoch: 8, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.547 Vali Acc: 0.829 Test Loss: 0.547 Test Acc: 0.829
Validation loss decreased (-0.789467 --> -0.828942).  Saving model ...
Epoch: 9 cost time: 3.3585667610168457
Epoch: 9, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.548354387283325
Epoch: 10, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.450 Vali Acc: 0.829 Test Loss: 0.450 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 11 cost time: 3.6647355556488037
Epoch: 11, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.528672933578491
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0856497287750244
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8251962661743164
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.491 Vali Acc: 0.829 Test Loss: 0.491 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.285949945449829
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.498340368270874
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.590 Vali Acc: 0.829 Test Loss: 0.590 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4844672679901123
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.5429866313934326
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2750327587127686
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.211421251296997
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.594 Vali Acc: 0.829 Test Loss: 0.594 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 7036228
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7865540981292725
Epoch: 1, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.405 Vali Acc: 0.296 Test Loss: 1.405 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.920745611190796
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.303 Vali Acc: 0.388 Test Loss: 1.303 Test Acc: 0.388
Validation loss decreased (-0.296039 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 2.1334054470062256
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
Validation loss decreased (-0.388145 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 2.127462148666382
Epoch: 4, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.075 Vali Acc: 0.566 Test Loss: 1.075 Test Acc: 0.566
Validation loss decreased (-0.480251 --> -0.565779).  Saving model ...
Epoch: 5 cost time: 1.9961464405059814
Epoch: 5, Steps: 10 | Train Loss: 0.895 Vali Loss: 0.944 Vali Acc: 0.645 Test Loss: 0.944 Test Acc: 0.645
Validation loss decreased (-0.565779 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 1.9857227802276611
Epoch: 6, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.822 Vali Acc: 0.724 Test Loss: 0.822 Test Acc: 0.724
Validation loss decreased (-0.644727 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 2.0633575916290283
Epoch: 7, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
Validation loss decreased (-0.723676 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 2.271430492401123
Epoch: 8, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.763151 --> -0.796046).  Saving model ...
Epoch: 9 cost time: 2.156414270401001
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 2.242567777633667
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 11 cost time: 2.145967721939087
Epoch: 11, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.448 Vali Acc: 0.809 Test Loss: 0.448 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 12 cost time: 2.148624897003174
Epoch: 12, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.425 Vali Acc: 0.829 Test Loss: 0.425 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 13 cost time: 2.0892581939697266
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.408 Vali Acc: 0.836 Test Loss: 0.408 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 14 cost time: 1.9564476013183594
Epoch: 14, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.388 Vali Acc: 0.842 Test Loss: 0.388 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 2.097017526626587
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.394 Vali Acc: 0.842 Test Loss: 0.394 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.123383045196533
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.425 Vali Acc: 0.836 Test Loss: 0.425 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.228865385055542
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.434 Vali Acc: 0.836 Test Loss: 0.434 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.192545175552368
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.435 Vali Acc: 0.849 Test Loss: 0.435 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 19 cost time: 2.3467416763305664
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.456 Vali Acc: 0.836 Test Loss: 0.456 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1796441078186035
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.156813859939575
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.503 Vali Acc: 0.829 Test Loss: 0.503 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1629652976989746
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.520 Vali Acc: 0.842 Test Loss: 0.520 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.132077693939209
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.520 Vali Acc: 0.842 Test Loss: 0.520 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9688007831573486
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.515 Vali Acc: 0.849 Test Loss: 0.515 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2064807415008545
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.519 Vali Acc: 0.842 Test Loss: 0.519 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2629847526550293
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.589 Vali Acc: 0.849 Test Loss: 0.589 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.025669813156128
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.587 Vali Acc: 0.842 Test Loss: 0.587 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.087994337081909
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.574 Vali Acc: 0.862 Test Loss: 0.574 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861836).  Saving model ...
Epoch: 29 cost time: 2.4608752727508545
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.547 Vali Acc: 0.882 Test Loss: 0.547 Test Acc: 0.882
Validation loss decreased (-0.861836 --> -0.881573).  Saving model ...
Epoch: 30 cost time: 2.5221660137176514
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.579 Vali Acc: 0.842 Test Loss: 0.579 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 2070916
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.14538836479187
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.422 Vali Acc: 0.276 Test Loss: 1.422 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 3.3423502445220947
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.341 Vali Acc: 0.362 Test Loss: 1.341 Test Acc: 0.362
Validation loss decreased (-0.276302 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 3.28281831741333
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.246 Vali Acc: 0.493 Test Loss: 1.246 Test Acc: 0.493
Validation loss decreased (-0.361829 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 3.2929251194000244
Epoch: 4, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.145 Vali Acc: 0.599 Test Loss: 1.145 Test Acc: 0.599
Validation loss decreased (-0.493409 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 3.2954530715942383
Epoch: 5, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.030 Vali Acc: 0.645 Test Loss: 1.030 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 3.3928918838500977
Epoch: 6, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.902 Vali Acc: 0.743 Test Loss: 0.902 Test Acc: 0.743
Validation loss decreased (-0.644727 --> -0.743412).  Saving model ...
Epoch: 7 cost time: 3.388556718826294
Epoch: 7, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.772 Vali Acc: 0.816 Test Loss: 0.772 Test Acc: 0.816
Validation loss decreased (-0.743412 --> -0.815782).  Saving model ...
Epoch: 8 cost time: 3.427168369293213
Epoch: 8, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4501683712005615
Epoch: 9, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.359445571899414
Epoch: 10, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
Validation loss decreased (-0.815782 --> -0.815785).  Saving model ...
Epoch: 11 cost time: 3.1654446125030518
Epoch: 11, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 12 cost time: 3.246629476547241
Epoch: 12, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 13 cost time: 3.278275728225708
Epoch: 13, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.375 Vali Acc: 0.829 Test Loss: 0.375 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828944).  Saving model ...
Epoch: 14 cost time: 3.2967031002044678
Epoch: 14, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2628557682037354
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.399 Vali Acc: 0.829 Test Loss: 0.399 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2638022899627686
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
Validation loss decreased (-0.828944 --> -0.848680).  Saving model ...
Epoch: 17 cost time: 3.2492566108703613
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.397 Vali Acc: 0.849 Test Loss: 0.397 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 18 cost time: 3.3201699256896973
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.469 Vali Acc: 0.836 Test Loss: 0.469 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.32308292388916
Epoch: 19, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.364166498184204
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.467 Vali Acc: 0.836 Test Loss: 0.467 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.423860549926758
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.513 Vali Acc: 0.836 Test Loss: 0.513 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.508823871612549
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.526 Vali Acc: 0.822 Test Loss: 0.526 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.338209629058838
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 24 cost time: 3.315877914428711
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4323818683624268
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.317213296890259
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.500 Vali Acc: 0.836 Test Loss: 0.500 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.328234910964966
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.500 Vali Acc: 0.836 Test Loss: 0.500 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2193686962127686
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.535 Vali Acc: 0.829 Test Loss: 0.535 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.1873912811279297
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.515 Vali Acc: 0.855 Test Loss: 0.515 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.2814488410949707
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.548 Vali Acc: 0.842 Test Loss: 0.548 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 7036228
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6390435695648193
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.402 Vali Acc: 0.289 Test Loss: 1.402 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.9267683029174805
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.306 Vali Acc: 0.401 Test Loss: 1.306 Test Acc: 0.401
Validation loss decreased (-0.289460 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.945927381515503
Epoch: 3, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.201 Vali Acc: 0.493 Test Loss: 1.201 Test Acc: 0.493
Validation loss decreased (-0.401303 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.8835735321044922
Epoch: 4, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.095 Vali Acc: 0.559 Test Loss: 1.095 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.790776252746582
Epoch: 5, Steps: 10 | Train Loss: 0.952 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
Validation loss decreased (-0.559200 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 1.8496184349060059
Epoch: 6, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
Validation loss decreased (-0.624990 --> -0.717097).  Saving model ...
Epoch: 7 cost time: 1.886627197265625
Epoch: 7, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.760 Vali Acc: 0.730 Test Loss: 0.760 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.9232001304626465
Epoch: 8, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 2.0286216735839844
Epoch: 9, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 2.0075619220733643
Epoch: 10, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
Validation loss decreased (-0.756573 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.992762804031372
Epoch: 11, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 12 cost time: 1.9228649139404297
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.429 Vali Acc: 0.816 Test Loss: 0.429 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 13 cost time: 1.9772801399230957
Epoch: 13, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.404 Vali Acc: 0.822 Test Loss: 0.404 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 14 cost time: 1.9360787868499756
Epoch: 14, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.9993233680725098
Epoch: 15, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.387 Vali Acc: 0.829 Test Loss: 0.387 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 16 cost time: 2.0633363723754883
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1212728023529053
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.372 Vali Acc: 0.836 Test Loss: 0.372 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835523).  Saving model ...
Epoch: 18 cost time: 2.0512051582336426
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.348 Vali Acc: 0.849 Test Loss: 0.348 Test Acc: 0.849
Validation loss decreased (-0.835523 --> -0.848681).  Saving model ...
Epoch: 19 cost time: 2.069916009902954
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.361 Vali Acc: 0.855 Test Loss: 0.361 Test Acc: 0.855
Validation loss decreased (-0.848681 --> -0.855260).  Saving model ...
Epoch: 20 cost time: 2.067032814025879
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.388 Vali Acc: 0.836 Test Loss: 0.388 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0956437587738037
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.414 Vali Acc: 0.829 Test Loss: 0.414 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0752127170562744
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.409 Vali Acc: 0.836 Test Loss: 0.409 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0813558101654053
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1263113021850586
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8879673480987549
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.434 Vali Acc: 0.829 Test Loss: 0.434 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2196691036224365
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6433000564575195
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.449 Vali Acc: 0.836 Test Loss: 0.449 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.677530288696289
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7362103462219238
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 2070916
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.95235013961792
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 2.4514126777648926
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.356 Vali Acc: 0.349 Test Loss: 1.356 Test Acc: 0.349
Validation loss decreased (-0.269723 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 2.402580976486206
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.275 Vali Acc: 0.434 Test Loss: 1.275 Test Acc: 0.434
Validation loss decreased (-0.348671 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 2.3638527393341064
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.189 Vali Acc: 0.553 Test Loss: 1.189 Test Acc: 0.553
Validation loss decreased (-0.434198 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 2.44649076461792
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
Validation loss decreased (-0.552620 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 2.3838002681732178
Epoch: 6, Steps: 10 | Train Loss: 0.959 Vali Loss: 0.982 Vali Acc: 0.671 Test Loss: 0.982 Test Acc: 0.671
Validation loss decreased (-0.624989 --> -0.671043).  Saving model ...
Epoch: 7 cost time: 2.445251941680908
Epoch: 7, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.870 Vali Acc: 0.770 Test Loss: 0.870 Test Acc: 0.770
Validation loss decreased (-0.671043 --> -0.769728).  Saving model ...
Epoch: 8 cost time: 2.464996337890625
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.758 Vali Acc: 0.776 Test Loss: 0.758 Test Acc: 0.776
Validation loss decreased (-0.769728 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 2.235914945602417
Epoch: 9, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
Validation loss decreased (-0.776308 --> -0.809204).  Saving model ...
Epoch: 10 cost time: 2.584778070449829
Epoch: 10, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.576 Vali Acc: 0.822 Test Loss: 0.576 Test Acc: 0.822
Validation loss decreased (-0.809204 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 2.449878692626953
Epoch: 11, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828942).  Saving model ...
Epoch: 12 cost time: 2.5933361053466797
Epoch: 12, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.455 Vali Acc: 0.822 Test Loss: 0.455 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6251120567321777
Epoch: 13, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.409 Vali Acc: 0.842 Test Loss: 0.409 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842101).  Saving model ...
Epoch: 14 cost time: 2.6583473682403564
Epoch: 14, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.375 Vali Acc: 0.842 Test Loss: 0.375 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842102).  Saving model ...
Epoch: 15 cost time: 2.609264850616455
Epoch: 15, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.366 Vali Acc: 0.836 Test Loss: 0.366 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.375248908996582
Epoch: 16, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.342 Vali Acc: 0.842 Test Loss: 0.342 Test Acc: 0.842
Validation loss decreased (-0.842102 --> -0.842102).  Saving model ...
Epoch: 17 cost time: 2.678705930709839
Epoch: 17, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.341 Vali Acc: 0.849 Test Loss: 0.341 Test Acc: 0.849
Validation loss decreased (-0.842102 --> -0.848681).  Saving model ...
Epoch: 18 cost time: 2.6593618392944336
Epoch: 18, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.323 Vali Acc: 0.842 Test Loss: 0.323 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4486336708068848
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.324 Vali Acc: 0.868 Test Loss: 0.324 Test Acc: 0.868
Validation loss decreased (-0.848681 --> -0.868418).  Saving model ...
Epoch: 20 cost time: 2.591540575027466
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.328 Vali Acc: 0.849 Test Loss: 0.328 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6119861602783203
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.334 Vali Acc: 0.836 Test Loss: 0.334 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.551379680633545
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.326 Vali Acc: 0.849 Test Loss: 0.326 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.527311086654663
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.324 Vali Acc: 0.849 Test Loss: 0.324 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5485315322875977
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.333 Vali Acc: 0.849 Test Loss: 0.333 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8024957180023193
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.331 Vali Acc: 0.842 Test Loss: 0.331 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.729473352432251
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.340 Vali Acc: 0.868 Test Loss: 0.340 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.4349424839019775
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.335 Vali Acc: 0.849 Test Loss: 0.335 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.6084980964660645
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.344 Vali Acc: 0.855 Test Loss: 0.344 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.5806002616882324
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 7036228
model size : 27.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4452130794525146
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.409 Vali Acc: 0.309 Test Loss: 1.409 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.6165237426757812
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.327 Vali Acc: 0.382 Test Loss: 1.327 Test Acc: 0.382
Validation loss decreased (-0.309196 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.6853594779968262
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.235 Vali Acc: 0.480 Test Loss: 1.235 Test Acc: 0.480
Validation loss decreased (-0.381566 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 1.5840086936950684
Epoch: 4, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.141 Vali Acc: 0.546 Test Loss: 1.141 Test Acc: 0.546
Validation loss decreased (-0.480251 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 1.621424913406372
Epoch: 5, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.039 Vali Acc: 0.572 Test Loss: 1.039 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572358).  Saving model ...
Epoch: 6 cost time: 1.6276500225067139
Epoch: 6, Steps: 10 | Train Loss: 0.898 Vali Loss: 0.943 Vali Acc: 0.645 Test Loss: 0.943 Test Acc: 0.645
Validation loss decreased (-0.572358 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.5398800373077393
Epoch: 7, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.848 Vali Acc: 0.684 Test Loss: 0.848 Test Acc: 0.684
Validation loss decreased (-0.644727 --> -0.684202).  Saving model ...
Epoch: 8 cost time: 1.6028993129730225
Epoch: 8, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.762 Vali Acc: 0.750 Test Loss: 0.762 Test Acc: 0.750
Validation loss decreased (-0.684202 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 1.7998831272125244
Epoch: 9, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.782888).  Saving model ...
Epoch: 10 cost time: 1.6010801792144775
Epoch: 10, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 11 cost time: 1.6983239650726318
Epoch: 11, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.550 Vali Acc: 0.829 Test Loss: 0.550 Test Acc: 0.829
Validation loss decreased (-0.802625 --> -0.828942).  Saving model ...
Epoch: 12 cost time: 1.6984729766845703
Epoch: 12, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 13 cost time: 1.803398847579956
Epoch: 13, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.449 Vali Acc: 0.849 Test Loss: 0.449 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848680).  Saving model ...
Epoch: 14 cost time: 1.704758644104004
Epoch: 14, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 15 cost time: 1.679306983947754
Epoch: 15, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.396 Vali Acc: 0.849 Test Loss: 0.396 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6668167114257812
Epoch: 16, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 17 cost time: 1.7498769760131836
Epoch: 17, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.361 Vali Acc: 0.882 Test Loss: 0.361 Test Acc: 0.882
Validation loss decreased (-0.861838 --> -0.881575).  Saving model ...
Epoch: 18 cost time: 1.695570707321167
Epoch: 18, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.347 Vali Acc: 0.868 Test Loss: 0.347 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7041029930114746
Epoch: 19, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.336 Vali Acc: 0.862 Test Loss: 0.336 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.694309949874878
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.335 Vali Acc: 0.862 Test Loss: 0.335 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7598302364349365
Epoch: 21, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.326 Vali Acc: 0.868 Test Loss: 0.326 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6641626358032227
Epoch: 22, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8137433528900146
Epoch: 23, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.331 Vali Acc: 0.868 Test Loss: 0.331 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6665339469909668
Epoch: 24, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7131171226501465
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.330 Vali Acc: 0.875 Test Loss: 0.330 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6074261665344238
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7016582489013672
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.326 Vali Acc: 0.882 Test Loss: 0.326 Test Acc: 0.882
Validation loss decreased (-0.881575 --> -0.881576).  Saving model ...
Epoch: 28 cost time: 1.6898164749145508
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.347 Vali Acc: 0.868 Test Loss: 0.347 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5187392234802246
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.325 Vali Acc: 0.888 Test Loss: 0.325 Test Acc: 0.888
Validation loss decreased (-0.881576 --> -0.888155).  Saving model ...
Epoch: 30 cost time: 1.4282469749450684
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.344 Vali Acc: 0.868 Test Loss: 0.344 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 2070916
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.6977760791778564
Epoch: 1, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.336 Vali Acc: 0.289 Test Loss: 1.336 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.836822986602783
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.279 Vali Acc: 0.395 Test Loss: 1.279 Test Acc: 0.395
Validation loss decreased (-0.289460 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 2.835075616836548
Epoch: 3, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.204 Vali Acc: 0.513 Test Loss: 1.204 Test Acc: 0.513
Validation loss decreased (-0.394724 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 2.62992787361145
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.513146 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 2.6915688514709473
Epoch: 5, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.020 Vali Acc: 0.711 Test Loss: 1.020 Test Acc: 0.711
Validation loss decreased (-0.624989 --> -0.710516).  Saving model ...
Epoch: 6 cost time: 2.6672325134277344
Epoch: 6, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.903 Vali Acc: 0.757 Test Loss: 0.903 Test Acc: 0.757
Validation loss decreased (-0.710516 --> -0.756570).  Saving model ...
Epoch: 7 cost time: 2.804542064666748
Epoch: 7, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.790 Vali Acc: 0.770 Test Loss: 0.790 Test Acc: 0.770
Validation loss decreased (-0.756570 --> -0.769729).  Saving model ...
Epoch: 8 cost time: 2.691054344177246
Epoch: 8, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
Validation loss decreased (-0.769729 --> -0.815783).  Saving model ...
Epoch: 9 cost time: 3.0551254749298096
Epoch: 9, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 10 cost time: 3.0314524173736572
Epoch: 10, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.547 Vali Acc: 0.836 Test Loss: 0.547 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835521).  Saving model ...
Epoch: 11 cost time: 3.1640684604644775
Epoch: 11, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.489 Vali Acc: 0.829 Test Loss: 0.489 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.078061103820801
Epoch: 12, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.508 Vali Acc: 0.849 Test Loss: 0.508 Test Acc: 0.849
Validation loss decreased (-0.835521 --> -0.848679).  Saving model ...
Epoch: 13 cost time: 3.211581230163574
Epoch: 13, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.974245309829712
Epoch: 14, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.504 Vali Acc: 0.836 Test Loss: 0.504 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1474127769470215
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.522 Vali Acc: 0.816 Test Loss: 0.522 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1294500827789307
Epoch: 16, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.503 Vali Acc: 0.829 Test Loss: 0.503 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0192759037017822
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.535 Vali Acc: 0.836 Test Loss: 0.535 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9140784740448
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.550 Vali Acc: 0.829 Test Loss: 0.550 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.187643527984619
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.555 Vali Acc: 0.842 Test Loss: 0.555 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.069490671157837
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.573 Vali Acc: 0.836 Test Loss: 0.573 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9559006690979004
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.610 Vali Acc: 0.829 Test Loss: 0.610 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.922150135040283
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.619 Vali Acc: 0.836 Test Loss: 0.619 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 3520708
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4105281829833984
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.456 Vali Acc: 0.243 Test Loss: 1.456 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 1.7672839164733887
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.371 Vali Acc: 0.283 Test Loss: 1.371 Test Acc: 0.283
Validation loss decreased (-0.243406 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.6933300495147705
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.271 Vali Acc: 0.434 Test Loss: 1.271 Test Acc: 0.434
Validation loss decreased (-0.282881 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 2.171113967895508
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.171 Vali Acc: 0.559 Test Loss: 1.171 Test Acc: 0.559
Validation loss decreased (-0.434198 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 2.236262321472168
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.061 Vali Acc: 0.651 Test Loss: 1.061 Test Acc: 0.651
Validation loss decreased (-0.559199 --> -0.651305).  Saving model ...
Epoch: 6 cost time: 2.2324485778808594
Epoch: 6, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.941 Vali Acc: 0.763 Test Loss: 0.941 Test Acc: 0.763
Validation loss decreased (-0.651305 --> -0.763148).  Saving model ...
Epoch: 7 cost time: 2.047727584838867
Epoch: 7, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.818 Vali Acc: 0.783 Test Loss: 0.818 Test Acc: 0.783
Validation loss decreased (-0.763148 --> -0.782887).  Saving model ...
Epoch: 8 cost time: 2.4361932277679443
Epoch: 8, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802624).  Saving model ...
Epoch: 9 cost time: 2.38539719581604
Epoch: 9, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
Validation loss decreased (-0.802624 --> -0.815783).  Saving model ...
Epoch: 10 cost time: 2.1594510078430176
Epoch: 10, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.546 Vali Acc: 0.822 Test Loss: 0.546 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 2.2888572216033936
Epoch: 11, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.329803466796875
Epoch: 12, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.454 Vali Acc: 0.836 Test Loss: 0.454 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835522).  Saving model ...
Epoch: 13 cost time: 2.274216413497925
Epoch: 13, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.441 Vali Acc: 0.816 Test Loss: 0.441 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.357811689376831
Epoch: 14, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.429 Vali Acc: 0.816 Test Loss: 0.429 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.288285493850708
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.418 Vali Acc: 0.829 Test Loss: 0.418 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.377542734146118
Epoch: 16, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.429 Vali Acc: 0.809 Test Loss: 0.429 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3328475952148438
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.450 Vali Acc: 0.829 Test Loss: 0.450 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.414626121520996
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9609830379486084
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3615875244140625
Epoch: 20, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.264427423477173
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3786096572875977
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.538 Vali Acc: 0.849 Test Loss: 0.538 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848679).  Saving model ...
Epoch: 23 cost time: 2.3306148052215576
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2435755729675293
Epoch: 24, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.608 Vali Acc: 0.836 Test Loss: 0.608 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.175015926361084
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.481 Vali Acc: 0.822 Test Loss: 0.481 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1347200870513916
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855258).  Saving model ...
Epoch: 27 cost time: 2.2356669902801514
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.482 Vali Acc: 0.842 Test Loss: 0.482 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2067062854766846
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.227169990539551
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.515 Vali Acc: 0.836 Test Loss: 0.515 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2537448406219482
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.541 Vali Acc: 0.829 Test Loss: 0.541 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 1037956
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.625957012176514
Epoch: 1, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.339 Vali Acc: 0.283 Test Loss: 1.339 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.506214141845703
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.290 Vali Acc: 0.388 Test Loss: 1.290 Test Acc: 0.388
Validation loss decreased (-0.282881 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 2.325551986694336
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.224 Vali Acc: 0.513 Test Loss: 1.224 Test Acc: 0.513
Validation loss decreased (-0.388145 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 2.6412465572357178
Epoch: 4, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.147 Vali Acc: 0.605 Test Loss: 1.147 Test Acc: 0.605
Validation loss decreased (-0.513146 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 2.5855765342712402
Epoch: 5, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.062 Vali Acc: 0.671 Test Loss: 1.062 Test Acc: 0.671
Validation loss decreased (-0.605252 --> -0.671042).  Saving model ...
Epoch: 6 cost time: 2.606346845626831
Epoch: 6, Steps: 10 | Train Loss: 0.937 Vali Loss: 0.961 Vali Acc: 0.717 Test Loss: 0.961 Test Acc: 0.717
Validation loss decreased (-0.671042 --> -0.717096).  Saving model ...
Epoch: 7 cost time: 2.331843137741089
Epoch: 7, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.855 Vali Acc: 0.763 Test Loss: 0.855 Test Acc: 0.763
Validation loss decreased (-0.717096 --> -0.763149).  Saving model ...
Epoch: 8 cost time: 2.6289451122283936
Epoch: 8, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
Validation loss decreased (-0.763149 --> -0.789466).  Saving model ...
Epoch: 9 cost time: 2.624251365661621
Epoch: 9, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
Validation loss decreased (-0.789466 --> -0.822362).  Saving model ...
Epoch: 10 cost time: 2.546013832092285
Epoch: 10, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 2.60846209526062
Epoch: 11, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.470 Vali Acc: 0.849 Test Loss: 0.470 Test Acc: 0.849
Validation loss decreased (-0.822363 --> -0.848680).  Saving model ...
Epoch: 12 cost time: 2.585380792617798
Epoch: 12, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.448 Vali Acc: 0.829 Test Loss: 0.448 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5804057121276855
Epoch: 13, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.418 Vali Acc: 0.829 Test Loss: 0.418 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.627373695373535
Epoch: 14, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6493418216705322
Epoch: 15, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.397 Vali Acc: 0.842 Test Loss: 0.397 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.814136028289795
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.396 Vali Acc: 0.842 Test Loss: 0.396 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.622750759124756
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 18 cost time: 2.4826061725616455
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.365 Vali Acc: 0.868 Test Loss: 0.365 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 19 cost time: 2.341409206390381
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 2.2792184352874756
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.406 Vali Acc: 0.868 Test Loss: 0.406 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6044809818267822
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.408 Vali Acc: 0.868 Test Loss: 0.408 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.58921480178833
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.476 Vali Acc: 0.836 Test Loss: 0.476 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.551962375640869
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5483274459838867
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.525 Vali Acc: 0.849 Test Loss: 0.525 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.564882516860962
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.561908721923828
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.502 Vali Acc: 0.842 Test Loss: 0.502 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.464755058288574
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.6812856197357178
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.511 Vali Acc: 0.855 Test Loss: 0.511 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4909396171569824
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.591 Vali Acc: 0.842 Test Loss: 0.591 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 3520708
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.797241687774658
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.461 Vali Acc: 0.250 Test Loss: 1.461 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.8776404857635498
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.383 Vali Acc: 0.289 Test Loss: 1.383 Test Acc: 0.289
Validation loss decreased (-0.249985 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 2.0090343952178955
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.291 Vali Acc: 0.388 Test Loss: 1.291 Test Acc: 0.388
Validation loss decreased (-0.289460 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.8548212051391602
Epoch: 4, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.198 Vali Acc: 0.513 Test Loss: 1.198 Test Acc: 0.513
Validation loss decreased (-0.388145 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.9198882579803467
Epoch: 5, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.513146 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.951770544052124
Epoch: 6, Steps: 10 | Train Loss: 0.931 Vali Loss: 0.990 Vali Acc: 0.730 Test Loss: 0.990 Test Acc: 0.730
Validation loss decreased (-0.624989 --> -0.730253).  Saving model ...
Epoch: 7 cost time: 1.887183427810669
Epoch: 7, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.876 Vali Acc: 0.770 Test Loss: 0.876 Test Acc: 0.770
Validation loss decreased (-0.730253 --> -0.769728).  Saving model ...
Epoch: 8 cost time: 1.8854107856750488
Epoch: 8, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.767 Vali Acc: 0.796 Test Loss: 0.767 Test Acc: 0.796
Validation loss decreased (-0.769728 --> -0.796045).  Saving model ...
Epoch: 9 cost time: 1.9809985160827637
Epoch: 9, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.669 Vali Acc: 0.816 Test Loss: 0.669 Test Acc: 0.816
Validation loss decreased (-0.796045 --> -0.815783).  Saving model ...
Epoch: 10 cost time: 1.898411512374878
Epoch: 10, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 1.7909479141235352
Epoch: 11, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9416944980621338
Epoch: 12, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.478 Vali Acc: 0.842 Test Loss: 0.478 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842100).  Saving model ...
Epoch: 13 cost time: 1.9454536437988281
Epoch: 13, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.449 Vali Acc: 0.829 Test Loss: 0.449 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9165806770324707
Epoch: 14, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.436 Vali Acc: 0.842 Test Loss: 0.436 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 1.9259042739868164
Epoch: 15, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.427 Vali Acc: 0.822 Test Loss: 0.427 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8319892883300781
Epoch: 16, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.397 Vali Acc: 0.816 Test Loss: 0.397 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7981810569763184
Epoch: 17, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.378 Vali Acc: 0.842 Test Loss: 0.378 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 18 cost time: 1.8369195461273193
Epoch: 18, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.366 Vali Acc: 0.849 Test Loss: 0.366 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848681).  Saving model ...
Epoch: 19 cost time: 1.7752044200897217
Epoch: 19, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.367 Vali Acc: 0.849 Test Loss: 0.367 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8403103351593018
Epoch: 20, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.366 Vali Acc: 0.862 Test Loss: 0.366 Test Acc: 0.862
Validation loss decreased (-0.848681 --> -0.861838).  Saving model ...
Epoch: 21 cost time: 1.7803668975830078
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.356 Vali Acc: 0.855 Test Loss: 0.356 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7328109741210938
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.365 Vali Acc: 0.849 Test Loss: 0.365 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.906226634979248
Epoch: 23, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.808121919631958
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.373 Vali Acc: 0.849 Test Loss: 0.373 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8100731372833252
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.369 Vali Acc: 0.855 Test Loss: 0.369 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7416009902954102
Epoch: 26, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.369 Vali Acc: 0.849 Test Loss: 0.369 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5757663249969482
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.797276496887207
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.81923246383667
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.433 Vali Acc: 0.849 Test Loss: 0.433 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8327972888946533
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 1037956
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.34128212928772
Epoch: 1, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.340 Vali Acc: 0.276 Test Loss: 1.340 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.043156385421753
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.297 Vali Acc: 0.382 Test Loss: 1.297 Test Acc: 0.382
Validation loss decreased (-0.276302 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 2.165652275085449
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.381566 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.243581771850586
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.175 Vali Acc: 0.592 Test Loss: 1.175 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 2.1796987056732178
Epoch: 5, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.105 Vali Acc: 0.638 Test Loss: 1.105 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638147).  Saving model ...
Epoch: 6 cost time: 2.25697922706604
Epoch: 6, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.023 Vali Acc: 0.658 Test Loss: 1.023 Test Acc: 0.658
Validation loss decreased (-0.638147 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 2.151986598968506
Epoch: 7, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.936 Vali Acc: 0.704 Test Loss: 0.936 Test Acc: 0.704
Validation loss decreased (-0.657885 --> -0.703938).  Saving model ...
Epoch: 8 cost time: 2.1872897148132324
Epoch: 8, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.837 Vali Acc: 0.743 Test Loss: 0.837 Test Acc: 0.743
Validation loss decreased (-0.703938 --> -0.743413).  Saving model ...
Epoch: 9 cost time: 2.1430087089538574
Epoch: 9, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.738 Vali Acc: 0.776 Test Loss: 0.738 Test Acc: 0.776
Validation loss decreased (-0.743413 --> -0.776308).  Saving model ...
Epoch: 10 cost time: 2.04575252532959
Epoch: 10, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
Validation loss decreased (-0.776308 --> -0.802625).  Saving model ...
Epoch: 11 cost time: 1.9691693782806396
Epoch: 11, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 2.1089420318603516
Epoch: 12, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 13 cost time: 2.147073984146118
Epoch: 13, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 14 cost time: 2.1343185901641846
Epoch: 14, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.458 Vali Acc: 0.842 Test Loss: 0.458 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 2.28318190574646
Epoch: 15, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.415 Vali Acc: 0.829 Test Loss: 0.415 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.983374834060669
Epoch: 16, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.400 Vali Acc: 0.836 Test Loss: 0.400 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0187764167785645
Epoch: 17, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.376 Vali Acc: 0.829 Test Loss: 0.376 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.016845464706421
Epoch: 18, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.356 Vali Acc: 0.836 Test Loss: 0.356 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.085066080093384
Epoch: 19, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.348 Vali Acc: 0.842 Test Loss: 0.348 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842102).  Saving model ...
Epoch: 20 cost time: 2.033963203430176
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.347 Vali Acc: 0.849 Test Loss: 0.347 Test Acc: 0.849
Validation loss decreased (-0.842102 --> -0.848681).  Saving model ...
Epoch: 21 cost time: 2.148402452468872
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.346 Vali Acc: 0.849 Test Loss: 0.346 Test Acc: 0.849
Validation loss decreased (-0.848681 --> -0.848681).  Saving model ...
Epoch: 22 cost time: 2.253387212753296
Epoch: 22, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.348 Vali Acc: 0.855 Test Loss: 0.348 Test Acc: 0.855
Validation loss decreased (-0.848681 --> -0.855260).  Saving model ...
Epoch: 23 cost time: 2.0011816024780273
Epoch: 23, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.343 Vali Acc: 0.836 Test Loss: 0.343 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0009844303131104
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.351 Vali Acc: 0.855 Test Loss: 0.351 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.101274013519287
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.352 Vali Acc: 0.836 Test Loss: 0.352 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8421909809112549
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1569323539733887
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0404977798461914
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.365 Vali Acc: 0.849 Test Loss: 0.365 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.2397780418395996
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.368 Vali Acc: 0.849 Test Loss: 0.368 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.284911632537842
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.369 Vali Acc: 0.842 Test Loss: 0.369 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 3520708
model size : 14.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.098510265350342
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.464 Vali Acc: 0.250 Test Loss: 1.464 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.6735484600067139
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.393 Vali Acc: 0.303 Test Loss: 1.393 Test Acc: 0.303
Validation loss decreased (-0.249985 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.6212646961212158
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.310 Vali Acc: 0.395 Test Loss: 1.310 Test Acc: 0.395
Validation loss decreased (-0.302618 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.5723986625671387
Epoch: 4, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.228 Vali Acc: 0.474 Test Loss: 1.228 Test Acc: 0.474
Validation loss decreased (-0.394724 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 1.6250405311584473
Epoch: 5, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.145 Vali Acc: 0.572 Test Loss: 1.145 Test Acc: 0.572
Validation loss decreased (-0.473672 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.6522347927093506
Epoch: 6, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.053 Vali Acc: 0.684 Test Loss: 1.053 Test Acc: 0.684
Validation loss decreased (-0.572357 --> -0.684200).  Saving model ...
Epoch: 7 cost time: 1.6882166862487793
Epoch: 7, Steps: 10 | Train Loss: 0.930 Vali Loss: 0.956 Vali Acc: 0.737 Test Loss: 0.956 Test Acc: 0.737
Validation loss decreased (-0.684200 --> -0.736833).  Saving model ...
Epoch: 8 cost time: 1.6531713008880615
Epoch: 8, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.6109576225280762
Epoch: 9, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.782887).  Saving model ...
Epoch: 10 cost time: 1.544240951538086
Epoch: 10, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7362325191497803
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.3964691162109375
Epoch: 12, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
Validation loss decreased (-0.789467 --> -0.828942).  Saving model ...
Epoch: 13 cost time: 1.4245572090148926
Epoch: 13, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3573341369628906
Epoch: 14, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.471 Vali Acc: 0.829 Test Loss: 0.471 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 15 cost time: 1.65315580368042
Epoch: 15, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.445 Vali Acc: 0.836 Test Loss: 0.445 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 16 cost time: 1.7186436653137207
Epoch: 16, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.428 Vali Acc: 0.829 Test Loss: 0.428 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7387809753417969
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.409 Vali Acc: 0.829 Test Loss: 0.409 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5365066528320312
Epoch: 18, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.392 Vali Acc: 0.842 Test Loss: 0.392 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 19 cost time: 1.6877307891845703
Epoch: 19, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.393 Vali Acc: 0.822 Test Loss: 0.393 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.74532151222229
Epoch: 20, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7244536876678467
Epoch: 21, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.358 Vali Acc: 0.855 Test Loss: 0.358 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855260).  Saving model ...
Epoch: 22 cost time: 1.6903119087219238
Epoch: 22, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.350 Vali Acc: 0.855 Test Loss: 0.350 Test Acc: 0.855
Validation loss decreased (-0.855260 --> -0.855260).  Saving model ...
Epoch: 23 cost time: 1.7405097484588623
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.385 Vali Acc: 0.836 Test Loss: 0.385 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7241134643554688
Epoch: 24, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.346 Vali Acc: 0.868 Test Loss: 0.346 Test Acc: 0.868
Validation loss decreased (-0.855260 --> -0.868418).  Saving model ...
Epoch: 25 cost time: 1.6817617416381836
Epoch: 25, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.345 Vali Acc: 0.842 Test Loss: 0.345 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.658376932144165
Epoch: 26, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.337 Vali Acc: 0.868 Test Loss: 0.337 Test Acc: 0.868
Validation loss decreased (-0.868418 --> -0.868418).  Saving model ...
Epoch: 27 cost time: 1.7023403644561768
Epoch: 27, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
Validation loss decreased (-0.868418 --> -0.874997).  Saving model ...
Epoch: 28 cost time: 1.7287981510162354
Epoch: 28, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.326 Vali Acc: 0.888 Test Loss: 0.326 Test Acc: 0.888
Validation loss decreased (-0.874997 --> -0.888155).  Saving model ...
Epoch: 29 cost time: 1.5597724914550781
Epoch: 29, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8535382747650146
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.329 Vali Acc: 0.862 Test Loss: 0.329 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 1037956
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.959206581115723
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.401 Vali Acc: 0.296 Test Loss: 1.401 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 5.840541839599609
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.337 Vali Acc: 0.368 Test Loss: 1.337 Test Acc: 0.368
Validation loss decreased (-0.296039 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 6.1471991539001465
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.264 Vali Acc: 0.480 Test Loss: 1.264 Test Acc: 0.480
Validation loss decreased (-0.368408 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 5.8418145179748535
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.188 Vali Acc: 0.546 Test Loss: 1.188 Test Acc: 0.546
Validation loss decreased (-0.480251 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 6.190751791000366
Epoch: 5, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.106 Vali Acc: 0.612 Test Loss: 1.106 Test Acc: 0.612
Validation loss decreased (-0.546041 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 5.7973198890686035
Epoch: 6, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.008 Vali Acc: 0.678 Test Loss: 1.008 Test Acc: 0.678
Validation loss decreased (-0.611831 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 6.17359733581543
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.894 Vali Acc: 0.711 Test Loss: 0.894 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710517).  Saving model ...
Epoch: 8 cost time: 5.506435871124268
Epoch: 8, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.783 Vali Acc: 0.770 Test Loss: 0.783 Test Acc: 0.770
Validation loss decreased (-0.710517 --> -0.769729).  Saving model ...
Epoch: 9 cost time: 5.787861585617065
Epoch: 9, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.769729 --> -0.822362).  Saving model ...
Epoch: 10 cost time: 5.3015360832214355
Epoch: 10, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.861289024353027
Epoch: 11, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.483 Vali Acc: 0.849 Test Loss: 0.483 Test Acc: 0.849
Validation loss decreased (-0.822362 --> -0.848679).  Saving model ...
Epoch: 12 cost time: 4.908613681793213
Epoch: 12, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.443 Vali Acc: 0.829 Test Loss: 0.443 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.840362787246704
Epoch: 13, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855259).  Saving model ...
Epoch: 14 cost time: 5.318354845046997
Epoch: 14, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.984462261199951
Epoch: 15, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.421 Vali Acc: 0.829 Test Loss: 0.421 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.564850568771362
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 17 cost time: 6.104661464691162
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.556737184524536
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.459 Vali Acc: 0.829 Test Loss: 0.459 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.052880048751831
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.453 Vali Acc: 0.849 Test Loss: 0.453 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.762176036834717
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.977778911590576
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.808115005493164
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.516 Vali Acc: 0.842 Test Loss: 0.516 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.94534707069397
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.71785306930542
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.535 Vali Acc: 0.836 Test Loss: 0.535 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.948318958282471
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.487 Vali Acc: 0.849 Test Loss: 0.487 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.431280612945557
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.556 Vali Acc: 0.836 Test Loss: 0.556 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 1762948
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.013672828674316
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.423 Vali Acc: 0.296 Test Loss: 1.423 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 2.8928210735321045
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.374 Vali Acc: 0.303 Test Loss: 1.374 Test Acc: 0.303
Validation loss decreased (-0.296038 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 3.3278093338012695
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.311 Vali Acc: 0.368 Test Loss: 1.311 Test Acc: 0.368
Validation loss decreased (-0.302618 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 3.3270888328552246
Epoch: 4, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.239 Vali Acc: 0.461 Test Loss: 1.239 Test Acc: 0.461
Validation loss decreased (-0.368408 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 3.0465445518493652
Epoch: 5, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.152 Vali Acc: 0.566 Test Loss: 1.152 Test Acc: 0.566
Validation loss decreased (-0.460514 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 3.3303298950195312
Epoch: 6, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.054 Vali Acc: 0.632 Test Loss: 1.054 Test Acc: 0.632
Validation loss decreased (-0.565778 --> -0.631568).  Saving model ...
Epoch: 7 cost time: 3.260748863220215
Epoch: 7, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.945 Vali Acc: 0.684 Test Loss: 0.945 Test Acc: 0.684
Validation loss decreased (-0.631568 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 3.331467628479004
Epoch: 8, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.842 Vali Acc: 0.711 Test Loss: 0.842 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 3.5716753005981445
Epoch: 9, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 3.4117541313171387
Epoch: 10, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
Validation loss decreased (-0.710519 --> -0.782888).  Saving model ...
Epoch: 11 cost time: 3.3270084857940674
Epoch: 11, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7184062004089355
Epoch: 12, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2645580768585205
Epoch: 13, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.475 Vali Acc: 0.796 Test Loss: 0.475 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 3.1885361671447754
Epoch: 14, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.443 Vali Acc: 0.829 Test Loss: 0.443 Test Acc: 0.829
Validation loss decreased (-0.796048 --> -0.828943).  Saving model ...
Epoch: 15 cost time: 2.3066556453704834
Epoch: 15, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.437 Vali Acc: 0.822 Test Loss: 0.437 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7651116847991943
Epoch: 16, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.424 Vali Acc: 0.816 Test Loss: 0.424 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.68226957321167
Epoch: 17, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.407 Vali Acc: 0.829 Test Loss: 0.407 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 18 cost time: 3.8144371509552
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.404 Vali Acc: 0.836 Test Loss: 0.404 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 19 cost time: 3.6722593307495117
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
Validation loss decreased (-0.835522 --> -0.855259).  Saving model ...
Epoch: 20 cost time: 3.5780982971191406
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.406 Vali Acc: 0.836 Test Loss: 0.406 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6031806468963623
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.411 Vali Acc: 0.822 Test Loss: 0.411 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5514190196990967
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4593842029571533
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.446 Vali Acc: 0.842 Test Loss: 0.446 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1899218559265137
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.463 Vali Acc: 0.849 Test Loss: 0.463 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.577925205230713
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.467 Vali Acc: 0.849 Test Loss: 0.467 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.344088315963745
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.498 Vali Acc: 0.842 Test Loss: 0.498 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.402214527130127
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.521 Vali Acc: 0.836 Test Loss: 0.521 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.294962167739868
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.563 Vali Acc: 0.842 Test Loss: 0.563 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.535935640335083
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.561 Vali Acc: 0.829 Test Loss: 0.561 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 521476
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.896634578704834
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.400 Vali Acc: 0.289 Test Loss: 1.400 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 4.666124582290649
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.341 Vali Acc: 0.355 Test Loss: 1.341 Test Acc: 0.355
Validation loss decreased (-0.289460 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 4.405813217163086
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.274 Vali Acc: 0.474 Test Loss: 1.274 Test Acc: 0.474
Validation loss decreased (-0.355250 --> -0.473671).  Saving model ...
Epoch: 4 cost time: 4.7024805545806885
Epoch: 4, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.204 Vali Acc: 0.539 Test Loss: 1.204 Test Acc: 0.539
Validation loss decreased (-0.473671 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 4.756243944168091
Epoch: 5, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.133 Vali Acc: 0.612 Test Loss: 1.133 Test Acc: 0.612
Validation loss decreased (-0.539462 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 4.580530643463135
Epoch: 6, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.049 Vali Acc: 0.645 Test Loss: 1.049 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 4.779514789581299
Epoch: 7, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.955 Vali Acc: 0.658 Test Loss: 0.955 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657885).  Saving model ...
Epoch: 8 cost time: 4.805668592453003
Epoch: 8, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.862 Vali Acc: 0.730 Test Loss: 0.862 Test Acc: 0.730
Validation loss decreased (-0.657885 --> -0.730255).  Saving model ...
Epoch: 9 cost time: 4.523048639297485
Epoch: 9, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.761 Vali Acc: 0.730 Test Loss: 0.761 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 4.462387323379517
Epoch: 10, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
Validation loss decreased (-0.730256 --> -0.789467).  Saving model ...
Epoch: 11 cost time: 4.82401704788208
Epoch: 11, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 4.398933410644531
Epoch: 12, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.511 Vali Acc: 0.842 Test Loss: 0.511 Test Acc: 0.842
Validation loss decreased (-0.789468 --> -0.842100).  Saving model ...
Epoch: 13 cost time: 4.038038015365601
Epoch: 13, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.504682540893555
Epoch: 14, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.515754461288452
Epoch: 15, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.419 Vali Acc: 0.849 Test Loss: 0.419 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 16 cost time: 4.102664470672607
Epoch: 16, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.424 Vali Acc: 0.836 Test Loss: 0.424 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.4234442710876465
Epoch: 17, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.418 Vali Acc: 0.849 Test Loss: 0.418 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 18 cost time: 4.256594896316528
Epoch: 18, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.422 Vali Acc: 0.829 Test Loss: 0.422 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.099432706832886
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.436 Vali Acc: 0.816 Test Loss: 0.436 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.315840244293213
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.438 Vali Acc: 0.829 Test Loss: 0.438 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.613081216812134
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.492 Vali Acc: 0.829 Test Loss: 0.492 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.3909690380096436
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.536 Vali Acc: 0.829 Test Loss: 0.536 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.567183017730713
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.540 Vali Acc: 0.829 Test Loss: 0.540 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.613156080245972
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.607 Vali Acc: 0.836 Test Loss: 0.607 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.28960108757019
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861837).  Saving model ...
Epoch: 26 cost time: 4.540053606033325
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.585657596588135
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.508 Vali Acc: 0.849 Test Loss: 0.508 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.371662378311157
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.483 Vali Acc: 0.849 Test Loss: 0.483 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.584721326828003
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.445 Vali Acc: 0.868 Test Loss: 0.445 Test Acc: 0.868
Validation loss decreased (-0.861837 --> -0.868417).  Saving model ...
Epoch: 30 cost time: 4.476474046707153
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.407 Vali Acc: 0.895 Test Loss: 0.407 Test Acc: 0.895
Validation loss decreased (-0.868417 --> -0.894733).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8947368421052632
model parameter : 1762948
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.530329704284668
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.424 Vali Acc: 0.283 Test Loss: 1.424 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 2.6337573528289795
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.379 Vali Acc: 0.309 Test Loss: 1.379 Test Acc: 0.309
Validation loss decreased (-0.282880 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 2.5678844451904297
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.321 Vali Acc: 0.368 Test Loss: 1.321 Test Acc: 0.368
Validation loss decreased (-0.309197 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.6546363830566406
Epoch: 4, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.255 Vali Acc: 0.447 Test Loss: 1.255 Test Acc: 0.447
Validation loss decreased (-0.368408 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 2.7319302558898926
Epoch: 5, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.173 Vali Acc: 0.533 Test Loss: 1.173 Test Acc: 0.533
Validation loss decreased (-0.447356 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 2.600506544113159
Epoch: 6, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.083 Vali Acc: 0.618 Test Loss: 1.083 Test Acc: 0.618
Validation loss decreased (-0.532883 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 2.594834327697754
Epoch: 7, Steps: 10 | Train Loss: 0.972 Vali Loss: 0.984 Vali Acc: 0.684 Test Loss: 0.984 Test Acc: 0.684
Validation loss decreased (-0.618410 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 2.639220714569092
Epoch: 8, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.886 Vali Acc: 0.704 Test Loss: 0.886 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 2.751796245574951
Epoch: 9, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.791 Vali Acc: 0.697 Test Loss: 0.791 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.800490379333496
Epoch: 10, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.699 Vali Acc: 0.763 Test Loss: 0.699 Test Acc: 0.763
Validation loss decreased (-0.703939 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 2.6535046100616455
Epoch: 11, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0147688388824463
Epoch: 12, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.573 Vali Acc: 0.730 Test Loss: 0.573 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0624234676361084
Epoch: 13, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.763151 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 2.8994851112365723
Epoch: 14, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 2.9022185802459717
Epoch: 15, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.466 Vali Acc: 0.796 Test Loss: 0.466 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 2.755100965499878
Epoch: 16, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.440 Vali Acc: 0.816 Test Loss: 0.440 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815785).  Saving model ...
Epoch: 17 cost time: 2.233095169067383
Epoch: 17, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 18 cost time: 2.2333390712738037
Epoch: 18, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.410 Vali Acc: 0.809 Test Loss: 0.410 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6757261753082275
Epoch: 19, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.407 Vali Acc: 0.809 Test Loss: 0.407 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8288207054138184
Epoch: 20, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.406 Vali Acc: 0.816 Test Loss: 0.406 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.76827335357666
Epoch: 21, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.408 Vali Acc: 0.816 Test Loss: 0.408 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.754544258117676
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9948835372924805
Epoch: 23, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.446 Vali Acc: 0.836 Test Loss: 0.446 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 24 cost time: 2.7497613430023193
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.454 Vali Acc: 0.809 Test Loss: 0.454 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7254996299743652
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.49495530128479
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1645374298095703
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9229350090026855
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.507 Vali Acc: 0.822 Test Loss: 0.507 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.963705062866211
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4794070720672607
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 521476
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.353635311126709
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.401 Vali Acc: 0.296 Test Loss: 1.401 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 2.8738317489624023
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.348 Vali Acc: 0.342 Test Loss: 1.348 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 2.622437000274658
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.286 Vali Acc: 0.461 Test Loss: 1.286 Test Acc: 0.461
Validation loss decreased (-0.342092 --> -0.460513).  Saving model ...
Epoch: 4 cost time: 2.8871307373046875
Epoch: 4, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.222 Vali Acc: 0.513 Test Loss: 1.222 Test Acc: 0.513
Validation loss decreased (-0.460513 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 2.541652202606201
Epoch: 5, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.158 Vali Acc: 0.586 Test Loss: 1.158 Test Acc: 0.586
Validation loss decreased (-0.513146 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 2.8496062755584717
Epoch: 6, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.084 Vali Acc: 0.618 Test Loss: 1.084 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 2.796326160430908
Epoch: 7, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.001 Vali Acc: 0.658 Test Loss: 1.001 Test Acc: 0.658
Validation loss decreased (-0.618410 --> -0.657885).  Saving model ...
Epoch: 8 cost time: 2.993091583251953
Epoch: 8, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.918 Vali Acc: 0.678 Test Loss: 0.918 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 2.8478617668151855
Epoch: 9, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.826 Vali Acc: 0.697 Test Loss: 0.826 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 3.019371509552002
Epoch: 10, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
Validation loss decreased (-0.697360 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 2.8207879066467285
Epoch: 11, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.649 Vali Acc: 0.770 Test Loss: 0.649 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 3.1334288120269775
Epoch: 12, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
Validation loss decreased (-0.769730 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 2.7269949913024902
Epoch: 13, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 3.020453453063965
Epoch: 14, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.480 Vali Acc: 0.849 Test Loss: 0.480 Test Acc: 0.849
Validation loss decreased (-0.815784 --> -0.848679).  Saving model ...
Epoch: 15 cost time: 2.4480204582214355
Epoch: 15, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.444 Vali Acc: 0.849 Test Loss: 0.444 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 16 cost time: 2.514045238494873
Epoch: 16, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.417 Vali Acc: 0.849 Test Loss: 0.417 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 17 cost time: 2.177593231201172
Epoch: 17, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.390 Vali Acc: 0.868 Test Loss: 0.390 Test Acc: 0.868
Validation loss decreased (-0.848680 --> -0.868417).  Saving model ...
Epoch: 18 cost time: 2.606451988220215
Epoch: 18, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.371 Vali Acc: 0.862 Test Loss: 0.371 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2089779376983643
Epoch: 19, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.361 Vali Acc: 0.862 Test Loss: 0.361 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4560859203338623
Epoch: 20, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.354 Vali Acc: 0.868 Test Loss: 0.354 Test Acc: 0.868
Validation loss decreased (-0.868417 --> -0.868418).  Saving model ...
Epoch: 21 cost time: 1.922719955444336
Epoch: 21, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.445084571838379
Epoch: 22, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.339 Vali Acc: 0.868 Test Loss: 0.339 Test Acc: 0.868
Validation loss decreased (-0.868418 --> -0.868418).  Saving model ...
Epoch: 23 cost time: 1.9841194152832031
Epoch: 23, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.334 Vali Acc: 0.862 Test Loss: 0.334 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4263832569122314
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.329 Vali Acc: 0.862 Test Loss: 0.329 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3697996139526367
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.334 Vali Acc: 0.862 Test Loss: 0.334 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5033836364746094
Epoch: 26, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.321 Vali Acc: 0.868 Test Loss: 0.321 Test Acc: 0.868
Validation loss decreased (-0.868418 --> -0.868418).  Saving model ...
Epoch: 27 cost time: 2.747520685195923
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.339 Vali Acc: 0.882 Test Loss: 0.339 Test Acc: 0.882
Validation loss decreased (-0.868418 --> -0.881576).  Saving model ...
Epoch: 28 cost time: 2.545138359069824
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.334 Vali Acc: 0.868 Test Loss: 0.334 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.896063804626465
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.352 Vali Acc: 0.882 Test Loss: 0.352 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5890231132507324
Epoch: 30, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 1762948
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.294969320297241
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.424 Vali Acc: 0.270 Test Loss: 1.424 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.5881948471069336
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.385 Vali Acc: 0.309 Test Loss: 1.385 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.5104031562805176
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.334 Vali Acc: 0.368 Test Loss: 1.334 Test Acc: 0.368
Validation loss decreased (-0.309197 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.8682122230529785
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.276 Vali Acc: 0.441 Test Loss: 1.276 Test Acc: 0.441
Validation loss decreased (-0.368408 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 2.104625701904297
Epoch: 5, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.205 Vali Acc: 0.553 Test Loss: 1.205 Test Acc: 0.553
Validation loss decreased (-0.440777 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 2.0533604621887207
Epoch: 6, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.127 Vali Acc: 0.618 Test Loss: 1.127 Test Acc: 0.618
Validation loss decreased (-0.552620 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 2.1569621562957764
Epoch: 7, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.039 Vali Acc: 0.678 Test Loss: 1.039 Test Acc: 0.678
Validation loss decreased (-0.618410 --> -0.677621).  Saving model ...
Epoch: 8 cost time: 2.0764458179473877
Epoch: 8, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.952 Vali Acc: 0.678 Test Loss: 0.952 Test Acc: 0.678
Validation loss decreased (-0.677621 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 1.8152241706848145
Epoch: 9, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.862 Vali Acc: 0.704 Test Loss: 0.862 Test Acc: 0.704
Validation loss decreased (-0.677622 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 2.0176336765289307
Epoch: 10, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.775 Vali Acc: 0.757 Test Loss: 0.775 Test Acc: 0.757
Validation loss decreased (-0.703939 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 1.950834035873413
Epoch: 11, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.698 Vali Acc: 0.757 Test Loss: 0.698 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 2.072035074234009
Epoch: 12, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.629 Vali Acc: 0.763 Test Loss: 0.629 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 2.048086643218994
Epoch: 13, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.9936881065368652
Epoch: 14, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.517 Vali Acc: 0.836 Test Loss: 0.517 Test Acc: 0.836
Validation loss decreased (-0.789468 --> -0.835521).  Saving model ...
Epoch: 15 cost time: 1.9919254779815674
Epoch: 15, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7973880767822266
Epoch: 16, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.442 Vali Acc: 0.822 Test Loss: 0.442 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9449713230133057
Epoch: 17, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.413 Vali Acc: 0.836 Test Loss: 0.413 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 18 cost time: 1.7712597846984863
Epoch: 18, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.392 Vali Acc: 0.849 Test Loss: 0.392 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
Epoch: 19 cost time: 1.930192470550537
Epoch: 19, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.378 Vali Acc: 0.862 Test Loss: 0.378 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 20 cost time: 1.8917169570922852
Epoch: 20, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8333637714385986
Epoch: 21, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.364 Vali Acc: 0.862 Test Loss: 0.364 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 22 cost time: 1.7817893028259277
Epoch: 22, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.372 Vali Acc: 0.829 Test Loss: 0.372 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9420652389526367
Epoch: 23, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861839).  Saving model ...
Epoch: 24 cost time: 2.0085532665252686
Epoch: 24, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.357 Vali Acc: 0.849 Test Loss: 0.357 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9203622341156006
Epoch: 25, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.354 Vali Acc: 0.862 Test Loss: 0.354 Test Acc: 0.862
Validation loss decreased (-0.861839 --> -0.861839).  Saving model ...
Epoch: 26 cost time: 1.99570894241333
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
Validation loss decreased (-0.861839 --> -0.861839).  Saving model ...
Epoch: 27 cost time: 1.9715642929077148
Epoch: 27, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8835201263427734
Epoch: 28, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.348 Vali Acc: 0.855 Test Loss: 0.348 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7168982028961182
Epoch: 29, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.356 Vali Acc: 0.849 Test Loss: 0.356 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.815868616104126
Epoch: 30, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.357 Vali Acc: 0.849 Test Loss: 0.357 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 521476
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.650995254516602
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.427 Vali Acc: 0.270 Test Loss: 1.427 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 2.3844969272613525
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.389 Vali Acc: 0.296 Test Loss: 1.389 Test Acc: 0.296
Validation loss decreased (-0.269723 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 2.406120777130127
Epoch: 3, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.337 Vali Acc: 0.355 Test Loss: 1.337 Test Acc: 0.355
Validation loss decreased (-0.296039 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 2.489896059036255
Epoch: 4, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.282 Vali Acc: 0.408 Test Loss: 1.282 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 2.683866024017334
Epoch: 5, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
Validation loss decreased (-0.407882 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 2.503300905227661
Epoch: 6, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.148 Vali Acc: 0.579 Test Loss: 1.148 Test Acc: 0.579
Validation loss decreased (-0.467093 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 2.5197396278381348
Epoch: 7, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.068 Vali Acc: 0.618 Test Loss: 1.068 Test Acc: 0.618
Validation loss decreased (-0.578936 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 2.50120210647583
Epoch: 8, Steps: 10 | Train Loss: 0.924 Vali Loss: 0.979 Vali Acc: 0.671 Test Loss: 0.979 Test Acc: 0.671
Validation loss decreased (-0.618410 --> -0.671043).  Saving model ...
Epoch: 9 cost time: 2.558333158493042
Epoch: 9, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.888 Vali Acc: 0.724 Test Loss: 0.888 Test Acc: 0.724
Validation loss decreased (-0.671043 --> -0.723675).  Saving model ...
Epoch: 10 cost time: 2.507951259613037
Epoch: 10, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
Validation loss decreased (-0.723675 --> -0.789466).  Saving model ...
Epoch: 11 cost time: 2.645872116088867
Epoch: 11, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
Validation loss decreased (-0.789466 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 2.4533231258392334
Epoch: 12, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 13 cost time: 2.377391815185547
Epoch: 13, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 2.3281610012054443
Epoch: 14, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.555067300796509
Epoch: 15, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.559731960296631
Epoch: 16, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6613967418670654
Epoch: 17, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809206).  Saving model ...
Epoch: 18 cost time: 2.594343423843384
Epoch: 18, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.500453472137451
Epoch: 19, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5128085613250732
Epoch: 20, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.692683219909668
Epoch: 21, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.853612184524536
Epoch: 22, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 2.5038342475891113
Epoch: 23, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 24 cost time: 2.6124982833862305
Epoch: 24, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5263330936431885
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5707645416259766
Epoch: 26, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.570467233657837
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5417873859405518
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7682690620422363
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.577467441558838
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1760932
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7294576168060303
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.424 Vali Acc: 0.263 Test Loss: 1.424 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.8952507972717285
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.383 Vali Acc: 0.322 Test Loss: 1.383 Test Acc: 0.322
Validation loss decreased (-0.263144 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.6500837802886963
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.328 Vali Acc: 0.382 Test Loss: 1.328 Test Acc: 0.382
Validation loss decreased (-0.322355 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.6215128898620605
Epoch: 4, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
Validation loss decreased (-0.381566 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 1.8496222496032715
Epoch: 5, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.197 Vali Acc: 0.553 Test Loss: 1.197 Test Acc: 0.553
Validation loss decreased (-0.467093 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 1.776601791381836
Epoch: 6, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.552620 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.9029455184936523
Epoch: 7, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.044 Vali Acc: 0.671 Test Loss: 1.044 Test Acc: 0.671
Validation loss decreased (-0.624989 --> -0.671042).  Saving model ...
Epoch: 8 cost time: 1.8456223011016846
Epoch: 8, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.958 Vali Acc: 0.711 Test Loss: 0.958 Test Acc: 0.711
Validation loss decreased (-0.671042 --> -0.710517).  Saving model ...
Epoch: 9 cost time: 1.915907382965088
Epoch: 9, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.875 Vali Acc: 0.763 Test Loss: 0.875 Test Acc: 0.763
Validation loss decreased (-0.710517 --> -0.763149).  Saving model ...
Epoch: 10 cost time: 2.0208661556243896
Epoch: 10, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.894599199295044
Epoch: 11, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.733 Vali Acc: 0.763 Test Loss: 0.733 Test Acc: 0.763
Validation loss decreased (-0.763149 --> -0.763151).  Saving model ...
Epoch: 12 cost time: 1.9765069484710693
Epoch: 12, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.676 Vali Acc: 0.763 Test Loss: 0.676 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 13 cost time: 2.036759853363037
Epoch: 13, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.623 Vali Acc: 0.776 Test Loss: 0.623 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 2.0286641120910645
Epoch: 14, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 2.0363194942474365
Epoch: 15, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.902155876159668
Epoch: 16, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7791197299957275
Epoch: 17, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 2.101027011871338
Epoch: 18, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
Validation loss decreased (-0.782890 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 2.031919479370117
Epoch: 19, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.456 Vali Acc: 0.822 Test Loss: 0.456 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 20 cost time: 1.9605450630187988
Epoch: 20, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.446 Vali Acc: 0.816 Test Loss: 0.446 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9985580444335938
Epoch: 21, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.431 Vali Acc: 0.822 Test Loss: 0.431 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 22 cost time: 2.046088933944702
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.437 Vali Acc: 0.816 Test Loss: 0.437 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.037705659866333
Epoch: 23, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.429 Vali Acc: 0.816 Test Loss: 0.429 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7143964767456055
Epoch: 24, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.444 Vali Acc: 0.822 Test Loss: 0.444 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.170720338821411
Epoch: 25, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1719605922698975
Epoch: 26, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.198260545730591
Epoch: 27, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.436 Vali Acc: 0.816 Test Loss: 0.436 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.124033212661743
Epoch: 28, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9584646224975586
Epoch: 29, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9732997417449951
Epoch: 30, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 519364
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.030311107635498
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.428 Vali Acc: 0.250 Test Loss: 1.428 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.8745512962341309
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.396 Vali Acc: 0.296 Test Loss: 1.396 Test Acc: 0.296
Validation loss decreased (-0.249986 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.947343349456787
Epoch: 3, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.350 Vali Acc: 0.342 Test Loss: 1.350 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 2.138392686843872
Epoch: 4, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.301 Vali Acc: 0.388 Test Loss: 1.301 Test Acc: 0.388
Validation loss decreased (-0.342092 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 2.0864405632019043
Epoch: 5, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.247 Vali Acc: 0.428 Test Loss: 1.247 Test Acc: 0.428
Validation loss decreased (-0.388145 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 2.093470811843872
Epoch: 6, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.185 Vali Acc: 0.526 Test Loss: 1.185 Test Acc: 0.526
Validation loss decreased (-0.427619 --> -0.526304).  Saving model ...
Epoch: 7 cost time: 1.9298498630523682
Epoch: 7, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.526304 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 1.9948060512542725
Epoch: 8, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.041 Vali Acc: 0.625 Test Loss: 1.041 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.8848381042480469
Epoch: 9, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.964 Vali Acc: 0.711 Test Loss: 0.964 Test Acc: 0.711
Validation loss decreased (-0.624990 --> -0.710517).  Saving model ...
Epoch: 10 cost time: 2.2310030460357666
Epoch: 10, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.882 Vali Acc: 0.763 Test Loss: 0.882 Test Acc: 0.763
Validation loss decreased (-0.710517 --> -0.763149).  Saving model ...
Epoch: 11 cost time: 2.2853825092315674
Epoch: 11, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.808 Vali Acc: 0.770 Test Loss: 0.808 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769729).  Saving model ...
Epoch: 12 cost time: 2.214949607849121
Epoch: 12, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2191693782806396
Epoch: 13, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.664 Vali Acc: 0.776 Test Loss: 0.664 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776309).  Saving model ...
Epoch: 14 cost time: 2.0803773403167725
Epoch: 14, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.8288228511810303
Epoch: 15, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 2.4976346492767334
Epoch: 16, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 2.3963661193847656
Epoch: 17, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.516141414642334
Epoch: 18, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.475 Vali Acc: 0.816 Test Loss: 0.475 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 19 cost time: 2.2967426776885986
Epoch: 19, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 20 cost time: 2.246262550354004
Epoch: 20, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.442 Vali Acc: 0.829 Test Loss: 0.442 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 21 cost time: 2.3404412269592285
Epoch: 21, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.346508264541626
Epoch: 22, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.469 Vali Acc: 0.816 Test Loss: 0.469 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2056899070739746
Epoch: 23, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.459 Vali Acc: 0.816 Test Loss: 0.459 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.225620985031128
Epoch: 24, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.445 Vali Acc: 0.829 Test Loss: 0.445 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2729692459106445
Epoch: 25, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.477 Vali Acc: 0.809 Test Loss: 0.477 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.224834680557251
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2196590900421143
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 28 cost time: 2.2396676540374756
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.515 Vali Acc: 0.822 Test Loss: 0.515 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.289355993270874
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.202587604522705
Epoch: 30, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1760932
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9960646629333496
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.6575267314910889
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.390 Vali Acc: 0.329 Test Loss: 1.390 Test Acc: 0.329
Validation loss decreased (-0.243407 --> -0.328933).  Saving model ...
Epoch: 3 cost time: 1.8066201210021973
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.342 Vali Acc: 0.368 Test Loss: 1.342 Test Acc: 0.368
Validation loss decreased (-0.328933 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.6993954181671143
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.285 Vali Acc: 0.454 Test Loss: 1.285 Test Acc: 0.454
Validation loss decreased (-0.368408 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 1.6876096725463867
Epoch: 5, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.227 Vali Acc: 0.539 Test Loss: 1.227 Test Acc: 0.539
Validation loss decreased (-0.453935 --> -0.539461).  Saving model ...
Epoch: 6 cost time: 1.4886980056762695
Epoch: 6, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.163 Vali Acc: 0.592 Test Loss: 1.163 Test Acc: 0.592
Validation loss decreased (-0.539461 --> -0.592094).  Saving model ...
Epoch: 7 cost time: 1.79569673538208
Epoch: 7, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.094 Vali Acc: 0.632 Test Loss: 1.094 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631568).  Saving model ...
Epoch: 8 cost time: 1.743412971496582
Epoch: 8, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.018 Vali Acc: 0.697 Test Loss: 1.018 Test Acc: 0.697
Validation loss decreased (-0.631568 --> -0.697358).  Saving model ...
Epoch: 9 cost time: 1.7932183742523193
Epoch: 9, Steps: 10 | Train Loss: 0.876 Vali Loss: 0.944 Vali Acc: 0.724 Test Loss: 0.944 Test Acc: 0.724
Validation loss decreased (-0.697358 --> -0.723675).  Saving model ...
Epoch: 10 cost time: 1.6928789615631104
Epoch: 10, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
Validation loss decreased (-0.723675 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.9168944358825684
Epoch: 11, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 1.7452170848846436
Epoch: 12, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.733 Vali Acc: 0.770 Test Loss: 0.733 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769730).  Saving model ...
Epoch: 13 cost time: 1.4620592594146729
Epoch: 13, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 1.7922694683074951
Epoch: 14, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 15 cost time: 1.8825616836547852
Epoch: 15, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815784).  Saving model ...
Epoch: 16 cost time: 1.7862882614135742
Epoch: 16, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8249437808990479
Epoch: 17, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8166522979736328
Epoch: 18, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.506 Vali Acc: 0.836 Test Loss: 0.506 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 19 cost time: 1.7262327671051025
Epoch: 19, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.497 Vali Acc: 0.822 Test Loss: 0.497 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.551093339920044
Epoch: 20, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3937208652496338
Epoch: 21, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6411311626434326
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.465 Vali Acc: 0.822 Test Loss: 0.465 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7717580795288086
Epoch: 23, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 24 cost time: 1.417382001876831
Epoch: 24, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.715667486190796
Epoch: 25, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8293743133544922
Epoch: 26, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6805827617645264
Epoch: 27, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6688268184661865
Epoch: 28, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7533214092254639
Epoch: 29, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7945504188537598
Epoch: 30, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 519364
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.590805768966675
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.428 Vali Acc: 0.250 Test Loss: 1.428 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.8733599185943604
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.400 Vali Acc: 0.296 Test Loss: 1.400 Test Acc: 0.296
Validation loss decreased (-0.249986 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.9929993152618408
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.362 Vali Acc: 0.336 Test Loss: 1.362 Test Acc: 0.336
Validation loss decreased (-0.296039 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.911120891571045
Epoch: 4, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.320 Vali Acc: 0.382 Test Loss: 1.320 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 1.980790615081787
Epoch: 5, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.273 Vali Acc: 0.414 Test Loss: 1.273 Test Acc: 0.414
Validation loss decreased (-0.381566 --> -0.414461).  Saving model ...
Epoch: 6 cost time: 1.8279697895050049
Epoch: 6, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.220 Vali Acc: 0.474 Test Loss: 1.220 Test Acc: 0.474
Validation loss decreased (-0.414461 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 1.6387088298797607
Epoch: 7, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.164 Vali Acc: 0.546 Test Loss: 1.164 Test Acc: 0.546
Validation loss decreased (-0.473672 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 1.7662177085876465
Epoch: 8, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.102 Vali Acc: 0.579 Test Loss: 1.102 Test Acc: 0.579
Validation loss decreased (-0.546041 --> -0.578936).  Saving model ...
Epoch: 9 cost time: 1.8477554321289062
Epoch: 9, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.036 Vali Acc: 0.658 Test Loss: 1.036 Test Acc: 0.658
Validation loss decreased (-0.578936 --> -0.657884).  Saving model ...
Epoch: 10 cost time: 1.8251309394836426
Epoch: 10, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.964 Vali Acc: 0.730 Test Loss: 0.964 Test Acc: 0.730
Validation loss decreased (-0.657884 --> -0.730254).  Saving model ...
Epoch: 11 cost time: 1.8995611667633057
Epoch: 11, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.896 Vali Acc: 0.763 Test Loss: 0.896 Test Acc: 0.763
Validation loss decreased (-0.730254 --> -0.763149).  Saving model ...
Epoch: 12 cost time: 1.88724946975708
Epoch: 12, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.825 Vali Acc: 0.776 Test Loss: 0.825 Test Acc: 0.776
Validation loss decreased (-0.763149 --> -0.776308).  Saving model ...
Epoch: 13 cost time: 1.6028664112091064
Epoch: 13, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.757 Vali Acc: 0.770 Test Loss: 0.757 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5593461990356445
Epoch: 14, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782888).  Saving model ...
Epoch: 15 cost time: 1.8183722496032715
Epoch: 15, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 16 cost time: 1.811396598815918
Epoch: 16, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
Validation loss decreased (-0.789467 --> -0.815784).  Saving model ...
Epoch: 17 cost time: 1.8720118999481201
Epoch: 17, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 18 cost time: 1.76885986328125
Epoch: 18, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.516 Vali Acc: 0.842 Test Loss: 0.516 Test Acc: 0.842
Validation loss decreased (-0.815784 --> -0.842100).  Saving model ...
Epoch: 19 cost time: 1.737440586090088
Epoch: 19, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.772883653640747
Epoch: 20, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.639660120010376
Epoch: 21, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.458 Vali Acc: 0.829 Test Loss: 0.458 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2685840129852295
Epoch: 22, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.425 Vali Acc: 0.842 Test Loss: 0.425 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 23 cost time: 1.7065160274505615
Epoch: 23, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.434 Vali Acc: 0.836 Test Loss: 0.434 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5532233715057373
Epoch: 24, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.422 Vali Acc: 0.836 Test Loss: 0.422 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.736793041229248
Epoch: 25, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7317733764648438
Epoch: 26, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7020573616027832
Epoch: 27, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.409 Vali Acc: 0.816 Test Loss: 0.409 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6762819290161133
Epoch: 28, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.431 Vali Acc: 0.816 Test Loss: 0.431 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4634425640106201
Epoch: 29, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.434 Vali Acc: 0.829 Test Loss: 0.434 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5017483234405518
Epoch: 30, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1760932
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5599286556243896
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.432 Vali Acc: 0.257 Test Loss: 1.432 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.6120104789733887
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.405 Vali Acc: 0.322 Test Loss: 1.405 Test Acc: 0.322
Validation loss decreased (-0.256565 --> -0.322354).  Saving model ...
Epoch: 3 cost time: 1.530698299407959
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.368 Vali Acc: 0.329 Test Loss: 1.368 Test Acc: 0.329
Validation loss decreased (-0.322354 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 1.6045470237731934
Epoch: 4, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.323 Vali Acc: 0.395 Test Loss: 1.323 Test Acc: 0.395
Validation loss decreased (-0.328934 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.5743227005004883
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.277 Vali Acc: 0.447 Test Loss: 1.277 Test Acc: 0.447
Validation loss decreased (-0.394724 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 1.5851223468780518
Epoch: 6, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.227 Vali Acc: 0.539 Test Loss: 1.227 Test Acc: 0.539
Validation loss decreased (-0.447356 --> -0.539461).  Saving model ...
Epoch: 7 cost time: 1.5901665687561035
Epoch: 7, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.171 Vali Acc: 0.586 Test Loss: 1.171 Test Acc: 0.586
Validation loss decreased (-0.539461 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 1.6856880187988281
Epoch: 8, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.110 Vali Acc: 0.664 Test Loss: 1.110 Test Acc: 0.664
Validation loss decreased (-0.585515 --> -0.664463).  Saving model ...
Epoch: 9 cost time: 1.55729079246521
Epoch: 9, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.050 Vali Acc: 0.671 Test Loss: 1.050 Test Acc: 0.671
Validation loss decreased (-0.664463 --> -0.671042).  Saving model ...
Epoch: 10 cost time: 1.5934841632843018
Epoch: 10, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.988 Vali Acc: 0.697 Test Loss: 0.988 Test Acc: 0.697
Validation loss decreased (-0.671042 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 1.647568941116333
Epoch: 11, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.920 Vali Acc: 0.743 Test Loss: 0.920 Test Acc: 0.743
Validation loss decreased (-0.697359 --> -0.743412).  Saving model ...
Epoch: 12 cost time: 1.5900285243988037
Epoch: 12, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.857 Vali Acc: 0.743 Test Loss: 0.857 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743412).  Saving model ...
Epoch: 13 cost time: 1.5280334949493408
Epoch: 13, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.799 Vali Acc: 0.757 Test Loss: 0.799 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756571).  Saving model ...
Epoch: 14 cost time: 1.691730260848999
Epoch: 14, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.737 Vali Acc: 0.770 Test Loss: 0.737 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 15 cost time: 1.610605001449585
Epoch: 15, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782888).  Saving model ...
Epoch: 16 cost time: 1.5565152168273926
Epoch: 16, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
Validation loss decreased (-0.782888 --> -0.809204).  Saving model ...
Epoch: 17 cost time: 1.5773720741271973
Epoch: 17, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.574012041091919
Epoch: 18, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.435868263244629
Epoch: 19, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.583216905593872
Epoch: 20, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5539741516113281
Epoch: 21, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.491729497909546
Epoch: 22, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 23 cost time: 1.4674570560455322
Epoch: 23, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2682676315307617
Epoch: 24, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4106378555297852
Epoch: 25, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.407243013381958
Epoch: 26, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3851494789123535
Epoch: 27, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4655404090881348
Epoch: 28, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4700360298156738
Epoch: 29, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5153813362121582
Epoch: 30, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 519364
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.845585107803345
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.391 Vali Acc: 0.296 Test Loss: 1.391 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 5.510625123977661
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.362 Vali Acc: 0.329 Test Loss: 1.362 Test Acc: 0.329
Validation loss decreased (-0.296039 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 5.215713977813721
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
Validation loss decreased (-0.328934 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 5.1231865882873535
Epoch: 4, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.277 Vali Acc: 0.408 Test Loss: 1.277 Test Acc: 0.408
Validation loss decreased (-0.374987 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 5.508631706237793
Epoch: 5, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.227 Vali Acc: 0.461 Test Loss: 1.227 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 5.174699783325195
Epoch: 6, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.171 Vali Acc: 0.507 Test Loss: 1.171 Test Acc: 0.507
Validation loss decreased (-0.460514 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 5.407688617706299
Epoch: 7, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.106 Vali Acc: 0.599 Test Loss: 1.106 Test Acc: 0.599
Validation loss decreased (-0.506567 --> -0.598673).  Saving model ...
Epoch: 8 cost time: 5.979052543640137
Epoch: 8, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.034 Vali Acc: 0.651 Test Loss: 1.034 Test Acc: 0.651
Validation loss decreased (-0.598673 --> -0.651305).  Saving model ...
Epoch: 9 cost time: 4.73604679107666
Epoch: 9, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.953 Vali Acc: 0.704 Test Loss: 0.953 Test Acc: 0.704
Validation loss decreased (-0.651305 --> -0.703938).  Saving model ...
Epoch: 10 cost time: 5.419670104980469
Epoch: 10, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.865 Vali Acc: 0.770 Test Loss: 0.865 Test Acc: 0.770
Validation loss decreased (-0.703938 --> -0.769728).  Saving model ...
Epoch: 11 cost time: 5.251403093338013
Epoch: 11, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
Validation loss decreased (-0.769728 --> -0.789466).  Saving model ...
Epoch: 12 cost time: 4.95029878616333
Epoch: 12, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.695 Vali Acc: 0.770 Test Loss: 0.695 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.6001341342926025
Epoch: 13, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 4.8656487464904785
Epoch: 14, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.394244432449341
Epoch: 15, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 5.875872850418091
Epoch: 16, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 5.640239238739014
Epoch: 17, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 18 cost time: 5.703066110610962
Epoch: 18, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.453 Vali Acc: 0.836 Test Loss: 0.453 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 19 cost time: 5.023833274841309
Epoch: 19, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.453 Vali Acc: 0.803 Test Loss: 0.453 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.117016077041626
Epoch: 20, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.576059818267822
Epoch: 21, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.456 Vali Acc: 0.803 Test Loss: 0.456 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.817641496658325
Epoch: 22, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.623424530029297
Epoch: 23, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.014383554458618
Epoch: 24, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.645000219345093
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.202554702758789
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.548011064529419
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.845378160476685
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 881764
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.416966915130615
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.338 Vali Acc: 0.368 Test Loss: 1.338 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 2.9581868648529053
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.313 Vali Acc: 0.395 Test Loss: 1.313 Test Acc: 0.395
Validation loss decreased (-0.368408 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 2.872257709503174
Epoch: 3, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.280 Vali Acc: 0.414 Test Loss: 1.280 Test Acc: 0.414
Validation loss decreased (-0.394724 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 2.7695980072021484
Epoch: 4, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.246 Vali Acc: 0.428 Test Loss: 1.246 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 2.8107151985168457
Epoch: 5, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.205 Vali Acc: 0.461 Test Loss: 1.205 Test Acc: 0.461
Validation loss decreased (-0.427619 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 3.790980815887451
Epoch: 6, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.163 Vali Acc: 0.513 Test Loss: 1.163 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 3.7905585765838623
Epoch: 7, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.116 Vali Acc: 0.566 Test Loss: 1.116 Test Acc: 0.566
Validation loss decreased (-0.513146 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 3.8139002323150635
Epoch: 8, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.065 Vali Acc: 0.605 Test Loss: 1.065 Test Acc: 0.605
Validation loss decreased (-0.565778 --> -0.605253).  Saving model ...
Epoch: 9 cost time: 3.645493745803833
Epoch: 9, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.010 Vali Acc: 0.632 Test Loss: 1.010 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 3.801663637161255
Epoch: 10, Steps: 10 | Train Loss: 0.935 Vali Loss: 0.956 Vali Acc: 0.704 Test Loss: 0.956 Test Acc: 0.704
Validation loss decreased (-0.631569 --> -0.703938).  Saving model ...
Epoch: 11 cost time: 3.725128412246704
Epoch: 11, Steps: 10 | Train Loss: 0.887 Vali Loss: 0.895 Vali Acc: 0.717 Test Loss: 0.895 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717096).  Saving model ...
Epoch: 12 cost time: 3.70880126953125
Epoch: 12, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.831 Vali Acc: 0.776 Test Loss: 0.831 Test Acc: 0.776
Validation loss decreased (-0.717096 --> -0.776307).  Saving model ...
Epoch: 13 cost time: 3.362755060195923
Epoch: 13, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.769 Vali Acc: 0.776 Test Loss: 0.769 Test Acc: 0.776
Validation loss decreased (-0.776307 --> -0.776308).  Saving model ...
Epoch: 14 cost time: 3.8127877712249756
Epoch: 14, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 3.39241886138916
Epoch: 15, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 2.8929476737976074
Epoch: 16, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 2.9747886657714844
Epoch: 17, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 18 cost time: 3.354273557662964
Epoch: 18, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 3.1916112899780273
Epoch: 19, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.493 Vali Acc: 0.836 Test Loss: 0.493 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 20 cost time: 3.3712480068206787
Epoch: 20, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4549360275268555
Epoch: 21, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3387928009033203
Epoch: 22, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.425 Vali Acc: 0.829 Test Loss: 0.425 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.332737445831299
Epoch: 23, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.412 Vali Acc: 0.842 Test Loss: 0.412 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842101).  Saving model ...
Epoch: 24 cost time: 2.716527223587036
Epoch: 24, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.405 Vali Acc: 0.842 Test Loss: 0.405 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 25 cost time: 3.377021074295044
Epoch: 25, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.407 Vali Acc: 0.849 Test Loss: 0.407 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 26 cost time: 3.403804063796997
Epoch: 26, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.410 Vali Acc: 0.836 Test Loss: 0.410 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9159774780273438
Epoch: 27, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 28 cost time: 3.683070659637451
Epoch: 28, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.404 Vali Acc: 0.842 Test Loss: 0.404 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4808127880096436
Epoch: 29, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.4560861587524414
Epoch: 30, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 260932
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.652249813079834
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.391 Vali Acc: 0.303 Test Loss: 1.391 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 4.132809638977051
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.364 Vali Acc: 0.336 Test Loss: 1.364 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 4.5052947998046875
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.328 Vali Acc: 0.362 Test Loss: 1.328 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 4.360183238983154
Epoch: 4, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.285 Vali Acc: 0.408 Test Loss: 1.285 Test Acc: 0.408
Validation loss decreased (-0.361829 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 4.068014144897461
Epoch: 5, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.240 Vali Acc: 0.461 Test Loss: 1.240 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 3.990366220474243
Epoch: 6, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
Validation loss decreased (-0.460514 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 4.170872211456299
Epoch: 7, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.133 Vali Acc: 0.572 Test Loss: 1.133 Test Acc: 0.572
Validation loss decreased (-0.480251 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 4.17078161239624
Epoch: 8, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.071 Vali Acc: 0.651 Test Loss: 1.071 Test Acc: 0.651
Validation loss decreased (-0.572357 --> -0.651305).  Saving model ...
Epoch: 9 cost time: 3.871859073638916
Epoch: 9, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.002 Vali Acc: 0.678 Test Loss: 1.002 Test Acc: 0.678
Validation loss decreased (-0.651305 --> -0.677622).  Saving model ...
Epoch: 10 cost time: 4.341166257858276
Epoch: 10, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.926 Vali Acc: 0.737 Test Loss: 0.926 Test Acc: 0.737
Validation loss decreased (-0.677622 --> -0.736833).  Saving model ...
Epoch: 11 cost time: 4.181890487670898
Epoch: 11, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 4.166620969772339
Epoch: 12, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.772 Vali Acc: 0.750 Test Loss: 0.772 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 3.422292947769165
Epoch: 13, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.702 Vali Acc: 0.763 Test Loss: 0.702 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 4.061546564102173
Epoch: 14, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8468947410583496
Epoch: 15, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 3.668549060821533
Epoch: 16, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 3.99222731590271
Epoch: 17, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 3.0409960746765137
Epoch: 18, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 2.627129316329956
Epoch: 19, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.466 Vali Acc: 0.822 Test Loss: 0.466 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 20 cost time: 2.639023542404175
Epoch: 20, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.469 Vali Acc: 0.829 Test Loss: 0.469 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 21 cost time: 4.204200267791748
Epoch: 21, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.454 Vali Acc: 0.816 Test Loss: 0.454 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.131436347961426
Epoch: 22, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.455 Vali Acc: 0.822 Test Loss: 0.455 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.07189679145813
Epoch: 23, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.455 Vali Acc: 0.822 Test Loss: 0.455 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.192844390869141
Epoch: 24, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 25 cost time: 4.06892204284668
Epoch: 25, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.933431386947632
Epoch: 26, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.487905740737915
Epoch: 27, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.038553237915039
Epoch: 28, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.9159786701202393
Epoch: 29, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.472 Vali Acc: 0.822 Test Loss: 0.472 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.5042779445648193
Epoch: 30, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 881764
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.587091445922852
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.333 Vali Acc: 0.368 Test Loss: 1.333 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 2.7213943004608154
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.311 Vali Acc: 0.408 Test Loss: 1.311 Test Acc: 0.408
Validation loss decreased (-0.368408 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 2.814069986343384
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.280 Vali Acc: 0.408 Test Loss: 1.280 Test Acc: 0.408
Validation loss decreased (-0.407882 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 2.796710729598999
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.249 Vali Acc: 0.434 Test Loss: 1.249 Test Acc: 0.434
Validation loss decreased (-0.407882 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 2.8540070056915283
Epoch: 5, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.210 Vali Acc: 0.447 Test Loss: 1.210 Test Acc: 0.447
Validation loss decreased (-0.434198 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 2.572441816329956
Epoch: 6, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
Validation loss decreased (-0.447356 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 2.476991653442383
Epoch: 7, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.130 Vali Acc: 0.539 Test Loss: 1.130 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 2.776702404022217
Epoch: 8, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.083 Vali Acc: 0.599 Test Loss: 1.083 Test Acc: 0.599
Validation loss decreased (-0.539462 --> -0.598673).  Saving model ...
Epoch: 9 cost time: 2.841536283493042
Epoch: 9, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.035 Vali Acc: 0.671 Test Loss: 1.035 Test Acc: 0.671
Validation loss decreased (-0.598673 --> -0.671042).  Saving model ...
Epoch: 10 cost time: 2.554104804992676
Epoch: 10, Steps: 10 | Train Loss: 0.986 Vali Loss: 0.988 Vali Acc: 0.684 Test Loss: 0.988 Test Acc: 0.684
Validation loss decreased (-0.671042 --> -0.684201).  Saving model ...
Epoch: 11 cost time: 2.3168070316314697
Epoch: 11, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.936 Vali Acc: 0.697 Test Loss: 0.936 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697359).  Saving model ...
Epoch: 12 cost time: 2.3903512954711914
Epoch: 12, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.877 Vali Acc: 0.737 Test Loss: 0.877 Test Acc: 0.737
Validation loss decreased (-0.697359 --> -0.736833).  Saving model ...
Epoch: 13 cost time: 2.3358895778656006
Epoch: 13, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.819 Vali Acc: 0.783 Test Loss: 0.819 Test Acc: 0.783
Validation loss decreased (-0.736833 --> -0.782887).  Saving model ...
Epoch: 14 cost time: 2.3451318740844727
Epoch: 14, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.763 Vali Acc: 0.770 Test Loss: 0.763 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.353586435317993
Epoch: 15, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.705 Vali Acc: 0.770 Test Loss: 0.705 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0098323822021484
Epoch: 16, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
Validation loss decreased (-0.782887 --> -0.822362).  Saving model ...
Epoch: 17 cost time: 2.6400654315948486
Epoch: 17, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822362).  Saving model ...
Epoch: 18 cost time: 2.5752408504486084
Epoch: 18, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.546 Vali Acc: 0.829 Test Loss: 0.546 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 19 cost time: 2.6200366020202637
Epoch: 19, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.505 Vali Acc: 0.842 Test Loss: 0.505 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842100).  Saving model ...
Epoch: 20 cost time: 2.4484593868255615
Epoch: 20, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.473 Vali Acc: 0.836 Test Loss: 0.473 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.746065378189087
Epoch: 21, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855259).  Saving model ...
Epoch: 22 cost time: 2.8735344409942627
Epoch: 22, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 23 cost time: 2.801210641860962
Epoch: 23, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 24 cost time: 2.332096815109253
Epoch: 24, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 25 cost time: 2.10237193107605
Epoch: 25, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.463606834411621
Epoch: 26, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.369 Vali Acc: 0.855 Test Loss: 0.369 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.402933120727539
Epoch: 27, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.374 Vali Acc: 0.849 Test Loss: 0.374 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.329305410385132
Epoch: 28, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.357 Vali Acc: 0.862 Test Loss: 0.357 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861839).  Saving model ...
Epoch: 29 cost time: 1.9540412425994873
Epoch: 29, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.355 Vali Acc: 0.868 Test Loss: 0.355 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868417).  Saving model ...
Epoch: 30 cost time: 2.3398821353912354
Epoch: 30, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.359 Vali Acc: 0.855 Test Loss: 0.359 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 260932
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.535624265670776
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.394 Vali Acc: 0.283 Test Loss: 1.394 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.765397071838379
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.372 Vali Acc: 0.329 Test Loss: 1.372 Test Acc: 0.329
Validation loss decreased (-0.282881 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 2.8090052604675293
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.341 Vali Acc: 0.349 Test Loss: 1.341 Test Acc: 0.349
Validation loss decreased (-0.328934 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 2.729531764984131
Epoch: 4, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.304 Vali Acc: 0.375 Test Loss: 1.304 Test Acc: 0.375
Validation loss decreased (-0.348671 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 2.6490111351013184
Epoch: 5, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.266 Vali Acc: 0.428 Test Loss: 1.266 Test Acc: 0.428
Validation loss decreased (-0.374987 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 2.776726007461548
Epoch: 6, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.225 Vali Acc: 0.480 Test Loss: 1.225 Test Acc: 0.480
Validation loss decreased (-0.427619 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 2.7943620681762695
Epoch: 7, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.179 Vali Acc: 0.539 Test Loss: 1.179 Test Acc: 0.539
Validation loss decreased (-0.480251 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 2.4956719875335693
Epoch: 8, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.131 Vali Acc: 0.638 Test Loss: 1.131 Test Acc: 0.638
Validation loss decreased (-0.539462 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 2.3252005577087402
Epoch: 9, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.078 Vali Acc: 0.678 Test Loss: 1.078 Test Acc: 0.678
Validation loss decreased (-0.638147 --> -0.677621).  Saving model ...
Epoch: 10 cost time: 1.9669229984283447
Epoch: 10, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.018 Vali Acc: 0.684 Test Loss: 1.018 Test Acc: 0.684
Validation loss decreased (-0.677621 --> -0.684200).  Saving model ...
Epoch: 11 cost time: 2.5267908573150635
Epoch: 11, Steps: 10 | Train Loss: 0.905 Vali Loss: 0.956 Vali Acc: 0.717 Test Loss: 0.956 Test Acc: 0.717
Validation loss decreased (-0.684200 --> -0.717096).  Saving model ...
Epoch: 12 cost time: 2.498173952102661
Epoch: 12, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.886 Vali Acc: 0.730 Test Loss: 0.886 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730254).  Saving model ...
Epoch: 13 cost time: 2.4282021522521973
Epoch: 13, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.817 Vali Acc: 0.757 Test Loss: 0.817 Test Acc: 0.757
Validation loss decreased (-0.730254 --> -0.756571).  Saving model ...
Epoch: 14 cost time: 2.3654229640960693
Epoch: 14, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.749 Vali Acc: 0.770 Test Loss: 0.749 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769729).  Saving model ...
Epoch: 15 cost time: 2.4111783504486084
Epoch: 15, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
Validation loss decreased (-0.769729 --> -0.782888).  Saving model ...
Epoch: 16 cost time: 2.5395166873931885
Epoch: 16, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 2.5017499923706055
Epoch: 17, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.585 Vali Acc: 0.796 Test Loss: 0.585 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.538743019104004
Epoch: 18, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5423998832702637
Epoch: 19, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 2.612576484680176
Epoch: 20, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 2.6223933696746826
Epoch: 21, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.442 Vali Acc: 0.829 Test Loss: 0.442 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 22 cost time: 2.644521951675415
Epoch: 22, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.419 Vali Acc: 0.842 Test Loss: 0.419 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 23 cost time: 2.298504590988159
Epoch: 23, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 24 cost time: 1.716538667678833
Epoch: 24, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 25 cost time: 2.3567707538604736
Epoch: 25, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.383 Vali Acc: 0.855 Test Loss: 0.383 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 26 cost time: 2.471090793609619
Epoch: 26, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 27 cost time: 2.2985410690307617
Epoch: 27, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.405 Vali Acc: 0.842 Test Loss: 0.405 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2941601276397705
Epoch: 28, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 29 cost time: 2.3400254249572754
Epoch: 29, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 30 cost time: 1.6050047874450684
Epoch: 30, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.365 Vali Acc: 0.862 Test Loss: 0.365 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 881764
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5694069862365723
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.332 Vali Acc: 0.368 Test Loss: 1.332 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.7704079151153564
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.312 Vali Acc: 0.401 Test Loss: 1.312 Test Acc: 0.401
Validation loss decreased (-0.368408 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 2.050034523010254
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.286 Vali Acc: 0.421 Test Loss: 1.286 Test Acc: 0.421
Validation loss decreased (-0.401303 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.7081172466278076
Epoch: 4, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.259 Vali Acc: 0.421 Test Loss: 1.259 Test Acc: 0.421
Validation loss decreased (-0.421040 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.959549903869629
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.226 Vali Acc: 0.454 Test Loss: 1.226 Test Acc: 0.454
Validation loss decreased (-0.421040 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.9736053943634033
Epoch: 6, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.192 Vali Acc: 0.493 Test Loss: 1.192 Test Acc: 0.493
Validation loss decreased (-0.453935 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 1.76546311378479
Epoch: 7, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.156 Vali Acc: 0.539 Test Loss: 1.156 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 1.8555777072906494
Epoch: 8, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.117 Vali Acc: 0.566 Test Loss: 1.117 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565778).  Saving model ...
Epoch: 9 cost time: 1.8167366981506348
Epoch: 9, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.076 Vali Acc: 0.605 Test Loss: 1.076 Test Acc: 0.605
Validation loss decreased (-0.565778 --> -0.605252).  Saving model ...
Epoch: 10 cost time: 1.8819663524627686
Epoch: 10, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
Validation loss decreased (-0.605252 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 1.8634798526763916
Epoch: 11, Steps: 10 | Train Loss: 1.007 Vali Loss: 0.992 Vali Acc: 0.638 Test Loss: 0.992 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 1.751805305480957
Epoch: 12, Steps: 10 | Train Loss: 0.940 Vali Loss: 0.945 Vali Acc: 0.658 Test Loss: 0.945 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 13 cost time: 1.8567230701446533
Epoch: 13, Steps: 10 | Train Loss: 0.872 Vali Loss: 0.890 Vali Acc: 0.711 Test Loss: 0.890 Test Acc: 0.711
Validation loss decreased (-0.657885 --> -0.710517).  Saving model ...
Epoch: 14 cost time: 1.707472801208496
Epoch: 14, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.841 Vali Acc: 0.724 Test Loss: 0.841 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723676).  Saving model ...
Epoch: 15 cost time: 2.060947895050049
Epoch: 15, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.793 Vali Acc: 0.743 Test Loss: 0.793 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 2.0121002197265625
Epoch: 16, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.738 Vali Acc: 0.763 Test Loss: 0.738 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 1.9429879188537598
Epoch: 17, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 18 cost time: 2.0939042568206787
Epoch: 18, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
Validation loss decreased (-0.782888 --> -0.815783).  Saving model ...
Epoch: 19 cost time: 1.9596796035766602
Epoch: 19, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.593 Vali Acc: 0.836 Test Loss: 0.593 Test Acc: 0.836
Validation loss decreased (-0.815783 --> -0.835520).  Saving model ...
Epoch: 20 cost time: 2.023697853088379
Epoch: 20, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.558 Vali Acc: 0.842 Test Loss: 0.558 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842100).  Saving model ...
Epoch: 21 cost time: 2.0028936862945557
Epoch: 21, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.518 Vali Acc: 0.842 Test Loss: 0.518 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842100).  Saving model ...
Epoch: 22 cost time: 2.0596301555633545
Epoch: 22, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.480 Vali Acc: 0.868 Test Loss: 0.480 Test Acc: 0.868
Validation loss decreased (-0.842100 --> -0.868416).  Saving model ...
Epoch: 23 cost time: 1.9543049335479736
Epoch: 23, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.456 Vali Acc: 0.849 Test Loss: 0.456 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8361101150512695
Epoch: 24, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7989370822906494
Epoch: 25, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.406 Vali Acc: 0.888 Test Loss: 0.406 Test Acc: 0.888
Validation loss decreased (-0.868416 --> -0.888154).  Saving model ...
Epoch: 26 cost time: 1.6241765022277832
Epoch: 26, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.388 Vali Acc: 0.895 Test Loss: 0.388 Test Acc: 0.895
Validation loss decreased (-0.888154 --> -0.894733).  Saving model ...
Epoch: 27 cost time: 1.4364376068115234
Epoch: 27, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.375 Vali Acc: 0.895 Test Loss: 0.375 Test Acc: 0.895
Validation loss decreased (-0.894733 --> -0.894733).  Saving model ...
Epoch: 28 cost time: 1.7047736644744873
Epoch: 28, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.366 Vali Acc: 0.895 Test Loss: 0.366 Test Acc: 0.895
Validation loss decreased (-0.894733 --> -0.894733).  Saving model ...
Epoch: 29 cost time: 1.662583589553833
Epoch: 29, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.356 Vali Acc: 0.895 Test Loss: 0.356 Test Acc: 0.895
Validation loss decreased (-0.894733 --> -0.894733).  Saving model ...
Epoch: 30 cost time: 1.7591099739074707
Epoch: 30, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.351 Vali Acc: 0.888 Test Loss: 0.351 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8947368421052632
model parameter : 260932
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.240575313568115
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.380 Vali Acc: 0.263 Test Loss: 1.380 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 5.044903755187988
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.355 Vali Acc: 0.270 Test Loss: 1.355 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 4.750748157501221
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.322 Vali Acc: 0.355 Test Loss: 1.322 Test Acc: 0.355
Validation loss decreased (-0.269723 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 5.012077569961548
Epoch: 4, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.284 Vali Acc: 0.421 Test Loss: 1.284 Test Acc: 0.421
Validation loss decreased (-0.355250 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 4.774954319000244
Epoch: 5, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.243 Vali Acc: 0.461 Test Loss: 1.243 Test Acc: 0.461
Validation loss decreased (-0.421040 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 4.631436586380005
Epoch: 6, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.198 Vali Acc: 0.513 Test Loss: 1.198 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 4.718141555786133
Epoch: 7, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.150 Vali Acc: 0.559 Test Loss: 1.150 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 5.154916286468506
Epoch: 8, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.095 Vali Acc: 0.618 Test Loss: 1.095 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618410).  Saving model ...
Epoch: 9 cost time: 5.534194469451904
Epoch: 9, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.032 Vali Acc: 0.645 Test Loss: 1.032 Test Acc: 0.645
Validation loss decreased (-0.618410 --> -0.644727).  Saving model ...
Epoch: 10 cost time: 5.1830127239227295
Epoch: 10, Steps: 10 | Train Loss: 0.920 Vali Loss: 0.967 Vali Acc: 0.651 Test Loss: 0.967 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 5.3837571144104
Epoch: 11, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.894 Vali Acc: 0.651 Test Loss: 0.894 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651307).  Saving model ...
Epoch: 12 cost time: 5.714489698410034
Epoch: 12, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.823 Vali Acc: 0.678 Test Loss: 0.823 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 13 cost time: 5.550675392150879
Epoch: 13, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.751 Vali Acc: 0.730 Test Loss: 0.751 Test Acc: 0.730
Validation loss decreased (-0.677623 --> -0.730256).  Saving model ...
Epoch: 14 cost time: 4.423415422439575
Epoch: 14, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.694 Vali Acc: 0.757 Test Loss: 0.694 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756572).  Saving model ...
Epoch: 15 cost time: 4.872854471206665
Epoch: 15, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 5.02642560005188
Epoch: 16, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 4.418416738510132
Epoch: 17, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.572 Vali Acc: 0.750 Test Loss: 0.572 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.571052074432373
Epoch: 18, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 5.343271970748901
Epoch: 19, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.515 Vali Acc: 0.763 Test Loss: 0.515 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.252978324890137
Epoch: 20, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 4.707101345062256
Epoch: 21, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.435 Vali Acc: 0.816 Test Loss: 0.435 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 22 cost time: 5.04546856880188
Epoch: 22, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.423 Vali Acc: 0.803 Test Loss: 0.423 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7538199424743652
Epoch: 23, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.418 Vali Acc: 0.803 Test Loss: 0.418 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.962822914123535
Epoch: 24, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.417 Vali Acc: 0.816 Test Loss: 0.417 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 25 cost time: 3.0239970684051514
Epoch: 25, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 26 cost time: 4.740664482116699
Epoch: 26, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.425 Vali Acc: 0.809 Test Loss: 0.425 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.554911851882935
Epoch: 27, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.435 Vali Acc: 0.803 Test Loss: 0.435 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.67083740234375
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.442 Vali Acc: 0.803 Test Loss: 0.442 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.294414758682251
Epoch: 29, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.419 Vali Acc: 0.829 Test Loss: 0.419 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 30 cost time: 5.268667936325073
Epoch: 30, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.438 Vali Acc: 0.816 Test Loss: 0.438 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 442180
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.342459440231323
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.367 Vali Acc: 0.355 Test Loss: 1.367 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 2.9786226749420166
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.346 Vali Acc: 0.368 Test Loss: 1.346 Test Acc: 0.368
Validation loss decreased (-0.355249 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.6754708290100098
Epoch: 3, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.317 Vali Acc: 0.414 Test Loss: 1.317 Test Acc: 0.414
Validation loss decreased (-0.368408 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 2.3339810371398926
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.283 Vali Acc: 0.441 Test Loss: 1.283 Test Acc: 0.441
Validation loss decreased (-0.414461 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 1.7985038757324219
Epoch: 5, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.245 Vali Acc: 0.507 Test Loss: 1.245 Test Acc: 0.507
Validation loss decreased (-0.440777 --> -0.506567).  Saving model ...
Epoch: 6 cost time: 2.5450599193573
Epoch: 6, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.201 Vali Acc: 0.546 Test Loss: 1.201 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 3.1466212272644043
Epoch: 7, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.154 Vali Acc: 0.579 Test Loss: 1.154 Test Acc: 0.579
Validation loss decreased (-0.546041 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 3.2151997089385986
Epoch: 8, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.102 Vali Acc: 0.638 Test Loss: 1.102 Test Acc: 0.638
Validation loss decreased (-0.578936 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 3.599806070327759
Epoch: 9, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.050 Vali Acc: 0.664 Test Loss: 1.050 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 3.4519901275634766
Epoch: 10, Steps: 10 | Train Loss: 0.987 Vali Loss: 0.991 Vali Acc: 0.697 Test Loss: 0.991 Test Acc: 0.697
Validation loss decreased (-0.664463 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 3.5061938762664795
Epoch: 11, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.927 Vali Acc: 0.763 Test Loss: 0.927 Test Acc: 0.763
Validation loss decreased (-0.697359 --> -0.763149).  Saving model ...
Epoch: 12 cost time: 3.5883407592773438
Epoch: 12, Steps: 10 | Train Loss: 0.829 Vali Loss: 0.864 Vali Acc: 0.770 Test Loss: 0.864 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769728).  Saving model ...
Epoch: 13 cost time: 3.3590290546417236
Epoch: 13, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.800 Vali Acc: 0.789 Test Loss: 0.800 Test Acc: 0.789
Validation loss decreased (-0.769728 --> -0.789466).  Saving model ...
Epoch: 14 cost time: 3.5882866382598877
Epoch: 14, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.734 Vali Acc: 0.796 Test Loss: 0.734 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 15 cost time: 3.2681071758270264
Epoch: 15, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.673 Vali Acc: 0.836 Test Loss: 0.673 Test Acc: 0.836
Validation loss decreased (-0.796045 --> -0.835520).  Saving model ...
Epoch: 16 cost time: 3.1073386669158936
Epoch: 16, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.611 Vali Acc: 0.849 Test Loss: 0.611 Test Acc: 0.849
Validation loss decreased (-0.835520 --> -0.848678).  Saving model ...
Epoch: 17 cost time: 3.351771116256714
Epoch: 17, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.564 Vali Acc: 0.829 Test Loss: 0.564 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.900320053100586
Epoch: 18, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.524 Vali Acc: 0.842 Test Loss: 0.524 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.33986759185791
Epoch: 19, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.491 Vali Acc: 0.855 Test Loss: 0.491 Test Acc: 0.855
Validation loss decreased (-0.848678 --> -0.855258).  Saving model ...
Epoch: 20 cost time: 3.1452136039733887
Epoch: 20, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861838).  Saving model ...
Epoch: 21 cost time: 3.014512538909912
Epoch: 21, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.430 Vali Acc: 0.868 Test Loss: 0.430 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 22 cost time: 3.537205934524536
Epoch: 22, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3410804271698
Epoch: 23, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5636589527130127
Epoch: 24, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.368 Vali Acc: 0.868 Test Loss: 0.368 Test Acc: 0.868
Validation loss decreased (-0.868417 --> -0.868417).  Saving model ...
Epoch: 25 cost time: 3.5724411010742188
Epoch: 25, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.246363639831543
Epoch: 26, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.340 Vali Acc: 0.882 Test Loss: 0.340 Test Acc: 0.882
Validation loss decreased (-0.868417 --> -0.881576).  Saving model ...
Epoch: 27 cost time: 3.54677152633667
Epoch: 27, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.332 Vali Acc: 0.868 Test Loss: 0.332 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5608327388763428
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.78609299659729
Epoch: 29, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.313 Vali Acc: 0.888 Test Loss: 0.313 Test Acc: 0.888
Validation loss decreased (-0.881576 --> -0.888155).  Saving model ...
Epoch: 30 cost time: 3.0149946212768555
Epoch: 30, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.305 Vali Acc: 0.882 Test Loss: 0.305 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 131716
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.897404432296753
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.381 Vali Acc: 0.257 Test Loss: 1.381 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 4.034019470214844
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.359 Vali Acc: 0.270 Test Loss: 1.359 Test Acc: 0.270
Validation loss decreased (-0.256565 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 3.6130969524383545
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.329 Vali Acc: 0.309 Test Loss: 1.329 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 4.077480792999268
Epoch: 4, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.295 Vali Acc: 0.395 Test Loss: 1.295 Test Acc: 0.395
Validation loss decreased (-0.309197 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 3.624803066253662
Epoch: 5, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.258 Vali Acc: 0.467 Test Loss: 1.258 Test Acc: 0.467
Validation loss decreased (-0.394724 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 4.075165271759033
Epoch: 6, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.220 Vali Acc: 0.507 Test Loss: 1.220 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 4.18276572227478
Epoch: 7, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.179 Vali Acc: 0.553 Test Loss: 1.179 Test Acc: 0.553
Validation loss decreased (-0.506567 --> -0.552620).  Saving model ...
Epoch: 8 cost time: 3.6986217498779297
Epoch: 8, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.132 Vali Acc: 0.612 Test Loss: 1.132 Test Acc: 0.612
Validation loss decreased (-0.552620 --> -0.611831).  Saving model ...
Epoch: 9 cost time: 3.7332818508148193
Epoch: 9, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.079 Vali Acc: 0.645 Test Loss: 1.079 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644726).  Saving model ...
Epoch: 10 cost time: 2.9464428424835205
Epoch: 10, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.022 Vali Acc: 0.658 Test Loss: 1.022 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657885).  Saving model ...
Epoch: 11 cost time: 3.7963531017303467
Epoch: 11, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.956 Vali Acc: 0.658 Test Loss: 0.956 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 3.249704122543335
Epoch: 12, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.891 Vali Acc: 0.658 Test Loss: 0.891 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657886).  Saving model ...
Epoch: 13 cost time: 3.4659297466278076
Epoch: 13, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.824 Vali Acc: 0.671 Test Loss: 0.824 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 14 cost time: 4.162245988845825
Epoch: 14, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
Validation loss decreased (-0.671044 --> -0.710519).  Saving model ...
Epoch: 15 cost time: 4.517759323120117
Epoch: 15, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.693 Vali Acc: 0.743 Test Loss: 0.693 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 4.197232007980347
Epoch: 16, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.632 Vali Acc: 0.763 Test Loss: 0.632 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 4.4066150188446045
Epoch: 17, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 4.4185426235198975
Epoch: 18, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 3.9899652004241943
Epoch: 19, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 4.17756199836731
Epoch: 20, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 21 cost time: 3.615607500076294
Epoch: 21, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 22 cost time: 4.191507339477539
Epoch: 22, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.436 Vali Acc: 0.816 Test Loss: 0.436 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7169926166534424
Epoch: 23, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.429 Vali Acc: 0.803 Test Loss: 0.429 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.203186750411987
Epoch: 24, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.425 Vali Acc: 0.809 Test Loss: 0.425 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.811231851577759
Epoch: 25, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.441 Vali Acc: 0.816 Test Loss: 0.441 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.291872262954712
Epoch: 26, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.434 Vali Acc: 0.816 Test Loss: 0.434 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.3894500732421875
Epoch: 27, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.443 Vali Acc: 0.809 Test Loss: 0.443 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.8021023273468018
Epoch: 28, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.455 Vali Acc: 0.809 Test Loss: 0.455 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.568690776824951
Epoch: 29, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.449 Vali Acc: 0.816 Test Loss: 0.449 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.1146063804626465
Epoch: 30, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 442180
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7771992683410645
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.370 Vali Acc: 0.336 Test Loss: 1.370 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 2.128516435623169
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.335513 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 2.0411202907562256
Epoch: 3, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.322 Vali Acc: 0.401 Test Loss: 1.322 Test Acc: 0.401
Validation loss decreased (-0.374986 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 2.382498025894165
Epoch: 4, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.289 Vali Acc: 0.428 Test Loss: 1.289 Test Acc: 0.428
Validation loss decreased (-0.401303 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 2.3471596240997314
Epoch: 5, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.253 Vali Acc: 0.480 Test Loss: 1.253 Test Acc: 0.480
Validation loss decreased (-0.427619 --> -0.480251).  Saving model ...
Epoch: 6 cost time: 2.332951545715332
Epoch: 6, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.212 Vali Acc: 0.559 Test Loss: 1.212 Test Acc: 0.559
Validation loss decreased (-0.480251 --> -0.559198).  Saving model ...
Epoch: 7 cost time: 2.667156457901001
Epoch: 7, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.167 Vali Acc: 0.586 Test Loss: 1.167 Test Acc: 0.586
Validation loss decreased (-0.559198 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 2.376970052719116
Epoch: 8, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.118 Vali Acc: 0.638 Test Loss: 1.118 Test Acc: 0.638
Validation loss decreased (-0.585515 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 2.336998224258423
Epoch: 9, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.069 Vali Acc: 0.664 Test Loss: 1.069 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 2.5694971084594727
Epoch: 10, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.015 Vali Acc: 0.704 Test Loss: 1.015 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703937).  Saving model ...
Epoch: 11 cost time: 2.381113290786743
Epoch: 11, Steps: 10 | Train Loss: 0.934 Vali Loss: 0.956 Vali Acc: 0.743 Test Loss: 0.956 Test Acc: 0.743
Validation loss decreased (-0.703937 --> -0.743411).  Saving model ...
Epoch: 12 cost time: 2.3258373737335205
Epoch: 12, Steps: 10 | Train Loss: 0.885 Vali Loss: 0.899 Vali Acc: 0.757 Test Loss: 0.899 Test Acc: 0.757
Validation loss decreased (-0.743411 --> -0.756570).  Saving model ...
Epoch: 13 cost time: 2.5819084644317627
Epoch: 13, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.840 Vali Acc: 0.770 Test Loss: 0.840 Test Acc: 0.770
Validation loss decreased (-0.756570 --> -0.769728).  Saving model ...
Epoch: 14 cost time: 2.1254329681396484
Epoch: 14, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.776 Vali Acc: 0.770 Test Loss: 0.776 Test Acc: 0.770
Validation loss decreased (-0.769728 --> -0.769729).  Saving model ...
Epoch: 15 cost time: 2.1013824939727783
Epoch: 15, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.717 Vali Acc: 0.822 Test Loss: 0.717 Test Acc: 0.822
Validation loss decreased (-0.769729 --> -0.822361).  Saving model ...
Epoch: 16 cost time: 2.2935445308685303
Epoch: 16, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.659 Vali Acc: 0.849 Test Loss: 0.659 Test Acc: 0.849
Validation loss decreased (-0.822361 --> -0.848678).  Saving model ...
Epoch: 17 cost time: 2.164816379547119
Epoch: 17, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.605 Vali Acc: 0.868 Test Loss: 0.605 Test Acc: 0.868
Validation loss decreased (-0.848678 --> -0.868415).  Saving model ...
Epoch: 18 cost time: 2.045330047607422
Epoch: 18, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.559 Vali Acc: 0.868 Test Loss: 0.559 Test Acc: 0.868
Validation loss decreased (-0.868415 --> -0.868415).  Saving model ...
Epoch: 19 cost time: 2.3411731719970703
Epoch: 19, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.517 Vali Acc: 0.868 Test Loss: 0.517 Test Acc: 0.868
Validation loss decreased (-0.868415 --> -0.868416).  Saving model ...
Epoch: 20 cost time: 2.0082015991210938
Epoch: 20, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.477 Vali Acc: 0.868 Test Loss: 0.477 Test Acc: 0.868
Validation loss decreased (-0.868416 --> -0.868416).  Saving model ...
Epoch: 21 cost time: 2.2824604511260986
Epoch: 21, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.443 Vali Acc: 0.882 Test Loss: 0.443 Test Acc: 0.882
Validation loss decreased (-0.868416 --> -0.881575).  Saving model ...
Epoch: 22 cost time: 2.7625341415405273
Epoch: 22, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4124341011047363
Epoch: 23, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.395 Vali Acc: 0.868 Test Loss: 0.395 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.569322109222412
Epoch: 24, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.792233943939209
Epoch: 25, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.433295965194702
Epoch: 26, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.346 Vali Acc: 0.868 Test Loss: 0.346 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.649034023284912
Epoch: 27, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.6512961387634277
Epoch: 28, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1289966106414795
Epoch: 29, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.322 Vali Acc: 0.868 Test Loss: 0.322 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.4600722789764404
Epoch: 30, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.317 Vali Acc: 0.868 Test Loss: 0.317 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 131716
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6530990600585938
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.383 Vali Acc: 0.243 Test Loss: 1.383 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.3399453163146973
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.362 Vali Acc: 0.276 Test Loss: 1.362 Test Acc: 0.276
Validation loss decreased (-0.243407 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 2.421389102935791
Epoch: 3, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.334 Vali Acc: 0.322 Test Loss: 1.334 Test Acc: 0.322
Validation loss decreased (-0.276302 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 2.4172089099884033
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
Validation loss decreased (-0.322355 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 2.728391647338867
Epoch: 5, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.270 Vali Acc: 0.461 Test Loss: 1.270 Test Acc: 0.461
Validation loss decreased (-0.374987 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 2.5182387828826904
Epoch: 6, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.235 Vali Acc: 0.513 Test Loss: 1.235 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 2.455561399459839
Epoch: 7, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.199 Vali Acc: 0.546 Test Loss: 1.199 Test Acc: 0.546
Validation loss decreased (-0.513146 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 2.7232775688171387
Epoch: 8, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.161 Vali Acc: 0.579 Test Loss: 1.161 Test Acc: 0.579
Validation loss decreased (-0.546041 --> -0.578936).  Saving model ...
Epoch: 9 cost time: 2.5334057807922363
Epoch: 9, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.118 Vali Acc: 0.632 Test Loss: 1.118 Test Acc: 0.632
Validation loss decreased (-0.578936 --> -0.631568).  Saving model ...
Epoch: 10 cost time: 2.5301105976104736
Epoch: 10, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.075 Vali Acc: 0.651 Test Loss: 1.075 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651305).  Saving model ...
Epoch: 11 cost time: 2.721222162246704
Epoch: 11, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.025 Vali Acc: 0.645 Test Loss: 1.025 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3834917545318604
Epoch: 12, Steps: 10 | Train Loss: 0.928 Vali Loss: 0.974 Vali Acc: 0.658 Test Loss: 0.974 Test Acc: 0.658
Validation loss decreased (-0.651305 --> -0.657885).  Saving model ...
Epoch: 13 cost time: 2.229184865951538
Epoch: 13, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.919 Vali Acc: 0.697 Test Loss: 0.919 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697359).  Saving model ...
Epoch: 14 cost time: 1.6114857196807861
Epoch: 14, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.864 Vali Acc: 0.711 Test Loss: 0.864 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 1.4965155124664307
Epoch: 15, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.802 Vali Acc: 0.743 Test Loss: 0.802 Test Acc: 0.743
Validation loss decreased (-0.710518 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 1.7838001251220703
Epoch: 16, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.742 Vali Acc: 0.776 Test Loss: 0.742 Test Acc: 0.776
Validation loss decreased (-0.743413 --> -0.776308).  Saving model ...
Epoch: 17 cost time: 1.7011752128601074
Epoch: 17, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.687 Vali Acc: 0.776 Test Loss: 0.687 Test Acc: 0.776
Validation loss decreased (-0.776308 --> -0.776309).  Saving model ...
Epoch: 18 cost time: 2.0952348709106445
Epoch: 18, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 19 cost time: 2.5731685161590576
Epoch: 19, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 2.5789735317230225
Epoch: 20, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 2.3452365398406982
Epoch: 21, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815785).  Saving model ...
Epoch: 22 cost time: 1.6639695167541504
Epoch: 22, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 23 cost time: 1.5068328380584717
Epoch: 23, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.436 Vali Acc: 0.816 Test Loss: 0.436 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2182064056396484
Epoch: 24, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.409 Vali Acc: 0.822 Test Loss: 0.409 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.9543838500976562
Epoch: 25, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.392 Vali Acc: 0.829 Test Loss: 0.392 Test Acc: 0.829
Validation loss decreased (-0.828943 --> -0.828943).  Saving model ...
Epoch: 26 cost time: 2.892303228378296
Epoch: 26, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.374 Vali Acc: 0.836 Test Loss: 0.374 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835523).  Saving model ...
Epoch: 27 cost time: 2.9545300006866455
Epoch: 27, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.363 Vali Acc: 0.836 Test Loss: 0.363 Test Acc: 0.836
Validation loss decreased (-0.835523 --> -0.835523).  Saving model ...
Epoch: 28 cost time: 2.8856425285339355
Epoch: 28, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.353 Vali Acc: 0.842 Test Loss: 0.353 Test Acc: 0.842
Validation loss decreased (-0.835523 --> -0.842102).  Saving model ...
Epoch: 29 cost time: 2.951313018798828
Epoch: 29, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.342 Vali Acc: 0.849 Test Loss: 0.342 Test Acc: 0.849
Validation loss decreased (-0.842102 --> -0.848681).  Saving model ...
Epoch: 30 cost time: 2.9951975345611572
Epoch: 30, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.334 Vali Acc: 0.862 Test Loss: 0.334 Test Acc: 0.862
Validation loss decreased (-0.848681 --> -0.861839).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 442180
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.84527587890625
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.376 Vali Acc: 0.329 Test Loss: 1.376 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.8601460456848145
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.358 Vali Acc: 0.349 Test Loss: 1.358 Test Acc: 0.349
Validation loss decreased (-0.328934 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 2.074150800704956
Epoch: 3, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.332 Vali Acc: 0.388 Test Loss: 1.332 Test Acc: 0.388
Validation loss decreased (-0.348671 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 2.0358405113220215
Epoch: 4, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.302 Vali Acc: 0.414 Test Loss: 1.302 Test Acc: 0.414
Validation loss decreased (-0.388145 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.9855561256408691
Epoch: 5, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.269 Vali Acc: 0.467 Test Loss: 1.269 Test Acc: 0.467
Validation loss decreased (-0.414461 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 2.0468227863311768
Epoch: 6, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.232 Vali Acc: 0.513 Test Loss: 1.232 Test Acc: 0.513
Validation loss decreased (-0.467093 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 1.9658751487731934
Epoch: 7, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.192 Vali Acc: 0.559 Test Loss: 1.192 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 2.0181639194488525
Epoch: 8, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.148 Vali Acc: 0.572 Test Loss: 1.148 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 2.0633764266967773
Epoch: 9, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.106 Vali Acc: 0.605 Test Loss: 1.106 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605252).  Saving model ...
Epoch: 10 cost time: 2.015622854232788
Epoch: 10, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.058 Vali Acc: 0.664 Test Loss: 1.058 Test Acc: 0.664
Validation loss decreased (-0.605252 --> -0.664463).  Saving model ...
Epoch: 11 cost time: 2.1541953086853027
Epoch: 11, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.008 Vali Acc: 0.704 Test Loss: 1.008 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703937).  Saving model ...
Epoch: 12 cost time: 1.9881627559661865
Epoch: 12, Steps: 10 | Train Loss: 0.950 Vali Loss: 0.960 Vali Acc: 0.737 Test Loss: 0.960 Test Acc: 0.737
Validation loss decreased (-0.703937 --> -0.736833).  Saving model ...
Epoch: 13 cost time: 2.18152117729187
Epoch: 13, Steps: 10 | Train Loss: 0.884 Vali Loss: 0.911 Vali Acc: 0.743 Test Loss: 0.911 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743412).  Saving model ...
Epoch: 14 cost time: 1.9579036235809326
Epoch: 14, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.856 Vali Acc: 0.763 Test Loss: 0.856 Test Acc: 0.763
Validation loss decreased (-0.743412 --> -0.763149).  Saving model ...
Epoch: 15 cost time: 2.2210941314697266
Epoch: 15, Steps: 10 | Train Loss: 0.791 Vali Loss: 0.806 Vali Acc: 0.803 Test Loss: 0.806 Test Acc: 0.803
Validation loss decreased (-0.763149 --> -0.802624).  Saving model ...
Epoch: 16 cost time: 2.289335250854492
Epoch: 16, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.752 Vali Acc: 0.816 Test Loss: 0.752 Test Acc: 0.816
Validation loss decreased (-0.802624 --> -0.815782).  Saving model ...
Epoch: 17 cost time: 2.223341464996338
Epoch: 17, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.697 Vali Acc: 0.842 Test Loss: 0.697 Test Acc: 0.842
Validation loss decreased (-0.815782 --> -0.842098).  Saving model ...
Epoch: 18 cost time: 2.132744073867798
Epoch: 18, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.649 Vali Acc: 0.855 Test Loss: 0.649 Test Acc: 0.855
Validation loss decreased (-0.842098 --> -0.855257).  Saving model ...
Epoch: 19 cost time: 2.1321611404418945
Epoch: 19, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.600 Vali Acc: 0.855 Test Loss: 0.600 Test Acc: 0.855
Validation loss decreased (-0.855257 --> -0.855257).  Saving model ...
Epoch: 20 cost time: 2.177696704864502
Epoch: 20, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.855257 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 2.2423384189605713
Epoch: 21, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.518 Vali Acc: 0.882 Test Loss: 0.518 Test Acc: 0.882
Validation loss decreased (-0.874994 --> -0.881574).  Saving model ...
Epoch: 22 cost time: 2.1131489276885986
Epoch: 22, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.485 Vali Acc: 0.888 Test Loss: 0.485 Test Acc: 0.888
Validation loss decreased (-0.881574 --> -0.888153).  Saving model ...
Epoch: 23 cost time: 2.2219741344451904
Epoch: 23, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.457 Vali Acc: 0.888 Test Loss: 0.457 Test Acc: 0.888
Validation loss decreased (-0.888153 --> -0.888153).  Saving model ...
Epoch: 24 cost time: 1.978097677230835
Epoch: 24, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.437 Vali Acc: 0.888 Test Loss: 0.437 Test Acc: 0.888
Validation loss decreased (-0.888153 --> -0.888154).  Saving model ...
Epoch: 25 cost time: 1.9854271411895752
Epoch: 25, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.418 Vali Acc: 0.895 Test Loss: 0.418 Test Acc: 0.895
Validation loss decreased (-0.888154 --> -0.894733).  Saving model ...
Epoch: 26 cost time: 1.752901315689087
Epoch: 26, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.400 Vali Acc: 0.882 Test Loss: 0.400 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9938108921051025
Epoch: 27, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.384 Vali Acc: 0.888 Test Loss: 0.384 Test Acc: 0.888
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0010030269622803
Epoch: 28, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9796795845031738
Epoch: 29, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.357 Vali Acc: 0.882 Test Loss: 0.357 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0809671878814697
Epoch: 30, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.346 Vali Acc: 0.888 Test Loss: 0.346 Test Acc: 0.888
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8947368421052632
model parameter : 131716
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.961903810501099
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.444 Vali Acc: 0.276 Test Loss: 1.444 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 2.6287221908569336
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.407 Vali Acc: 0.309 Test Loss: 1.407 Test Acc: 0.309
Validation loss decreased (-0.276301 --> -0.309196).  Saving model ...
Epoch: 3 cost time: 2.6860907077789307
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
Validation loss decreased (-0.309196 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 2.7249443531036377
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.306 Vali Acc: 0.382 Test Loss: 1.306 Test Acc: 0.382
Validation loss decreased (-0.374986 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 2.6211562156677246
Epoch: 5, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.246 Vali Acc: 0.441 Test Loss: 1.246 Test Acc: 0.441
Validation loss decreased (-0.381566 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 2.793480157852173
Epoch: 6, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
Validation loss decreased (-0.440777 --> -0.519725).  Saving model ...
Epoch: 7 cost time: 2.606482982635498
Epoch: 7, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.113 Vali Acc: 0.559 Test Loss: 1.113 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 2.7246437072753906
Epoch: 8, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.047 Vali Acc: 0.605 Test Loss: 1.047 Test Acc: 0.605
Validation loss decreased (-0.559199 --> -0.605253).  Saving model ...
Epoch: 9 cost time: 2.6882998943328857
Epoch: 9, Steps: 10 | Train Loss: 1.006 Vali Loss: 0.986 Vali Acc: 0.632 Test Loss: 0.986 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 2.124669075012207
Epoch: 10, Steps: 10 | Train Loss: 0.899 Vali Loss: 0.923 Vali Acc: 0.658 Test Loss: 0.923 Test Acc: 0.658
Validation loss decreased (-0.631569 --> -0.657886).  Saving model ...
Epoch: 11 cost time: 2.0950772762298584
Epoch: 11, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.864 Vali Acc: 0.671 Test Loss: 0.864 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 12 cost time: 2.4506940841674805
Epoch: 12, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.817 Vali Acc: 0.664 Test Loss: 0.817 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.500319719314575
Epoch: 13, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.769 Vali Acc: 0.697 Test Loss: 0.769 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 14 cost time: 2.3745381832122803
Epoch: 14, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.730 Vali Acc: 0.678 Test Loss: 0.730 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5462851524353027
Epoch: 15, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.688 Vali Acc: 0.704 Test Loss: 0.688 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 2.5828957557678223
Epoch: 16, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717099).  Saving model ...
Epoch: 17 cost time: 2.39996075630188
Epoch: 17, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.629 Vali Acc: 0.730 Test Loss: 0.629 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 18 cost time: 2.4880566596984863
Epoch: 18, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.616 Vali Acc: 0.730 Test Loss: 0.616 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 19 cost time: 2.9030261039733887
Epoch: 19, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 20 cost time: 2.746051073074341
Epoch: 20, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 2.6950604915618896
Epoch: 21, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.564340114593506
Epoch: 22, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
Validation loss decreased (-0.776310 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 2.66314959526062
Epoch: 23, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6840734481811523
Epoch: 24, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.775045394897461
Epoch: 25, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.8538196086883545
Epoch: 26, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.7493906021118164
Epoch: 27, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.659579277038574
Epoch: 28, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.651193380355835
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 30 cost time: 2.6260907649993896
Epoch: 30, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 881044
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.780932188034058
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.401 Vali Acc: 0.263 Test Loss: 1.401 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 2.1371383666992188
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.373 Vali Acc: 0.329 Test Loss: 1.373 Test Acc: 0.329
Validation loss decreased (-0.263144 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 2.1292717456817627
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.337 Vali Acc: 0.355 Test Loss: 1.337 Test Acc: 0.355
Validation loss decreased (-0.328934 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 2.238290309906006
Epoch: 4, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.297 Vali Acc: 0.388 Test Loss: 1.297 Test Acc: 0.388
Validation loss decreased (-0.355250 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 2.099027395248413
Epoch: 5, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.251 Vali Acc: 0.454 Test Loss: 1.251 Test Acc: 0.454
Validation loss decreased (-0.388145 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 2.345625162124634
Epoch: 6, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.199 Vali Acc: 0.520 Test Loss: 1.199 Test Acc: 0.520
Validation loss decreased (-0.453935 --> -0.519725).  Saving model ...
Epoch: 7 cost time: 2.208711624145508
Epoch: 7, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.150 Vali Acc: 0.566 Test Loss: 1.150 Test Acc: 0.566
Validation loss decreased (-0.519725 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 2.1490354537963867
Epoch: 8, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.093 Vali Acc: 0.638 Test Loss: 1.093 Test Acc: 0.638
Validation loss decreased (-0.565778 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 2.3450448513031006
Epoch: 9, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.035 Vali Acc: 0.658 Test Loss: 1.035 Test Acc: 0.658
Validation loss decreased (-0.638147 --> -0.657884).  Saving model ...
Epoch: 10 cost time: 2.280618190765381
Epoch: 10, Steps: 10 | Train Loss: 0.962 Vali Loss: 0.970 Vali Acc: 0.671 Test Loss: 0.970 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671043).  Saving model ...
Epoch: 11 cost time: 2.1123392581939697
Epoch: 11, Steps: 10 | Train Loss: 0.869 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
Validation loss decreased (-0.671043 --> -0.717096).  Saving model ...
Epoch: 12 cost time: 2.0468783378601074
Epoch: 12, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.846 Vali Acc: 0.743 Test Loss: 0.846 Test Acc: 0.743
Validation loss decreased (-0.717096 --> -0.743413).  Saving model ...
Epoch: 13 cost time: 2.2202072143554688
Epoch: 13, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.785 Vali Acc: 0.763 Test Loss: 0.785 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 14 cost time: 2.321699380874634
Epoch: 14, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.763150 --> -0.809203).  Saving model ...
Epoch: 15 cost time: 2.2995553016662598
Epoch: 15, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.685 Vali Acc: 0.822 Test Loss: 0.685 Test Acc: 0.822
Validation loss decreased (-0.809203 --> -0.822362).  Saving model ...
Epoch: 16 cost time: 2.1228952407836914
Epoch: 16, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.628 Vali Acc: 0.829 Test Loss: 0.628 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 17 cost time: 1.9911863803863525
Epoch: 17, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.005467176437378
Epoch: 18, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.550 Vali Acc: 0.842 Test Loss: 0.550 Test Acc: 0.842
Validation loss decreased (-0.828941 --> -0.842100).  Saving model ...
Epoch: 19 cost time: 2.2258658409118652
Epoch: 19, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1241445541381836
Epoch: 20, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.499 Vali Acc: 0.836 Test Loss: 0.499 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1605734825134277
Epoch: 21, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.483 Vali Acc: 0.836 Test Loss: 0.483 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.181004047393799
Epoch: 22, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9195291996002197
Epoch: 23, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.462 Vali Acc: 0.836 Test Loss: 0.462 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0238561630249023
Epoch: 24, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.463 Vali Acc: 0.842 Test Loss: 0.463 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 25 cost time: 2.022156238555908
Epoch: 25, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 26 cost time: 2.1189563274383545
Epoch: 26, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.426 Vali Acc: 0.842 Test Loss: 0.426 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1738874912261963
Epoch: 27, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.440 Vali Acc: 0.849 Test Loss: 0.440 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.155317783355713
Epoch: 28, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.455 Vali Acc: 0.829 Test Loss: 0.455 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.223499298095703
Epoch: 29, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.461 Vali Acc: 0.849 Test Loss: 0.461 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.114668846130371
Epoch: 30, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 260068
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.063376188278198
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.444 Vali Acc: 0.276 Test Loss: 1.444 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 2.2843008041381836
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.404 Vali Acc: 0.316 Test Loss: 1.404 Test Acc: 0.316
Validation loss decreased (-0.276301 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 2.2363741397857666
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.353 Vali Acc: 0.355 Test Loss: 1.353 Test Acc: 0.355
Validation loss decreased (-0.315775 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 2.2446746826171875
Epoch: 4, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.296 Vali Acc: 0.388 Test Loss: 1.296 Test Acc: 0.388
Validation loss decreased (-0.355250 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 2.1300253868103027
Epoch: 5, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.233 Vali Acc: 0.447 Test Loss: 1.233 Test Acc: 0.447
Validation loss decreased (-0.388145 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 2.279519557952881
Epoch: 6, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.174 Vali Acc: 0.513 Test Loss: 1.174 Test Acc: 0.513
Validation loss decreased (-0.447356 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 2.0156044960021973
Epoch: 7, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.113 Vali Acc: 0.592 Test Loss: 1.113 Test Acc: 0.592
Validation loss decreased (-0.513146 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 2.1692721843719482
Epoch: 8, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.057 Vali Acc: 0.605 Test Loss: 1.057 Test Acc: 0.605
Validation loss decreased (-0.592094 --> -0.605253).  Saving model ...
Epoch: 9 cost time: 2.1724109649658203
Epoch: 9, Steps: 10 | Train Loss: 0.999 Vali Loss: 0.998 Vali Acc: 0.625 Test Loss: 0.998 Test Acc: 0.625
Validation loss decreased (-0.605253 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 2.016944408416748
Epoch: 10, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.931 Vali Acc: 0.658 Test Loss: 0.931 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657885).  Saving model ...
Epoch: 11 cost time: 1.954169511795044
Epoch: 11, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.868 Vali Acc: 0.691 Test Loss: 0.868 Test Acc: 0.691
Validation loss decreased (-0.657885 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 2.0480165481567383
Epoch: 12, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.822 Vali Acc: 0.678 Test Loss: 0.822 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.036892890930176
Epoch: 13, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.773 Vali Acc: 0.691 Test Loss: 0.773 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 14 cost time: 2.045198678970337
Epoch: 14, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.729 Vali Acc: 0.697 Test Loss: 0.729 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 15 cost time: 2.2100460529327393
Epoch: 15, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.682 Vali Acc: 0.711 Test Loss: 0.682 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 2.447161912918091
Epoch: 16, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.657 Vali Acc: 0.724 Test Loss: 0.657 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 17 cost time: 2.093808889389038
Epoch: 17, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.616 Vali Acc: 0.730 Test Loss: 0.616 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 18 cost time: 2.2307512760162354
Epoch: 18, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 19 cost time: 2.287364959716797
Epoch: 19, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.461263656616211
Epoch: 20, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 2.444633960723877
Epoch: 21, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 2.3845465183258057
Epoch: 22, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 2.0908334255218506
Epoch: 23, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1507105827331543
Epoch: 24, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.222303628921509
Epoch: 25, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2764205932617188
Epoch: 26, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 27 cost time: 2.169853925704956
Epoch: 27, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.141519784927368
Epoch: 28, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.266072988510132
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.193019390106201
Epoch: 30, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 881044
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5345964431762695
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.403 Vali Acc: 0.283 Test Loss: 1.403 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.810361385345459
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.375 Vali Acc: 0.336 Test Loss: 1.375 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.752478837966919
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.337 Vali Acc: 0.368 Test Loss: 1.337 Test Acc: 0.368
Validation loss decreased (-0.335513 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.799126148223877
Epoch: 4, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.296 Vali Acc: 0.401 Test Loss: 1.296 Test Acc: 0.401
Validation loss decreased (-0.368408 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 1.895205020904541
Epoch: 5, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.249 Vali Acc: 0.461 Test Loss: 1.249 Test Acc: 0.461
Validation loss decreased (-0.401303 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 1.987441062927246
Epoch: 6, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.200 Vali Acc: 0.513 Test Loss: 1.200 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 1.8441722393035889
Epoch: 7, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.150 Vali Acc: 0.559 Test Loss: 1.150 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 1.9446561336517334
Epoch: 8, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.094 Vali Acc: 0.599 Test Loss: 1.094 Test Acc: 0.599
Validation loss decreased (-0.559199 --> -0.598673).  Saving model ...
Epoch: 9 cost time: 2.073093891143799
Epoch: 9, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.038 Vali Acc: 0.638 Test Loss: 1.038 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 1.8717436790466309
Epoch: 10, Steps: 10 | Train Loss: 0.963 Vali Loss: 0.976 Vali Acc: 0.664 Test Loss: 0.976 Test Acc: 0.664
Validation loss decreased (-0.638148 --> -0.664464).  Saving model ...
Epoch: 11 cost time: 1.9083476066589355
Epoch: 11, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.914 Vali Acc: 0.704 Test Loss: 0.914 Test Acc: 0.704
Validation loss decreased (-0.664464 --> -0.703938).  Saving model ...
Epoch: 12 cost time: 2.0296523571014404
Epoch: 12, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
Validation loss decreased (-0.703938 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.8858039379119873
Epoch: 13, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.804 Vali Acc: 0.757 Test Loss: 0.804 Test Acc: 0.757
Validation loss decreased (-0.749991 --> -0.756571).  Saving model ...
Epoch: 14 cost time: 1.9244518280029297
Epoch: 14, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.754 Vali Acc: 0.783 Test Loss: 0.754 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782887).  Saving model ...
Epoch: 15 cost time: 1.5970356464385986
Epoch: 15, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.708 Vali Acc: 0.789 Test Loss: 0.708 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 16 cost time: 2.024644136428833
Epoch: 16, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 2.0095791816711426
Epoch: 17, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.628 Vali Acc: 0.776 Test Loss: 0.628 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9583978652954102
Epoch: 18, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.012263059616089
Epoch: 19, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8359365463256836
Epoch: 20, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.737936019897461
Epoch: 21, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
Validation loss decreased (-0.802625 --> -0.828942).  Saving model ...
Epoch: 22 cost time: 1.7191805839538574
Epoch: 22, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0448496341705322
Epoch: 23, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 24 cost time: 2.068265914916992
Epoch: 24, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.04144549369812
Epoch: 25, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.476 Vali Acc: 0.822 Test Loss: 0.476 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9705431461334229
Epoch: 26, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 27 cost time: 2.0594418048858643
Epoch: 27, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.456 Vali Acc: 0.829 Test Loss: 0.456 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.120453119277954
Epoch: 28, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9916622638702393
Epoch: 29, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3184146881103516
Epoch: 30, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.478 Vali Acc: 0.836 Test Loss: 0.478 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 260068
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.240532875061035
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.453 Vali Acc: 0.257 Test Loss: 1.453 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 1.9803838729858398
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.430 Vali Acc: 0.283 Test Loss: 1.430 Test Acc: 0.283
Validation loss decreased (-0.256564 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 2.1596615314483643
Epoch: 3, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.396 Vali Acc: 0.342 Test Loss: 1.396 Test Acc: 0.342
Validation loss decreased (-0.282880 --> -0.342091).  Saving model ...
Epoch: 4 cost time: 2.232239007949829
Epoch: 4, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.362 Vali Acc: 0.382 Test Loss: 1.362 Test Acc: 0.382
Validation loss decreased (-0.342091 --> -0.381565).  Saving model ...
Epoch: 5 cost time: 2.260322093963623
Epoch: 5, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.325 Vali Acc: 0.395 Test Loss: 1.325 Test Acc: 0.395
Validation loss decreased (-0.381565 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 2.2498672008514404
Epoch: 6, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.292 Vali Acc: 0.428 Test Loss: 1.292 Test Acc: 0.428
Validation loss decreased (-0.394724 --> -0.427619).  Saving model ...
Epoch: 7 cost time: 2.153860092163086
Epoch: 7, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.269 Vali Acc: 0.461 Test Loss: 1.269 Test Acc: 0.461
Validation loss decreased (-0.427619 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 2.091156005859375
Epoch: 8, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.236 Vali Acc: 0.493 Test Loss: 1.236 Test Acc: 0.493
Validation loss decreased (-0.460514 --> -0.493409).  Saving model ...
Epoch: 9 cost time: 2.094022035598755
Epoch: 9, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.201 Vali Acc: 0.526 Test Loss: 1.201 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 10 cost time: 1.8977210521697998
Epoch: 10, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.168 Vali Acc: 0.539 Test Loss: 1.168 Test Acc: 0.539
Validation loss decreased (-0.526304 --> -0.539462).  Saving model ...
Epoch: 11 cost time: 1.4892585277557373
Epoch: 11, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.124 Vali Acc: 0.572 Test Loss: 1.124 Test Acc: 0.572
Validation loss decreased (-0.539462 --> -0.572357).  Saving model ...
Epoch: 12 cost time: 1.4832048416137695
Epoch: 12, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.090 Vali Acc: 0.586 Test Loss: 1.090 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 13 cost time: 1.5122122764587402
Epoch: 13, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.054 Vali Acc: 0.599 Test Loss: 1.054 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 14 cost time: 1.4095127582550049
Epoch: 14, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.030 Vali Acc: 0.618 Test Loss: 1.030 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618411).  Saving model ...
Epoch: 15 cost time: 1.794245958328247
Epoch: 15, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.004 Vali Acc: 0.651 Test Loss: 1.004 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651306).  Saving model ...
Epoch: 16 cost time: 2.0454957485198975
Epoch: 16, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.970 Vali Acc: 0.664 Test Loss: 0.970 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664464).  Saving model ...
Epoch: 17 cost time: 1.7879745960235596
Epoch: 17, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.972 Vali Acc: 0.684 Test Loss: 0.972 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 18 cost time: 1.1457977294921875
Epoch: 18, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.908 Vali Acc: 0.691 Test Loss: 0.908 Test Acc: 0.691
Validation loss decreased (-0.684201 --> -0.690780).  Saving model ...
Epoch: 19 cost time: 1.829880714416504
Epoch: 19, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.865 Vali Acc: 0.697 Test Loss: 0.865 Test Acc: 0.697
Validation loss decreased (-0.690780 --> -0.697360).  Saving model ...
Epoch: 20 cost time: 1.9425818920135498
Epoch: 20, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.846 Vali Acc: 0.743 Test Loss: 0.846 Test Acc: 0.743
Validation loss decreased (-0.697360 --> -0.743413).  Saving model ...
Epoch: 21 cost time: 1.6676549911499023
Epoch: 21, Steps: 10 | Train Loss: 0.704 Vali Loss: 0.817 Vali Acc: 0.711 Test Loss: 0.817 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8983497619628906
Epoch: 22, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7464227676391602
Epoch: 23, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.703 Vali Acc: 0.730 Test Loss: 0.703 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.745861530303955
Epoch: 24, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.683 Vali Acc: 0.724 Test Loss: 0.683 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5952458381652832
Epoch: 25, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.655 Vali Acc: 0.730 Test Loss: 0.655 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7796807289123535
Epoch: 26, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.623 Vali Acc: 0.730 Test Loss: 0.623 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.797231912612915
Epoch: 27, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.603 Vali Acc: 0.737 Test Loss: 0.603 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7256340980529785
Epoch: 28, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.7100543975830078
Epoch: 29, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 30 cost time: 1.89207124710083
Epoch: 30, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 881044
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.275113821029663
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.6024229526519775
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.402 Vali Acc: 0.283 Test Loss: 1.402 Test Acc: 0.283
Validation loss decreased (-0.256565 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.6073105335235596
Epoch: 3, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.381 Vali Acc: 0.309 Test Loss: 1.381 Test Acc: 0.309
Validation loss decreased (-0.282881 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 1.6034176349639893
Epoch: 4, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.355 Vali Acc: 0.322 Test Loss: 1.355 Test Acc: 0.322
Validation loss decreased (-0.309197 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 1.426569938659668
Epoch: 5, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.323 Vali Acc: 0.382 Test Loss: 1.323 Test Acc: 0.382
Validation loss decreased (-0.322355 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 1.6675269603729248
Epoch: 6, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.288 Vali Acc: 0.467 Test Loss: 1.288 Test Acc: 0.467
Validation loss decreased (-0.381566 --> -0.467092).  Saving model ...
Epoch: 7 cost time: 1.5887336730957031
Epoch: 7, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
Validation loss decreased (-0.467092 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 1.62308931350708
Epoch: 8, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.217 Vali Acc: 0.507 Test Loss: 1.217 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 9 cost time: 1.6216394901275635
Epoch: 9, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.176 Vali Acc: 0.579 Test Loss: 1.176 Test Acc: 0.579
Validation loss decreased (-0.506567 --> -0.578936).  Saving model ...
Epoch: 10 cost time: 1.7250707149505615
Epoch: 10, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.135 Vali Acc: 0.612 Test Loss: 1.135 Test Acc: 0.612
Validation loss decreased (-0.578936 --> -0.611831).  Saving model ...
Epoch: 11 cost time: 1.8642005920410156
Epoch: 11, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.088 Vali Acc: 0.638 Test Loss: 1.088 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638147).  Saving model ...
Epoch: 12 cost time: 1.7087104320526123
Epoch: 12, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.042 Vali Acc: 0.704 Test Loss: 1.042 Test Acc: 0.704
Validation loss decreased (-0.638147 --> -0.703937).  Saving model ...
Epoch: 13 cost time: 1.8305590152740479
Epoch: 13, Steps: 10 | Train Loss: 0.961 Vali Loss: 0.999 Vali Acc: 0.737 Test Loss: 0.999 Test Acc: 0.737
Validation loss decreased (-0.703937 --> -0.736832).  Saving model ...
Epoch: 14 cost time: 1.8543429374694824
Epoch: 14, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.963 Vali Acc: 0.743 Test Loss: 0.963 Test Acc: 0.743
Validation loss decreased (-0.736832 --> -0.743411).  Saving model ...
Epoch: 15 cost time: 1.876530647277832
Epoch: 15, Steps: 10 | Train Loss: 0.881 Vali Loss: 0.922 Vali Acc: 0.737 Test Loss: 0.922 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9580495357513428
Epoch: 16, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.889 Vali Acc: 0.737 Test Loss: 0.889 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9345180988311768
Epoch: 17, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.841 Vali Acc: 0.757 Test Loss: 0.841 Test Acc: 0.757
Validation loss decreased (-0.743411 --> -0.756571).  Saving model ...
Epoch: 18 cost time: 1.993919849395752
Epoch: 18, Steps: 10 | Train Loss: 0.718 Vali Loss: 0.800 Vali Acc: 0.789 Test Loss: 0.800 Test Acc: 0.789
Validation loss decreased (-0.756571 --> -0.789466).  Saving model ...
Epoch: 19 cost time: 1.7020800113677979
Epoch: 19, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.764 Vali Acc: 0.776 Test Loss: 0.764 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9172191619873047
Epoch: 20, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.725 Vali Acc: 0.796 Test Loss: 0.725 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 21 cost time: 1.9546175003051758
Epoch: 21, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.713 Vali Acc: 0.796 Test Loss: 0.713 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796045).  Saving model ...
Epoch: 22 cost time: 1.7660937309265137
Epoch: 22, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802625).  Saving model ...
Epoch: 23 cost time: 1.6759207248687744
Epoch: 23, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.655 Vali Acc: 0.816 Test Loss: 0.655 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 24 cost time: 1.6902050971984863
Epoch: 24, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 25 cost time: 1.7871778011322021
Epoch: 25, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815784).  Saving model ...
Epoch: 26 cost time: 1.465254545211792
Epoch: 26, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 27 cost time: 1.6339917182922363
Epoch: 27, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.713897943496704
Epoch: 28, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5547819137573242
Epoch: 29, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7049999237060547
Epoch: 30, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 260068
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.054601430892944
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.412 Vali Acc: 0.211 Test Loss: 1.412 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 2.377819299697876
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.383 Vali Acc: 0.230 Test Loss: 1.383 Test Acc: 0.230
Validation loss decreased (-0.210512 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 2.349496841430664
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.344 Vali Acc: 0.276 Test Loss: 1.344 Test Acc: 0.276
Validation loss decreased (-0.230249 --> -0.276302).  Saving model ...
Epoch: 4 cost time: 2.514827013015747
Epoch: 4, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.302 Vali Acc: 0.322 Test Loss: 1.302 Test Acc: 0.322
Validation loss decreased (-0.276302 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 2.412895917892456
Epoch: 5, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.254 Vali Acc: 0.421 Test Loss: 1.254 Test Acc: 0.421
Validation loss decreased (-0.322355 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 2.353584051132202
Epoch: 6, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.202 Vali Acc: 0.487 Test Loss: 1.202 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486830).  Saving model ...
Epoch: 7 cost time: 2.357548952102661
Epoch: 7, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.148 Vali Acc: 0.533 Test Loss: 1.148 Test Acc: 0.533
Validation loss decreased (-0.486830 --> -0.532883).  Saving model ...
Epoch: 8 cost time: 2.3532118797302246
Epoch: 8, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.092 Vali Acc: 0.553 Test Loss: 1.092 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552621).  Saving model ...
Epoch: 9 cost time: 2.1580917835235596
Epoch: 9, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.032 Vali Acc: 0.599 Test Loss: 1.032 Test Acc: 0.599
Validation loss decreased (-0.552621 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 2.3487865924835205
Epoch: 10, Steps: 10 | Train Loss: 0.992 Vali Loss: 0.973 Vali Acc: 0.651 Test Loss: 0.973 Test Acc: 0.651
Validation loss decreased (-0.598674 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 2.259342670440674
Epoch: 11, Steps: 10 | Train Loss: 0.932 Vali Loss: 0.916 Vali Acc: 0.704 Test Loss: 0.916 Test Acc: 0.704
Validation loss decreased (-0.651306 --> -0.703938).  Saving model ...
Epoch: 12 cost time: 2.097294807434082
Epoch: 12, Steps: 10 | Train Loss: 0.855 Vali Loss: 0.858 Vali Acc: 0.730 Test Loss: 0.858 Test Acc: 0.730
Validation loss decreased (-0.703938 --> -0.730255).  Saving model ...
Epoch: 13 cost time: 2.110126256942749
Epoch: 13, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.803 Vali Acc: 0.737 Test Loss: 0.803 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736834).  Saving model ...
Epoch: 14 cost time: 2.080948829650879
Epoch: 14, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.755 Vali Acc: 0.743 Test Loss: 0.755 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 15 cost time: 2.1139414310455322
Epoch: 15, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.717 Vali Acc: 0.763 Test Loss: 0.717 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 2.0235090255737305
Epoch: 16, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
Validation loss decreased (-0.763151 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 2.0891530513763428
Epoch: 17, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 2.151688575744629
Epoch: 18, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 2.1580729484558105
Epoch: 19, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 2.151561975479126
Epoch: 20, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.7976047992706299
Epoch: 21, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.516 Vali Acc: 0.829 Test Loss: 0.516 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 22 cost time: 1.5816121101379395
Epoch: 22, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.505 Vali Acc: 0.842 Test Loss: 0.505 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842100).  Saving model ...
Epoch: 23 cost time: 1.7876570224761963
Epoch: 23, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7121312618255615
Epoch: 24, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.458 Vali Acc: 0.849 Test Loss: 0.458 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 25 cost time: 2.175837993621826
Epoch: 25, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 26 cost time: 2.2449045181274414
Epoch: 26, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.441 Vali Acc: 0.829 Test Loss: 0.441 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5086727142333984
Epoch: 27, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.476 Vali Acc: 0.829 Test Loss: 0.476 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1008896827697754
Epoch: 28, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.508 Vali Acc: 0.829 Test Loss: 0.508 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.509777545928955
Epoch: 29, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.528837203979492
Epoch: 30, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.483 Vali Acc: 0.836 Test Loss: 0.483 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 441172
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.520864725112915
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.442 Vali Acc: 0.211 Test Loss: 1.442 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 1.708681583404541
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.423 Vali Acc: 0.230 Test Loss: 1.423 Test Acc: 0.230
Validation loss decreased (-0.210512 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 1.807588815689087
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.400 Vali Acc: 0.263 Test Loss: 1.400 Test Acc: 0.263
Validation loss decreased (-0.230249 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 1.9086172580718994
Epoch: 4, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.374 Vali Acc: 0.309 Test Loss: 1.374 Test Acc: 0.309
Validation loss decreased (-0.263144 --> -0.309197).  Saving model ...
Epoch: 5 cost time: 1.8450469970703125
Epoch: 5, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.344 Vali Acc: 0.382 Test Loss: 1.344 Test Acc: 0.382
Validation loss decreased (-0.309197 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 1.7811696529388428
Epoch: 6, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.311 Vali Acc: 0.421 Test Loss: 1.311 Test Acc: 0.421
Validation loss decreased (-0.381566 --> -0.421040).  Saving model ...
Epoch: 7 cost time: 1.810232162475586
Epoch: 7, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.276 Vali Acc: 0.487 Test Loss: 1.276 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486829).  Saving model ...
Epoch: 8 cost time: 1.8537280559539795
Epoch: 8, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.242 Vali Acc: 0.553 Test Loss: 1.242 Test Acc: 0.553
Validation loss decreased (-0.486829 --> -0.552619).  Saving model ...
Epoch: 9 cost time: 1.8961162567138672
Epoch: 9, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.203 Vali Acc: 0.599 Test Loss: 1.203 Test Acc: 0.599
Validation loss decreased (-0.552619 --> -0.598672).  Saving model ...
Epoch: 10 cost time: 1.8604342937469482
Epoch: 10, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.162 Vali Acc: 0.638 Test Loss: 1.162 Test Acc: 0.638
Validation loss decreased (-0.598672 --> -0.638146).  Saving model ...
Epoch: 11 cost time: 1.8102142810821533
Epoch: 11, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.120 Vali Acc: 0.645 Test Loss: 1.120 Test Acc: 0.645
Validation loss decreased (-0.638146 --> -0.644726).  Saving model ...
Epoch: 12 cost time: 1.895761489868164
Epoch: 12, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.078 Vali Acc: 0.691 Test Loss: 1.078 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690779).  Saving model ...
Epoch: 13 cost time: 1.9443087577819824
Epoch: 13, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.034 Vali Acc: 0.711 Test Loss: 1.034 Test Acc: 0.711
Validation loss decreased (-0.690779 --> -0.710516).  Saving model ...
Epoch: 14 cost time: 1.957352876663208
Epoch: 14, Steps: 10 | Train Loss: 0.931 Vali Loss: 0.985 Vali Acc: 0.730 Test Loss: 0.985 Test Acc: 0.730
Validation loss decreased (-0.710516 --> -0.730253).  Saving model ...
Epoch: 15 cost time: 1.993894338607788
Epoch: 15, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.934 Vali Acc: 0.763 Test Loss: 0.934 Test Acc: 0.763
Validation loss decreased (-0.730253 --> -0.763149).  Saving model ...
Epoch: 16 cost time: 2.030637502670288
Epoch: 16, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.879 Vali Acc: 0.783 Test Loss: 0.879 Test Acc: 0.783
Validation loss decreased (-0.763149 --> -0.782886).  Saving model ...
Epoch: 17 cost time: 1.8856542110443115
Epoch: 17, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.827 Vali Acc: 0.796 Test Loss: 0.827 Test Acc: 0.796
Validation loss decreased (-0.782886 --> -0.796044).  Saving model ...
Epoch: 18 cost time: 1.901305913925171
Epoch: 18, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
Validation loss decreased (-0.796044 --> -0.802624).  Saving model ...
Epoch: 19 cost time: 1.9254989624023438
Epoch: 19, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.017340898513794
Epoch: 20, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
Validation loss decreased (-0.802624 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 1.9097917079925537
Epoch: 21, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.615 Vali Acc: 0.816 Test Loss: 0.615 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 22 cost time: 2.003674030303955
Epoch: 22, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822363).  Saving model ...
Epoch: 23 cost time: 1.9261493682861328
Epoch: 23, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7327675819396973
Epoch: 24, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5870051383972168
Epoch: 25, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8566169738769531
Epoch: 26, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8883543014526367
Epoch: 27, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.811018943786621
Epoch: 28, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 29 cost time: 1.7871949672698975
Epoch: 29, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8947885036468506
Epoch: 30, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 130660
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7213103771209717
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.410 Vali Acc: 0.204 Test Loss: 1.410 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 1.5844340324401855
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.380 Vali Acc: 0.224 Test Loss: 1.380 Test Acc: 0.224
Validation loss decreased (-0.203933 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 1.7375702857971191
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.340 Vali Acc: 0.283 Test Loss: 1.340 Test Acc: 0.283
Validation loss decreased (-0.223670 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 2.082991361618042
Epoch: 4, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.299 Vali Acc: 0.329 Test Loss: 1.299 Test Acc: 0.329
Validation loss decreased (-0.282881 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 1.8834223747253418
Epoch: 5, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.252 Vali Acc: 0.395 Test Loss: 1.252 Test Acc: 0.395
Validation loss decreased (-0.328934 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 1.9370508193969727
Epoch: 6, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.198 Vali Acc: 0.467 Test Loss: 1.198 Test Acc: 0.467
Validation loss decreased (-0.394724 --> -0.467093).  Saving model ...
Epoch: 7 cost time: 1.9756264686584473
Epoch: 7, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.143 Vali Acc: 0.507 Test Loss: 1.143 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506568).  Saving model ...
Epoch: 8 cost time: 2.033179759979248
Epoch: 8, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.088 Vali Acc: 0.572 Test Loss: 1.088 Test Acc: 0.572
Validation loss decreased (-0.506568 --> -0.572358).  Saving model ...
Epoch: 9 cost time: 1.9662573337554932
Epoch: 9, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.029 Vali Acc: 0.612 Test Loss: 1.029 Test Acc: 0.612
Validation loss decreased (-0.572358 --> -0.611832).  Saving model ...
Epoch: 10 cost time: 1.983933687210083
Epoch: 10, Steps: 10 | Train Loss: 1.023 Vali Loss: 0.971 Vali Acc: 0.651 Test Loss: 0.971 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 1.8605444431304932
Epoch: 11, Steps: 10 | Train Loss: 0.938 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
Validation loss decreased (-0.651306 --> -0.717096).  Saving model ...
Epoch: 12 cost time: 2.0496747493743896
Epoch: 12, Steps: 10 | Train Loss: 0.869 Vali Loss: 0.859 Vali Acc: 0.724 Test Loss: 0.859 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723676).  Saving model ...
Epoch: 13 cost time: 1.9495322704315186
Epoch: 13, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.807 Vali Acc: 0.743 Test Loss: 0.807 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743413).  Saving model ...
Epoch: 14 cost time: 2.0155351161956787
Epoch: 14, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.758 Vali Acc: 0.763 Test Loss: 0.758 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 15 cost time: 2.012701988220215
Epoch: 15, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.715 Vali Acc: 0.776 Test Loss: 0.715 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 1.9590857028961182
Epoch: 16, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
Validation loss decreased (-0.776309 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 1.9697649478912354
Epoch: 17, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.018693685531616
Epoch: 18, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9000763893127441
Epoch: 19, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 2.1317238807678223
Epoch: 20, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.9482221603393555
Epoch: 21, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.924471139907837
Epoch: 22, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9185047149658203
Epoch: 23, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 24 cost time: 1.8995893001556396
Epoch: 24, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 25 cost time: 2.016451835632324
Epoch: 25, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.473 Vali Acc: 0.849 Test Loss: 0.473 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848679).  Saving model ...
Epoch: 26 cost time: 1.9396147727966309
Epoch: 26, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.444 Vali Acc: 0.849 Test Loss: 0.444 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 27 cost time: 2.2872631549835205
Epoch: 27, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.465 Vali Acc: 0.829 Test Loss: 0.465 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0738353729248047
Epoch: 28, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.453922748565674
Epoch: 29, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.522 Vali Acc: 0.829 Test Loss: 0.522 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.148031234741211
Epoch: 30, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 441172
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4636025428771973
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.438 Vali Acc: 0.224 Test Loss: 1.438 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.7207212448120117
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.420 Vali Acc: 0.237 Test Loss: 1.420 Test Acc: 0.237
Validation loss decreased (-0.223670 --> -0.236828).  Saving model ...
Epoch: 3 cost time: 1.7250251770019531
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.397 Vali Acc: 0.263 Test Loss: 1.397 Test Acc: 0.263
Validation loss decreased (-0.236828 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 1.7487146854400635
Epoch: 4, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.371 Vali Acc: 0.309 Test Loss: 1.371 Test Acc: 0.309
Validation loss decreased (-0.263144 --> -0.309197).  Saving model ...
Epoch: 5 cost time: 1.7388193607330322
Epoch: 5, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.7758491039276123
Epoch: 6, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.310 Vali Acc: 0.401 Test Loss: 1.310 Test Acc: 0.401
Validation loss decreased (-0.374987 --> -0.401303).  Saving model ...
Epoch: 7 cost time: 1.8010737895965576
Epoch: 7, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.274 Vali Acc: 0.467 Test Loss: 1.274 Test Acc: 0.467
Validation loss decreased (-0.401303 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 1.6523809432983398
Epoch: 8, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.238 Vali Acc: 0.526 Test Loss: 1.238 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526303).  Saving model ...
Epoch: 9 cost time: 1.6978635787963867
Epoch: 9, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.199 Vali Acc: 0.605 Test Loss: 1.199 Test Acc: 0.605
Validation loss decreased (-0.526303 --> -0.605251).  Saving model ...
Epoch: 10 cost time: 1.5087921619415283
Epoch: 10, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.157 Vali Acc: 0.632 Test Loss: 1.157 Test Acc: 0.632
Validation loss decreased (-0.605251 --> -0.631567).  Saving model ...
Epoch: 11 cost time: 1.4672842025756836
Epoch: 11, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.114 Vali Acc: 0.671 Test Loss: 1.114 Test Acc: 0.671
Validation loss decreased (-0.631567 --> -0.671041).  Saving model ...
Epoch: 12 cost time: 1.6795244216918945
Epoch: 12, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.069 Vali Acc: 0.697 Test Loss: 1.069 Test Acc: 0.697
Validation loss decreased (-0.671041 --> -0.697358).  Saving model ...
Epoch: 13 cost time: 1.6075491905212402
Epoch: 13, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
Validation loss decreased (-0.697358 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.5759739875793457
Epoch: 14, Steps: 10 | Train Loss: 0.921 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 1.6136353015899658
Epoch: 15, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.914 Vali Acc: 0.776 Test Loss: 0.914 Test Acc: 0.776
Validation loss decreased (-0.749990 --> -0.776307).  Saving model ...
Epoch: 16 cost time: 1.6934001445770264
Epoch: 16, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.855 Vali Acc: 0.816 Test Loss: 0.855 Test Acc: 0.816
Validation loss decreased (-0.776307 --> -0.815781).  Saving model ...
Epoch: 17 cost time: 1.6596336364746094
Epoch: 17, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.800 Vali Acc: 0.822 Test Loss: 0.800 Test Acc: 0.822
Validation loss decreased (-0.815781 --> -0.822360).  Saving model ...
Epoch: 18 cost time: 1.73325777053833
Epoch: 18, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.748 Vali Acc: 0.822 Test Loss: 0.748 Test Acc: 0.822
Validation loss decreased (-0.822360 --> -0.822361).  Saving model ...
Epoch: 19 cost time: 1.672741413116455
Epoch: 19, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.698 Vali Acc: 0.829 Test Loss: 0.698 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828940).  Saving model ...
Epoch: 20 cost time: 1.7362477779388428
Epoch: 20, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.649 Vali Acc: 0.829 Test Loss: 0.649 Test Acc: 0.829
Validation loss decreased (-0.828940 --> -0.828941).  Saving model ...
Epoch: 21 cost time: 1.7337145805358887
Epoch: 21, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.606 Vali Acc: 0.829 Test Loss: 0.606 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828941).  Saving model ...
Epoch: 22 cost time: 1.787074327468872
Epoch: 22, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.779479742050171
Epoch: 23, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.537 Vali Acc: 0.822 Test Loss: 0.537 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7938480377197266
Epoch: 24, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828942).  Saving model ...
Epoch: 25 cost time: 1.8434219360351562
Epoch: 25, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7599577903747559
Epoch: 26, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828942).  Saving model ...
Epoch: 27 cost time: 1.7662477493286133
Epoch: 27, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.779055118560791
Epoch: 28, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.478 Vali Acc: 0.822 Test Loss: 0.478 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.887282133102417
Epoch: 29, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.465 Vali Acc: 0.849 Test Loss: 0.465 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848680).  Saving model ...
Epoch: 30 cost time: 1.75010347366333
Epoch: 30, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.464 Vali Acc: 0.836 Test Loss: 0.464 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 130660
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6580889225006104
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.410 Vali Acc: 0.197 Test Loss: 1.410 Test Acc: 0.197
Validation loss decreased (inf --> -0.197354).  Saving model ...
Epoch: 2 cost time: 1.604024887084961
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.396 Vali Acc: 0.204 Test Loss: 1.396 Test Acc: 0.204
Validation loss decreased (-0.197354 --> -0.203933).  Saving model ...
Epoch: 3 cost time: 1.5468719005584717
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.375 Vali Acc: 0.237 Test Loss: 1.375 Test Acc: 0.237
Validation loss decreased (-0.203933 --> -0.236828).  Saving model ...
Epoch: 4 cost time: 1.8056128025054932
Epoch: 4, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.340 Vali Acc: 0.283 Test Loss: 1.340 Test Acc: 0.283
Validation loss decreased (-0.236828 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 1.5268850326538086
Epoch: 5, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.306 Vali Acc: 0.355 Test Loss: 1.306 Test Acc: 0.355
Validation loss decreased (-0.282881 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 1.5637588500976562
Epoch: 6, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.273 Vali Acc: 0.421 Test Loss: 1.273 Test Acc: 0.421
Validation loss decreased (-0.355250 --> -0.421040).  Saving model ...
Epoch: 7 cost time: 1.7273478507995605
Epoch: 7, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.240 Vali Acc: 0.454 Test Loss: 1.240 Test Acc: 0.454
Validation loss decreased (-0.421040 --> -0.453935).  Saving model ...
Epoch: 8 cost time: 1.8022050857543945
Epoch: 8, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.199 Vali Acc: 0.474 Test Loss: 1.199 Test Acc: 0.474
Validation loss decreased (-0.453935 --> -0.473672).  Saving model ...
Epoch: 9 cost time: 1.761944055557251
Epoch: 9, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.168 Vali Acc: 0.520 Test Loss: 1.168 Test Acc: 0.520
Validation loss decreased (-0.473672 --> -0.519725).  Saving model ...
Epoch: 10 cost time: 1.8062958717346191
Epoch: 10, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.131 Vali Acc: 0.559 Test Loss: 1.131 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 11 cost time: 1.638228416442871
Epoch: 11, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.096 Vali Acc: 0.572 Test Loss: 1.096 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 12 cost time: 1.8836548328399658
Epoch: 12, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.063 Vali Acc: 0.612 Test Loss: 1.063 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611831).  Saving model ...
Epoch: 13 cost time: 1.7370343208312988
Epoch: 13, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.034 Vali Acc: 0.638 Test Loss: 1.034 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638148).  Saving model ...
Epoch: 14 cost time: 1.7983109951019287
Epoch: 14, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.012 Vali Acc: 0.664 Test Loss: 1.012 Test Acc: 0.664
Validation loss decreased (-0.638148 --> -0.664464).  Saving model ...
Epoch: 15 cost time: 1.8772430419921875
Epoch: 15, Steps: 10 | Train Loss: 1.011 Vali Loss: 0.990 Vali Acc: 0.704 Test Loss: 0.990 Test Acc: 0.704
Validation loss decreased (-0.664464 --> -0.703937).  Saving model ...
Epoch: 16 cost time: 1.677994728088379
Epoch: 16, Steps: 10 | Train Loss: 0.990 Vali Loss: 0.962 Vali Acc: 0.697 Test Loss: 0.962 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.696516990661621
Epoch: 17, Steps: 10 | Train Loss: 0.955 Vali Loss: 0.936 Vali Acc: 0.704 Test Loss: 0.936 Test Acc: 0.704
Validation loss decreased (-0.703937 --> -0.703938).  Saving model ...
Epoch: 18 cost time: 1.7758030891418457
Epoch: 18, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.921 Vali Acc: 0.717 Test Loss: 0.921 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717096).  Saving model ...
Epoch: 19 cost time: 1.6935169696807861
Epoch: 19, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.897 Vali Acc: 0.724 Test Loss: 0.897 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 20 cost time: 1.9257731437683105
Epoch: 20, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.830 Vali Acc: 0.737 Test Loss: 0.830 Test Acc: 0.737
Validation loss decreased (-0.723675 --> -0.736834).  Saving model ...
Epoch: 21 cost time: 1.8390586376190186
Epoch: 21, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.776 Vali Acc: 0.763 Test Loss: 0.776 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763150).  Saving model ...
Epoch: 22 cost time: 1.8433167934417725
Epoch: 22, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.716 Vali Acc: 0.796 Test Loss: 0.716 Test Acc: 0.796
Validation loss decreased (-0.763150 --> -0.796045).  Saving model ...
Epoch: 23 cost time: 1.7529144287109375
Epoch: 23, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.670 Vali Acc: 0.822 Test Loss: 0.670 Test Acc: 0.822
Validation loss decreased (-0.796045 --> -0.822362).  Saving model ...
Epoch: 24 cost time: 1.4109749794006348
Epoch: 24, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
Validation loss decreased (-0.822362 --> -0.822362).  Saving model ...
Epoch: 25 cost time: 1.745055913925171
Epoch: 25, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5725157260894775
Epoch: 26, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7040035724639893
Epoch: 27, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 28 cost time: 1.6109931468963623
Epoch: 28, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5176196098327637
Epoch: 29, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5793652534484863
Epoch: 30, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 441172
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.140376567840576
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.433 Vali Acc: 0.217 Test Loss: 1.433 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.300934076309204
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.418 Vali Acc: 0.250 Test Loss: 1.418 Test Acc: 0.250
Validation loss decreased (-0.217091 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.4093084335327148
Epoch: 3, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.400 Vali Acc: 0.296 Test Loss: 1.400 Test Acc: 0.296
Validation loss decreased (-0.249986 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 1.5439367294311523
Epoch: 4, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.378 Vali Acc: 0.316 Test Loss: 1.378 Test Acc: 0.316
Validation loss decreased (-0.296039 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 1.4355552196502686
Epoch: 5, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.354 Vali Acc: 0.355 Test Loss: 1.354 Test Acc: 0.355
Validation loss decreased (-0.315776 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 1.6061415672302246
Epoch: 6, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.327 Vali Acc: 0.388 Test Loss: 1.327 Test Acc: 0.388
Validation loss decreased (-0.355250 --> -0.388145).  Saving model ...
Epoch: 7 cost time: 1.791430950164795
Epoch: 7, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.299 Vali Acc: 0.474 Test Loss: 1.299 Test Acc: 0.474
Validation loss decreased (-0.388145 --> -0.473671).  Saving model ...
Epoch: 8 cost time: 1.6691482067108154
Epoch: 8, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.272 Vali Acc: 0.539 Test Loss: 1.272 Test Acc: 0.539
Validation loss decreased (-0.473671 --> -0.539461).  Saving model ...
Epoch: 9 cost time: 1.5030736923217773
Epoch: 9, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.241 Vali Acc: 0.572 Test Loss: 1.241 Test Acc: 0.572
Validation loss decreased (-0.539461 --> -0.572356).  Saving model ...
Epoch: 10 cost time: 1.8314173221588135
Epoch: 10, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.209 Vali Acc: 0.605 Test Loss: 1.209 Test Acc: 0.605
Validation loss decreased (-0.572356 --> -0.605251).  Saving model ...
Epoch: 11 cost time: 1.72243332862854
Epoch: 11, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.178 Vali Acc: 0.632 Test Loss: 1.178 Test Acc: 0.632
Validation loss decreased (-0.605251 --> -0.631567).  Saving model ...
Epoch: 12 cost time: 1.6376941204071045
Epoch: 12, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.146 Vali Acc: 0.651 Test Loss: 1.146 Test Acc: 0.651
Validation loss decreased (-0.631567 --> -0.651304).  Saving model ...
Epoch: 13 cost time: 1.6131157875061035
Epoch: 13, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.114 Vali Acc: 0.717 Test Loss: 1.114 Test Acc: 0.717
Validation loss decreased (-0.651304 --> -0.717094).  Saving model ...
Epoch: 14 cost time: 1.7733094692230225
Epoch: 14, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.080 Vali Acc: 0.724 Test Loss: 1.080 Test Acc: 0.724
Validation loss decreased (-0.717094 --> -0.723673).  Saving model ...
Epoch: 15 cost time: 1.6739158630371094
Epoch: 15, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.045 Vali Acc: 0.743 Test Loss: 1.045 Test Acc: 0.743
Validation loss decreased (-0.723673 --> -0.743411).  Saving model ...
Epoch: 16 cost time: 1.7360398769378662
Epoch: 16, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.006 Vali Acc: 0.763 Test Loss: 1.006 Test Acc: 0.763
Validation loss decreased (-0.743411 --> -0.763148).  Saving model ...
Epoch: 17 cost time: 1.7632615566253662
Epoch: 17, Steps: 10 | Train Loss: 0.945 Vali Loss: 0.969 Vali Acc: 0.776 Test Loss: 0.969 Test Acc: 0.776
Validation loss decreased (-0.763148 --> -0.776306).  Saving model ...
Epoch: 18 cost time: 1.6528072357177734
Epoch: 18, Steps: 10 | Train Loss: 0.885 Vali Loss: 0.933 Vali Acc: 0.783 Test Loss: 0.933 Test Acc: 0.783
Validation loss decreased (-0.776306 --> -0.782885).  Saving model ...
Epoch: 19 cost time: 1.5809247493743896
Epoch: 19, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.900 Vali Acc: 0.789 Test Loss: 0.900 Test Acc: 0.789
Validation loss decreased (-0.782885 --> -0.789465).  Saving model ...
Epoch: 20 cost time: 1.5464274883270264
Epoch: 20, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.863 Vali Acc: 0.803 Test Loss: 0.863 Test Acc: 0.803
Validation loss decreased (-0.789465 --> -0.802623).  Saving model ...
Epoch: 21 cost time: 1.6846528053283691
Epoch: 21, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.821 Vali Acc: 0.822 Test Loss: 0.821 Test Acc: 0.822
Validation loss decreased (-0.802623 --> -0.822360).  Saving model ...
Epoch: 22 cost time: 1.6317150592803955
Epoch: 22, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5783262252807617
Epoch: 23, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
Validation loss decreased (-0.822360 --> -0.822361).  Saving model ...
Epoch: 24 cost time: 1.5511784553527832
Epoch: 24, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.703 Vali Acc: 0.816 Test Loss: 0.703 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.606217622756958
Epoch: 25, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6738784313201904
Epoch: 26, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7073402404785156
Epoch: 27, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
Validation loss decreased (-0.822361 --> -0.822362).  Saving model ...
Epoch: 28 cost time: 1.6010146141052246
Epoch: 28, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.568 Vali Acc: 0.829 Test Loss: 0.568 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 29 cost time: 1.773911952972412
Epoch: 29, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.541 Vali Acc: 0.849 Test Loss: 0.541 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848679).  Saving model ...
Epoch: 30 cost time: 1.7762703895568848
Epoch: 30, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.517 Vali Acc: 0.862 Test Loss: 0.517 Test Acc: 0.862
Validation loss decreased (-0.848679 --> -0.861837).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 130660
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.580082654953003
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.448 Vali Acc: 0.224 Test Loss: 1.448 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.300260066986084
Epoch: 2, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.434 Vali Acc: 0.224 Test Loss: 1.434 Test Acc: 0.224
Validation loss decreased (-0.223670 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.368560314178467
Epoch: 3, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.413 Vali Acc: 0.237 Test Loss: 1.413 Test Acc: 0.237
Validation loss decreased (-0.223670 --> -0.236828).  Saving model ...
Epoch: 4 cost time: 2.2491958141326904
Epoch: 4, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.389 Vali Acc: 0.237 Test Loss: 1.389 Test Acc: 0.237
Validation loss decreased (-0.236828 --> -0.236828).  Saving model ...
Epoch: 5 cost time: 2.3739962577819824
Epoch: 5, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.362 Vali Acc: 0.257 Test Loss: 1.362 Test Acc: 0.257
Validation loss decreased (-0.236828 --> -0.256565).  Saving model ...
Epoch: 6 cost time: 2.055570125579834
Epoch: 6, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.334 Vali Acc: 0.296 Test Loss: 1.334 Test Acc: 0.296
Validation loss decreased (-0.256565 --> -0.296039).  Saving model ...
Epoch: 7 cost time: 2.077436923980713
Epoch: 7, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.304 Vali Acc: 0.355 Test Loss: 1.304 Test Acc: 0.355
Validation loss decreased (-0.296039 --> -0.355250).  Saving model ...
Epoch: 8 cost time: 2.126103162765503
Epoch: 8, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.272 Vali Acc: 0.408 Test Loss: 1.272 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 9 cost time: 2.2043139934539795
Epoch: 9, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.236 Vali Acc: 0.441 Test Loss: 1.236 Test Acc: 0.441
Validation loss decreased (-0.407882 --> -0.440777).  Saving model ...
Epoch: 10 cost time: 2.1178815364837646
Epoch: 10, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.195 Vali Acc: 0.493 Test Loss: 1.195 Test Acc: 0.493
Validation loss decreased (-0.440777 --> -0.493409).  Saving model ...
Epoch: 11 cost time: 1.939159631729126
Epoch: 11, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.150 Vali Acc: 0.526 Test Loss: 1.150 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 12 cost time: 2.2200095653533936
Epoch: 12, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.097 Vali Acc: 0.579 Test Loss: 1.097 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578936).  Saving model ...
Epoch: 13 cost time: 1.98606538772583
Epoch: 13, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.049 Vali Acc: 0.618 Test Loss: 1.049 Test Acc: 0.618
Validation loss decreased (-0.578936 --> -0.618411).  Saving model ...
Epoch: 14 cost time: 2.214528799057007
Epoch: 14, Steps: 10 | Train Loss: 0.988 Vali Loss: 0.997 Vali Acc: 0.645 Test Loss: 0.997 Test Acc: 0.645
Validation loss decreased (-0.618411 --> -0.644727).  Saving model ...
Epoch: 15 cost time: 2.0600509643554688
Epoch: 15, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.948 Vali Acc: 0.645 Test Loss: 0.948 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644727).  Saving model ...
Epoch: 16 cost time: 1.8916242122650146
Epoch: 16, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.902 Vali Acc: 0.645 Test Loss: 0.902 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 17 cost time: 2.2564446926116943
Epoch: 17, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.855 Vali Acc: 0.691 Test Loss: 0.855 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690781).  Saving model ...
Epoch: 18 cost time: 2.2975027561187744
Epoch: 18, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.819 Vali Acc: 0.678 Test Loss: 0.819 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1110830307006836
Epoch: 19, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.786 Vali Acc: 0.697 Test Loss: 0.786 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 2.059688091278076
Epoch: 20, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.738 Vali Acc: 0.724 Test Loss: 0.738 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 21 cost time: 1.9145615100860596
Epoch: 21, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.703 Vali Acc: 0.743 Test Loss: 0.703 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 22 cost time: 2.152482271194458
Epoch: 22, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.683 Vali Acc: 0.743 Test Loss: 0.683 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 1.9431562423706055
Epoch: 23, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.654 Vali Acc: 0.724 Test Loss: 0.654 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2895267009735107
Epoch: 24, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 2.066743850708008
Epoch: 25, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 2.4009580612182617
Epoch: 26, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4592764377593994
Epoch: 27, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 28 cost time: 2.143233299255371
Epoch: 28, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.085637331008911
Epoch: 29, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.9054913520812988
Epoch: 30, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 221236
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4296977519989014
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.474 Vali Acc: 0.191 Test Loss: 1.474 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 1.7821464538574219
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.461 Vali Acc: 0.197 Test Loss: 1.461 Test Acc: 0.197
Validation loss decreased (-0.190775 --> -0.197354).  Saving model ...
Epoch: 3 cost time: 1.718484878540039
Epoch: 3, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.442 Vali Acc: 0.211 Test Loss: 1.442 Test Acc: 0.211
Validation loss decreased (-0.197354 --> -0.210512).  Saving model ...
Epoch: 4 cost time: 1.798722505569458
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.422 Vali Acc: 0.211 Test Loss: 1.422 Test Acc: 0.211
Validation loss decreased (-0.210512 --> -0.210512).  Saving model ...
Epoch: 5 cost time: 1.6908948421478271
Epoch: 5, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.401 Vali Acc: 0.217 Test Loss: 1.401 Test Acc: 0.217
Validation loss decreased (-0.210512 --> -0.217091).  Saving model ...
Epoch: 6 cost time: 1.704988956451416
Epoch: 6, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.375 Vali Acc: 0.237 Test Loss: 1.375 Test Acc: 0.237
Validation loss decreased (-0.217091 --> -0.236828).  Saving model ...
Epoch: 7 cost time: 1.7534523010253906
Epoch: 7, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.349 Vali Acc: 0.263 Test Loss: 1.349 Test Acc: 0.263
Validation loss decreased (-0.236828 --> -0.263144).  Saving model ...
Epoch: 8 cost time: 1.813340187072754
Epoch: 8, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.321 Vali Acc: 0.322 Test Loss: 1.321 Test Acc: 0.322
Validation loss decreased (-0.263144 --> -0.322355).  Saving model ...
Epoch: 9 cost time: 1.7871742248535156
Epoch: 9, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.293 Vali Acc: 0.355 Test Loss: 1.293 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 10 cost time: 1.646254301071167
Epoch: 10, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.262 Vali Acc: 0.382 Test Loss: 1.262 Test Acc: 0.382
Validation loss decreased (-0.355250 --> -0.381566).  Saving model ...
Epoch: 11 cost time: 1.5772716999053955
Epoch: 11, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.227 Vali Acc: 0.461 Test Loss: 1.227 Test Acc: 0.461
Validation loss decreased (-0.381566 --> -0.460514).  Saving model ...
Epoch: 12 cost time: 1.3048784732818604
Epoch: 12, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.191 Vali Acc: 0.513 Test Loss: 1.191 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 13 cost time: 1.551466464996338
Epoch: 13, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.152 Vali Acc: 0.559 Test Loss: 1.152 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 14 cost time: 1.8291692733764648
Epoch: 14, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.109 Vali Acc: 0.592 Test Loss: 1.109 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 15 cost time: 1.6892716884613037
Epoch: 15, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.060 Vali Acc: 0.645 Test Loss: 1.060 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644726).  Saving model ...
Epoch: 16 cost time: 1.78843092918396
Epoch: 16, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.009 Vali Acc: 0.658 Test Loss: 1.009 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657885).  Saving model ...
Epoch: 17 cost time: 1.816443681716919
Epoch: 17, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.957 Vali Acc: 0.684 Test Loss: 0.957 Test Acc: 0.684
Validation loss decreased (-0.657885 --> -0.684201).  Saving model ...
Epoch: 18 cost time: 1.88590669631958
Epoch: 18, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.904 Vali Acc: 0.711 Test Loss: 0.904 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710517).  Saving model ...
Epoch: 19 cost time: 1.8919143676757812
Epoch: 19, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
Validation loss decreased (-0.710517 --> -0.710518).  Saving model ...
Epoch: 20 cost time: 1.835575819015503
Epoch: 20, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717097).  Saving model ...
Epoch: 21 cost time: 1.898270606994629
Epoch: 21, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.758 Vali Acc: 0.743 Test Loss: 0.758 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743413).  Saving model ...
Epoch: 22 cost time: 1.6646051406860352
Epoch: 22, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.713 Vali Acc: 0.737 Test Loss: 0.713 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5703752040863037
Epoch: 23, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.675 Vali Acc: 0.750 Test Loss: 0.675 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749993).  Saving model ...
Epoch: 24 cost time: 1.425175428390503
Epoch: 24, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 1.4263079166412354
Epoch: 25, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.3896105289459229
Epoch: 26, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.6090571880340576
Epoch: 27, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 1.8408219814300537
Epoch: 28, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.8466241359710693
Epoch: 29, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 30 cost time: 1.9032347202301025
Epoch: 30, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 65956
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.079800844192505
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.449 Vali Acc: 0.230 Test Loss: 1.449 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.5979080200195312
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.434 Vali Acc: 0.237 Test Loss: 1.434 Test Acc: 0.237
Validation loss decreased (-0.230249 --> -0.236828).  Saving model ...
Epoch: 3 cost time: 1.8140807151794434
Epoch: 3, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.414 Vali Acc: 0.243 Test Loss: 1.414 Test Acc: 0.243
Validation loss decreased (-0.236828 --> -0.243407).  Saving model ...
Epoch: 4 cost time: 1.547877311706543
Epoch: 4, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.389 Vali Acc: 0.237 Test Loss: 1.389 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7716386318206787
Epoch: 5, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.362 Vali Acc: 0.257 Test Loss: 1.362 Test Acc: 0.257
Validation loss decreased (-0.243407 --> -0.256565).  Saving model ...
Epoch: 6 cost time: 1.6631596088409424
Epoch: 6, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.335 Vali Acc: 0.303 Test Loss: 1.335 Test Acc: 0.303
Validation loss decreased (-0.256565 --> -0.302618).  Saving model ...
Epoch: 7 cost time: 1.7504267692565918
Epoch: 7, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.304 Vali Acc: 0.322 Test Loss: 1.304 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 8 cost time: 1.9757204055786133
Epoch: 8, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.271 Vali Acc: 0.375 Test Loss: 1.271 Test Acc: 0.375
Validation loss decreased (-0.322355 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 1.8576850891113281
Epoch: 9, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.236 Vali Acc: 0.434 Test Loss: 1.236 Test Acc: 0.434
Validation loss decreased (-0.374987 --> -0.434198).  Saving model ...
Epoch: 10 cost time: 1.7811486721038818
Epoch: 10, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.194 Vali Acc: 0.493 Test Loss: 1.194 Test Acc: 0.493
Validation loss decreased (-0.434198 --> -0.493409).  Saving model ...
Epoch: 11 cost time: 1.8476982116699219
Epoch: 11, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.146 Vali Acc: 0.520 Test Loss: 1.146 Test Acc: 0.520
Validation loss decreased (-0.493409 --> -0.519725).  Saving model ...
Epoch: 12 cost time: 1.8016703128814697
Epoch: 12, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.096 Vali Acc: 0.572 Test Loss: 1.096 Test Acc: 0.572
Validation loss decreased (-0.519725 --> -0.572357).  Saving model ...
Epoch: 13 cost time: 1.8335421085357666
Epoch: 13, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.050 Vali Acc: 0.612 Test Loss: 1.050 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611832).  Saving model ...
Epoch: 14 cost time: 1.7884750366210938
Epoch: 14, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.002 Vali Acc: 0.638 Test Loss: 1.002 Test Acc: 0.638
Validation loss decreased (-0.611832 --> -0.638148).  Saving model ...
Epoch: 15 cost time: 1.8800432682037354
Epoch: 15, Steps: 10 | Train Loss: 0.906 Vali Loss: 0.956 Vali Acc: 0.651 Test Loss: 0.956 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 16 cost time: 1.7397699356079102
Epoch: 16, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.893 Vali Acc: 0.684 Test Loss: 0.893 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 1.786468505859375
Epoch: 17, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.847 Vali Acc: 0.678 Test Loss: 0.847 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7983756065368652
Epoch: 18, Steps: 10 | Train Loss: 0.735 Vali Loss: 0.808 Vali Acc: 0.684 Test Loss: 0.808 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 19 cost time: 1.7136402130126953
Epoch: 19, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.792 Vali Acc: 0.697 Test Loss: 0.792 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 1.6076350212097168
Epoch: 20, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 21 cost time: 1.7461576461791992
Epoch: 21, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 22 cost time: 1.808084487915039
Epoch: 22, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.701 Vali Acc: 0.743 Test Loss: 0.701 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 1.8799140453338623
Epoch: 23, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.673 Vali Acc: 0.730 Test Loss: 0.673 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.211932897567749
Epoch: 24, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.638 Vali Acc: 0.743 Test Loss: 0.638 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 1.908700704574585
Epoch: 25, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 2.2105534076690674
Epoch: 26, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 2.0841033458709717
Epoch: 27, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 2.0966594219207764
Epoch: 28, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.916213035583496
Epoch: 29, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.740783452987671
Epoch: 30, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 221236
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.510756015777588
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.473 Vali Acc: 0.191 Test Loss: 1.473 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 1.6453680992126465
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.460 Vali Acc: 0.197 Test Loss: 1.460 Test Acc: 0.197
Validation loss decreased (-0.190775 --> -0.197354).  Saving model ...
Epoch: 3 cost time: 1.7284531593322754
Epoch: 3, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.441 Vali Acc: 0.211 Test Loss: 1.441 Test Acc: 0.211
Validation loss decreased (-0.197354 --> -0.210512).  Saving model ...
Epoch: 4 cost time: 1.7213599681854248
Epoch: 4, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.420 Vali Acc: 0.211 Test Loss: 1.420 Test Acc: 0.211
Validation loss decreased (-0.210512 --> -0.210512).  Saving model ...
Epoch: 5 cost time: 1.7037725448608398
Epoch: 5, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.398 Vali Acc: 0.230 Test Loss: 1.398 Test Acc: 0.230
Validation loss decreased (-0.210512 --> -0.230249).  Saving model ...
Epoch: 6 cost time: 1.7495357990264893
Epoch: 6, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.372 Vali Acc: 0.250 Test Loss: 1.372 Test Acc: 0.250
Validation loss decreased (-0.230249 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.6303510665893555
Epoch: 7, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.344 Vali Acc: 0.283 Test Loss: 1.344 Test Acc: 0.283
Validation loss decreased (-0.249986 --> -0.282881).  Saving model ...
Epoch: 8 cost time: 1.7450692653656006
Epoch: 8, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.316 Vali Acc: 0.322 Test Loss: 1.316 Test Acc: 0.322
Validation loss decreased (-0.282881 --> -0.322355).  Saving model ...
Epoch: 9 cost time: 1.619269847869873
Epoch: 9, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.287 Vali Acc: 0.355 Test Loss: 1.287 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 10 cost time: 1.6133778095245361
Epoch: 10, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.256 Vali Acc: 0.401 Test Loss: 1.256 Test Acc: 0.401
Validation loss decreased (-0.355250 --> -0.401303).  Saving model ...
Epoch: 11 cost time: 1.5368914604187012
Epoch: 11, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.219 Vali Acc: 0.467 Test Loss: 1.219 Test Acc: 0.467
Validation loss decreased (-0.401303 --> -0.467093).  Saving model ...
Epoch: 12 cost time: 1.384573221206665
Epoch: 12, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.183 Vali Acc: 0.507 Test Loss: 1.183 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 13 cost time: 1.5937633514404297
Epoch: 13, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.143 Vali Acc: 0.559 Test Loss: 1.143 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559199).  Saving model ...
Epoch: 14 cost time: 1.6544239521026611
Epoch: 14, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.099 Vali Acc: 0.586 Test Loss: 1.099 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585515).  Saving model ...
Epoch: 15 cost time: 1.4023833274841309
Epoch: 15, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.052 Vali Acc: 0.618 Test Loss: 1.052 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618411).  Saving model ...
Epoch: 16 cost time: 1.560683012008667
Epoch: 16, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.002 Vali Acc: 0.658 Test Loss: 1.002 Test Acc: 0.658
Validation loss decreased (-0.618411 --> -0.657885).  Saving model ...
Epoch: 17 cost time: 1.5949602127075195
Epoch: 17, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.951 Vali Acc: 0.678 Test Loss: 0.951 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677622).  Saving model ...
Epoch: 18 cost time: 1.6498472690582275
Epoch: 18, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710517).  Saving model ...
Epoch: 19 cost time: 1.5400707721710205
Epoch: 19, Steps: 10 | Train Loss: 0.767 Vali Loss: 0.850 Vali Acc: 0.704 Test Loss: 0.850 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7219140529632568
Epoch: 20, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736834).  Saving model ...
Epoch: 21 cost time: 1.686208724975586
Epoch: 21, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.760 Vali Acc: 0.743 Test Loss: 0.760 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 22 cost time: 1.512568712234497
Epoch: 22, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.716 Vali Acc: 0.743 Test Loss: 0.716 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 23 cost time: 1.6874723434448242
Epoch: 23, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.681 Vali Acc: 0.757 Test Loss: 0.681 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 1.5171606540679932
Epoch: 24, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 25 cost time: 1.6466782093048096
Epoch: 25, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4486985206604004
Epoch: 26, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 1.461489200592041
Epoch: 27, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.454848051071167
Epoch: 28, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 1.596238136291504
Epoch: 29, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.5406162738800049
Epoch: 30, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 65956
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.53778338432312
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.458 Vali Acc: 0.230 Test Loss: 1.458 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.4708096981048584
Epoch: 2, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.448 Vali Acc: 0.217 Test Loss: 1.448 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9629807472229004
Epoch: 3, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.432 Vali Acc: 0.224 Test Loss: 1.432 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6497750282287598
Epoch: 4, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.412 Vali Acc: 0.197 Test Loss: 1.412 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4153249263763428
Epoch: 5, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.391 Vali Acc: 0.211 Test Loss: 1.391 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.525792121887207
Epoch: 6, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.369 Vali Acc: 0.243 Test Loss: 1.369 Test Acc: 0.243
Validation loss decreased (-0.230249 --> -0.243407).  Saving model ...
Epoch: 7 cost time: 1.538177490234375
Epoch: 7, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.349 Vali Acc: 0.250 Test Loss: 1.349 Test Acc: 0.250
Validation loss decreased (-0.243407 --> -0.249987).  Saving model ...
Epoch: 8 cost time: 1.7284815311431885
Epoch: 8, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.324 Vali Acc: 0.283 Test Loss: 1.324 Test Acc: 0.283
Validation loss decreased (-0.249987 --> -0.282881).  Saving model ...
Epoch: 9 cost time: 1.3634564876556396
Epoch: 9, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.300 Vali Acc: 0.329 Test Loss: 1.300 Test Acc: 0.329
Validation loss decreased (-0.282881 --> -0.328934).  Saving model ...
Epoch: 10 cost time: 1.523888349533081
Epoch: 10, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.282 Vali Acc: 0.375 Test Loss: 1.282 Test Acc: 0.375
Validation loss decreased (-0.328934 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 1.7364788055419922
Epoch: 11, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.257 Vali Acc: 0.428 Test Loss: 1.257 Test Acc: 0.428
Validation loss decreased (-0.374987 --> -0.427619).  Saving model ...
Epoch: 12 cost time: 1.7174568176269531
Epoch: 12, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.229 Vali Acc: 0.480 Test Loss: 1.229 Test Acc: 0.480
Validation loss decreased (-0.427619 --> -0.480251).  Saving model ...
Epoch: 13 cost time: 1.8042430877685547
Epoch: 13, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.205 Vali Acc: 0.533 Test Loss: 1.205 Test Acc: 0.533
Validation loss decreased (-0.480251 --> -0.532883).  Saving model ...
Epoch: 14 cost time: 1.8932206630706787
Epoch: 14, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.175 Vali Acc: 0.572 Test Loss: 1.175 Test Acc: 0.572
Validation loss decreased (-0.532883 --> -0.572357).  Saving model ...
Epoch: 15 cost time: 1.7379257678985596
Epoch: 15, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.145 Vali Acc: 0.572 Test Loss: 1.145 Test Acc: 0.572
Validation loss decreased (-0.572357 --> -0.572357).  Saving model ...
Epoch: 16 cost time: 1.7364907264709473
Epoch: 16, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.117 Vali Acc: 0.599 Test Loss: 1.117 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598673).  Saving model ...
Epoch: 17 cost time: 1.7393622398376465
Epoch: 17, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.087 Vali Acc: 0.612 Test Loss: 1.087 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611831).  Saving model ...
Epoch: 18 cost time: 1.64341139793396
Epoch: 18, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.059 Vali Acc: 0.658 Test Loss: 1.059 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657884).  Saving model ...
Epoch: 19 cost time: 1.6400575637817383
Epoch: 19, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.030 Vali Acc: 0.658 Test Loss: 1.030 Test Acc: 0.658
Validation loss decreased (-0.657884 --> -0.657884).  Saving model ...
Epoch: 20 cost time: 1.4457159042358398
Epoch: 20, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.000 Vali Acc: 0.671 Test Loss: 1.000 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671043).  Saving model ...
Epoch: 21 cost time: 1.4794068336486816
Epoch: 21, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.969 Vali Acc: 0.678 Test Loss: 0.969 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677622).  Saving model ...
Epoch: 22 cost time: 1.5885767936706543
Epoch: 22, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.939 Vali Acc: 0.671 Test Loss: 0.939 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.617661476135254
Epoch: 23, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.908 Vali Acc: 0.691 Test Loss: 0.908 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 24 cost time: 1.6751041412353516
Epoch: 24, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.870 Vali Acc: 0.704 Test Loss: 0.870 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 25 cost time: 1.5534815788269043
Epoch: 25, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.835 Vali Acc: 0.704 Test Loss: 0.835 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 26 cost time: 1.8003227710723877
Epoch: 26, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.801 Vali Acc: 0.724 Test Loss: 0.801 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723676).  Saving model ...
Epoch: 27 cost time: 1.7309818267822266
Epoch: 27, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.768 Vali Acc: 0.730 Test Loss: 0.768 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 28 cost time: 1.5153188705444336
Epoch: 28, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.733 Vali Acc: 0.743 Test Loss: 0.733 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 29 cost time: 1.9265117645263672
Epoch: 29, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.697 Vali Acc: 0.743 Test Loss: 0.697 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 30 cost time: 1.8350868225097656
Epoch: 30, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
Validation loss decreased (-0.743414 --> -0.776309).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 221236
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.619173288345337
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.477 Vali Acc: 0.184 Test Loss: 1.477 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 1.1018400192260742
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.467 Vali Acc: 0.197 Test Loss: 1.467 Test Acc: 0.197
Validation loss decreased (-0.184196 --> -0.197354).  Saving model ...
Epoch: 3 cost time: 1.2925093173980713
Epoch: 3, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.451 Vali Acc: 0.204 Test Loss: 1.451 Test Acc: 0.204
Validation loss decreased (-0.197354 --> -0.203933).  Saving model ...
Epoch: 4 cost time: 1.504518985748291
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.434 Vali Acc: 0.211 Test Loss: 1.434 Test Acc: 0.211
Validation loss decreased (-0.203933 --> -0.210512).  Saving model ...
Epoch: 5 cost time: 1.5444726943969727
Epoch: 5, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.417 Vali Acc: 0.224 Test Loss: 1.417 Test Acc: 0.224
Validation loss decreased (-0.210512 --> -0.223670).  Saving model ...
Epoch: 6 cost time: 1.4204351902008057
Epoch: 6, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.396 Vali Acc: 0.230 Test Loss: 1.396 Test Acc: 0.230
Validation loss decreased (-0.223670 --> -0.230249).  Saving model ...
Epoch: 7 cost time: 1.5098741054534912
Epoch: 7, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.375 Vali Acc: 0.250 Test Loss: 1.375 Test Acc: 0.250
Validation loss decreased (-0.230249 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.4493520259857178
Epoch: 8, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.354 Vali Acc: 0.270 Test Loss: 1.354 Test Acc: 0.270
Validation loss decreased (-0.249986 --> -0.269723).  Saving model ...
Epoch: 9 cost time: 1.4988212585449219
Epoch: 9, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.333 Vali Acc: 0.309 Test Loss: 1.333 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 10 cost time: 1.4563262462615967
Epoch: 10, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.311 Vali Acc: 0.349 Test Loss: 1.311 Test Acc: 0.349
Validation loss decreased (-0.309197 --> -0.348671).  Saving model ...
Epoch: 11 cost time: 1.4246184825897217
Epoch: 11, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.284 Vali Acc: 0.401 Test Loss: 1.284 Test Acc: 0.401
Validation loss decreased (-0.348671 --> -0.401303).  Saving model ...
Epoch: 12 cost time: 1.2111015319824219
Epoch: 12, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.260 Vali Acc: 0.434 Test Loss: 1.260 Test Acc: 0.434
Validation loss decreased (-0.401303 --> -0.434198).  Saving model ...
Epoch: 13 cost time: 1.4220054149627686
Epoch: 13, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.235 Vali Acc: 0.474 Test Loss: 1.235 Test Acc: 0.474
Validation loss decreased (-0.434198 --> -0.473672).  Saving model ...
Epoch: 14 cost time: 1.0508897304534912
Epoch: 14, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.208 Vali Acc: 0.507 Test Loss: 1.208 Test Acc: 0.507
Validation loss decreased (-0.473672 --> -0.506567).  Saving model ...
Epoch: 15 cost time: 1.3807518482208252
Epoch: 15, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.179 Vali Acc: 0.526 Test Loss: 1.179 Test Acc: 0.526
Validation loss decreased (-0.506567 --> -0.526304).  Saving model ...
Epoch: 16 cost time: 1.2491686344146729
Epoch: 16, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.149 Vali Acc: 0.553 Test Loss: 1.149 Test Acc: 0.553
Validation loss decreased (-0.526304 --> -0.552620).  Saving model ...
Epoch: 17 cost time: 1.459242820739746
Epoch: 17, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.120 Vali Acc: 0.566 Test Loss: 1.120 Test Acc: 0.566
Validation loss decreased (-0.552620 --> -0.565778).  Saving model ...
Epoch: 18 cost time: 1.3948183059692383
Epoch: 18, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.090 Vali Acc: 0.605 Test Loss: 1.090 Test Acc: 0.605
Validation loss decreased (-0.565778 --> -0.605252).  Saving model ...
Epoch: 19 cost time: 1.409902811050415
Epoch: 19, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.058 Vali Acc: 0.605 Test Loss: 1.058 Test Acc: 0.605
Validation loss decreased (-0.605252 --> -0.605253).  Saving model ...
Epoch: 20 cost time: 1.3674919605255127
Epoch: 20, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.025 Vali Acc: 0.632 Test Loss: 1.025 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631569).  Saving model ...
Epoch: 21 cost time: 1.6529786586761475
Epoch: 21, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.991 Vali Acc: 0.638 Test Loss: 0.991 Test Acc: 0.638
Validation loss decreased (-0.631569 --> -0.638148).  Saving model ...
Epoch: 22 cost time: 1.3834805488586426
Epoch: 22, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.956 Vali Acc: 0.651 Test Loss: 0.956 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 23 cost time: 1.5574581623077393
Epoch: 23, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.923 Vali Acc: 0.645 Test Loss: 0.923 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3757679462432861
Epoch: 24, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.886 Vali Acc: 0.638 Test Loss: 0.886 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5111899375915527
Epoch: 25, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.858 Vali Acc: 0.645 Test Loss: 0.858 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.262695550918579
Epoch: 26, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.825 Vali Acc: 0.651 Test Loss: 0.825 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651308).  Saving model ...
Epoch: 27 cost time: 1.6157026290893555
Epoch: 27, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.799 Vali Acc: 0.658 Test Loss: 0.799 Test Acc: 0.658
Validation loss decreased (-0.651308 --> -0.657887).  Saving model ...
Epoch: 28 cost time: 1.2698438167572021
Epoch: 28, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.770 Vali Acc: 0.671 Test Loss: 0.770 Test Acc: 0.671
Validation loss decreased (-0.657887 --> -0.671045).  Saving model ...
Epoch: 29 cost time: 1.4815795421600342
Epoch: 29, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.744 Vali Acc: 0.691 Test Loss: 0.744 Test Acc: 0.691
Validation loss decreased (-0.671045 --> -0.690782).  Saving model ...
Epoch: 30 cost time: 1.2986929416656494
Epoch: 30, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.723 Vali Acc: 0.691 Test Loss: 0.723 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.6907894736842105
model parameter : 65956
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 11.326419830322266
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.286 Vali Acc: 0.388 Test Loss: 1.286 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 9.594477891921997
Epoch: 2, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.030 Vali Acc: 0.671 Test Loss: 1.030 Test Acc: 0.671
Validation loss decreased (-0.388145 --> -0.671042).  Saving model ...
Epoch: 3 cost time: 8.493583679199219
Epoch: 3, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
Validation loss decreased (-0.671042 --> -0.789466).  Saving model ...
Epoch: 4 cost time: 8.452795028686523
Epoch: 4, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
Validation loss decreased (-0.789466 --> -0.822363).  Saving model ...
Epoch: 5 cost time: 7.135873317718506
Epoch: 5, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.416 Vali Acc: 0.842 Test Loss: 0.416 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842101).  Saving model ...
Epoch: 6 cost time: 9.40368127822876
Epoch: 6, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 7 cost time: 8.608779430389404
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.477 Vali Acc: 0.829 Test Loss: 0.477 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.246216773986816
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.746689319610596
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.527 Vali Acc: 0.836 Test Loss: 0.527 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.34691596031189
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.472 Vali Acc: 0.842 Test Loss: 0.472 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.527221202850342
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855258).  Saving model ...
Epoch: 12 cost time: 8.461484670639038
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.524 Vali Acc: 0.829 Test Loss: 0.524 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.392459869384766
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.597999095916748
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.836 Test Loss: 0.552 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.986685037612915
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.836 Test Loss: 0.550 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.551927804946899
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.849 Test Loss: 0.569 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.011857032775879
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.842 Test Loss: 0.573 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.597594261169434
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.829 Test Loss: 0.584 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.230881690979004
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.662159204483032
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.775669813156128
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 37509636
model size : 145.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.819163084030151
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.323 Vali Acc: 0.316 Test Loss: 1.323 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 2.635857582092285
Epoch: 2, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.070 Vali Acc: 0.684 Test Loss: 1.070 Test Acc: 0.684
Validation loss decreased (-0.315776 --> -0.684200).  Saving model ...
Epoch: 3 cost time: 3.118769884109497
Epoch: 3, Steps: 10 | Train Loss: 0.829 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
Validation loss decreased (-0.684200 --> -0.809203).  Saving model ...
Epoch: 4 cost time: 2.659586191177368
Epoch: 4, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
Validation loss decreased (-0.809203 --> -0.828942).  Saving model ...
Epoch: 5 cost time: 3.1702616214752197
Epoch: 5, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.441 Vali Acc: 0.849 Test Loss: 0.441 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848680).  Saving model ...
Epoch: 6 cost time: 3.3941280841827393
Epoch: 6, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.364 Vali Acc: 0.855 Test Loss: 0.364 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855260).  Saving model ...
Epoch: 7 cost time: 3.228355884552002
Epoch: 7, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.372 Vali Acc: 0.849 Test Loss: 0.372 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.519834518432617
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.392 Vali Acc: 0.849 Test Loss: 0.392 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3079113960266113
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.401 Vali Acc: 0.849 Test Loss: 0.401 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3453896045684814
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.422 Vali Acc: 0.849 Test Loss: 0.422 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.212491989135742
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861838).  Saving model ...
Epoch: 12 cost time: 3.3220574855804443
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 13 cost time: 3.169496774673462
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2905666828155518
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.882 Test Loss: 0.408 Test Acc: 0.882
Validation loss decreased (-0.861838 --> -0.881575).  Saving model ...
Epoch: 15 cost time: 3.0385050773620605
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.849 Test Loss: 0.426 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.498835802078247
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.496 Vali Acc: 0.849 Test Loss: 0.496 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.552402973175049
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.605 Vali Acc: 0.868 Test Loss: 0.605 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5018796920776367
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.571 Vali Acc: 0.842 Test Loss: 0.571 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4614005088806152
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.585 Vali Acc: 0.842 Test Loss: 0.585 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.000682830810547
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.95560884475708
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0237812995910645
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.508 Vali Acc: 0.868 Test Loss: 0.508 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8783457279205322
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.9732751846313477
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 11031556
model size : 44.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 8.110149383544922
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.299 Vali Acc: 0.355 Test Loss: 1.299 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 5.94784688949585
Epoch: 2, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.071 Vali Acc: 0.605 Test Loss: 1.071 Test Acc: 0.605
Validation loss decreased (-0.355250 --> -0.605252).  Saving model ...
Epoch: 3 cost time: 6.709452152252197
Epoch: 3, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.816 Vali Acc: 0.757 Test Loss: 0.816 Test Acc: 0.757
Validation loss decreased (-0.605252 --> -0.756571).  Saving model ...
Epoch: 4 cost time: 6.415988922119141
Epoch: 4, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.756571 --> -0.822363).  Saving model ...
Epoch: 5 cost time: 7.230150938034058
Epoch: 5, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.449 Vali Acc: 0.829 Test Loss: 0.449 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 6 cost time: 6.77343487739563
Epoch: 6, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.413 Vali Acc: 0.842 Test Loss: 0.413 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 7 cost time: 5.145807266235352
Epoch: 7, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.505 Vali Acc: 0.842 Test Loss: 0.505 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.986721515655518
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.463 Vali Acc: 0.836 Test Loss: 0.463 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.66867470741272
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.653 Vali Acc: 0.796 Test Loss: 0.653 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.6658642292022705
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.677 Vali Acc: 0.836 Test Loss: 0.677 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.169488191604614
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.285233974456787
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.746 Vali Acc: 0.809 Test Loss: 0.746 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.903435468673706
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.624 Vali Acc: 0.849 Test Loss: 0.624 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848678).  Saving model ...
Epoch: 14 cost time: 5.792097568511963
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.623 Vali Acc: 0.842 Test Loss: 0.623 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.674097299575806
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.811962127685547
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.513 Vali Acc: 0.836 Test Loss: 0.513 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.0439276695251465
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.517 Vali Acc: 0.849 Test Loss: 0.517 Test Acc: 0.849
Validation loss decreased (-0.848678 --> -0.848679).  Saving model ...
Epoch: 18 cost time: 6.901399612426758
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.842 Test Loss: 0.563 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.31234335899353
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.596 Vali Acc: 0.849 Test Loss: 0.596 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.7162864208221436
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.849 Test Loss: 0.636 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.80981183052063
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.849 Test Loss: 0.661 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.598445892333984
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.836 Test Loss: 0.678 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.840877294540405
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.689 Vali Acc: 0.836 Test Loss: 0.689 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.446301460266113
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.836 Test Loss: 0.696 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.840054273605347
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.601 Vali Acc: 0.849 Test Loss: 0.601 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.56576681137085
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.868 Test Loss: 0.565 Test Acc: 0.868
Validation loss decreased (-0.848679 --> -0.868415).  Saving model ...
Epoch: 27 cost time: 6.42927098274231
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.868 Test Loss: 0.599 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.065107822418213
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.757 Vali Acc: 0.842 Test Loss: 0.757 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 7.4801483154296875
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.862 Test Loss: 0.557 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 7.107568740844727
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.849 Test Loss: 0.580 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 37509636
model size : 145.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.125409126281738
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.332 Vali Acc: 0.316 Test Loss: 1.332 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 2.7106733322143555
Epoch: 2, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.106 Vali Acc: 0.638 Test Loss: 1.106 Test Acc: 0.638
Validation loss decreased (-0.315776 --> -0.638147).  Saving model ...
Epoch: 3 cost time: 2.5297296047210693
Epoch: 3, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.845 Vali Acc: 0.783 Test Loss: 0.845 Test Acc: 0.783
Validation loss decreased (-0.638147 --> -0.782886).  Saving model ...
Epoch: 4 cost time: 2.7618248462677
Epoch: 4, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.782886 --> -0.809204).  Saving model ...
Epoch: 5 cost time: 2.7172155380249023
Epoch: 5, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.474 Vali Acc: 0.842 Test Loss: 0.474 Test Acc: 0.842
Validation loss decreased (-0.809204 --> -0.842101).  Saving model ...
Epoch: 6 cost time: 2.8029792308807373
Epoch: 6, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
Validation loss decreased (-0.842101 --> -0.861838).  Saving model ...
Epoch: 7 cost time: 2.7600271701812744
Epoch: 7, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4931247234344482
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.417 Vali Acc: 0.836 Test Loss: 0.417 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2088427543640137
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.567345380783081
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.411 Vali Acc: 0.849 Test Loss: 0.411 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4600048065185547
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1200406551361084
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.399 Vali Acc: 0.868 Test Loss: 0.399 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 13 cost time: 2.7054357528686523
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6972947120666504
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0211398601531982
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.478 Vali Acc: 0.842 Test Loss: 0.478 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9377410411834717
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.569 Vali Acc: 0.836 Test Loss: 0.569 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7478597164154053
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.514 Vali Acc: 0.849 Test Loss: 0.514 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9785420894622803
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7923331260681152
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3630480766296387
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.578 Vali Acc: 0.862 Test Loss: 0.578 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.784667730331421
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.567 Vali Acc: 0.855 Test Loss: 0.567 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5719895362854004
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.855 Test Loss: 0.536 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 11031556
model size : 44.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.9283201694488525
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.320 Vali Acc: 0.329 Test Loss: 1.320 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 4.458814382553101
Epoch: 2, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.124 Vali Acc: 0.572 Test Loss: 1.124 Test Acc: 0.572
Validation loss decreased (-0.328934 --> -0.572357).  Saving model ...
Epoch: 3 cost time: 4.242919445037842
Epoch: 3, Steps: 10 | Train Loss: 0.995 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.572357 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 3.9631128311157227
Epoch: 4, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.640 Vali Acc: 0.816 Test Loss: 0.640 Test Acc: 0.816
Validation loss decreased (-0.749991 --> -0.815783).  Saving model ...
Epoch: 5 cost time: 4.337865114212036
Epoch: 5, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8214805126190186
Epoch: 6, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
Validation loss decreased (-0.815783 --> -0.848680).  Saving model ...
Epoch: 7 cost time: 4.222479820251465
Epoch: 7, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 8 cost time: 4.7355797290802
Epoch: 8, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.358 Vali Acc: 0.855 Test Loss: 0.358 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.112939357757568
Epoch: 9, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.408 Vali Acc: 0.842 Test Loss: 0.408 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.6331164836883545
Epoch: 10, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.430 Vali Acc: 0.829 Test Loss: 0.430 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.989532232284546
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.233433246612549
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.519725322723389
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.500 Vali Acc: 0.836 Test Loss: 0.500 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.431707859039307
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.506 Vali Acc: 0.822 Test Loss: 0.506 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.287585258483887
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.523 Vali Acc: 0.822 Test Loss: 0.523 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.449625492095947
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.356821775436401
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 37509636
model size : 145.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6808855533599854
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.351 Vali Acc: 0.303 Test Loss: 1.351 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.909092903137207
Epoch: 2, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.164 Vali Acc: 0.592 Test Loss: 1.164 Test Acc: 0.592
Validation loss decreased (-0.302618 --> -0.592094).  Saving model ...
Epoch: 3 cost time: 1.9076001644134521
Epoch: 3, Steps: 10 | Train Loss: 0.993 Vali Loss: 0.934 Vali Acc: 0.737 Test Loss: 0.934 Test Acc: 0.737
Validation loss decreased (-0.592094 --> -0.736833).  Saving model ...
Epoch: 4 cost time: 1.9350616931915283
Epoch: 4, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.720 Vali Acc: 0.763 Test Loss: 0.720 Test Acc: 0.763
Validation loss decreased (-0.736833 --> -0.763151).  Saving model ...
Epoch: 5 cost time: 1.656841516494751
Epoch: 5, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
Validation loss decreased (-0.763151 --> -0.815784).  Saving model ...
Epoch: 6 cost time: 1.8290541172027588
Epoch: 6, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.426 Vali Acc: 0.829 Test Loss: 0.426 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828943).  Saving model ...
Epoch: 7 cost time: 1.9570260047912598
Epoch: 7, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.377 Vali Acc: 0.836 Test Loss: 0.377 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835523).  Saving model ...
Epoch: 8 cost time: 1.8846442699432373
Epoch: 8, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.365 Vali Acc: 0.842 Test Loss: 0.365 Test Acc: 0.842
Validation loss decreased (-0.835523 --> -0.842102).  Saving model ...
Epoch: 9 cost time: 2.133909225463867
Epoch: 9, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.341 Vali Acc: 0.842 Test Loss: 0.341 Test Acc: 0.842
Validation loss decreased (-0.842102 --> -0.842102).  Saving model ...
Epoch: 10 cost time: 1.6409659385681152
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.344 Vali Acc: 0.855 Test Loss: 0.344 Test Acc: 0.855
Validation loss decreased (-0.842102 --> -0.855260).  Saving model ...
Epoch: 11 cost time: 1.678297519683838
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.855260 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 1.8930845260620117
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.348 Vali Acc: 0.849 Test Loss: 0.348 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8982107639312744
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.776778221130371
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8936336040496826
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.841921329498291
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.364 Vali Acc: 0.868 Test Loss: 0.364 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8957204818725586
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.047860622406006
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.377 Vali Acc: 0.862 Test Loss: 0.377 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7628428936004639
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.836 Test Loss: 0.380 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1792080402374268
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9039983749389648
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.393 Vali Acc: 0.868 Test Loss: 0.393 Test Acc: 0.868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 11031556
model size : 44.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.297151327133179
Epoch: 1, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.313 Vali Acc: 0.434 Test Loss: 1.313 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 3.7151758670806885
Epoch: 2, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.130 Vali Acc: 0.592 Test Loss: 1.130 Test Acc: 0.592
Validation loss decreased (-0.434197 --> -0.592094).  Saving model ...
Epoch: 3 cost time: 4.003464698791504
Epoch: 3, Steps: 10 | Train Loss: 0.926 Vali Loss: 0.903 Vali Acc: 0.691 Test Loss: 0.903 Test Acc: 0.691
Validation loss decreased (-0.592094 --> -0.690780).  Saving model ...
Epoch: 4 cost time: 4.389458417892456
Epoch: 4, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
Validation loss decreased (-0.690780 --> -0.815783).  Saving model ...
Epoch: 5 cost time: 4.480087757110596
Epoch: 5, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.823458671569824
Epoch: 6, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.398 Vali Acc: 0.816 Test Loss: 0.398 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815785).  Saving model ...
Epoch: 7 cost time: 4.674541711807251
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 8 cost time: 4.152238130569458
Epoch: 8, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.457 Vali Acc: 0.836 Test Loss: 0.457 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.005615472793579
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.431 Vali Acc: 0.836 Test Loss: 0.431 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.107822895050049
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.434 Vali Acc: 0.842 Test Loss: 0.434 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 11 cost time: 4.43540620803833
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.441 Vali Acc: 0.849 Test Loss: 0.441 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 12 cost time: 4.1412646770477295
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 13 cost time: 3.3540711402893066
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.472 Vali Acc: 0.849 Test Loss: 0.472 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1224539279937744
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9106016159057617
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.862 Test Loss: 0.498 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861837).  Saving model ...
Epoch: 16 cost time: 3.8862814903259277
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.849 Test Loss: 0.531 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.2872090339660645
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.578 Vali Acc: 0.836 Test Loss: 0.578 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.752284049987793
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.465188026428223
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.557 Vali Acc: 0.842 Test Loss: 0.557 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.55460786819458
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.20698356628418
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.855 Test Loss: 0.563 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.52748441696167
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.849 Test Loss: 0.580 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.709187269210815
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.842 Test Loss: 0.598 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.30937385559082
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.842 Test Loss: 0.606 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.660361051559448
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.849 Test Loss: 0.617 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 18764804
model size : 74.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7079107761383057
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.333 Vali Acc: 0.382 Test Loss: 1.333 Test Acc: 0.382
Validation loss decreased (inf --> -0.381566).  Saving model ...
Epoch: 2 cost time: 1.7934486865997314
Epoch: 2, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.128 Vali Acc: 0.651 Test Loss: 1.128 Test Acc: 0.651
Validation loss decreased (-0.381566 --> -0.651305).  Saving model ...
Epoch: 3 cost time: 1.8459398746490479
Epoch: 3, Steps: 10 | Train Loss: 0.969 Vali Loss: 0.885 Vali Acc: 0.776 Test Loss: 0.885 Test Acc: 0.776
Validation loss decreased (-0.651305 --> -0.776307).  Saving model ...
Epoch: 4 cost time: 1.5821654796600342
Epoch: 4, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.662 Vali Acc: 0.836 Test Loss: 0.662 Test Acc: 0.836
Validation loss decreased (-0.776307 --> -0.835520).  Saving model ...
Epoch: 5 cost time: 1.4926838874816895
Epoch: 5, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.482 Vali Acc: 0.836 Test Loss: 0.482 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835521).  Saving model ...
Epoch: 6 cost time: 2.000838041305542
Epoch: 6, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.835521 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.939537525177002
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.343 Vali Acc: 0.862 Test Loss: 0.343 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1304633617401123
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.307 Vali Acc: 0.882 Test Loss: 0.307 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881576).  Saving model ...
Epoch: 9 cost time: 1.7949752807617188
Epoch: 9, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.334 Vali Acc: 0.875 Test Loss: 0.334 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.121894359588623
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.351 Vali Acc: 0.868 Test Loss: 0.351 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0458452701568604
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.366 Vali Acc: 0.882 Test Loss: 0.366 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.098262310028076
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9774298667907715
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.413 Vali Acc: 0.868 Test Loss: 0.413 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8300538063049316
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0889906883239746
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8337202072143555
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.416 Vali Acc: 0.868 Test Loss: 0.416 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0499236583709717
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8138651847839355
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 5525508
model size : 23.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.330589056015015
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.317 Vali Acc: 0.421 Test Loss: 1.317 Test Acc: 0.421
Validation loss decreased (inf --> -0.421039).  Saving model ...
Epoch: 2 cost time: 3.553931713104248
Epoch: 2, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.150 Vali Acc: 0.612 Test Loss: 1.150 Test Acc: 0.612
Validation loss decreased (-0.421039 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 3.1931118965148926
Epoch: 3, Steps: 10 | Train Loss: 0.983 Vali Loss: 0.948 Vali Acc: 0.671 Test Loss: 0.948 Test Acc: 0.671
Validation loss decreased (-0.611831 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 2.772073745727539
Epoch: 4, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
Validation loss decreased (-0.671043 --> -0.782888).  Saving model ...
Epoch: 5 cost time: 3.0768566131591797
Epoch: 5, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
Validation loss decreased (-0.782888 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 3.371088981628418
Epoch: 6, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.452 Vali Acc: 0.809 Test Loss: 0.452 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 7 cost time: 3.053340435028076
Epoch: 7, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.418 Vali Acc: 0.849 Test Loss: 0.418 Test Acc: 0.849
Validation loss decreased (-0.809206 --> -0.848680).  Saving model ...
Epoch: 8 cost time: 2.6503403186798096
Epoch: 8, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.524 Vali Acc: 0.829 Test Loss: 0.524 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.654310941696167
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.455 Vali Acc: 0.842 Test Loss: 0.455 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0585544109344482
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.225571632385254
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9944839477539062
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.836 Test Loss: 0.509 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1027183532714844
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.064336061477661
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.549 Vali Acc: 0.836 Test Loss: 0.549 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.13966965675354
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.542 Vali Acc: 0.842 Test Loss: 0.542 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.276012420654297
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.570 Vali Acc: 0.836 Test Loss: 0.570 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7672648429870605
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.597 Vali Acc: 0.842 Test Loss: 0.597 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 18764804
model size : 74.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9061717987060547
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.337 Vali Acc: 0.375 Test Loss: 1.337 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2801940441131592
Epoch: 2, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.150 Vali Acc: 0.618 Test Loss: 1.150 Test Acc: 0.618
Validation loss decreased (-0.374987 --> -0.618410).  Saving model ...
Epoch: 3 cost time: 1.54365873336792
Epoch: 3, Steps: 10 | Train Loss: 1.006 Vali Loss: 0.924 Vali Acc: 0.737 Test Loss: 0.924 Test Acc: 0.737
Validation loss decreased (-0.618410 --> -0.736833).  Saving model ...
Epoch: 4 cost time: 1.1074285507202148
Epoch: 4, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.716 Vali Acc: 0.816 Test Loss: 0.716 Test Acc: 0.816
Validation loss decreased (-0.736833 --> -0.815782).  Saving model ...
Epoch: 5 cost time: 1.29372239112854
Epoch: 5, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.538 Vali Acc: 0.836 Test Loss: 0.538 Test Acc: 0.836
Validation loss decreased (-0.815782 --> -0.835521).  Saving model ...
Epoch: 6 cost time: 1.5242397785186768
Epoch: 6, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.415 Vali Acc: 0.868 Test Loss: 0.415 Test Acc: 0.868
Validation loss decreased (-0.835521 --> -0.868417).  Saving model ...
Epoch: 7 cost time: 1.3583450317382812
Epoch: 7, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.366 Vali Acc: 0.868 Test Loss: 0.366 Test Acc: 0.868
Validation loss decreased (-0.868417 --> -0.868417).  Saving model ...
Epoch: 8 cost time: 1.4487113952636719
Epoch: 8, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.347 Vali Acc: 0.868 Test Loss: 0.347 Test Acc: 0.868
Validation loss decreased (-0.868417 --> -0.868418).  Saving model ...
Epoch: 9 cost time: 1.7066586017608643
Epoch: 9, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.374 Vali Acc: 0.868 Test Loss: 0.374 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6044316291809082
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3082239627838135
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.390 Vali Acc: 0.862 Test Loss: 0.390 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.575226068496704
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.415 Vali Acc: 0.849 Test Loss: 0.415 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3501853942871094
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1972894668579102
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.429 Vali Acc: 0.868 Test Loss: 0.429 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.164992094039917
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.849 Test Loss: 0.454 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.371607780456543
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.341783046722412
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8670976161956787
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 5525508
model size : 23.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.558816432952881
Epoch: 1, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.324 Vali Acc: 0.421 Test Loss: 1.324 Test Acc: 0.421
Validation loss decreased (inf --> -0.421039).  Saving model ...
Epoch: 2 cost time: 2.258761405944824
Epoch: 2, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.181 Vali Acc: 0.599 Test Loss: 1.181 Test Acc: 0.599
Validation loss decreased (-0.421039 --> -0.598672).  Saving model ...
Epoch: 3 cost time: 2.080864906311035
Epoch: 3, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.011 Vali Acc: 0.658 Test Loss: 1.011 Test Acc: 0.658
Validation loss decreased (-0.598672 --> -0.657885).  Saving model ...
Epoch: 4 cost time: 2.4655675888061523
Epoch: 4, Steps: 10 | Train Loss: 0.784 Vali Loss: 0.805 Vali Acc: 0.763 Test Loss: 0.805 Test Acc: 0.763
Validation loss decreased (-0.657885 --> -0.763150).  Saving model ...
Epoch: 5 cost time: 2.40425968170166
Epoch: 5, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
Validation loss decreased (-0.763150 --> -0.815783).  Saving model ...
Epoch: 6 cost time: 2.3301796913146973
Epoch: 6, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.473 Vali Acc: 0.822 Test Loss: 0.473 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822364).  Saving model ...
Epoch: 7 cost time: 1.9558773040771484
Epoch: 7, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.393 Vali Acc: 0.822 Test Loss: 0.393 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 8 cost time: 2.1525049209594727
Epoch: 8, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.401 Vali Acc: 0.836 Test Loss: 0.401 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 9 cost time: 1.8604607582092285
Epoch: 9, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.375 Vali Acc: 0.836 Test Loss: 0.375 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835523).  Saving model ...
Epoch: 10 cost time: 2.187803030014038
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.393 Vali Acc: 0.849 Test Loss: 0.393 Test Acc: 0.849
Validation loss decreased (-0.835523 --> -0.848680).  Saving model ...
Epoch: 11 cost time: 2.338042736053467
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.390 Vali Acc: 0.836 Test Loss: 0.390 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.196526527404785
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 13 cost time: 2.5292603969573975
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5100812911987305
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.456 Vali Acc: 0.842 Test Loss: 0.456 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9434986114501953
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.550539255142212
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.489 Vali Acc: 0.842 Test Loss: 0.489 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1055550575256348
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.487 Vali Acc: 0.829 Test Loss: 0.487 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.844377279281616
Epoch: 18, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.499 Vali Acc: 0.836 Test Loss: 0.499 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.767390251159668
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.506 Vali Acc: 0.849 Test Loss: 0.506 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.9112586975097656
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.504 Vali Acc: 0.842 Test Loss: 0.504 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.651149034500122
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.535 Vali Acc: 0.842 Test Loss: 0.535 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6893091201782227
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.842 Test Loss: 0.552 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 18764804
model size : 74.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1872992515563965
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.345 Vali Acc: 0.336 Test Loss: 1.345 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.5030622482299805
Epoch: 2, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.184 Vali Acc: 0.586 Test Loss: 1.184 Test Acc: 0.586
Validation loss decreased (-0.335513 --> -0.585514).  Saving model ...
Epoch: 3 cost time: 1.4500732421875
Epoch: 3, Steps: 10 | Train Loss: 1.065 Vali Loss: 0.983 Vali Acc: 0.730 Test Loss: 0.983 Test Acc: 0.730
Validation loss decreased (-0.585514 --> -0.730253).  Saving model ...
Epoch: 4 cost time: 1.470890760421753
Epoch: 4, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.799 Vali Acc: 0.789 Test Loss: 0.799 Test Acc: 0.789
Validation loss decreased (-0.730253 --> -0.789466).  Saving model ...
Epoch: 5 cost time: 1.2918367385864258
Epoch: 5, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796046).  Saving model ...
Epoch: 6 cost time: 1.5160529613494873
Epoch: 6, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
Validation loss decreased (-0.796046 --> -0.855258).  Saving model ...
Epoch: 7 cost time: 1.4734716415405273
Epoch: 7, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861838).  Saving model ...
Epoch: 8 cost time: 1.136932134628296
Epoch: 8, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.358 Vali Acc: 0.855 Test Loss: 0.358 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.338160753250122
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861839).  Saving model ...
Epoch: 10 cost time: 1.3944509029388428
Epoch: 10, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.342 Vali Acc: 0.862 Test Loss: 0.342 Test Acc: 0.862
Validation loss decreased (-0.861839 --> -0.861839).  Saving model ...
Epoch: 11 cost time: 1.3193373680114746
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.334 Vali Acc: 0.855 Test Loss: 0.334 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3846378326416016
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.358 Vali Acc: 0.862 Test Loss: 0.358 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3534653186798096
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.344 Vali Acc: 0.862 Test Loss: 0.344 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4272871017456055
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.347 Vali Acc: 0.862 Test Loss: 0.347 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3111155033111572
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.368 Vali Acc: 0.849 Test Loss: 0.368 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.365891456604004
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.365 Vali Acc: 0.855 Test Loss: 0.365 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4931414127349854
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.375 Vali Acc: 0.862 Test Loss: 0.375 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4683308601379395
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.259432077407837
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2971408367156982
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.404 Vali Acc: 0.868 Test Loss: 0.404 Test Acc: 0.868
Validation loss decreased (-0.861839 --> -0.868417).  Saving model ...
Epoch: 21 cost time: 1.4055488109588623
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.395 Vali Acc: 0.862 Test Loss: 0.395 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.269731044769287
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.413 Vali Acc: 0.868 Test Loss: 0.413 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2209861278533936
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.336446762084961
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.413 Vali Acc: 0.868 Test Loss: 0.413 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2992534637451172
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.868 Test Loss: 0.419 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3373568058013916
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874996).  Saving model ...
Epoch: 27 cost time: 1.3056597709655762
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.868 Test Loss: 0.425 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4816720485687256
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.427 Vali Acc: 0.868 Test Loss: 0.427 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4580724239349365
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.868 Test Loss: 0.432 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4769361019134521
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.868 Test Loss: 0.437 Test Acc: 0.868
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 5525508
model size : 23.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 7.043473958969116
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.375 Vali Acc: 0.276 Test Loss: 1.375 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 4.8571937084198
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.216 Vali Acc: 0.480 Test Loss: 1.216 Test Acc: 0.480
Validation loss decreased (-0.276302 --> -0.480251).  Saving model ...
Epoch: 3 cost time: 5.3548901081085205
Epoch: 3, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.016 Vali Acc: 0.711 Test Loss: 1.016 Test Acc: 0.711
Validation loss decreased (-0.480251 --> -0.710516).  Saving model ...
Epoch: 4 cost time: 5.587415933609009
Epoch: 4, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
Validation loss decreased (-0.710516 --> -0.809203).  Saving model ...
Epoch: 5 cost time: 5.291798114776611
Epoch: 5, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809205).  Saving model ...
Epoch: 6 cost time: 5.148927450180054
Epoch: 6, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
Validation loss decreased (-0.809205 --> -0.855259).  Saving model ...
Epoch: 7 cost time: 5.571501731872559
Epoch: 7, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.596029758453369
Epoch: 8, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.413 Vali Acc: 0.842 Test Loss: 0.413 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.497873783111572
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
Epoch: 10 cost time: 4.927212715148926
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.490 Vali Acc: 0.829 Test Loss: 0.490 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.895570755004883
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.567 Vali Acc: 0.836 Test Loss: 0.567 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.269877672195435
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.500 Vali Acc: 0.836 Test Loss: 0.500 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.3658082485198975
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.46209979057312
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.551 Vali Acc: 0.849 Test Loss: 0.551 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.7015345096588135
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.459576845169067
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.716 Vali Acc: 0.809 Test Loss: 0.716 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.712973356246948
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.619101285934448
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.703 Vali Acc: 0.829 Test Loss: 0.703 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.323590040206909
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.714 Vali Acc: 0.829 Test Loss: 0.714 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 18756356
model size : 72.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.366783142089844
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.336 Vali Acc: 0.395 Test Loss: 1.336 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 2.6170785427093506
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.184 Vali Acc: 0.513 Test Loss: 1.184 Test Acc: 0.513
Validation loss decreased (-0.394723 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 2.591183662414551
Epoch: 3, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.017 Vali Acc: 0.684 Test Loss: 1.017 Test Acc: 0.684
Validation loss decreased (-0.513146 --> -0.684200).  Saving model ...
Epoch: 4 cost time: 2.1200902462005615
Epoch: 4, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.821 Vali Acc: 0.770 Test Loss: 0.821 Test Acc: 0.770
Validation loss decreased (-0.684200 --> -0.769729).  Saving model ...
Epoch: 5 cost time: 2.175246238708496
Epoch: 5, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
Validation loss decreased (-0.769729 --> -0.802625).  Saving model ...
Epoch: 6 cost time: 2.4248087406158447
Epoch: 6, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.046482563018799
Epoch: 7, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.438 Vali Acc: 0.816 Test Loss: 0.438 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815785).  Saving model ...
Epoch: 8 cost time: 2.143284559249878
Epoch: 8, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.391 Vali Acc: 0.836 Test Loss: 0.391 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 9 cost time: 2.5308115482330322
Epoch: 9, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.378 Vali Acc: 0.829 Test Loss: 0.378 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.27638578414917
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.370 Vali Acc: 0.849 Test Loss: 0.370 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848681).  Saving model ...
Epoch: 11 cost time: 2.251641035079956
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.371 Vali Acc: 0.868 Test Loss: 0.371 Test Acc: 0.868
Validation loss decreased (-0.848681 --> -0.868417).  Saving model ...
Epoch: 12 cost time: 2.490302085876465
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.373 Vali Acc: 0.849 Test Loss: 0.373 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2041208744049072
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.096182346343994
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2637810707092285
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2390313148498535
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2514352798461914
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.436445474624634
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6036689281463623
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2966690063476562
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 2.36551833152771
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4012632369995117
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.601 Vali Acc: 0.829 Test Loss: 0.601 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.119863510131836
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.570 Vali Acc: 0.836 Test Loss: 0.570 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8836333751678467
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.829 Test Loss: 0.573 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.249422073364258
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.736 Vali Acc: 0.796 Test Loss: 0.736 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.27812123298645
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.157627820968628
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.572 Vali Acc: 0.829 Test Loss: 0.572 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.3830604553222656
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2624740600585938
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.467 Vali Acc: 0.842 Test Loss: 0.467 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7139220237731934
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.506 Vali Acc: 0.849 Test Loss: 0.506 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 5516804
model size : 22.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.233494997024536
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 3.518308639526367
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.252 Vali Acc: 0.421 Test Loss: 1.252 Test Acc: 0.421
Validation loss decreased (-0.282881 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 3.362928867340088
Epoch: 3, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.086 Vali Acc: 0.625 Test Loss: 1.086 Test Acc: 0.625
Validation loss decreased (-0.421040 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 3.518371105194092
Epoch: 4, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.889 Vali Acc: 0.770 Test Loss: 0.889 Test Acc: 0.770
Validation loss decreased (-0.624989 --> -0.769728).  Saving model ...
Epoch: 5 cost time: 4.385125160217285
Epoch: 5, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
Validation loss decreased (-0.769728 --> -0.802625).  Saving model ...
Epoch: 6 cost time: 4.452637195587158
Epoch: 6, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 4.069754362106323
Epoch: 7, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.479 Vali Acc: 0.829 Test Loss: 0.479 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828943).  Saving model ...
Epoch: 8 cost time: 3.724250555038452
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.459 Vali Acc: 0.789 Test Loss: 0.459 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.941850423812866
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.462 Vali Acc: 0.822 Test Loss: 0.462 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.088918209075928
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.223805904388428
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.622652053833008
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.726909160614014
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.122817277908325
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.584 Vali Acc: 0.836 Test Loss: 0.584 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835520).  Saving model ...
Epoch: 15 cost time: 3.8640682697296143
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.603 Vali Acc: 0.816 Test Loss: 0.603 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.127562522888184
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.678985595703125
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.362914562225342
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.742 Vali Acc: 0.803 Test Loss: 0.742 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.36707615852356
Epoch: 19, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.677 Vali Acc: 0.822 Test Loss: 0.677 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.3567795753479
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.538 Vali Acc: 0.842 Test Loss: 0.538 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842100).  Saving model ...
Epoch: 21 cost time: 4.361279010772705
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.563 Vali Acc: 0.829 Test Loss: 0.563 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7798144817352295
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.548 Vali Acc: 0.829 Test Loss: 0.548 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.48333477973938
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.557 Vali Acc: 0.836 Test Loss: 0.557 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.676600694656372
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.581 Vali Acc: 0.829 Test Loss: 0.581 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.457394361495972
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.013849496841431
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.829 Test Loss: 0.621 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.269194841384888
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.583 Vali Acc: 0.842 Test Loss: 0.583 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.192627429962158
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.829 Test Loss: 0.567 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.745237350463867
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.829 Test Loss: 0.584 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.0572509765625
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.836 Test Loss: 0.611 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 18756356
model size : 72.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.096533536911011
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 2.2883756160736084
Epoch: 2, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.208 Vali Acc: 0.526 Test Loss: 1.208 Test Acc: 0.526
Validation loss decreased (-0.374987 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 2.232495069503784
Epoch: 3, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.062 Vali Acc: 0.625 Test Loss: 1.062 Test Acc: 0.625
Validation loss decreased (-0.526304 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 2.32019305229187
Epoch: 4, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
Validation loss decreased (-0.624989 --> -0.717096).  Saving model ...
Epoch: 5 cost time: 2.1605165004730225
Epoch: 5, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.718 Vali Acc: 0.776 Test Loss: 0.718 Test Acc: 0.776
Validation loss decreased (-0.717096 --> -0.776309).  Saving model ...
Epoch: 6 cost time: 2.2331745624542236
Epoch: 6, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 2.0876853466033936
Epoch: 7, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 2.322650194168091
Epoch: 8, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 9 cost time: 2.3629720211029053
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.456 Vali Acc: 0.816 Test Loss: 0.456 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 10 cost time: 2.1545143127441406
Epoch: 10, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.192582845687866
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.468 Vali Acc: 0.816 Test Loss: 0.468 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9892480373382568
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6326844692230225
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 14 cost time: 1.7380883693695068
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.501 Vali Acc: 0.822 Test Loss: 0.501 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.792266607284546
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.030121326446533
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.544 Vali Acc: 0.842 Test Loss: 0.544 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842100).  Saving model ...
Epoch: 17 cost time: 1.9163117408752441
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.096498966217041
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.550 Vali Acc: 0.849 Test Loss: 0.550 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848679).  Saving model ...
Epoch: 19 cost time: 2.064074993133545
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3710272312164307
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.522 Vali Acc: 0.842 Test Loss: 0.522 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1413512229919434
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.552 Vali Acc: 0.849 Test Loss: 0.552 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.135462999343872
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
Validation loss decreased (-0.848679 --> -0.855258).  Saving model ...
Epoch: 23 cost time: 2.1707775592803955
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.849 Test Loss: 0.524 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.299907922744751
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3665049076080322
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861836).  Saving model ...
Epoch: 26 cost time: 1.9441676139831543
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.842 Test Loss: 0.565 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.113795757293701
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.573 Vali Acc: 0.842 Test Loss: 0.573 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.131748676300049
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.631 Vali Acc: 0.855 Test Loss: 0.631 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.233813524246216
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.842 Test Loss: 0.634 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0464203357696533
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.849 Test Loss: 0.597 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 5516804
model size : 22.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.136378765106201
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.395 Vali Acc: 0.263 Test Loss: 1.395 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 3.2151663303375244
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.285 Vali Acc: 0.375 Test Loss: 1.285 Test Acc: 0.375
Validation loss decreased (-0.263144 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 3.195253372192383
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.145 Vali Acc: 0.572 Test Loss: 1.145 Test Acc: 0.572
Validation loss decreased (-0.374987 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 3.0728979110717773
Epoch: 4, Steps: 10 | Train Loss: 1.026 Vali Loss: 0.982 Vali Acc: 0.711 Test Loss: 0.982 Test Acc: 0.711
Validation loss decreased (-0.572357 --> -0.710516).  Saving model ...
Epoch: 5 cost time: 3.338357925415039
Epoch: 5, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
Validation loss decreased (-0.710516 --> -0.802624).  Saving model ...
Epoch: 6 cost time: 3.4026923179626465
Epoch: 6, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.644 Vali Acc: 0.816 Test Loss: 0.644 Test Acc: 0.816
Validation loss decreased (-0.802624 --> -0.815783).  Saving model ...
Epoch: 7 cost time: 3.3765573501586914
Epoch: 7, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.532 Vali Acc: 0.836 Test Loss: 0.532 Test Acc: 0.836
Validation loss decreased (-0.815783 --> -0.835521).  Saving model ...
Epoch: 8 cost time: 3.4646596908569336
Epoch: 8, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 9 cost time: 3.4062132835388184
Epoch: 9, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.419 Vali Acc: 0.868 Test Loss: 0.419 Test Acc: 0.868
Validation loss decreased (-0.835522 --> -0.868417).  Saving model ...
Epoch: 10 cost time: 3.2761621475219727
Epoch: 10, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3098127841949463
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.403 Vali Acc: 0.842 Test Loss: 0.403 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4606893062591553
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.396 Vali Acc: 0.822 Test Loss: 0.396 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2275819778442383
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.397 Vali Acc: 0.842 Test Loss: 0.397 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1746981143951416
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2560925483703613
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.401 Vali Acc: 0.842 Test Loss: 0.401 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.5522677898406982
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.413 Vali Acc: 0.842 Test Loss: 0.413 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.851687431335449
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.410 Vali Acc: 0.836 Test Loss: 0.410 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5821447372436523
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.413 Vali Acc: 0.829 Test Loss: 0.413 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5737948417663574
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.431 Vali Acc: 0.842 Test Loss: 0.431 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 18756356
model size : 72.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7196390628814697
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.355 Vali Acc: 0.355 Test Loss: 1.355 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.8191378116607666
Epoch: 2, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.245 Vali Acc: 0.487 Test Loss: 1.245 Test Acc: 0.487
Validation loss decreased (-0.355250 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.9150397777557373
Epoch: 3, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.124 Vali Acc: 0.592 Test Loss: 1.124 Test Acc: 0.592
Validation loss decreased (-0.486830 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 1.6939663887023926
Epoch: 4, Steps: 10 | Train Loss: 0.976 Vali Loss: 0.978 Vali Acc: 0.697 Test Loss: 0.978 Test Acc: 0.697
Validation loss decreased (-0.592094 --> -0.697359).  Saving model ...
Epoch: 5 cost time: 1.950998306274414
Epoch: 5, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.820 Vali Acc: 0.776 Test Loss: 0.820 Test Acc: 0.776
Validation loss decreased (-0.697359 --> -0.776308).  Saving model ...
Epoch: 6 cost time: 1.8002512454986572
Epoch: 6, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
Validation loss decreased (-0.776308 --> -0.796046).  Saving model ...
Epoch: 7 cost time: 1.8163387775421143
Epoch: 7, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.563 Vali Acc: 0.829 Test Loss: 0.563 Test Acc: 0.829
Validation loss decreased (-0.796046 --> -0.828942).  Saving model ...
Epoch: 8 cost time: 1.7509889602661133
Epoch: 8, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.492 Vali Acc: 0.842 Test Loss: 0.492 Test Acc: 0.842
Validation loss decreased (-0.828942 --> -0.842100).  Saving model ...
Epoch: 9 cost time: 1.8266329765319824
Epoch: 9, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 10 cost time: 1.7423982620239258
Epoch: 10, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.842101 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 1.38238525390625
Epoch: 11, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 12 cost time: 1.6907086372375488
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5455594062805176
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 1.645862102508545
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.326 Vali Acc: 0.888 Test Loss: 0.326 Test Acc: 0.888
Validation loss decreased (-0.874997 --> -0.888155).  Saving model ...
Epoch: 15 cost time: 1.3709917068481445
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.320 Vali Acc: 0.888 Test Loss: 0.320 Test Acc: 0.888
Validation loss decreased (-0.888155 --> -0.888155).  Saving model ...
Epoch: 16 cost time: 1.5750446319580078
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.326 Vali Acc: 0.882 Test Loss: 0.326 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.644334316253662
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.335 Vali Acc: 0.868 Test Loss: 0.335 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5543808937072754
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6775293350219727
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.382 Vali Acc: 0.862 Test Loss: 0.382 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6722474098205566
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.389 Vali Acc: 0.882 Test Loss: 0.389 Test Acc: 0.882
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.775115728378296
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.405 Vali Acc: 0.882 Test Loss: 0.405 Test Acc: 0.882
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7678935527801514
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8856761455535889
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6421165466308594
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.389 Vali Acc: 0.849 Test Loss: 0.389 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8287677764892578
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.379 Vali Acc: 0.875 Test Loss: 0.379 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 5516804
model size : 22.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.0689520835876465
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.341 Vali Acc: 0.309 Test Loss: 1.341 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 3.253366470336914
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.221 Vali Acc: 0.454 Test Loss: 1.221 Test Acc: 0.454
Validation loss decreased (-0.309197 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 2.8852968215942383
Epoch: 3, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.058 Vali Acc: 0.717 Test Loss: 1.058 Test Acc: 0.717
Validation loss decreased (-0.453935 --> -0.717095).  Saving model ...
Epoch: 4 cost time: 3.0591087341308594
Epoch: 4, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.865 Vali Acc: 0.763 Test Loss: 0.865 Test Acc: 0.763
Validation loss decreased (-0.717095 --> -0.763149).  Saving model ...
Epoch: 5 cost time: 3.0758004188537598
Epoch: 5, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.665 Vali Acc: 0.816 Test Loss: 0.665 Test Acc: 0.816
Validation loss decreased (-0.763149 --> -0.815783).  Saving model ...
Epoch: 6 cost time: 2.919386863708496
Epoch: 6, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.511 Vali Acc: 0.842 Test Loss: 0.511 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842100).  Saving model ...
Epoch: 7 cost time: 3.1039531230926514
Epoch: 7, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.414 Vali Acc: 0.842 Test Loss: 0.414 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 8 cost time: 3.2038917541503906
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.391 Vali Acc: 0.849 Test Loss: 0.391 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 9 cost time: 3.242454767227173
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.848680 --> -0.861838).  Saving model ...
Epoch: 10 cost time: 3.565622091293335
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.441 Vali Acc: 0.829 Test Loss: 0.441 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3862979412078857
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.447 Vali Acc: 0.849 Test Loss: 0.447 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.328248977661133
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.467 Vali Acc: 0.842 Test Loss: 0.467 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3388404846191406
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.513 Vali Acc: 0.829 Test Loss: 0.513 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4234251976013184
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0054104328155518
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8966763019561768
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.616 Vali Acc: 0.836 Test Loss: 0.616 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.475600481033325
Epoch: 17, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.699 Vali Acc: 0.842 Test Loss: 0.699 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9873719215393066
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1768128871917725
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.605 Vali Acc: 0.855 Test Loss: 0.605 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 9383172
model size : 37.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4968037605285645
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.381 Vali Acc: 0.349 Test Loss: 1.381 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.5656094551086426
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.267 Vali Acc: 0.454 Test Loss: 1.267 Test Acc: 0.454
Validation loss decreased (-0.348670 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.653874397277832
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.122 Vali Acc: 0.638 Test Loss: 1.122 Test Acc: 0.638
Validation loss decreased (-0.453935 --> -0.638147).  Saving model ...
Epoch: 4 cost time: 1.9331555366516113
Epoch: 4, Steps: 10 | Train Loss: 0.951 Vali Loss: 0.971 Vali Acc: 0.724 Test Loss: 0.971 Test Acc: 0.724
Validation loss decreased (-0.638147 --> -0.723675).  Saving model ...
Epoch: 5 cost time: 1.972843885421753
Epoch: 5, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.815 Vali Acc: 0.763 Test Loss: 0.815 Test Acc: 0.763
Validation loss decreased (-0.723675 --> -0.763150).  Saving model ...
Epoch: 6 cost time: 1.987534761428833
Epoch: 6, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.667 Vali Acc: 0.829 Test Loss: 0.667 Test Acc: 0.829
Validation loss decreased (-0.763150 --> -0.828941).  Saving model ...
Epoch: 7 cost time: 1.8970422744750977
Epoch: 7, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.552 Vali Acc: 0.849 Test Loss: 0.552 Test Acc: 0.849
Validation loss decreased (-0.828941 --> -0.848679).  Saving model ...
Epoch: 8 cost time: 1.841714859008789
Epoch: 8, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
Validation loss decreased (-0.848679 --> -0.861837).  Saving model ...
Epoch: 9 cost time: 1.691432237625122
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.861837 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 1.7054247856140137
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.378 Vali Acc: 0.868 Test Loss: 0.378 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.855508804321289
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.354 Vali Acc: 0.888 Test Loss: 0.354 Test Acc: 0.888
Validation loss decreased (-0.874996 --> -0.888154).  Saving model ...
Epoch: 12 cost time: 1.766968011856079
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8642115592956543
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.361 Vali Acc: 0.882 Test Loss: 0.361 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9033854007720947
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.75441575050354
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5527105331420898
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.399 Vali Acc: 0.888 Test Loss: 0.399 Test Acc: 0.888
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5992341041564941
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6558618545532227
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.401 Vali Acc: 0.882 Test Loss: 0.401 Test Acc: 0.882
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8540661334991455
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.425 Vali Acc: 0.895 Test Loss: 0.425 Test Acc: 0.895
Validation loss decreased (-0.888154 --> -0.894733).  Saving model ...
Epoch: 20 cost time: 1.8920598030090332
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.603954792022705
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.440 Vali Acc: 0.882 Test Loss: 0.440 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6689121723175049
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.436 Vali Acc: 0.868 Test Loss: 0.436 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6261265277862549
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.43654203414917
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.882 Test Loss: 0.459 Test Acc: 0.882
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5873074531555176
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9216430187225342
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5231976509094238
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.895 Test Loss: 0.466 Test Acc: 0.895
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4916188716888428
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.875 Test Loss: 0.501 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.494520902633667
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8947368421052632
model parameter : 2763268
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.692783355712891
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.346 Vali Acc: 0.322 Test Loss: 1.346 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 2.70304012298584
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.241 Vali Acc: 0.434 Test Loss: 1.241 Test Acc: 0.434
Validation loss decreased (-0.322355 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 2.6722989082336426
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.101 Vali Acc: 0.671 Test Loss: 1.101 Test Acc: 0.671
Validation loss decreased (-0.434198 --> -0.671042).  Saving model ...
Epoch: 4 cost time: 2.7293484210968018
Epoch: 4, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.935 Vali Acc: 0.789 Test Loss: 0.935 Test Acc: 0.789
Validation loss decreased (-0.671042 --> -0.789464).  Saving model ...
Epoch: 5 cost time: 2.558781147003174
Epoch: 5, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.749 Vali Acc: 0.796 Test Loss: 0.749 Test Acc: 0.796
Validation loss decreased (-0.789464 --> -0.796045).  Saving model ...
Epoch: 6 cost time: 2.4123499393463135
Epoch: 6, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
Validation loss decreased (-0.796045 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 2.627669334411621
Epoch: 7, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822364).  Saving model ...
Epoch: 8 cost time: 2.3716444969177246
Epoch: 8, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 9 cost time: 2.622879981994629
Epoch: 9, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.426 Vali Acc: 0.829 Test Loss: 0.426 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.660865068435669
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.434 Vali Acc: 0.842 Test Loss: 0.434 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 11 cost time: 2.353652000427246
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5906686782836914
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7833948135375977
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.474 Vali Acc: 0.842 Test Loss: 0.474 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7410149574279785
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.414 Vali Acc: 0.842 Test Loss: 0.414 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 2.529996871948242
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8420627117156982
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.830765962600708
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.491 Vali Acc: 0.842 Test Loss: 0.491 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.819040536880493
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.513 Vali Acc: 0.836 Test Loss: 0.513 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7714478969573975
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.529 Vali Acc: 0.836 Test Loss: 0.529 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9619357585906982
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.541 Vali Acc: 0.842 Test Loss: 0.541 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.662964344024658
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.570 Vali Acc: 0.836 Test Loss: 0.570 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9189670085906982
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.678 Vali Acc: 0.842 Test Loss: 0.678 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.780996799468994
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7848916053771973
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 9383172
model size : 37.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5760319232940674
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.381 Vali Acc: 0.342 Test Loss: 1.381 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 1.686948299407959
Epoch: 2, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.279 Vali Acc: 0.447 Test Loss: 1.279 Test Acc: 0.447
Validation loss decreased (-0.342091 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 1.7655079364776611
Epoch: 3, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.147 Vali Acc: 0.612 Test Loss: 1.147 Test Acc: 0.612
Validation loss decreased (-0.447356 --> -0.611831).  Saving model ...
Epoch: 4 cost time: 1.7756192684173584
Epoch: 4, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.009 Vali Acc: 0.711 Test Loss: 1.009 Test Acc: 0.711
Validation loss decreased (-0.611831 --> -0.710516).  Saving model ...
Epoch: 5 cost time: 1.7306053638458252
Epoch: 5, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
Validation loss decreased (-0.710516 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.6639699935913086
Epoch: 6, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
Validation loss decreased (-0.749991 --> -0.796045).  Saving model ...
Epoch: 7 cost time: 1.7854199409484863
Epoch: 7, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.607 Vali Acc: 0.829 Test Loss: 0.607 Test Acc: 0.829
Validation loss decreased (-0.796045 --> -0.828941).  Saving model ...
Epoch: 8 cost time: 1.8642354011535645
Epoch: 8, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.507 Vali Acc: 0.842 Test Loss: 0.507 Test Acc: 0.842
Validation loss decreased (-0.828941 --> -0.842100).  Saving model ...
Epoch: 9 cost time: 1.8758907318115234
Epoch: 9, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.842100 --> -0.861838).  Saving model ...
Epoch: 10 cost time: 1.7508459091186523
Epoch: 10, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.405 Vali Acc: 0.842 Test Loss: 0.405 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8382062911987305
Epoch: 11, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.365 Vali Acc: 0.882 Test Loss: 0.365 Test Acc: 0.882
Validation loss decreased (-0.861838 --> -0.881575).  Saving model ...
Epoch: 12 cost time: 1.9497489929199219
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8253498077392578
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.352 Vali Acc: 0.868 Test Loss: 0.352 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7738080024719238
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.373 Vali Acc: 0.868 Test Loss: 0.373 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.837733507156372
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9489970207214355
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8166766166687012
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.376 Vali Acc: 0.868 Test Loss: 0.376 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.638303279876709
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.372 Vali Acc: 0.868 Test Loss: 0.372 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5514228343963623
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.390 Vali Acc: 0.875 Test Loss: 0.390 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8238410949707031
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.401 Vali Acc: 0.868 Test Loss: 0.401 Test Acc: 0.868
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7324280738830566
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.881578947368421
model parameter : 2763268
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.01630973815918
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.351 Vali Acc: 0.309 Test Loss: 1.351 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.0686872005462646
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.265 Vali Acc: 0.401 Test Loss: 1.265 Test Acc: 0.401
Validation loss decreased (-0.309197 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 2.1420974731445312
Epoch: 3, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.149 Vali Acc: 0.599 Test Loss: 1.149 Test Acc: 0.599
Validation loss decreased (-0.401303 --> -0.598673).  Saving model ...
Epoch: 4 cost time: 2.1240594387054443
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.017 Vali Acc: 0.717 Test Loss: 1.017 Test Acc: 0.717
Validation loss decreased (-0.598673 --> -0.717095).  Saving model ...
Epoch: 5 cost time: 2.2877349853515625
Epoch: 5, Steps: 10 | Train Loss: 0.858 Vali Loss: 0.865 Vali Acc: 0.770 Test Loss: 0.865 Test Acc: 0.770
Validation loss decreased (-0.717095 --> -0.769728).  Saving model ...
Epoch: 6 cost time: 2.299232244491577
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
Validation loss decreased (-0.769728 --> -0.809203).  Saving model ...
Epoch: 7 cost time: 2.1547329425811768
Epoch: 7, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.179124355316162
Epoch: 8, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
Validation loss decreased (-0.809203 --> -0.835521).  Saving model ...
Epoch: 9 cost time: 2.193077564239502
Epoch: 9, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.448 Vali Acc: 0.829 Test Loss: 0.448 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.277432680130005
Epoch: 10, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.186258316040039
Epoch: 11, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.403 Vali Acc: 0.836 Test Loss: 0.403 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 12 cost time: 2.1775832176208496
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 13 cost time: 2.1354219913482666
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.385 Vali Acc: 0.842 Test Loss: 0.385 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 14 cost time: 2.135047435760498
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.379 Vali Acc: 0.842 Test Loss: 0.379 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 15 cost time: 1.9244823455810547
Epoch: 15, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.401 Vali Acc: 0.836 Test Loss: 0.401 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9829635620117188
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 17 cost time: 2.085359573364258
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.378 Vali Acc: 0.855 Test Loss: 0.378 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.873727798461914
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8131723403930664
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.383 Vali Acc: 0.855 Test Loss: 0.383 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.968273639678955
Epoch: 20, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.023969888687134
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.458 Vali Acc: 0.842 Test Loss: 0.458 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7546606063842773
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9969441890716553
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0115602016448975
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.479 Vali Acc: 0.842 Test Loss: 0.479 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.041407823562622
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.457 Vali Acc: 0.849 Test Loss: 0.457 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.863100528717041
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.461 Vali Acc: 0.842 Test Loss: 0.461 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 9383172
model size : 37.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.182018280029297
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.379 Vali Acc: 0.349 Test Loss: 1.379 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.4364423751831055
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.291 Vali Acc: 0.454 Test Loss: 1.291 Test Acc: 0.454
Validation loss decreased (-0.348670 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.4352552890777588
Epoch: 3, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.175 Vali Acc: 0.592 Test Loss: 1.175 Test Acc: 0.592
Validation loss decreased (-0.453934 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 1.4683911800384521
Epoch: 4, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.053 Vali Acc: 0.691 Test Loss: 1.053 Test Acc: 0.691
Validation loss decreased (-0.592094 --> -0.690779).  Saving model ...
Epoch: 5 cost time: 1.4546451568603516
Epoch: 5, Steps: 10 | Train Loss: 0.886 Vali Loss: 0.924 Vali Acc: 0.750 Test Loss: 0.924 Test Acc: 0.750
Validation loss decreased (-0.690779 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.3683359622955322
Epoch: 6, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.782887).  Saving model ...
Epoch: 7 cost time: 1.4326164722442627
Epoch: 7, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.681 Vali Acc: 0.796 Test Loss: 0.681 Test Acc: 0.796
Validation loss decreased (-0.782887 --> -0.796046).  Saving model ...
Epoch: 8 cost time: 1.576387643814087
Epoch: 8, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.582 Vali Acc: 0.829 Test Loss: 0.582 Test Acc: 0.829
Validation loss decreased (-0.796046 --> -0.828942).  Saving model ...
Epoch: 9 cost time: 1.4902946949005127
Epoch: 9, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.492 Vali Acc: 0.855 Test Loss: 0.492 Test Acc: 0.855
Validation loss decreased (-0.828942 --> -0.855258).  Saving model ...
Epoch: 10 cost time: 1.4580938816070557
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
Validation loss decreased (-0.855258 --> -0.861838).  Saving model ...
Epoch: 11 cost time: 1.3959453105926514
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
Validation loss decreased (-0.861838 --> -0.861838).  Saving model ...
Epoch: 12 cost time: 1.5638084411621094
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 13 cost time: 1.5035934448242188
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.352 Vali Acc: 0.882 Test Loss: 0.352 Test Acc: 0.882
Validation loss decreased (-0.874996 --> -0.881575).  Saving model ...
Epoch: 14 cost time: 1.451258897781372
Epoch: 14, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.344 Vali Acc: 0.882 Test Loss: 0.344 Test Acc: 0.882
Validation loss decreased (-0.881575 --> -0.881576).  Saving model ...
Epoch: 15 cost time: 1.42234468460083
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.346 Vali Acc: 0.882 Test Loss: 0.346 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4008007049560547
Epoch: 16, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.332 Vali Acc: 0.875 Test Loss: 0.332 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.385119915008545
Epoch: 17, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.336 Vali Acc: 0.888 Test Loss: 0.336 Test Acc: 0.888
Validation loss decreased (-0.881576 --> -0.888155).  Saving model ...
Epoch: 18 cost time: 1.3874504566192627
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.337 Vali Acc: 0.862 Test Loss: 0.337 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.398796558380127
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.346 Vali Acc: 0.855 Test Loss: 0.346 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4339187145233154
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.347 Vali Acc: 0.868 Test Loss: 0.347 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4859809875488281
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.344 Vali Acc: 0.855 Test Loss: 0.344 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4483637809753418
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.346 Vali Acc: 0.868 Test Loss: 0.346 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5390450954437256
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4697370529174805
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4914307594299316
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.352 Vali Acc: 0.875 Test Loss: 0.352 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.528777837753296
Epoch: 26, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.359 Vali Acc: 0.862 Test Loss: 0.359 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4932172298431396
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.379 Vali Acc: 0.868 Test Loss: 0.379 Test Acc: 0.868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 2763268
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.782917022705078
Epoch: 1, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.297 Vali Acc: 0.408 Test Loss: 1.297 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 2.8208277225494385
Epoch: 2, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.204 Vali Acc: 0.507 Test Loss: 1.204 Test Acc: 0.507
Validation loss decreased (-0.407882 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 2.779294490814209
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.085 Vali Acc: 0.572 Test Loss: 1.085 Test Acc: 0.572
Validation loss decreased (-0.506567 --> -0.572358).  Saving model ...
Epoch: 4 cost time: 2.749361515045166
Epoch: 4, Steps: 10 | Train Loss: 0.965 Vali Loss: 0.939 Vali Acc: 0.717 Test Loss: 0.939 Test Acc: 0.717
Validation loss decreased (-0.572358 --> -0.717096).  Saving model ...
Epoch: 5 cost time: 2.5695903301239014
Epoch: 5, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.779 Vali Acc: 0.757 Test Loss: 0.779 Test Acc: 0.757
Validation loss decreased (-0.717096 --> -0.756571).  Saving model ...
Epoch: 6 cost time: 2.5163156986236572
Epoch: 6, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
Validation loss decreased (-0.756571 --> -0.809204).  Saving model ...
Epoch: 7 cost time: 2.70699143409729
Epoch: 7, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815785).  Saving model ...
Epoch: 8 cost time: 2.1370909214019775
Epoch: 8, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.405 Vali Acc: 0.836 Test Loss: 0.405 Test Acc: 0.836
Validation loss decreased (-0.815785 --> -0.835522).  Saving model ...
Epoch: 9 cost time: 2.1797518730163574
Epoch: 9, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.367 Vali Acc: 0.829 Test Loss: 0.367 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7342309951782227
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.373 Vali Acc: 0.862 Test Loss: 0.373 Test Acc: 0.862
Validation loss decreased (-0.835522 --> -0.861838).  Saving model ...
Epoch: 11 cost time: 2.5304930210113525
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.370 Vali Acc: 0.849 Test Loss: 0.370 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8688852787017822
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7159881591796875
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.814423084259033
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.413 Vali Acc: 0.849 Test Loss: 0.413 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.9850618839263916
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7245426177978516
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8630166053771973
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9033095836639404
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7316832542419434
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7446210384368896
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 4696580
model size : 19.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4925928115844727
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.456 Vali Acc: 0.250 Test Loss: 1.456 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.67887544631958
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.351 Vali Acc: 0.375 Test Loss: 1.351 Test Acc: 0.375
Validation loss decreased (-0.249985 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.4231362342834473
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.7463712692260742
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.089 Vali Acc: 0.586 Test Loss: 1.089 Test Acc: 0.586
Validation loss decreased (-0.499988 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.6227915287017822
Epoch: 5, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.939 Vali Acc: 0.697 Test Loss: 0.939 Test Acc: 0.697
Validation loss decreased (-0.585515 --> -0.697359).  Saving model ...
Epoch: 6 cost time: 1.7450878620147705
Epoch: 6, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.792 Vali Acc: 0.763 Test Loss: 0.792 Test Acc: 0.763
Validation loss decreased (-0.697359 --> -0.763150).  Saving model ...
Epoch: 7 cost time: 1.3669471740722656
Epoch: 7, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.650 Vali Acc: 0.789 Test Loss: 0.650 Test Acc: 0.789
Validation loss decreased (-0.763150 --> -0.789467).  Saving model ...
Epoch: 8 cost time: 1.6930608749389648
Epoch: 8, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.789467 --> -0.822363).  Saving model ...
Epoch: 9 cost time: 1.6252079010009766
Epoch: 9, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.452 Vali Acc: 0.842 Test Loss: 0.452 Test Acc: 0.842
Validation loss decreased (-0.822363 --> -0.842101).  Saving model ...
Epoch: 10 cost time: 1.7327256202697754
Epoch: 10, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
Validation loss decreased (-0.842101 --> -0.861838).  Saving model ...
Epoch: 11 cost time: 1.6254174709320068
Epoch: 11, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 12 cost time: 1.7852890491485596
Epoch: 12, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.358 Vali Acc: 0.868 Test Loss: 0.358 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.606424331665039
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.368 Vali Acc: 0.855 Test Loss: 0.368 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6693007946014404
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.367 Vali Acc: 0.862 Test Loss: 0.367 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8165404796600342
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.383 Vali Acc: 0.862 Test Loss: 0.383 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6996471881866455
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.81947922706604
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.415 Vali Acc: 0.862 Test Loss: 0.415 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.71561598777771
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7475802898406982
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.432 Vali Acc: 0.868 Test Loss: 0.432 Test Acc: 0.868
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.528777837753296
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6495347023010254
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 1386500
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5617597103118896
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.300 Vali Acc: 0.395 Test Loss: 1.300 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 1.9423496723175049
Epoch: 2, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.214 Vali Acc: 0.487 Test Loss: 1.214 Test Acc: 0.487
Validation loss decreased (-0.394724 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.8482601642608643
Epoch: 3, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.105 Vali Acc: 0.566 Test Loss: 1.105 Test Acc: 0.566
Validation loss decreased (-0.486830 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.9581413269042969
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 0.974 Vali Acc: 0.684 Test Loss: 0.974 Test Acc: 0.684
Validation loss decreased (-0.565778 --> -0.684201).  Saving model ...
Epoch: 5 cost time: 1.6720836162567139
Epoch: 5, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.684201 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 1.807065486907959
Epoch: 6, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
Validation loss decreased (-0.749992 --> -0.802625).  Saving model ...
Epoch: 7 cost time: 1.9231219291687012
Epoch: 7, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815784).  Saving model ...
Epoch: 8 cost time: 1.888838291168213
Epoch: 8, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.457 Vali Acc: 0.829 Test Loss: 0.457 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828943).  Saving model ...
Epoch: 9 cost time: 2.032830238342285
Epoch: 9, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.400 Vali Acc: 0.836 Test Loss: 0.400 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 10 cost time: 1.9701573848724365
Epoch: 10, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.376 Vali Acc: 0.836 Test Loss: 0.376 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835523).  Saving model ...
Epoch: 11 cost time: 1.9302573204040527
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.398 Vali Acc: 0.836 Test Loss: 0.398 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0167174339294434
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.382 Vali Acc: 0.842 Test Loss: 0.382 Test Acc: 0.842
Validation loss decreased (-0.835523 --> -0.842101).  Saving model ...
Epoch: 13 cost time: 2.0741865634918213
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.417 Vali Acc: 0.849 Test Loss: 0.417 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 14 cost time: 2.034528970718384
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.409 Vali Acc: 0.836 Test Loss: 0.409 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.095123767852783
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.436 Vali Acc: 0.829 Test Loss: 0.436 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9211318492889404
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.456 Vali Acc: 0.836 Test Loss: 0.456 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.168050527572632
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.457 Vali Acc: 0.868 Test Loss: 0.457 Test Acc: 0.868
Validation loss decreased (-0.848680 --> -0.868416).  Saving model ...
Epoch: 18 cost time: 1.899585247039795
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5388331413269043
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6680116653442383
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7034642696380615
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.431 Vali Acc: 0.836 Test Loss: 0.431 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6093006134033203
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.482 Vali Acc: 0.868 Test Loss: 0.482 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.0386836528778076
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0844855308532715
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.495 Vali Acc: 0.836 Test Loss: 0.495 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.834995985031128
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.842 Test Loss: 0.505 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0175843238830566
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
Validation loss decreased (-0.868416 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 1.987257957458496
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.497 Vali Acc: 0.855 Test Loss: 0.497 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9757938385009766
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.566 Vali Acc: 0.849 Test Loss: 0.566 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2922093868255615
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.547 Vali Acc: 0.836 Test Loss: 0.547 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.171703338623047
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.836 Test Loss: 0.547 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 4696580
model size : 19.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3257384300231934
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.459 Vali Acc: 0.243 Test Loss: 1.459 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 1.4823102951049805
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.359 Vali Acc: 0.362 Test Loss: 1.359 Test Acc: 0.362
Validation loss decreased (-0.243406 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.3915252685546875
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.242 Vali Acc: 0.487 Test Loss: 1.242 Test Acc: 0.487
Validation loss decreased (-0.361829 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 1.4633417129516602
Epoch: 4, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.111 Vali Acc: 0.559 Test Loss: 1.111 Test Acc: 0.559
Validation loss decreased (-0.486830 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.4542226791381836
Epoch: 5, Steps: 10 | Train Loss: 0.927 Vali Loss: 0.971 Vali Acc: 0.664 Test Loss: 0.971 Test Acc: 0.664
Validation loss decreased (-0.559199 --> -0.664464).  Saving model ...
Epoch: 6 cost time: 1.4859514236450195
Epoch: 6, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.836 Vali Acc: 0.711 Test Loss: 0.836 Test Acc: 0.711
Validation loss decreased (-0.664464 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.4694757461547852
Epoch: 7, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
Validation loss decreased (-0.710518 --> -0.789467).  Saving model ...
Epoch: 8 cost time: 1.4079456329345703
Epoch: 8, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
Validation loss decreased (-0.789467 --> -0.822363).  Saving model ...
Epoch: 9 cost time: 1.4948153495788574
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 10 cost time: 1.4170966148376465
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.432 Vali Acc: 0.862 Test Loss: 0.432 Test Acc: 0.862
Validation loss decreased (-0.822363 --> -0.861838).  Saving model ...
Epoch: 11 cost time: 1.3379099369049072
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.295564889907837
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.366 Vali Acc: 0.855 Test Loss: 0.366 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3922109603881836
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3599565029144287
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.388 Vali Acc: 0.842 Test Loss: 0.388 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1660635471343994
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.395 Vali Acc: 0.842 Test Loss: 0.395 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.383073329925537
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.420 Vali Acc: 0.836 Test Loss: 0.420 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3753161430358887
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.326935052871704
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.430 Vali Acc: 0.836 Test Loss: 0.430 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4740185737609863
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.419 Vali Acc: 0.868 Test Loss: 0.419 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 20 cost time: 1.386582374572754
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.453 Vali Acc: 0.842 Test Loss: 0.453 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4459624290466309
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.462 Vali Acc: 0.862 Test Loss: 0.462 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5179736614227295
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.440 Vali Acc: 0.868 Test Loss: 0.440 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.466599941253662
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.454 Vali Acc: 0.862 Test Loss: 0.454 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4888947010040283
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 1.3385283946990967
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.490 Vali Acc: 0.868 Test Loss: 0.490 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.425771713256836
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.532 Vali Acc: 0.849 Test Loss: 0.532 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3856499195098877
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.410496473312378
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.855 Test Loss: 0.550 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4210772514343262
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.518 Vali Acc: 0.868 Test Loss: 0.518 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.490023136138916
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.624 Vali Acc: 0.855 Test Loss: 0.624 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 1386500
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.633732318878174
Epoch: 1, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.302 Vali Acc: 0.401 Test Loss: 1.302 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.5897104740142822
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.224 Vali Acc: 0.474 Test Loss: 1.224 Test Acc: 0.474
Validation loss decreased (-0.401303 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.374030590057373
Epoch: 3, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.127 Vali Acc: 0.566 Test Loss: 1.127 Test Acc: 0.566
Validation loss decreased (-0.473672 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.6467654705047607
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.012 Vali Acc: 0.671 Test Loss: 1.012 Test Acc: 0.671
Validation loss decreased (-0.565778 --> -0.671043).  Saving model ...
Epoch: 5 cost time: 1.5650334358215332
Epoch: 5, Steps: 10 | Train Loss: 0.904 Vali Loss: 0.891 Vali Acc: 0.704 Test Loss: 0.891 Test Acc: 0.704
Validation loss decreased (-0.671043 --> -0.703938).  Saving model ...
Epoch: 6 cost time: 1.453451156616211
Epoch: 6, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.755 Vali Acc: 0.789 Test Loss: 0.755 Test Acc: 0.789
Validation loss decreased (-0.703938 --> -0.789466).  Saving model ...
Epoch: 7 cost time: 1.4564166069030762
Epoch: 7, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802625).  Saving model ...
Epoch: 8 cost time: 1.654008150100708
Epoch: 8, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.5209314823150635
Epoch: 9, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.438 Vali Acc: 0.849 Test Loss: 0.438 Test Acc: 0.849
Validation loss decreased (-0.802626 --> -0.848680).  Saving model ...
Epoch: 10 cost time: 1.5302228927612305
Epoch: 10, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.389 Vali Acc: 0.829 Test Loss: 0.389 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6252210140228271
Epoch: 11, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.358 Vali Acc: 0.868 Test Loss: 0.358 Test Acc: 0.868
Validation loss decreased (-0.848680 --> -0.868417).  Saving model ...
Epoch: 12 cost time: 1.5771236419677734
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.335 Vali Acc: 0.842 Test Loss: 0.335 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.429414987564087
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.337 Vali Acc: 0.862 Test Loss: 0.337 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6277399063110352
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.329 Vali Acc: 0.849 Test Loss: 0.329 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6125075817108154
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.338 Vali Acc: 0.849 Test Loss: 0.338 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.577554702758789
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.341 Vali Acc: 0.842 Test Loss: 0.341 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6333484649658203
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.345 Vali Acc: 0.855 Test Loss: 0.345 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6992466449737549
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.344 Vali Acc: 0.836 Test Loss: 0.344 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5115735530853271
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.355 Vali Acc: 0.862 Test Loss: 0.355 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7775332927703857
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.353 Vali Acc: 0.849 Test Loss: 0.353 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6453351974487305
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.367 Vali Acc: 0.855 Test Loss: 0.367 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 4696580
model size : 19.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7974390983581543
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.464 Vali Acc: 0.243 Test Loss: 1.464 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 1.1660706996917725
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.370 Vali Acc: 0.368 Test Loss: 1.370 Test Acc: 0.368
Validation loss decreased (-0.243406 --> -0.368407).  Saving model ...
Epoch: 3 cost time: 1.1875648498535156
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.265 Vali Acc: 0.487 Test Loss: 1.265 Test Acc: 0.487
Validation loss decreased (-0.368407 --> -0.486829).  Saving model ...
Epoch: 4 cost time: 1.1263320446014404
Epoch: 4, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.148 Vali Acc: 0.579 Test Loss: 1.148 Test Acc: 0.579
Validation loss decreased (-0.486829 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 1.0985503196716309
Epoch: 5, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.025 Vali Acc: 0.651 Test Loss: 1.025 Test Acc: 0.651
Validation loss decreased (-0.578936 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.3466784954071045
Epoch: 6, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.907 Vali Acc: 0.671 Test Loss: 0.907 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 1.2673671245574951
Epoch: 7, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.787 Vali Acc: 0.737 Test Loss: 0.787 Test Acc: 0.737
Validation loss decreased (-0.671044 --> -0.736834).  Saving model ...
Epoch: 8 cost time: 1.2969770431518555
Epoch: 8, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763151).  Saving model ...
Epoch: 9 cost time: 1.102205514907837
Epoch: 9, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.763151 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 1.2772610187530518
Epoch: 10, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2110490798950195
Epoch: 11, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.457 Vali Acc: 0.816 Test Loss: 0.457 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 12 cost time: 1.0842697620391846
Epoch: 12, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.419 Vali Acc: 0.855 Test Loss: 0.419 Test Acc: 0.855
Validation loss decreased (-0.815785 --> -0.855259).  Saving model ...
Epoch: 13 cost time: 1.2929127216339111
Epoch: 13, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.397 Vali Acc: 0.849 Test Loss: 0.397 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.215846061706543
Epoch: 14, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.385 Vali Acc: 0.849 Test Loss: 0.385 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.274562120437622
Epoch: 15, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.378 Vali Acc: 0.849 Test Loss: 0.378 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.446502447128296
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.361 Vali Acc: 0.836 Test Loss: 0.361 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4050416946411133
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.352 Vali Acc: 0.849 Test Loss: 0.352 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.342839002609253
Epoch: 18, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.349 Vali Acc: 0.842 Test Loss: 0.349 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3243935108184814
Epoch: 19, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.356 Vali Acc: 0.855 Test Loss: 0.356 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855260).  Saving model ...
Epoch: 20 cost time: 1.2912302017211914
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.347 Vali Acc: 0.842 Test Loss: 0.347 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4379394054412842
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.351365566253662
Epoch: 22, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.369 Vali Acc: 0.855 Test Loss: 0.369 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3599493503570557
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.323 Vali Acc: 0.855 Test Loss: 0.323 Test Acc: 0.855
Validation loss decreased (-0.855260 --> -0.855260).  Saving model ...
Epoch: 24 cost time: 1.2983980178833008
Epoch: 24, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.334 Vali Acc: 0.868 Test Loss: 0.334 Test Acc: 0.868
Validation loss decreased (-0.855260 --> -0.868418).  Saving model ...
Epoch: 25 cost time: 1.3727564811706543
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.336 Vali Acc: 0.882 Test Loss: 0.336 Test Acc: 0.882
Validation loss decreased (-0.868418 --> -0.881576).  Saving model ...
Epoch: 26 cost time: 1.3949518203735352
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.336 Vali Acc: 0.888 Test Loss: 0.336 Test Acc: 0.888
Validation loss decreased (-0.881576 --> -0.888155).  Saving model ...
Epoch: 27 cost time: 1.2905304431915283
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2945051193237305
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.342 Vali Acc: 0.882 Test Loss: 0.342 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3814177513122559
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.311356544494629
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8881578947368421
model parameter : 1386500
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.5187437534332275
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.407 Vali Acc: 0.243 Test Loss: 1.407 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.079848527908325
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.336 Vali Acc: 0.368 Test Loss: 1.336 Test Acc: 0.368
Validation loss decreased (-0.243407 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 2.057879686355591
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.245 Vali Acc: 0.447 Test Loss: 1.245 Test Acc: 0.447
Validation loss decreased (-0.368408 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 2.1491074562072754
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.141 Vali Acc: 0.559 Test Loss: 1.141 Test Acc: 0.559
Validation loss decreased (-0.447356 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 2.2575535774230957
Epoch: 5, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.015 Vali Acc: 0.658 Test Loss: 1.015 Test Acc: 0.658
Validation loss decreased (-0.559199 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 2.8224661350250244
Epoch: 6, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.866 Vali Acc: 0.737 Test Loss: 0.866 Test Acc: 0.737
Validation loss decreased (-0.657885 --> -0.736833).  Saving model ...
Epoch: 7 cost time: 2.821965456008911
Epoch: 7, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.733 Vali Acc: 0.763 Test Loss: 0.733 Test Acc: 0.763
Validation loss decreased (-0.736833 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 2.681568145751953
Epoch: 8, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.57515549659729
Epoch: 9, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
Validation loss decreased (-0.763151 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 2.7684898376464844
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809206).  Saving model ...
Epoch: 11 cost time: 2.845065116882324
Epoch: 11, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.427 Vali Acc: 0.829 Test Loss: 0.427 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 12 cost time: 2.8153154850006104
Epoch: 12, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.805393934249878
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.410 Vali Acc: 0.836 Test Loss: 0.410 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 14 cost time: 2.748483657836914
Epoch: 14, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.842 Test Loss: 0.553 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842100).  Saving model ...
Epoch: 15 cost time: 2.3328194618225098
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.415 Vali Acc: 0.842 Test Loss: 0.415 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 16 cost time: 2.510324478149414
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.523 Vali Acc: 0.836 Test Loss: 0.523 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.691856861114502
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.486 Vali Acc: 0.842 Test Loss: 0.486 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3207643032073975
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.475 Vali Acc: 0.836 Test Loss: 0.475 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.310913324356079
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.509 Vali Acc: 0.836 Test Loss: 0.509 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4249484539031982
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.525 Vali Acc: 0.836 Test Loss: 0.525 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5087647438049316
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.537 Vali Acc: 0.836 Test Loss: 0.537 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4927117824554443
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.836 Test Loss: 0.559 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5270259380340576
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.565 Vali Acc: 0.849 Test Loss: 0.565 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848679).  Saving model ...
Epoch: 24 cost time: 2.6518454551696777
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.558 Vali Acc: 0.842 Test Loss: 0.558 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.780526638031006
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.578 Vali Acc: 0.849 Test Loss: 0.578 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8486547470092773
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.842 Test Loss: 0.580 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.86555552482605
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.842 Test Loss: 0.602 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5576274394989014
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.629 Vali Acc: 0.836 Test Loss: 0.629 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.619945764541626
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.842 Test Loss: 0.659 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.63919734954834
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.836 Test Loss: 0.655 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 4692356
model size : 18.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.775566816329956
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.364 Vali Acc: 0.362 Test Loss: 1.364 Test Acc: 0.362
Validation loss decreased (inf --> -0.361828).  Saving model ...
Epoch: 2 cost time: 1.6301348209381104
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.294 Vali Acc: 0.421 Test Loss: 1.294 Test Acc: 0.421
Validation loss decreased (-0.361828 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.4781742095947266
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.206 Vali Acc: 0.507 Test Loss: 1.206 Test Acc: 0.507
Validation loss decreased (-0.421040 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.7014236450195312
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.111 Vali Acc: 0.566 Test Loss: 1.111 Test Acc: 0.566
Validation loss decreased (-0.506567 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 1.4868667125701904
Epoch: 5, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.006 Vali Acc: 0.651 Test Loss: 1.006 Test Acc: 0.651
Validation loss decreased (-0.565778 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.5877790451049805
Epoch: 6, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.895 Vali Acc: 0.730 Test Loss: 0.895 Test Acc: 0.730
Validation loss decreased (-0.651306 --> -0.730254).  Saving model ...
Epoch: 7 cost time: 1.6406514644622803
Epoch: 7, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.782 Vali Acc: 0.776 Test Loss: 0.782 Test Acc: 0.776
Validation loss decreased (-0.730254 --> -0.776308).  Saving model ...
Epoch: 8 cost time: 1.607872486114502
Epoch: 8, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.776308 --> -0.809204).  Saving model ...
Epoch: 9 cost time: 1.7818660736083984
Epoch: 9, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.594 Vali Acc: 0.842 Test Loss: 0.594 Test Acc: 0.842
Validation loss decreased (-0.809204 --> -0.842099).  Saving model ...
Epoch: 10 cost time: 1.6269571781158447
Epoch: 10, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.529 Vali Acc: 0.842 Test Loss: 0.529 Test Acc: 0.842
Validation loss decreased (-0.842099 --> -0.842100).  Saving model ...
Epoch: 11 cost time: 1.900683879852295
Epoch: 11, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.468 Vali Acc: 0.849 Test Loss: 0.468 Test Acc: 0.849
Validation loss decreased (-0.842100 --> -0.848680).  Saving model ...
Epoch: 12 cost time: 1.6651480197906494
Epoch: 12, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.593205213546753
Epoch: 13, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5302445888519287
Epoch: 14, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.392 Vali Acc: 0.849 Test Loss: 0.392 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 15 cost time: 1.508434534072876
Epoch: 15, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 16 cost time: 1.6856470108032227
Epoch: 16, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.360 Vali Acc: 0.862 Test Loss: 0.360 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861839).  Saving model ...
Epoch: 17 cost time: 1.9374265670776367
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.364 Vali Acc: 0.849 Test Loss: 0.364 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7041544914245605
Epoch: 18, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.366 Vali Acc: 0.836 Test Loss: 0.366 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8433725833892822
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.368 Vali Acc: 0.836 Test Loss: 0.368 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6867384910583496
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.356 Vali Acc: 0.842 Test Loss: 0.356 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7742679119110107
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.378 Vali Acc: 0.842 Test Loss: 0.378 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.735783338546753
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.377 Vali Acc: 0.849 Test Loss: 0.377 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.762329339981079
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.557403802871704
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.394 Vali Acc: 0.842 Test Loss: 0.394 Test Acc: 0.842
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8167791366577148
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.390 Vali Acc: 0.849 Test Loss: 0.390 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5463807582855225
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.418 Vali Acc: 0.842 Test Loss: 0.418 Test Acc: 0.842
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 1382148
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.389656066894531
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.409 Vali Acc: 0.250 Test Loss: 1.409 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.413726806640625
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.346 Vali Acc: 0.322 Test Loss: 1.346 Test Acc: 0.322
Validation loss decreased (-0.249986 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 2.4480085372924805
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.262 Vali Acc: 0.454 Test Loss: 1.262 Test Acc: 0.454
Validation loss decreased (-0.322355 --> -0.453935).  Saving model ...
Epoch: 4 cost time: 2.1542768478393555
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.167 Vali Acc: 0.526 Test Loss: 1.167 Test Acc: 0.526
Validation loss decreased (-0.453935 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 2.488090753555298
Epoch: 5, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.054 Vali Acc: 0.645 Test Loss: 1.054 Test Acc: 0.645
Validation loss decreased (-0.526304 --> -0.644726).  Saving model ...
Epoch: 6 cost time: 2.2124404907226562
Epoch: 6, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.919 Vali Acc: 0.743 Test Loss: 0.919 Test Acc: 0.743
Validation loss decreased (-0.644726 --> -0.743412).  Saving model ...
Epoch: 7 cost time: 2.25471830368042
Epoch: 7, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.791 Vali Acc: 0.757 Test Loss: 0.791 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756571).  Saving model ...
Epoch: 8 cost time: 2.3995277881622314
Epoch: 8, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.676 Vali Acc: 0.763 Test Loss: 0.676 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763151).  Saving model ...
Epoch: 9 cost time: 2.393187999725342
Epoch: 9, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.763151 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 2.31884765625
Epoch: 10, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.494 Vali Acc: 0.822 Test Loss: 0.494 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 2.3522984981536865
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835522).  Saving model ...
Epoch: 12 cost time: 2.1784863471984863
Epoch: 12, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.399742364883423
Epoch: 13, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.425 Vali Acc: 0.868 Test Loss: 0.425 Test Acc: 0.868
Validation loss decreased (-0.835522 --> -0.868417).  Saving model ...
Epoch: 14 cost time: 2.1646997928619385
Epoch: 14, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.385 Vali Acc: 0.836 Test Loss: 0.385 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.14711594581604
Epoch: 15, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.393 Vali Acc: 0.849 Test Loss: 0.393 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.408351421356201
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.379 Vali Acc: 0.842 Test Loss: 0.379 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2226336002349854
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3369057178497314
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.249530553817749
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.392 Vali Acc: 0.849 Test Loss: 0.392 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4591686725616455
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4895567893981934
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.442 Vali Acc: 0.849 Test Loss: 0.442 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.208167552947998
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.474 Vali Acc: 0.842 Test Loss: 0.474 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3678815364837646
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.469 Vali Acc: 0.829 Test Loss: 0.469 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 4692356
model size : 18.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5786521434783936
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.366 Vali Acc: 0.355 Test Loss: 1.366 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.626255989074707
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.304 Vali Acc: 0.408 Test Loss: 1.304 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.5473346710205078
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.225 Vali Acc: 0.507 Test Loss: 1.225 Test Acc: 0.507
Validation loss decreased (-0.407882 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.4063746929168701
Epoch: 4, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.140 Vali Acc: 0.553 Test Loss: 1.140 Test Acc: 0.553
Validation loss decreased (-0.506567 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.5021641254425049
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.046 Vali Acc: 0.638 Test Loss: 1.046 Test Acc: 0.638
Validation loss decreased (-0.552620 --> -0.638147).  Saving model ...
Epoch: 6 cost time: 1.394101619720459
Epoch: 6, Steps: 10 | Train Loss: 0.890 Vali Loss: 0.947 Vali Acc: 0.711 Test Loss: 0.947 Test Acc: 0.711
Validation loss decreased (-0.638147 --> -0.710517).  Saving model ...
Epoch: 7 cost time: 1.5022377967834473
Epoch: 7, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.845 Vali Acc: 0.776 Test Loss: 0.845 Test Acc: 0.776
Validation loss decreased (-0.710517 --> -0.776307).  Saving model ...
Epoch: 8 cost time: 1.4318509101867676
Epoch: 8, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
Validation loss decreased (-0.776307 --> -0.802624).  Saving model ...
Epoch: 9 cost time: 1.516059398651123
Epoch: 9, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.672 Vali Acc: 0.829 Test Loss: 0.672 Test Acc: 0.829
Validation loss decreased (-0.802624 --> -0.828941).  Saving model ...
Epoch: 10 cost time: 1.3186800479888916
Epoch: 10, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.606 Vali Acc: 0.829 Test Loss: 0.606 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828941).  Saving model ...
Epoch: 11 cost time: 1.57871675491333
Epoch: 11, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.541 Vali Acc: 0.836 Test Loss: 0.541 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835521).  Saving model ...
Epoch: 12 cost time: 1.2632818222045898
Epoch: 12, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.499 Vali Acc: 0.829 Test Loss: 0.499 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6232860088348389
Epoch: 13, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4699664115905762
Epoch: 14, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5451390743255615
Epoch: 15, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.429 Vali Acc: 0.816 Test Loss: 0.429 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.594151258468628
Epoch: 16, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.415 Vali Acc: 0.822 Test Loss: 0.415 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4916212558746338
Epoch: 17, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.408 Vali Acc: 0.803 Test Loss: 0.408 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.289308786392212
Epoch: 18, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.408 Vali Acc: 0.816 Test Loss: 0.408 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2802155017852783
Epoch: 19, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.406 Vali Acc: 0.809 Test Loss: 0.406 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3461112976074219
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.388 Vali Acc: 0.836 Test Loss: 0.388 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 21 cost time: 1.289322853088379
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.383 Vali Acc: 0.829 Test Loss: 0.383 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4726839065551758
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.393 Vali Acc: 0.816 Test Loss: 0.393 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6107177734375
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4797484874725342
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.355 Vali Acc: 0.849 Test Loss: 0.355 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848681).  Saving model ...
Epoch: 25 cost time: 1.5321447849273682
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.354 Vali Acc: 0.849 Test Loss: 0.354 Test Acc: 0.849
Validation loss decreased (-0.848681 --> -0.848681).  Saving model ...
Epoch: 26 cost time: 1.5820670127868652
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.393 Vali Acc: 0.829 Test Loss: 0.393 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.601167917251587
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.374 Vali Acc: 0.842 Test Loss: 0.374 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4827427864074707
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.378 Vali Acc: 0.849 Test Loss: 0.378 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1350460052490234
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.388 Vali Acc: 0.842 Test Loss: 0.388 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5676994323730469
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 1382148
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4151570796966553
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.409 Vali Acc: 0.237 Test Loss: 1.409 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.7217779159545898
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.355 Vali Acc: 0.303 Test Loss: 1.355 Test Acc: 0.303
Validation loss decreased (-0.236828 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.728391170501709
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.280 Vali Acc: 0.414 Test Loss: 1.280 Test Acc: 0.414
Validation loss decreased (-0.302618 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 2.1682002544403076
Epoch: 4, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.192 Vali Acc: 0.539 Test Loss: 1.192 Test Acc: 0.539
Validation loss decreased (-0.414461 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.828613519668579
Epoch: 5, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.094 Vali Acc: 0.618 Test Loss: 1.094 Test Acc: 0.618
Validation loss decreased (-0.539462 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.7968957424163818
Epoch: 6, Steps: 10 | Train Loss: 0.966 Vali Loss: 0.981 Vali Acc: 0.711 Test Loss: 0.981 Test Acc: 0.711
Validation loss decreased (-0.618410 --> -0.710517).  Saving model ...
Epoch: 7 cost time: 1.7462289333343506
Epoch: 7, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.868 Vali Acc: 0.757 Test Loss: 0.868 Test Acc: 0.757
Validation loss decreased (-0.710517 --> -0.756570).  Saving model ...
Epoch: 8 cost time: 1.900388240814209
Epoch: 8, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.752 Vali Acc: 0.803 Test Loss: 0.752 Test Acc: 0.803
Validation loss decreased (-0.756570 --> -0.802624).  Saving model ...
Epoch: 9 cost time: 1.8801608085632324
Epoch: 9, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
Validation loss decreased (-0.802624 --> -0.802625).  Saving model ...
Epoch: 10 cost time: 1.8691902160644531
Epoch: 10, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.8172197341918945
Epoch: 11, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.509 Vali Acc: 0.849 Test Loss: 0.509 Test Acc: 0.849
Validation loss decreased (-0.815784 --> -0.848679).  Saving model ...
Epoch: 12 cost time: 1.7053744792938232
Epoch: 12, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.461 Vali Acc: 0.836 Test Loss: 0.461 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7908027172088623
Epoch: 13, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.432 Vali Acc: 0.842 Test Loss: 0.432 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.936095952987671
Epoch: 14, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.398733377456665
Epoch: 15, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.507 Vali Acc: 0.770 Test Loss: 0.507 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6278784275054932
Epoch: 16, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.477 Vali Acc: 0.783 Test Loss: 0.477 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.713512897491455
Epoch: 17, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.446 Vali Acc: 0.803 Test Loss: 0.446 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.782078504562378
Epoch: 18, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.375 Vali Acc: 0.849 Test Loss: 0.375 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848680).  Saving model ...
Epoch: 19 cost time: 1.7910208702087402
Epoch: 19, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.354 Vali Acc: 0.855 Test Loss: 0.354 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855260).  Saving model ...
Epoch: 20 cost time: 1.4308335781097412
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.347 Vali Acc: 0.849 Test Loss: 0.347 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6075170040130615
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.348 Vali Acc: 0.862 Test Loss: 0.348 Test Acc: 0.862
Validation loss decreased (-0.855260 --> -0.861839).  Saving model ...
Epoch: 22 cost time: 1.6313252449035645
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.340 Vali Acc: 0.855 Test Loss: 0.340 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9387896060943604
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.351 Vali Acc: 0.855 Test Loss: 0.351 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7152693271636963
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5594980716705322
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.425 Vali Acc: 0.822 Test Loss: 0.425 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7875113487243652
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6913633346557617
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.476 Vali Acc: 0.803 Test Loss: 0.476 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5748820304870605
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5529699325561523
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.412 Vali Acc: 0.849 Test Loss: 0.412 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5390846729278564
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.378 Vali Acc: 0.855 Test Loss: 0.378 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 4692356
model size : 18.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4993906021118164
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.365 Vali Acc: 0.336 Test Loss: 1.365 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.4564712047576904
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.312 Vali Acc: 0.401 Test Loss: 1.312 Test Acc: 0.401
Validation loss decreased (-0.335513 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.2890088558197021
Epoch: 3, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.244 Vali Acc: 0.474 Test Loss: 1.244 Test Acc: 0.474
Validation loss decreased (-0.401303 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.3931524753570557
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.173 Vali Acc: 0.546 Test Loss: 1.173 Test Acc: 0.546
Validation loss decreased (-0.473672 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 1.3151600360870361
Epoch: 5, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.093 Vali Acc: 0.618 Test Loss: 1.093 Test Acc: 0.618
Validation loss decreased (-0.546041 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.33970308303833
Epoch: 6, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.009 Vali Acc: 0.645 Test Loss: 1.009 Test Acc: 0.645
Validation loss decreased (-0.618410 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.3718500137329102
Epoch: 7, Steps: 10 | Train Loss: 0.892 Vali Loss: 0.917 Vali Acc: 0.730 Test Loss: 0.917 Test Acc: 0.730
Validation loss decreased (-0.644727 --> -0.730254).  Saving model ...
Epoch: 8 cost time: 1.3904433250427246
Epoch: 8, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.831 Vali Acc: 0.776 Test Loss: 0.831 Test Acc: 0.776
Validation loss decreased (-0.730254 --> -0.776307).  Saving model ...
Epoch: 9 cost time: 1.2357358932495117
Epoch: 9, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
Validation loss decreased (-0.776307 --> -0.815782).  Saving model ...
Epoch: 10 cost time: 1.4007847309112549
Epoch: 10, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.660 Vali Acc: 0.816 Test Loss: 0.660 Test Acc: 0.816
Validation loss decreased (-0.815782 --> -0.815783).  Saving model ...
Epoch: 11 cost time: 1.3899638652801514
Epoch: 11, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.585 Vali Acc: 0.836 Test Loss: 0.585 Test Acc: 0.836
Validation loss decreased (-0.815783 --> -0.835520).  Saving model ...
Epoch: 12 cost time: 1.0766866207122803
Epoch: 12, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.539 Vali Acc: 0.829 Test Loss: 0.539 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3315815925598145
Epoch: 13, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.493 Vali Acc: 0.842 Test Loss: 0.493 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842100).  Saving model ...
Epoch: 14 cost time: 1.323493242263794
Epoch: 14, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2946887016296387
Epoch: 15, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.414 Vali Acc: 0.855 Test Loss: 0.414 Test Acc: 0.855
Validation loss decreased (-0.842100 --> -0.855259).  Saving model ...
Epoch: 16 cost time: 1.3132481575012207
Epoch: 16, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
Epoch: 17 cost time: 1.4755916595458984
Epoch: 17, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.370 Vali Acc: 0.855 Test Loss: 0.370 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4030027389526367
Epoch: 18, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.356 Vali Acc: 0.842 Test Loss: 0.356 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3675990104675293
Epoch: 19, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.343 Vali Acc: 0.849 Test Loss: 0.343 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4328722953796387
Epoch: 20, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.338 Vali Acc: 0.849 Test Loss: 0.338 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.476761817932129
Epoch: 21, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.331 Vali Acc: 0.855 Test Loss: 0.331 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.345348834991455
Epoch: 22, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.338 Vali Acc: 0.855 Test Loss: 0.338 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3375389575958252
Epoch: 23, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.372 Vali Acc: 0.836 Test Loss: 0.372 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4821207523345947
Epoch: 24, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3505761623382568
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.410 Vali Acc: 0.829 Test Loss: 0.410 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3026409149169922
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.415 Vali Acc: 0.822 Test Loss: 0.415 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 1382148
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.19472599029541
Epoch: 1, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.225 Vali Acc: 0.434 Test Loss: 1.225 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 1.901442527770996
Epoch: 2, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.177 Vali Acc: 0.566 Test Loss: 1.177 Test Acc: 0.566
Validation loss decreased (-0.434198 --> -0.565778).  Saving model ...
Epoch: 3 cost time: 2.1997482776641846
Epoch: 3, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.117 Vali Acc: 0.664 Test Loss: 1.117 Test Acc: 0.664
Validation loss decreased (-0.565778 --> -0.664463).  Saving model ...
Epoch: 4 cost time: 1.927297592163086
Epoch: 4, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.044 Vali Acc: 0.737 Test Loss: 1.044 Test Acc: 0.737
Validation loss decreased (-0.664463 --> -0.736832).  Saving model ...
Epoch: 5 cost time: 2.1639058589935303
Epoch: 5, Steps: 10 | Train Loss: 0.977 Vali Loss: 0.952 Vali Acc: 0.743 Test Loss: 0.952 Test Acc: 0.743
Validation loss decreased (-0.736832 --> -0.743412).  Saving model ...
Epoch: 6 cost time: 2.091719150543213
Epoch: 6, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.850 Vali Acc: 0.743 Test Loss: 0.850 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743413).  Saving model ...
Epoch: 7 cost time: 1.7895324230194092
Epoch: 7, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.742 Vali Acc: 0.776 Test Loss: 0.742 Test Acc: 0.776
Validation loss decreased (-0.743413 --> -0.776308).  Saving model ...
Epoch: 8 cost time: 2.107175827026367
Epoch: 8, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
Validation loss decreased (-0.776308 --> -0.802625).  Saving model ...
Epoch: 9 cost time: 1.8550820350646973
Epoch: 9, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.557 Vali Acc: 0.829 Test Loss: 0.557 Test Acc: 0.829
Validation loss decreased (-0.802625 --> -0.828942).  Saving model ...
Epoch: 10 cost time: 2.2820725440979004
Epoch: 10, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4498372077941895
Epoch: 11, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835522).  Saving model ...
Epoch: 12 cost time: 2.315840482711792
Epoch: 12, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.415 Vali Acc: 0.842 Test Loss: 0.415 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 13 cost time: 2.3944339752197266
Epoch: 13, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.391 Vali Acc: 0.829 Test Loss: 0.391 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3489723205566406
Epoch: 14, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.383 Vali Acc: 0.849 Test Loss: 0.383 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 15 cost time: 2.251351833343506
Epoch: 15, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.406 Vali Acc: 0.836 Test Loss: 0.406 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.508073091506958
Epoch: 16, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.394 Vali Acc: 0.816 Test Loss: 0.394 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3144657611846924
Epoch: 17, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.415 Vali Acc: 0.816 Test Loss: 0.415 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4041030406951904
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.417783737182617
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.441 Vali Acc: 0.836 Test Loss: 0.441 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.2749927043914795
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.438 Vali Acc: 0.836 Test Loss: 0.438 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.36124324798584
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0167534351348877
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2501060962677
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.541 Vali Acc: 0.822 Test Loss: 0.541 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.165316343307495
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 2348676
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7468883991241455
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.373 Vali Acc: 0.349 Test Loss: 1.373 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.6577706336975098
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.323 Vali Acc: 0.408 Test Loss: 1.323 Test Acc: 0.408
Validation loss decreased (-0.348670 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.5241146087646484
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.259 Vali Acc: 0.447 Test Loss: 1.259 Test Acc: 0.447
Validation loss decreased (-0.407882 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.7787120342254639
Epoch: 4, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.183 Vali Acc: 0.559 Test Loss: 1.183 Test Acc: 0.559
Validation loss decreased (-0.447356 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.5736172199249268
Epoch: 5, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.105 Vali Acc: 0.618 Test Loss: 1.105 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.5493667125701904
Epoch: 6, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.012 Vali Acc: 0.691 Test Loss: 1.012 Test Acc: 0.691
Validation loss decreased (-0.618410 --> -0.690779).  Saving model ...
Epoch: 7 cost time: 1.7264494895935059
Epoch: 7, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.919 Vali Acc: 0.737 Test Loss: 0.919 Test Acc: 0.737
Validation loss decreased (-0.690779 --> -0.736833).  Saving model ...
Epoch: 8 cost time: 1.5814213752746582
Epoch: 8, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.819 Vali Acc: 0.776 Test Loss: 0.819 Test Acc: 0.776
Validation loss decreased (-0.736833 --> -0.776308).  Saving model ...
Epoch: 9 cost time: 1.3560731410980225
Epoch: 9, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4787683486938477
Epoch: 10, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.656 Vali Acc: 0.763 Test Loss: 0.656 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4010441303253174
Epoch: 11, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5033838748931885
Epoch: 12, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7983605861663818
Epoch: 13, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.7246484756469727
Epoch: 14, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.477 Vali Acc: 0.783 Test Loss: 0.477 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 15 cost time: 1.7256278991699219
Epoch: 15, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.452 Vali Acc: 0.796 Test Loss: 0.452 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.6952970027923584
Epoch: 16, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
Validation loss decreased (-0.796048 --> -0.822364).  Saving model ...
Epoch: 17 cost time: 1.6254465579986572
Epoch: 17, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.440 Vali Acc: 0.816 Test Loss: 0.440 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.750075101852417
Epoch: 18, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.415 Vali Acc: 0.803 Test Loss: 0.415 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8050553798675537
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.433 Vali Acc: 0.822 Test Loss: 0.433 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.544884204864502
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.438 Vali Acc: 0.809 Test Loss: 0.438 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6570868492126465
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 22 cost time: 1.6035120487213135
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.468 Vali Acc: 0.829 Test Loss: 0.468 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3974268436431885
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5577354431152344
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.518 Vali Acc: 0.822 Test Loss: 0.518 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5021576881408691
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4589695930480957
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2129464149475098
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3118834495544434
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.539 Vali Acc: 0.836 Test Loss: 0.539 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5493617057800293
Epoch: 29, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.544 Vali Acc: 0.836 Test Loss: 0.544 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2910969257354736
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.500 Vali Acc: 0.829 Test Loss: 0.500 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 693508
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.689978837966919
Epoch: 1, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.227 Vali Acc: 0.454 Test Loss: 1.227 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 1.541440486907959
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.182 Vali Acc: 0.553 Test Loss: 1.182 Test Acc: 0.553
Validation loss decreased (-0.453935 --> -0.552620).  Saving model ...
Epoch: 3 cost time: 1.5867130756378174
Epoch: 3, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.129 Vali Acc: 0.658 Test Loss: 1.129 Test Acc: 0.658
Validation loss decreased (-0.552620 --> -0.657883).  Saving model ...
Epoch: 4 cost time: 1.7232296466827393
Epoch: 4, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.061 Vali Acc: 0.717 Test Loss: 1.061 Test Acc: 0.717
Validation loss decreased (-0.657883 --> -0.717095).  Saving model ...
Epoch: 5 cost time: 1.5765032768249512
Epoch: 5, Steps: 10 | Train Loss: 1.020 Vali Loss: 0.980 Vali Acc: 0.724 Test Loss: 0.980 Test Acc: 0.724
Validation loss decreased (-0.717095 --> -0.723674).  Saving model ...
Epoch: 6 cost time: 1.6514670848846436
Epoch: 6, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.888 Vali Acc: 0.737 Test Loss: 0.888 Test Acc: 0.737
Validation loss decreased (-0.723674 --> -0.736833).  Saving model ...
Epoch: 7 cost time: 1.8292207717895508
Epoch: 7, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.790 Vali Acc: 0.783 Test Loss: 0.790 Test Acc: 0.783
Validation loss decreased (-0.736833 --> -0.782887).  Saving model ...
Epoch: 8 cost time: 1.6169159412384033
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802625).  Saving model ...
Epoch: 9 cost time: 1.8811404705047607
Epoch: 9, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.598 Vali Acc: 0.836 Test Loss: 0.598 Test Acc: 0.836
Validation loss decreased (-0.802625 --> -0.835520).  Saving model ...
Epoch: 10 cost time: 1.7274866104125977
Epoch: 10, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7352619171142578
Epoch: 11, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.866828441619873
Epoch: 12, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6499886512756348
Epoch: 13, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.417 Vali Acc: 0.822 Test Loss: 0.417 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6133391857147217
Epoch: 14, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.394 Vali Acc: 0.809 Test Loss: 0.394 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8452386856079102
Epoch: 15, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.374 Vali Acc: 0.829 Test Loss: 0.374 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6465988159179688
Epoch: 16, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.354 Vali Acc: 0.836 Test Loss: 0.354 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835523).  Saving model ...
Epoch: 17 cost time: 1.688464879989624
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.377 Vali Acc: 0.822 Test Loss: 0.377 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7818455696105957
Epoch: 18, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.372 Vali Acc: 0.836 Test Loss: 0.372 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7046473026275635
Epoch: 19, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.383 Vali Acc: 0.836 Test Loss: 0.383 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8280107975006104
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.372 Vali Acc: 0.842 Test Loss: 0.372 Test Acc: 0.842
Validation loss decreased (-0.835523 --> -0.842102).  Saving model ...
Epoch: 21 cost time: 1.973262071609497
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.374 Vali Acc: 0.862 Test Loss: 0.374 Test Acc: 0.862
Validation loss decreased (-0.842102 --> -0.861838).  Saving model ...
Epoch: 22 cost time: 1.9306411743164062
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.398 Vali Acc: 0.836 Test Loss: 0.398 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9371132850646973
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.485 Vali Acc: 0.822 Test Loss: 0.485 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.084963083267212
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.495 Vali Acc: 0.822 Test Loss: 0.495 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8960418701171875
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8731005191802979
Epoch: 26, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.398 Vali Acc: 0.842 Test Loss: 0.398 Test Acc: 0.842
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.841273307800293
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.861838 --> -0.874996).  Saving model ...
Epoch: 28 cost time: 1.8471033573150635
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.381 Vali Acc: 0.868 Test Loss: 0.381 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.627035140991211
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.433 Vali Acc: 0.842 Test Loss: 0.433 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0201473236083984
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.493 Vali Acc: 0.822 Test Loss: 0.493 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 2348676
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4375269412994385
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.368 Vali Acc: 0.342 Test Loss: 1.368 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.5347790718078613
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.323 Vali Acc: 0.428 Test Loss: 1.323 Test Acc: 0.428
Validation loss decreased (-0.342092 --> -0.427618).  Saving model ...
Epoch: 3 cost time: 1.5077612400054932
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.268 Vali Acc: 0.454 Test Loss: 1.268 Test Acc: 0.454
Validation loss decreased (-0.427618 --> -0.453935).  Saving model ...
Epoch: 4 cost time: 1.5728774070739746
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.202 Vali Acc: 0.553 Test Loss: 1.202 Test Acc: 0.553
Validation loss decreased (-0.453935 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.4349944591522217
Epoch: 5, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.133 Vali Acc: 0.592 Test Loss: 1.133 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.5178425312042236
Epoch: 6, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.052 Vali Acc: 0.645 Test Loss: 1.052 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 1.1111419200897217
Epoch: 7, Steps: 10 | Train Loss: 0.943 Vali Loss: 0.970 Vali Acc: 0.711 Test Loss: 0.970 Test Acc: 0.711
Validation loss decreased (-0.644726 --> -0.710517).  Saving model ...
Epoch: 8 cost time: 1.3734543323516846
Epoch: 8, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.887 Vali Acc: 0.730 Test Loss: 0.887 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730254).  Saving model ...
Epoch: 9 cost time: 1.237919569015503
Epoch: 9, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.806 Vali Acc: 0.763 Test Loss: 0.806 Test Acc: 0.763
Validation loss decreased (-0.730254 --> -0.763150).  Saving model ...
Epoch: 10 cost time: 1.3988549709320068
Epoch: 10, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.728 Vali Acc: 0.770 Test Loss: 0.728 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 1.261441707611084
Epoch: 11, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.656 Vali Acc: 0.816 Test Loss: 0.656 Test Acc: 0.816
Validation loss decreased (-0.769730 --> -0.815783).  Saving model ...
Epoch: 12 cost time: 1.156938076019287
Epoch: 12, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.109832525253296
Epoch: 13, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1940083503723145
Epoch: 14, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.272362470626831
Epoch: 15, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815785).  Saving model ...
Epoch: 16 cost time: 1.3838539123535156
Epoch: 16, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.428 Vali Acc: 0.809 Test Loss: 0.428 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.51945161819458
Epoch: 17, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.415 Vali Acc: 0.829 Test Loss: 0.415 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 18 cost time: 1.3423309326171875
Epoch: 18, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.422 Vali Acc: 0.816 Test Loss: 0.422 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4915320873260498
Epoch: 19, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.393 Vali Acc: 0.842 Test Loss: 0.393 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 20 cost time: 1.3786051273345947
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 21 cost time: 1.3169119358062744
Epoch: 21, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.374 Vali Acc: 0.836 Test Loss: 0.374 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4522018432617188
Epoch: 22, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.377 Vali Acc: 0.836 Test Loss: 0.377 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4240093231201172
Epoch: 23, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.356 Vali Acc: 0.849 Test Loss: 0.356 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.52504301071167
Epoch: 24, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.378 Vali Acc: 0.842 Test Loss: 0.378 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.32578444480896
Epoch: 25, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4376516342163086
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.386 Vali Acc: 0.836 Test Loss: 0.386 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3003196716308594
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.398 Vali Acc: 0.849 Test Loss: 0.398 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1274404525756836
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.346766471862793
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.404 Vali Acc: 0.849 Test Loss: 0.404 Test Acc: 0.849
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.319763422012329
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 693508
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6679141521453857
Epoch: 1, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.232 Vali Acc: 0.434 Test Loss: 1.232 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 1.5613441467285156
Epoch: 2, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.194 Vali Acc: 0.539 Test Loss: 1.194 Test Acc: 0.539
Validation loss decreased (-0.434198 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 1.3954343795776367
Epoch: 3, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.147 Vali Acc: 0.645 Test Loss: 1.147 Test Acc: 0.645
Validation loss decreased (-0.539462 --> -0.644725).  Saving model ...
Epoch: 4 cost time: 1.6344685554504395
Epoch: 4, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.091 Vali Acc: 0.711 Test Loss: 1.091 Test Acc: 0.711
Validation loss decreased (-0.644725 --> -0.710515).  Saving model ...
Epoch: 5 cost time: 1.4287924766540527
Epoch: 5, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.030 Vali Acc: 0.724 Test Loss: 1.030 Test Acc: 0.724
Validation loss decreased (-0.710515 --> -0.723674).  Saving model ...
Epoch: 6 cost time: 1.5794808864593506
Epoch: 6, Steps: 10 | Train Loss: 0.959 Vali Loss: 0.960 Vali Acc: 0.730 Test Loss: 0.960 Test Acc: 0.730
Validation loss decreased (-0.723674 --> -0.730254).  Saving model ...
Epoch: 7 cost time: 1.4571161270141602
Epoch: 7, Steps: 10 | Train Loss: 0.874 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.730254 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 1.5233228206634521
Epoch: 8, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.793 Vali Acc: 0.770 Test Loss: 0.793 Test Acc: 0.770
Validation loss decreased (-0.749991 --> -0.769729).  Saving model ...
Epoch: 9 cost time: 1.28957200050354
Epoch: 9, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
Validation loss decreased (-0.769729 --> -0.822361).  Saving model ...
Epoch: 10 cost time: 1.4656753540039062
Epoch: 10, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.613 Vali Acc: 0.836 Test Loss: 0.613 Test Acc: 0.836
Validation loss decreased (-0.822361 --> -0.835520).  Saving model ...
Epoch: 11 cost time: 1.3187181949615479
Epoch: 11, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.541 Vali Acc: 0.836 Test Loss: 0.541 Test Acc: 0.836
Validation loss decreased (-0.835520 --> -0.835521).  Saving model ...
Epoch: 12 cost time: 1.6505160331726074
Epoch: 12, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.480 Vali Acc: 0.842 Test Loss: 0.480 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 13 cost time: 1.6588258743286133
Epoch: 13, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.443 Vali Acc: 0.842 Test Loss: 0.443 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 14 cost time: 1.6132216453552246
Epoch: 14, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
Validation loss decreased (-0.842101 --> -0.861838).  Saving model ...
Epoch: 15 cost time: 1.6041686534881592
Epoch: 15, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.377 Vali Acc: 0.868 Test Loss: 0.377 Test Acc: 0.868
Validation loss decreased (-0.861838 --> -0.868417).  Saving model ...
Epoch: 16 cost time: 1.5915682315826416
Epoch: 16, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.379 Vali Acc: 0.836 Test Loss: 0.379 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.641157865524292
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.401 Vali Acc: 0.816 Test Loss: 0.401 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3774855136871338
Epoch: 18, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.409 Vali Acc: 0.816 Test Loss: 0.409 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5973002910614014
Epoch: 19, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.356 Vali Acc: 0.862 Test Loss: 0.356 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4463121891021729
Epoch: 20, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.345 Vali Acc: 0.862 Test Loss: 0.345 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4682424068450928
Epoch: 21, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.350 Vali Acc: 0.836 Test Loss: 0.350 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1950418949127197
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.357 Vali Acc: 0.842 Test Loss: 0.357 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5456981658935547
Epoch: 23, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.353 Vali Acc: 0.849 Test Loss: 0.353 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4073450565338135
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.359 Vali Acc: 0.842 Test Loss: 0.359 Test Acc: 0.842
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.531250238418579
Epoch: 25, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.352 Vali Acc: 0.849 Test Loss: 0.352 Test Acc: 0.849
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 2348676
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1879823207855225
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.368 Vali Acc: 0.349 Test Loss: 1.368 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.2638609409332275
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.327 Vali Acc: 0.401 Test Loss: 1.327 Test Acc: 0.401
Validation loss decreased (-0.348671 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.3289709091186523
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.275 Vali Acc: 0.447 Test Loss: 1.275 Test Acc: 0.447
Validation loss decreased (-0.401303 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.3152515888214111
Epoch: 4, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.214 Vali Acc: 0.533 Test Loss: 1.214 Test Acc: 0.533
Validation loss decreased (-0.447356 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.3835618495941162
Epoch: 5, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.152 Vali Acc: 0.586 Test Loss: 1.152 Test Acc: 0.586
Validation loss decreased (-0.532883 --> -0.585515).  Saving model ...
Epoch: 6 cost time: 1.2652897834777832
Epoch: 6, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.079 Vali Acc: 0.645 Test Loss: 1.079 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 1.1047086715698242
Epoch: 7, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.007 Vali Acc: 0.704 Test Loss: 1.007 Test Acc: 0.704
Validation loss decreased (-0.644726 --> -0.703937).  Saving model ...
Epoch: 8 cost time: 1.277784824371338
Epoch: 8, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.935 Vali Acc: 0.730 Test Loss: 0.935 Test Acc: 0.730
Validation loss decreased (-0.703937 --> -0.730254).  Saving model ...
Epoch: 9 cost time: 1.2806837558746338
Epoch: 9, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.862 Vali Acc: 0.737 Test Loss: 0.862 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736833).  Saving model ...
Epoch: 10 cost time: 1.2745108604431152
Epoch: 10, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.792 Vali Acc: 0.737 Test Loss: 0.792 Test Acc: 0.737
Validation loss decreased (-0.736833 --> -0.736834).  Saving model ...
Epoch: 11 cost time: 1.3488140106201172
Epoch: 11, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
Validation loss decreased (-0.736834 --> -0.789466).  Saving model ...
Epoch: 12 cost time: 1.2312817573547363
Epoch: 12, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.321603536605835
Epoch: 13, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
Validation loss decreased (-0.789466 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.3007166385650635
Epoch: 14, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3185663223266602
Epoch: 15, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.507 Vali Acc: 0.816 Test Loss: 0.507 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815784).  Saving model ...
Epoch: 16 cost time: 1.3739347457885742
Epoch: 16, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835522).  Saving model ...
Epoch: 17 cost time: 1.4140374660491943
Epoch: 17, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.434 Vali Acc: 0.842 Test Loss: 0.434 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 18 cost time: 1.1878058910369873
Epoch: 18, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3726508617401123
Epoch: 19, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.412 Vali Acc: 0.836 Test Loss: 0.412 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.134962558746338
Epoch: 20, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.393 Vali Acc: 0.822 Test Loss: 0.393 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.402160882949829
Epoch: 21, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.390 Vali Acc: 0.842 Test Loss: 0.390 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 22 cost time: 1.421783685684204
Epoch: 22, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.380 Vali Acc: 0.829 Test Loss: 0.380 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4489080905914307
Epoch: 23, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.370 Vali Acc: 0.836 Test Loss: 0.370 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0865576267242432
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.366 Vali Acc: 0.842 Test Loss: 0.366 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842102).  Saving model ...
Epoch: 25 cost time: 0.9308695793151855
Epoch: 25, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.374 Vali Acc: 0.842 Test Loss: 0.374 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0467238426208496
Epoch: 26, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.370 Vali Acc: 0.849 Test Loss: 0.370 Test Acc: 0.849
Validation loss decreased (-0.842102 --> -0.848681).  Saving model ...
Epoch: 27 cost time: 0.9686641693115234
Epoch: 27, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.361 Vali Acc: 0.822 Test Loss: 0.361 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9719877243041992
Epoch: 28, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.366 Vali Acc: 0.842 Test Loss: 0.366 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.274613380432129
Epoch: 29, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.364 Vali Acc: 0.836 Test Loss: 0.364 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0339248180389404
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.364 Vali Acc: 0.829 Test Loss: 0.364 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 693508
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.824652671813965
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.445 Vali Acc: 0.270 Test Loss: 1.445 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 3.761781692504883
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.397 Vali Acc: 0.322 Test Loss: 1.397 Test Acc: 0.322
Validation loss decreased (-0.269722 --> -0.322354).  Saving model ...
Epoch: 3 cost time: 3.5565192699432373
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.334 Vali Acc: 0.368 Test Loss: 1.334 Test Acc: 0.368
Validation loss decreased (-0.322354 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 3.0679571628570557
Epoch: 4, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.259 Vali Acc: 0.461 Test Loss: 1.259 Test Acc: 0.461
Validation loss decreased (-0.368408 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 2.8838424682617188
Epoch: 5, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.174 Vali Acc: 0.513 Test Loss: 1.174 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 2.3889658451080322
Epoch: 6, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.076 Vali Acc: 0.618 Test Loss: 1.076 Test Acc: 0.618
Validation loss decreased (-0.513146 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 3.057342290878296
Epoch: 7, Steps: 10 | Train Loss: 0.939 Vali Loss: 0.961 Vali Acc: 0.664 Test Loss: 0.961 Test Acc: 0.664
Validation loss decreased (-0.618410 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 3.0934202671051025
Epoch: 8, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
Validation loss decreased (-0.664464 --> -0.717097).  Saving model ...
Epoch: 9 cost time: 3.7646725177764893
Epoch: 9, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.743 Vali Acc: 0.750 Test Loss: 0.743 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 3.8700404167175293
Epoch: 10, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
Validation loss decreased (-0.749993 --> -0.796046).  Saving model ...
Epoch: 11 cost time: 3.755385160446167
Epoch: 11, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 3.5080406665802
Epoch: 12, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 13 cost time: 3.053069829940796
Epoch: 13, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.469 Vali Acc: 0.796 Test Loss: 0.469 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7549402713775635
Epoch: 14, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.452 Vali Acc: 0.836 Test Loss: 0.452 Test Acc: 0.836
Validation loss decreased (-0.802627 --> -0.835522).  Saving model ...
Epoch: 15 cost time: 2.659698486328125
Epoch: 15, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.418 Vali Acc: 0.829 Test Loss: 0.418 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.70314359664917
Epoch: 16, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.435 Vali Acc: 0.849 Test Loss: 0.435 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
Epoch: 17 cost time: 2.690044641494751
Epoch: 17, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.439 Vali Acc: 0.829 Test Loss: 0.439 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4232988357543945
Epoch: 18, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.462 Vali Acc: 0.829 Test Loss: 0.462 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3037242889404297
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.473 Vali Acc: 0.836 Test Loss: 0.473 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1766083240509033
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.524 Vali Acc: 0.836 Test Loss: 0.524 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.418125867843628
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.532 Vali Acc: 0.822 Test Loss: 0.532 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.2073514461517334
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.672649383544922
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.605 Vali Acc: 0.842 Test Loss: 0.605 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.969395637512207
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1341569423675537
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8747169971466064
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.559 Vali Acc: 0.822 Test Loss: 0.559 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 1176836
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3044960498809814
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.418 Vali Acc: 0.283 Test Loss: 1.418 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.112415075302124
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.372 Vali Acc: 0.322 Test Loss: 1.372 Test Acc: 0.322
Validation loss decreased (-0.282881 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 2.0873160362243652
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.315 Vali Acc: 0.434 Test Loss: 1.315 Test Acc: 0.434
Validation loss decreased (-0.322355 --> -0.434197).  Saving model ...
Epoch: 4 cost time: 2.098644495010376
Epoch: 4, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.252 Vali Acc: 0.467 Test Loss: 1.252 Test Acc: 0.467
Validation loss decreased (-0.434197 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 1.9907147884368896
Epoch: 5, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.182 Vali Acc: 0.526 Test Loss: 1.182 Test Acc: 0.526
Validation loss decreased (-0.467093 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 1.803088665008545
Epoch: 6, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.102 Vali Acc: 0.612 Test Loss: 1.102 Test Acc: 0.612
Validation loss decreased (-0.526304 --> -0.611831).  Saving model ...
Epoch: 7 cost time: 1.9712507724761963
Epoch: 7, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.023 Vali Acc: 0.632 Test Loss: 1.023 Test Acc: 0.632
Validation loss decreased (-0.611831 --> -0.631569).  Saving model ...
Epoch: 8 cost time: 2.1987931728363037
Epoch: 8, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.940 Vali Acc: 0.671 Test Loss: 0.940 Test Acc: 0.671
Validation loss decreased (-0.631569 --> -0.671043).  Saving model ...
Epoch: 9 cost time: 1.8413877487182617
Epoch: 9, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.856 Vali Acc: 0.711 Test Loss: 0.856 Test Acc: 0.711
Validation loss decreased (-0.671043 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 2.210470199584961
Epoch: 10, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.710518 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 2.379786252975464
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763151).  Saving model ...
Epoch: 12 cost time: 2.050690174102783
Epoch: 12, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782888).  Saving model ...
Epoch: 13 cost time: 2.086668014526367
Epoch: 13, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3916916847229004
Epoch: 14, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.132157325744629
Epoch: 15, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9400522708892822
Epoch: 16, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.267667770385742
Epoch: 17, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.9496631622314453
Epoch: 18, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.1461553573608398
Epoch: 19, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 20 cost time: 1.551490068435669
Epoch: 20, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.2103357315063477
Epoch: 21, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5275089740753174
Epoch: 22, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.466 Vali Acc: 0.822 Test Loss: 0.466 Test Acc: 0.822
Validation loss decreased (-0.809206 --> -0.822364).  Saving model ...
Epoch: 23 cost time: 1.8829209804534912
Epoch: 23, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.470 Vali Acc: 0.822 Test Loss: 0.470 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0911998748779297
Epoch: 24, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.021010160446167
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.477 Vali Acc: 0.822 Test Loss: 0.477 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3724164962768555
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 27 cost time: 2.0689213275909424
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.509 Vali Acc: 0.829 Test Loss: 0.509 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9327418804168701
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.144585132598877
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.512 Vali Acc: 0.836 Test Loss: 0.512 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2130627632141113
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.504 Vali Acc: 0.829 Test Loss: 0.504 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 349188
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.167002201080322
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.446 Vali Acc: 0.283 Test Loss: 1.446 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 2.6720497608184814
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.401 Vali Acc: 0.329 Test Loss: 1.401 Test Acc: 0.329
Validation loss decreased (-0.282880 --> -0.328933).  Saving model ...
Epoch: 3 cost time: 2.923722743988037
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.345 Vali Acc: 0.382 Test Loss: 1.345 Test Acc: 0.382
Validation loss decreased (-0.328933 --> -0.381565).  Saving model ...
Epoch: 4 cost time: 2.63075852394104
Epoch: 4, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.280 Vali Acc: 0.428 Test Loss: 1.280 Test Acc: 0.428
Validation loss decreased (-0.381565 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 2.0373125076293945
Epoch: 5, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.209 Vali Acc: 0.493 Test Loss: 1.209 Test Acc: 0.493
Validation loss decreased (-0.427619 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 2.2886292934417725
Epoch: 6, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.130 Vali Acc: 0.592 Test Loss: 1.130 Test Acc: 0.592
Validation loss decreased (-0.493409 --> -0.592094).  Saving model ...
Epoch: 7 cost time: 2.430581569671631
Epoch: 7, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.035 Vali Acc: 0.638 Test Loss: 1.035 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638148).  Saving model ...
Epoch: 8 cost time: 1.8900794982910156
Epoch: 8, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.932 Vali Acc: 0.678 Test Loss: 0.932 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 1.4939641952514648
Epoch: 9, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.832 Vali Acc: 0.697 Test Loss: 0.832 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 1.849416971206665
Epoch: 10, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.723 Vali Acc: 0.763 Test Loss: 0.723 Test Acc: 0.763
Validation loss decreased (-0.697360 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 1.903304100036621
Epoch: 11, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.8201754093170166
Epoch: 12, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
Validation loss decreased (-0.789467 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 2.0378873348236084
Epoch: 13, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.8307604789733887
Epoch: 14, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.451 Vali Acc: 0.816 Test Loss: 0.451 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 15 cost time: 1.855720043182373
Epoch: 15, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 16 cost time: 1.8423466682434082
Epoch: 16, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.410 Vali Acc: 0.822 Test Loss: 0.410 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822364).  Saving model ...
Epoch: 17 cost time: 1.3679754734039307
Epoch: 17, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4436562061309814
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.401 Vali Acc: 0.829 Test Loss: 0.401 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 19 cost time: 1.465588092803955
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.416 Vali Acc: 0.836 Test Loss: 0.416 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 20 cost time: 2.258418321609497
Epoch: 20, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.446 Vali Acc: 0.836 Test Loss: 0.446 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3363864421844482
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.471 Vali Acc: 0.849 Test Loss: 0.471 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848680).  Saving model ...
Epoch: 22 cost time: 1.8945441246032715
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.451 Vali Acc: 0.829 Test Loss: 0.451 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3945794105529785
Epoch: 23, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855258).  Saving model ...
Epoch: 24 cost time: 2.469057559967041
Epoch: 24, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.477 Vali Acc: 0.842 Test Loss: 0.477 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0551233291625977
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.491 Vali Acc: 0.829 Test Loss: 0.491 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9585990905761719
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.497 Vali Acc: 0.836 Test Loss: 0.497 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9470837116241455
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.480 Vali Acc: 0.842 Test Loss: 0.480 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.3568079471588135
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.1802501678466797
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.4563231468200684
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.549 Vali Acc: 0.842 Test Loss: 0.549 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 1176836
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4802558422088623
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.423 Vali Acc: 0.276 Test Loss: 1.423 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.2431511878967285
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.381 Vali Acc: 0.296 Test Loss: 1.381 Test Acc: 0.296
Validation loss decreased (-0.276302 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.3313777446746826
Epoch: 3, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.329 Vali Acc: 0.428 Test Loss: 1.329 Test Acc: 0.428
Validation loss decreased (-0.296039 --> -0.427618).  Saving model ...
Epoch: 4 cost time: 1.2586002349853516
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.274 Vali Acc: 0.447 Test Loss: 1.274 Test Acc: 0.447
Validation loss decreased (-0.427618 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 0.7497332096099854
Epoch: 5, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.213 Vali Acc: 0.513 Test Loss: 1.213 Test Acc: 0.513
Validation loss decreased (-0.447356 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 0.9670014381408691
Epoch: 6, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.145 Vali Acc: 0.559 Test Loss: 1.145 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 0.954392671585083
Epoch: 7, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.078 Vali Acc: 0.579 Test Loss: 1.078 Test Acc: 0.579
Validation loss decreased (-0.559199 --> -0.578937).  Saving model ...
Epoch: 8 cost time: 1.1833863258361816
Epoch: 8, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.3000478744506836
Epoch: 9, Steps: 10 | Train Loss: 0.863 Vali Loss: 0.928 Vali Acc: 0.671 Test Loss: 0.928 Test Acc: 0.671
Validation loss decreased (-0.624990 --> -0.671043).  Saving model ...
Epoch: 10 cost time: 1.4982831478118896
Epoch: 10, Steps: 10 | Train Loss: 0.757 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
Validation loss decreased (-0.671043 --> -0.710518).  Saving model ...
Epoch: 11 cost time: 1.8567676544189453
Epoch: 11, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.786 Vali Acc: 0.711 Test Loss: 0.786 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710518).  Saving model ...
Epoch: 12 cost time: 1.6468956470489502
Epoch: 12, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.726 Vali Acc: 0.757 Test Loss: 0.726 Test Acc: 0.757
Validation loss decreased (-0.710518 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.8172783851623535
Epoch: 13, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.673 Vali Acc: 0.757 Test Loss: 0.673 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 14 cost time: 1.4142203330993652
Epoch: 14, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.413123369216919
Epoch: 15, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.5072448253631592
Epoch: 16, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.6092214584350586
Epoch: 17, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.508 Vali Acc: 0.776 Test Loss: 0.508 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6156342029571533
Epoch: 18, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.493 Vali Acc: 0.776 Test Loss: 0.493 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1593873500823975
Epoch: 19, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.469 Vali Acc: 0.783 Test Loss: 0.469 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8269026279449463
Epoch: 20, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.455 Vali Acc: 0.783 Test Loss: 0.455 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5326566696166992
Epoch: 21, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.452 Vali Acc: 0.803 Test Loss: 0.452 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 22 cost time: 1.8135559558868408
Epoch: 22, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 23 cost time: 1.601266622543335
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.430 Vali Acc: 0.803 Test Loss: 0.430 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7980895042419434
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.435 Vali Acc: 0.809 Test Loss: 0.435 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 25 cost time: 1.484506607055664
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.448 Vali Acc: 0.816 Test Loss: 0.448 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 26 cost time: 1.6988945007324219
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.451 Vali Acc: 0.822 Test Loss: 0.451 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 27 cost time: 1.736776351928711
Epoch: 27, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2674238681793213
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 29 cost time: 1.6280021667480469
Epoch: 29, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6417222023010254
Epoch: 30, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 349188
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.488194465637207
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.446 Vali Acc: 0.289 Test Loss: 1.446 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.92262601852417
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.404 Vali Acc: 0.322 Test Loss: 1.404 Test Acc: 0.322
Validation loss decreased (-0.289459 --> -0.322354).  Saving model ...
Epoch: 3 cost time: 1.7625877857208252
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.351 Vali Acc: 0.382 Test Loss: 1.351 Test Acc: 0.382
Validation loss decreased (-0.322354 --> -0.381565).  Saving model ...
Epoch: 4 cost time: 1.6621630191802979
Epoch: 4, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.292 Vali Acc: 0.428 Test Loss: 1.292 Test Acc: 0.428
Validation loss decreased (-0.381565 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.918428659439087
Epoch: 5, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.229 Vali Acc: 0.487 Test Loss: 1.229 Test Acc: 0.487
Validation loss decreased (-0.427619 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 1.159407615661621
Epoch: 6, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.162 Vali Acc: 0.572 Test Loss: 1.162 Test Acc: 0.572
Validation loss decreased (-0.486830 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 1.9272010326385498
Epoch: 7, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.082 Vali Acc: 0.625 Test Loss: 1.082 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.6473557949066162
Epoch: 8, Steps: 10 | Train Loss: 0.960 Vali Loss: 0.998 Vali Acc: 0.664 Test Loss: 0.998 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664464).  Saving model ...
Epoch: 9 cost time: 1.7024509906768799
Epoch: 9, Steps: 10 | Train Loss: 0.876 Vali Loss: 0.915 Vali Acc: 0.678 Test Loss: 0.915 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677622).  Saving model ...
Epoch: 10 cost time: 1.7279729843139648
Epoch: 10, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.816 Vali Acc: 0.737 Test Loss: 0.816 Test Acc: 0.737
Validation loss decreased (-0.677622 --> -0.736834).  Saving model ...
Epoch: 11 cost time: 1.2436954975128174
Epoch: 11, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.720 Vali Acc: 0.776 Test Loss: 0.720 Test Acc: 0.776
Validation loss decreased (-0.736834 --> -0.776309).  Saving model ...
Epoch: 12 cost time: 1.6841039657592773
Epoch: 12, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 1.624845027923584
Epoch: 13, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.796046 --> -0.822363).  Saving model ...
Epoch: 14 cost time: 1.842073917388916
Epoch: 14, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822364).  Saving model ...
Epoch: 15 cost time: 1.6379482746124268
Epoch: 15, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 16 cost time: 1.8934283256530762
Epoch: 16, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.407 Vali Acc: 0.836 Test Loss: 0.407 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 17 cost time: 1.6877951622009277
Epoch: 17, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.397 Vali Acc: 0.836 Test Loss: 0.397 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835522).  Saving model ...
Epoch: 18 cost time: 1.4868254661560059
Epoch: 18, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.378 Vali Acc: 0.829 Test Loss: 0.378 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.720942735671997
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.369 Vali Acc: 0.829 Test Loss: 0.369 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4699065685272217
Epoch: 20, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.367 Vali Acc: 0.816 Test Loss: 0.367 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5356266498565674
Epoch: 21, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.371 Vali Acc: 0.816 Test Loss: 0.371 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1483302116394043
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.369 Vali Acc: 0.836 Test Loss: 0.369 Test Acc: 0.836
Validation loss decreased (-0.835522 --> -0.835523).  Saving model ...
Epoch: 23 cost time: 1.5831122398376465
Epoch: 23, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3746328353881836
Epoch: 24, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.618201494216919
Epoch: 25, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.366 Vali Acc: 0.836 Test Loss: 0.366 Test Acc: 0.836
Validation loss decreased (-0.835523 --> -0.835523).  Saving model ...
Epoch: 26 cost time: 1.7895874977111816
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.372 Vali Acc: 0.822 Test Loss: 0.372 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5170037746429443
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.379 Vali Acc: 0.829 Test Loss: 0.379 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7643764019012451
Epoch: 28, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4599711894989014
Epoch: 29, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.383 Vali Acc: 0.836 Test Loss: 0.383 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8396267890930176
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.381 Vali Acc: 0.829 Test Loss: 0.381 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1176836
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6089954376220703
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.430 Vali Acc: 0.257 Test Loss: 1.430 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 0.9459795951843262
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.393 Vali Acc: 0.296 Test Loss: 1.393 Test Acc: 0.296
Validation loss decreased (-0.256565 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.0258615016937256
Epoch: 3, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.349 Vali Acc: 0.368 Test Loss: 1.349 Test Acc: 0.368
Validation loss decreased (-0.296039 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 0.9231491088867188
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.300 Vali Acc: 0.408 Test Loss: 1.300 Test Acc: 0.408
Validation loss decreased (-0.368408 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 0.8694884777069092
Epoch: 5, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.246 Vali Acc: 0.467 Test Loss: 1.246 Test Acc: 0.467
Validation loss decreased (-0.407882 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.1181273460388184
Epoch: 6, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.185 Vali Acc: 0.533 Test Loss: 1.185 Test Acc: 0.533
Validation loss decreased (-0.467093 --> -0.532883).  Saving model ...
Epoch: 7 cost time: 1.4205338954925537
Epoch: 7, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.126 Vali Acc: 0.553 Test Loss: 1.126 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552620).  Saving model ...
Epoch: 8 cost time: 1.2474629878997803
Epoch: 8, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.062 Vali Acc: 0.572 Test Loss: 1.062 Test Acc: 0.572
Validation loss decreased (-0.552620 --> -0.572358).  Saving model ...
Epoch: 9 cost time: 1.2466483116149902
Epoch: 9, Steps: 10 | Train Loss: 0.941 Vali Loss: 0.995 Vali Acc: 0.618 Test Loss: 0.995 Test Acc: 0.618
Validation loss decreased (-0.572358 --> -0.618411).  Saving model ...
Epoch: 10 cost time: 1.4485342502593994
Epoch: 10, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.930 Vali Acc: 0.651 Test Loss: 0.930 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 1.2148232460021973
Epoch: 11, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.865 Vali Acc: 0.678 Test Loss: 0.865 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 12 cost time: 1.5118632316589355
Epoch: 12, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717097).  Saving model ...
Epoch: 13 cost time: 1.0444631576538086
Epoch: 13, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.731 Vali Acc: 0.743 Test Loss: 0.731 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743414).  Saving model ...
Epoch: 14 cost time: 1.008652687072754
Epoch: 14, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.2796719074249268
Epoch: 15, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 0.9515128135681152
Epoch: 16, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.307079553604126
Epoch: 17, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.056014060974121
Epoch: 18, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 0.8314299583435059
Epoch: 19, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.3400261402130127
Epoch: 20, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.444 Vali Acc: 0.803 Test Loss: 0.444 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 1.0531020164489746
Epoch: 21, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.409 Vali Acc: 0.822 Test Loss: 0.409 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822364).  Saving model ...
Epoch: 22 cost time: 1.2940723896026611
Epoch: 22, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.388 Vali Acc: 0.822 Test Loss: 0.388 Test Acc: 0.822
Validation loss decreased (-0.822364 --> -0.822365).  Saving model ...
Epoch: 23 cost time: 1.1683728694915771
Epoch: 23, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.379 Vali Acc: 0.829 Test Loss: 0.379 Test Acc: 0.829
Validation loss decreased (-0.822365 --> -0.828944).  Saving model ...
Epoch: 24 cost time: 1.1177196502685547
Epoch: 24, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.360 Vali Acc: 0.829 Test Loss: 0.360 Test Acc: 0.829
Validation loss decreased (-0.828944 --> -0.828944).  Saving model ...
Epoch: 25 cost time: 1.3312852382659912
Epoch: 25, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.359 Vali Acc: 0.836 Test Loss: 0.359 Test Acc: 0.836
Validation loss decreased (-0.828944 --> -0.835523).  Saving model ...
Epoch: 26 cost time: 1.1265060901641846
Epoch: 26, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.351 Vali Acc: 0.836 Test Loss: 0.351 Test Acc: 0.836
Validation loss decreased (-0.835523 --> -0.835523).  Saving model ...
Epoch: 27 cost time: 1.143019437789917
Epoch: 27, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.348 Vali Acc: 0.836 Test Loss: 0.348 Test Acc: 0.836
Validation loss decreased (-0.835523 --> -0.835523).  Saving model ...
Epoch: 28 cost time: 1.219393014907837
Epoch: 28, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.349 Vali Acc: 0.836 Test Loss: 0.349 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9876878261566162
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.349 Vali Acc: 0.842 Test Loss: 0.349 Test Acc: 0.842
Validation loss decreased (-0.835523 --> -0.842102).  Saving model ...
Epoch: 30 cost time: 1.1752583980560303
Epoch: 30, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.336 Vali Acc: 0.849 Test Loss: 0.336 Test Acc: 0.849
Validation loss decreased (-0.842102 --> -0.848681).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 349188
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3826515674591064
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.418 Vali Acc: 0.316 Test Loss: 1.418 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.1566286087036133
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.388 Vali Acc: 0.336 Test Loss: 1.388 Test Acc: 0.336
Validation loss decreased (-0.315775 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 1.2481918334960938
Epoch: 3, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.347 Vali Acc: 0.368 Test Loss: 1.347 Test Acc: 0.368
Validation loss decreased (-0.335512 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.0634336471557617
Epoch: 4, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.304 Vali Acc: 0.395 Test Loss: 1.304 Test Acc: 0.395
Validation loss decreased (-0.368408 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.5590779781341553
Epoch: 5, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.253 Vali Acc: 0.454 Test Loss: 1.253 Test Acc: 0.454
Validation loss decreased (-0.394724 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.6856298446655273
Epoch: 6, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.194 Vali Acc: 0.480 Test Loss: 1.194 Test Acc: 0.480
Validation loss decreased (-0.453935 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 1.7693984508514404
Epoch: 7, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.128 Vali Acc: 0.566 Test Loss: 1.128 Test Acc: 0.566
Validation loss decreased (-0.480251 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 1.857811450958252
Epoch: 8, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.054 Vali Acc: 0.632 Test Loss: 1.054 Test Acc: 0.632
Validation loss decreased (-0.565778 --> -0.631568).  Saving model ...
Epoch: 9 cost time: 1.9020063877105713
Epoch: 9, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
Validation loss decreased (-0.631568 --> -0.717096).  Saving model ...
Epoch: 10 cost time: 1.6910805702209473
Epoch: 10, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.889 Vali Acc: 0.730 Test Loss: 0.889 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730254).  Saving model ...
Epoch: 11 cost time: 1.8088996410369873
Epoch: 11, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.802 Vali Acc: 0.757 Test Loss: 0.802 Test Acc: 0.757
Validation loss decreased (-0.730254 --> -0.756571).  Saving model ...
Epoch: 12 cost time: 1.9823062419891357
Epoch: 12, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.731 Vali Acc: 0.737 Test Loss: 0.731 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8382439613342285
Epoch: 13, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 1.4903068542480469
Epoch: 14, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5092031955718994
Epoch: 15, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.782888 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.7599678039550781
Epoch: 16, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6019508838653564
Epoch: 17, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 18 cost time: 1.4533796310424805
Epoch: 18, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3554558753967285
Epoch: 19, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.483 Vali Acc: 0.783 Test Loss: 0.483 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4828851222991943
Epoch: 20, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.464 Vali Acc: 0.796 Test Loss: 0.464 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7378933429718018
Epoch: 21, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.424 Vali Acc: 0.829 Test Loss: 0.424 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 22 cost time: 1.5971596240997314
Epoch: 22, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.398 Vali Acc: 0.842 Test Loss: 0.398 Test Acc: 0.842
Validation loss decreased (-0.828943 --> -0.842101).  Saving model ...
Epoch: 23 cost time: 1.8795130252838135
Epoch: 23, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.405 Vali Acc: 0.822 Test Loss: 0.405 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6741957664489746
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.432 Vali Acc: 0.803 Test Loss: 0.432 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.890380859375
Epoch: 25, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.697601556777954
Epoch: 26, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.432 Vali Acc: 0.829 Test Loss: 0.432 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8318729400634766
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7825534343719482
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.411 Vali Acc: 0.842 Test Loss: 0.411 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4628703594207764
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.430 Vali Acc: 0.836 Test Loss: 0.430 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7291011810302734
Epoch: 30, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.417 Vali Acc: 0.822 Test Loss: 0.417 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1174724
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4016969203948975
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.337 Vali Acc: 0.329 Test Loss: 1.337 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.5544259548187256
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.297 Vali Acc: 0.382 Test Loss: 1.297 Test Acc: 0.382
Validation loss decreased (-0.328934 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.2887542247772217
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.249 Vali Acc: 0.421 Test Loss: 1.249 Test Acc: 0.421
Validation loss decreased (-0.381566 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.3960888385772705
Epoch: 4, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.198 Vali Acc: 0.539 Test Loss: 1.198 Test Acc: 0.539
Validation loss decreased (-0.421040 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.3412201404571533
Epoch: 5, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.150 Vali Acc: 0.566 Test Loss: 1.150 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 1.3192775249481201
Epoch: 6, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.097 Vali Acc: 0.599 Test Loss: 1.097 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.3047575950622559
Epoch: 7, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.040 Vali Acc: 0.612 Test Loss: 1.040 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611832).  Saving model ...
Epoch: 8 cost time: 1.2846596240997314
Epoch: 8, Steps: 10 | Train Loss: 1.042 Vali Loss: 0.977 Vali Acc: 0.671 Test Loss: 0.977 Test Acc: 0.671
Validation loss decreased (-0.611832 --> -0.671043).  Saving model ...
Epoch: 9 cost time: 1.4633347988128662
Epoch: 9, Steps: 10 | Train Loss: 0.956 Vali Loss: 0.909 Vali Acc: 0.717 Test Loss: 0.909 Test Acc: 0.717
Validation loss decreased (-0.671043 --> -0.717096).  Saving model ...
Epoch: 10 cost time: 1.2729337215423584
Epoch: 10, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.839 Vali Acc: 0.757 Test Loss: 0.839 Test Acc: 0.757
Validation loss decreased (-0.717096 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 1.4319255352020264
Epoch: 11, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.770 Vali Acc: 0.789 Test Loss: 0.770 Test Acc: 0.789
Validation loss decreased (-0.756571 --> -0.789466).  Saving model ...
Epoch: 12 cost time: 1.456679344177246
Epoch: 12, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.704 Vali Acc: 0.796 Test Loss: 0.704 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 1.360673427581787
Epoch: 13, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.646 Vali Acc: 0.816 Test Loss: 0.646 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815783).  Saving model ...
Epoch: 14 cost time: 1.316110610961914
Epoch: 14, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.592 Vali Acc: 0.829 Test Loss: 0.592 Test Acc: 0.829
Validation loss decreased (-0.815783 --> -0.828941).  Saving model ...
Epoch: 15 cost time: 1.376535415649414
Epoch: 15, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.548 Vali Acc: 0.836 Test Loss: 0.548 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835521).  Saving model ...
Epoch: 16 cost time: 1.3057129383087158
Epoch: 16, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.513 Vali Acc: 0.836 Test Loss: 0.513 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835521).  Saving model ...
Epoch: 17 cost time: 1.4190089702606201
Epoch: 17, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.472 Vali Acc: 0.842 Test Loss: 0.472 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842101).  Saving model ...
Epoch: 18 cost time: 1.1880831718444824
Epoch: 18, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.446 Vali Acc: 0.829 Test Loss: 0.446 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4311587810516357
Epoch: 19, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.447 Vali Acc: 0.803 Test Loss: 0.447 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.35722017288208
Epoch: 20, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.421 Vali Acc: 0.816 Test Loss: 0.421 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4546852111816406
Epoch: 21, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.431 Vali Acc: 0.816 Test Loss: 0.431 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4493083953857422
Epoch: 22, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.431 Vali Acc: 0.816 Test Loss: 0.431 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6421642303466797
Epoch: 23, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.403 Vali Acc: 0.829 Test Loss: 0.403 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.490126132965088
Epoch: 24, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.403 Vali Acc: 0.829 Test Loss: 0.403 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5279309749603271
Epoch: 25, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.410 Vali Acc: 0.829 Test Loss: 0.410 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3908905982971191
Epoch: 26, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.394 Vali Acc: 0.803 Test Loss: 0.394 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.266667366027832
Epoch: 27, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.404 Vali Acc: 0.809 Test Loss: 0.404 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 347012
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4716007709503174
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.419 Vali Acc: 0.316 Test Loss: 1.419 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 1.527251958847046
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.390 Vali Acc: 0.336 Test Loss: 1.390 Test Acc: 0.336
Validation loss decreased (-0.315775 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 1.4641120433807373
Epoch: 3, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.353 Vali Acc: 0.368 Test Loss: 1.353 Test Acc: 0.368
Validation loss decreased (-0.335512 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.3103463649749756
Epoch: 4, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.311 Vali Acc: 0.421 Test Loss: 1.311 Test Acc: 0.421
Validation loss decreased (-0.368408 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.3005449771881104
Epoch: 5, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.265 Vali Acc: 0.428 Test Loss: 1.265 Test Acc: 0.428
Validation loss decreased (-0.421040 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.311950922012329
Epoch: 6, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.211 Vali Acc: 0.474 Test Loss: 1.211 Test Acc: 0.474
Validation loss decreased (-0.427619 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 1.2966406345367432
Epoch: 7, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.153 Vali Acc: 0.546 Test Loss: 1.153 Test Acc: 0.546
Validation loss decreased (-0.473672 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 1.5682363510131836
Epoch: 8, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.091 Vali Acc: 0.612 Test Loss: 1.091 Test Acc: 0.612
Validation loss decreased (-0.546041 --> -0.611831).  Saving model ...
Epoch: 9 cost time: 1.379584550857544
Epoch: 9, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.022 Vali Acc: 0.691 Test Loss: 1.022 Test Acc: 0.691
Validation loss decreased (-0.611831 --> -0.690779).  Saving model ...
Epoch: 10 cost time: 1.4406604766845703
Epoch: 10, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.952 Vali Acc: 0.697 Test Loss: 0.952 Test Acc: 0.697
Validation loss decreased (-0.690779 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 1.322265386581421
Epoch: 11, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.872 Vali Acc: 0.730 Test Loss: 0.872 Test Acc: 0.730
Validation loss decreased (-0.697359 --> -0.730254).  Saving model ...
Epoch: 12 cost time: 1.3809967041015625
Epoch: 12, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.801 Vali Acc: 0.737 Test Loss: 0.801 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736834).  Saving model ...
Epoch: 13 cost time: 1.4832823276519775
Epoch: 13, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.723 Vali Acc: 0.737 Test Loss: 0.723 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736835).  Saving model ...
Epoch: 14 cost time: 1.3036396503448486
Epoch: 14, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.2828598022460938
Epoch: 15, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
Validation loss decreased (-0.749994 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.2617015838623047
Epoch: 16, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.2534260749816895
Epoch: 17, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.552623987197876
Epoch: 18, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5293762683868408
Epoch: 19, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.468437671661377
Epoch: 20, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5495152473449707
Epoch: 21, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.442 Vali Acc: 0.809 Test Loss: 0.442 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.6087543964385986
Epoch: 22, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.434 Vali Acc: 0.803 Test Loss: 0.434 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.871835470199585
Epoch: 23, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.418 Vali Acc: 0.836 Test Loss: 0.418 Test Acc: 0.836
Validation loss decreased (-0.809206 --> -0.835522).  Saving model ...
Epoch: 24 cost time: 1.5634069442749023
Epoch: 24, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5357694625854492
Epoch: 25, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.413 Vali Acc: 0.822 Test Loss: 0.413 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4182953834533691
Epoch: 26, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.376 Vali Acc: 0.829 Test Loss: 0.376 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5321283340454102
Epoch: 27, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.366 Vali Acc: 0.849 Test Loss: 0.366 Test Acc: 0.849
Validation loss decreased (-0.835522 --> -0.848681).  Saving model ...
Epoch: 28 cost time: 1.6492528915405273
Epoch: 28, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.369 Vali Acc: 0.842 Test Loss: 0.369 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4024362564086914
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.371 Vali Acc: 0.849 Test Loss: 0.371 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2966115474700928
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.365 Vali Acc: 0.842 Test Loss: 0.365 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 1174724
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1446423530578613
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.343 Vali Acc: 0.322 Test Loss: 1.343 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.3038520812988281
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.307 Vali Acc: 0.362 Test Loss: 1.307 Test Acc: 0.362
Validation loss decreased (-0.322355 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.415459394454956
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.263 Vali Acc: 0.421 Test Loss: 1.263 Test Acc: 0.421
Validation loss decreased (-0.361829 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.2531046867370605
Epoch: 4, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.214 Vali Acc: 0.507 Test Loss: 1.214 Test Acc: 0.507
Validation loss decreased (-0.421040 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 1.2402379512786865
Epoch: 5, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.166 Vali Acc: 0.539 Test Loss: 1.166 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.2381389141082764
Epoch: 6, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.117 Vali Acc: 0.586 Test Loss: 1.117 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 1.323636531829834
Epoch: 7, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.080 Vali Acc: 0.579 Test Loss: 1.080 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1736562252044678
Epoch: 8, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.020 Vali Acc: 0.599 Test Loss: 1.020 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 1.1266071796417236
Epoch: 9, Steps: 10 | Train Loss: 0.997 Vali Loss: 0.958 Vali Acc: 0.658 Test Loss: 0.958 Test Acc: 0.658
Validation loss decreased (-0.598674 --> -0.657885).  Saving model ...
Epoch: 10 cost time: 1.2176973819732666
Epoch: 10, Steps: 10 | Train Loss: 0.929 Vali Loss: 0.896 Vali Acc: 0.684 Test Loss: 0.896 Test Acc: 0.684
Validation loss decreased (-0.657885 --> -0.684202).  Saving model ...
Epoch: 11 cost time: 1.0634193420410156
Epoch: 11, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.832 Vali Acc: 0.737 Test Loss: 0.832 Test Acc: 0.737
Validation loss decreased (-0.684202 --> -0.736834).  Saving model ...
Epoch: 12 cost time: 1.1121463775634766
Epoch: 12, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 1.0510258674621582
Epoch: 13, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.712 Vali Acc: 0.763 Test Loss: 0.712 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.116865634918213
Epoch: 14, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
Validation loss decreased (-0.763151 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.1689519882202148
Epoch: 15, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.105851411819458
Epoch: 16, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.173790693283081
Epoch: 17, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.2770581245422363
Epoch: 18, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822364).  Saving model ...
Epoch: 19 cost time: 1.1674070358276367
Epoch: 19, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.466 Vali Acc: 0.842 Test Loss: 0.466 Test Acc: 0.842
Validation loss decreased (-0.822364 --> -0.842101).  Saving model ...
Epoch: 20 cost time: 1.2947816848754883
Epoch: 20, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.443 Vali Acc: 0.829 Test Loss: 0.443 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.068887710571289
Epoch: 21, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.424 Vali Acc: 0.836 Test Loss: 0.424 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.312755823135376
Epoch: 22, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.842101 --> -0.855259).  Saving model ...
Epoch: 23 cost time: 1.3305037021636963
Epoch: 23, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.407 Vali Acc: 0.842 Test Loss: 0.407 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2270488739013672
Epoch: 24, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.408 Vali Acc: 0.842 Test Loss: 0.408 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.237797737121582
Epoch: 25, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3604507446289062
Epoch: 26, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.383 Vali Acc: 0.868 Test Loss: 0.383 Test Acc: 0.868
Validation loss decreased (-0.855259 --> -0.868417).  Saving model ...
Epoch: 27 cost time: 1.2166383266448975
Epoch: 27, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.396 Vali Acc: 0.849 Test Loss: 0.396 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2778239250183105
Epoch: 28, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.397 Vali Acc: 0.849 Test Loss: 0.397 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.239591121673584
Epoch: 29, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.401 Vali Acc: 0.849 Test Loss: 0.401 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1671178340911865
Epoch: 30, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.387 Vali Acc: 0.849 Test Loss: 0.387 Test Acc: 0.849
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 347012
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.305969715118408
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.418 Vali Acc: 0.309 Test Loss: 1.418 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.3141510486602783
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.394 Vali Acc: 0.336 Test Loss: 1.394 Test Acc: 0.336
Validation loss decreased (-0.309196 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 1.4083082675933838
Epoch: 3, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.361 Vali Acc: 0.355 Test Loss: 1.361 Test Acc: 0.355
Validation loss decreased (-0.335512 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.3949222564697266
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.326 Vali Acc: 0.395 Test Loss: 1.326 Test Acc: 0.395
Validation loss decreased (-0.355250 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.170994758605957
Epoch: 5, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.287 Vali Acc: 0.441 Test Loss: 1.287 Test Acc: 0.441
Validation loss decreased (-0.394724 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 1.3933091163635254
Epoch: 6, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.244 Vali Acc: 0.461 Test Loss: 1.244 Test Acc: 0.461
Validation loss decreased (-0.440777 --> -0.460514).  Saving model ...
Epoch: 7 cost time: 1.174391269683838
Epoch: 7, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.199 Vali Acc: 0.513 Test Loss: 1.199 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 1.3031022548675537
Epoch: 8, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.149 Vali Acc: 0.592 Test Loss: 1.149 Test Acc: 0.592
Validation loss decreased (-0.513146 --> -0.592094).  Saving model ...
Epoch: 9 cost time: 1.2211666107177734
Epoch: 9, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.094 Vali Acc: 0.664 Test Loss: 1.094 Test Acc: 0.664
Validation loss decreased (-0.592094 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 1.118194341659546
Epoch: 10, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.040 Vali Acc: 0.697 Test Loss: 1.040 Test Acc: 0.697
Validation loss decreased (-0.664463 --> -0.697358).  Saving model ...
Epoch: 11 cost time: 1.2833564281463623
Epoch: 11, Steps: 10 | Train Loss: 0.916 Vali Loss: 0.970 Vali Acc: 0.724 Test Loss: 0.970 Test Acc: 0.724
Validation loss decreased (-0.697358 --> -0.723675).  Saving model ...
Epoch: 12 cost time: 1.1689717769622803
Epoch: 12, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.906 Vali Acc: 0.737 Test Loss: 0.906 Test Acc: 0.737
Validation loss decreased (-0.723675 --> -0.736833).  Saving model ...
Epoch: 13 cost time: 0.9865338802337646
Epoch: 13, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.847 Vali Acc: 0.724 Test Loss: 0.847 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1218647956848145
Epoch: 14, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.784 Vali Acc: 0.737 Test Loss: 0.784 Test Acc: 0.737
Validation loss decreased (-0.736833 --> -0.736834).  Saving model ...
Epoch: 15 cost time: 1.3312175273895264
Epoch: 15, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
Validation loss decreased (-0.736834 --> -0.769730).  Saving model ...
Epoch: 16 cost time: 1.3506395816802979
Epoch: 16, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.663 Vali Acc: 0.770 Test Loss: 0.663 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 17 cost time: 1.1608786582946777
Epoch: 17, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
Validation loss decreased (-0.769730 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.3318612575531006
Epoch: 18, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1015851497650146
Epoch: 19, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2132596969604492
Epoch: 20, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.40897798538208
Epoch: 21, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.467 Vali Acc: 0.829 Test Loss: 0.467 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828943).  Saving model ...
Epoch: 22 cost time: 0.9451687335968018
Epoch: 22, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.468 Vali Acc: 0.836 Test Loss: 0.468 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835522).  Saving model ...
Epoch: 23 cost time: 1.3231940269470215
Epoch: 23, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.447 Vali Acc: 0.809 Test Loss: 0.447 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0644395351409912
Epoch: 24, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.443 Vali Acc: 0.803 Test Loss: 0.443 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9322326183319092
Epoch: 25, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.426 Vali Acc: 0.816 Test Loss: 0.426 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0706446170806885
Epoch: 26, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.421 Vali Acc: 0.822 Test Loss: 0.421 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9906232357025146
Epoch: 27, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.411 Vali Acc: 0.822 Test Loss: 0.411 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9890062808990479
Epoch: 28, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.386 Vali Acc: 0.842 Test Loss: 0.386 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 29 cost time: 1.0530736446380615
Epoch: 29, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.368 Vali Acc: 0.836 Test Loss: 0.368 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2870476245880127
Epoch: 30, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.387 Vali Acc: 0.842 Test Loss: 0.387 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1174724
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.935511827468872
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.347 Vali Acc: 0.303 Test Loss: 1.347 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.1262364387512207
Epoch: 2, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.317 Vali Acc: 0.316 Test Loss: 1.317 Test Acc: 0.316
Validation loss decreased (-0.302618 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.0786571502685547
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.284 Vali Acc: 0.401 Test Loss: 1.284 Test Acc: 0.401
Validation loss decreased (-0.315776 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.0597708225250244
Epoch: 4, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.248 Vali Acc: 0.441 Test Loss: 1.248 Test Acc: 0.441
Validation loss decreased (-0.401303 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 0.9725856781005859
Epoch: 5, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.212 Vali Acc: 0.480 Test Loss: 1.212 Test Acc: 0.480
Validation loss decreased (-0.440777 --> -0.480251).  Saving model ...
Epoch: 6 cost time: 1.0874309539794922
Epoch: 6, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.173 Vali Acc: 0.546 Test Loss: 1.173 Test Acc: 0.546
Validation loss decreased (-0.480251 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 1.275167465209961
Epoch: 7, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.134 Vali Acc: 0.572 Test Loss: 1.134 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 1.17445707321167
Epoch: 8, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.092 Vali Acc: 0.586 Test Loss: 1.092 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 1.129361629486084
Epoch: 9, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.044 Vali Acc: 0.645 Test Loss: 1.044 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 10 cost time: 0.997570276260376
Epoch: 10, Steps: 10 | Train Loss: 1.047 Vali Loss: 0.995 Vali Acc: 0.638 Test Loss: 0.995 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.020400047302246
Epoch: 11, Steps: 10 | Train Loss: 0.963 Vali Loss: 0.945 Vali Acc: 0.684 Test Loss: 0.945 Test Acc: 0.684
Validation loss decreased (-0.644726 --> -0.684201).  Saving model ...
Epoch: 12 cost time: 1.028472661972046
Epoch: 12, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.886 Vali Acc: 0.737 Test Loss: 0.886 Test Acc: 0.737
Validation loss decreased (-0.684201 --> -0.736833).  Saving model ...
Epoch: 13 cost time: 1.2058947086334229
Epoch: 13, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.820 Vali Acc: 0.757 Test Loss: 0.820 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756571).  Saving model ...
Epoch: 14 cost time: 1.1423587799072266
Epoch: 14, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.758 Vali Acc: 0.776 Test Loss: 0.758 Test Acc: 0.776
Validation loss decreased (-0.756571 --> -0.776308).  Saving model ...
Epoch: 15 cost time: 1.1589813232421875
Epoch: 15, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
Validation loss decreased (-0.776308 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 1.1948797702789307
Epoch: 16, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796046).  Saving model ...
Epoch: 17 cost time: 1.1389193534851074
Epoch: 17, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.1162521839141846
Epoch: 18, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.0418968200683594
Epoch: 19, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.1591038703918457
Epoch: 20, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.496 Vali Acc: 0.836 Test Loss: 0.496 Test Acc: 0.836
Validation loss decreased (-0.802626 --> -0.835521).  Saving model ...
Epoch: 21 cost time: 0.9682297706604004
Epoch: 21, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.464 Vali Acc: 0.829 Test Loss: 0.464 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0708873271942139
Epoch: 22, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.443 Vali Acc: 0.862 Test Loss: 0.443 Test Acc: 0.862
Validation loss decreased (-0.835521 --> -0.861838).  Saving model ...
Epoch: 23 cost time: 1.1718990802764893
Epoch: 23, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0694818496704102
Epoch: 24, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.478 Vali Acc: 0.829 Test Loss: 0.478 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.158825159072876
Epoch: 25, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9765245914459229
Epoch: 26, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9542474746704102
Epoch: 27, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9618759155273438
Epoch: 28, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0916733741760254
Epoch: 29, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9697308540344238
Epoch: 30, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.386 Vali Acc: 0.836 Test Loss: 0.386 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 347012
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.414456844329834
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.433 Vali Acc: 0.184 Test Loss: 1.433 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 2.550424337387085
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.410 Vali Acc: 0.237 Test Loss: 1.410 Test Acc: 0.237
Validation loss decreased (-0.184196 --> -0.236828).  Saving model ...
Epoch: 3 cost time: 3.304774284362793
Epoch: 3, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.382 Vali Acc: 0.257 Test Loss: 1.382 Test Acc: 0.257
Validation loss decreased (-0.236828 --> -0.256565).  Saving model ...
Epoch: 4 cost time: 2.7778804302215576
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.350 Vali Acc: 0.336 Test Loss: 1.350 Test Acc: 0.336
Validation loss decreased (-0.256565 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 3.0229485034942627
Epoch: 5, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.313 Vali Acc: 0.395 Test Loss: 1.313 Test Acc: 0.395
Validation loss decreased (-0.335513 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 3.1223862171173096
Epoch: 6, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
Validation loss decreased (-0.394724 --> -0.480250).  Saving model ...
Epoch: 7 cost time: 3.99216365814209
Epoch: 7, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.226 Vali Acc: 0.520 Test Loss: 1.226 Test Acc: 0.520
Validation loss decreased (-0.480250 --> -0.519725).  Saving model ...
Epoch: 8 cost time: 3.5346784591674805
Epoch: 8, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.175 Vali Acc: 0.546 Test Loss: 1.175 Test Acc: 0.546
Validation loss decreased (-0.519725 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 3.8267533779144287
Epoch: 9, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.119 Vali Acc: 0.559 Test Loss: 1.119 Test Acc: 0.559
Validation loss decreased (-0.546041 --> -0.559199).  Saving model ...
Epoch: 10 cost time: 3.329782724380493
Epoch: 10, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.058 Vali Acc: 0.658 Test Loss: 1.058 Test Acc: 0.658
Validation loss decreased (-0.559199 --> -0.657884).  Saving model ...
Epoch: 11 cost time: 3.7748281955718994
Epoch: 11, Steps: 10 | Train Loss: 0.963 Vali Loss: 0.986 Vali Acc: 0.678 Test Loss: 0.986 Test Acc: 0.678
Validation loss decreased (-0.657884 --> -0.677622).  Saving model ...
Epoch: 12 cost time: 3.002121686935425
Epoch: 12, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.915 Vali Acc: 0.691 Test Loss: 0.915 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690780).  Saving model ...
Epoch: 13 cost time: 3.4716925621032715
Epoch: 13, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717097).  Saving model ...
Epoch: 14 cost time: 2.691354274749756
Epoch: 14, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.767 Vali Acc: 0.763 Test Loss: 0.767 Test Acc: 0.763
Validation loss decreased (-0.717097 --> -0.763150).  Saving model ...
Epoch: 15 cost time: 3.521639108657837
Epoch: 15, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.689 Vali Acc: 0.796 Test Loss: 0.689 Test Acc: 0.796
Validation loss decreased (-0.763150 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 2.8875343799591064
Epoch: 16, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.626 Vali Acc: 0.816 Test Loss: 0.626 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815783).  Saving model ...
Epoch: 17 cost time: 3.54492449760437
Epoch: 17, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4098589420318604
Epoch: 18, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8279380798339844
Epoch: 19, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6542234420776367
Epoch: 20, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6933114528656006
Epoch: 21, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.459 Vali Acc: 0.842 Test Loss: 0.459 Test Acc: 0.842
Validation loss decreased (-0.815783 --> -0.842101).  Saving model ...
Epoch: 22 cost time: 3.1281356811523438
Epoch: 22, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.463 Vali Acc: 0.822 Test Loss: 0.463 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6689178943634033
Epoch: 23, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.433 Vali Acc: 0.842 Test Loss: 0.433 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842101).  Saving model ...
Epoch: 24 cost time: 2.852097749710083
Epoch: 24, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.422 Vali Acc: 0.816 Test Loss: 0.422 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.391645669937134
Epoch: 25, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.409 Vali Acc: 0.829 Test Loss: 0.409 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.6527578830718994
Epoch: 26, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.389 Vali Acc: 0.836 Test Loss: 0.389 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.188519239425659
Epoch: 27, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.701033592224121
Epoch: 28, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.383 Vali Acc: 0.829 Test Loss: 0.383 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.401435375213623
Epoch: 29, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.364 Vali Acc: 0.842 Test Loss: 0.364 Test Acc: 0.842
Validation loss decreased (-0.842101 --> -0.842102).  Saving model ...
Epoch: 30 cost time: 2.442805528640747
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.365 Vali Acc: 0.842 Test Loss: 0.365 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 588612
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.172916650772095
Epoch: 1, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.347 Vali Acc: 0.322 Test Loss: 1.347 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 2.3463141918182373
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.324 Vali Acc: 0.349 Test Loss: 1.324 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 2.559863328933716
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.294 Vali Acc: 0.414 Test Loss: 1.294 Test Acc: 0.414
Validation loss decreased (-0.348671 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 2.169373035430908
Epoch: 4, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.259 Vali Acc: 0.461 Test Loss: 1.259 Test Acc: 0.461
Validation loss decreased (-0.414461 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 2.401611804962158
Epoch: 5, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
Validation loss decreased (-0.460514 --> -0.519725).  Saving model ...
Epoch: 6 cost time: 2.2837255001068115
Epoch: 6, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.179 Vali Acc: 0.579 Test Loss: 1.179 Test Acc: 0.579
Validation loss decreased (-0.519725 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 2.1672167778015137
Epoch: 7, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.128 Vali Acc: 0.612 Test Loss: 1.128 Test Acc: 0.612
Validation loss decreased (-0.578936 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 2.275289297103882
Epoch: 8, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.075 Vali Acc: 0.658 Test Loss: 1.075 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657884).  Saving model ...
Epoch: 9 cost time: 1.9962410926818848
Epoch: 9, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.012 Vali Acc: 0.697 Test Loss: 1.012 Test Acc: 0.697
Validation loss decreased (-0.657884 --> -0.697358).  Saving model ...
Epoch: 10 cost time: 2.3279025554656982
Epoch: 10, Steps: 10 | Train Loss: 0.942 Vali Loss: 0.948 Vali Acc: 0.697 Test Loss: 0.948 Test Acc: 0.697
Validation loss decreased (-0.697358 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 2.1896331310272217
Epoch: 11, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.879 Vali Acc: 0.711 Test Loss: 0.879 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710518).  Saving model ...
Epoch: 12 cost time: 2.2526743412017822
Epoch: 12, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.813 Vali Acc: 0.737 Test Loss: 0.813 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736834).  Saving model ...
Epoch: 13 cost time: 2.504694938659668
Epoch: 13, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.741 Vali Acc: 0.737 Test Loss: 0.741 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736835).  Saving model ...
Epoch: 14 cost time: 2.398981809616089
Epoch: 14, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.675 Vali Acc: 0.750 Test Loss: 0.675 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.4993739128112793
Epoch: 15, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 2.579406261444092
Epoch: 16, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 2.2535135746002197
Epoch: 17, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 2.6063148975372314
Epoch: 18, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 2.5667927265167236
Epoch: 19, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.482 Vali Acc: 0.783 Test Loss: 0.482 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9252805709838867
Epoch: 20, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 2.406865358352661
Epoch: 21, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822364).  Saving model ...
Epoch: 22 cost time: 2.0748255252838135
Epoch: 22, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.440 Vali Acc: 0.789 Test Loss: 0.440 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9691574573516846
Epoch: 23, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.427 Vali Acc: 0.816 Test Loss: 0.427 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.256922721862793
Epoch: 24, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.409 Vali Acc: 0.829 Test Loss: 0.409 Test Acc: 0.829
Validation loss decreased (-0.822364 --> -0.828943).  Saving model ...
Epoch: 25 cost time: 1.8636023998260498
Epoch: 25, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.201030731201172
Epoch: 26, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.308290481567383
Epoch: 27, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.424 Vali Acc: 0.829 Test Loss: 0.424 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2528741359710693
Epoch: 28, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4400763511657715
Epoch: 29, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.415 Vali Acc: 0.809 Test Loss: 0.415 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.015127420425415
Epoch: 30, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.420 Vali Acc: 0.809 Test Loss: 0.420 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 174724
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.725298166275024
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.432 Vali Acc: 0.184 Test Loss: 1.432 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 2.3394293785095215
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.411 Vali Acc: 0.224 Test Loss: 1.411 Test Acc: 0.224
Validation loss decreased (-0.184196 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 1.7088558673858643
Epoch: 3, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.384 Vali Acc: 0.243 Test Loss: 1.384 Test Acc: 0.243
Validation loss decreased (-0.223670 --> -0.243407).  Saving model ...
Epoch: 4 cost time: 1.4994785785675049
Epoch: 4, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.353 Vali Acc: 0.329 Test Loss: 1.353 Test Acc: 0.329
Validation loss decreased (-0.243407 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 1.4302361011505127
Epoch: 5, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.318 Vali Acc: 0.382 Test Loss: 1.318 Test Acc: 0.382
Validation loss decreased (-0.328934 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 1.6377997398376465
Epoch: 6, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.280 Vali Acc: 0.441 Test Loss: 1.280 Test Acc: 0.441
Validation loss decreased (-0.381566 --> -0.440777).  Saving model ...
Epoch: 7 cost time: 2.6109514236450195
Epoch: 7, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.237 Vali Acc: 0.533 Test Loss: 1.237 Test Acc: 0.533
Validation loss decreased (-0.440777 --> -0.532882).  Saving model ...
Epoch: 8 cost time: 2.784292459487915
Epoch: 8, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.191 Vali Acc: 0.559 Test Loss: 1.191 Test Acc: 0.559
Validation loss decreased (-0.532882 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 2.572514057159424
Epoch: 9, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.142 Vali Acc: 0.566 Test Loss: 1.142 Test Acc: 0.566
Validation loss decreased (-0.559199 --> -0.565778).  Saving model ...
Epoch: 10 cost time: 2.9329962730407715
Epoch: 10, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.089 Vali Acc: 0.638 Test Loss: 1.089 Test Acc: 0.638
Validation loss decreased (-0.565778 --> -0.638147).  Saving model ...
Epoch: 11 cost time: 3.004392623901367
Epoch: 11, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.029 Vali Acc: 0.645 Test Loss: 1.029 Test Acc: 0.645
Validation loss decreased (-0.638147 --> -0.644727).  Saving model ...
Epoch: 12 cost time: 2.675445079803467
Epoch: 12, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.965 Vali Acc: 0.691 Test Loss: 0.965 Test Acc: 0.691
Validation loss decreased (-0.644727 --> -0.690780).  Saving model ...
Epoch: 13 cost time: 2.5522894859313965
Epoch: 13, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.889 Vali Acc: 0.717 Test Loss: 0.889 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717096).  Saving model ...
Epoch: 14 cost time: 2.7695677280426025
Epoch: 14, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.828 Vali Acc: 0.730 Test Loss: 0.828 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 2.4757883548736572
Epoch: 15, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 2.2673771381378174
Epoch: 16, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.684 Vali Acc: 0.763 Test Loss: 0.684 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 2.5246176719665527
Epoch: 17, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.629 Vali Acc: 0.763 Test Loss: 0.629 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 2.7525415420532227
Epoch: 18, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 2.524839401245117
Epoch: 19, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 2.2609236240386963
Epoch: 20, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 21 cost time: 1.9940907955169678
Epoch: 21, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.476 Vali Acc: 0.836 Test Loss: 0.476 Test Acc: 0.836
Validation loss decreased (-0.776311 --> -0.835522).  Saving model ...
Epoch: 22 cost time: 3.021899938583374
Epoch: 22, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5786118507385254
Epoch: 23, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4724371433258057
Epoch: 24, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6261954307556152
Epoch: 25, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.428 Vali Acc: 0.822 Test Loss: 0.428 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6911685466766357
Epoch: 26, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.418 Vali Acc: 0.822 Test Loss: 0.418 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1470744609832764
Epoch: 27, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.426 Vali Acc: 0.809 Test Loss: 0.426 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.995913028717041
Epoch: 28, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.401 Vali Acc: 0.842 Test Loss: 0.401 Test Acc: 0.842
Validation loss decreased (-0.835522 --> -0.842101).  Saving model ...
Epoch: 29 cost time: 2.3279311656951904
Epoch: 29, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.429 Vali Acc: 0.836 Test Loss: 0.429 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.504777193069458
Epoch: 30, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 588612
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9269649982452393
Epoch: 1, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.347 Vali Acc: 0.336 Test Loss: 1.347 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.5759150981903076
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.327 Vali Acc: 0.368 Test Loss: 1.327 Test Acc: 0.368
Validation loss decreased (-0.335513 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.4270787239074707
Epoch: 3, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.301 Vali Acc: 0.421 Test Loss: 1.301 Test Acc: 0.421
Validation loss decreased (-0.368408 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.3981494903564453
Epoch: 4, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.268 Vali Acc: 0.434 Test Loss: 1.268 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 1.3356266021728516
Epoch: 5, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.434198 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.4227564334869385
Epoch: 6, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.195 Vali Acc: 0.553 Test Loss: 1.195 Test Acc: 0.553
Validation loss decreased (-0.499988 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 1.94050931930542
Epoch: 7, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.148 Vali Acc: 0.592 Test Loss: 1.148 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 1.8259501457214355
Epoch: 8, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.098 Vali Acc: 0.638 Test Loss: 1.098 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 2.0133562088012695
Epoch: 9, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.042 Vali Acc: 0.664 Test Loss: 1.042 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664463).  Saving model ...
Epoch: 10 cost time: 1.9100706577301025
Epoch: 10, Steps: 10 | Train Loss: 0.989 Vali Loss: 0.986 Vali Acc: 0.671 Test Loss: 0.986 Test Acc: 0.671
Validation loss decreased (-0.664463 --> -0.671043).  Saving model ...
Epoch: 11 cost time: 1.6422183513641357
Epoch: 11, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.930 Vali Acc: 0.697 Test Loss: 0.930 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697359).  Saving model ...
Epoch: 12 cost time: 1.9341745376586914
Epoch: 12, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.872 Vali Acc: 0.724 Test Loss: 0.872 Test Acc: 0.724
Validation loss decreased (-0.697359 --> -0.723675).  Saving model ...
Epoch: 13 cost time: 1.6272094249725342
Epoch: 13, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.810 Vali Acc: 0.757 Test Loss: 0.810 Test Acc: 0.757
Validation loss decreased (-0.723675 --> -0.756571).  Saving model ...
Epoch: 14 cost time: 1.9989559650421143
Epoch: 14, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.749 Vali Acc: 0.730 Test Loss: 0.749 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8965673446655273
Epoch: 15, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.694 Vali Acc: 0.743 Test Loss: 0.694 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1731479167938232
Epoch: 16, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.649 Vali Acc: 0.730 Test Loss: 0.649 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0413756370544434
Epoch: 17, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9451510906219482
Epoch: 18, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.567 Vali Acc: 0.737 Test Loss: 0.567 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0770559310913086
Epoch: 19, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756574).  Saving model ...
Epoch: 20 cost time: 1.8932733535766602
Epoch: 20, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.502 Vali Acc: 0.770 Test Loss: 0.502 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769732).  Saving model ...
Epoch: 21 cost time: 2.1060643196105957
Epoch: 21, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.477 Vali Acc: 0.776 Test Loss: 0.477 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 22 cost time: 1.9608135223388672
Epoch: 22, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.472 Vali Acc: 0.770 Test Loss: 0.472 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8132164478302002
Epoch: 23, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.455 Vali Acc: 0.783 Test Loss: 0.455 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 24 cost time: 2.0693042278289795
Epoch: 24, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.421 Vali Acc: 0.803 Test Loss: 0.421 Test Acc: 0.803
Validation loss decreased (-0.782890 --> -0.802627).  Saving model ...
Epoch: 25 cost time: 1.6413190364837646
Epoch: 25, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.427 Vali Acc: 0.809 Test Loss: 0.427 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 26 cost time: 1.847032070159912
Epoch: 26, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.390 Vali Acc: 0.796 Test Loss: 0.390 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8020062446594238
Epoch: 27, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.404 Vali Acc: 0.816 Test Loss: 0.404 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 28 cost time: 1.4958469867706299
Epoch: 28, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.413 Vali Acc: 0.809 Test Loss: 0.413 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7987353801727295
Epoch: 29, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 30 cost time: 1.7375836372375488
Epoch: 30, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.405 Vali Acc: 0.803 Test Loss: 0.405 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 174724
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3836402893066406
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.437 Vali Acc: 0.178 Test Loss: 1.437 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 1.9999845027923584
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.420 Vali Acc: 0.217 Test Loss: 1.420 Test Acc: 0.217
Validation loss decreased (-0.177617 --> -0.217091).  Saving model ...
Epoch: 3 cost time: 1.6879668235778809
Epoch: 3, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
Validation loss decreased (-0.217091 --> -0.243407).  Saving model ...
Epoch: 4 cost time: 1.9077951908111572
Epoch: 4, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.370 Vali Acc: 0.296 Test Loss: 1.370 Test Acc: 0.296
Validation loss decreased (-0.243407 --> -0.296039).  Saving model ...
Epoch: 5 cost time: 1.6495692729949951
Epoch: 5, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.339 Vali Acc: 0.342 Test Loss: 1.339 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 6 cost time: 1.4504094123840332
Epoch: 6, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.309 Vali Acc: 0.382 Test Loss: 1.309 Test Acc: 0.382
Validation loss decreased (-0.342092 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 1.72709321975708
Epoch: 7, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.273 Vali Acc: 0.428 Test Loss: 1.273 Test Acc: 0.428
Validation loss decreased (-0.381566 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 1.4790213108062744
Epoch: 8, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.427619 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.7717232704162598
Epoch: 9, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.198 Vali Acc: 0.526 Test Loss: 1.198 Test Acc: 0.526
Validation loss decreased (-0.499988 --> -0.526304).  Saving model ...
Epoch: 10 cost time: 1.5673694610595703
Epoch: 10, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.157 Vali Acc: 0.605 Test Loss: 1.157 Test Acc: 0.605
Validation loss decreased (-0.526304 --> -0.605252).  Saving model ...
Epoch: 11 cost time: 1.4106850624084473
Epoch: 11, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
Validation loss decreased (-0.605252 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 1.8637375831604004
Epoch: 12, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.065 Vali Acc: 0.625 Test Loss: 1.065 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.4410104751586914
Epoch: 13, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.017 Vali Acc: 0.638 Test Loss: 1.017 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638148).  Saving model ...
Epoch: 14 cost time: 1.8492791652679443
Epoch: 14, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.975 Vali Acc: 0.651 Test Loss: 0.975 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 15 cost time: 1.4723384380340576
Epoch: 15, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.917 Vali Acc: 0.664 Test Loss: 0.917 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664465).  Saving model ...
Epoch: 16 cost time: 2.2762012481689453
Epoch: 16, Steps: 10 | Train Loss: 0.791 Vali Loss: 0.865 Vali Acc: 0.684 Test Loss: 0.865 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 2.1447107791900635
Epoch: 17, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.810 Vali Acc: 0.717 Test Loss: 0.810 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717097).  Saving model ...
Epoch: 18 cost time: 2.2670159339904785
Epoch: 18, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 2.0581796169281006
Epoch: 19, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.709 Vali Acc: 0.757 Test Loss: 0.709 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 1.858389139175415
Epoch: 20, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.120396614074707
Epoch: 21, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 1.7973477840423584
Epoch: 22, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 2.246391534805298
Epoch: 23, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.9141128063201904
Epoch: 24, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815785).  Saving model ...
Epoch: 25 cost time: 2.0259125232696533
Epoch: 25, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.453 Vali Acc: 0.868 Test Loss: 0.453 Test Acc: 0.868
Validation loss decreased (-0.815785 --> -0.868417).  Saving model ...
Epoch: 26 cost time: 1.954533576965332
Epoch: 26, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7807753086090088
Epoch: 27, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0199995040893555
Epoch: 28, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7345564365386963
Epoch: 29, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.150742292404175
Epoch: 30, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
Validation loss decreased (-0.868417 --> -0.874996).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.875
model parameter : 588612
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4449000358581543
Epoch: 1, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.355 Vali Acc: 0.342 Test Loss: 1.355 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.0249087810516357
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.338 Vali Acc: 0.362 Test Loss: 1.338 Test Acc: 0.362
Validation loss decreased (-0.342092 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.1798958778381348
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.317 Vali Acc: 0.401 Test Loss: 1.317 Test Acc: 0.401
Validation loss decreased (-0.361829 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.1018998622894287
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.288 Vali Acc: 0.441 Test Loss: 1.288 Test Acc: 0.441
Validation loss decreased (-0.401303 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 1.2150030136108398
Epoch: 5, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.255 Vali Acc: 0.467 Test Loss: 1.255 Test Acc: 0.467
Validation loss decreased (-0.440777 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.1462600231170654
Epoch: 6, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.222 Vali Acc: 0.507 Test Loss: 1.222 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.283135175704956
Epoch: 7, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.183 Vali Acc: 0.559 Test Loss: 1.183 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 1.4604911804199219
Epoch: 8, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.144 Vali Acc: 0.586 Test Loss: 1.144 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 1.4501228332519531
Epoch: 9, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.099 Vali Acc: 0.599 Test Loss: 1.099 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598673).  Saving model ...
Epoch: 10 cost time: 1.2562322616577148
Epoch: 10, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.055 Vali Acc: 0.632 Test Loss: 1.055 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631568).  Saving model ...
Epoch: 11 cost time: 1.0092308521270752
Epoch: 11, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.007 Vali Acc: 0.678 Test Loss: 1.007 Test Acc: 0.678
Validation loss decreased (-0.631568 --> -0.677622).  Saving model ...
Epoch: 12 cost time: 0.8738434314727783
Epoch: 12, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.955 Vali Acc: 0.697 Test Loss: 0.955 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697359).  Saving model ...
Epoch: 13 cost time: 0.937546968460083
Epoch: 13, Steps: 10 | Train Loss: 0.882 Vali Loss: 0.903 Vali Acc: 0.717 Test Loss: 0.903 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717096).  Saving model ...
Epoch: 14 cost time: 0.7687771320343018
Epoch: 14, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.845 Vali Acc: 0.730 Test Loss: 0.845 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 0.8701672554016113
Epoch: 15, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.792 Vali Acc: 0.743 Test Loss: 0.792 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 16 cost time: 1.1298019886016846
Epoch: 16, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.746 Vali Acc: 0.770 Test Loss: 0.746 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769729).  Saving model ...
Epoch: 17 cost time: 1.2377026081085205
Epoch: 17, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.702 Vali Acc: 0.757 Test Loss: 0.702 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3228700160980225
Epoch: 18, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.664 Vali Acc: 0.757 Test Loss: 0.664 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2221612930297852
Epoch: 19, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.626 Vali Acc: 0.757 Test Loss: 0.626 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1698825359344482
Epoch: 20, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4335179328918457
Epoch: 21, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
Validation loss decreased (-0.769729 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.074075698852539
Epoch: 22, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.2404494285583496
Epoch: 23, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2774484157562256
Epoch: 24, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 25 cost time: 1.076202154159546
Epoch: 25, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.491 Vali Acc: 0.776 Test Loss: 0.491 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3446142673492432
Epoch: 26, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 1.086968183517456
Epoch: 27, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 28 cost time: 1.3119854927062988
Epoch: 28, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 29 cost time: 1.485262393951416
Epoch: 29, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.436 Vali Acc: 0.809 Test Loss: 0.436 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.217552661895752
Epoch: 30, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.428 Vali Acc: 0.816 Test Loss: 0.428 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 174724
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.560471057891846
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.387 Vali Acc: 0.309 Test Loss: 1.387 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.7482352256774902
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.363 Vali Acc: 0.349 Test Loss: 1.363 Test Acc: 0.349
Validation loss decreased (-0.309197 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 3.29771089553833
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.329 Vali Acc: 0.408 Test Loss: 1.329 Test Acc: 0.408
Validation loss decreased (-0.348671 --> -0.407881).  Saving model ...
Epoch: 4 cost time: 3.2229409217834473
Epoch: 4, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.293 Vali Acc: 0.421 Test Loss: 1.293 Test Acc: 0.421
Validation loss decreased (-0.407881 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 3.057701587677002
Epoch: 5, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
Validation loss decreased (-0.421040 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.751208782196045
Epoch: 6, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.208 Vali Acc: 0.520 Test Loss: 1.208 Test Acc: 0.520
Validation loss decreased (-0.467093 --> -0.519725).  Saving model ...
Epoch: 7 cost time: 2.679229974746704
Epoch: 7, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.160 Vali Acc: 0.566 Test Loss: 1.160 Test Acc: 0.566
Validation loss decreased (-0.519725 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 2.5794677734375
Epoch: 8, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.107 Vali Acc: 0.586 Test Loss: 1.107 Test Acc: 0.586
Validation loss decreased (-0.565778 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 2.6799497604370117
Epoch: 9, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.049 Vali Acc: 0.645 Test Loss: 1.049 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 10 cost time: 2.4414467811584473
Epoch: 10, Steps: 10 | Train Loss: 0.970 Vali Loss: 0.987 Vali Acc: 0.697 Test Loss: 0.987 Test Acc: 0.697
Validation loss decreased (-0.644726 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 2.055356502532959
Epoch: 11, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.913 Vali Acc: 0.724 Test Loss: 0.913 Test Acc: 0.724
Validation loss decreased (-0.697359 --> -0.723675).  Saving model ...
Epoch: 12 cost time: 2.2433037757873535
Epoch: 12, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.838 Vali Acc: 0.809 Test Loss: 0.838 Test Acc: 0.809
Validation loss decreased (-0.723675 --> -0.809202).  Saving model ...
Epoch: 13 cost time: 1.6835157871246338
Epoch: 13, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.769 Vali Acc: 0.809 Test Loss: 0.769 Test Acc: 0.809
Validation loss decreased (-0.809202 --> -0.809203).  Saving model ...
Epoch: 14 cost time: 1.9512135982513428
Epoch: 14, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4923391342163086
Epoch: 15, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809204).  Saving model ...
Epoch: 16 cost time: 2.3436455726623535
Epoch: 16, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 3.5125060081481934
Epoch: 17, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 18 cost time: 3.556579351425171
Epoch: 18, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 19 cost time: 3.474306583404541
Epoch: 19, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828943).  Saving model ...
Epoch: 20 cost time: 3.225769519805908
Epoch: 20, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0333826541900635
Epoch: 21, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9776883125305176
Epoch: 22, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.436 Vali Acc: 0.809 Test Loss: 0.436 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.218477964401245
Epoch: 23, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.408 Vali Acc: 0.849 Test Loss: 0.408 Test Acc: 0.849
Validation loss decreased (-0.828943 --> -0.848680).  Saving model ...
Epoch: 24 cost time: 3.0885698795318604
Epoch: 24, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.400 Vali Acc: 0.809 Test Loss: 0.400 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.107024908065796
Epoch: 25, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.396 Vali Acc: 0.809 Test Loss: 0.396 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1763079166412354
Epoch: 26, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.449 Vali Acc: 0.803 Test Loss: 0.449 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.845350503921509
Epoch: 27, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.389 Vali Acc: 0.842 Test Loss: 0.389 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.144359827041626
Epoch: 28, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.447 Vali Acc: 0.783 Test Loss: 0.447 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3372995853424072
Epoch: 29, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.378 Vali Acc: 0.842 Test Loss: 0.378 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.2048518657684326
Epoch: 30, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 295556
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7377870082855225
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.448 Vali Acc: 0.263 Test Loss: 1.448 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 1.5612199306488037
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.426 Vali Acc: 0.303 Test Loss: 1.426 Test Acc: 0.303
Validation loss decreased (-0.263143 --> -0.302617).  Saving model ...
Epoch: 3 cost time: 1.507648229598999
Epoch: 3, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.395 Vali Acc: 0.329 Test Loss: 1.395 Test Acc: 0.329
Validation loss decreased (-0.302617 --> -0.328933).  Saving model ...
Epoch: 4 cost time: 1.9637200832366943
Epoch: 4, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
Validation loss decreased (-0.328933 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.3419928550720215
Epoch: 5, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.322 Vali Acc: 0.408 Test Loss: 1.322 Test Acc: 0.408
Validation loss decreased (-0.374986 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 1.5372838973999023
Epoch: 6, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.284 Vali Acc: 0.467 Test Loss: 1.284 Test Acc: 0.467
Validation loss decreased (-0.407882 --> -0.467092).  Saving model ...
Epoch: 7 cost time: 2.215907335281372
Epoch: 7, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.246 Vali Acc: 0.493 Test Loss: 1.246 Test Acc: 0.493
Validation loss decreased (-0.467092 --> -0.493409).  Saving model ...
Epoch: 8 cost time: 2.199808359146118
Epoch: 8, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.203 Vali Acc: 0.526 Test Loss: 1.203 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 9 cost time: 1.8301582336425781
Epoch: 9, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.158 Vali Acc: 0.553 Test Loss: 1.158 Test Acc: 0.553
Validation loss decreased (-0.526304 --> -0.552620).  Saving model ...
Epoch: 10 cost time: 1.3147523403167725
Epoch: 10, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.114 Vali Acc: 0.605 Test Loss: 1.114 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605252).  Saving model ...
Epoch: 11 cost time: 1.3903133869171143
Epoch: 11, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.068 Vali Acc: 0.605 Test Loss: 1.068 Test Acc: 0.605
Validation loss decreased (-0.605252 --> -0.605252).  Saving model ...
Epoch: 12 cost time: 1.2783808708190918
Epoch: 12, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.020 Vali Acc: 0.618 Test Loss: 1.020 Test Acc: 0.618
Validation loss decreased (-0.605252 --> -0.618411).  Saving model ...
Epoch: 13 cost time: 1.3243861198425293
Epoch: 13, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.965 Vali Acc: 0.645 Test Loss: 0.965 Test Acc: 0.645
Validation loss decreased (-0.618411 --> -0.644727).  Saving model ...
Epoch: 14 cost time: 2.078380584716797
Epoch: 14, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.915 Vali Acc: 0.684 Test Loss: 0.915 Test Acc: 0.684
Validation loss decreased (-0.644727 --> -0.684201).  Saving model ...
Epoch: 15 cost time: 1.9697587490081787
Epoch: 15, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.859 Vali Acc: 0.697 Test Loss: 0.859 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 16 cost time: 2.056551456451416
Epoch: 16, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.805 Vali Acc: 0.711 Test Loss: 0.805 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710518).  Saving model ...
Epoch: 17 cost time: 2.2330658435821533
Epoch: 17, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.750 Vali Acc: 0.737 Test Loss: 0.750 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 18 cost time: 1.9973232746124268
Epoch: 18, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9490370750427246
Epoch: 19, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.657 Vali Acc: 0.743 Test Loss: 0.657 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 20 cost time: 1.8218939304351807
Epoch: 20, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.618 Vali Acc: 0.750 Test Loss: 0.618 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 21 cost time: 1.7521181106567383
Epoch: 21, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 22 cost time: 1.74776029586792
Epoch: 22, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 23 cost time: 1.968914270401001
Epoch: 23, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.991683006286621
Epoch: 24, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.506 Vali Acc: 0.816 Test Loss: 0.506 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 25 cost time: 2.0069503784179688
Epoch: 25, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.479 Vali Acc: 0.789 Test Loss: 0.479 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.949514389038086
Epoch: 26, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815785).  Saving model ...
Epoch: 27 cost time: 1.7167770862579346
Epoch: 27, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.444 Vali Acc: 0.816 Test Loss: 0.444 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 28 cost time: 1.7196874618530273
Epoch: 28, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.439 Vali Acc: 0.796 Test Loss: 0.439 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7056198120117188
Epoch: 29, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.433 Vali Acc: 0.796 Test Loss: 0.433 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7729480266571045
Epoch: 30, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.416 Vali Acc: 0.816 Test Loss: 0.416 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 88580
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9269816875457764
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.385 Vali Acc: 0.303 Test Loss: 1.385 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.8403453826904297
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.362 Vali Acc: 0.342 Test Loss: 1.362 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.7631094455718994
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.331 Vali Acc: 0.395 Test Loss: 1.331 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.599184274673462
Epoch: 4, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.298 Vali Acc: 0.388 Test Loss: 1.298 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6824076175689697
Epoch: 5, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.262 Vali Acc: 0.461 Test Loss: 1.262 Test Acc: 0.461
Validation loss decreased (-0.394724 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 1.1459126472473145
Epoch: 6, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.220 Vali Acc: 0.507 Test Loss: 1.220 Test Acc: 0.507
Validation loss decreased (-0.460514 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.6160643100738525
Epoch: 7, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.178 Vali Acc: 0.539 Test Loss: 1.178 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 1.7563633918762207
Epoch: 8, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.133 Vali Acc: 0.586 Test Loss: 1.133 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 1.6668376922607422
Epoch: 9, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.084 Vali Acc: 0.625 Test Loss: 1.084 Test Acc: 0.625
Validation loss decreased (-0.585515 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.2592346668243408
Epoch: 10, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.032 Vali Acc: 0.671 Test Loss: 1.032 Test Acc: 0.671
Validation loss decreased (-0.624989 --> -0.671042).  Saving model ...
Epoch: 11 cost time: 2.205772638320923
Epoch: 11, Steps: 10 | Train Loss: 0.964 Vali Loss: 0.974 Vali Acc: 0.704 Test Loss: 0.974 Test Acc: 0.704
Validation loss decreased (-0.671042 --> -0.703938).  Saving model ...
Epoch: 12 cost time: 1.6019132137298584
Epoch: 12, Steps: 10 | Train Loss: 0.887 Vali Loss: 0.916 Vali Acc: 0.743 Test Loss: 0.916 Test Acc: 0.743
Validation loss decreased (-0.703938 --> -0.743412).  Saving model ...
Epoch: 13 cost time: 1.7158472537994385
Epoch: 13, Steps: 10 | Train Loss: 0.834 Vali Loss: 0.857 Vali Acc: 0.763 Test Loss: 0.857 Test Acc: 0.763
Validation loss decreased (-0.743412 --> -0.763149).  Saving model ...
Epoch: 14 cost time: 2.331594705581665
Epoch: 14, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.801 Vali Acc: 0.770 Test Loss: 0.801 Test Acc: 0.770
Validation loss decreased (-0.763149 --> -0.769729).  Saving model ...
Epoch: 15 cost time: 1.9849228858947754
Epoch: 15, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.742 Vali Acc: 0.776 Test Loss: 0.742 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776308).  Saving model ...
Epoch: 16 cost time: 2.5014381408691406
Epoch: 16, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
Validation loss decreased (-0.776308 --> -0.809204).  Saving model ...
Epoch: 17 cost time: 1.9473354816436768
Epoch: 17, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.623 Vali Acc: 0.809 Test Loss: 0.623 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 1.8529343605041504
Epoch: 18, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 2.4281532764434814
Epoch: 19, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.540 Vali Acc: 0.836 Test Loss: 0.540 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 20 cost time: 2.00445556640625
Epoch: 20, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4582443237304688
Epoch: 21, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.480 Vali Acc: 0.842 Test Loss: 0.480 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842100).  Saving model ...
Epoch: 22 cost time: 1.941056489944458
Epoch: 22, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.448 Vali Acc: 0.842 Test Loss: 0.448 Test Acc: 0.842
Validation loss decreased (-0.842100 --> -0.842101).  Saving model ...
Epoch: 23 cost time: 2.4405465126037598
Epoch: 23, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.428 Vali Acc: 0.849 Test Loss: 0.428 Test Acc: 0.849
Validation loss decreased (-0.842101 --> -0.848680).  Saving model ...
Epoch: 24 cost time: 2.7186365127563477
Epoch: 24, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.407 Vali Acc: 0.849 Test Loss: 0.407 Test Acc: 0.849
Validation loss decreased (-0.848680 --> -0.848680).  Saving model ...
Epoch: 25 cost time: 2.2995707988739014
Epoch: 25, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.408 Vali Acc: 0.855 Test Loss: 0.408 Test Acc: 0.855
Validation loss decreased (-0.848680 --> -0.855259).  Saving model ...
Epoch: 26 cost time: 2.764827013015747
Epoch: 26, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.417 Vali Acc: 0.836 Test Loss: 0.417 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9040851593017578
Epoch: 27, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2842068672180176
Epoch: 28, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.411 Vali Acc: 0.849 Test Loss: 0.411 Test Acc: 0.849
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3169806003570557
Epoch: 29, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.390 Vali Acc: 0.842 Test Loss: 0.390 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.12911057472229
Epoch: 30, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.380 Vali Acc: 0.862 Test Loss: 0.380 Test Acc: 0.862
Validation loss decreased (-0.855259 --> -0.861838).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8618421052631579
model parameter : 295556
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6789824962615967
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.03334379196167
Epoch: 2, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.423 Vali Acc: 0.316 Test Loss: 1.423 Test Acc: 0.316
Validation loss decreased (-0.249986 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 1.3883085250854492
Epoch: 3, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.394 Vali Acc: 0.329 Test Loss: 1.394 Test Acc: 0.329
Validation loss decreased (-0.315775 --> -0.328933).  Saving model ...
Epoch: 4 cost time: 1.0090746879577637
Epoch: 4, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.359 Vali Acc: 0.388 Test Loss: 1.359 Test Acc: 0.388
Validation loss decreased (-0.328933 --> -0.388144).  Saving model ...
Epoch: 5 cost time: 1.2624144554138184
Epoch: 5, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.324 Vali Acc: 0.421 Test Loss: 1.324 Test Acc: 0.421
Validation loss decreased (-0.388144 --> -0.421039).  Saving model ...
Epoch: 6 cost time: 1.6190924644470215
Epoch: 6, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.287 Vali Acc: 0.461 Test Loss: 1.287 Test Acc: 0.461
Validation loss decreased (-0.421039 --> -0.460513).  Saving model ...
Epoch: 7 cost time: 1.755464792251587
Epoch: 7, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.251 Vali Acc: 0.487 Test Loss: 1.251 Test Acc: 0.487
Validation loss decreased (-0.460513 --> -0.486830).  Saving model ...
Epoch: 8 cost time: 1.8317046165466309
Epoch: 8, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.211 Vali Acc: 0.520 Test Loss: 1.211 Test Acc: 0.520
Validation loss decreased (-0.486830 --> -0.519725).  Saving model ...
Epoch: 9 cost time: 1.6135163307189941
Epoch: 9, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.168 Vali Acc: 0.553 Test Loss: 1.168 Test Acc: 0.553
Validation loss decreased (-0.519725 --> -0.552620).  Saving model ...
Epoch: 10 cost time: 1.511143684387207
Epoch: 10, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.127 Vali Acc: 0.586 Test Loss: 1.127 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585515).  Saving model ...
Epoch: 11 cost time: 1.0745129585266113
Epoch: 11, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.082 Vali Acc: 0.599 Test Loss: 1.082 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598673).  Saving model ...
Epoch: 12 cost time: 1.2631876468658447
Epoch: 12, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.037 Vali Acc: 0.618 Test Loss: 1.037 Test Acc: 0.618
Validation loss decreased (-0.598673 --> -0.618411).  Saving model ...
Epoch: 13 cost time: 1.1375901699066162
Epoch: 13, Steps: 10 | Train Loss: 0.901 Vali Loss: 0.986 Vali Acc: 0.638 Test Loss: 0.986 Test Acc: 0.638
Validation loss decreased (-0.618411 --> -0.638148).  Saving model ...
Epoch: 14 cost time: 1.1544337272644043
Epoch: 14, Steps: 10 | Train Loss: 0.855 Vali Loss: 0.941 Vali Acc: 0.645 Test Loss: 0.941 Test Acc: 0.645
Validation loss decreased (-0.638148 --> -0.644727).  Saving model ...
Epoch: 15 cost time: 1.3987560272216797
Epoch: 15, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.892 Vali Acc: 0.691 Test Loss: 0.892 Test Acc: 0.691
Validation loss decreased (-0.644727 --> -0.690781).  Saving model ...
Epoch: 16 cost time: 1.4889729022979736
Epoch: 16, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.849 Vali Acc: 0.691 Test Loss: 0.849 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690781).  Saving model ...
Epoch: 17 cost time: 1.7004897594451904
Epoch: 17, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.798 Vali Acc: 0.691 Test Loss: 0.798 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690781).  Saving model ...
Epoch: 18 cost time: 1.7351036071777344
Epoch: 18, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 19 cost time: 1.1937053203582764
Epoch: 19, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.712 Vali Acc: 0.730 Test Loss: 0.712 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 20 cost time: 1.315089464187622
Epoch: 20, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.672 Vali Acc: 0.743 Test Loss: 0.672 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 21 cost time: 1.509385347366333
Epoch: 21, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.640 Vali Acc: 0.743 Test Loss: 0.640 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 22 cost time: 1.7394697666168213
Epoch: 22, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 23 cost time: 1.5049777030944824
Epoch: 23, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.593 Vali Acc: 0.770 Test Loss: 0.593 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 1.531409740447998
Epoch: 24, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 25 cost time: 1.6607263088226318
Epoch: 25, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.530 Vali Acc: 0.757 Test Loss: 0.530 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.81656813621521
Epoch: 26, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 27 cost time: 2.0169198513031006
Epoch: 27, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8194665908813477
Epoch: 28, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.483 Vali Acc: 0.770 Test Loss: 0.483 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.610741138458252
Epoch: 29, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.467 Vali Acc: 0.776 Test Loss: 0.467 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4614791870117188
Epoch: 30, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.446 Vali Acc: 0.809 Test Loss: 0.446 Test Acc: 0.809
Validation loss decreased (-0.782890 --> -0.809206).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 88580
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2688326835632324
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.390 Vali Acc: 0.322 Test Loss: 1.390 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.7506213188171387
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.369 Vali Acc: 0.355 Test Loss: 1.369 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355249).  Saving model ...
Epoch: 3 cost time: 1.915808916091919
Epoch: 3, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.340 Vali Acc: 0.388 Test Loss: 1.340 Test Acc: 0.388
Validation loss decreased (-0.355249 --> -0.388144).  Saving model ...
Epoch: 4 cost time: 1.6383121013641357
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.310 Vali Acc: 0.408 Test Loss: 1.310 Test Acc: 0.408
Validation loss decreased (-0.388144 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 1.5955097675323486
Epoch: 5, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.277 Vali Acc: 0.447 Test Loss: 1.277 Test Acc: 0.447
Validation loss decreased (-0.407882 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 1.2219915390014648
Epoch: 6, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.237 Vali Acc: 0.474 Test Loss: 1.237 Test Acc: 0.474
Validation loss decreased (-0.447356 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 1.5636436939239502
Epoch: 7, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.198 Vali Acc: 0.539 Test Loss: 1.198 Test Acc: 0.539
Validation loss decreased (-0.473672 --> -0.539462).  Saving model ...
Epoch: 8 cost time: 1.2962467670440674
Epoch: 8, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.159 Vali Acc: 0.572 Test Loss: 1.159 Test Acc: 0.572
Validation loss decreased (-0.539462 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 1.131136417388916
Epoch: 9, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.116 Vali Acc: 0.632 Test Loss: 1.116 Test Acc: 0.632
Validation loss decreased (-0.572357 --> -0.631568).  Saving model ...
Epoch: 10 cost time: 1.1435322761535645
Epoch: 10, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.074 Vali Acc: 0.664 Test Loss: 1.074 Test Acc: 0.664
Validation loss decreased (-0.631568 --> -0.664463).  Saving model ...
Epoch: 11 cost time: 1.3697991371154785
Epoch: 11, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.030 Vali Acc: 0.697 Test Loss: 1.030 Test Acc: 0.697
Validation loss decreased (-0.664463 --> -0.697358).  Saving model ...
Epoch: 12 cost time: 1.3794772624969482
Epoch: 12, Steps: 10 | Train Loss: 0.955 Vali Loss: 0.983 Vali Acc: 0.724 Test Loss: 0.983 Test Acc: 0.724
Validation loss decreased (-0.697358 --> -0.723674).  Saving model ...
Epoch: 13 cost time: 1.719085693359375
Epoch: 13, Steps: 10 | Train Loss: 0.899 Vali Loss: 0.937 Vali Acc: 0.757 Test Loss: 0.937 Test Acc: 0.757
Validation loss decreased (-0.723674 --> -0.756570).  Saving model ...
Epoch: 14 cost time: 1.6885950565338135
Epoch: 14, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.889 Vali Acc: 0.783 Test Loss: 0.889 Test Acc: 0.783
Validation loss decreased (-0.756570 --> -0.782886).  Saving model ...
Epoch: 15 cost time: 1.5516979694366455
Epoch: 15, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.840 Vali Acc: 0.789 Test Loss: 0.840 Test Acc: 0.789
Validation loss decreased (-0.782886 --> -0.789465).  Saving model ...
Epoch: 16 cost time: 1.0273189544677734
Epoch: 16, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.788 Vali Acc: 0.822 Test Loss: 0.788 Test Acc: 0.822
Validation loss decreased (-0.789465 --> -0.822361).  Saving model ...
Epoch: 17 cost time: 1.6265230178833008
Epoch: 17, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.745 Vali Acc: 0.809 Test Loss: 0.745 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4117491245269775
Epoch: 18, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6365365982055664
Epoch: 19, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.228670597076416
Epoch: 20, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.636 Vali Acc: 0.789 Test Loss: 0.636 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8331341743469238
Epoch: 21, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.568 Vali Acc: 0.849 Test Loss: 0.568 Test Acc: 0.849
Validation loss decreased (-0.822361 --> -0.848679).  Saving model ...
Epoch: 22 cost time: 1.9116358757019043
Epoch: 22, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.514 Vali Acc: 0.868 Test Loss: 0.514 Test Acc: 0.868
Validation loss decreased (-0.848679 --> -0.868416).  Saving model ...
Epoch: 23 cost time: 1.471062421798706
Epoch: 23, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.784574270248413
Epoch: 24, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3986680507659912
Epoch: 25, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.549 Vali Acc: 0.730 Test Loss: 0.549 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7665765285491943
Epoch: 26, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.479 Vali Acc: 0.822 Test Loss: 0.479 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.554638385772705
Epoch: 27, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6266539096832275
Epoch: 28, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.420 Vali Acc: 0.849 Test Loss: 0.420 Test Acc: 0.849
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5349702835083008
Epoch: 29, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3744866847991943
Epoch: 30, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.395 Vali Acc: 0.849 Test Loss: 0.395 Test Acc: 0.849
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 295556
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.383234977722168
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.439 Vali Acc: 0.243 Test Loss: 1.439 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.274667501449585
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.418 Vali Acc: 0.283 Test Loss: 1.418 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.3972210884094238
Epoch: 3, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.390 Vali Acc: 0.296 Test Loss: 1.390 Test Acc: 0.296
Validation loss decreased (-0.282881 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 1.0401263236999512
Epoch: 4, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.355 Vali Acc: 0.355 Test Loss: 1.355 Test Acc: 0.355
Validation loss decreased (-0.296039 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 1.3877928256988525
Epoch: 5, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.320 Vali Acc: 0.434 Test Loss: 1.320 Test Acc: 0.434
Validation loss decreased (-0.355250 --> -0.434197).  Saving model ...
Epoch: 6 cost time: 1.1599154472351074
Epoch: 6, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.286 Vali Acc: 0.441 Test Loss: 1.286 Test Acc: 0.441
Validation loss decreased (-0.434197 --> -0.440777).  Saving model ...
Epoch: 7 cost time: 1.3959050178527832
Epoch: 7, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.253 Vali Acc: 0.493 Test Loss: 1.253 Test Acc: 0.493
Validation loss decreased (-0.440777 --> -0.493409).  Saving model ...
Epoch: 8 cost time: 1.2705717086791992
Epoch: 8, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.215 Vali Acc: 0.533 Test Loss: 1.215 Test Acc: 0.533
Validation loss decreased (-0.493409 --> -0.532883).  Saving model ...
Epoch: 9 cost time: 1.4826116561889648
Epoch: 9, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.176 Vali Acc: 0.559 Test Loss: 1.176 Test Acc: 0.559
Validation loss decreased (-0.532883 --> -0.559199).  Saving model ...
Epoch: 10 cost time: 1.513718605041504
Epoch: 10, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.136 Vali Acc: 0.572 Test Loss: 1.136 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 11 cost time: 1.4402806758880615
Epoch: 11, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.095 Vali Acc: 0.586 Test Loss: 1.095 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 12 cost time: 1.404862642288208
Epoch: 12, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.056 Vali Acc: 0.599 Test Loss: 1.056 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 13 cost time: 1.393038272857666
Epoch: 13, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 1.2905051708221436
Epoch: 14, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 0.859856128692627
Epoch: 15, Steps: 10 | Train Loss: 0.856 Vali Loss: 0.937 Vali Acc: 0.645 Test Loss: 0.937 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644727).  Saving model ...
Epoch: 16 cost time: 0.9328529834747314
Epoch: 16, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.891 Vali Acc: 0.658 Test Loss: 0.891 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657886).  Saving model ...
Epoch: 17 cost time: 0.9048950672149658
Epoch: 17, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.847 Vali Acc: 0.664 Test Loss: 0.847 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664465).  Saving model ...
Epoch: 18 cost time: 0.9422638416290283
Epoch: 18, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.805 Vali Acc: 0.684 Test Loss: 0.805 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684202).  Saving model ...
Epoch: 19 cost time: 0.9070909023284912
Epoch: 19, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.770 Vali Acc: 0.678 Test Loss: 0.770 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1234056949615479
Epoch: 20, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.734 Vali Acc: 0.678 Test Loss: 0.734 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1323158740997314
Epoch: 21, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.705 Vali Acc: 0.684 Test Loss: 0.705 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 22 cost time: 1.324920415878296
Epoch: 22, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.677 Vali Acc: 0.704 Test Loss: 0.677 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703941).  Saving model ...
Epoch: 23 cost time: 1.0653526782989502
Epoch: 23, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.652 Vali Acc: 0.704 Test Loss: 0.652 Test Acc: 0.704
Validation loss decreased (-0.703941 --> -0.703941).  Saving model ...
Epoch: 24 cost time: 1.2239859104156494
Epoch: 24, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.631 Vali Acc: 0.711 Test Loss: 0.631 Test Acc: 0.711
Validation loss decreased (-0.703941 --> -0.710520).  Saving model ...
Epoch: 25 cost time: 1.0653507709503174
Epoch: 25, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.710520 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 0.9794316291809082
Epoch: 26, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 27 cost time: 0.81679368019104
Epoch: 27, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736837).  Saving model ...
Epoch: 28 cost time: 0.8432886600494385
Epoch: 28, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.736837 --> -0.736837).  Saving model ...
Epoch: 29 cost time: 0.9868133068084717
Epoch: 29, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.521 Vali Acc: 0.750 Test Loss: 0.521 Test Acc: 0.750
Validation loss decreased (-0.736837 --> -0.749995).  Saving model ...
Epoch: 30 cost time: 1.1218607425689697
Epoch: 30, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.503 Vali Acc: 0.757 Test Loss: 0.503 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756574).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 88580
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.503051519393921
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.410 Vali Acc: 0.283 Test Loss: 1.410 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.3011393547058105
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.381 Vali Acc: 0.276 Test Loss: 1.381 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5453433990478516
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.347 Vali Acc: 0.289 Test Loss: 1.347 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 1.6012523174285889
Epoch: 4, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.312 Vali Acc: 0.336 Test Loss: 1.312 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 1.1735930442810059
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.278 Vali Acc: 0.362 Test Loss: 1.278 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 1.5334651470184326
Epoch: 6, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.245 Vali Acc: 0.368 Test Loss: 1.245 Test Acc: 0.368
Validation loss decreased (-0.361829 --> -0.368409).  Saving model ...
Epoch: 7 cost time: 1.610013484954834
Epoch: 7, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.210 Vali Acc: 0.428 Test Loss: 1.210 Test Acc: 0.428
Validation loss decreased (-0.368409 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 1.4849989414215088
Epoch: 8, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.427619 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.357919454574585
Epoch: 9, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
Validation loss decreased (-0.499988 --> -0.532883).  Saving model ...
Epoch: 10 cost time: 1.2440855503082275
Epoch: 10, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.080 Vali Acc: 0.592 Test Loss: 1.080 Test Acc: 0.592
Validation loss decreased (-0.532883 --> -0.592094).  Saving model ...
Epoch: 11 cost time: 1.2141284942626953
Epoch: 11, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.025 Vali Acc: 0.678 Test Loss: 1.025 Test Acc: 0.678
Validation loss decreased (-0.592094 --> -0.677621).  Saving model ...
Epoch: 12 cost time: 1.1028327941894531
Epoch: 12, Steps: 10 | Train Loss: 0.940 Vali Loss: 0.964 Vali Acc: 0.711 Test Loss: 0.964 Test Acc: 0.711
Validation loss decreased (-0.677621 --> -0.710517).  Saving model ...
Epoch: 13 cost time: 1.0267579555511475
Epoch: 13, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.904 Vali Acc: 0.743 Test Loss: 0.904 Test Acc: 0.743
Validation loss decreased (-0.710517 --> -0.743412).  Saving model ...
Epoch: 14 cost time: 1.2464385032653809
Epoch: 14, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.842 Vali Acc: 0.757 Test Loss: 0.842 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756571).  Saving model ...
Epoch: 15 cost time: 1.5632047653198242
Epoch: 15, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782887).  Saving model ...
Epoch: 16 cost time: 1.6124002933502197
Epoch: 16, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.713 Vali Acc: 0.803 Test Loss: 0.713 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802624).  Saving model ...
Epoch: 17 cost time: 1.85782790184021
Epoch: 17, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
Validation loss decreased (-0.802624 --> -0.802625).  Saving model ...
Epoch: 18 cost time: 1.7714669704437256
Epoch: 18, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.5255253314971924
Epoch: 19, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.6593892574310303
Epoch: 20, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.5674102306365967
Epoch: 21, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
Validation loss decreased (-0.815784 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 1.6614785194396973
Epoch: 22, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828942).  Saving model ...
Epoch: 23 cost time: 1.9250717163085938
Epoch: 23, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6389491558074951
Epoch: 24, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.458 Vali Acc: 0.816 Test Loss: 0.458 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7249996662139893
Epoch: 25, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.468 Vali Acc: 0.822 Test Loss: 0.468 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7500970363616943
Epoch: 26, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.456 Vali Acc: 0.829 Test Loss: 0.456 Test Acc: 0.829
Validation loss decreased (-0.828942 --> -0.828943).  Saving model ...
Epoch: 27 cost time: 1.8023149967193604
Epoch: 27, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.431 Vali Acc: 0.849 Test Loss: 0.431 Test Acc: 0.849
Validation loss decreased (-0.828943 --> -0.848680).  Saving model ...
Epoch: 28 cost time: 1.6654558181762695
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5578885078430176
Epoch: 29, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.444 Vali Acc: 0.829 Test Loss: 0.444 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5982928276062012
Epoch: 30, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.467 Vali Acc: 0.822 Test Loss: 0.467 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 587748
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.604956865310669
Epoch: 1, Steps: 10 | Train Loss: 1.553 Vali Loss: 1.486 Vali Acc: 0.178 Test Loss: 1.486 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 1.5401222705841064
Epoch: 2, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.466 Vali Acc: 0.191 Test Loss: 1.466 Test Acc: 0.191
Validation loss decreased (-0.177617 --> -0.190775).  Saving model ...
Epoch: 3 cost time: 1.3723833560943604
Epoch: 3, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.439 Vali Acc: 0.230 Test Loss: 1.439 Test Acc: 0.230
Validation loss decreased (-0.190775 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 1.4108917713165283
Epoch: 4, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (-0.230249 --> -0.269723).  Saving model ...
Epoch: 5 cost time: 1.6133649349212646
Epoch: 5, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.373 Vali Acc: 0.309 Test Loss: 1.373 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 6 cost time: 1.3380229473114014
Epoch: 6, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.338 Vali Acc: 0.329 Test Loss: 1.338 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 7 cost time: 1.3628649711608887
Epoch: 7, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.303 Vali Acc: 0.355 Test Loss: 1.303 Test Acc: 0.355
Validation loss decreased (-0.328934 --> -0.355250).  Saving model ...
Epoch: 8 cost time: 1.502119779586792
Epoch: 8, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.263 Vali Acc: 0.401 Test Loss: 1.263 Test Acc: 0.401
Validation loss decreased (-0.355250 --> -0.401303).  Saving model ...
Epoch: 9 cost time: 1.3795225620269775
Epoch: 9, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.221 Vali Acc: 0.441 Test Loss: 1.221 Test Acc: 0.441
Validation loss decreased (-0.401303 --> -0.440777).  Saving model ...
Epoch: 10 cost time: 1.2755281925201416
Epoch: 10, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.172 Vali Acc: 0.487 Test Loss: 1.172 Test Acc: 0.487
Validation loss decreased (-0.440777 --> -0.486830).  Saving model ...
Epoch: 11 cost time: 1.320615530014038
Epoch: 11, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.124 Vali Acc: 0.559 Test Loss: 1.124 Test Acc: 0.559
Validation loss decreased (-0.486830 --> -0.559199).  Saving model ...
Epoch: 12 cost time: 1.483781337738037
Epoch: 12, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.073 Vali Acc: 0.586 Test Loss: 1.073 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585516).  Saving model ...
Epoch: 13 cost time: 1.3091175556182861
Epoch: 13, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.021 Vali Acc: 0.599 Test Loss: 1.021 Test Acc: 0.599
Validation loss decreased (-0.585516 --> -0.598674).  Saving model ...
Epoch: 14 cost time: 1.4002516269683838
Epoch: 14, Steps: 10 | Train Loss: 0.971 Vali Loss: 0.964 Vali Acc: 0.651 Test Loss: 0.964 Test Acc: 0.651
Validation loss decreased (-0.598674 --> -0.651306).  Saving model ...
Epoch: 15 cost time: 1.582430124282837
Epoch: 15, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.908 Vali Acc: 0.704 Test Loss: 0.908 Test Acc: 0.704
Validation loss decreased (-0.651306 --> -0.703938).  Saving model ...
Epoch: 16 cost time: 1.3861238956451416
Epoch: 16, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.857 Vali Acc: 0.724 Test Loss: 0.857 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723676).  Saving model ...
Epoch: 17 cost time: 1.144881248474121
Epoch: 17, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.798 Vali Acc: 0.763 Test Loss: 0.798 Test Acc: 0.763
Validation loss decreased (-0.723676 --> -0.763150).  Saving model ...
Epoch: 18 cost time: 1.4942800998687744
Epoch: 18, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
Validation loss decreased (-0.763150 --> -0.782887).  Saving model ...
Epoch: 19 cost time: 1.4489643573760986
Epoch: 19, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.694 Vali Acc: 0.809 Test Loss: 0.694 Test Acc: 0.809
Validation loss decreased (-0.782887 --> -0.809204).  Saving model ...
Epoch: 20 cost time: 1.423457145690918
Epoch: 20, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.647 Vali Acc: 0.836 Test Loss: 0.647 Test Acc: 0.836
Validation loss decreased (-0.809204 --> -0.835520).  Saving model ...
Epoch: 21 cost time: 1.2723164558410645
Epoch: 21, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.369276762008667
Epoch: 22, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
Validation loss decreased (-0.835520 --> -0.855258).  Saving model ...
Epoch: 23 cost time: 1.4118659496307373
Epoch: 23, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 24 cost time: 1.2808566093444824
Epoch: 24, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.501 Vali Acc: 0.842 Test Loss: 0.501 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3393468856811523
Epoch: 25, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855258).  Saving model ...
Epoch: 26 cost time: 1.3177614212036133
Epoch: 26, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.453 Vali Acc: 0.868 Test Loss: 0.453 Test Acc: 0.868
Validation loss decreased (-0.855258 --> -0.868417).  Saving model ...
Epoch: 27 cost time: 1.2902357578277588
Epoch: 27, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.433 Vali Acc: 0.849 Test Loss: 0.433 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.326066017150879
Epoch: 28, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.421 Vali Acc: 0.868 Test Loss: 0.421 Test Acc: 0.868
Validation loss decreased (-0.868417 --> -0.868417).  Saving model ...
Epoch: 29 cost time: 1.2188620567321777
Epoch: 29, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1331558227539062
Epoch: 30, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.868421052631579
model parameter : 173764
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6789803504943848
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.4301652908325195
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.382 Vali Acc: 0.283 Test Loss: 1.382 Test Acc: 0.283
Validation loss decreased (-0.269723 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.2112400531768799
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.349 Vali Acc: 0.289 Test Loss: 1.349 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 1.2778983116149902
Epoch: 4, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.312 Vali Acc: 0.329 Test Loss: 1.312 Test Acc: 0.329
Validation loss decreased (-0.289460 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 1.3802971839904785
Epoch: 5, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.277 Vali Acc: 0.368 Test Loss: 1.277 Test Acc: 0.368
Validation loss decreased (-0.328934 --> -0.368408).  Saving model ...
Epoch: 6 cost time: 1.3198230266571045
Epoch: 6, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.243 Vali Acc: 0.395 Test Loss: 1.243 Test Acc: 0.395
Validation loss decreased (-0.368408 --> -0.394724).  Saving model ...
Epoch: 7 cost time: 1.3155112266540527
Epoch: 7, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.210 Vali Acc: 0.428 Test Loss: 1.210 Test Acc: 0.428
Validation loss decreased (-0.394724 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 1.3641729354858398
Epoch: 8, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.171 Vali Acc: 0.480 Test Loss: 1.171 Test Acc: 0.480
Validation loss decreased (-0.427619 --> -0.480251).  Saving model ...
Epoch: 9 cost time: 1.4894044399261475
Epoch: 9, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.129 Vali Acc: 0.513 Test Loss: 1.129 Test Acc: 0.513
Validation loss decreased (-0.480251 --> -0.513147).  Saving model ...
Epoch: 10 cost time: 1.4128718376159668
Epoch: 10, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.081 Vali Acc: 0.559 Test Loss: 1.081 Test Acc: 0.559
Validation loss decreased (-0.513147 --> -0.559200).  Saving model ...
Epoch: 11 cost time: 1.4445767402648926
Epoch: 11, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.027 Vali Acc: 0.618 Test Loss: 1.027 Test Acc: 0.618
Validation loss decreased (-0.559200 --> -0.618411).  Saving model ...
Epoch: 12 cost time: 1.4534997940063477
Epoch: 12, Steps: 10 | Train Loss: 0.954 Vali Loss: 0.968 Vali Acc: 0.664 Test Loss: 0.968 Test Acc: 0.664
Validation loss decreased (-0.618411 --> -0.664464).  Saving model ...
Epoch: 13 cost time: 1.401012659072876
Epoch: 13, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.664464 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.2950568199157715
Epoch: 14, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.849 Vali Acc: 0.757 Test Loss: 0.849 Test Acc: 0.757
Validation loss decreased (-0.749991 --> -0.756570).  Saving model ...
Epoch: 15 cost time: 1.2450542449951172
Epoch: 15, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.790 Vali Acc: 0.776 Test Loss: 0.790 Test Acc: 0.776
Validation loss decreased (-0.756570 --> -0.776308).  Saving model ...
Epoch: 16 cost time: 1.15549898147583
Epoch: 16, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
Validation loss decreased (-0.776308 --> -0.789466).  Saving model ...
Epoch: 17 cost time: 1.179527759552002
Epoch: 17, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.676 Vali Acc: 0.796 Test Loss: 0.676 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796046).  Saving model ...
Epoch: 18 cost time: 1.3340349197387695
Epoch: 18, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 19 cost time: 1.4240827560424805
Epoch: 19, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.3856923580169678
Epoch: 20, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5518763065338135
Epoch: 21, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4004106521606445
Epoch: 22, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.3102035522460938
Epoch: 23, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 24 cost time: 1.4276275634765625
Epoch: 24, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 25 cost time: 1.3645663261413574
Epoch: 25, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 26 cost time: 1.4762365818023682
Epoch: 26, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 27 cost time: 1.2907309532165527
Epoch: 27, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4890623092651367
Epoch: 28, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5026500225067139
Epoch: 29, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4362640380859375
Epoch: 30, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 587748
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.470939874649048
Epoch: 1, Steps: 10 | Train Loss: 1.551 Vali Loss: 1.483 Vali Acc: 0.184 Test Loss: 1.483 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 1.1639504432678223
Epoch: 2, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.463 Vali Acc: 0.197 Test Loss: 1.463 Test Acc: 0.197
Validation loss decreased (-0.184196 --> -0.197354).  Saving model ...
Epoch: 3 cost time: 1.324051856994629
Epoch: 3, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.435 Vali Acc: 0.230 Test Loss: 1.435 Test Acc: 0.230
Validation loss decreased (-0.197354 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 0.8800413608551025
Epoch: 4, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.403 Vali Acc: 0.257 Test Loss: 1.403 Test Acc: 0.257
Validation loss decreased (-0.230249 --> -0.256565).  Saving model ...
Epoch: 5 cost time: 1.3014192581176758
Epoch: 5, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.371 Vali Acc: 0.309 Test Loss: 1.371 Test Acc: 0.309
Validation loss decreased (-0.256565 --> -0.309197).  Saving model ...
Epoch: 6 cost time: 1.1595971584320068
Epoch: 6, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.337 Vali Acc: 0.336 Test Loss: 1.337 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 7 cost time: 1.1895287036895752
Epoch: 7, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.304 Vali Acc: 0.368 Test Loss: 1.304 Test Acc: 0.368
Validation loss decreased (-0.335513 --> -0.368408).  Saving model ...
Epoch: 8 cost time: 0.9643800258636475
Epoch: 8, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.265 Vali Acc: 0.401 Test Loss: 1.265 Test Acc: 0.401
Validation loss decreased (-0.368408 --> -0.401303).  Saving model ...
Epoch: 9 cost time: 1.3554461002349854
Epoch: 9, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.223 Vali Acc: 0.447 Test Loss: 1.223 Test Acc: 0.447
Validation loss decreased (-0.401303 --> -0.447356).  Saving model ...
Epoch: 10 cost time: 1.1392643451690674
Epoch: 10, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.175 Vali Acc: 0.480 Test Loss: 1.175 Test Acc: 0.480
Validation loss decreased (-0.447356 --> -0.480251).  Saving model ...
Epoch: 11 cost time: 1.3487739562988281
Epoch: 11, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.129 Vali Acc: 0.533 Test Loss: 1.129 Test Acc: 0.533
Validation loss decreased (-0.480251 --> -0.532883).  Saving model ...
Epoch: 12 cost time: 1.099377155303955
Epoch: 12, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.083 Vali Acc: 0.579 Test Loss: 1.083 Test Acc: 0.579
Validation loss decreased (-0.532883 --> -0.578937).  Saving model ...
Epoch: 13 cost time: 1.2315568923950195
Epoch: 13, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.035 Vali Acc: 0.618 Test Loss: 1.035 Test Acc: 0.618
Validation loss decreased (-0.578937 --> -0.618411).  Saving model ...
Epoch: 14 cost time: 1.1658544540405273
Epoch: 14, Steps: 10 | Train Loss: 0.974 Vali Loss: 0.979 Vali Acc: 0.651 Test Loss: 0.979 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651306).  Saving model ...
Epoch: 15 cost time: 1.1733644008636475
Epoch: 15, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.925 Vali Acc: 0.697 Test Loss: 0.925 Test Acc: 0.697
Validation loss decreased (-0.651306 --> -0.697359).  Saving model ...
Epoch: 16 cost time: 1.3073275089263916
Epoch: 16, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.871 Vali Acc: 0.743 Test Loss: 0.871 Test Acc: 0.743
Validation loss decreased (-0.697359 --> -0.743412).  Saving model ...
Epoch: 17 cost time: 1.1286592483520508
Epoch: 17, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.817 Vali Acc: 0.763 Test Loss: 0.817 Test Acc: 0.763
Validation loss decreased (-0.743412 --> -0.763150).  Saving model ...
Epoch: 18 cost time: 1.3448309898376465
Epoch: 18, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.761 Vali Acc: 0.763 Test Loss: 0.761 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763150).  Saving model ...
Epoch: 19 cost time: 1.240243673324585
Epoch: 19, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
Validation loss decreased (-0.763150 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 1.4440090656280518
Epoch: 20, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 1.284602165222168
Epoch: 21, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 22 cost time: 1.3388969898223877
Epoch: 22, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
Validation loss decreased (-0.809204 --> -0.822362).  Saving model ...
Epoch: 23 cost time: 1.2290217876434326
Epoch: 23, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.566 Vali Acc: 0.829 Test Loss: 0.566 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 24 cost time: 1.436727523803711
Epoch: 24, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.537 Vali Acc: 0.836 Test Loss: 0.537 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 25 cost time: 1.1831018924713135
Epoch: 25, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4857497215270996
Epoch: 26, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
Validation loss decreased (-0.835521 --> -0.835522).  Saving model ...
Epoch: 27 cost time: 1.3463823795318604
Epoch: 27, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
Validation loss decreased (-0.835522 --> -0.855258).  Saving model ...
Epoch: 28 cost time: 1.4064905643463135
Epoch: 28, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.855258 --> -0.855259).  Saving model ...
Epoch: 29 cost time: 1.3047409057617188
Epoch: 29, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.421 Vali Acc: 0.849 Test Loss: 0.421 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3775482177734375
Epoch: 30, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.855259 --> -0.855259).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8552631578947368
model parameter : 173764
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.102919340133667
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.405 Vali Acc: 0.263 Test Loss: 1.405 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.4321205615997314
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.381 Vali Acc: 0.283 Test Loss: 1.381 Test Acc: 0.283
Validation loss decreased (-0.263144 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.3242952823638916
Epoch: 3, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.357 Vali Acc: 0.276 Test Loss: 1.357 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3912386894226074
Epoch: 4, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.328 Vali Acc: 0.303 Test Loss: 1.328 Test Acc: 0.303
Validation loss decreased (-0.282881 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 1.1505203247070312
Epoch: 5, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.303 Vali Acc: 0.349 Test Loss: 1.303 Test Acc: 0.349
Validation loss decreased (-0.302618 --> -0.348671).  Saving model ...
Epoch: 6 cost time: 1.0313735008239746
Epoch: 6, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.280 Vali Acc: 0.382 Test Loss: 1.280 Test Acc: 0.382
Validation loss decreased (-0.348671 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 1.0265300273895264
Epoch: 7, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
Validation loss decreased (-0.381566 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 1.0661983489990234
Epoch: 8, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.223 Vali Acc: 0.507 Test Loss: 1.223 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 9 cost time: 1.0171589851379395
Epoch: 9, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.195 Vali Acc: 0.539 Test Loss: 1.195 Test Acc: 0.539
Validation loss decreased (-0.506567 --> -0.539462).  Saving model ...
Epoch: 10 cost time: 1.2140305042266846
Epoch: 10, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.167 Vali Acc: 0.559 Test Loss: 1.167 Test Acc: 0.559
Validation loss decreased (-0.539462 --> -0.559199).  Saving model ...
Epoch: 11 cost time: 1.396862268447876
Epoch: 11, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.142 Vali Acc: 0.592 Test Loss: 1.142 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 12 cost time: 1.223041296005249
Epoch: 12, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.112 Vali Acc: 0.612 Test Loss: 1.112 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611831).  Saving model ...
Epoch: 13 cost time: 1.0312495231628418
Epoch: 13, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.079 Vali Acc: 0.638 Test Loss: 1.079 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638147).  Saving model ...
Epoch: 14 cost time: 1.0746362209320068
Epoch: 14, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.044 Vali Acc: 0.645 Test Loss: 1.044 Test Acc: 0.645
Validation loss decreased (-0.638147 --> -0.644726).  Saving model ...
Epoch: 15 cost time: 1.2648732662200928
Epoch: 15, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.002 Vali Acc: 0.691 Test Loss: 1.002 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690779).  Saving model ...
Epoch: 16 cost time: 0.9051034450531006
Epoch: 16, Steps: 10 | Train Loss: 0.946 Vali Loss: 0.958 Vali Acc: 0.697 Test Loss: 0.958 Test Acc: 0.697
Validation loss decreased (-0.690779 --> -0.697359).  Saving model ...
Epoch: 17 cost time: 0.9805073738098145
Epoch: 17, Steps: 10 | Train Loss: 0.915 Vali Loss: 0.919 Vali Acc: 0.743 Test Loss: 0.919 Test Acc: 0.743
Validation loss decreased (-0.697359 --> -0.743412).  Saving model ...
Epoch: 18 cost time: 1.205458402633667
Epoch: 18, Steps: 10 | Train Loss: 0.876 Vali Loss: 0.884 Vali Acc: 0.737 Test Loss: 0.884 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2168569564819336
Epoch: 19, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.849 Vali Acc: 0.743 Test Loss: 0.849 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743413).  Saving model ...
Epoch: 20 cost time: 1.1145014762878418
Epoch: 20, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.813 Vali Acc: 0.757 Test Loss: 0.813 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756571).  Saving model ...
Epoch: 21 cost time: 1.106109857559204
Epoch: 21, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.773 Vali Acc: 0.776 Test Loss: 0.773 Test Acc: 0.776
Validation loss decreased (-0.756571 --> -0.776308).  Saving model ...
Epoch: 22 cost time: 1.0461938381195068
Epoch: 22, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.736 Vali Acc: 0.776 Test Loss: 0.736 Test Acc: 0.776
Validation loss decreased (-0.776308 --> -0.776308).  Saving model ...
Epoch: 23 cost time: 1.280613899230957
Epoch: 23, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
Validation loss decreased (-0.776308 --> -0.802625).  Saving model ...
Epoch: 24 cost time: 1.1113708019256592
Epoch: 24, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.662 Vali Acc: 0.789 Test Loss: 0.662 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8402001857757568
Epoch: 25, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.636 Vali Acc: 0.776 Test Loss: 0.636 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9964077472686768
Epoch: 26, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 27 cost time: 1.3650615215301514
Epoch: 27, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 28 cost time: 1.2323718070983887
Epoch: 28, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2693421840667725
Epoch: 29, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.521 Vali Acc: 0.836 Test Loss: 0.521 Test Acc: 0.836
Validation loss decreased (-0.815783 --> -0.835521).  Saving model ...
Epoch: 30 cost time: 1.0623211860656738
Epoch: 30, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 587748
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.217879056930542
Epoch: 1, Steps: 10 | Train Loss: 1.550 Vali Loss: 1.492 Vali Acc: 0.171 Test Loss: 1.492 Test Acc: 0.171
Validation loss decreased (inf --> -0.171038).  Saving model ...
Epoch: 2 cost time: 1.0043554306030273
Epoch: 2, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.479 Vali Acc: 0.191 Test Loss: 1.479 Test Acc: 0.191
Validation loss decreased (-0.171038 --> -0.190775).  Saving model ...
Epoch: 3 cost time: 1.0486936569213867
Epoch: 3, Steps: 10 | Train Loss: 1.510 Vali Loss: 1.461 Vali Acc: 0.204 Test Loss: 1.461 Test Acc: 0.204
Validation loss decreased (-0.190775 --> -0.203933).  Saving model ...
Epoch: 4 cost time: 0.9799666404724121
Epoch: 4, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.440 Vali Acc: 0.217 Test Loss: 1.440 Test Acc: 0.217
Validation loss decreased (-0.203933 --> -0.217091).  Saving model ...
Epoch: 5 cost time: 1.0879943370819092
Epoch: 5, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.418 Vali Acc: 0.230 Test Loss: 1.418 Test Acc: 0.230
Validation loss decreased (-0.217091 --> -0.230249).  Saving model ...
Epoch: 6 cost time: 1.11039137840271
Epoch: 6, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (-0.230249 --> -0.269723).  Saving model ...
Epoch: 7 cost time: 1.0756428241729736
Epoch: 7, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.374 Vali Acc: 0.296 Test Loss: 1.374 Test Acc: 0.296
Validation loss decreased (-0.269723 --> -0.296039).  Saving model ...
Epoch: 8 cost time: 1.166046380996704
Epoch: 8, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.351 Vali Acc: 0.349 Test Loss: 1.351 Test Acc: 0.349
Validation loss decreased (-0.296039 --> -0.348671).  Saving model ...
Epoch: 9 cost time: 1.2941699028015137
Epoch: 9, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.327 Vali Acc: 0.368 Test Loss: 1.327 Test Acc: 0.368
Validation loss decreased (-0.348671 --> -0.368408).  Saving model ...
Epoch: 10 cost time: 1.296332836151123
Epoch: 10, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.285 Vali Acc: 0.428 Test Loss: 1.285 Test Acc: 0.428
Validation loss decreased (-0.368408 --> -0.427619).  Saving model ...
Epoch: 11 cost time: 1.1474237442016602
Epoch: 11, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.259 Vali Acc: 0.454 Test Loss: 1.259 Test Acc: 0.454
Validation loss decreased (-0.427619 --> -0.453935).  Saving model ...
Epoch: 12 cost time: 1.0525257587432861
Epoch: 12, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.234 Vali Acc: 0.493 Test Loss: 1.234 Test Acc: 0.493
Validation loss decreased (-0.453935 --> -0.493409).  Saving model ...
Epoch: 13 cost time: 1.0751147270202637
Epoch: 13, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.208 Vali Acc: 0.513 Test Loss: 1.208 Test Acc: 0.513
Validation loss decreased (-0.493409 --> -0.513146).  Saving model ...
Epoch: 14 cost time: 1.1556496620178223
Epoch: 14, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.181 Vali Acc: 0.526 Test Loss: 1.181 Test Acc: 0.526
Validation loss decreased (-0.513146 --> -0.526304).  Saving model ...
Epoch: 15 cost time: 1.0050106048583984
Epoch: 15, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.153 Vali Acc: 0.553 Test Loss: 1.153 Test Acc: 0.553
Validation loss decreased (-0.526304 --> -0.552620).  Saving model ...
Epoch: 16 cost time: 0.996492862701416
Epoch: 16, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.124 Vali Acc: 0.586 Test Loss: 1.124 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585515).  Saving model ...
Epoch: 17 cost time: 1.110487699508667
Epoch: 17, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.098 Vali Acc: 0.599 Test Loss: 1.098 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598673).  Saving model ...
Epoch: 18 cost time: 1.0215508937835693
Epoch: 18, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.069 Vali Acc: 0.612 Test Loss: 1.069 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611831).  Saving model ...
Epoch: 19 cost time: 1.0873663425445557
Epoch: 19, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.046 Vali Acc: 0.625 Test Loss: 1.046 Test Acc: 0.625
Validation loss decreased (-0.611831 --> -0.624990).  Saving model ...
Epoch: 20 cost time: 1.0384986400604248
Epoch: 20, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.012 Vali Acc: 0.632 Test Loss: 1.012 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631569).  Saving model ...
Epoch: 21 cost time: 1.2063114643096924
Epoch: 21, Steps: 10 | Train Loss: 0.920 Vali Loss: 0.978 Vali Acc: 0.645 Test Loss: 0.978 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644727).  Saving model ...
Epoch: 22 cost time: 1.0672545433044434
Epoch: 22, Steps: 10 | Train Loss: 0.882 Vali Loss: 0.943 Vali Acc: 0.651 Test Loss: 0.943 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651306).  Saving model ...
Epoch: 23 cost time: 1.1270530223846436
Epoch: 23, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.906 Vali Acc: 0.671 Test Loss: 0.906 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671044).  Saving model ...
Epoch: 24 cost time: 1.2027161121368408
Epoch: 24, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.872 Vali Acc: 0.684 Test Loss: 0.872 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 25 cost time: 1.1235525608062744
Epoch: 25, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.831 Vali Acc: 0.724 Test Loss: 0.831 Test Acc: 0.724
Validation loss decreased (-0.684202 --> -0.723676).  Saving model ...
Epoch: 26 cost time: 1.3733656406402588
Epoch: 26, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.797 Vali Acc: 0.730 Test Loss: 0.797 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 27 cost time: 1.1863102912902832
Epoch: 27, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.763 Vali Acc: 0.730 Test Loss: 0.763 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 28 cost time: 1.233215570449829
Epoch: 28, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.722 Vali Acc: 0.763 Test Loss: 0.722 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763151).  Saving model ...
Epoch: 29 cost time: 1.3179028034210205
Epoch: 29, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.682 Vali Acc: 0.776 Test Loss: 0.682 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 30 cost time: 0.9752323627471924
Epoch: 30, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.647 Vali Acc: 0.776 Test Loss: 0.647 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 173764
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1878063678741455
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.388 Vali Acc: 0.289 Test Loss: 1.388 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.173806667327881
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.369 Vali Acc: 0.322 Test Loss: 1.369 Test Acc: 0.322
Validation loss decreased (-0.289460 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.5810661315917969
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (-0.322355 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.4802155494689941
Epoch: 4, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.320 Vali Acc: 0.395 Test Loss: 1.320 Test Acc: 0.395
Validation loss decreased (-0.374987 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.6891322135925293
Epoch: 5, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.289 Vali Acc: 0.421 Test Loss: 1.289 Test Acc: 0.421
Validation loss decreased (-0.394724 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 2.0468406677246094
Epoch: 6, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.259 Vali Acc: 0.434 Test Loss: 1.259 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 1.7120788097381592
Epoch: 7, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.224 Vali Acc: 0.454 Test Loss: 1.224 Test Acc: 0.454
Validation loss decreased (-0.434198 --> -0.453935).  Saving model ...
Epoch: 8 cost time: 1.3419456481933594
Epoch: 8, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.188 Vali Acc: 0.480 Test Loss: 1.188 Test Acc: 0.480
Validation loss decreased (-0.453935 --> -0.480251).  Saving model ...
Epoch: 9 cost time: 1.907785415649414
Epoch: 9, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.480251 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 2.035273790359497
Epoch: 10, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.111 Vali Acc: 0.546 Test Loss: 1.111 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546042).  Saving model ...
Epoch: 11 cost time: 1.466212511062622
Epoch: 11, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.061 Vali Acc: 0.559 Test Loss: 1.061 Test Acc: 0.559
Validation loss decreased (-0.546042 --> -0.559200).  Saving model ...
Epoch: 12 cost time: 1.6815071105957031
Epoch: 12, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.005 Vali Acc: 0.605 Test Loss: 1.005 Test Acc: 0.605
Validation loss decreased (-0.559200 --> -0.605253).  Saving model ...
Epoch: 13 cost time: 1.6848790645599365
Epoch: 13, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.943 Vali Acc: 0.658 Test Loss: 0.943 Test Acc: 0.658
Validation loss decreased (-0.605253 --> -0.657885).  Saving model ...
Epoch: 14 cost time: 2.0850989818573
Epoch: 14, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.875 Vali Acc: 0.724 Test Loss: 0.875 Test Acc: 0.724
Validation loss decreased (-0.657885 --> -0.723675).  Saving model ...
Epoch: 15 cost time: 2.144920587539673
Epoch: 15, Steps: 10 | Train Loss: 0.776 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.723675 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 1.6484668254852295
Epoch: 16, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.756 Vali Acc: 0.770 Test Loss: 0.756 Test Acc: 0.770
Validation loss decreased (-0.749992 --> -0.769729).  Saving model ...
Epoch: 17 cost time: 1.7204713821411133
Epoch: 17, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
Validation loss decreased (-0.769729 --> -0.776309).  Saving model ...
Epoch: 18 cost time: 1.4477252960205078
Epoch: 18, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
Validation loss decreased (-0.776309 --> -0.809204).  Saving model ...
Epoch: 19 cost time: 2.039682388305664
Epoch: 19, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 20 cost time: 2.363563299179077
Epoch: 20, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.580 Vali Acc: 0.829 Test Loss: 0.580 Test Acc: 0.829
Validation loss decreased (-0.809204 --> -0.828942).  Saving model ...
Epoch: 21 cost time: 2.2273783683776855
Epoch: 21, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.545 Vali Acc: 0.849 Test Loss: 0.545 Test Acc: 0.849
Validation loss decreased (-0.828942 --> -0.848679).  Saving model ...
Epoch: 22 cost time: 2.2712924480438232
Epoch: 22, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.513 Vali Acc: 0.849 Test Loss: 0.513 Test Acc: 0.849
Validation loss decreased (-0.848679 --> -0.848679).  Saving model ...
Epoch: 23 cost time: 2.064626693725586
Epoch: 23, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.490 Vali Acc: 0.836 Test Loss: 0.490 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1064035892486572
Epoch: 24, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2102785110473633
Epoch: 25, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9002034664154053
Epoch: 26, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.484 Vali Acc: 0.836 Test Loss: 0.484 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9116711616516113
Epoch: 27, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.478 Vali Acc: 0.836 Test Loss: 0.478 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9047255516052246
Epoch: 28, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.842052698135376
Epoch: 29, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.487 Vali Acc: 0.829 Test Loss: 0.487 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8124909400939941
Epoch: 30, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 294500
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.263697385787964
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.460 Vali Acc: 0.303 Test Loss: 1.460 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.5342621803283691
Epoch: 2, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.444 Vali Acc: 0.316 Test Loss: 1.444 Test Acc: 0.316
Validation loss decreased (-0.302617 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 1.1948130130767822
Epoch: 3, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.422 Vali Acc: 0.309 Test Loss: 1.422 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2444348335266113
Epoch: 4, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.397 Vali Acc: 0.322 Test Loss: 1.397 Test Acc: 0.322
Validation loss decreased (-0.315775 --> -0.322354).  Saving model ...
Epoch: 5 cost time: 1.4000837802886963
Epoch: 5, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.371 Vali Acc: 0.382 Test Loss: 1.371 Test Acc: 0.382
Validation loss decreased (-0.322354 --> -0.381565).  Saving model ...
Epoch: 6 cost time: 1.4271187782287598
Epoch: 6, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.343 Vali Acc: 0.421 Test Loss: 1.343 Test Acc: 0.421
Validation loss decreased (-0.381565 --> -0.421039).  Saving model ...
Epoch: 7 cost time: 1.5711748600006104
Epoch: 7, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.314 Vali Acc: 0.447 Test Loss: 1.314 Test Acc: 0.447
Validation loss decreased (-0.421039 --> -0.447355).  Saving model ...
Epoch: 8 cost time: 1.5190315246582031
Epoch: 8, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.284 Vali Acc: 0.487 Test Loss: 1.284 Test Acc: 0.487
Validation loss decreased (-0.447355 --> -0.486829).  Saving model ...
Epoch: 9 cost time: 1.20162034034729
Epoch: 9, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.252 Vali Acc: 0.513 Test Loss: 1.252 Test Acc: 0.513
Validation loss decreased (-0.486829 --> -0.513145).  Saving model ...
Epoch: 10 cost time: 1.4276211261749268
Epoch: 10, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.219 Vali Acc: 0.566 Test Loss: 1.219 Test Acc: 0.566
Validation loss decreased (-0.513145 --> -0.565777).  Saving model ...
Epoch: 11 cost time: 1.1428751945495605
Epoch: 11, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.182 Vali Acc: 0.572 Test Loss: 1.182 Test Acc: 0.572
Validation loss decreased (-0.565777 --> -0.572357).  Saving model ...
Epoch: 12 cost time: 1.2832999229431152
Epoch: 12, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.141 Vali Acc: 0.579 Test Loss: 1.141 Test Acc: 0.579
Validation loss decreased (-0.572357 --> -0.578936).  Saving model ...
Epoch: 13 cost time: 1.1903841495513916
Epoch: 13, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.100 Vali Acc: 0.586 Test Loss: 1.100 Test Acc: 0.586
Validation loss decreased (-0.578936 --> -0.585515).  Saving model ...
Epoch: 14 cost time: 1.1137592792510986
Epoch: 14, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.058 Vali Acc: 0.612 Test Loss: 1.058 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611832).  Saving model ...
Epoch: 15 cost time: 1.3468902111053467
Epoch: 15, Steps: 10 | Train Loss: 0.944 Vali Loss: 1.010 Vali Acc: 0.651 Test Loss: 1.010 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651306).  Saving model ...
Epoch: 16 cost time: 1.3441200256347656
Epoch: 16, Steps: 10 | Train Loss: 0.893 Vali Loss: 0.957 Vali Acc: 0.658 Test Loss: 0.957 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657885).  Saving model ...
Epoch: 17 cost time: 1.314443826675415
Epoch: 17, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.904 Vali Acc: 0.678 Test Loss: 0.904 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677623).  Saving model ...
Epoch: 18 cost time: 1.2634906768798828
Epoch: 18, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.850 Vali Acc: 0.737 Test Loss: 0.850 Test Acc: 0.737
Validation loss decreased (-0.677623 --> -0.736834).  Saving model ...
Epoch: 19 cost time: 1.3619866371154785
Epoch: 19, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.798 Vali Acc: 0.737 Test Loss: 0.798 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736834).  Saving model ...
Epoch: 20 cost time: 1.2943849563598633
Epoch: 20, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.750 Vali Acc: 0.737 Test Loss: 0.750 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 1.348768949508667
Epoch: 21, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.707 Vali Acc: 0.724 Test Loss: 0.707 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1329915523529053
Epoch: 22, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.674 Vali Acc: 0.724 Test Loss: 0.674 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1608994007110596
Epoch: 23, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 1.194486141204834
Epoch: 24, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.617 Vali Acc: 0.770 Test Loss: 0.617 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 25 cost time: 1.1543927192687988
Epoch: 25, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.2398738861083984
Epoch: 26, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 1.221924066543579
Epoch: 27, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 28 cost time: 1.199280023574829
Epoch: 28, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 1.4880003929138184
Epoch: 29, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.366145372390747
Epoch: 30, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 87492
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.41374135017395
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.386 Vali Acc: 0.289 Test Loss: 1.386 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.975036859512329
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.366 Vali Acc: 0.322 Test Loss: 1.366 Test Acc: 0.322
Validation loss decreased (-0.289460 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.8392560482025146
Epoch: 3, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (-0.322355 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.6692962646484375
Epoch: 4, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.316 Vali Acc: 0.382 Test Loss: 1.316 Test Acc: 0.382
Validation loss decreased (-0.374987 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 1.56429123878479
Epoch: 5, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.286 Vali Acc: 0.441 Test Loss: 1.286 Test Acc: 0.441
Validation loss decreased (-0.381566 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 1.6355671882629395
Epoch: 6, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.255 Vali Acc: 0.461 Test Loss: 1.255 Test Acc: 0.461
Validation loss decreased (-0.440777 --> -0.460514).  Saving model ...
Epoch: 7 cost time: 1.5436644554138184
Epoch: 7, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
Validation loss decreased (-0.460514 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 1.6459760665893555
Epoch: 8, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.183 Vali Acc: 0.493 Test Loss: 1.183 Test Acc: 0.493
Validation loss decreased (-0.467093 --> -0.493409).  Saving model ...
Epoch: 9 cost time: 1.645777702331543
Epoch: 9, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
Validation loss decreased (-0.493409 --> -0.519725).  Saving model ...
Epoch: 10 cost time: 1.8497092723846436
Epoch: 10, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.100 Vali Acc: 0.539 Test Loss: 1.100 Test Acc: 0.539
Validation loss decreased (-0.519725 --> -0.539463).  Saving model ...
Epoch: 11 cost time: 2.045985221862793
Epoch: 11, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.048 Vali Acc: 0.572 Test Loss: 1.048 Test Acc: 0.572
Validation loss decreased (-0.539463 --> -0.572358).  Saving model ...
Epoch: 12 cost time: 2.0316829681396484
Epoch: 12, Steps: 10 | Train Loss: 0.978 Vali Loss: 0.992 Vali Acc: 0.625 Test Loss: 0.992 Test Acc: 0.625
Validation loss decreased (-0.572358 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 1.8659543991088867
Epoch: 13, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.932 Vali Acc: 0.684 Test Loss: 0.932 Test Acc: 0.684
Validation loss decreased (-0.624990 --> -0.684201).  Saving model ...
Epoch: 14 cost time: 1.861037254333496
Epoch: 14, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.867 Vali Acc: 0.711 Test Loss: 0.867 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 1.7348337173461914
Epoch: 15, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.811 Vali Acc: 0.737 Test Loss: 0.811 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736834).  Saving model ...
Epoch: 16 cost time: 1.7606256008148193
Epoch: 16, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.758 Vali Acc: 0.757 Test Loss: 0.758 Test Acc: 0.757
Validation loss decreased (-0.736834 --> -0.756571).  Saving model ...
Epoch: 17 cost time: 1.9151585102081299
Epoch: 17, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.709 Vali Acc: 0.757 Test Loss: 0.709 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 18 cost time: 1.6862061023712158
Epoch: 18, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 19 cost time: 1.6594877243041992
Epoch: 19, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
Validation loss decreased (-0.756572 --> -0.815783).  Saving model ...
Epoch: 20 cost time: 1.7219414710998535
Epoch: 20, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 21 cost time: 1.8770813941955566
Epoch: 21, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.598 Vali Acc: 0.822 Test Loss: 0.598 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 22 cost time: 1.8766252994537354
Epoch: 22, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.564 Vali Acc: 0.829 Test Loss: 0.564 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828942).  Saving model ...
Epoch: 23 cost time: 2.125408887863159
Epoch: 23, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9247121810913086
Epoch: 24, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7425804138183594
Epoch: 25, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.036104679107666
Epoch: 26, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.135981798171997
Epoch: 27, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1410281658172607
Epoch: 28, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.2987256050109863
Epoch: 29, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.239374876022339
Epoch: 30, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 294500
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8328590393066406
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.462 Vali Acc: 0.303 Test Loss: 1.462 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.096829891204834
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.446 Vali Acc: 0.309 Test Loss: 1.446 Test Acc: 0.309
Validation loss decreased (-0.302617 --> -0.309196).  Saving model ...
Epoch: 3 cost time: 1.163459062576294
Epoch: 3, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.424 Vali Acc: 0.309 Test Loss: 1.424 Test Acc: 0.309
Validation loss decreased (-0.309196 --> -0.309196).  Saving model ...
Epoch: 4 cost time: 1.2989318370819092
Epoch: 4, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.399 Vali Acc: 0.322 Test Loss: 1.399 Test Acc: 0.322
Validation loss decreased (-0.309196 --> -0.322354).  Saving model ...
Epoch: 5 cost time: 1.353308916091919
Epoch: 5, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.373 Vali Acc: 0.368 Test Loss: 1.373 Test Acc: 0.368
Validation loss decreased (-0.322354 --> -0.368407).  Saving model ...
Epoch: 6 cost time: 1.2475402355194092
Epoch: 6, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.346 Vali Acc: 0.421 Test Loss: 1.346 Test Acc: 0.421
Validation loss decreased (-0.368407 --> -0.421039).  Saving model ...
Epoch: 7 cost time: 1.2412471771240234
Epoch: 7, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.317 Vali Acc: 0.428 Test Loss: 1.317 Test Acc: 0.428
Validation loss decreased (-0.421039 --> -0.427618).  Saving model ...
Epoch: 8 cost time: 1.1528363227844238
Epoch: 8, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.288 Vali Acc: 0.480 Test Loss: 1.288 Test Acc: 0.480
Validation loss decreased (-0.427618 --> -0.480250).  Saving model ...
Epoch: 9 cost time: 1.2089853286743164
Epoch: 9, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.257 Vali Acc: 0.513 Test Loss: 1.257 Test Acc: 0.513
Validation loss decreased (-0.480250 --> -0.513145).  Saving model ...
Epoch: 10 cost time: 1.2469184398651123
Epoch: 10, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.226 Vali Acc: 0.553 Test Loss: 1.226 Test Acc: 0.553
Validation loss decreased (-0.513145 --> -0.552619).  Saving model ...
Epoch: 11 cost time: 1.3154339790344238
Epoch: 11, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.192 Vali Acc: 0.572 Test Loss: 1.192 Test Acc: 0.572
Validation loss decreased (-0.552619 --> -0.572356).  Saving model ...
Epoch: 12 cost time: 1.228022813796997
Epoch: 12, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.154 Vali Acc: 0.586 Test Loss: 1.154 Test Acc: 0.586
Validation loss decreased (-0.572356 --> -0.585515).  Saving model ...
Epoch: 13 cost time: 1.2317984104156494
Epoch: 13, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.114 Vali Acc: 0.586 Test Loss: 1.114 Test Acc: 0.586
Validation loss decreased (-0.585515 --> -0.585515).  Saving model ...
Epoch: 14 cost time: 1.2722208499908447
Epoch: 14, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.072 Vali Acc: 0.599 Test Loss: 1.072 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598673).  Saving model ...
Epoch: 15 cost time: 1.232853889465332
Epoch: 15, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.025 Vali Acc: 0.612 Test Loss: 1.025 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611832).  Saving model ...
Epoch: 16 cost time: 1.3844108581542969
Epoch: 16, Steps: 10 | Train Loss: 0.930 Vali Loss: 0.976 Vali Acc: 0.638 Test Loss: 0.976 Test Acc: 0.638
Validation loss decreased (-0.611832 --> -0.638148).  Saving model ...
Epoch: 17 cost time: 1.2951462268829346
Epoch: 17, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.927 Vali Acc: 0.651 Test Loss: 0.927 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651307).  Saving model ...
Epoch: 18 cost time: 1.404554843902588
Epoch: 18, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.876 Vali Acc: 0.678 Test Loss: 0.876 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 19 cost time: 1.2353014945983887
Epoch: 19, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.826 Vali Acc: 0.664 Test Loss: 0.826 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2333378791809082
Epoch: 20, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.776 Vali Acc: 0.691 Test Loss: 0.776 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 21 cost time: 1.2140848636627197
Epoch: 21, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.732 Vali Acc: 0.711 Test Loss: 0.732 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 22 cost time: 1.2140707969665527
Epoch: 22, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 23 cost time: 1.4166810512542725
Epoch: 23, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 24 cost time: 1.344351053237915
Epoch: 24, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.626 Vali Acc: 0.717 Test Loss: 0.626 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 25 cost time: 1.2590148448944092
Epoch: 25, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 1.277104377746582
Epoch: 26, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
Validation loss decreased (-0.736836 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.384183406829834
Epoch: 27, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.441493034362793
Epoch: 28, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 1.39223051071167
Epoch: 29, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 30 cost time: 1.2716472148895264
Epoch: 30, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 87492
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7373368740081787
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.385 Vali Acc: 0.283 Test Loss: 1.385 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.7067654132843018
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.369 Vali Acc: 0.303 Test Loss: 1.369 Test Acc: 0.303
Validation loss decreased (-0.282881 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.6667287349700928
Epoch: 3, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.351 Vali Acc: 0.309 Test Loss: 1.351 Test Acc: 0.309
Validation loss decreased (-0.302618 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 1.7839055061340332
Epoch: 4, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.329 Vali Acc: 0.388 Test Loss: 1.329 Test Acc: 0.388
Validation loss decreased (-0.309197 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 1.6866238117218018
Epoch: 5, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.308 Vali Acc: 0.375 Test Loss: 1.308 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8609347343444824
Epoch: 6, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.287 Vali Acc: 0.414 Test Loss: 1.287 Test Acc: 0.414
Validation loss decreased (-0.388145 --> -0.414461).  Saving model ...
Epoch: 7 cost time: 1.9234142303466797
Epoch: 7, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.262 Vali Acc: 0.434 Test Loss: 1.262 Test Acc: 0.434
Validation loss decreased (-0.414461 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 1.7579998970031738
Epoch: 8, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.237 Vali Acc: 0.474 Test Loss: 1.237 Test Acc: 0.474
Validation loss decreased (-0.434198 --> -0.473672).  Saving model ...
Epoch: 9 cost time: 1.8863091468811035
Epoch: 9, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8127565383911133
Epoch: 10, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.176 Vali Acc: 0.513 Test Loss: 1.176 Test Acc: 0.513
Validation loss decreased (-0.473672 --> -0.513146).  Saving model ...
Epoch: 11 cost time: 1.761432409286499
Epoch: 11, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.141 Vali Acc: 0.526 Test Loss: 1.141 Test Acc: 0.526
Validation loss decreased (-0.513146 --> -0.526304).  Saving model ...
Epoch: 12 cost time: 1.734510898590088
Epoch: 12, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.114 Vali Acc: 0.566 Test Loss: 1.114 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565778).  Saving model ...
Epoch: 13 cost time: 1.775923252105713
Epoch: 13, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.085 Vali Acc: 0.592 Test Loss: 1.085 Test Acc: 0.592
Validation loss decreased (-0.565778 --> -0.592094).  Saving model ...
Epoch: 14 cost time: 1.8469305038452148
Epoch: 14, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.055 Vali Acc: 0.638 Test Loss: 1.055 Test Acc: 0.638
Validation loss decreased (-0.592094 --> -0.638147).  Saving model ...
Epoch: 15 cost time: 1.5509514808654785
Epoch: 15, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.017 Vali Acc: 0.645 Test Loss: 1.017 Test Acc: 0.645
Validation loss decreased (-0.638147 --> -0.644727).  Saving model ...
Epoch: 16 cost time: 1.6746442317962646
Epoch: 16, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.964 Vali Acc: 0.651 Test Loss: 0.964 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651306).  Saving model ...
Epoch: 17 cost time: 1.6005375385284424
Epoch: 17, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.924 Vali Acc: 0.684 Test Loss: 0.924 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684201).  Saving model ...
Epoch: 18 cost time: 1.289933681488037
Epoch: 18, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
Validation loss decreased (-0.684201 --> -0.717096).  Saving model ...
Epoch: 19 cost time: 1.6089773178100586
Epoch: 19, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.854 Vali Acc: 0.697 Test Loss: 0.854 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6400623321533203
Epoch: 20, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.819 Vali Acc: 0.730 Test Loss: 0.819 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730255).  Saving model ...
Epoch: 21 cost time: 1.4869625568389893
Epoch: 21, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.802 Vali Acc: 0.757 Test Loss: 0.802 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756571).  Saving model ...
Epoch: 22 cost time: 1.5876927375793457
Epoch: 22, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.769 Vali Acc: 0.737 Test Loss: 0.769 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7572858333587646
Epoch: 23, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.751 Vali Acc: 0.750 Test Loss: 0.751 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6602962017059326
Epoch: 24, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.724 Vali Acc: 0.757 Test Loss: 0.724 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 25 cost time: 1.790985107421875
Epoch: 25, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.699 Vali Acc: 0.776 Test Loss: 0.699 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 26 cost time: 1.6917614936828613
Epoch: 26, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.674 Vali Acc: 0.763 Test Loss: 0.674 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8630938529968262
Epoch: 27, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.655 Vali Acc: 0.770 Test Loss: 0.655 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7598693370819092
Epoch: 28, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 29 cost time: 1.8499925136566162
Epoch: 29, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.615 Vali Acc: 0.789 Test Loss: 0.615 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 1.907710313796997
Epoch: 30, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 294500
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1981558799743652
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.462 Vali Acc: 0.303 Test Loss: 1.462 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.3516547679901123
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.454 Vali Acc: 0.276 Test Loss: 1.454 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.289067268371582
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.434 Vali Acc: 0.309 Test Loss: 1.434 Test Acc: 0.309
Validation loss decreased (-0.302617 --> -0.309196).  Saving model ...
Epoch: 4 cost time: 1.297980785369873
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.414 Vali Acc: 0.316 Test Loss: 1.414 Test Acc: 0.316
Validation loss decreased (-0.309196 --> -0.315775).  Saving model ...
Epoch: 5 cost time: 1.2985029220581055
Epoch: 5, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.393 Vali Acc: 0.342 Test Loss: 1.393 Test Acc: 0.342
Validation loss decreased (-0.315775 --> -0.342091).  Saving model ...
Epoch: 6 cost time: 1.362067461013794
Epoch: 6, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.369 Vali Acc: 0.388 Test Loss: 1.369 Test Acc: 0.388
Validation loss decreased (-0.342091 --> -0.388144).  Saving model ...
Epoch: 7 cost time: 1.4614205360412598
Epoch: 7, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.346 Vali Acc: 0.401 Test Loss: 1.346 Test Acc: 0.401
Validation loss decreased (-0.388144 --> -0.401302).  Saving model ...
Epoch: 8 cost time: 1.0847818851470947
Epoch: 8, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.323 Vali Acc: 0.434 Test Loss: 1.323 Test Acc: 0.434
Validation loss decreased (-0.401302 --> -0.434197).  Saving model ...
Epoch: 9 cost time: 1.3211071491241455
Epoch: 9, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.299 Vali Acc: 0.454 Test Loss: 1.299 Test Acc: 0.454
Validation loss decreased (-0.434197 --> -0.453934).  Saving model ...
Epoch: 10 cost time: 1.2404754161834717
Epoch: 10, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.276 Vali Acc: 0.507 Test Loss: 1.276 Test Acc: 0.507
Validation loss decreased (-0.453934 --> -0.506566).  Saving model ...
Epoch: 11 cost time: 1.3855838775634766
Epoch: 11, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.252 Vali Acc: 0.539 Test Loss: 1.252 Test Acc: 0.539
Validation loss decreased (-0.506566 --> -0.539461).  Saving model ...
Epoch: 12 cost time: 1.432276964187622
Epoch: 12, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.226 Vali Acc: 0.566 Test Loss: 1.226 Test Acc: 0.566
Validation loss decreased (-0.539461 --> -0.565777).  Saving model ...
Epoch: 13 cost time: 1.382462501525879
Epoch: 13, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.200 Vali Acc: 0.572 Test Loss: 1.200 Test Acc: 0.572
Validation loss decreased (-0.565777 --> -0.572356).  Saving model ...
Epoch: 14 cost time: 1.4434592723846436
Epoch: 14, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.174 Vali Acc: 0.586 Test Loss: 1.174 Test Acc: 0.586
Validation loss decreased (-0.572356 --> -0.585515).  Saving model ...
Epoch: 15 cost time: 1.4246723651885986
Epoch: 15, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.147 Vali Acc: 0.612 Test Loss: 1.147 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611831).  Saving model ...
Epoch: 16 cost time: 1.616265058517456
Epoch: 16, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.119 Vali Acc: 0.618 Test Loss: 1.119 Test Acc: 0.618
Validation loss decreased (-0.611831 --> -0.618410).  Saving model ...
Epoch: 17 cost time: 1.437532901763916
Epoch: 17, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
Validation loss decreased (-0.618410 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 1.4944393634796143
Epoch: 18, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.059 Vali Acc: 0.645 Test Loss: 1.059 Test Acc: 0.645
Validation loss decreased (-0.624989 --> -0.644726).  Saving model ...
Epoch: 19 cost time: 1.3826169967651367
Epoch: 19, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.031 Vali Acc: 0.645 Test Loss: 1.031 Test Acc: 0.645
Validation loss decreased (-0.644726 --> -0.644727).  Saving model ...
Epoch: 20 cost time: 1.3974580764770508
Epoch: 20, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.001 Vali Acc: 0.645 Test Loss: 1.001 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644727).  Saving model ...
Epoch: 21 cost time: 1.3595411777496338
Epoch: 21, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.970 Vali Acc: 0.638 Test Loss: 0.970 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3559951782226562
Epoch: 22, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.941 Vali Acc: 0.638 Test Loss: 0.941 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3901214599609375
Epoch: 23, Steps: 10 | Train Loss: 0.834 Vali Loss: 0.912 Vali Acc: 0.638 Test Loss: 0.912 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3434240818023682
Epoch: 24, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.882 Vali Acc: 0.671 Test Loss: 0.882 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 25 cost time: 1.4589793682098389
Epoch: 25, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.853 Vali Acc: 0.684 Test Loss: 0.853 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 26 cost time: 1.3960206508636475
Epoch: 26, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.825 Vali Acc: 0.678 Test Loss: 0.825 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3278274536132812
Epoch: 27, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.800 Vali Acc: 0.691 Test Loss: 0.800 Test Acc: 0.691
Validation loss decreased (-0.684202 --> -0.690781).  Saving model ...
Epoch: 28 cost time: 1.3823392391204834
Epoch: 28, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.773 Vali Acc: 0.711 Test Loss: 0.773 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 29 cost time: 1.3728523254394531
Epoch: 29, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 30 cost time: 1.3236143589019775
Epoch: 30, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7302631578947368
model parameter : 87492
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.07023286819458
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.380 Vali Acc: 0.355 Test Loss: 1.380 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 1.8912591934204102
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.366 Vali Acc: 0.368 Test Loss: 1.366 Test Acc: 0.368
Validation loss decreased (-0.355249 --> -0.368407).  Saving model ...
Epoch: 3 cost time: 2.019742488861084
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.349 Vali Acc: 0.388 Test Loss: 1.349 Test Acc: 0.388
Validation loss decreased (-0.368407 --> -0.388144).  Saving model ...
Epoch: 4 cost time: 2.072904348373413
Epoch: 4, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.328 Vali Acc: 0.421 Test Loss: 1.328 Test Acc: 0.421
Validation loss decreased (-0.388144 --> -0.421039).  Saving model ...
Epoch: 5 cost time: 1.9890170097351074
Epoch: 5, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.305 Vali Acc: 0.447 Test Loss: 1.305 Test Acc: 0.447
Validation loss decreased (-0.421039 --> -0.447355).  Saving model ...
Epoch: 6 cost time: 2.017709493637085
Epoch: 6, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.281 Vali Acc: 0.474 Test Loss: 1.281 Test Acc: 0.474
Validation loss decreased (-0.447355 --> -0.473671).  Saving model ...
Epoch: 7 cost time: 1.7258946895599365
Epoch: 7, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.255 Vali Acc: 0.467 Test Loss: 1.255 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9476244449615479
Epoch: 8, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.228 Vali Acc: 0.493 Test Loss: 1.228 Test Acc: 0.493
Validation loss decreased (-0.473671 --> -0.493409).  Saving model ...
Epoch: 9 cost time: 1.917999029159546
Epoch: 9, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.197 Vali Acc: 0.572 Test Loss: 1.197 Test Acc: 0.572
Validation loss decreased (-0.493409 --> -0.572356).  Saving model ...
Epoch: 10 cost time: 1.813589096069336
Epoch: 10, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.164 Vali Acc: 0.592 Test Loss: 1.164 Test Acc: 0.592
Validation loss decreased (-0.572356 --> -0.592094).  Saving model ...
Epoch: 11 cost time: 1.6237952709197998
Epoch: 11, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.130 Vali Acc: 0.592 Test Loss: 1.130 Test Acc: 0.592
Validation loss decreased (-0.592094 --> -0.592094).  Saving model ...
Epoch: 12 cost time: 1.7203402519226074
Epoch: 12, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.092 Vali Acc: 0.618 Test Loss: 1.092 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618410).  Saving model ...
Epoch: 13 cost time: 1.8604722023010254
Epoch: 13, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.049 Vali Acc: 0.638 Test Loss: 1.049 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638147).  Saving model ...
Epoch: 14 cost time: 1.791438102722168
Epoch: 14, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.004 Vali Acc: 0.651 Test Loss: 1.004 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 15 cost time: 2.065425395965576
Epoch: 15, Steps: 10 | Train Loss: 0.931 Vali Loss: 0.953 Vali Acc: 0.684 Test Loss: 0.953 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684201).  Saving model ...
Epoch: 16 cost time: 1.948218822479248
Epoch: 16, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.900 Vali Acc: 0.711 Test Loss: 0.900 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710517).  Saving model ...
Epoch: 17 cost time: 1.7540500164031982
Epoch: 17, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.843 Vali Acc: 0.737 Test Loss: 0.843 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736834).  Saving model ...
Epoch: 18 cost time: 1.8916435241699219
Epoch: 18, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.9543092250823975
Epoch: 19, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.743 Vali Acc: 0.757 Test Loss: 0.743 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756572).  Saving model ...
Epoch: 20 cost time: 1.8771557807922363
Epoch: 20, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.701 Vali Acc: 0.770 Test Loss: 0.701 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 1.853494644165039
Epoch: 21, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 22 cost time: 1.8424854278564453
Epoch: 22, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.626 Vali Acc: 0.789 Test Loss: 0.626 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 23 cost time: 1.888037919998169
Epoch: 23, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.875002145767212
Epoch: 24, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 2.1401171684265137
Epoch: 25, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 1.8975586891174316
Epoch: 26, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.825425148010254
Epoch: 27, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.708287000656128
Epoch: 28, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815785).  Saving model ...
Epoch: 29 cost time: 2.0770537853240967
Epoch: 29, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8964760303497314
Epoch: 30, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 147876
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.697904348373413
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.360 Vali Acc: 0.375 Test Loss: 1.360 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.6032891273498535
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.347 Vali Acc: 0.401 Test Loss: 1.347 Test Acc: 0.401
Validation loss decreased (-0.374986 --> -0.401302).  Saving model ...
Epoch: 3 cost time: 1.6443719863891602
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.330 Vali Acc: 0.421 Test Loss: 1.330 Test Acc: 0.421
Validation loss decreased (-0.401302 --> -0.421039).  Saving model ...
Epoch: 4 cost time: 1.6744117736816406
Epoch: 4, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.311 Vali Acc: 0.441 Test Loss: 1.311 Test Acc: 0.441
Validation loss decreased (-0.421039 --> -0.440776).  Saving model ...
Epoch: 5 cost time: 1.6760993003845215
Epoch: 5, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.288 Vali Acc: 0.441 Test Loss: 1.288 Test Acc: 0.441
Validation loss decreased (-0.440776 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 1.8605620861053467
Epoch: 6, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.265 Vali Acc: 0.474 Test Loss: 1.265 Test Acc: 0.474
Validation loss decreased (-0.440777 --> -0.473672).  Saving model ...
Epoch: 7 cost time: 1.6110405921936035
Epoch: 7, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.240 Vali Acc: 0.493 Test Loss: 1.240 Test Acc: 0.493
Validation loss decreased (-0.473672 --> -0.493409).  Saving model ...
Epoch: 8 cost time: 1.7236669063568115
Epoch: 8, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.213 Vali Acc: 0.553 Test Loss: 1.213 Test Acc: 0.553
Validation loss decreased (-0.493409 --> -0.552619).  Saving model ...
Epoch: 9 cost time: 1.6473455429077148
Epoch: 9, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.184 Vali Acc: 0.592 Test Loss: 1.184 Test Acc: 0.592
Validation loss decreased (-0.552619 --> -0.592093).  Saving model ...
Epoch: 10 cost time: 1.5890750885009766
Epoch: 10, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.152 Vali Acc: 0.612 Test Loss: 1.152 Test Acc: 0.612
Validation loss decreased (-0.592093 --> -0.611831).  Saving model ...
Epoch: 11 cost time: 1.6022312641143799
Epoch: 11, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.118 Vali Acc: 0.658 Test Loss: 1.118 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657884).  Saving model ...
Epoch: 12 cost time: 1.6393957138061523
Epoch: 12, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.081 Vali Acc: 0.671 Test Loss: 1.081 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671042).  Saving model ...
Epoch: 13 cost time: 1.5816209316253662
Epoch: 13, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.043 Vali Acc: 0.697 Test Loss: 1.043 Test Acc: 0.697
Validation loss decreased (-0.671042 --> -0.697358).  Saving model ...
Epoch: 14 cost time: 1.5850579738616943
Epoch: 14, Steps: 10 | Train Loss: 1.014 Vali Loss: 0.998 Vali Acc: 0.704 Test Loss: 0.998 Test Acc: 0.704
Validation loss decreased (-0.697358 --> -0.703937).  Saving model ...
Epoch: 15 cost time: 1.5868380069732666
Epoch: 15, Steps: 10 | Train Loss: 0.970 Vali Loss: 0.955 Vali Acc: 0.717 Test Loss: 0.955 Test Acc: 0.717
Validation loss decreased (-0.703937 --> -0.717096).  Saving model ...
Epoch: 16 cost time: 1.8582334518432617
Epoch: 16, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.912 Vali Acc: 0.737 Test Loss: 0.912 Test Acc: 0.737
Validation loss decreased (-0.717096 --> -0.736833).  Saving model ...
Epoch: 17 cost time: 1.6857645511627197
Epoch: 17, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.869 Vali Acc: 0.743 Test Loss: 0.869 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743412).  Saving model ...
Epoch: 18 cost time: 1.547353744506836
Epoch: 18, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.828 Vali Acc: 0.757 Test Loss: 0.828 Test Acc: 0.757
Validation loss decreased (-0.743412 --> -0.756571).  Saving model ...
Epoch: 19 cost time: 1.661515474319458
Epoch: 19, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6881194114685059
Epoch: 20, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.754 Vali Acc: 0.750 Test Loss: 0.754 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7971653938293457
Epoch: 21, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6924729347229004
Epoch: 22, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.699 Vali Acc: 0.750 Test Loss: 0.699 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.727888822555542
Epoch: 23, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.669 Vali Acc: 0.743 Test Loss: 0.669 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7781078815460205
Epoch: 24, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 1.7153191566467285
Epoch: 25, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.6387107372283936
Epoch: 26, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.6483087539672852
Epoch: 27, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.580 Vali Acc: 0.796 Test Loss: 0.580 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.745699167251587
Epoch: 28, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6111366748809814
Epoch: 29, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.5834057331085205
Epoch: 30, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 44356
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6977131366729736
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.378 Vali Acc: 0.362 Test Loss: 1.378 Test Acc: 0.362
Validation loss decreased (inf --> -0.361828).  Saving model ...
Epoch: 2 cost time: 1.7111027240753174
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.364 Vali Acc: 0.388 Test Loss: 1.364 Test Acc: 0.388
Validation loss decreased (-0.361828 --> -0.388144).  Saving model ...
Epoch: 3 cost time: 1.638380765914917
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.346 Vali Acc: 0.388 Test Loss: 1.346 Test Acc: 0.388
Validation loss decreased (-0.388144 --> -0.388144).  Saving model ...
Epoch: 4 cost time: 1.6720092296600342
Epoch: 4, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.324 Vali Acc: 0.421 Test Loss: 1.324 Test Acc: 0.421
Validation loss decreased (-0.388144 --> -0.421039).  Saving model ...
Epoch: 5 cost time: 1.8818330764770508
Epoch: 5, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.301 Vali Acc: 0.447 Test Loss: 1.301 Test Acc: 0.447
Validation loss decreased (-0.421039 --> -0.447355).  Saving model ...
Epoch: 6 cost time: 1.856675148010254
Epoch: 6, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.277 Vali Acc: 0.467 Test Loss: 1.277 Test Acc: 0.467
Validation loss decreased (-0.447355 --> -0.467092).  Saving model ...
Epoch: 7 cost time: 1.664076566696167
Epoch: 7, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.250 Vali Acc: 0.493 Test Loss: 1.250 Test Acc: 0.493
Validation loss decreased (-0.467092 --> -0.493409).  Saving model ...
Epoch: 8 cost time: 1.8159377574920654
Epoch: 8, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.223 Vali Acc: 0.526 Test Loss: 1.223 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 9 cost time: 1.9042658805847168
Epoch: 9, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.192 Vali Acc: 0.566 Test Loss: 1.192 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565778).  Saving model ...
Epoch: 10 cost time: 1.6747205257415771
Epoch: 10, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.157 Vali Acc: 0.579 Test Loss: 1.157 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578936).  Saving model ...
Epoch: 11 cost time: 1.5608735084533691
Epoch: 11, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.120 Vali Acc: 0.599 Test Loss: 1.120 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598673).  Saving model ...
Epoch: 12 cost time: 1.673109769821167
Epoch: 12, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.079 Vali Acc: 0.638 Test Loss: 1.079 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638147).  Saving model ...
Epoch: 13 cost time: 1.655062198638916
Epoch: 13, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.038 Vali Acc: 0.651 Test Loss: 1.038 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651305).  Saving model ...
Epoch: 14 cost time: 1.6724889278411865
Epoch: 14, Steps: 10 | Train Loss: 0.965 Vali Loss: 0.998 Vali Acc: 0.697 Test Loss: 0.998 Test Acc: 0.697
Validation loss decreased (-0.651305 --> -0.697358).  Saving model ...
Epoch: 15 cost time: 1.8884365558624268
Epoch: 15, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.949 Vali Acc: 0.691 Test Loss: 0.949 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8030822277069092
Epoch: 16, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.902 Vali Acc: 0.724 Test Loss: 0.902 Test Acc: 0.724
Validation loss decreased (-0.697358 --> -0.723675).  Saving model ...
Epoch: 17 cost time: 1.5150220394134521
Epoch: 17, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.854 Vali Acc: 0.724 Test Loss: 0.854 Test Acc: 0.724
Validation loss decreased (-0.723675 --> -0.723676).  Saving model ...
Epoch: 18 cost time: 1.5848345756530762
Epoch: 18, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.811 Vali Acc: 0.737 Test Loss: 0.811 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736834).  Saving model ...
Epoch: 19 cost time: 1.665879487991333
Epoch: 19, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.767 Vali Acc: 0.743 Test Loss: 0.767 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743413).  Saving model ...
Epoch: 20 cost time: 1.5986721515655518
Epoch: 20, Steps: 10 | Train Loss: 0.643 Vali Loss: 0.721 Vali Acc: 0.770 Test Loss: 0.721 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769730).  Saving model ...
Epoch: 21 cost time: 1.561694860458374
Epoch: 21, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 22 cost time: 1.4952173233032227
Epoch: 22, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 23 cost time: 1.8182446956634521
Epoch: 23, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796046).  Saving model ...
Epoch: 24 cost time: 1.7379741668701172
Epoch: 24, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815783).  Saving model ...
Epoch: 25 cost time: 1.7016417980194092
Epoch: 25, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6248865127563477
Epoch: 26, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6525251865386963
Epoch: 27, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5612521171569824
Epoch: 28, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.090052843093872
Epoch: 29, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7824008464813232
Epoch: 30, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 147876
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3782737255096436
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.362 Vali Acc: 0.388 Test Loss: 1.362 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 1.4253880977630615
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.349 Vali Acc: 0.408 Test Loss: 1.349 Test Acc: 0.408
Validation loss decreased (-0.388144 --> -0.407881).  Saving model ...
Epoch: 3 cost time: 1.4895000457763672
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.331 Vali Acc: 0.434 Test Loss: 1.331 Test Acc: 0.434
Validation loss decreased (-0.407881 --> -0.434197).  Saving model ...
Epoch: 4 cost time: 1.4533262252807617
Epoch: 4, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.311 Vali Acc: 0.447 Test Loss: 1.311 Test Acc: 0.447
Validation loss decreased (-0.434197 --> -0.447355).  Saving model ...
Epoch: 5 cost time: 1.4537785053253174
Epoch: 5, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.288 Vali Acc: 0.454 Test Loss: 1.288 Test Acc: 0.454
Validation loss decreased (-0.447355 --> -0.453934).  Saving model ...
Epoch: 6 cost time: 1.5143678188323975
Epoch: 6, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.265 Vali Acc: 0.487 Test Loss: 1.265 Test Acc: 0.487
Validation loss decreased (-0.453934 --> -0.486829).  Saving model ...
Epoch: 7 cost time: 1.3871097564697266
Epoch: 7, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.583827018737793
Epoch: 8, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.212 Vali Acc: 0.559 Test Loss: 1.212 Test Acc: 0.559
Validation loss decreased (-0.486829 --> -0.559198).  Saving model ...
Epoch: 9 cost time: 1.4894039630889893
Epoch: 9, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.181 Vali Acc: 0.579 Test Loss: 1.181 Test Acc: 0.579
Validation loss decreased (-0.559198 --> -0.578936).  Saving model ...
Epoch: 10 cost time: 1.5109169483184814
Epoch: 10, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.149 Vali Acc: 0.632 Test Loss: 1.149 Test Acc: 0.632
Validation loss decreased (-0.578936 --> -0.631567).  Saving model ...
Epoch: 11 cost time: 1.5805907249450684
Epoch: 11, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.113 Vali Acc: 0.684 Test Loss: 1.113 Test Acc: 0.684
Validation loss decreased (-0.631567 --> -0.684199).  Saving model ...
Epoch: 12 cost time: 1.5514156818389893
Epoch: 12, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.075 Vali Acc: 0.704 Test Loss: 1.075 Test Acc: 0.704
Validation loss decreased (-0.684199 --> -0.703937).  Saving model ...
Epoch: 13 cost time: 1.658501386642456
Epoch: 13, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.035 Vali Acc: 0.717 Test Loss: 1.035 Test Acc: 0.717
Validation loss decreased (-0.703937 --> -0.717095).  Saving model ...
Epoch: 14 cost time: 1.65781569480896
Epoch: 14, Steps: 10 | Train Loss: 1.036 Vali Loss: 0.992 Vali Acc: 0.730 Test Loss: 0.992 Test Acc: 0.730
Validation loss decreased (-0.717095 --> -0.730253).  Saving model ...
Epoch: 15 cost time: 1.346851110458374
Epoch: 15, Steps: 10 | Train Loss: 0.990 Vali Loss: 0.947 Vali Acc: 0.737 Test Loss: 0.947 Test Acc: 0.737
Validation loss decreased (-0.730253 --> -0.736833).  Saving model ...
Epoch: 16 cost time: 1.6402857303619385
Epoch: 16, Steps: 10 | Train Loss: 0.915 Vali Loss: 0.904 Vali Acc: 0.743 Test Loss: 0.904 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743412).  Saving model ...
Epoch: 17 cost time: 1.569566011428833
Epoch: 17, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.861 Vali Acc: 0.737 Test Loss: 0.861 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3988184928894043
Epoch: 18, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.743412 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.3421013355255127
Epoch: 19, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 1.4813587665557861
Epoch: 20, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.749 Vali Acc: 0.763 Test Loss: 0.749 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 21 cost time: 1.5687174797058105
Epoch: 21, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.715 Vali Acc: 0.757 Test Loss: 0.715 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5688269138336182
Epoch: 22, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3838982582092285
Epoch: 23, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763151).  Saving model ...
Epoch: 24 cost time: 1.6474316120147705
Epoch: 24, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.636 Vali Acc: 0.770 Test Loss: 0.636 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 25 cost time: 1.5535757541656494
Epoch: 25, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.614 Vali Acc: 0.770 Test Loss: 0.614 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.4743850231170654
Epoch: 26, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 1.4844083786010742
Epoch: 27, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 28 cost time: 1.552847146987915
Epoch: 28, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.549834966659546
Epoch: 29, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 1.6000721454620361
Epoch: 30, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 44356
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5231728553771973
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.322 Test Loss: 1.384 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.7587931156158447
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.372 Vali Acc: 0.349 Test Loss: 1.372 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 1.6052322387695312
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.348670 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.6858103275299072
Epoch: 4, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.338 Vali Acc: 0.414 Test Loss: 1.338 Test Acc: 0.414
Validation loss decreased (-0.374986 --> -0.414460).  Saving model ...
Epoch: 5 cost time: 1.468601942062378
Epoch: 5, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.318 Vali Acc: 0.461 Test Loss: 1.318 Test Acc: 0.461
Validation loss decreased (-0.414460 --> -0.460513).  Saving model ...
Epoch: 6 cost time: 1.52077054977417
Epoch: 6, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.296 Vali Acc: 0.474 Test Loss: 1.296 Test Acc: 0.474
Validation loss decreased (-0.460513 --> -0.473671).  Saving model ...
Epoch: 7 cost time: 1.0946693420410156
Epoch: 7, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.275 Vali Acc: 0.487 Test Loss: 1.275 Test Acc: 0.487
Validation loss decreased (-0.473671 --> -0.486829).  Saving model ...
Epoch: 8 cost time: 1.4744646549224854
Epoch: 8, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.252 Vali Acc: 0.507 Test Loss: 1.252 Test Acc: 0.507
Validation loss decreased (-0.486829 --> -0.506566).  Saving model ...
Epoch: 9 cost time: 1.5159049034118652
Epoch: 9, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.229 Vali Acc: 0.539 Test Loss: 1.229 Test Acc: 0.539
Validation loss decreased (-0.506566 --> -0.539461).  Saving model ...
Epoch: 10 cost time: 1.3512582778930664
Epoch: 10, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.205 Vali Acc: 0.572 Test Loss: 1.205 Test Acc: 0.572
Validation loss decreased (-0.539461 --> -0.572356).  Saving model ...
Epoch: 11 cost time: 1.3128859996795654
Epoch: 11, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.182 Vali Acc: 0.579 Test Loss: 1.182 Test Acc: 0.579
Validation loss decreased (-0.572356 --> -0.578936).  Saving model ...
Epoch: 12 cost time: 1.494518756866455
Epoch: 12, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.157 Vali Acc: 0.592 Test Loss: 1.157 Test Acc: 0.592
Validation loss decreased (-0.578936 --> -0.592094).  Saving model ...
Epoch: 13 cost time: 1.51468825340271
Epoch: 13, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.129 Vali Acc: 0.612 Test Loss: 1.129 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611831).  Saving model ...
Epoch: 14 cost time: 1.539724588394165
Epoch: 14, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.101 Vali Acc: 0.632 Test Loss: 1.101 Test Acc: 0.632
Validation loss decreased (-0.611831 --> -0.631568).  Saving model ...
Epoch: 15 cost time: 1.5083098411560059
Epoch: 15, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.071 Vali Acc: 0.645 Test Loss: 1.071 Test Acc: 0.645
Validation loss decreased (-0.631568 --> -0.644726).  Saving model ...
Epoch: 16 cost time: 1.6012065410614014
Epoch: 16, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.037 Vali Acc: 0.691 Test Loss: 1.037 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690779).  Saving model ...
Epoch: 17 cost time: 1.4769322872161865
Epoch: 17, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.006 Vali Acc: 0.684 Test Loss: 1.006 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.502490758895874
Epoch: 18, Steps: 10 | Train Loss: 0.967 Vali Loss: 0.975 Vali Acc: 0.711 Test Loss: 0.975 Test Acc: 0.711
Validation loss decreased (-0.690779 --> -0.710517).  Saving model ...
Epoch: 19 cost time: 1.5323486328125
Epoch: 19, Steps: 10 | Train Loss: 0.932 Vali Loss: 0.941 Vali Acc: 0.724 Test Loss: 0.941 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723675).  Saving model ...
Epoch: 20 cost time: 1.6151213645935059
Epoch: 20, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.896 Vali Acc: 0.743 Test Loss: 0.896 Test Acc: 0.743
Validation loss decreased (-0.723675 --> -0.743412).  Saving model ...
Epoch: 21 cost time: 1.4579122066497803
Epoch: 21, Steps: 10 | Train Loss: 0.856 Vali Loss: 0.864 Vali Acc: 0.737 Test Loss: 0.864 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.397538423538208
Epoch: 22, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.743412 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.6320459842681885
Epoch: 23, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.812 Vali Acc: 0.757 Test Loss: 0.812 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756571).  Saving model ...
Epoch: 24 cost time: 1.494934320449829
Epoch: 24, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.790 Vali Acc: 0.757 Test Loss: 0.790 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756571).  Saving model ...
Epoch: 25 cost time: 1.409449577331543
Epoch: 25, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.763 Vali Acc: 0.750 Test Loss: 0.763 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5254559516906738
Epoch: 26, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.765 Vali Acc: 0.737 Test Loss: 0.765 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3536062240600586
Epoch: 27, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.743 Vali Acc: 0.730 Test Loss: 0.743 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2377207279205322
Epoch: 28, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.724 Vali Acc: 0.730 Test Loss: 0.724 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5811805725097656
Epoch: 29, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.697 Vali Acc: 0.757 Test Loss: 0.697 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756572).  Saving model ...
Epoch: 30 cost time: 1.5069291591644287
Epoch: 30, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 147876
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2566144466400146
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.364 Vali Acc: 0.401 Test Loss: 1.364 Test Acc: 0.401
Validation loss decreased (inf --> -0.401302).  Saving model ...
Epoch: 2 cost time: 1.558837890625
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.354 Vali Acc: 0.395 Test Loss: 1.354 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5308787822723389
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.339 Vali Acc: 0.421 Test Loss: 1.339 Test Acc: 0.421
Validation loss decreased (-0.401302 --> -0.421039).  Saving model ...
Epoch: 4 cost time: 1.4431800842285156
Epoch: 4, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.323 Vali Acc: 0.428 Test Loss: 1.323 Test Acc: 0.428
Validation loss decreased (-0.421039 --> -0.427618).  Saving model ...
Epoch: 5 cost time: 1.5777878761291504
Epoch: 5, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.304 Vali Acc: 0.428 Test Loss: 1.304 Test Acc: 0.428
Validation loss decreased (-0.427618 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.4945621490478516
Epoch: 6, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.283 Vali Acc: 0.434 Test Loss: 1.283 Test Acc: 0.434
Validation loss decreased (-0.427619 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 1.435563564300537
Epoch: 7, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.260 Vali Acc: 0.474 Test Loss: 1.260 Test Acc: 0.474
Validation loss decreased (-0.434198 --> -0.473672).  Saving model ...
Epoch: 8 cost time: 1.4583039283752441
Epoch: 8, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.238 Vali Acc: 0.480 Test Loss: 1.238 Test Acc: 0.480
Validation loss decreased (-0.473672 --> -0.480251).  Saving model ...
Epoch: 9 cost time: 1.4443910121917725
Epoch: 9, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.215 Vali Acc: 0.520 Test Loss: 1.215 Test Acc: 0.520
Validation loss decreased (-0.480251 --> -0.519725).  Saving model ...
Epoch: 10 cost time: 1.3802533149719238
Epoch: 10, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.192 Vali Acc: 0.539 Test Loss: 1.192 Test Acc: 0.539
Validation loss decreased (-0.519725 --> -0.539462).  Saving model ...
Epoch: 11 cost time: 1.436211347579956
Epoch: 11, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.169 Vali Acc: 0.592 Test Loss: 1.169 Test Acc: 0.592
Validation loss decreased (-0.539462 --> -0.592094).  Saving model ...
Epoch: 12 cost time: 1.3354053497314453
Epoch: 12, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.146 Vali Acc: 0.592 Test Loss: 1.146 Test Acc: 0.592
Validation loss decreased (-0.592094 --> -0.592094).  Saving model ...
Epoch: 13 cost time: 1.3337962627410889
Epoch: 13, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.122 Vali Acc: 0.645 Test Loss: 1.122 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644726).  Saving model ...
Epoch: 14 cost time: 1.3847606182098389
Epoch: 14, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.097 Vali Acc: 0.632 Test Loss: 1.097 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4031257629394531
Epoch: 15, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.071 Vali Acc: 0.678 Test Loss: 1.071 Test Acc: 0.678
Validation loss decreased (-0.644726 --> -0.677621).  Saving model ...
Epoch: 16 cost time: 1.603588342666626
Epoch: 16, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.043 Vali Acc: 0.704 Test Loss: 1.043 Test Acc: 0.704
Validation loss decreased (-0.677621 --> -0.703937).  Saving model ...
Epoch: 17 cost time: 1.44980788230896
Epoch: 17, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.012 Vali Acc: 0.704 Test Loss: 1.012 Test Acc: 0.704
Validation loss decreased (-0.703937 --> -0.703937).  Saving model ...
Epoch: 18 cost time: 1.370518684387207
Epoch: 18, Steps: 10 | Train Loss: 1.015 Vali Loss: 0.981 Vali Acc: 0.704 Test Loss: 0.981 Test Acc: 0.704
Validation loss decreased (-0.703937 --> -0.703938).  Saving model ...
Epoch: 19 cost time: 1.359745740890503
Epoch: 19, Steps: 10 | Train Loss: 0.999 Vali Loss: 0.951 Vali Acc: 0.737 Test Loss: 0.951 Test Acc: 0.737
Validation loss decreased (-0.703938 --> -0.736833).  Saving model ...
Epoch: 20 cost time: 1.317683458328247
Epoch: 20, Steps: 10 | Train Loss: 0.942 Vali Loss: 0.921 Vali Acc: 0.757 Test Loss: 0.921 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756570).  Saving model ...
Epoch: 21 cost time: 1.3334298133850098
Epoch: 21, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.897 Vali Acc: 0.776 Test Loss: 0.897 Test Acc: 0.776
Validation loss decreased (-0.756570 --> -0.776307).  Saving model ...
Epoch: 22 cost time: 1.3944237232208252
Epoch: 22, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.867 Vali Acc: 0.783 Test Loss: 0.867 Test Acc: 0.783
Validation loss decreased (-0.776307 --> -0.782886).  Saving model ...
Epoch: 23 cost time: 1.4419643878936768
Epoch: 23, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.834 Vali Acc: 0.803 Test Loss: 0.834 Test Acc: 0.803
Validation loss decreased (-0.782886 --> -0.802623).  Saving model ...
Epoch: 24 cost time: 1.5209197998046875
Epoch: 24, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
Validation loss decreased (-0.802623 --> -0.809203).  Saving model ...
Epoch: 25 cost time: 1.4958746433258057
Epoch: 25, Steps: 10 | Train Loss: 0.735 Vali Loss: 0.772 Vali Acc: 0.796 Test Loss: 0.772 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5481324195861816
Epoch: 26, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
Validation loss decreased (-0.809203 --> -0.809203).  Saving model ...
Epoch: 27 cost time: 1.5211126804351807
Epoch: 27, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5787980556488037
Epoch: 28, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6375389099121094
Epoch: 29, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.661 Vali Acc: 0.796 Test Loss: 0.661 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6177775859832764
Epoch: 30, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_TimesNet_UEA_ftM_sl30_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 44356
model size : 0.34MB
