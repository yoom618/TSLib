Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 68.75642013549805
Epoch: 1, Steps: 18 | Train Loss: 2.889 Vali Loss: 1.609 Vali Acc: 0.887 Test Loss: 1.609 Test Acc: 0.887
Validation loss decreased (inf --> -0.886651).  Saving model ...
Epoch: 2 cost time: 68.9139175415039
Epoch: 2, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.248 Vali Acc: 0.973 Test Loss: 0.248 Test Acc: 0.973
Validation loss decreased (-0.886651 --> -0.973331).  Saving model ...
Epoch: 3 cost time: 67.69273018836975
Epoch: 3, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 58.306156396865845
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 49.83225917816162
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 64.06210803985596
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 61.020790815353394
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 59.46627235412598
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 63.616095542907715
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 58.93460464477539
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 59.21708583831787
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 53.541122913360596
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 54.66807174682617
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 61.05511808395386
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 63.746031045913696
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 64.34479331970215
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 51.85905575752258
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 63.221407651901245
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 61.914313316345215
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 56.99483847618103
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 61.68268346786499
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 61.101733684539795
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 50.962623834609985
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 55.3951530456543
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 52.54623341560364
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 61.44687342643738
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 54.61758875846863
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 55.36785364151001
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 54.076454639434814
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 53.27506422996521
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 75447449
model size : 290.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 23.711761713027954
Epoch: 1, Steps: 18 | Train Loss: 2.782 Vali Loss: 1.543 Vali Acc: 0.927 Test Loss: 1.543 Test Acc: 0.927
Validation loss decreased (inf --> -0.926651).  Saving model ...
Epoch: 2 cost time: 18.254902601242065
Epoch: 2, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.256 Vali Acc: 0.967 Test Loss: 0.256 Test Acc: 0.967
Validation loss decreased (-0.926651 --> -0.966664).  Saving model ...
Epoch: 3 cost time: 19.13677716255188
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 22.650213956832886
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 22.451192378997803
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 19.224908590316772
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 21.309755563735962
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 20.99277973175049
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 20.3681480884552
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.088890075683594
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 17.83594059944153
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 20.864348888397217
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 17.375365734100342
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 17.609390258789062
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 20.13024377822876
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 17.662590265274048
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 20.667343616485596
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 21.775602340698242
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 20.654404878616333
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 20.92826509475708
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 18.393617630004883
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 19.71937394142151
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 17.941502332687378
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 18.184099674224854
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 17.492290258407593
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 16.17973017692566
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 17.353783130645752
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 18.254974126815796
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 18.78202509880066
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 20.432047843933105
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22491289
model size : 88.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 38.63253402709961
Epoch: 1, Steps: 18 | Train Loss: 2.889 Vali Loss: 1.609 Vali Acc: 0.887 Test Loss: 1.609 Test Acc: 0.887
Validation loss decreased (inf --> -0.886651).  Saving model ...
Epoch: 2 cost time: 35.49760127067566
Epoch: 2, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.248 Vali Acc: 0.973 Test Loss: 0.248 Test Acc: 0.973
Validation loss decreased (-0.886651 --> -0.973331).  Saving model ...
Epoch: 3 cost time: 34.39720845222473
Epoch: 3, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 34.83727478981018
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 36.09619617462158
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 34.37852621078491
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 33.75518321990967
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 35.90631341934204
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 37.151872396469116
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 36.233675479888916
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 35.84766149520874
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.33834910392761
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 35.61196851730347
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 36.59130620956421
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 34.610681772232056
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 39.62055206298828
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 34.799495697021484
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 33.948725938797
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 35.16243577003479
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 32.1586480140686
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 32.162038803100586
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 31.472627639770508
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 31.98259663581848
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 46.35204768180847
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 45.50423288345337
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 43.95913481712341
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 41.255027532577515
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 35.15953707695007
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 38.699689626693726
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 42.16836643218994
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 75447449
model size : 290.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 15.887771129608154
Epoch: 1, Steps: 18 | Train Loss: 2.782 Vali Loss: 1.543 Vali Acc: 0.927 Test Loss: 1.543 Test Acc: 0.927
Validation loss decreased (inf --> -0.926651).  Saving model ...
Epoch: 2 cost time: 14.857073307037354
Epoch: 2, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.256 Vali Acc: 0.967 Test Loss: 0.256 Test Acc: 0.967
Validation loss decreased (-0.926651 --> -0.966664).  Saving model ...
Epoch: 3 cost time: 10.5230393409729
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 14.916062116622925
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 15.5526762008667
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 13.796619892120361
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 15.50609278678894
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 14.500527143478394
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 15.546390533447266
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.23500370979309
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.146418809890747
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 13.679082870483398
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 14.37970781326294
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 14.492058992385864
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 13.228569984436035
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 15.015095949172974
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 14.473483562469482
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.266221284866333
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.026778221130371
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 11.869129419326782
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 12.996729612350464
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 15.985668659210205
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 14.910082817077637
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 14.132781028747559
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 16.005894422531128
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 16.356637954711914
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 16.003525495529175
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 13.273502826690674
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 16.224539518356323
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 14.530358076095581
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22491289
model size : 88.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 28.32861590385437
Epoch: 1, Steps: 18 | Train Loss: 2.889 Vali Loss: 1.609 Vali Acc: 0.887 Test Loss: 1.609 Test Acc: 0.887
Validation loss decreased (inf --> -0.886651).  Saving model ...
Epoch: 2 cost time: 18.997549295425415
Epoch: 2, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.248 Vali Acc: 0.973 Test Loss: 0.248 Test Acc: 0.973
Validation loss decreased (-0.886651 --> -0.973331).  Saving model ...
Epoch: 3 cost time: 24.418116569519043
Epoch: 3, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 24.553854942321777
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.164104223251343
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 21.467894077301025
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.981491088867188
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 25.6396586894989
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 22.602876901626587
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 22.61371660232544
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 24.171047925949097
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.412636041641235
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.98304057121277
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 24.360103845596313
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 21.565099477767944
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 19.41745138168335
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.1172091960907
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 21.01630663871765
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 23.724384784698486
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 20.79967999458313
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 20.588533878326416
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 19.54204750061035
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 24.878425359725952
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 23.618738651275635
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 23.796099185943604
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 20.41012167930603
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 20.494333505630493
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 23.231029987335205
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 20.846210956573486
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 22.627142906188965
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 75447449
model size : 290.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.393081426620483
Epoch: 1, Steps: 18 | Train Loss: 2.782 Vali Loss: 1.543 Vali Acc: 0.927 Test Loss: 1.543 Test Acc: 0.927
Validation loss decreased (inf --> -0.926651).  Saving model ...
Epoch: 2 cost time: 8.929803609848022
Epoch: 2, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.256 Vali Acc: 0.967 Test Loss: 0.256 Test Acc: 0.967
Validation loss decreased (-0.926651 --> -0.966664).  Saving model ...
Epoch: 3 cost time: 8.724415063858032
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 8.06811785697937
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 9.168382167816162
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 8.046439170837402
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 8.990444421768188
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 8.088733673095703
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 9.01390290260315
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.877066612243652
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.36936616897583
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 8.834513187408447
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 8.816526889801025
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 9.357041835784912
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 8.705074071884155
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 8.968717098236084
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 8.456620216369629
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.37985372543335
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.406703472137451
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 13.184330224990845
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 14.635058403015137
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 15.445854187011719
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 14.320091962814331
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 14.742386817932129
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 15.477215766906738
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 13.974563360214233
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 14.312718391418457
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 12.675815105438232
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 12.883789777755737
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.980 Test Loss: 0.058 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 12.063960790634155
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 22491289
model size : 88.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 42.2459990978241
Epoch: 1, Steps: 18 | Train Loss: 2.868 Vali Loss: 1.664 Vali Acc: 0.880 Test Loss: 1.664 Test Acc: 0.880
Validation loss decreased (inf --> -0.879983).  Saving model ...
Epoch: 2 cost time: 38.71118378639221
Epoch: 2, Steps: 18 | Train Loss: 0.821 Vali Loss: 0.307 Vali Acc: 0.960 Test Loss: 0.307 Test Acc: 0.960
Validation loss decreased (-0.879983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 39.58198547363281
Epoch: 3, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959999).  Saving model ...
Epoch: 4 cost time: 37.899476051330566
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.959999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 40.52713418006897
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 35.88696503639221
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 37.09876370429993
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 36.268571853637695
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 36.49421262741089
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 37.39325714111328
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 36.35743713378906
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 38.39127707481384
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 36.547654151916504
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 36.29161071777344
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 35.614251136779785
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 37.07164406776428
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37957785
model size : 147.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 15.142898559570312
Epoch: 1, Steps: 18 | Train Loss: 2.907 Vali Loss: 1.693 Vali Acc: 0.847 Test Loss: 1.693 Test Acc: 0.847
Validation loss decreased (inf --> -0.846650).  Saving model ...
Epoch: 2 cost time: 14.483347415924072
Epoch: 2, Steps: 18 | Train Loss: 0.916 Vali Loss: 0.314 Vali Acc: 0.960 Test Loss: 0.314 Test Acc: 0.960
Validation loss decreased (-0.846650 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 13.837804555892944
Epoch: 3, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 14.382372379302979
Epoch: 4, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.917790412902832
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 14.533166885375977
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 15.645025968551636
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 16.68617868423462
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 16.942914962768555
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 19.668057441711426
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 19.24271559715271
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 17.930182695388794
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 17.877382040023804
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 18.400101900100708
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 17.928141117095947
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 17.917485237121582
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 18.529508590698242
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 17.131341218948364
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.82876181602478
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 18.317166328430176
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 17.53652787208557
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 17.638484239578247
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 17.10503578186035
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 18.243406772613525
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 18.454607248306274
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 16.29034972190857
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 18.959455966949463
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 18.5972797870636
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 15.487603187561035
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 17.50206685066223
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 11479193
model size : 46.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 34.582419633865356
Epoch: 1, Steps: 18 | Train Loss: 2.868 Vali Loss: 1.664 Vali Acc: 0.880 Test Loss: 1.664 Test Acc: 0.880
Validation loss decreased (inf --> -0.879983).  Saving model ...
Epoch: 2 cost time: 36.09750437736511
Epoch: 2, Steps: 18 | Train Loss: 0.821 Vali Loss: 0.307 Vali Acc: 0.960 Test Loss: 0.307 Test Acc: 0.960
Validation loss decreased (-0.879983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 31.04664397239685
Epoch: 3, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959999).  Saving model ...
Epoch: 4 cost time: 30.93801760673523
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.959999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 28.532284021377563
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.891963005065918
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 31.549147367477417
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.682981252670288
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 32.96124267578125
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 32.026877641677856
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 31.96261167526245
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 31.455747604370117
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 30.818520545959473
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 30.950137615203857
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 32.104223012924194
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 30.8430335521698
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37957785
model size : 147.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.72551679611206
Epoch: 1, Steps: 18 | Train Loss: 2.907 Vali Loss: 1.693 Vali Acc: 0.847 Test Loss: 1.693 Test Acc: 0.847
Validation loss decreased (inf --> -0.846650).  Saving model ...
Epoch: 2 cost time: 12.298178672790527
Epoch: 2, Steps: 18 | Train Loss: 0.916 Vali Loss: 0.314 Vali Acc: 0.960 Test Loss: 0.314 Test Acc: 0.960
Validation loss decreased (-0.846650 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 13.982905149459839
Epoch: 3, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 12.898923635482788
Epoch: 4, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.323701620101929
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 12.52253532409668
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 11.85962200164795
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 12.855982542037964
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 13.111148834228516
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 11.572096824645996
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 12.35753870010376
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 13.370656490325928
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 13.387179851531982
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 11.15367579460144
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 10.781457901000977
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 12.910336971282959
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 11.288823366165161
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 12.800974369049072
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.04300594329834
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.875391721725464
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.06339168548584
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 11.851511001586914
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 11.627447843551636
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 13.37300181388855
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 11.479366540908813
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 12.08609676361084
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.289205551147461
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 13.143948793411255
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 12.965501546859741
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 13.376370906829834
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 11479193
model size : 46.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 20.252657890319824
Epoch: 1, Steps: 18 | Train Loss: 2.868 Vali Loss: 1.664 Vali Acc: 0.880 Test Loss: 1.664 Test Acc: 0.880
Validation loss decreased (inf --> -0.879983).  Saving model ...
Epoch: 2 cost time: 15.856967449188232
Epoch: 2, Steps: 18 | Train Loss: 0.821 Vali Loss: 0.307 Vali Acc: 0.960 Test Loss: 0.307 Test Acc: 0.960
Validation loss decreased (-0.879983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 16.008286237716675
Epoch: 3, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959999).  Saving model ...
Epoch: 4 cost time: 18.476240396499634
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.959999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 17.484479188919067
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.293009281158447
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 7 cost time: 17.94570016860962
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.214599132537842
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.02366304397583
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.5161190032959
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 17.71428608894348
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.49970293045044
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.46377444267273
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.19234609603882
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.472729921340942
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 15.728500604629517
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 37957785
model size : 147.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.97917127609253
Epoch: 1, Steps: 18 | Train Loss: 2.907 Vali Loss: 1.693 Vali Acc: 0.847 Test Loss: 1.693 Test Acc: 0.847
Validation loss decreased (inf --> -0.846650).  Saving model ...
Epoch: 2 cost time: 7.046499252319336
Epoch: 2, Steps: 18 | Train Loss: 0.916 Vali Loss: 0.314 Vali Acc: 0.960 Test Loss: 0.314 Test Acc: 0.960
Validation loss decreased (-0.846650 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 7.899897336959839
Epoch: 3, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 7.976771116256714
Epoch: 4, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.743739128112793
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 7.764131546020508
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 7.807158470153809
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 8.5704984664917
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 8.568773746490479
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 7.529245615005493
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 8.21118974685669
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 7.971429347991943
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 8.772751331329346
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 8.393144607543945
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 7.753073215484619
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 8.14043664932251
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 7.6963512897491455
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 8.194488763809204
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.09516978263855
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.642610311508179
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.264467716217041
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 8.168816089630127
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 8.768583059310913
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.412522792816162
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 7.643740892410278
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 7.445711612701416
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.713521480560303
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.426457643508911
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 7.890404939651489
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.281322240829468
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 11479193
model size : 46.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 42.5624258518219
Epoch: 1, Steps: 18 | Train Loss: 3.128 Vali Loss: 2.345 Vali Acc: 0.667 Test Loss: 2.345 Test Acc: 0.667
Validation loss decreased (inf --> -0.666643).  Saving model ...
Epoch: 2 cost time: 39.386778593063354
Epoch: 2, Steps: 18 | Train Loss: 1.593 Vali Loss: 0.875 Vali Acc: 0.957 Test Loss: 0.875 Test Acc: 0.957
Validation loss decreased (-0.666643 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 38.68181395530701
Epoch: 3, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.267 Vali Acc: 0.967 Test Loss: 0.267 Test Acc: 0.967
Validation loss decreased (-0.956658 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 39.79314136505127
Epoch: 4, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 40.590633392333984
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 39.636845111846924
Epoch: 6, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 42.08900570869446
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 40.256890296936035
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 40.99206256866455
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 40.61031651496887
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 38.92275667190552
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 38.47449588775635
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 36.30349159240723
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 36.616528034210205
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 40.71622180938721
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 40.57030463218689
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 40.259467124938965
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 39.972060203552246
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 38.28233551979065
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 36.543561697006226
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 36.44130563735962
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 37.80594348907471
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 38.55470323562622
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 39.64778733253479
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 38.362090826034546
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 38.69690203666687
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 38.61358404159546
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 37.52296018600464
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 39.05304670333862
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 38.37495946884155
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 37726809
model size : 145.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 17.908138036727905
Epoch: 1, Steps: 18 | Train Loss: 3.108 Vali Loss: 2.338 Vali Acc: 0.637 Test Loss: 2.338 Test Acc: 0.637
Validation loss decreased (inf --> -0.636643).  Saving model ...
Epoch: 2 cost time: 16.377957344055176
Epoch: 2, Steps: 18 | Train Loss: 1.628 Vali Loss: 0.882 Vali Acc: 0.937 Test Loss: 0.882 Test Acc: 0.937
Validation loss decreased (-0.636643 --> -0.936658).  Saving model ...
Epoch: 3 cost time: 16.26959538459778
Epoch: 3, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.265 Vali Acc: 0.977 Test Loss: 0.265 Test Acc: 0.977
Validation loss decreased (-0.936658 --> -0.976664).  Saving model ...
Epoch: 4 cost time: 16.886849880218506
Epoch: 4, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.855823993682861
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.976664 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 15.876576662063599
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.579434871673584
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.400540351867676
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 15.208823204040527
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 16.09558916091919
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 16.01339101791382
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 16.25699734687805
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 15.699997901916504
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.833638191223145
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 15.947408437728882
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 16.04023551940918
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 15.87721848487854
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 15.713505506515503
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 15.566793441772461
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 15.16280198097229
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.642045974731445
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 14.896036148071289
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 15.009653329849243
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 15.303443908691406
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 15.37367558479309
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 15.674161911010742
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 15.607367038726807
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 15.1167733669281
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 15.475003957748413
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 16.370779752731323
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 11247705
model size : 44.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 31.222315788269043
Epoch: 1, Steps: 18 | Train Loss: 3.128 Vali Loss: 2.345 Vali Acc: 0.667 Test Loss: 2.345 Test Acc: 0.667
Validation loss decreased (inf --> -0.666643).  Saving model ...
Epoch: 2 cost time: 28.387908935546875
Epoch: 2, Steps: 18 | Train Loss: 1.593 Vali Loss: 0.875 Vali Acc: 0.957 Test Loss: 0.875 Test Acc: 0.957
Validation loss decreased (-0.666643 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 24.923829317092896
Epoch: 3, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.267 Vali Acc: 0.967 Test Loss: 0.267 Test Acc: 0.967
Validation loss decreased (-0.956658 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 25.16988706588745
Epoch: 4, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 26.192058801651
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 29.105159759521484
Epoch: 6, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 29.172312259674072
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 29.232019901275635
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 30.885530710220337
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 31.598934173583984
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 30.601779460906982
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 33.00801181793213
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 29.138243675231934
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 33.07932376861572
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 31.76761221885681
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 31.304884910583496
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 31.535041332244873
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 29.198930740356445
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 31.468153715133667
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 31.433425903320312
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 27.6001718044281
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 27.83400797843933
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 31.311468601226807
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 29.05231475830078
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 30.29525351524353
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 31.292524099349976
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 30.16046714782715
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 28.725950241088867
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 27.86258101463318
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 26.01233744621277
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 37726809
model size : 145.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 16.15113353729248
Epoch: 1, Steps: 18 | Train Loss: 3.108 Vali Loss: 2.338 Vali Acc: 0.637 Test Loss: 2.338 Test Acc: 0.637
Validation loss decreased (inf --> -0.636643).  Saving model ...
Epoch: 2 cost time: 14.354331016540527
Epoch: 2, Steps: 18 | Train Loss: 1.628 Vali Loss: 0.882 Vali Acc: 0.937 Test Loss: 0.882 Test Acc: 0.937
Validation loss decreased (-0.636643 --> -0.936658).  Saving model ...
Epoch: 3 cost time: 12.465500354766846
Epoch: 3, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.265 Vali Acc: 0.977 Test Loss: 0.265 Test Acc: 0.977
Validation loss decreased (-0.936658 --> -0.976664).  Saving model ...
Epoch: 4 cost time: 13.414032936096191
Epoch: 4, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.674527883529663
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.976664 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 13.650489091873169
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.950997114181519
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.861268997192383
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 12.349012613296509
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 12.80333924293518
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 13.206174612045288
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 13.033335208892822
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 12.689034223556519
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.667280673980713
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 11.917620658874512
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 11.56890320777893
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 12.895357847213745
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 13.014449119567871
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 13.0358247756958
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.692140340805054
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.68021821975708
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 13.81775712966919
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 12.643849611282349
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 12.850853681564331
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 12.996536254882812
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 13.99157190322876
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 13.47269582748413
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 13.572878122329712
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 13.710378885269165
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 13.779573917388916
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 11247705
model size : 44.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 18.572991609573364
Epoch: 1, Steps: 18 | Train Loss: 3.128 Vali Loss: 2.345 Vali Acc: 0.663 Test Loss: 2.345 Test Acc: 0.663
Validation loss decreased (inf --> -0.663310).  Saving model ...
Epoch: 2 cost time: 17.16085696220398
Epoch: 2, Steps: 18 | Train Loss: 1.593 Vali Loss: 0.875 Vali Acc: 0.957 Test Loss: 0.875 Test Acc: 0.957
Validation loss decreased (-0.663310 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 17.182833433151245
Epoch: 3, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.266 Vali Acc: 0.967 Test Loss: 0.266 Test Acc: 0.967
Validation loss decreased (-0.956658 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 18.05016016960144
Epoch: 4, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 17.867742776870728
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 18.214529275894165
Epoch: 6, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.96273374557495
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 19.432248830795288
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.215038537979126
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.482577323913574
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.415283918380737
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.12855863571167
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.059525489807129
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.540691137313843
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.927953958511353
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.562217473983765
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 17.32137393951416
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37726809
model size : 145.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.37162733078003
Epoch: 1, Steps: 18 | Train Loss: 3.108 Vali Loss: 2.338 Vali Acc: 0.637 Test Loss: 2.338 Test Acc: 0.637
Validation loss decreased (inf --> -0.636643).  Saving model ...
Epoch: 2 cost time: 7.729588985443115
Epoch: 2, Steps: 18 | Train Loss: 1.628 Vali Loss: 0.882 Vali Acc: 0.937 Test Loss: 0.882 Test Acc: 0.937
Validation loss decreased (-0.636643 --> -0.936658).  Saving model ...
Epoch: 3 cost time: 7.0987324714660645
Epoch: 3, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.265 Vali Acc: 0.977 Test Loss: 0.265 Test Acc: 0.977
Validation loss decreased (-0.936658 --> -0.976664).  Saving model ...
Epoch: 4 cost time: 7.636972188949585
Epoch: 4, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.208744287490845
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.976664 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 8.317481994628906
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.5295350551605225
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.972743272781372
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 7.907506942749023
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 7.675382614135742
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 8.362300872802734
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.449691772460938
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 8.430281162261963
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.585222959518433
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 8.038735151290894
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 7.3156211376190186
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 7.720949411392212
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 8.059592485427856
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 7.780240774154663
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.158095359802246
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.689847707748413
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 7.53818678855896
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 7.997495412826538
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 7.585955619812012
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.216393947601318
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 7.396398544311523
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.422245979309082
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.6365907192230225
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.892348766326904
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 8.313628435134888
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 11247705
model size : 44.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 24.478450536727905
Epoch: 1, Steps: 18 | Train Loss: 3.056 Vali Loss: 2.371 Vali Acc: 0.657 Test Loss: 2.371 Test Acc: 0.657
Validation loss decreased (inf --> -0.656643).  Saving model ...
Epoch: 2 cost time: 22.755526065826416
Epoch: 2, Steps: 18 | Train Loss: 1.641 Vali Loss: 0.935 Vali Acc: 0.937 Test Loss: 0.935 Test Acc: 0.937
Validation loss decreased (-0.656643 --> -0.936657).  Saving model ...
Epoch: 3 cost time: 23.639538526535034
Epoch: 3, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.286 Vali Acc: 0.953 Test Loss: 0.286 Test Acc: 0.953
Validation loss decreased (-0.936657 --> -0.953330).  Saving model ...
Epoch: 4 cost time: 21.4173686504364
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.953330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 19.51082134246826
Epoch: 5, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 19.036500215530396
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 20.22247052192688
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 22.39180898666382
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 22.088260889053345
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 21.51486587524414
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 22.57010579109192
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 21.6374294757843
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 21.949106216430664
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 21.543412446975708
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 20.69125771522522
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 20.214591026306152
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 20.23797917366028
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 21.042863130569458
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 22.446833610534668
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 22.749790906906128
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 20.71293807029724
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 21.02855920791626
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 20.59483504295349
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 21.977084159851074
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 21.488592863082886
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 20.460190773010254
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 20.60495901107788
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 20.84196710586548
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 21.088176727294922
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 22.701637744903564
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 18980441
model size : 73.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 15.256188154220581
Epoch: 1, Steps: 18 | Train Loss: 3.044 Vali Loss: 2.311 Vali Acc: 0.740 Test Loss: 2.311 Test Acc: 0.740
Validation loss decreased (inf --> -0.739977).  Saving model ...
Epoch: 2 cost time: 13.119610786437988
Epoch: 2, Steps: 18 | Train Loss: 1.608 Vali Loss: 0.871 Vali Acc: 0.957 Test Loss: 0.871 Test Acc: 0.957
Validation loss decreased (-0.739977 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 12.499186515808105
Epoch: 3, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.273 Vali Acc: 0.973 Test Loss: 0.273 Test Acc: 0.973
Validation loss decreased (-0.956658 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 11.998135089874268
Epoch: 4, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.8755784034729
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 11.891381740570068
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 11.79281735420227
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.70913577079773
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.16483187675476
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.328623533248901
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.268045902252197
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.262709140777588
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.570395469665527
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.339195013046265
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.08065390586853
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.795195579528809
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5740633
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 22.234315395355225
Epoch: 1, Steps: 18 | Train Loss: 3.056 Vali Loss: 2.371 Vali Acc: 0.657 Test Loss: 2.371 Test Acc: 0.657
Validation loss decreased (inf --> -0.656643).  Saving model ...
Epoch: 2 cost time: 19.638473987579346
Epoch: 2, Steps: 18 | Train Loss: 1.641 Vali Loss: 0.935 Vali Acc: 0.937 Test Loss: 0.935 Test Acc: 0.937
Validation loss decreased (-0.656643 --> -0.936657).  Saving model ...
Epoch: 3 cost time: 20.393901824951172
Epoch: 3, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.286 Vali Acc: 0.953 Test Loss: 0.286 Test Acc: 0.953
Validation loss decreased (-0.936657 --> -0.953330).  Saving model ...
Epoch: 4 cost time: 21.562613010406494
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.953330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 21.816988945007324
Epoch: 5, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 21.112876415252686
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 20.635969638824463
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 20.765666723251343
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 20.379295110702515
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 21.071678161621094
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 21.453843355178833
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 20.75194787979126
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 20.672202348709106
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 20.384787797927856
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 19.719698667526245
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 19.446446180343628
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 20.368814706802368
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 21.58381223678589
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 21.40381932258606
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 21.825326681137085
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.364815950393677
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 20.610849380493164
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 20.111795663833618
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 20.888057708740234
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 20.30829405784607
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 20.348777055740356
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 17.241610765457153
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 20.57860803604126
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 20.777662992477417
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 21.114302396774292
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 18980441
model size : 73.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.925519704818726
Epoch: 1, Steps: 18 | Train Loss: 3.044 Vali Loss: 2.311 Vali Acc: 0.740 Test Loss: 2.311 Test Acc: 0.740
Validation loss decreased (inf --> -0.739977).  Saving model ...
Epoch: 2 cost time: 10.57718014717102
Epoch: 2, Steps: 18 | Train Loss: 1.608 Vali Loss: 0.871 Vali Acc: 0.957 Test Loss: 0.871 Test Acc: 0.957
Validation loss decreased (-0.739977 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 10.601238012313843
Epoch: 3, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.273 Vali Acc: 0.973 Test Loss: 0.273 Test Acc: 0.973
Validation loss decreased (-0.956658 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 10.708030462265015
Epoch: 4, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.761372566223145
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 10.381844758987427
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 10.329805374145508
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.727983951568604
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.826464891433716
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.024731397628784
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.868294477462769
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.915815353393555
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.797083854675293
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.900486707687378
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.872881650924683
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.958069086074829
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5740633
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 15.766173839569092
Epoch: 1, Steps: 18 | Train Loss: 3.056 Vali Loss: 2.371 Vali Acc: 0.657 Test Loss: 2.371 Test Acc: 0.657
Validation loss decreased (inf --> -0.656643).  Saving model ...
Epoch: 2 cost time: 14.522678136825562
Epoch: 2, Steps: 18 | Train Loss: 1.641 Vali Loss: 0.935 Vali Acc: 0.937 Test Loss: 0.935 Test Acc: 0.937
Validation loss decreased (-0.656643 --> -0.936657).  Saving model ...
Epoch: 3 cost time: 13.817829370498657
Epoch: 3, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.286 Vali Acc: 0.953 Test Loss: 0.286 Test Acc: 0.953
Validation loss decreased (-0.936657 --> -0.953330).  Saving model ...
Epoch: 4 cost time: 13.709481954574585
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.953330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 13.899788618087769
Epoch: 5, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 14.086173057556152
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 13.898534059524536
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 13.492152214050293
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 14.06902289390564
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 14.227959632873535
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 13.601784706115723
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 13.759745359420776
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 13.679573059082031
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 13.80855393409729
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 13.750768661499023
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 13.835777521133423
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 13.805288314819336
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 13.88852334022522
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 13.81052827835083
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 14.396200180053711
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.36550498008728
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.934738874435425
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 13.753105163574219
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 13.653530359268188
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 13.813154935836792
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 13.686300992965698
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 13.450109004974365
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 13.673821210861206
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 14.467410802841187
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 13.874101877212524
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 18980441
model size : 73.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.140674114227295
Epoch: 1, Steps: 18 | Train Loss: 3.044 Vali Loss: 2.311 Vali Acc: 0.740 Test Loss: 2.311 Test Acc: 0.740
Validation loss decreased (inf --> -0.739977).  Saving model ...
Epoch: 2 cost time: 7.304321527481079
Epoch: 2, Steps: 18 | Train Loss: 1.608 Vali Loss: 0.871 Vali Acc: 0.957 Test Loss: 0.871 Test Acc: 0.957
Validation loss decreased (-0.739977 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 7.251517057418823
Epoch: 3, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.273 Vali Acc: 0.973 Test Loss: 0.273 Test Acc: 0.973
Validation loss decreased (-0.956658 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 7.055621385574341
Epoch: 4, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.048918724060059
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 7.085713863372803
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 7.023770332336426
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.992101430892944
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.029078960418701
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.033826112747192
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.04721736907959
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.241619110107422
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.2505316734313965
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.117695331573486
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.350662469863892
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.361734867095947
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5740633
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 20.89052414894104
Epoch: 1, Steps: 18 | Train Loss: 3.003 Vali Loss: 2.352 Vali Acc: 0.720 Test Loss: 2.352 Test Acc: 0.720
Validation loss decreased (inf --> -0.719976).  Saving model ...
Epoch: 2 cost time: 19.004477500915527
Epoch: 2, Steps: 18 | Train Loss: 1.658 Vali Loss: 0.964 Vali Acc: 0.957 Test Loss: 0.964 Test Acc: 0.957
Validation loss decreased (-0.719976 --> -0.956657).  Saving model ...
Epoch: 3 cost time: 18.98050355911255
Epoch: 3, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.316 Vali Acc: 0.957 Test Loss: 0.316 Test Acc: 0.957
Validation loss decreased (-0.956657 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 18.893467903137207
Epoch: 4, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.956664 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 18.528916835784912
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 18.149203777313232
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 18.429186582565308
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.95755958557129
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 17.511361598968506
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 17.613377332687378
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 17.43636918067932
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 17.436703205108643
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 17.841267108917236
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 17.34679079055786
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 17.791795015335083
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 18.70005750656128
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 18.781577110290527
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 18.693238735198975
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 18.357098817825317
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 17.556929349899292
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 16.790608882904053
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 16.869936227798462
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 17.43204402923584
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 17.568366050720215
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 17.984942197799683
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 18.049182891845703
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 18.45167636871338
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 17.404730558395386
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 16.562658309936523
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 18.81375765800476
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9607257
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.07094931602478
Epoch: 1, Steps: 18 | Train Loss: 2.984 Vali Loss: 2.330 Vali Acc: 0.687 Test Loss: 2.330 Test Acc: 0.687
Validation loss decreased (inf --> -0.686643).  Saving model ...
Epoch: 2 cost time: 9.053117990493774
Epoch: 2, Steps: 18 | Train Loss: 1.678 Vali Loss: 0.962 Vali Acc: 0.927 Test Loss: 0.962 Test Acc: 0.927
Validation loss decreased (-0.686643 --> -0.926657).  Saving model ...
Epoch: 3 cost time: 8.8720383644104
Epoch: 3, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.926657 --> -0.949997).  Saving model ...
Epoch: 4 cost time: 8.960432291030884
Epoch: 4, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.949997 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 9.062258005142212
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 8.1400465965271
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 7.982371091842651
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 8.101784467697144
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.410763502120972
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 8.510389566421509
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 8.738447666168213
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 8.838600873947144
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 8.698272466659546
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 8.71360993385315
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.782076120376587
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 8.819308757781982
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 8.678578615188599
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 8.543433904647827
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 8.443765640258789
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 8.01485538482666
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 8.276676177978516
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 7.114392042160034
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 8.8292977809906
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 8.250999212265015
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 9.030597448348999
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 8.876568794250488
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.968908548355103
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 9.026653289794922
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 9.080708503723145
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 9.09435749053955
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2987097
model size : 12.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.764760732650757
Epoch: 1, Steps: 18 | Train Loss: 3.003 Vali Loss: 2.352 Vali Acc: 0.720 Test Loss: 2.352 Test Acc: 0.720
Validation loss decreased (inf --> -0.719976).  Saving model ...
Epoch: 2 cost time: 12.81700325012207
Epoch: 2, Steps: 18 | Train Loss: 1.658 Vali Loss: 0.964 Vali Acc: 0.957 Test Loss: 0.964 Test Acc: 0.957
Validation loss decreased (-0.719976 --> -0.956657).  Saving model ...
Epoch: 3 cost time: 12.83718204498291
Epoch: 3, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.316 Vali Acc: 0.957 Test Loss: 0.316 Test Acc: 0.957
Validation loss decreased (-0.956657 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 13.5858793258667
Epoch: 4, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.956664 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 13.673080205917358
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 13.757875680923462
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 13.254843711853027
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.049724340438843
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 12.81480884552002
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 12.792232513427734
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 12.755182027816772
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 12.524275064468384
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 13.536361455917358
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 13.813508749008179
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 14.098241806030273
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 14.068817615509033
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 14.077328205108643
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 12.851088762283325
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 12.695569276809692
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 12.712997198104858
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 13.506910800933838
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 13.338386535644531
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 13.323433876037598
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 13.346695184707642
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 13.339199304580688
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 13.610249757766724
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.89037036895752
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 12.696208715438843
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 12.935994863510132
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 13.741319179534912
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9607257
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.116712093353271
Epoch: 1, Steps: 18 | Train Loss: 2.984 Vali Loss: 2.330 Vali Acc: 0.687 Test Loss: 2.330 Test Acc: 0.687
Validation loss decreased (inf --> -0.686643).  Saving model ...
Epoch: 2 cost time: 7.354857683181763
Epoch: 2, Steps: 18 | Train Loss: 1.678 Vali Loss: 0.962 Vali Acc: 0.927 Test Loss: 0.962 Test Acc: 0.927
Validation loss decreased (-0.686643 --> -0.926657).  Saving model ...
Epoch: 3 cost time: 7.369447469711304
Epoch: 3, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.926657 --> -0.949997).  Saving model ...
Epoch: 4 cost time: 7.36833643913269
Epoch: 4, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.949997 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 7.349256992340088
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 7.466447353363037
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 6.949776649475098
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 6.711277961730957
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.720287561416626
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 6.679325342178345
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 6.699233770370483
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 6.5543811321258545
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 6.9399638175964355
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 6.781067371368408
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.0884034633636475
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 7.020301103591919
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 6.965225458145142
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 7.189051866531372
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 7.01677680015564
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 7.458782196044922
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 7.511795282363892
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 7.146301746368408
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 6.954096078872681
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 6.84295916557312
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 6.9113852977752686
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 6.955988883972168
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.186776638031006
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.28853964805603
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.114274024963379
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.377855062484741
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2987097
model size : 12.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.3562593460083
Epoch: 1, Steps: 18 | Train Loss: 3.003 Vali Loss: 2.352 Vali Acc: 0.720 Test Loss: 2.352 Test Acc: 0.720
Validation loss decreased (inf --> -0.719976).  Saving model ...
Epoch: 2 cost time: 9.124282836914062
Epoch: 2, Steps: 18 | Train Loss: 1.658 Vali Loss: 0.964 Vali Acc: 0.957 Test Loss: 0.964 Test Acc: 0.957
Validation loss decreased (-0.719976 --> -0.956657).  Saving model ...
Epoch: 3 cost time: 8.840626239776611
Epoch: 3, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.316 Vali Acc: 0.957 Test Loss: 0.316 Test Acc: 0.957
Validation loss decreased (-0.956657 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 8.378442525863647
Epoch: 4, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.956664 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 8.336602449417114
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 8.287299394607544
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 8.43062138557434
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.421031951904297
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 8.732854127883911
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 8.917333364486694
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 8.049489498138428
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 9.213661670684814
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 9.03976583480835
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 9.478962898254395
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 9.53566575050354
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 8.961232423782349
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 8.928013801574707
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 8.92491865158081
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 8.896517992019653
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 8.797477006912231
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 9.294066905975342
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.024705648422241
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 9.100245237350464
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 9.11471962928772
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 9.126856088638306
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 8.729419469833374
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 8.712307929992676
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 8.27933669090271
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 8.252234697341919
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 8.094880819320679
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9607257
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.869470596313477
Epoch: 1, Steps: 18 | Train Loss: 2.984 Vali Loss: 2.330 Vali Acc: 0.687 Test Loss: 2.330 Test Acc: 0.687
Validation loss decreased (inf --> -0.686643).  Saving model ...
Epoch: 2 cost time: 5.340713977813721
Epoch: 2, Steps: 18 | Train Loss: 1.678 Vali Loss: 0.962 Vali Acc: 0.927 Test Loss: 0.962 Test Acc: 0.927
Validation loss decreased (-0.686643 --> -0.926657).  Saving model ...
Epoch: 3 cost time: 5.31417441368103
Epoch: 3, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.926657 --> -0.949997).  Saving model ...
Epoch: 4 cost time: 5.278240203857422
Epoch: 4, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.949997 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 5.399248123168945
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 5.370006322860718
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 5.433147430419922
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 5.564612150192261
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.623184442520142
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 5.506245136260986
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 5.594095945358276
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 5.618741035461426
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 5.315136432647705
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 5.337395191192627
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.2358314990997314
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 5.282001256942749
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 5.233566522598267
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 5.339799404144287
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 5.5192649364471436
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 5.669732570648193
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 5.438523054122925
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 5.3869335651397705
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 5.3938727378845215
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 5.4029552936553955
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 5.11902117729187
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 5.33318829536438
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.293060541152954
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.253134489059448
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.1456263065338135
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.059228181838989
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2987097
model size : 12.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 18.546847343444824
Epoch: 1, Steps: 18 | Train Loss: 3.134 Vali Loss: 2.746 Vali Acc: 0.357 Test Loss: 2.746 Test Acc: 0.357
Validation loss decreased (inf --> -0.356639).  Saving model ...
Epoch: 2 cost time: 16.738649129867554
Epoch: 2, Steps: 18 | Train Loss: 2.311 Vali Loss: 1.808 Vali Acc: 0.827 Test Loss: 1.808 Test Acc: 0.827
Validation loss decreased (-0.356639 --> -0.826649).  Saving model ...
Epoch: 3 cost time: 17.936665534973145
Epoch: 3, Steps: 18 | Train Loss: 1.360 Vali Loss: 0.962 Vali Acc: 0.933 Test Loss: 0.962 Test Acc: 0.933
Validation loss decreased (-0.826649 --> -0.933324).  Saving model ...
Epoch: 4 cost time: 18.595895767211914
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.421 Vali Acc: 0.957 Test Loss: 0.421 Test Acc: 0.957
Validation loss decreased (-0.933324 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 17.65506386756897
Epoch: 5, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.232 Vali Acc: 0.973 Test Loss: 0.232 Test Acc: 0.973
Validation loss decreased (-0.956662 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 18.205543756484985
Epoch: 6, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 17.282154083251953
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.150776386260986
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 17.225658655166626
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 18.34816002845764
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 17.607306718826294
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 17.1291184425354
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 17.486453533172607
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 14.435126304626465
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 16.419538021087646
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 16.13326382637024
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 17.52624273300171
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 17.39566683769226
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 18.0678608417511
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 18.18711018562317
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 17.35360836982727
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 16.60249972343445
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 17.474676847457886
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 18.442179679870605
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 17.587596654891968
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 17.757708311080933
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 17.118964672088623
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 16.93348240852356
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 16.130411863327026
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 15.67427659034729
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9491769
model size : 36.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.03210186958313
Epoch: 1, Steps: 18 | Train Loss: 3.191 Vali Loss: 2.820 Vali Acc: 0.327 Test Loss: 2.820 Test Acc: 0.327
Validation loss decreased (inf --> -0.326638).  Saving model ...
Epoch: 2 cost time: 9.00334882736206
Epoch: 2, Steps: 18 | Train Loss: 2.388 Vali Loss: 1.834 Vali Acc: 0.850 Test Loss: 1.834 Test Acc: 0.850
Validation loss decreased (-0.326638 --> -0.849982).  Saving model ...
Epoch: 3 cost time: 8.991595268249512
Epoch: 3, Steps: 18 | Train Loss: 1.328 Vali Loss: 0.911 Vali Acc: 0.930 Test Loss: 0.911 Test Acc: 0.930
Validation loss decreased (-0.849982 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 9.030616044998169
Epoch: 4, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.403 Vali Acc: 0.963 Test Loss: 0.403 Test Acc: 0.963
Validation loss decreased (-0.929991 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 9.238895654678345
Epoch: 5, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.228 Vali Acc: 0.973 Test Loss: 0.228 Test Acc: 0.973
Validation loss decreased (-0.963329 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 9.3917236328125
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 9.040820598602295
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.801716566085815
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.801488637924194
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.874622821807861
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.658727645874023
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.859203338623047
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 8.985612630844116
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.148571014404297
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.08726167678833
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.800768852233887
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 8.648737668991089
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.86247968673706
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.945834875106812
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.264078617095947
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 8.103719711303711
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.464601278305054
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.588143110275269
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 9.126600503921509
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 9.218100786209106
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 9.042964458465576
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 9.156810998916626
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 9.269320726394653
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 9.216606616973877
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 9.271203994750977
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2871353
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.945809125900269
Epoch: 1, Steps: 18 | Train Loss: 3.134 Vali Loss: 2.746 Vali Acc: 0.357 Test Loss: 2.746 Test Acc: 0.357
Validation loss decreased (inf --> -0.356639).  Saving model ...
Epoch: 2 cost time: 13.084346055984497
Epoch: 2, Steps: 18 | Train Loss: 2.311 Vali Loss: 1.808 Vali Acc: 0.827 Test Loss: 1.808 Test Acc: 0.827
Validation loss decreased (-0.356639 --> -0.826649).  Saving model ...
Epoch: 3 cost time: 12.555147171020508
Epoch: 3, Steps: 18 | Train Loss: 1.360 Vali Loss: 0.962 Vali Acc: 0.933 Test Loss: 0.962 Test Acc: 0.933
Validation loss decreased (-0.826649 --> -0.933324).  Saving model ...
Epoch: 4 cost time: 13.031811475753784
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.421 Vali Acc: 0.957 Test Loss: 0.421 Test Acc: 0.957
Validation loss decreased (-0.933324 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 13.241057872772217
Epoch: 5, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.232 Vali Acc: 0.973 Test Loss: 0.232 Test Acc: 0.973
Validation loss decreased (-0.956662 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 13.05085301399231
Epoch: 6, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 12.971305847167969
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.160036087036133
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 13.225122213363647
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 12.737141370773315
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 12.882588148117065
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 13.000730991363525
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 13.805444240570068
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 13.555806159973145
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 13.730726957321167
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 13.738579750061035
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 13.432466506958008
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 13.217725038528442
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 10.033931732177734
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 12.424480676651001
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 12.393814086914062
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 13.147302150726318
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 13.199597835540771
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 13.150328159332275
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 13.12830376625061
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 13.071875095367432
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 13.866398096084595
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 13.23274278640747
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 13.20592999458313
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 13.293606519699097
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9491769
model size : 36.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.587352275848389
Epoch: 1, Steps: 18 | Train Loss: 3.191 Vali Loss: 2.820 Vali Acc: 0.327 Test Loss: 2.820 Test Acc: 0.327
Validation loss decreased (inf --> -0.326638).  Saving model ...
Epoch: 2 cost time: 6.344782114028931
Epoch: 2, Steps: 18 | Train Loss: 2.388 Vali Loss: 1.834 Vali Acc: 0.850 Test Loss: 1.834 Test Acc: 0.850
Validation loss decreased (-0.326638 --> -0.849982).  Saving model ...
Epoch: 3 cost time: 7.521007776260376
Epoch: 3, Steps: 18 | Train Loss: 1.328 Vali Loss: 0.911 Vali Acc: 0.930 Test Loss: 0.911 Test Acc: 0.930
Validation loss decreased (-0.849982 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 7.232560873031616
Epoch: 4, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.403 Vali Acc: 0.963 Test Loss: 0.403 Test Acc: 0.963
Validation loss decreased (-0.929991 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 7.526345729827881
Epoch: 5, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.228 Vali Acc: 0.973 Test Loss: 0.228 Test Acc: 0.973
Validation loss decreased (-0.963329 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 7.58894944190979
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 7.1725013256073
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.270293712615967
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.279933929443359
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.336871862411499
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.456535577774048
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.262251615524292
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 7.62707781791687
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.594529867172241
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.6834447383880615
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.7319440841674805
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 7.227871417999268
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.134918689727783
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.402554750442505
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.443751335144043
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 7.532834768295288
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.457742929458618
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.586623668670654
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 7.817661285400391
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 7.722078800201416
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 7.795491933822632
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 6.823676824569702
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.854811429977417
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 7.803922414779663
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 7.679285526275635
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2871353
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.170928239822388
Epoch: 1, Steps: 18 | Train Loss: 3.135 Vali Loss: 2.748 Vali Acc: 0.347 Test Loss: 2.748 Test Acc: 0.347
Validation loss decreased (inf --> -0.346639).  Saving model ...
Epoch: 2 cost time: 8.915775775909424
Epoch: 2, Steps: 18 | Train Loss: 2.318 Vali Loss: 1.812 Vali Acc: 0.830 Test Loss: 1.812 Test Acc: 0.830
Validation loss decreased (-0.346639 --> -0.829982).  Saving model ...
Epoch: 3 cost time: 8.895917892456055
Epoch: 3, Steps: 18 | Train Loss: 1.370 Vali Loss: 0.960 Vali Acc: 0.940 Test Loss: 0.960 Test Acc: 0.940
Validation loss decreased (-0.829982 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 9.20462942123413
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.417 Vali Acc: 0.960 Test Loss: 0.417 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959996).  Saving model ...
Epoch: 5 cost time: 8.874731063842773
Epoch: 5, Steps: 18 | Train Loss: 0.219 Vali Loss: 0.230 Vali Acc: 0.977 Test Loss: 0.230 Test Acc: 0.977
Validation loss decreased (-0.959996 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 8.488744735717773
Epoch: 6, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
Validation loss decreased (-0.976664 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 8.623761177062988
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.477628946304321
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 8.763092279434204
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 8.566987037658691
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 8.982126712799072
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.716577529907227
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 9.690017461776733
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.421295166015625
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 9.458480596542358
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 9.353167533874512
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 9.4579758644104
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 9.4205961227417
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 9.453648805618286
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.511979103088379
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.470181226730347
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 9.500384092330933
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 9.160468578338623
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 8.675090074539185
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.647527694702148
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 8.295085668563843
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 8.658706426620483
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.525622606277466
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 9.157439231872559
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 9.143614053726196
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 9491769
model size : 36.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.9623634815216064
Epoch: 1, Steps: 18 | Train Loss: 3.191 Vali Loss: 2.820 Vali Acc: 0.327 Test Loss: 2.820 Test Acc: 0.327
Validation loss decreased (inf --> -0.326638).  Saving model ...
Epoch: 2 cost time: 5.338002443313599
Epoch: 2, Steps: 18 | Train Loss: 2.388 Vali Loss: 1.834 Vali Acc: 0.850 Test Loss: 1.834 Test Acc: 0.850
Validation loss decreased (-0.326638 --> -0.849982).  Saving model ...
Epoch: 3 cost time: 5.271625280380249
Epoch: 3, Steps: 18 | Train Loss: 1.328 Vali Loss: 0.911 Vali Acc: 0.930 Test Loss: 0.911 Test Acc: 0.930
Validation loss decreased (-0.849982 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 5.366931915283203
Epoch: 4, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.403 Vali Acc: 0.963 Test Loss: 0.403 Test Acc: 0.963
Validation loss decreased (-0.929991 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 5.514644622802734
Epoch: 5, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.228 Vali Acc: 0.970 Test Loss: 0.228 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 5.4440226554870605
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 5.397702932357788
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.528867483139038
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.623029470443726
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.566977500915527
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.540746450424194
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.584359884262085
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 5.778233051300049
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.2672200202941895
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.286492586135864
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.278765439987183
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 5.337684154510498
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.262009859085083
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.454189777374268
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.477555990219116
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 5.26607084274292
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.292903661727905
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.592687129974365
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 5.594517707824707
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 5.636061429977417
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 5.5258777141571045
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 5.633603572845459
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.560150623321533
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.472856044769287
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 5.554184675216675
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2871353
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 13.862035512924194
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.781 Vali Acc: 0.293 Test Loss: 2.781 Test Acc: 0.293
Validation loss decreased (inf --> -0.293306).  Saving model ...
Epoch: 2 cost time: 12.135924100875854
Epoch: 2, Steps: 18 | Train Loss: 2.361 Vali Loss: 1.824 Vali Acc: 0.820 Test Loss: 1.824 Test Acc: 0.820
Validation loss decreased (-0.293306 --> -0.819982).  Saving model ...
Epoch: 3 cost time: 12.83110785484314
Epoch: 3, Steps: 18 | Train Loss: 1.384 Vali Loss: 0.938 Vali Acc: 0.930 Test Loss: 0.938 Test Acc: 0.930
Validation loss decreased (-0.819982 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 12.854087591171265
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.443 Vali Acc: 0.943 Test Loss: 0.443 Test Acc: 0.943
Validation loss decreased (-0.929991 --> -0.943329).  Saving model ...
Epoch: 5 cost time: 12.192957401275635
Epoch: 5, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.255 Vali Acc: 0.953 Test Loss: 0.255 Test Acc: 0.953
Validation loss decreased (-0.943329 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 12.099778175354004
Epoch: 6, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.953331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 12.073207378387451
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 12.386273622512817
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.791745662689209
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.32529878616333
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.297926425933838
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.84063196182251
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 12.888094186782837
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.73200011253357
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.444329977035522
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.403809785842896
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.537813663482666
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.383203029632568
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.788461685180664
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.76744532585144
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.79298710823059
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.765012264251709
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 4804409
model size : 18.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.362499475479126
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.822 Vali Acc: 0.290 Test Loss: 2.822 Test Acc: 0.290
Validation loss decreased (inf --> -0.289972).  Saving model ...
Epoch: 2 cost time: 7.0064473152160645
Epoch: 2, Steps: 18 | Train Loss: 2.378 Vali Loss: 1.873 Vali Acc: 0.837 Test Loss: 1.873 Test Acc: 0.837
Validation loss decreased (-0.289972 --> -0.836648).  Saving model ...
Epoch: 3 cost time: 7.189616680145264
Epoch: 3, Steps: 18 | Train Loss: 1.361 Vali Loss: 0.981 Vali Acc: 0.947 Test Loss: 0.981 Test Acc: 0.947
Validation loss decreased (-0.836648 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 7.152621030807495
Epoch: 4, Steps: 18 | Train Loss: 0.597 Vali Loss: 0.461 Vali Acc: 0.963 Test Loss: 0.461 Test Acc: 0.963
Validation loss decreased (-0.946657 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 7.1593101024627686
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.253 Vali Acc: 0.973 Test Loss: 0.253 Test Acc: 0.973
Validation loss decreased (-0.963329 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 7.180371284484863
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 7.169359922409058
Epoch: 7, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 7.142719268798828
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 7.25517201423645
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 7.1376824378967285
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 6.79633641242981
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 6.808940172195435
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 6.879190921783447
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 6.35595703125
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 6.478733539581299
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 6.429297924041748
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 6.4701924324035645
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 6.3695032596588135
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 6.840987682342529
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 6.791607141494751
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 6.989595174789429
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 7.224627256393433
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 7.2053258419036865
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 7.286255359649658
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 7.291382551193237
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 7.152757167816162
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 6.818983554840088
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 6.803269147872925
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.800178289413452
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 6.766000032424927
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1494073
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.99917483329773
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.781 Vali Acc: 0.293 Test Loss: 2.781 Test Acc: 0.293
Validation loss decreased (inf --> -0.293306).  Saving model ...
Epoch: 2 cost time: 9.06963849067688
Epoch: 2, Steps: 18 | Train Loss: 2.361 Vali Loss: 1.824 Vali Acc: 0.820 Test Loss: 1.824 Test Acc: 0.820
Validation loss decreased (-0.293306 --> -0.819982).  Saving model ...
Epoch: 3 cost time: 9.427556037902832
Epoch: 3, Steps: 18 | Train Loss: 1.384 Vali Loss: 0.938 Vali Acc: 0.930 Test Loss: 0.938 Test Acc: 0.930
Validation loss decreased (-0.819982 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 8.638200044631958
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.443 Vali Acc: 0.943 Test Loss: 0.443 Test Acc: 0.943
Validation loss decreased (-0.929991 --> -0.943329).  Saving model ...
Epoch: 5 cost time: 8.754650115966797
Epoch: 5, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.255 Vali Acc: 0.953 Test Loss: 0.255 Test Acc: 0.953
Validation loss decreased (-0.943329 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 8.455701112747192
Epoch: 6, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.953331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 8.781431198120117
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 8.952521085739136
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.779498815536499
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.008403301239014
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.97272253036499
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.978439331054688
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 9.098931550979614
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.004684209823608
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.194307565689087
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.78554105758667
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.64844536781311
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.625499963760376
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.682514667510986
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.63971471786499
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.52483582496643
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.028640508651733
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 4804409
model size : 18.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.787775754928589
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.822 Vali Acc: 0.290 Test Loss: 2.822 Test Acc: 0.290
Validation loss decreased (inf --> -0.289972).  Saving model ...
Epoch: 2 cost time: 5.002692461013794
Epoch: 2, Steps: 18 | Train Loss: 2.378 Vali Loss: 1.873 Vali Acc: 0.837 Test Loss: 1.873 Test Acc: 0.837
Validation loss decreased (-0.289972 --> -0.836648).  Saving model ...
Epoch: 3 cost time: 4.3721020221710205
Epoch: 3, Steps: 18 | Train Loss: 1.361 Vali Loss: 0.981 Vali Acc: 0.947 Test Loss: 0.981 Test Acc: 0.947
Validation loss decreased (-0.836648 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 4.9414143562316895
Epoch: 4, Steps: 18 | Train Loss: 0.597 Vali Loss: 0.461 Vali Acc: 0.963 Test Loss: 0.461 Test Acc: 0.963
Validation loss decreased (-0.946657 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 5.061536550521851
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.253 Vali Acc: 0.973 Test Loss: 0.253 Test Acc: 0.973
Validation loss decreased (-0.963329 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 5.1427624225616455
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 5.395259380340576
Epoch: 7, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 5.194884538650513
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 5.620425701141357
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 5.5854480266571045
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 5.592807054519653
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 5.611754655838013
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 5.797936677932739
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 5.795180797576904
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 5.755472421646118
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 5.9471447467803955
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 5.867430210113525
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 5.585406303405762
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 5.6168272495269775
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 5.6886584758758545
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 5.7845892906188965
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 5.340838432312012
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 5.322782278060913
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 5.414147853851318
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 5.317235231399536
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 5.285499811172485
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 5.6587347984313965
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 5.454988241195679
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.293309450149536
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 5.524085760116577
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1494073
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.54214596748352
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.781 Vali Acc: 0.293 Test Loss: 2.781 Test Acc: 0.293
Validation loss decreased (inf --> -0.293306).  Saving model ...
Epoch: 2 cost time: 6.796128511428833
Epoch: 2, Steps: 18 | Train Loss: 2.361 Vali Loss: 1.826 Vali Acc: 0.820 Test Loss: 1.826 Test Acc: 0.820
Validation loss decreased (-0.293306 --> -0.819982).  Saving model ...
Epoch: 3 cost time: 6.828698635101318
Epoch: 3, Steps: 18 | Train Loss: 1.385 Vali Loss: 0.940 Vali Acc: 0.930 Test Loss: 0.940 Test Acc: 0.930
Validation loss decreased (-0.819982 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 6.285471439361572
Epoch: 4, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.444 Vali Acc: 0.943 Test Loss: 0.444 Test Acc: 0.943
Validation loss decreased (-0.929991 --> -0.943329).  Saving model ...
Epoch: 5 cost time: 6.292708158493042
Epoch: 5, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.256 Vali Acc: 0.953 Test Loss: 0.256 Test Acc: 0.953
Validation loss decreased (-0.943329 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 6.24043607711792
Epoch: 6, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.953331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 6.2599945068359375
Epoch: 7, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 6.395348072052002
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.490992546081543
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.1471943855285645
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.407853841781616
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.252934694290161
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 6.818435430526733
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.462353706359863
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.49498438835144
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.391061305999756
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.361560821533203
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.572729110717773
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.434020042419434
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.161691188812256
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.61143946647644
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.5574095249176025
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 4804409
model size : 18.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.3446385860443115
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.822 Vali Acc: 0.290 Test Loss: 2.822 Test Acc: 0.290
Validation loss decreased (inf --> -0.289972).  Saving model ...
Epoch: 2 cost time: 4.528164625167847
Epoch: 2, Steps: 18 | Train Loss: 2.378 Vali Loss: 1.873 Vali Acc: 0.837 Test Loss: 1.873 Test Acc: 0.837
Validation loss decreased (-0.289972 --> -0.836648).  Saving model ...
Epoch: 3 cost time: 4.609618186950684
Epoch: 3, Steps: 18 | Train Loss: 1.362 Vali Loss: 0.981 Vali Acc: 0.947 Test Loss: 0.981 Test Acc: 0.947
Validation loss decreased (-0.836648 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 4.47847056388855
Epoch: 4, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.461 Vali Acc: 0.963 Test Loss: 0.461 Test Acc: 0.963
Validation loss decreased (-0.946657 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 4.750328302383423
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.252 Vali Acc: 0.970 Test Loss: 0.252 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 4.722322225570679
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 4.806451797485352
Epoch: 7, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 4.777720212936401
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 4.796950578689575
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 4.865593194961548
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 4.792517900466919
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 4.741705656051636
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 4.924860954284668
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.609239339828491
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.264693975448608
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.268629550933838
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 4.192668914794922
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 4.236018180847168
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.2647833824157715
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.296396017074585
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 4.344905853271484
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.3964197635650635
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 4.09934401512146
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 4.690546989440918
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 4.636157274246216
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 4.483246564865112
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 4.311408519744873
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 4.101724863052368
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 4.615025997161865
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 4.537352800369263
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1494073
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.433976411819458
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.789 Vali Acc: 0.387 Test Loss: 2.789 Test Acc: 0.387
Validation loss decreased (inf --> -0.386639).  Saving model ...
Epoch: 2 cost time: 8.65205717086792
Epoch: 2, Steps: 18 | Train Loss: 2.409 Vali Loss: 1.849 Vali Acc: 0.907 Test Loss: 1.849 Test Acc: 0.907
Validation loss decreased (-0.386639 --> -0.906648).  Saving model ...
Epoch: 3 cost time: 8.758771657943726
Epoch: 3, Steps: 18 | Train Loss: 1.401 Vali Loss: 0.941 Vali Acc: 0.960 Test Loss: 0.941 Test Acc: 0.960
Validation loss decreased (-0.906648 --> -0.959991).  Saving model ...
Epoch: 4 cost time: 8.070809841156006
Epoch: 4, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.423 Vali Acc: 0.970 Test Loss: 0.423 Test Acc: 0.970
Validation loss decreased (-0.959991 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 8.058631896972656
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 8.247941017150879
Epoch: 6, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.000333786010742
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 9.099516868591309
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 9.014113426208496
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 9.335158109664917
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 9.374301671981812
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 9.382721662521362
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 8.439831018447876
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 8.384738445281982
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 8.102656841278076
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 8.58431625366211
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 8.635449647903442
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.55616307258606
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.152966499328613
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.84535837173462
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.682544708251953
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.495048761367798
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.444241762161255
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.298765420913696
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 8.485417604446411
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.491162538528442
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2460729
model size : 10.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.80159330368042
Epoch: 1, Steps: 18 | Train Loss: 3.156 Vali Loss: 2.823 Vali Acc: 0.277 Test Loss: 2.823 Test Acc: 0.277
Validation loss decreased (inf --> -0.276638).  Saving model ...
Epoch: 2 cost time: 4.9944844245910645
Epoch: 2, Steps: 18 | Train Loss: 2.424 Vali Loss: 1.935 Vali Acc: 0.850 Test Loss: 1.935 Test Acc: 0.850
Validation loss decreased (-0.276638 --> -0.849981).  Saving model ...
Epoch: 3 cost time: 5.11625862121582
Epoch: 3, Steps: 18 | Train Loss: 1.478 Vali Loss: 1.104 Vali Acc: 0.937 Test Loss: 1.104 Test Acc: 0.937
Validation loss decreased (-0.849981 --> -0.936656).  Saving model ...
Epoch: 4 cost time: 5.16037392616272
Epoch: 4, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.559 Vali Acc: 0.950 Test Loss: 0.559 Test Acc: 0.950
Validation loss decreased (-0.936656 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 4.245068073272705
Epoch: 5, Steps: 18 | Train Loss: 0.305 Vali Loss: 0.318 Vali Acc: 0.957 Test Loss: 0.318 Test Acc: 0.957
Validation loss decreased (-0.949994 --> -0.956663).  Saving model ...
Epoch: 6 cost time: 3.9326274394989014
Epoch: 6, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
Validation loss decreased (-0.956663 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 5.162013053894043
Epoch: 7, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.166000843048096
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 5.491671800613403
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 5.542729377746582
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 5.25394082069397
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 5.126091718673706
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 5.021794080734253
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 5.137599468231201
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.876144886016846
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.7362449169158936
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 4.605003833770752
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 4.546130657196045
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.520930051803589
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.675342559814453
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 4.726074934005737
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 5.344797611236572
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 5.408298492431641
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 5.47032618522644
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 5.346888303756714
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.364367485046387
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.112566947937012
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 5.4218974113464355
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 4.436410665512085
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.598772287368774
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 805433
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.32612681388855
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.789 Vali Acc: 0.387 Test Loss: 2.789 Test Acc: 0.387
Validation loss decreased (inf --> -0.386639).  Saving model ...
Epoch: 2 cost time: 5.949797868728638
Epoch: 2, Steps: 18 | Train Loss: 2.409 Vali Loss: 1.849 Vali Acc: 0.907 Test Loss: 1.849 Test Acc: 0.907
Validation loss decreased (-0.386639 --> -0.906648).  Saving model ...
Epoch: 3 cost time: 6.2077553272247314
Epoch: 3, Steps: 18 | Train Loss: 1.401 Vali Loss: 0.941 Vali Acc: 0.960 Test Loss: 0.941 Test Acc: 0.960
Validation loss decreased (-0.906648 --> -0.959991).  Saving model ...
Epoch: 4 cost time: 6.08455491065979
Epoch: 4, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.423 Vali Acc: 0.970 Test Loss: 0.423 Test Acc: 0.970
Validation loss decreased (-0.959991 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 7.107303857803345
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 7.081284284591675
Epoch: 6, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.0504255294799805
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 7.1432647705078125
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 6.669423341751099
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 6.690549850463867
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 6.110495090484619
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 4.207001447677612
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 6.245845794677734
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 6.310218095779419
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 6.296360015869141
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 6.329164981842041
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 6.567643880844116
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.665972471237183
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.905824899673462
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.604495525360107
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.585818529129028
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.600126266479492
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.384135723114014
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.71201229095459
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.0131995677948
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.471156358718872
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2460729
model size : 10.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.899565696716309
Epoch: 1, Steps: 18 | Train Loss: 3.156 Vali Loss: 2.823 Vali Acc: 0.277 Test Loss: 2.823 Test Acc: 0.277
Validation loss decreased (inf --> -0.276638).  Saving model ...
Epoch: 2 cost time: 4.430234909057617
Epoch: 2, Steps: 18 | Train Loss: 2.424 Vali Loss: 1.935 Vali Acc: 0.850 Test Loss: 1.935 Test Acc: 0.850
Validation loss decreased (-0.276638 --> -0.849981).  Saving model ...
Epoch: 3 cost time: 4.165902853012085
Epoch: 3, Steps: 18 | Train Loss: 1.478 Vali Loss: 1.104 Vali Acc: 0.937 Test Loss: 1.104 Test Acc: 0.937
Validation loss decreased (-0.849981 --> -0.936656).  Saving model ...
Epoch: 4 cost time: 4.180724859237671
Epoch: 4, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.559 Vali Acc: 0.950 Test Loss: 0.559 Test Acc: 0.950
Validation loss decreased (-0.936656 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 4.186539173126221
Epoch: 5, Steps: 18 | Train Loss: 0.305 Vali Loss: 0.318 Vali Acc: 0.957 Test Loss: 0.318 Test Acc: 0.957
Validation loss decreased (-0.949994 --> -0.956663).  Saving model ...
Epoch: 6 cost time: 4.416882753372192
Epoch: 6, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
Validation loss decreased (-0.956663 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 4.121952056884766
Epoch: 7, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.42050838470459
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 4.373492479324341
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 4.510521650314331
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 3.8592019081115723
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 4.192441463470459
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 4.710557460784912
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.872556686401367
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.928788185119629
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.763545274734497
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 4.920328617095947
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 4.8171470165252686
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.587121963500977
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.440345048904419
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 4.807093858718872
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 5.101270914077759
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 5.108255863189697
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 5.069774150848389
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 5.212756633758545
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.039629936218262
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.945612192153931
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 5.042339086532593
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 4.86604380607605
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.494072914123535
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 805433
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.696244955062866
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.789 Vali Acc: 0.387 Test Loss: 2.789 Test Acc: 0.387
Validation loss decreased (inf --> -0.386639).  Saving model ...
Epoch: 2 cost time: 5.000599384307861
Epoch: 2, Steps: 18 | Train Loss: 2.409 Vali Loss: 1.849 Vali Acc: 0.907 Test Loss: 1.849 Test Acc: 0.907
Validation loss decreased (-0.386639 --> -0.906648).  Saving model ...
Epoch: 3 cost time: 5.022288084030151
Epoch: 3, Steps: 18 | Train Loss: 1.401 Vali Loss: 0.941 Vali Acc: 0.960 Test Loss: 0.941 Test Acc: 0.960
Validation loss decreased (-0.906648 --> -0.959991).  Saving model ...
Epoch: 4 cost time: 5.1397905349731445
Epoch: 4, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.422 Vali Acc: 0.970 Test Loss: 0.422 Test Acc: 0.970
Validation loss decreased (-0.959991 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 5.150290489196777
Epoch: 5, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 5.28056263923645
Epoch: 6, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.270233869552612
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 5.322246789932251
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 5.251691818237305
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 5.299097299575806
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 5.102189540863037
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 4.8321709632873535
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 4.911344051361084
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.784829378128052
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.926482915878296
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.947173833847046
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 5.224738359451294
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.411138296127319
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.4070961475372314
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.213916778564453
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.231964111328125
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.463789463043213
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.384925365447998
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.374252796173096
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.090256214141846
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.139326572418213
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2460729
model size : 10.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.129968643188477
Epoch: 1, Steps: 18 | Train Loss: 3.156 Vali Loss: 2.823 Vali Acc: 0.280 Test Loss: 2.823 Test Acc: 0.280
Validation loss decreased (inf --> -0.279972).  Saving model ...
Epoch: 2 cost time: 3.5030810832977295
Epoch: 2, Steps: 18 | Train Loss: 2.425 Vali Loss: 1.935 Vali Acc: 0.850 Test Loss: 1.935 Test Acc: 0.850
Validation loss decreased (-0.279972 --> -0.849981).  Saving model ...
Epoch: 3 cost time: 3.6934056282043457
Epoch: 3, Steps: 18 | Train Loss: 1.480 Vali Loss: 1.103 Vali Acc: 0.937 Test Loss: 1.103 Test Acc: 0.937
Validation loss decreased (-0.849981 --> -0.936656).  Saving model ...
Epoch: 4 cost time: 3.590763568878174
Epoch: 4, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.557 Vali Acc: 0.950 Test Loss: 0.557 Test Acc: 0.950
Validation loss decreased (-0.936656 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 3.5740749835968018
Epoch: 5, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.315 Vali Acc: 0.957 Test Loss: 0.315 Test Acc: 0.957
Validation loss decreased (-0.949994 --> -0.956664).  Saving model ...
Epoch: 6 cost time: 3.5810186862945557
Epoch: 6, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.216 Vali Acc: 0.973 Test Loss: 0.216 Test Acc: 0.973
Validation loss decreased (-0.956664 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 3.6308085918426514
Epoch: 7, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 3.720282554626465
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 3.6848063468933105
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 3.7473058700561523
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 3.730846881866455
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 3.6704742908477783
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 3.547955274581909
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.522482395172119
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4728798866271973
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 3.614792585372925
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 3.4996836185455322
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 3.109116315841675
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.2756736278533936
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.5894851684570312
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.554776668548584
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6094491481781006
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.6399753093719482
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.583306074142456
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.594529867172241
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.33852219581604
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.428919553756714
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.819822311401367
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.1036598682403564
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.573147773742676
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 805433
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.856136560440063
Epoch: 1, Steps: 18 | Train Loss: 3.202 Vali Loss: 2.973 Vali Acc: 0.143 Test Loss: 2.973 Test Acc: 0.143
Validation loss decreased (inf --> -0.143304).  Saving model ...
Epoch: 2 cost time: 10.108216762542725
Epoch: 2, Steps: 18 | Train Loss: 2.741 Vali Loss: 2.390 Vali Acc: 0.593 Test Loss: 2.390 Test Acc: 0.593
Validation loss decreased (-0.143304 --> -0.593309).  Saving model ...
Epoch: 3 cost time: 10.066473484039307
Epoch: 3, Steps: 18 | Train Loss: 2.110 Vali Loss: 1.722 Vali Acc: 0.857 Test Loss: 1.722 Test Acc: 0.857
Validation loss decreased (-0.593309 --> -0.856649).  Saving model ...
Epoch: 4 cost time: 8.74972414970398
Epoch: 4, Steps: 18 | Train Loss: 1.413 Vali Loss: 1.123 Vali Acc: 0.937 Test Loss: 1.123 Test Acc: 0.937
Validation loss decreased (-0.856649 --> -0.936655).  Saving model ...
Epoch: 5 cost time: 10.690168380737305
Epoch: 5, Steps: 18 | Train Loss: 0.846 Vali Loss: 0.672 Vali Acc: 0.957 Test Loss: 0.672 Test Acc: 0.957
Validation loss decreased (-0.936655 --> -0.956660).  Saving model ...
Epoch: 6 cost time: 10.683111906051636
Epoch: 6, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.419 Vali Acc: 0.953 Test Loss: 0.419 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.42098331451416
Epoch: 7, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.292 Vali Acc: 0.967 Test Loss: 0.292 Test Acc: 0.967
Validation loss decreased (-0.956660 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 10.674935817718506
Epoch: 8, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.238 Vali Acc: 0.970 Test Loss: 0.238 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 10.854856967926025
Epoch: 9, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 10.983432531356812
Epoch: 10, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 11.031823635101318
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 10.975751399993896
Epoch: 12, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.586506843566895
Epoch: 13, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.557811975479126
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.862001180648804
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 10.827703475952148
Epoch: 16, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.010841846466064
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.086649894714355
Epoch: 18, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.979886054992676
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.237024784088135
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 11.267156600952148
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 10.912921667098999
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.479403972625732
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 10.389110088348389
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 10.500753164291382
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.736863136291504
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 11.03724718093872
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.076133489608765
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 10.901170253753662
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 30 cost time: 10.852034568786621
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 2402985
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.675455808639526
Epoch: 1, Steps: 18 | Train Loss: 3.187 Vali Loss: 2.989 Vali Acc: 0.167 Test Loss: 2.989 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 5.859286069869995
Epoch: 2, Steps: 18 | Train Loss: 2.805 Vali Loss: 2.518 Vali Acc: 0.563 Test Loss: 2.518 Test Acc: 0.563
Validation loss decreased (-0.166637 --> -0.563308).  Saving model ...
Epoch: 3 cost time: 5.866535425186157
Epoch: 3, Steps: 18 | Train Loss: 2.236 Vali Loss: 1.959 Vali Acc: 0.777 Test Loss: 1.959 Test Acc: 0.777
Validation loss decreased (-0.563308 --> -0.776647).  Saving model ...
Epoch: 4 cost time: 5.728632688522339
Epoch: 4, Steps: 18 | Train Loss: 1.621 Vali Loss: 1.404 Vali Acc: 0.873 Test Loss: 1.404 Test Acc: 0.873
Validation loss decreased (-0.776647 --> -0.873319).  Saving model ...
Epoch: 5 cost time: 5.702209234237671
Epoch: 5, Steps: 18 | Train Loss: 1.030 Vali Loss: 0.925 Vali Acc: 0.907 Test Loss: 0.925 Test Acc: 0.907
Validation loss decreased (-0.873319 --> -0.906657).  Saving model ...
Epoch: 6 cost time: 5.8404316902160645
Epoch: 6, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.595 Vali Acc: 0.937 Test Loss: 0.595 Test Acc: 0.937
Validation loss decreased (-0.906657 --> -0.936661).  Saving model ...
Epoch: 7 cost time: 5.880872488021851
Epoch: 7, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.422 Vali Acc: 0.943 Test Loss: 0.422 Test Acc: 0.943
Validation loss decreased (-0.936661 --> -0.943329).  Saving model ...
Epoch: 8 cost time: 6.125956773757935
Epoch: 8, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.339 Vali Acc: 0.947 Test Loss: 0.339 Test Acc: 0.947
Validation loss decreased (-0.943329 --> -0.946663).  Saving model ...
Epoch: 9 cost time: 6.113009691238403
Epoch: 9, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.281 Vali Acc: 0.953 Test Loss: 0.281 Test Acc: 0.953
Validation loss decreased (-0.946663 --> -0.953331).  Saving model ...
Epoch: 10 cost time: 6.0931479930877686
Epoch: 10, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.953 Test Loss: 0.253 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 11 cost time: 6.104290008544922
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959998).  Saving model ...
Epoch: 12 cost time: 6.096480369567871
Epoch: 12, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.073166608810425
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 14 cost time: 5.879538536071777
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.702584505081177
Epoch: 15, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.678666830062866
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.661100149154663
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.731924295425415
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.687690258026123
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.69459342956543
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.638444662094116
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 5.6712141036987305
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.322788715362549
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 5.741920232772827
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.731415748596191
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 5.784870624542236
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.653331995010376
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.184624433517456
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.161812782287598
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.786421537399292
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 747561
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.530774354934692
Epoch: 1, Steps: 18 | Train Loss: 3.202 Vali Loss: 2.973 Vali Acc: 0.143 Test Loss: 2.973 Test Acc: 0.143
Validation loss decreased (inf --> -0.143304).  Saving model ...
Epoch: 2 cost time: 8.41726803779602
Epoch: 2, Steps: 18 | Train Loss: 2.741 Vali Loss: 2.390 Vali Acc: 0.593 Test Loss: 2.390 Test Acc: 0.593
Validation loss decreased (-0.143304 --> -0.593309).  Saving model ...
Epoch: 3 cost time: 7.943034648895264
Epoch: 3, Steps: 18 | Train Loss: 2.110 Vali Loss: 1.722 Vali Acc: 0.857 Test Loss: 1.722 Test Acc: 0.857
Validation loss decreased (-0.593309 --> -0.856649).  Saving model ...
Epoch: 4 cost time: 7.856566667556763
Epoch: 4, Steps: 18 | Train Loss: 1.413 Vali Loss: 1.123 Vali Acc: 0.937 Test Loss: 1.123 Test Acc: 0.937
Validation loss decreased (-0.856649 --> -0.936655).  Saving model ...
Epoch: 5 cost time: 7.814297437667847
Epoch: 5, Steps: 18 | Train Loss: 0.846 Vali Loss: 0.672 Vali Acc: 0.957 Test Loss: 0.672 Test Acc: 0.957
Validation loss decreased (-0.936655 --> -0.956660).  Saving model ...
Epoch: 6 cost time: 8.279179334640503
Epoch: 6, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.419 Vali Acc: 0.953 Test Loss: 0.419 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.443907260894775
Epoch: 7, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.292 Vali Acc: 0.967 Test Loss: 0.292 Test Acc: 0.967
Validation loss decreased (-0.956660 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 8.411569118499756
Epoch: 8, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.238 Vali Acc: 0.970 Test Loss: 0.238 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 7.8128087520599365
Epoch: 9, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 7.770543575286865
Epoch: 10, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 7.675386905670166
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 7.431575536727905
Epoch: 12, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.504171133041382
Epoch: 13, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.42386269569397
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.40957260131836
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 7.945613622665405
Epoch: 16, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.836767196655273
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.821972370147705
Epoch: 18, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.602254629135132
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.596667766571045
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 8.565590858459473
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 8.52783203125
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.926619529724121
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 8.043940305709839
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 8.115700006484985
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.603763341903687
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 8.452584505081177
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.66305923461914
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 8.361540079116821
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 30 cost time: 7.891700029373169
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 2402985
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.987619161605835
Epoch: 1, Steps: 18 | Train Loss: 3.187 Vali Loss: 2.989 Vali Acc: 0.167 Test Loss: 2.989 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 5.29957127571106
Epoch: 2, Steps: 18 | Train Loss: 2.805 Vali Loss: 2.518 Vali Acc: 0.563 Test Loss: 2.518 Test Acc: 0.563
Validation loss decreased (-0.166637 --> -0.563308).  Saving model ...
Epoch: 3 cost time: 5.3344011306762695
Epoch: 3, Steps: 18 | Train Loss: 2.236 Vali Loss: 1.959 Vali Acc: 0.777 Test Loss: 1.959 Test Acc: 0.777
Validation loss decreased (-0.563308 --> -0.776647).  Saving model ...
Epoch: 4 cost time: 5.2936928272247314
Epoch: 4, Steps: 18 | Train Loss: 1.621 Vali Loss: 1.404 Vali Acc: 0.873 Test Loss: 1.404 Test Acc: 0.873
Validation loss decreased (-0.776647 --> -0.873319).  Saving model ...
Epoch: 5 cost time: 5.123656749725342
Epoch: 5, Steps: 18 | Train Loss: 1.030 Vali Loss: 0.925 Vali Acc: 0.907 Test Loss: 0.925 Test Acc: 0.907
Validation loss decreased (-0.873319 --> -0.906657).  Saving model ...
Epoch: 6 cost time: 5.269338846206665
Epoch: 6, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.595 Vali Acc: 0.937 Test Loss: 0.595 Test Acc: 0.937
Validation loss decreased (-0.906657 --> -0.936661).  Saving model ...
Epoch: 7 cost time: 4.802690267562866
Epoch: 7, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.422 Vali Acc: 0.943 Test Loss: 0.422 Test Acc: 0.943
Validation loss decreased (-0.936661 --> -0.943329).  Saving model ...
Epoch: 8 cost time: 5.0185418128967285
Epoch: 8, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.339 Vali Acc: 0.947 Test Loss: 0.339 Test Acc: 0.947
Validation loss decreased (-0.943329 --> -0.946663).  Saving model ...
Epoch: 9 cost time: 5.115746974945068
Epoch: 9, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.281 Vali Acc: 0.953 Test Loss: 0.281 Test Acc: 0.953
Validation loss decreased (-0.946663 --> -0.953331).  Saving model ...
Epoch: 10 cost time: 5.000648736953735
Epoch: 10, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.953 Test Loss: 0.253 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 11 cost time: 5.037538290023804
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959998).  Saving model ...
Epoch: 12 cost time: 5.30812668800354
Epoch: 12, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.46566104888916
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 14 cost time: 5.316794157028198
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.443217039108276
Epoch: 15, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.4919233322143555
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.276953935623169
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.242823839187622
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.258982181549072
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.202564239501953
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.2232582569122314
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 5.440174579620361
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.4343438148498535
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 5.4282824993133545
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.348873138427734
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 5.231832027435303
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.951225519180298
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.9996068477630615
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.809877872467041
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.903818130493164
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 747561
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.217012166976929
Epoch: 1, Steps: 18 | Train Loss: 3.202 Vali Loss: 2.974 Vali Acc: 0.143 Test Loss: 2.974 Test Acc: 0.143
Validation loss decreased (inf --> -0.143304).  Saving model ...
Epoch: 2 cost time: 5.71219277381897
Epoch: 2, Steps: 18 | Train Loss: 2.743 Vali Loss: 2.391 Vali Acc: 0.593 Test Loss: 2.391 Test Acc: 0.593
Validation loss decreased (-0.143304 --> -0.593309).  Saving model ...
Epoch: 3 cost time: 5.7483978271484375
Epoch: 3, Steps: 18 | Train Loss: 2.113 Vali Loss: 1.724 Vali Acc: 0.857 Test Loss: 1.724 Test Acc: 0.857
Validation loss decreased (-0.593309 --> -0.856649).  Saving model ...
Epoch: 4 cost time: 5.651500225067139
Epoch: 4, Steps: 18 | Train Loss: 1.417 Vali Loss: 1.126 Vali Acc: 0.933 Test Loss: 1.126 Test Acc: 0.933
Validation loss decreased (-0.856649 --> -0.933322).  Saving model ...
Epoch: 5 cost time: 5.474161863327026
Epoch: 5, Steps: 18 | Train Loss: 0.851 Vali Loss: 0.675 Vali Acc: 0.953 Test Loss: 0.675 Test Acc: 0.953
Validation loss decreased (-0.933322 --> -0.953327).  Saving model ...
Epoch: 6 cost time: 5.5071234703063965
Epoch: 6, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.422 Vali Acc: 0.953 Test Loss: 0.422 Test Acc: 0.953
Validation loss decreased (-0.953327 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 5.365046501159668
Epoch: 7, Steps: 18 | Train Loss: 0.257 Vali Loss: 0.295 Vali Acc: 0.963 Test Loss: 0.295 Test Acc: 0.963
Validation loss decreased (-0.953329 --> -0.963330).  Saving model ...
Epoch: 8 cost time: 5.270371675491333
Epoch: 8, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.241 Vali Acc: 0.970 Test Loss: 0.241 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 5.8763182163238525
Epoch: 9, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.387482404708862
Epoch: 10, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 5.850486755371094
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 5.916794061660767
Epoch: 12, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.893470525741577
Epoch: 13, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.464039325714111
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.575417518615723
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.449250936508179
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.442409515380859
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.026051759719849
Epoch: 18, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 5.84087347984314
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.890499591827393
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.8466386795043945
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.8368611335754395
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.350805759429932
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.963 Test Loss: 0.113 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.34699010848999
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.03213906288147
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.3684728145599365
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.993002891540527
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.591821908950806
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.963 Test Loss: 0.108 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 2402985
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.611629009246826
Epoch: 1, Steps: 18 | Train Loss: 3.189 Vali Loss: 2.989 Vali Acc: 0.167 Test Loss: 2.989 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 3.8647215366363525
Epoch: 2, Steps: 18 | Train Loss: 2.809 Vali Loss: 2.518 Vali Acc: 0.563 Test Loss: 2.518 Test Acc: 0.563
Validation loss decreased (-0.166637 --> -0.563308).  Saving model ...
Epoch: 3 cost time: 3.7687265872955322
Epoch: 3, Steps: 18 | Train Loss: 2.242 Vali Loss: 1.959 Vali Acc: 0.780 Test Loss: 1.959 Test Acc: 0.780
Validation loss decreased (-0.563308 --> -0.779980).  Saving model ...
Epoch: 4 cost time: 3.722545623779297
Epoch: 4, Steps: 18 | Train Loss: 1.629 Vali Loss: 1.403 Vali Acc: 0.877 Test Loss: 1.403 Test Acc: 0.877
Validation loss decreased (-0.779980 --> -0.876653).  Saving model ...
Epoch: 5 cost time: 3.610569953918457
Epoch: 5, Steps: 18 | Train Loss: 1.050 Vali Loss: 0.924 Vali Acc: 0.907 Test Loss: 0.924 Test Acc: 0.907
Validation loss decreased (-0.876653 --> -0.906657).  Saving model ...
Epoch: 6 cost time: 3.5810720920562744
Epoch: 6, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.594 Vali Acc: 0.937 Test Loss: 0.594 Test Acc: 0.937
Validation loss decreased (-0.906657 --> -0.936661).  Saving model ...
Epoch: 7 cost time: 3.736546516418457
Epoch: 7, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.421 Vali Acc: 0.947 Test Loss: 0.421 Test Acc: 0.947
Validation loss decreased (-0.936661 --> -0.946662).  Saving model ...
Epoch: 8 cost time: 3.6864328384399414
Epoch: 8, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.335 Vali Acc: 0.947 Test Loss: 0.335 Test Acc: 0.947
Validation loss decreased (-0.946662 --> -0.946663).  Saving model ...
Epoch: 9 cost time: 3.817072629928589
Epoch: 9, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.946663 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 3.853300094604492
Epoch: 10, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.248 Vali Acc: 0.953 Test Loss: 0.248 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 11 cost time: 3.930126190185547
Epoch: 11, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963331).  Saving model ...
Epoch: 12 cost time: 3.90468430519104
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8893544673919678
Epoch: 13, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 3.9104483127593994
Epoch: 14, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 3.906766176223755
Epoch: 15, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.644059181213379
Epoch: 16, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6633613109588623
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6357719898223877
Epoch: 18, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8293490409851074
Epoch: 19, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7175445556640625
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 21 cost time: 3.525346279144287
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 3.9615375995635986
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9422645568847656
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 3.979036808013916
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 3.9472529888153076
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 3.9097225666046143
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.889392375946045
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5747718811035156
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 3.8426578044891357
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.9117939472198486
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 747561
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.398592233657837
Epoch: 1, Steps: 18 | Train Loss: 3.142 Vali Loss: 2.923 Vali Acc: 0.187 Test Loss: 2.923 Test Acc: 0.187
Validation loss decreased (inf --> -0.186637).  Saving model ...
Epoch: 2 cost time: 8.16162657737732
Epoch: 2, Steps: 18 | Train Loss: 2.745 Vali Loss: 2.414 Vali Acc: 0.690 Test Loss: 2.414 Test Acc: 0.690
Validation loss decreased (-0.186637 --> -0.689976).  Saving model ...
Epoch: 3 cost time: 8.227151155471802
Epoch: 3, Steps: 18 | Train Loss: 2.122 Vali Loss: 1.806 Vali Acc: 0.903 Test Loss: 1.806 Test Acc: 0.903
Validation loss decreased (-0.689976 --> -0.903315).  Saving model ...
Epoch: 4 cost time: 8.106531143188477
Epoch: 4, Steps: 18 | Train Loss: 1.471 Vali Loss: 1.217 Vali Acc: 0.943 Test Loss: 1.217 Test Acc: 0.943
Validation loss decreased (-0.903315 --> -0.943321).  Saving model ...
Epoch: 5 cost time: 7.739194631576538
Epoch: 5, Steps: 18 | Train Loss: 0.900 Vali Loss: 0.757 Vali Acc: 0.950 Test Loss: 0.757 Test Acc: 0.950
Validation loss decreased (-0.943321 --> -0.949992).  Saving model ...
Epoch: 6 cost time: 6.506379842758179
Epoch: 6, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.466 Vali Acc: 0.963 Test Loss: 0.466 Test Acc: 0.963
Validation loss decreased (-0.949992 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 7.791492700576782
Epoch: 7, Steps: 18 | Train Loss: 0.300 Vali Loss: 0.325 Vali Acc: 0.960 Test Loss: 0.325 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.959861516952515
Epoch: 8, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.263 Vali Acc: 0.967 Test Loss: 0.263 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 8.214125156402588
Epoch: 9, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.219 Vali Acc: 0.980 Test Loss: 0.219 Test Acc: 0.980
Validation loss decreased (-0.966664 --> -0.979998).  Saving model ...
Epoch: 10 cost time: 8.227492332458496
Epoch: 10, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 11 cost time: 8.358989953994751
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.177 Vali Acc: 0.980 Test Loss: 0.177 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 12 cost time: 7.839082717895508
Epoch: 12, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.957928419113159
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.976591348648071
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.983 Test Loss: 0.143 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 7.824507474899292
Epoch: 15, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 8.369975328445435
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.983 Test Loss: 0.132 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 8.307389497756958
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 8.282964944839478
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.084975957870483
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.078715324401855
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 7.46028733253479
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 7.600090742111206
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.900184154510498
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 7.874449729919434
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 7.866169214248657
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 6.410334825515747
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 7.6913933753967285
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 7.596750259399414
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 7.589985132217407
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.984814882278442
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1230761
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.242488622665405
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.098 Vali Acc: 0.137 Test Loss: 3.098 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 4.7496161460876465
Epoch: 2, Steps: 18 | Train Loss: 2.912 Vali Loss: 2.610 Vali Acc: 0.507 Test Loss: 2.610 Test Acc: 0.507
Validation loss decreased (-0.136636 --> -0.506641).  Saving model ...
Epoch: 3 cost time: 5.041646480560303
Epoch: 3, Steps: 18 | Train Loss: 2.347 Vali Loss: 2.024 Vali Acc: 0.807 Test Loss: 2.024 Test Acc: 0.807
Validation loss decreased (-0.506641 --> -0.806646).  Saving model ...
Epoch: 4 cost time: 3.817780017852783
Epoch: 4, Steps: 18 | Train Loss: 1.711 Vali Loss: 1.430 Vali Acc: 0.923 Test Loss: 1.430 Test Acc: 0.923
Validation loss decreased (-0.806646 --> -0.923319).  Saving model ...
Epoch: 5 cost time: 4.6565539836883545
Epoch: 5, Steps: 18 | Train Loss: 1.126 Vali Loss: 0.922 Vali Acc: 0.937 Test Loss: 0.922 Test Acc: 0.937
Validation loss decreased (-0.923319 --> -0.936657).  Saving model ...
Epoch: 6 cost time: 4.96634316444397
Epoch: 6, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.579 Vali Acc: 0.950 Test Loss: 0.579 Test Acc: 0.950
Validation loss decreased (-0.936657 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 4.999637842178345
Epoch: 7, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.384 Vali Acc: 0.970 Test Loss: 0.384 Test Acc: 0.970
Validation loss decreased (-0.949994 --> -0.969996).  Saving model ...
Epoch: 8 cost time: 5.173991441726685
Epoch: 8, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.290 Vali Acc: 0.973 Test Loss: 0.290 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973330).  Saving model ...
Epoch: 9 cost time: 5.224463701248169
Epoch: 9, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.238 Vali Acc: 0.973 Test Loss: 0.238 Test Acc: 0.973
Validation loss decreased (-0.973330 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 5.2936999797821045
Epoch: 10, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.202 Vali Acc: 0.977 Test Loss: 0.202 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 5.067989349365234
Epoch: 11, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 12 cost time: 4.109534025192261
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 5.008435010910034
Epoch: 13, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.881993293762207
Epoch: 14, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.900745868682861
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 5.008576154708862
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 5.213953495025635
Epoch: 17, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 5.086650133132935
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 5.053689956665039
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 5.146827697753906
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 4.942397117614746
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.863573789596558
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 5.075676918029785
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 4.9878315925598145
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 4.80873703956604
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 5.2154905796051025
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 5.316183090209961
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.304835796356201
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 5.337266683578491
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 5.376657247543335
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 402985
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.997097969055176
Epoch: 1, Steps: 18 | Train Loss: 3.142 Vali Loss: 2.923 Vali Acc: 0.187 Test Loss: 2.923 Test Acc: 0.187
Validation loss decreased (inf --> -0.186637).  Saving model ...
Epoch: 2 cost time: 6.509113073348999
Epoch: 2, Steps: 18 | Train Loss: 2.745 Vali Loss: 2.414 Vali Acc: 0.690 Test Loss: 2.414 Test Acc: 0.690
Validation loss decreased (-0.186637 --> -0.689976).  Saving model ...
Epoch: 3 cost time: 6.599135637283325
Epoch: 3, Steps: 18 | Train Loss: 2.122 Vali Loss: 1.806 Vali Acc: 0.903 Test Loss: 1.806 Test Acc: 0.903
Validation loss decreased (-0.689976 --> -0.903315).  Saving model ...
Epoch: 4 cost time: 6.68415093421936
Epoch: 4, Steps: 18 | Train Loss: 1.471 Vali Loss: 1.217 Vali Acc: 0.943 Test Loss: 1.217 Test Acc: 0.943
Validation loss decreased (-0.903315 --> -0.943321).  Saving model ...
Epoch: 5 cost time: 7.047646999359131
Epoch: 5, Steps: 18 | Train Loss: 0.900 Vali Loss: 0.757 Vali Acc: 0.950 Test Loss: 0.757 Test Acc: 0.950
Validation loss decreased (-0.943321 --> -0.949992).  Saving model ...
Epoch: 6 cost time: 6.949778079986572
Epoch: 6, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.466 Vali Acc: 0.963 Test Loss: 0.466 Test Acc: 0.963
Validation loss decreased (-0.949992 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 6.700388669967651
Epoch: 7, Steps: 18 | Train Loss: 0.300 Vali Loss: 0.325 Vali Acc: 0.960 Test Loss: 0.325 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.616998910903931
Epoch: 8, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.263 Vali Acc: 0.967 Test Loss: 0.263 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 6.3640453815460205
Epoch: 9, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.219 Vali Acc: 0.980 Test Loss: 0.219 Test Acc: 0.980
Validation loss decreased (-0.966664 --> -0.979998).  Saving model ...
Epoch: 10 cost time: 6.587122917175293
Epoch: 10, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 11 cost time: 6.841163873672485
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.177 Vali Acc: 0.980 Test Loss: 0.177 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 12 cost time: 6.639949798583984
Epoch: 12, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.769869089126587
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.853658437728882
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.983 Test Loss: 0.143 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 6.2382493019104
Epoch: 15, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 6.4734930992126465
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.983 Test Loss: 0.132 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 6.393804550170898
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 6.33818507194519
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.718605041503906
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.6664769649505615
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 6.7649149894714355
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 6.649482011795044
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.19999361038208
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 6.2725608348846436
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 6.493443965911865
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 6.7179577350616455
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 6.854212522506714
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 6.899881839752197
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 6.6469995975494385
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.939319610595703
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1230761
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.445760250091553
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.098 Vali Acc: 0.137 Test Loss: 3.098 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 4.583857774734497
Epoch: 2, Steps: 18 | Train Loss: 2.912 Vali Loss: 2.610 Vali Acc: 0.507 Test Loss: 2.610 Test Acc: 0.507
Validation loss decreased (-0.136636 --> -0.506641).  Saving model ...
Epoch: 3 cost time: 4.74929666519165
Epoch: 3, Steps: 18 | Train Loss: 2.347 Vali Loss: 2.024 Vali Acc: 0.807 Test Loss: 2.024 Test Acc: 0.807
Validation loss decreased (-0.506641 --> -0.806646).  Saving model ...
Epoch: 4 cost time: 4.769921541213989
Epoch: 4, Steps: 18 | Train Loss: 1.711 Vali Loss: 1.430 Vali Acc: 0.923 Test Loss: 1.430 Test Acc: 0.923
Validation loss decreased (-0.806646 --> -0.923319).  Saving model ...
Epoch: 5 cost time: 4.817612409591675
Epoch: 5, Steps: 18 | Train Loss: 1.126 Vali Loss: 0.922 Vali Acc: 0.937 Test Loss: 0.922 Test Acc: 0.937
Validation loss decreased (-0.923319 --> -0.936657).  Saving model ...
Epoch: 6 cost time: 4.633696556091309
Epoch: 6, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.579 Vali Acc: 0.950 Test Loss: 0.579 Test Acc: 0.950
Validation loss decreased (-0.936657 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 4.609611988067627
Epoch: 7, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.384 Vali Acc: 0.970 Test Loss: 0.384 Test Acc: 0.970
Validation loss decreased (-0.949994 --> -0.969996).  Saving model ...
Epoch: 8 cost time: 4.145510673522949
Epoch: 8, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.290 Vali Acc: 0.973 Test Loss: 0.290 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973330).  Saving model ...
Epoch: 9 cost time: 4.376708745956421
Epoch: 9, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.238 Vali Acc: 0.973 Test Loss: 0.238 Test Acc: 0.973
Validation loss decreased (-0.973330 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 4.322462797164917
Epoch: 10, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.202 Vali Acc: 0.977 Test Loss: 0.202 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 4.3143932819366455
Epoch: 11, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 12 cost time: 4.422563076019287
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 4.68310284614563
Epoch: 13, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.595071315765381
Epoch: 14, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.6833624839782715
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.682669162750244
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 4.708681583404541
Epoch: 17, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 4.368985176086426
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.417877435684204
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.2855236530303955
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.7240543365478516
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.428889036178589
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 4.632363796234131
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 4.760308265686035
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 4.756590127944946
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 4.798598289489746
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 4.7131407260894775
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.369365930557251
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 4.504316329956055
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 4.270999908447266
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 402985
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.9099061489105225
Epoch: 1, Steps: 18 | Train Loss: 3.141 Vali Loss: 2.923 Vali Acc: 0.187 Test Loss: 2.923 Test Acc: 0.187
Validation loss decreased (inf --> -0.186637).  Saving model ...
Epoch: 2 cost time: 4.9391093254089355
Epoch: 2, Steps: 18 | Train Loss: 2.745 Vali Loss: 2.414 Vali Acc: 0.690 Test Loss: 2.414 Test Acc: 0.690
Validation loss decreased (-0.186637 --> -0.689976).  Saving model ...
Epoch: 3 cost time: 4.989916563034058
Epoch: 3, Steps: 18 | Train Loss: 2.122 Vali Loss: 1.807 Vali Acc: 0.903 Test Loss: 1.807 Test Acc: 0.903
Validation loss decreased (-0.689976 --> -0.903315).  Saving model ...
Epoch: 4 cost time: 4.963232040405273
Epoch: 4, Steps: 18 | Train Loss: 1.471 Vali Loss: 1.218 Vali Acc: 0.943 Test Loss: 1.218 Test Acc: 0.943
Validation loss decreased (-0.903315 --> -0.943321).  Saving model ...
Epoch: 5 cost time: 4.925682306289673
Epoch: 5, Steps: 18 | Train Loss: 0.900 Vali Loss: 0.756 Vali Acc: 0.950 Test Loss: 0.756 Test Acc: 0.950
Validation loss decreased (-0.943321 --> -0.949992).  Saving model ...
Epoch: 6 cost time: 4.74476170539856
Epoch: 6, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.466 Vali Acc: 0.963 Test Loss: 0.466 Test Acc: 0.963
Validation loss decreased (-0.949992 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 4.674102067947388
Epoch: 7, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.324 Vali Acc: 0.967 Test Loss: 0.324 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 4.74942684173584
Epoch: 8, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 4.292863845825195
Epoch: 9, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.218 Vali Acc: 0.980 Test Loss: 0.218 Test Acc: 0.980
Validation loss decreased (-0.966664 --> -0.979998).  Saving model ...
Epoch: 10 cost time: 4.625407934188843
Epoch: 10, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.191 Vali Acc: 0.980 Test Loss: 0.191 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 11 cost time: 4.215266227722168
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 12 cost time: 4.737946510314941
Epoch: 12, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.018558979034424
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.551563262939453
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.142 Vali Acc: 0.983 Test Loss: 0.142 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 5.08331298828125
Epoch: 15, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 5.13409948348999
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 5.102237701416016
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 5.0160510540008545
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 5.032266616821289
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 5.0640037059783936
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 5.141684293746948
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 5.121748208999634
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.160277605056763
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 5.247952461242676
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 5.226014852523804
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 5.251102685928345
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 5.24494194984436
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 5.284057855606079
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 5.259401559829712
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.233778476715088
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1230761
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.426040172576904
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.098 Vali Acc: 0.137 Test Loss: 3.098 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 3.6526710987091064
Epoch: 2, Steps: 18 | Train Loss: 2.913 Vali Loss: 2.610 Vali Acc: 0.507 Test Loss: 2.610 Test Acc: 0.507
Validation loss decreased (-0.136636 --> -0.506641).  Saving model ...
Epoch: 3 cost time: 3.6943299770355225
Epoch: 3, Steps: 18 | Train Loss: 2.348 Vali Loss: 2.024 Vali Acc: 0.807 Test Loss: 2.024 Test Acc: 0.807
Validation loss decreased (-0.506641 --> -0.806646).  Saving model ...
Epoch: 4 cost time: 3.72061824798584
Epoch: 4, Steps: 18 | Train Loss: 1.713 Vali Loss: 1.429 Vali Acc: 0.923 Test Loss: 1.429 Test Acc: 0.923
Validation loss decreased (-0.806646 --> -0.923319).  Saving model ...
Epoch: 5 cost time: 3.7563626766204834
Epoch: 5, Steps: 18 | Train Loss: 1.128 Vali Loss: 0.920 Vali Acc: 0.937 Test Loss: 0.920 Test Acc: 0.937
Validation loss decreased (-0.923319 --> -0.936657).  Saving model ...
Epoch: 6 cost time: 3.743133544921875
Epoch: 6, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.577 Vali Acc: 0.953 Test Loss: 0.577 Test Acc: 0.953
Validation loss decreased (-0.936657 --> -0.953328).  Saving model ...
Epoch: 7 cost time: 3.744553327560425
Epoch: 7, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.382 Vali Acc: 0.970 Test Loss: 0.382 Test Acc: 0.970
Validation loss decreased (-0.953328 --> -0.969996).  Saving model ...
Epoch: 8 cost time: 3.706414222717285
Epoch: 8, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.288 Vali Acc: 0.973 Test Loss: 0.288 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973330).  Saving model ...
Epoch: 9 cost time: 3.4868502616882324
Epoch: 9, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.236 Vali Acc: 0.973 Test Loss: 0.236 Test Acc: 0.973
Validation loss decreased (-0.973330 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 3.648609161376953
Epoch: 10, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 11 cost time: 3.6171469688415527
Epoch: 11, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 12 cost time: 3.668740749359131
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 3.5766501426696777
Epoch: 13, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.980 Test Loss: 0.148 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.486224412918091
Epoch: 14, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.6224305629730225
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 3.650163173675537
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 3.6321182250976562
Epoch: 17, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.974976062774658
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.8926873207092285
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.683647871017456
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.6626908779144287
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.641044855117798
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.6122429370880127
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.5981085300445557
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.51570200920105
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.6059224605560303
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.47455096244812
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6525397300720215
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.4980413913726807
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 3.54315185546875
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 402985
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.94826340675354
Epoch: 1, Steps: 18 | Train Loss: 3.217 Vali Loss: 3.025 Vali Acc: 0.127 Test Loss: 3.025 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 7.162302255630493
Epoch: 2, Steps: 18 | Train Loss: 2.802 Vali Loss: 2.497 Vali Acc: 0.523 Test Loss: 2.497 Test Acc: 0.523
Validation loss decreased (-0.126636 --> -0.523308).  Saving model ...
Epoch: 3 cost time: 7.146657228469849
Epoch: 3, Steps: 18 | Train Loss: 2.215 Vali Loss: 1.900 Vali Acc: 0.837 Test Loss: 1.900 Test Acc: 0.837
Validation loss decreased (-0.523308 --> -0.836648).  Saving model ...
Epoch: 4 cost time: 7.387519121170044
Epoch: 4, Steps: 18 | Train Loss: 1.605 Vali Loss: 1.323 Vali Acc: 0.927 Test Loss: 1.323 Test Acc: 0.927
Validation loss decreased (-0.836648 --> -0.926653).  Saving model ...
Epoch: 5 cost time: 7.495616674423218
Epoch: 5, Steps: 18 | Train Loss: 1.027 Vali Loss: 0.841 Vali Acc: 0.943 Test Loss: 0.841 Test Acc: 0.943
Validation loss decreased (-0.926653 --> -0.943325).  Saving model ...
Epoch: 6 cost time: 7.4013471603393555
Epoch: 6, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.508 Vali Acc: 0.957 Test Loss: 0.508 Test Acc: 0.957
Validation loss decreased (-0.943325 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 7.5993664264678955
Epoch: 7, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.336 Vali Acc: 0.967 Test Loss: 0.336 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 7.505557060241699
Epoch: 8, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969997).  Saving model ...
Epoch: 9 cost time: 7.100260972976685
Epoch: 9, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 7.010657072067261
Epoch: 10, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 6.8739166259765625
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 6.901456832885742
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.985831022262573
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 7.402174234390259
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.19700813293457
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 7.321393728256226
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 7.31960129737854
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.2785961627960205
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.965447902679443
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.888713359832764
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.871913194656372
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.089037656784058
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.206017255783081
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.292963266372681
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.417632341384888
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.43680477142334
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 644649
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.8845579624176025
Epoch: 1, Steps: 18 | Train Loss: 3.237 Vali Loss: 3.052 Vali Acc: 0.123 Test Loss: 3.052 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 5.0825934410095215
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 2.531 Vali Acc: 0.547 Test Loss: 2.531 Test Acc: 0.547
Validation loss decreased (-0.123303 --> -0.546641).  Saving model ...
Epoch: 3 cost time: 4.698693752288818
Epoch: 3, Steps: 18 | Train Loss: 2.248 Vali Loss: 1.952 Vali Acc: 0.817 Test Loss: 1.952 Test Acc: 0.817
Validation loss decreased (-0.546641 --> -0.816647).  Saving model ...
Epoch: 4 cost time: 4.914583683013916
Epoch: 4, Steps: 18 | Train Loss: 1.669 Vali Loss: 1.394 Vali Acc: 0.880 Test Loss: 1.394 Test Acc: 0.880
Validation loss decreased (-0.816647 --> -0.879986).  Saving model ...
Epoch: 5 cost time: 4.830763339996338
Epoch: 5, Steps: 18 | Train Loss: 1.073 Vali Loss: 0.921 Vali Acc: 0.937 Test Loss: 0.921 Test Acc: 0.937
Validation loss decreased (-0.879986 --> -0.936657).  Saving model ...
Epoch: 6 cost time: 4.888890504837036
Epoch: 6, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.586 Vali Acc: 0.953 Test Loss: 0.586 Test Acc: 0.953
Validation loss decreased (-0.936657 --> -0.953327).  Saving model ...
Epoch: 7 cost time: 4.886699438095093
Epoch: 7, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.393 Vali Acc: 0.963 Test Loss: 0.393 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 4.884549856185913
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.290 Vali Acc: 0.963 Test Loss: 0.290 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 4.846182346343994
Epoch: 9, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 4.987273931503296
Epoch: 10, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 5.0136284828186035
Epoch: 11, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.054675102233887
Epoch: 12, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.24663519859314
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.249660015106201
Epoch: 14, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 5.117108106613159
Epoch: 15, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 4.967094898223877
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 4.936721086502075
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 4.932107925415039
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 4.833579778671265
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 4.901356220245361
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 4.8922669887542725
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.6260666847229
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 5.128106594085693
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 5.316804647445679
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 5.265656232833862
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.326328992843628
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.189374685287476
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.19093656539917
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 5.16549015045166
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.963624477386475
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 230697
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.278842926025391
Epoch: 1, Steps: 18 | Train Loss: 3.217 Vali Loss: 3.025 Vali Acc: 0.127 Test Loss: 3.025 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 5.702166557312012
Epoch: 2, Steps: 18 | Train Loss: 2.802 Vali Loss: 2.497 Vali Acc: 0.523 Test Loss: 2.497 Test Acc: 0.523
Validation loss decreased (-0.126636 --> -0.523308).  Saving model ...
Epoch: 3 cost time: 5.837355613708496
Epoch: 3, Steps: 18 | Train Loss: 2.215 Vali Loss: 1.900 Vali Acc: 0.837 Test Loss: 1.900 Test Acc: 0.837
Validation loss decreased (-0.523308 --> -0.836648).  Saving model ...
Epoch: 4 cost time: 5.982975959777832
Epoch: 4, Steps: 18 | Train Loss: 1.605 Vali Loss: 1.323 Vali Acc: 0.927 Test Loss: 1.323 Test Acc: 0.927
Validation loss decreased (-0.836648 --> -0.926653).  Saving model ...
Epoch: 5 cost time: 6.082979202270508
Epoch: 5, Steps: 18 | Train Loss: 1.027 Vali Loss: 0.841 Vali Acc: 0.943 Test Loss: 0.841 Test Acc: 0.943
Validation loss decreased (-0.926653 --> -0.943325).  Saving model ...
Epoch: 6 cost time: 6.070779085159302
Epoch: 6, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.508 Vali Acc: 0.957 Test Loss: 0.508 Test Acc: 0.957
Validation loss decreased (-0.943325 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 5.986948013305664
Epoch: 7, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.336 Vali Acc: 0.967 Test Loss: 0.336 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 6.0755462646484375
Epoch: 8, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969997).  Saving model ...
Epoch: 9 cost time: 5.850571870803833
Epoch: 9, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 5.854701995849609
Epoch: 10, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 5.555968284606934
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 5.2841410636901855
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.577476978302002
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.198606252670288
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.781987428665161
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 5.62198543548584
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 5.870053768157959
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.816951513290405
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.6880784034729
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.919862270355225
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.047889471054077
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.985026597976685
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.4970104694366455
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.745002746582031
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.779298305511475
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.654385089874268
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 644649
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.884150981903076
Epoch: 1, Steps: 18 | Train Loss: 3.237 Vali Loss: 3.052 Vali Acc: 0.123 Test Loss: 3.052 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 4.347800970077515
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 2.531 Vali Acc: 0.547 Test Loss: 2.531 Test Acc: 0.547
Validation loss decreased (-0.123303 --> -0.546641).  Saving model ...
Epoch: 3 cost time: 4.242022752761841
Epoch: 3, Steps: 18 | Train Loss: 2.248 Vali Loss: 1.952 Vali Acc: 0.817 Test Loss: 1.952 Test Acc: 0.817
Validation loss decreased (-0.546641 --> -0.816647).  Saving model ...
Epoch: 4 cost time: 4.247556209564209
Epoch: 4, Steps: 18 | Train Loss: 1.669 Vali Loss: 1.394 Vali Acc: 0.880 Test Loss: 1.394 Test Acc: 0.880
Validation loss decreased (-0.816647 --> -0.879986).  Saving model ...
Epoch: 5 cost time: 4.292685270309448
Epoch: 5, Steps: 18 | Train Loss: 1.073 Vali Loss: 0.921 Vali Acc: 0.937 Test Loss: 0.921 Test Acc: 0.937
Validation loss decreased (-0.879986 --> -0.936657).  Saving model ...
Epoch: 6 cost time: 4.299521207809448
Epoch: 6, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.586 Vali Acc: 0.953 Test Loss: 0.586 Test Acc: 0.953
Validation loss decreased (-0.936657 --> -0.953327).  Saving model ...
Epoch: 7 cost time: 4.3130106925964355
Epoch: 7, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.393 Vali Acc: 0.963 Test Loss: 0.393 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 4.2001869678497314
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.290 Vali Acc: 0.963 Test Loss: 0.290 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 4.029986381530762
Epoch: 9, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 4.183658123016357
Epoch: 10, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 3.9484729766845703
Epoch: 11, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.94275164604187
Epoch: 12, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8694422245025635
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.755646228790283
Epoch: 14, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 3.9321749210357666
Epoch: 15, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 3.8846733570098877
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 3.896008014678955
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 4.004284620285034
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 4.035858631134033
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 4.108862400054932
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 4.13933253288269
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.067723035812378
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 4.142498731613159
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 4.009277820587158
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 4.130091190338135
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.09340763092041
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8492109775543213
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8620951175689697
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 3.8413116931915283
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8904130458831787
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 230697
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.117542266845703
Epoch: 1, Steps: 18 | Train Loss: 3.217 Vali Loss: 3.025 Vali Acc: 0.127 Test Loss: 3.025 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 4.647264003753662
Epoch: 2, Steps: 18 | Train Loss: 2.802 Vali Loss: 2.497 Vali Acc: 0.523 Test Loss: 2.497 Test Acc: 0.523
Validation loss decreased (-0.126636 --> -0.523308).  Saving model ...
Epoch: 3 cost time: 4.763269424438477
Epoch: 3, Steps: 18 | Train Loss: 2.215 Vali Loss: 1.899 Vali Acc: 0.837 Test Loss: 1.899 Test Acc: 0.837
Validation loss decreased (-0.523308 --> -0.836648).  Saving model ...
Epoch: 4 cost time: 4.789923667907715
Epoch: 4, Steps: 18 | Train Loss: 1.605 Vali Loss: 1.323 Vali Acc: 0.927 Test Loss: 1.323 Test Acc: 0.927
Validation loss decreased (-0.836648 --> -0.926653).  Saving model ...
Epoch: 5 cost time: 4.719540119171143
Epoch: 5, Steps: 18 | Train Loss: 1.027 Vali Loss: 0.842 Vali Acc: 0.943 Test Loss: 0.842 Test Acc: 0.943
Validation loss decreased (-0.926653 --> -0.943325).  Saving model ...
Epoch: 6 cost time: 4.710418701171875
Epoch: 6, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.508 Vali Acc: 0.957 Test Loss: 0.508 Test Acc: 0.957
Validation loss decreased (-0.943325 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 4.849886178970337
Epoch: 7, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.336 Vali Acc: 0.967 Test Loss: 0.336 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 4.84868049621582
Epoch: 8, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969997).  Saving model ...
Epoch: 9 cost time: 4.746574640274048
Epoch: 9, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 4.600875377655029
Epoch: 10, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 4.428507089614868
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 4.562041759490967
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.682805776596069
Epoch: 13, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.6033546924591064
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.324300289154053
Epoch: 15, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 4.840220212936401
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 4.800773859024048
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.81487774848938
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.860330104827881
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.814386367797852
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.8134663105010986
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.952131986618042
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.827315330505371
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.7616143226623535
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.681103944778442
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.7635462284088135
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 644649
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.026196479797363
Epoch: 1, Steps: 18 | Train Loss: 3.236 Vali Loss: 3.052 Vali Acc: 0.127 Test Loss: 3.052 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 3.559138536453247
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 2.531 Vali Acc: 0.543 Test Loss: 2.531 Test Acc: 0.543
Validation loss decreased (-0.126636 --> -0.543308).  Saving model ...
Epoch: 3 cost time: 3.579847574234009
Epoch: 3, Steps: 18 | Train Loss: 2.248 Vali Loss: 1.953 Vali Acc: 0.817 Test Loss: 1.953 Test Acc: 0.817
Validation loss decreased (-0.543308 --> -0.816647).  Saving model ...
Epoch: 4 cost time: 3.6852893829345703
Epoch: 4, Steps: 18 | Train Loss: 1.669 Vali Loss: 1.395 Vali Acc: 0.880 Test Loss: 1.395 Test Acc: 0.880
Validation loss decreased (-0.816647 --> -0.879986).  Saving model ...
Epoch: 5 cost time: 3.591064929962158
Epoch: 5, Steps: 18 | Train Loss: 1.073 Vali Loss: 0.922 Vali Acc: 0.937 Test Loss: 0.922 Test Acc: 0.937
Validation loss decreased (-0.879986 --> -0.936657).  Saving model ...
Epoch: 6 cost time: 3.6078813076019287
Epoch: 6, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.585 Vali Acc: 0.953 Test Loss: 0.585 Test Acc: 0.953
Validation loss decreased (-0.936657 --> -0.953327).  Saving model ...
Epoch: 7 cost time: 3.588005542755127
Epoch: 7, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.393 Vali Acc: 0.963 Test Loss: 0.393 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 3.666799306869507
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.289 Vali Acc: 0.963 Test Loss: 0.289 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 3.645956516265869
Epoch: 9, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.232 Vali Acc: 0.970 Test Loss: 0.232 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 3.543287515640259
Epoch: 10, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 3.480905771255493
Epoch: 11, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4547247886657715
Epoch: 12, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4604039192199707
Epoch: 13, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3645098209381104
Epoch: 14, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 3.5017640590667725
Epoch: 15, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 3.4565043449401855
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 3.521968126296997
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 3.378918170928955
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 3.6590144634246826
Epoch: 19, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 3.6834588050842285
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 3.692925453186035
Epoch: 21, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 3.6564548015594482
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.6898558139801025
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 3.4242682456970215
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 3.631582498550415
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.645892858505249
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.4574778079986572
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 3.4590377807617188
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 3.5738813877105713
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 3.5018107891082764
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 230697
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.236352682113647
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 3.091 Vali Acc: 0.087 Test Loss: 3.091 Test Acc: 0.087
Validation loss decreased (inf --> -0.086636).  Saving model ...
Epoch: 2 cost time: 7.949880361557007
Epoch: 2, Steps: 18 | Train Loss: 3.026 Vali Loss: 2.801 Vali Acc: 0.237 Test Loss: 2.801 Test Acc: 0.237
Validation loss decreased (-0.086636 --> -0.236639).  Saving model ...
Epoch: 3 cost time: 9.18583369255066
Epoch: 3, Steps: 18 | Train Loss: 2.672 Vali Loss: 2.445 Vali Acc: 0.563 Test Loss: 2.445 Test Acc: 0.563
Validation loss decreased (-0.236639 --> -0.563309).  Saving model ...
Epoch: 4 cost time: 9.070556163787842
Epoch: 4, Steps: 18 | Train Loss: 2.323 Vali Loss: 2.062 Vali Acc: 0.717 Test Loss: 2.062 Test Acc: 0.717
Validation loss decreased (-0.563309 --> -0.716646).  Saving model ...
Epoch: 5 cost time: 9.190900325775146
Epoch: 5, Steps: 18 | Train Loss: 1.865 Vali Loss: 1.695 Vali Acc: 0.810 Test Loss: 1.695 Test Acc: 0.810
Validation loss decreased (-0.716646 --> -0.809983).  Saving model ...
Epoch: 6 cost time: 9.287208080291748
Epoch: 6, Steps: 18 | Train Loss: 1.502 Vali Loss: 1.354 Vali Acc: 0.860 Test Loss: 1.354 Test Acc: 0.860
Validation loss decreased (-0.809983 --> -0.859986).  Saving model ...
Epoch: 7 cost time: 8.998291015625
Epoch: 7, Steps: 18 | Train Loss: 1.184 Vali Loss: 1.059 Vali Acc: 0.880 Test Loss: 1.059 Test Acc: 0.880
Validation loss decreased (-0.859986 --> -0.879989).  Saving model ...
Epoch: 8 cost time: 8.931639194488525
Epoch: 8, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.839 Vali Acc: 0.910 Test Loss: 0.839 Test Acc: 0.910
Validation loss decreased (-0.879989 --> -0.909992).  Saving model ...
Epoch: 9 cost time: 9.065083980560303
Epoch: 9, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.685 Vali Acc: 0.903 Test Loss: 0.685 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.993000984191895
Epoch: 10, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.561 Vali Acc: 0.923 Test Loss: 0.561 Test Acc: 0.923
Validation loss decreased (-0.909992 --> -0.923328).  Saving model ...
Epoch: 11 cost time: 9.10630989074707
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.487 Vali Acc: 0.937 Test Loss: 0.487 Test Acc: 0.937
Validation loss decreased (-0.923328 --> -0.936662).  Saving model ...
Epoch: 12 cost time: 9.361365795135498
Epoch: 12, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.419 Vali Acc: 0.940 Test Loss: 0.419 Test Acc: 0.940
Validation loss decreased (-0.936662 --> -0.939996).  Saving model ...
Epoch: 13 cost time: 9.344712972640991
Epoch: 13, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.375 Vali Acc: 0.943 Test Loss: 0.375 Test Acc: 0.943
Validation loss decreased (-0.939996 --> -0.943330).  Saving model ...
Epoch: 14 cost time: 8.662601947784424
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.340 Vali Acc: 0.940 Test Loss: 0.340 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.275654077529907
Epoch: 15, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.316 Vali Acc: 0.943 Test Loss: 0.316 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943330).  Saving model ...
Epoch: 16 cost time: 9.263989448547363
Epoch: 16, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.673364877700806
Epoch: 17, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.276 Vali Acc: 0.943 Test Loss: 0.276 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943331).  Saving model ...
Epoch: 18 cost time: 8.597622632980347
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.42805814743042
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.520113706588745
Epoch: 20, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 8.924009799957275
Epoch: 21, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.240 Vali Acc: 0.940 Test Loss: 0.240 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.966783046722412
Epoch: 22, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.130228042602539
Epoch: 23, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.020164012908936
Epoch: 24, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 9.175299644470215
Epoch: 25, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 26 cost time: 8.70389986038208
Epoch: 26, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.45682954788208
Epoch: 27, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.947 Test Loss: 0.207 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.732938766479492
Epoch: 28, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 29 cost time: 8.915051937103271
Epoch: 29, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.84150743484497
Epoch: 30, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 1202273
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.93443489074707
Epoch: 1, Steps: 18 | Train Loss: 3.287 Vali Loss: 3.209 Vali Acc: 0.067 Test Loss: 3.209 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 5.890151262283325
Epoch: 2, Steps: 18 | Train Loss: 3.093 Vali Loss: 2.927 Vali Acc: 0.183 Test Loss: 2.927 Test Acc: 0.183
Validation loss decreased (-0.066635 --> -0.183304).  Saving model ...
Epoch: 3 cost time: 5.79526948928833
Epoch: 3, Steps: 18 | Train Loss: 2.764 Vali Loss: 2.590 Vali Acc: 0.513 Test Loss: 2.590 Test Acc: 0.513
Validation loss decreased (-0.183304 --> -0.513307).  Saving model ...
Epoch: 4 cost time: 5.848647832870483
Epoch: 4, Steps: 18 | Train Loss: 2.372 Vali Loss: 2.217 Vali Acc: 0.703 Test Loss: 2.217 Test Acc: 0.703
Validation loss decreased (-0.513307 --> -0.703311).  Saving model ...
Epoch: 5 cost time: 5.8973963260650635
Epoch: 5, Steps: 18 | Train Loss: 1.987 Vali Loss: 1.812 Vali Acc: 0.810 Test Loss: 1.812 Test Acc: 0.810
Validation loss decreased (-0.703311 --> -0.809982).  Saving model ...
Epoch: 6 cost time: 5.609325647354126
Epoch: 6, Steps: 18 | Train Loss: 1.541 Vali Loss: 1.427 Vali Acc: 0.847 Test Loss: 1.427 Test Acc: 0.847
Validation loss decreased (-0.809982 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 5.393645763397217
Epoch: 7, Steps: 18 | Train Loss: 1.156 Vali Loss: 1.098 Vali Acc: 0.880 Test Loss: 1.098 Test Acc: 0.880
Validation loss decreased (-0.846652 --> -0.879989).  Saving model ...
Epoch: 8 cost time: 5.492001056671143
Epoch: 8, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.861 Vali Acc: 0.887 Test Loss: 0.861 Test Acc: 0.887
Validation loss decreased (-0.879989 --> -0.886658).  Saving model ...
Epoch: 9 cost time: 5.707068204879761
Epoch: 9, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.683 Vali Acc: 0.910 Test Loss: 0.683 Test Acc: 0.910
Validation loss decreased (-0.886658 --> -0.909993).  Saving model ...
Epoch: 10 cost time: 5.571820974349976
Epoch: 10, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.568 Vali Acc: 0.913 Test Loss: 0.568 Test Acc: 0.913
Validation loss decreased (-0.909993 --> -0.913328).  Saving model ...
Epoch: 11 cost time: 5.567743539810181
Epoch: 11, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.486 Vali Acc: 0.923 Test Loss: 0.486 Test Acc: 0.923
Validation loss decreased (-0.913328 --> -0.923328).  Saving model ...
Epoch: 12 cost time: 5.750278949737549
Epoch: 12, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.433 Vali Acc: 0.923 Test Loss: 0.433 Test Acc: 0.923
Validation loss decreased (-0.923328 --> -0.923329).  Saving model ...
Epoch: 13 cost time: 5.9404616355896
Epoch: 13, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.923329 --> -0.929996).  Saving model ...
Epoch: 14 cost time: 5.975908041000366
Epoch: 14, Steps: 18 | Train Loss: 0.192 Vali Loss: 0.349 Vali Acc: 0.940 Test Loss: 0.349 Test Acc: 0.940
Validation loss decreased (-0.929996 --> -0.939997).  Saving model ...
Epoch: 15 cost time: 5.80184268951416
Epoch: 15, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.327 Vali Acc: 0.940 Test Loss: 0.327 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 16 cost time: 5.690840244293213
Epoch: 16, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.881643772125244
Epoch: 17, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.288 Vali Acc: 0.940 Test Loss: 0.288 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 18 cost time: 5.6413750648498535
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.273 Vali Acc: 0.940 Test Loss: 0.273 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 19 cost time: 5.605159044265747
Epoch: 19, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.268 Vali Acc: 0.940 Test Loss: 0.268 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 20 cost time: 5.58596134185791
Epoch: 20, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.248 Vali Acc: 0.947 Test Loss: 0.248 Test Acc: 0.947
Validation loss decreased (-0.939997 --> -0.946664).  Saving model ...
Epoch: 21 cost time: 5.506651878356934
Epoch: 21, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.241 Vali Acc: 0.940 Test Loss: 0.241 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.57474422454834
Epoch: 22, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.595975875854492
Epoch: 23, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.891514778137207
Epoch: 24, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.947 Test Loss: 0.217 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 25 cost time: 6.054882287979126
Epoch: 25, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.940 Test Loss: 0.217 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.069931745529175
Epoch: 26, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.947 Test Loss: 0.208 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946665).  Saving model ...
Epoch: 27 cost time: 5.989433288574219
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.111614465713501
Epoch: 28, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.946665 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 5.957024335861206
Epoch: 29, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 5.7057204246521
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.947 Test Loss: 0.200 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 374305
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.068168878555298
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 3.091 Vali Acc: 0.087 Test Loss: 3.091 Test Acc: 0.087
Validation loss decreased (inf --> -0.086636).  Saving model ...
Epoch: 2 cost time: 7.200056791305542
Epoch: 2, Steps: 18 | Train Loss: 3.026 Vali Loss: 2.801 Vali Acc: 0.237 Test Loss: 2.801 Test Acc: 0.237
Validation loss decreased (-0.086636 --> -0.236639).  Saving model ...
Epoch: 3 cost time: 7.190156936645508
Epoch: 3, Steps: 18 | Train Loss: 2.672 Vali Loss: 2.445 Vali Acc: 0.563 Test Loss: 2.445 Test Acc: 0.563
Validation loss decreased (-0.236639 --> -0.563309).  Saving model ...
Epoch: 4 cost time: 7.218982934951782
Epoch: 4, Steps: 18 | Train Loss: 2.323 Vali Loss: 2.062 Vali Acc: 0.717 Test Loss: 2.062 Test Acc: 0.717
Validation loss decreased (-0.563309 --> -0.716646).  Saving model ...
Epoch: 5 cost time: 7.548143625259399
Epoch: 5, Steps: 18 | Train Loss: 1.865 Vali Loss: 1.695 Vali Acc: 0.810 Test Loss: 1.695 Test Acc: 0.810
Validation loss decreased (-0.716646 --> -0.809983).  Saving model ...
Epoch: 6 cost time: 7.234816789627075
Epoch: 6, Steps: 18 | Train Loss: 1.502 Vali Loss: 1.354 Vali Acc: 0.860 Test Loss: 1.354 Test Acc: 0.860
Validation loss decreased (-0.809983 --> -0.859986).  Saving model ...
Epoch: 7 cost time: 7.23508882522583
Epoch: 7, Steps: 18 | Train Loss: 1.184 Vali Loss: 1.059 Vali Acc: 0.880 Test Loss: 1.059 Test Acc: 0.880
Validation loss decreased (-0.859986 --> -0.879989).  Saving model ...
Epoch: 8 cost time: 7.374786376953125
Epoch: 8, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.839 Vali Acc: 0.910 Test Loss: 0.839 Test Acc: 0.910
Validation loss decreased (-0.879989 --> -0.909992).  Saving model ...
Epoch: 9 cost time: 7.460819244384766
Epoch: 9, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.685 Vali Acc: 0.903 Test Loss: 0.685 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.1183624267578125
Epoch: 10, Steps: 18 | Train Loss: 0.535 Vali Loss: 0.561 Vali Acc: 0.923 Test Loss: 0.561 Test Acc: 0.923
Validation loss decreased (-0.909992 --> -0.923328).  Saving model ...
Epoch: 11 cost time: 7.016758680343628
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.487 Vali Acc: 0.937 Test Loss: 0.487 Test Acc: 0.937
Validation loss decreased (-0.923328 --> -0.936662).  Saving model ...
Epoch: 12 cost time: 6.784005641937256
Epoch: 12, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.419 Vali Acc: 0.940 Test Loss: 0.419 Test Acc: 0.940
Validation loss decreased (-0.936662 --> -0.939996).  Saving model ...
Epoch: 13 cost time: 6.822196960449219
Epoch: 13, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.375 Vali Acc: 0.943 Test Loss: 0.375 Test Acc: 0.943
Validation loss decreased (-0.939996 --> -0.943330).  Saving model ...
Epoch: 14 cost time: 6.836585760116577
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.340 Vali Acc: 0.940 Test Loss: 0.340 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.97567892074585
Epoch: 15, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.316 Vali Acc: 0.943 Test Loss: 0.316 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943330).  Saving model ...
Epoch: 16 cost time: 7.3318092823028564
Epoch: 16, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.272905588150024
Epoch: 17, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.276 Vali Acc: 0.943 Test Loss: 0.276 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943331).  Saving model ...
Epoch: 18 cost time: 7.503000020980835
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.4501261711120605
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.438140392303467
Epoch: 20, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 7.081777572631836
Epoch: 21, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.240 Vali Acc: 0.940 Test Loss: 0.240 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.285758972167969
Epoch: 22, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.403631210327148
Epoch: 23, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.186327934265137
Epoch: 24, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 7.131586790084839
Epoch: 25, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 26 cost time: 6.982409715652466
Epoch: 26, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.527431488037109
Epoch: 27, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.947 Test Loss: 0.207 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.449668884277344
Epoch: 28, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 29 cost time: 7.2654149532318115
Epoch: 29, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.311648845672607
Epoch: 30, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 1202273
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.244657039642334
Epoch: 1, Steps: 18 | Train Loss: 3.287 Vali Loss: 3.209 Vali Acc: 0.067 Test Loss: 3.209 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 4.290222406387329
Epoch: 2, Steps: 18 | Train Loss: 3.093 Vali Loss: 2.927 Vali Acc: 0.183 Test Loss: 2.927 Test Acc: 0.183
Validation loss decreased (-0.066635 --> -0.183304).  Saving model ...
Epoch: 3 cost time: 4.285630464553833
Epoch: 3, Steps: 18 | Train Loss: 2.764 Vali Loss: 2.590 Vali Acc: 0.513 Test Loss: 2.590 Test Acc: 0.513
Validation loss decreased (-0.183304 --> -0.513307).  Saving model ...
Epoch: 4 cost time: 3.781290054321289
Epoch: 4, Steps: 18 | Train Loss: 2.372 Vali Loss: 2.217 Vali Acc: 0.703 Test Loss: 2.217 Test Acc: 0.703
Validation loss decreased (-0.513307 --> -0.703311).  Saving model ...
Epoch: 5 cost time: 4.36180305480957
Epoch: 5, Steps: 18 | Train Loss: 1.987 Vali Loss: 1.812 Vali Acc: 0.810 Test Loss: 1.812 Test Acc: 0.810
Validation loss decreased (-0.703311 --> -0.809982).  Saving model ...
Epoch: 6 cost time: 4.329211950302124
Epoch: 6, Steps: 18 | Train Loss: 1.541 Vali Loss: 1.427 Vali Acc: 0.847 Test Loss: 1.427 Test Acc: 0.847
Validation loss decreased (-0.809982 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 4.254556179046631
Epoch: 7, Steps: 18 | Train Loss: 1.156 Vali Loss: 1.098 Vali Acc: 0.880 Test Loss: 1.098 Test Acc: 0.880
Validation loss decreased (-0.846652 --> -0.879989).  Saving model ...
Epoch: 8 cost time: 4.305157423019409
Epoch: 8, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.861 Vali Acc: 0.887 Test Loss: 0.861 Test Acc: 0.887
Validation loss decreased (-0.879989 --> -0.886658).  Saving model ...
Epoch: 9 cost time: 4.518289566040039
Epoch: 9, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.683 Vali Acc: 0.910 Test Loss: 0.683 Test Acc: 0.910
Validation loss decreased (-0.886658 --> -0.909993).  Saving model ...
Epoch: 10 cost time: 4.659619092941284
Epoch: 10, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.568 Vali Acc: 0.913 Test Loss: 0.568 Test Acc: 0.913
Validation loss decreased (-0.909993 --> -0.913328).  Saving model ...
Epoch: 11 cost time: 4.5111610889434814
Epoch: 11, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.486 Vali Acc: 0.923 Test Loss: 0.486 Test Acc: 0.923
Validation loss decreased (-0.913328 --> -0.923328).  Saving model ...
Epoch: 12 cost time: 4.3221275806427
Epoch: 12, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.433 Vali Acc: 0.923 Test Loss: 0.433 Test Acc: 0.923
Validation loss decreased (-0.923328 --> -0.923329).  Saving model ...
Epoch: 13 cost time: 4.523454427719116
Epoch: 13, Steps: 18 | Train Loss: 0.228 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.923329 --> -0.929996).  Saving model ...
Epoch: 14 cost time: 4.560070753097534
Epoch: 14, Steps: 18 | Train Loss: 0.192 Vali Loss: 0.349 Vali Acc: 0.940 Test Loss: 0.349 Test Acc: 0.940
Validation loss decreased (-0.929996 --> -0.939997).  Saving model ...
Epoch: 15 cost time: 4.574025630950928
Epoch: 15, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.327 Vali Acc: 0.940 Test Loss: 0.327 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 16 cost time: 4.257221221923828
Epoch: 16, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.4833152294158936
Epoch: 17, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.288 Vali Acc: 0.940 Test Loss: 0.288 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 18 cost time: 4.293281078338623
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.273 Vali Acc: 0.940 Test Loss: 0.273 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 19 cost time: 4.235235214233398
Epoch: 19, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.268 Vali Acc: 0.940 Test Loss: 0.268 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 20 cost time: 4.243733167648315
Epoch: 20, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.248 Vali Acc: 0.947 Test Loss: 0.248 Test Acc: 0.947
Validation loss decreased (-0.939997 --> -0.946664).  Saving model ...
Epoch: 21 cost time: 4.4846227169036865
Epoch: 21, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.241 Vali Acc: 0.940 Test Loss: 0.241 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.442070722579956
Epoch: 22, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.2014405727386475
Epoch: 23, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.744500160217285
Epoch: 24, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.947 Test Loss: 0.217 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 25 cost time: 4.715221881866455
Epoch: 25, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.940 Test Loss: 0.217 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.712026119232178
Epoch: 26, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.947 Test Loss: 0.208 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946665).  Saving model ...
Epoch: 27 cost time: 4.539755582809448
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.785771369934082
Epoch: 28, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.946665 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 4.659867763519287
Epoch: 29, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 4.687174081802368
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.947 Test Loss: 0.200 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 374305
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.116933584213257
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 3.092 Vali Acc: 0.087 Test Loss: 3.092 Test Acc: 0.087
Validation loss decreased (inf --> -0.086636).  Saving model ...
Epoch: 2 cost time: 5.276353597640991
Epoch: 2, Steps: 18 | Train Loss: 3.029 Vali Loss: 2.802 Vali Acc: 0.233 Test Loss: 2.802 Test Acc: 0.233
Validation loss decreased (-0.086636 --> -0.233305).  Saving model ...
Epoch: 3 cost time: 5.258561611175537
Epoch: 3, Steps: 18 | Train Loss: 2.677 Vali Loss: 2.447 Vali Acc: 0.563 Test Loss: 2.447 Test Acc: 0.563
Validation loss decreased (-0.233305 --> -0.563309).  Saving model ...
Epoch: 4 cost time: 5.256742238998413
Epoch: 4, Steps: 18 | Train Loss: 2.329 Vali Loss: 2.063 Vali Acc: 0.717 Test Loss: 2.063 Test Acc: 0.717
Validation loss decreased (-0.563309 --> -0.716646).  Saving model ...
Epoch: 5 cost time: 5.276378870010376
Epoch: 5, Steps: 18 | Train Loss: 1.873 Vali Loss: 1.696 Vali Acc: 0.810 Test Loss: 1.696 Test Acc: 0.810
Validation loss decreased (-0.716646 --> -0.809983).  Saving model ...
Epoch: 6 cost time: 5.346858978271484
Epoch: 6, Steps: 18 | Train Loss: 1.511 Vali Loss: 1.354 Vali Acc: 0.857 Test Loss: 1.354 Test Acc: 0.857
Validation loss decreased (-0.809983 --> -0.856653).  Saving model ...
Epoch: 7 cost time: 5.497161388397217
Epoch: 7, Steps: 18 | Train Loss: 1.195 Vali Loss: 1.057 Vali Acc: 0.883 Test Loss: 1.057 Test Acc: 0.883
Validation loss decreased (-0.856653 --> -0.883323).  Saving model ...
Epoch: 8 cost time: 5.584781885147095
Epoch: 8, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.836 Vali Acc: 0.913 Test Loss: 0.836 Test Acc: 0.913
Validation loss decreased (-0.883323 --> -0.913325).  Saving model ...
Epoch: 9 cost time: 5.541081666946411
Epoch: 9, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.678 Vali Acc: 0.910 Test Loss: 0.678 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.3151938915252686
Epoch: 10, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.554 Vali Acc: 0.923 Test Loss: 0.554 Test Acc: 0.923
Validation loss decreased (-0.913325 --> -0.923328).  Saving model ...
Epoch: 11 cost time: 4.312595367431641
Epoch: 11, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.476 Vali Acc: 0.943 Test Loss: 0.476 Test Acc: 0.943
Validation loss decreased (-0.923328 --> -0.943329).  Saving model ...
Epoch: 12 cost time: 5.4955291748046875
Epoch: 12, Steps: 18 | Train Loss: 0.316 Vali Loss: 0.407 Vali Acc: 0.950 Test Loss: 0.407 Test Acc: 0.950
Validation loss decreased (-0.943329 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 5.357219934463501
Epoch: 13, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.362 Vali Acc: 0.947 Test Loss: 0.362 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.43947958946228
Epoch: 14, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.326 Vali Acc: 0.947 Test Loss: 0.326 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.277437448501587
Epoch: 15, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.301 Vali Acc: 0.947 Test Loss: 0.301 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.293488025665283
Epoch: 16, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.282 Vali Acc: 0.943 Test Loss: 0.282 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.39372444152832
Epoch: 17, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 5.396486043930054
Epoch: 18, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.253 Vali Acc: 0.947 Test Loss: 0.253 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.423585891723633
Epoch: 19, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.238 Vali Acc: 0.940 Test Loss: 0.238 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.399370431900024
Epoch: 20, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
Validation loss decreased (-0.949997 --> -0.956665).  Saving model ...
Epoch: 21 cost time: 5.421473741531372
Epoch: 21, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.219 Vali Acc: 0.947 Test Loss: 0.219 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.5354485511779785
Epoch: 22, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.675943851470947
Epoch: 23, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.780948638916016
Epoch: 24, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 25 cost time: 5.750359773635864
Epoch: 25, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.8063836097717285
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.850991487503052
Epoch: 27, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 28 cost time: 5.802684783935547
Epoch: 28, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 5.778192758560181
Epoch: 29, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.734800815582275
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1202273
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.792631149291992
Epoch: 1, Steps: 18 | Train Loss: 3.287 Vali Loss: 3.209 Vali Acc: 0.067 Test Loss: 3.209 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 4.161793947219849
Epoch: 2, Steps: 18 | Train Loss: 3.095 Vali Loss: 2.929 Vali Acc: 0.183 Test Loss: 2.929 Test Acc: 0.183
Validation loss decreased (-0.066635 --> -0.183304).  Saving model ...
Epoch: 3 cost time: 3.9308974742889404
Epoch: 3, Steps: 18 | Train Loss: 2.769 Vali Loss: 2.593 Vali Acc: 0.517 Test Loss: 2.593 Test Acc: 0.517
Validation loss decreased (-0.183304 --> -0.516641).  Saving model ...
Epoch: 4 cost time: 4.124640226364136
Epoch: 4, Steps: 18 | Train Loss: 2.384 Vali Loss: 2.221 Vali Acc: 0.700 Test Loss: 2.221 Test Acc: 0.700
Validation loss decreased (-0.516641 --> -0.699978).  Saving model ...
Epoch: 5 cost time: 3.971672296524048
Epoch: 5, Steps: 18 | Train Loss: 2.001 Vali Loss: 1.817 Vali Acc: 0.807 Test Loss: 1.817 Test Acc: 0.807
Validation loss decreased (-0.699978 --> -0.806648).  Saving model ...
Epoch: 6 cost time: 3.9760687351226807
Epoch: 6, Steps: 18 | Train Loss: 1.558 Vali Loss: 1.433 Vali Acc: 0.847 Test Loss: 1.433 Test Acc: 0.847
Validation loss decreased (-0.806648 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 4.03985595703125
Epoch: 7, Steps: 18 | Train Loss: 1.174 Vali Loss: 1.102 Vali Acc: 0.883 Test Loss: 1.102 Test Acc: 0.883
Validation loss decreased (-0.846652 --> -0.883322).  Saving model ...
Epoch: 8 cost time: 3.9870619773864746
Epoch: 8, Steps: 18 | Train Loss: 0.858 Vali Loss: 0.860 Vali Acc: 0.897 Test Loss: 0.860 Test Acc: 0.897
Validation loss decreased (-0.883322 --> -0.896658).  Saving model ...
Epoch: 9 cost time: 4.037868976593018
Epoch: 9, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.680 Vali Acc: 0.907 Test Loss: 0.680 Test Acc: 0.907
Validation loss decreased (-0.896658 --> -0.906660).  Saving model ...
Epoch: 10 cost time: 3.9442858695983887
Epoch: 10, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.565 Vali Acc: 0.913 Test Loss: 0.565 Test Acc: 0.913
Validation loss decreased (-0.906660 --> -0.913328).  Saving model ...
Epoch: 11 cost time: 3.925755023956299
Epoch: 11, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.483 Vali Acc: 0.923 Test Loss: 0.483 Test Acc: 0.923
Validation loss decreased (-0.913328 --> -0.923329).  Saving model ...
Epoch: 12 cost time: 3.9830265045166016
Epoch: 12, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.430 Vali Acc: 0.917 Test Loss: 0.430 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.04139256477356
Epoch: 13, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.381 Vali Acc: 0.933 Test Loss: 0.381 Test Acc: 0.933
Validation loss decreased (-0.923329 --> -0.933330).  Saving model ...
Epoch: 14 cost time: 4.029637336730957
Epoch: 14, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 4.042399168014526
Epoch: 15, Steps: 18 | Train Loss: 0.156 Vali Loss: 0.322 Vali Acc: 0.943 Test Loss: 0.322 Test Acc: 0.943
Validation loss decreased (-0.933330 --> -0.943330).  Saving model ...
Epoch: 16 cost time: 4.027373790740967
Epoch: 16, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.301 Vali Acc: 0.937 Test Loss: 0.301 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.056000232696533
Epoch: 17, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.284 Vali Acc: 0.943 Test Loss: 0.284 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943330).  Saving model ...
Epoch: 18 cost time: 4.057159662246704
Epoch: 18, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.943330 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 4.064151763916016
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 4.132652044296265
Epoch: 20, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.243 Vali Acc: 0.947 Test Loss: 0.243 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.185171127319336
Epoch: 21, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 4.1689133644104
Epoch: 22, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953331).  Saving model ...
Epoch: 23 cost time: 4.1492674350738525
Epoch: 23, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.979706048965454
Epoch: 24, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.212 Vali Acc: 0.953 Test Loss: 0.212 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 25 cost time: 4.0282509326934814
Epoch: 25, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.947 Test Loss: 0.211 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.195793628692627
Epoch: 26, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 27 cost time: 4.288546800613403
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.181626796722412
Epoch: 28, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 29 cost time: 4.132890462875366
Epoch: 29, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.0419862270355225
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 374305
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.551481246948242
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.155 Vali Acc: 0.123 Test Loss: 3.155 Test Acc: 0.123
Validation loss decreased (inf --> -0.123302).  Saving model ...
Epoch: 2 cost time: 7.7741920948028564
Epoch: 2, Steps: 18 | Train Loss: 3.022 Vali Loss: 2.872 Vali Acc: 0.283 Test Loss: 2.872 Test Acc: 0.283
Validation loss decreased (-0.123302 --> -0.283305).  Saving model ...
Epoch: 3 cost time: 7.621613025665283
Epoch: 3, Steps: 18 | Train Loss: 2.689 Vali Loss: 2.521 Vali Acc: 0.543 Test Loss: 2.521 Test Acc: 0.543
Validation loss decreased (-0.283305 --> -0.543308).  Saving model ...
Epoch: 4 cost time: 7.2487757205963135
Epoch: 4, Steps: 18 | Train Loss: 2.330 Vali Loss: 2.137 Vali Acc: 0.763 Test Loss: 2.137 Test Acc: 0.763
Validation loss decreased (-0.543308 --> -0.763312).  Saving model ...
Epoch: 5 cost time: 7.439399719238281
Epoch: 5, Steps: 18 | Train Loss: 1.906 Vali Loss: 1.746 Vali Acc: 0.847 Test Loss: 1.746 Test Acc: 0.847
Validation loss decreased (-0.763312 --> -0.846649).  Saving model ...
Epoch: 6 cost time: 7.4674859046936035
Epoch: 6, Steps: 18 | Train Loss: 1.502 Vali Loss: 1.381 Vali Acc: 0.877 Test Loss: 1.381 Test Acc: 0.877
Validation loss decreased (-0.846649 --> -0.876653).  Saving model ...
Epoch: 7 cost time: 7.237595081329346
Epoch: 7, Steps: 18 | Train Loss: 1.143 Vali Loss: 1.076 Vali Acc: 0.893 Test Loss: 1.076 Test Acc: 0.893
Validation loss decreased (-0.876653 --> -0.893323).  Saving model ...
Epoch: 8 cost time: 7.266151666641235
Epoch: 8, Steps: 18 | Train Loss: 0.845 Vali Loss: 0.834 Vali Acc: 0.933 Test Loss: 0.834 Test Acc: 0.933
Validation loss decreased (-0.893323 --> -0.933325).  Saving model ...
Epoch: 9 cost time: 7.718507289886475
Epoch: 9, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.654 Vali Acc: 0.933 Test Loss: 0.654 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933327).  Saving model ...
Epoch: 10 cost time: 7.849487066268921
Epoch: 10, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.531 Vali Acc: 0.943 Test Loss: 0.531 Test Acc: 0.943
Validation loss decreased (-0.933327 --> -0.943328).  Saving model ...
Epoch: 11 cost time: 7.712507724761963
Epoch: 11, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.453 Vali Acc: 0.953 Test Loss: 0.453 Test Acc: 0.953
Validation loss decreased (-0.943328 --> -0.953329).  Saving model ...
Epoch: 12 cost time: 7.811625719070435
Epoch: 12, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.806434154510498
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.350 Vali Acc: 0.963 Test Loss: 0.350 Test Acc: 0.963
Validation loss decreased (-0.953329 --> -0.963330).  Saving model ...
Epoch: 14 cost time: 7.787869453430176
Epoch: 14, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.318 Vali Acc: 0.963 Test Loss: 0.318 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963330).  Saving model ...
Epoch: 15 cost time: 7.615350723266602
Epoch: 15, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.288 Vali Acc: 0.960 Test Loss: 0.288 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.034897565841675
Epoch: 16, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.265 Vali Acc: 0.960 Test Loss: 0.265 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.909948110580444
Epoch: 17, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.248 Vali Acc: 0.957 Test Loss: 0.248 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.435089349746704
Epoch: 18, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 19 cost time: 7.549698829650879
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.534285306930542
Epoch: 20, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.654785633087158
Epoch: 21, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.205 Vali Acc: 0.953 Test Loss: 0.205 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.617360591888428
Epoch: 22, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.52743673324585
Epoch: 23, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.697218656539917
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.605536222457886
Epoch: 25, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.394843339920044
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.811474323272705
Epoch: 27, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.778211832046509
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 615777
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.634074449539185
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 3.126 Vali Acc: 0.103 Test Loss: 3.126 Test Acc: 0.103
Validation loss decreased (inf --> -0.103302).  Saving model ...
Epoch: 2 cost time: 4.515337705612183
Epoch: 2, Steps: 18 | Train Loss: 2.998 Vali Loss: 2.830 Vali Acc: 0.287 Test Loss: 2.830 Test Acc: 0.287
Validation loss decreased (-0.103302 --> -0.286638).  Saving model ...
Epoch: 3 cost time: 4.796387195587158
Epoch: 3, Steps: 18 | Train Loss: 2.662 Vali Loss: 2.456 Vali Acc: 0.540 Test Loss: 2.456 Test Acc: 0.540
Validation loss decreased (-0.286638 --> -0.539975).  Saving model ...
Epoch: 4 cost time: 4.672183990478516
Epoch: 4, Steps: 18 | Train Loss: 2.246 Vali Loss: 2.053 Vali Acc: 0.727 Test Loss: 2.053 Test Acc: 0.727
Validation loss decreased (-0.539975 --> -0.726646).  Saving model ...
Epoch: 5 cost time: 4.286394834518433
Epoch: 5, Steps: 18 | Train Loss: 1.818 Vali Loss: 1.657 Vali Acc: 0.833 Test Loss: 1.657 Test Acc: 0.833
Validation loss decreased (-0.726646 --> -0.833317).  Saving model ...
Epoch: 6 cost time: 4.871776103973389
Epoch: 6, Steps: 18 | Train Loss: 1.438 Vali Loss: 1.309 Vali Acc: 0.853 Test Loss: 1.309 Test Acc: 0.853
Validation loss decreased (-0.833317 --> -0.853320).  Saving model ...
Epoch: 7 cost time: 4.613736152648926
Epoch: 7, Steps: 18 | Train Loss: 1.085 Vali Loss: 1.022 Vali Acc: 0.897 Test Loss: 1.022 Test Acc: 0.897
Validation loss decreased (-0.853320 --> -0.896656).  Saving model ...
Epoch: 8 cost time: 4.836857318878174
Epoch: 8, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.812 Vali Acc: 0.917 Test Loss: 0.812 Test Acc: 0.917
Validation loss decreased (-0.896656 --> -0.916659).  Saving model ...
Epoch: 9 cost time: 4.740815162658691
Epoch: 9, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.659 Vali Acc: 0.923 Test Loss: 0.659 Test Acc: 0.923
Validation loss decreased (-0.916659 --> -0.923327).  Saving model ...
Epoch: 10 cost time: 4.745765686035156
Epoch: 10, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.558 Vali Acc: 0.933 Test Loss: 0.558 Test Acc: 0.933
Validation loss decreased (-0.923327 --> -0.933328).  Saving model ...
Epoch: 11 cost time: 4.69877552986145
Epoch: 11, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.480 Vali Acc: 0.950 Test Loss: 0.480 Test Acc: 0.950
Validation loss decreased (-0.933328 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 4.587264776229858
Epoch: 12, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.431 Vali Acc: 0.937 Test Loss: 0.431 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.762554883956909
Epoch: 13, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 4.62179160118103
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.353 Vali Acc: 0.953 Test Loss: 0.353 Test Acc: 0.953
Validation loss decreased (-0.949996 --> -0.953330).  Saving model ...
Epoch: 15 cost time: 4.864630699157715
Epoch: 15, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.323 Vali Acc: 0.957 Test Loss: 0.323 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956663).  Saving model ...
Epoch: 16 cost time: 4.732195138931274
Epoch: 16, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.310 Vali Acc: 0.953 Test Loss: 0.310 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.872561931610107
Epoch: 17, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.292 Vali Acc: 0.960 Test Loss: 0.292 Test Acc: 0.960
Validation loss decreased (-0.956663 --> -0.959997).  Saving model ...
Epoch: 18 cost time: 4.814536094665527
Epoch: 18, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.276 Vali Acc: 0.960 Test Loss: 0.276 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959997).  Saving model ...
Epoch: 19 cost time: 4.67633318901062
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.953 Test Loss: 0.267 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.851041793823242
Epoch: 20, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.252 Vali Acc: 0.957 Test Loss: 0.252 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.844273567199707
Epoch: 21, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.035758018493652
Epoch: 22, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 23 cost time: 4.8773558139801025
Epoch: 23, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.957 Test Loss: 0.229 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.853675365447998
Epoch: 24, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 25 cost time: 4.998632431030273
Epoch: 25, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.963894367218018
Epoch: 26, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.030166387557983
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.960 Test Loss: 0.213 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.871615648269653
Epoch: 28, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 29 cost time: 5.134406805038452
Epoch: 29, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.099785566329956
Epoch: 30, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 201761
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.188705205917358
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.155 Vali Acc: 0.123 Test Loss: 3.155 Test Acc: 0.123
Validation loss decreased (inf --> -0.123302).  Saving model ...
Epoch: 2 cost time: 5.993973255157471
Epoch: 2, Steps: 18 | Train Loss: 3.022 Vali Loss: 2.872 Vali Acc: 0.283 Test Loss: 2.872 Test Acc: 0.283
Validation loss decreased (-0.123302 --> -0.283305).  Saving model ...
Epoch: 3 cost time: 4.631025075912476
Epoch: 3, Steps: 18 | Train Loss: 2.689 Vali Loss: 2.521 Vali Acc: 0.543 Test Loss: 2.521 Test Acc: 0.543
Validation loss decreased (-0.283305 --> -0.543308).  Saving model ...
Epoch: 4 cost time: 6.159374952316284
Epoch: 4, Steps: 18 | Train Loss: 2.330 Vali Loss: 2.137 Vali Acc: 0.763 Test Loss: 2.137 Test Acc: 0.763
Validation loss decreased (-0.543308 --> -0.763312).  Saving model ...
Epoch: 5 cost time: 6.175278186798096
Epoch: 5, Steps: 18 | Train Loss: 1.905 Vali Loss: 1.746 Vali Acc: 0.847 Test Loss: 1.746 Test Acc: 0.847
Validation loss decreased (-0.763312 --> -0.846649).  Saving model ...
Epoch: 6 cost time: 6.257443428039551
Epoch: 6, Steps: 18 | Train Loss: 1.502 Vali Loss: 1.381 Vali Acc: 0.877 Test Loss: 1.381 Test Acc: 0.877
Validation loss decreased (-0.846649 --> -0.876653).  Saving model ...
Epoch: 7 cost time: 6.06179141998291
Epoch: 7, Steps: 18 | Train Loss: 1.143 Vali Loss: 1.076 Vali Acc: 0.893 Test Loss: 1.076 Test Acc: 0.893
Validation loss decreased (-0.876653 --> -0.893323).  Saving model ...
Epoch: 8 cost time: 6.07057785987854
Epoch: 8, Steps: 18 | Train Loss: 0.845 Vali Loss: 0.834 Vali Acc: 0.933 Test Loss: 0.834 Test Acc: 0.933
Validation loss decreased (-0.893323 --> -0.933325).  Saving model ...
Epoch: 9 cost time: 6.140744924545288
Epoch: 9, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.654 Vali Acc: 0.933 Test Loss: 0.654 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933327).  Saving model ...
Epoch: 10 cost time: 6.221322774887085
Epoch: 10, Steps: 18 | Train Loss: 0.463 Vali Loss: 0.531 Vali Acc: 0.943 Test Loss: 0.531 Test Acc: 0.943
Validation loss decreased (-0.933327 --> -0.943328).  Saving model ...
Epoch: 11 cost time: 6.171850681304932
Epoch: 11, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.453 Vali Acc: 0.953 Test Loss: 0.453 Test Acc: 0.953
Validation loss decreased (-0.943328 --> -0.953329).  Saving model ...
Epoch: 12 cost time: 6.32413911819458
Epoch: 12, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.373262405395508
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.350 Vali Acc: 0.963 Test Loss: 0.350 Test Acc: 0.963
Validation loss decreased (-0.953329 --> -0.963330).  Saving model ...
Epoch: 14 cost time: 6.4320783615112305
Epoch: 14, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.318 Vali Acc: 0.963 Test Loss: 0.318 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963330).  Saving model ...
Epoch: 15 cost time: 6.4887471199035645
Epoch: 15, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.288 Vali Acc: 0.960 Test Loss: 0.288 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.494412899017334
Epoch: 16, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.265 Vali Acc: 0.960 Test Loss: 0.265 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.467379808425903
Epoch: 17, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.248 Vali Acc: 0.957 Test Loss: 0.248 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.410221815109253
Epoch: 18, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 19 cost time: 6.473984479904175
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.462671279907227
Epoch: 20, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.467814683914185
Epoch: 21, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.205 Vali Acc: 0.953 Test Loss: 0.205 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.413952112197876
Epoch: 22, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.276921033859253
Epoch: 23, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.260213375091553
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.302158832550049
Epoch: 25, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.333246231079102
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.15554141998291
Epoch: 27, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.1103034019470215
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 615777
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.23581600189209
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 3.126 Vali Acc: 0.103 Test Loss: 3.126 Test Acc: 0.103
Validation loss decreased (inf --> -0.103302).  Saving model ...
Epoch: 2 cost time: 4.298522472381592
Epoch: 2, Steps: 18 | Train Loss: 2.998 Vali Loss: 2.830 Vali Acc: 0.287 Test Loss: 2.830 Test Acc: 0.287
Validation loss decreased (-0.103302 --> -0.286638).  Saving model ...
Epoch: 3 cost time: 4.214452743530273
Epoch: 3, Steps: 18 | Train Loss: 2.662 Vali Loss: 2.456 Vali Acc: 0.540 Test Loss: 2.456 Test Acc: 0.540
Validation loss decreased (-0.286638 --> -0.539975).  Saving model ...
Epoch: 4 cost time: 4.386561632156372
Epoch: 4, Steps: 18 | Train Loss: 2.246 Vali Loss: 2.053 Vali Acc: 0.727 Test Loss: 2.053 Test Acc: 0.727
Validation loss decreased (-0.539975 --> -0.726646).  Saving model ...
Epoch: 5 cost time: 4.411938667297363
Epoch: 5, Steps: 18 | Train Loss: 1.818 Vali Loss: 1.657 Vali Acc: 0.833 Test Loss: 1.657 Test Acc: 0.833
Validation loss decreased (-0.726646 --> -0.833317).  Saving model ...
Epoch: 6 cost time: 4.371875762939453
Epoch: 6, Steps: 18 | Train Loss: 1.438 Vali Loss: 1.309 Vali Acc: 0.853 Test Loss: 1.309 Test Acc: 0.853
Validation loss decreased (-0.833317 --> -0.853320).  Saving model ...
Epoch: 7 cost time: 4.236988067626953
Epoch: 7, Steps: 18 | Train Loss: 1.085 Vali Loss: 1.022 Vali Acc: 0.897 Test Loss: 1.022 Test Acc: 0.897
Validation loss decreased (-0.853320 --> -0.896656).  Saving model ...
Epoch: 8 cost time: 4.428033351898193
Epoch: 8, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.812 Vali Acc: 0.917 Test Loss: 0.812 Test Acc: 0.917
Validation loss decreased (-0.896656 --> -0.916659).  Saving model ...
Epoch: 9 cost time: 3.9503424167633057
Epoch: 9, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.659 Vali Acc: 0.923 Test Loss: 0.659 Test Acc: 0.923
Validation loss decreased (-0.916659 --> -0.923327).  Saving model ...
Epoch: 10 cost time: 4.502286911010742
Epoch: 10, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.558 Vali Acc: 0.933 Test Loss: 0.558 Test Acc: 0.933
Validation loss decreased (-0.923327 --> -0.933328).  Saving model ...
Epoch: 11 cost time: 4.465638875961304
Epoch: 11, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.480 Vali Acc: 0.950 Test Loss: 0.480 Test Acc: 0.950
Validation loss decreased (-0.933328 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 4.484004497528076
Epoch: 12, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.431 Vali Acc: 0.937 Test Loss: 0.431 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.467742204666138
Epoch: 13, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 4.480643033981323
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.353 Vali Acc: 0.953 Test Loss: 0.353 Test Acc: 0.953
Validation loss decreased (-0.949996 --> -0.953330).  Saving model ...
Epoch: 15 cost time: 4.524962425231934
Epoch: 15, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.323 Vali Acc: 0.957 Test Loss: 0.323 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956663).  Saving model ...
Epoch: 16 cost time: 4.473840713500977
Epoch: 16, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.310 Vali Acc: 0.953 Test Loss: 0.310 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.579813241958618
Epoch: 17, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.292 Vali Acc: 0.960 Test Loss: 0.292 Test Acc: 0.960
Validation loss decreased (-0.956663 --> -0.959997).  Saving model ...
Epoch: 18 cost time: 4.521112680435181
Epoch: 18, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.276 Vali Acc: 0.960 Test Loss: 0.276 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959997).  Saving model ...
Epoch: 19 cost time: 4.335458517074585
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.953 Test Loss: 0.267 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.35915732383728
Epoch: 20, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.252 Vali Acc: 0.957 Test Loss: 0.252 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.399877548217773
Epoch: 21, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.421047687530518
Epoch: 22, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 23 cost time: 4.360430955886841
Epoch: 23, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.957 Test Loss: 0.229 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.246094703674316
Epoch: 24, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 25 cost time: 4.394975662231445
Epoch: 25, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.441986560821533
Epoch: 26, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.324591875076294
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.960 Test Loss: 0.213 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.3481385707855225
Epoch: 28, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 29 cost time: 4.352776765823364
Epoch: 29, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.1081178188323975
Epoch: 30, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 201761
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.373737573623657
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 3.157 Vali Acc: 0.127 Test Loss: 3.157 Test Acc: 0.127
Validation loss decreased (inf --> -0.126635).  Saving model ...
Epoch: 2 cost time: 4.523902654647827
Epoch: 2, Steps: 18 | Train Loss: 3.027 Vali Loss: 2.878 Vali Acc: 0.273 Test Loss: 2.878 Test Acc: 0.273
Validation loss decreased (-0.126635 --> -0.273305).  Saving model ...
Epoch: 3 cost time: 4.548543691635132
Epoch: 3, Steps: 18 | Train Loss: 2.699 Vali Loss: 2.530 Vali Acc: 0.517 Test Loss: 2.530 Test Acc: 0.517
Validation loss decreased (-0.273305 --> -0.516641).  Saving model ...
Epoch: 4 cost time: 4.455589771270752
Epoch: 4, Steps: 18 | Train Loss: 2.347 Vali Loss: 2.149 Vali Acc: 0.753 Test Loss: 2.149 Test Acc: 0.753
Validation loss decreased (-0.516641 --> -0.753312).  Saving model ...
Epoch: 5 cost time: 4.564829111099243
Epoch: 5, Steps: 18 | Train Loss: 1.932 Vali Loss: 1.760 Vali Acc: 0.843 Test Loss: 1.760 Test Acc: 0.843
Validation loss decreased (-0.753312 --> -0.843316).  Saving model ...
Epoch: 6 cost time: 4.585441589355469
Epoch: 6, Steps: 18 | Train Loss: 1.529 Vali Loss: 1.394 Vali Acc: 0.873 Test Loss: 1.394 Test Acc: 0.873
Validation loss decreased (-0.843316 --> -0.873319).  Saving model ...
Epoch: 7 cost time: 4.63538670539856
Epoch: 7, Steps: 18 | Train Loss: 1.166 Vali Loss: 1.084 Vali Acc: 0.907 Test Loss: 1.084 Test Acc: 0.907
Validation loss decreased (-0.873319 --> -0.906656).  Saving model ...
Epoch: 8 cost time: 4.5416624546051025
Epoch: 8, Steps: 18 | Train Loss: 0.867 Vali Loss: 0.831 Vali Acc: 0.927 Test Loss: 0.831 Test Acc: 0.927
Validation loss decreased (-0.906656 --> -0.926658).  Saving model ...
Epoch: 9 cost time: 4.600722789764404
Epoch: 9, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.646 Vali Acc: 0.930 Test Loss: 0.646 Test Acc: 0.930
Validation loss decreased (-0.926658 --> -0.929994).  Saving model ...
Epoch: 10 cost time: 4.609458923339844
Epoch: 10, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.516 Vali Acc: 0.950 Test Loss: 0.516 Test Acc: 0.950
Validation loss decreased (-0.929994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 4.587461709976196
Epoch: 11, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.429 Vali Acc: 0.960 Test Loss: 0.429 Test Acc: 0.960
Validation loss decreased (-0.949995 --> -0.959996).  Saving model ...
Epoch: 12 cost time: 4.4137818813323975
Epoch: 12, Steps: 18 | Train Loss: 0.287 Vali Loss: 0.366 Vali Acc: 0.953 Test Loss: 0.366 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.6533472537994385
Epoch: 13, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.322 Vali Acc: 0.963 Test Loss: 0.322 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 14 cost time: 4.554804086685181
Epoch: 14, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.289 Vali Acc: 0.970 Test Loss: 0.289 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969997).  Saving model ...
Epoch: 15 cost time: 4.587982177734375
Epoch: 15, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.262 Vali Acc: 0.963 Test Loss: 0.262 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.5181121826171875
Epoch: 16, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.509440898895264
Epoch: 17, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.224 Vali Acc: 0.970 Test Loss: 0.224 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 18 cost time: 4.502898693084717
Epoch: 18, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.590595960617065
Epoch: 19, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 20 cost time: 4.6043617725372314
Epoch: 20, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 21 cost time: 4.610256671905518
Epoch: 21, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.59500789642334
Epoch: 22, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.619413375854492
Epoch: 23, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.712700366973877
Epoch: 24, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.712597846984863
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 4.738142013549805
Epoch: 26, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.8882551193237305
Epoch: 27, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.765456438064575
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.905765771865845
Epoch: 29, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.871342658996582
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 615777
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.861770868301392
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 3.128 Vali Acc: 0.103 Test Loss: 3.128 Test Acc: 0.103
Validation loss decreased (inf --> -0.103302).  Saving model ...
Epoch: 2 cost time: 3.9726955890655518
Epoch: 2, Steps: 18 | Train Loss: 3.002 Vali Loss: 2.833 Vali Acc: 0.283 Test Loss: 2.833 Test Acc: 0.283
Validation loss decreased (-0.103302 --> -0.283305).  Saving model ...
Epoch: 3 cost time: 3.9494194984436035
Epoch: 3, Steps: 18 | Train Loss: 2.666 Vali Loss: 2.460 Vali Acc: 0.537 Test Loss: 2.460 Test Acc: 0.537
Validation loss decreased (-0.283305 --> -0.536642).  Saving model ...
Epoch: 4 cost time: 4.045890808105469
Epoch: 4, Steps: 18 | Train Loss: 2.257 Vali Loss: 2.058 Vali Acc: 0.730 Test Loss: 2.058 Test Acc: 0.730
Validation loss decreased (-0.536642 --> -0.729979).  Saving model ...
Epoch: 5 cost time: 4.01934289932251
Epoch: 5, Steps: 18 | Train Loss: 1.827 Vali Loss: 1.664 Vali Acc: 0.827 Test Loss: 1.664 Test Acc: 0.827
Validation loss decreased (-0.729979 --> -0.826650).  Saving model ...
Epoch: 6 cost time: 3.964614152908325
Epoch: 6, Steps: 18 | Train Loss: 1.452 Vali Loss: 1.317 Vali Acc: 0.860 Test Loss: 1.317 Test Acc: 0.860
Validation loss decreased (-0.826650 --> -0.859987).  Saving model ...
Epoch: 7 cost time: 3.9806134700775146
Epoch: 7, Steps: 18 | Train Loss: 1.098 Vali Loss: 1.028 Vali Acc: 0.900 Test Loss: 1.028 Test Acc: 0.900
Validation loss decreased (-0.859987 --> -0.899990).  Saving model ...
Epoch: 8 cost time: 3.919595241546631
Epoch: 8, Steps: 18 | Train Loss: 0.849 Vali Loss: 0.814 Vali Acc: 0.913 Test Loss: 0.814 Test Acc: 0.913
Validation loss decreased (-0.899990 --> -0.913325).  Saving model ...
Epoch: 9 cost time: 3.9752750396728516
Epoch: 9, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.659 Vali Acc: 0.930 Test Loss: 0.659 Test Acc: 0.930
Validation loss decreased (-0.913325 --> -0.929993).  Saving model ...
Epoch: 10 cost time: 3.8891618251800537
Epoch: 10, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.554 Vali Acc: 0.937 Test Loss: 0.554 Test Acc: 0.937
Validation loss decreased (-0.929993 --> -0.936661).  Saving model ...
Epoch: 11 cost time: 3.7638182640075684
Epoch: 11, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.475 Vali Acc: 0.947 Test Loss: 0.475 Test Acc: 0.947
Validation loss decreased (-0.936661 --> -0.946662).  Saving model ...
Epoch: 12 cost time: 3.8162479400634766
Epoch: 12, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.423 Vali Acc: 0.940 Test Loss: 0.423 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7696003913879395
Epoch: 13, Steps: 18 | Train Loss: 0.263 Vali Loss: 0.373 Vali Acc: 0.957 Test Loss: 0.373 Test Acc: 0.957
Validation loss decreased (-0.946662 --> -0.956663).  Saving model ...
Epoch: 14 cost time: 3.742798089981079
Epoch: 14, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.344 Vali Acc: 0.953 Test Loss: 0.344 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8128559589385986
Epoch: 15, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.313 Vali Acc: 0.957 Test Loss: 0.313 Test Acc: 0.957
Validation loss decreased (-0.956663 --> -0.956664).  Saving model ...
Epoch: 16 cost time: 3.784163236618042
Epoch: 16, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.299 Vali Acc: 0.953 Test Loss: 0.299 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7721147537231445
Epoch: 17, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959997).  Saving model ...
Epoch: 18 cost time: 3.63761305809021
Epoch: 18, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.261 Vali Acc: 0.963 Test Loss: 0.261 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 19 cost time: 3.781170606613159
Epoch: 19, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.253 Vali Acc: 0.957 Test Loss: 0.253 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9006338119506836
Epoch: 20, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.239 Vali Acc: 0.960 Test Loss: 0.239 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7680678367614746
Epoch: 21, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.229 Vali Acc: 0.953 Test Loss: 0.229 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.9453346729278564
Epoch: 22, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.215 Vali Acc: 0.963 Test Loss: 0.215 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 23 cost time: 3.9066615104675293
Epoch: 23, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.957 Test Loss: 0.218 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8967080116271973
Epoch: 24, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 25 cost time: 3.967327117919922
Epoch: 25, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.211 Vali Acc: 0.960 Test Loss: 0.211 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.049667835235596
Epoch: 26, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.199 Vali Acc: 0.960 Test Loss: 0.199 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.935985565185547
Epoch: 27, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 28 cost time: 3.920592784881592
Epoch: 28, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 29 cost time: 3.9569642543792725
Epoch: 29, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.933826446533203
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 201761
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.706207036972046
Epoch: 1, Steps: 18 | Train Loss: 3.221 Vali Loss: 3.111 Vali Acc: 0.127 Test Loss: 3.111 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 7.041841506958008
Epoch: 2, Steps: 18 | Train Loss: 2.971 Vali Loss: 2.842 Vali Acc: 0.227 Test Loss: 2.842 Test Acc: 0.227
Validation loss decreased (-0.126636 --> -0.226638).  Saving model ...
Epoch: 3 cost time: 7.043232679367065
Epoch: 3, Steps: 18 | Train Loss: 2.693 Vali Loss: 2.511 Vali Acc: 0.447 Test Loss: 2.511 Test Acc: 0.447
Validation loss decreased (-0.226638 --> -0.446642).  Saving model ...
Epoch: 4 cost time: 7.009735107421875
Epoch: 4, Steps: 18 | Train Loss: 2.327 Vali Loss: 2.169 Vali Acc: 0.660 Test Loss: 2.169 Test Acc: 0.660
Validation loss decreased (-0.446642 --> -0.659978).  Saving model ...
Epoch: 5 cost time: 6.822371482849121
Epoch: 5, Steps: 18 | Train Loss: 1.958 Vali Loss: 1.838 Vali Acc: 0.790 Test Loss: 1.838 Test Acc: 0.790
Validation loss decreased (-0.659978 --> -0.789982).  Saving model ...
Epoch: 6 cost time: 6.856419801712036
Epoch: 6, Steps: 18 | Train Loss: 1.552 Vali Loss: 1.524 Vali Acc: 0.823 Test Loss: 1.524 Test Acc: 0.823
Validation loss decreased (-0.789982 --> -0.823318).  Saving model ...
Epoch: 7 cost time: 6.837259292602539
Epoch: 7, Steps: 18 | Train Loss: 1.238 Vali Loss: 1.245 Vali Acc: 0.833 Test Loss: 1.245 Test Acc: 0.833
Validation loss decreased (-0.823318 --> -0.833321).  Saving model ...
Epoch: 8 cost time: 6.7989442348480225
Epoch: 8, Steps: 18 | Train Loss: 0.951 Vali Loss: 0.994 Vali Acc: 0.867 Test Loss: 0.994 Test Acc: 0.867
Validation loss decreased (-0.833321 --> -0.866657).  Saving model ...
Epoch: 9 cost time: 6.611245155334473
Epoch: 9, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.800 Vali Acc: 0.883 Test Loss: 0.800 Test Acc: 0.883
Validation loss decreased (-0.866657 --> -0.883325).  Saving model ...
Epoch: 10 cost time: 6.568079710006714
Epoch: 10, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.659 Vali Acc: 0.887 Test Loss: 0.659 Test Acc: 0.887
Validation loss decreased (-0.883325 --> -0.886660).  Saving model ...
Epoch: 11 cost time: 6.673022747039795
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.556 Vali Acc: 0.897 Test Loss: 0.556 Test Acc: 0.897
Validation loss decreased (-0.886660 --> -0.896661).  Saving model ...
Epoch: 12 cost time: 6.609060764312744
Epoch: 12, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.483 Vali Acc: 0.893 Test Loss: 0.483 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.522077798843384
Epoch: 13, Steps: 18 | Train Loss: 0.238 Vali Loss: 0.434 Vali Acc: 0.893 Test Loss: 0.434 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.837775468826294
Epoch: 14, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.390 Vali Acc: 0.907 Test Loss: 0.390 Test Acc: 0.907
Validation loss decreased (-0.896661 --> -0.906663).  Saving model ...
Epoch: 15 cost time: 6.873619079589844
Epoch: 15, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.364 Vali Acc: 0.913 Test Loss: 0.364 Test Acc: 0.913
Validation loss decreased (-0.906663 --> -0.913330).  Saving model ...
Epoch: 16 cost time: 6.852082967758179
Epoch: 16, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.337 Vali Acc: 0.927 Test Loss: 0.337 Test Acc: 0.927
Validation loss decreased (-0.913330 --> -0.926663).  Saving model ...
Epoch: 17 cost time: 6.843996286392212
Epoch: 17, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.315 Vali Acc: 0.937 Test Loss: 0.315 Test Acc: 0.937
Validation loss decreased (-0.926663 --> -0.936664).  Saving model ...
Epoch: 18 cost time: 6.828104734420776
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.299 Vali Acc: 0.940 Test Loss: 0.299 Test Acc: 0.940
Validation loss decreased (-0.936664 --> -0.939997).  Saving model ...
Epoch: 19 cost time: 6.816535472869873
Epoch: 19, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.915831565856934
Epoch: 20, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.272 Vali Acc: 0.947 Test Loss: 0.272 Test Acc: 0.947
Validation loss decreased (-0.939997 --> -0.946664).  Saving model ...
Epoch: 21 cost time: 6.861997127532959
Epoch: 21, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.263 Vali Acc: 0.947 Test Loss: 0.263 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 22 cost time: 6.288043737411499
Epoch: 22, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.860557794570923
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.940 Test Loss: 0.242 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.915217638015747
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 6.8298728466033936
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.795127868652344
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.813501834869385
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.947 Test Loss: 0.226 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.76293683052063
Epoch: 28, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 6.717852592468262
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.947 Test Loss: 0.210 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.752701044082642
Epoch: 30, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 322529
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.4759955406188965
Epoch: 1, Steps: 18 | Train Loss: 3.280 Vali Loss: 3.173 Vali Acc: 0.073 Test Loss: 3.173 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 4.497822046279907
Epoch: 2, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.872 Vali Acc: 0.283 Test Loss: 2.872 Test Acc: 0.283
Validation loss decreased (-0.073302 --> -0.283305).  Saving model ...
Epoch: 3 cost time: 4.721173048019409
Epoch: 3, Steps: 18 | Train Loss: 2.691 Vali Loss: 2.503 Vali Acc: 0.457 Test Loss: 2.503 Test Acc: 0.457
Validation loss decreased (-0.283305 --> -0.456642).  Saving model ...
Epoch: 4 cost time: 4.602407217025757
Epoch: 4, Steps: 18 | Train Loss: 2.334 Vali Loss: 2.112 Vali Acc: 0.680 Test Loss: 2.112 Test Acc: 0.680
Validation loss decreased (-0.456642 --> -0.679979).  Saving model ...
Epoch: 5 cost time: 4.609821557998657
Epoch: 5, Steps: 18 | Train Loss: 1.935 Vali Loss: 1.737 Vali Acc: 0.813 Test Loss: 1.737 Test Acc: 0.813
Validation loss decreased (-0.679979 --> -0.813316).  Saving model ...
Epoch: 6 cost time: 4.653400421142578
Epoch: 6, Steps: 18 | Train Loss: 1.561 Vali Loss: 1.388 Vali Acc: 0.850 Test Loss: 1.388 Test Acc: 0.850
Validation loss decreased (-0.813316 --> -0.849986).  Saving model ...
Epoch: 7 cost time: 4.559284210205078
Epoch: 7, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.084 Vali Acc: 0.887 Test Loss: 1.084 Test Acc: 0.887
Validation loss decreased (-0.849986 --> -0.886656).  Saving model ...
Epoch: 8 cost time: 4.5601279735565186
Epoch: 8, Steps: 18 | Train Loss: 0.910 Vali Loss: 0.841 Vali Acc: 0.913 Test Loss: 0.841 Test Acc: 0.913
Validation loss decreased (-0.886656 --> -0.913325).  Saving model ...
Epoch: 9 cost time: 4.544935464859009
Epoch: 9, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.656 Vali Acc: 0.927 Test Loss: 0.656 Test Acc: 0.927
Validation loss decreased (-0.913325 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 4.58540415763855
Epoch: 10, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.529 Vali Acc: 0.933 Test Loss: 0.529 Test Acc: 0.933
Validation loss decreased (-0.926660 --> -0.933328).  Saving model ...
Epoch: 11 cost time: 4.5582435131073
Epoch: 11, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.450 Vali Acc: 0.930 Test Loss: 0.450 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.594398736953735
Epoch: 12, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.390 Vali Acc: 0.947 Test Loss: 0.390 Test Acc: 0.947
Validation loss decreased (-0.933328 --> -0.946663).  Saving model ...
Epoch: 13 cost time: 4.556241035461426
Epoch: 13, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.350 Vali Acc: 0.940 Test Loss: 0.350 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.556561231613159
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.316 Vali Acc: 0.947 Test Loss: 0.316 Test Acc: 0.947
Validation loss decreased (-0.946663 --> -0.946664).  Saving model ...
Epoch: 15 cost time: 4.544820547103882
Epoch: 15, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 4.579252481460571
Epoch: 16, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.276 Vali Acc: 0.947 Test Loss: 0.276 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.54136061668396
Epoch: 17, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.263 Vali Acc: 0.957 Test Loss: 0.263 Test Acc: 0.957
Validation loss decreased (-0.949997 --> -0.956664).  Saving model ...
Epoch: 18 cost time: 4.506563663482666
Epoch: 18, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.251 Vali Acc: 0.947 Test Loss: 0.251 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.566299676895142
Epoch: 19, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.236 Vali Acc: 0.953 Test Loss: 0.236 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.551427364349365
Epoch: 20, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.960 Test Loss: 0.226 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 21 cost time: 4.609098672866821
Epoch: 21, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.634331226348877
Epoch: 22, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.465994119644165
Epoch: 23, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 24 cost time: 4.588644742965698
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 25 cost time: 4.281548500061035
Epoch: 25, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 26 cost time: 4.668545484542847
Epoch: 26, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.681419610977173
Epoch: 27, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 28 cost time: 4.673808336257935
Epoch: 28, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 29 cost time: 4.725311040878296
Epoch: 29, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 30 cost time: 4.7055628299713135
Epoch: 30, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 115489
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.8163886070251465
Epoch: 1, Steps: 18 | Train Loss: 3.221 Vali Loss: 3.111 Vali Acc: 0.127 Test Loss: 3.111 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 5.913279056549072
Epoch: 2, Steps: 18 | Train Loss: 2.971 Vali Loss: 2.842 Vali Acc: 0.227 Test Loss: 2.842 Test Acc: 0.227
Validation loss decreased (-0.126636 --> -0.226638).  Saving model ...
Epoch: 3 cost time: 5.851393461227417
Epoch: 3, Steps: 18 | Train Loss: 2.693 Vali Loss: 2.511 Vali Acc: 0.447 Test Loss: 2.511 Test Acc: 0.447
Validation loss decreased (-0.226638 --> -0.446642).  Saving model ...
Epoch: 4 cost time: 5.884096145629883
Epoch: 4, Steps: 18 | Train Loss: 2.327 Vali Loss: 2.169 Vali Acc: 0.660 Test Loss: 2.169 Test Acc: 0.660
Validation loss decreased (-0.446642 --> -0.659978).  Saving model ...
Epoch: 5 cost time: 5.856948137283325
Epoch: 5, Steps: 18 | Train Loss: 1.958 Vali Loss: 1.838 Vali Acc: 0.790 Test Loss: 1.838 Test Acc: 0.790
Validation loss decreased (-0.659978 --> -0.789982).  Saving model ...
Epoch: 6 cost time: 5.75154185295105
Epoch: 6, Steps: 18 | Train Loss: 1.552 Vali Loss: 1.524 Vali Acc: 0.823 Test Loss: 1.524 Test Acc: 0.823
Validation loss decreased (-0.789982 --> -0.823318).  Saving model ...
Epoch: 7 cost time: 5.753338575363159
Epoch: 7, Steps: 18 | Train Loss: 1.238 Vali Loss: 1.245 Vali Acc: 0.833 Test Loss: 1.245 Test Acc: 0.833
Validation loss decreased (-0.823318 --> -0.833321).  Saving model ...
Epoch: 8 cost time: 5.660596609115601
Epoch: 8, Steps: 18 | Train Loss: 0.951 Vali Loss: 0.994 Vali Acc: 0.867 Test Loss: 0.994 Test Acc: 0.867
Validation loss decreased (-0.833321 --> -0.866657).  Saving model ...
Epoch: 9 cost time: 5.792807340621948
Epoch: 9, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.800 Vali Acc: 0.883 Test Loss: 0.800 Test Acc: 0.883
Validation loss decreased (-0.866657 --> -0.883325).  Saving model ...
Epoch: 10 cost time: 5.282021760940552
Epoch: 10, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.659 Vali Acc: 0.887 Test Loss: 0.659 Test Acc: 0.887
Validation loss decreased (-0.883325 --> -0.886660).  Saving model ...
Epoch: 11 cost time: 5.619753122329712
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.556 Vali Acc: 0.897 Test Loss: 0.556 Test Acc: 0.897
Validation loss decreased (-0.886660 --> -0.896661).  Saving model ...
Epoch: 12 cost time: 5.663216590881348
Epoch: 12, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.483 Vali Acc: 0.893 Test Loss: 0.483 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.647547006607056
Epoch: 13, Steps: 18 | Train Loss: 0.238 Vali Loss: 0.434 Vali Acc: 0.893 Test Loss: 0.434 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.630277872085571
Epoch: 14, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.390 Vali Acc: 0.907 Test Loss: 0.390 Test Acc: 0.907
Validation loss decreased (-0.896661 --> -0.906663).  Saving model ...
Epoch: 15 cost time: 5.6446311473846436
Epoch: 15, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.364 Vali Acc: 0.913 Test Loss: 0.364 Test Acc: 0.913
Validation loss decreased (-0.906663 --> -0.913330).  Saving model ...
Epoch: 16 cost time: 5.632482290267944
Epoch: 16, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.337 Vali Acc: 0.927 Test Loss: 0.337 Test Acc: 0.927
Validation loss decreased (-0.913330 --> -0.926663).  Saving model ...
Epoch: 17 cost time: 5.623070001602173
Epoch: 17, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.315 Vali Acc: 0.937 Test Loss: 0.315 Test Acc: 0.937
Validation loss decreased (-0.926663 --> -0.936664).  Saving model ...
Epoch: 18 cost time: 5.612548351287842
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.299 Vali Acc: 0.940 Test Loss: 0.299 Test Acc: 0.940
Validation loss decreased (-0.936664 --> -0.939997).  Saving model ...
Epoch: 19 cost time: 5.602582216262817
Epoch: 19, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.882461786270142
Epoch: 20, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.272 Vali Acc: 0.947 Test Loss: 0.272 Test Acc: 0.947
Validation loss decreased (-0.939997 --> -0.946664).  Saving model ...
Epoch: 21 cost time: 5.883810997009277
Epoch: 21, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.263 Vali Acc: 0.947 Test Loss: 0.263 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 22 cost time: 5.935399055480957
Epoch: 22, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.928011178970337
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.940 Test Loss: 0.242 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.890640497207642
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 5.924580097198486
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.86875057220459
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.904576539993286
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.947 Test Loss: 0.226 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.902406215667725
Epoch: 28, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 5.934983968734741
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.947 Test Loss: 0.210 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.870299577713013
Epoch: 30, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 322529
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.1011247634887695
Epoch: 1, Steps: 18 | Train Loss: 3.280 Vali Loss: 3.173 Vali Acc: 0.073 Test Loss: 3.173 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 4.293804407119751
Epoch: 2, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.872 Vali Acc: 0.283 Test Loss: 2.872 Test Acc: 0.283
Validation loss decreased (-0.073302 --> -0.283305).  Saving model ...
Epoch: 3 cost time: 4.210468530654907
Epoch: 3, Steps: 18 | Train Loss: 2.691 Vali Loss: 2.503 Vali Acc: 0.457 Test Loss: 2.503 Test Acc: 0.457
Validation loss decreased (-0.283305 --> -0.456642).  Saving model ...
Epoch: 4 cost time: 4.21541166305542
Epoch: 4, Steps: 18 | Train Loss: 2.334 Vali Loss: 2.112 Vali Acc: 0.680 Test Loss: 2.112 Test Acc: 0.680
Validation loss decreased (-0.456642 --> -0.679979).  Saving model ...
Epoch: 5 cost time: 4.041851997375488
Epoch: 5, Steps: 18 | Train Loss: 1.935 Vali Loss: 1.737 Vali Acc: 0.813 Test Loss: 1.737 Test Acc: 0.813
Validation loss decreased (-0.679979 --> -0.813316).  Saving model ...
Epoch: 6 cost time: 4.091566324234009
Epoch: 6, Steps: 18 | Train Loss: 1.561 Vali Loss: 1.388 Vali Acc: 0.850 Test Loss: 1.388 Test Acc: 0.850
Validation loss decreased (-0.813316 --> -0.849986).  Saving model ...
Epoch: 7 cost time: 4.233428955078125
Epoch: 7, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.084 Vali Acc: 0.887 Test Loss: 1.084 Test Acc: 0.887
Validation loss decreased (-0.849986 --> -0.886656).  Saving model ...
Epoch: 8 cost time: 4.2579100131988525
Epoch: 8, Steps: 18 | Train Loss: 0.910 Vali Loss: 0.841 Vali Acc: 0.913 Test Loss: 0.841 Test Acc: 0.913
Validation loss decreased (-0.886656 --> -0.913325).  Saving model ...
Epoch: 9 cost time: 4.148792028427124
Epoch: 9, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.656 Vali Acc: 0.927 Test Loss: 0.656 Test Acc: 0.927
Validation loss decreased (-0.913325 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 4.275389194488525
Epoch: 10, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.529 Vali Acc: 0.933 Test Loss: 0.529 Test Acc: 0.933
Validation loss decreased (-0.926660 --> -0.933328).  Saving model ...
Epoch: 11 cost time: 4.104414701461792
Epoch: 11, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.450 Vali Acc: 0.930 Test Loss: 0.450 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.14261794090271
Epoch: 12, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.390 Vali Acc: 0.947 Test Loss: 0.390 Test Acc: 0.947
Validation loss decreased (-0.933328 --> -0.946663).  Saving model ...
Epoch: 13 cost time: 4.250138998031616
Epoch: 13, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.350 Vali Acc: 0.940 Test Loss: 0.350 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.262488126754761
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.316 Vali Acc: 0.947 Test Loss: 0.316 Test Acc: 0.947
Validation loss decreased (-0.946663 --> -0.946664).  Saving model ...
Epoch: 15 cost time: 4.212981224060059
Epoch: 15, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 4.065229654312134
Epoch: 16, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.276 Vali Acc: 0.947 Test Loss: 0.276 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.328814506530762
Epoch: 17, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.263 Vali Acc: 0.957 Test Loss: 0.263 Test Acc: 0.957
Validation loss decreased (-0.949997 --> -0.956664).  Saving model ...
Epoch: 18 cost time: 4.365677833557129
Epoch: 18, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.251 Vali Acc: 0.947 Test Loss: 0.251 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.356569766998291
Epoch: 19, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.236 Vali Acc: 0.953 Test Loss: 0.236 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.362370491027832
Epoch: 20, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.960 Test Loss: 0.226 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 21 cost time: 4.34552526473999
Epoch: 21, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.388694524765015
Epoch: 22, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.360342741012573
Epoch: 23, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 24 cost time: 4.589548110961914
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 25 cost time: 4.370594024658203
Epoch: 25, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 26 cost time: 4.32425594329834
Epoch: 26, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.277683258056641
Epoch: 27, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 28 cost time: 4.062427043914795
Epoch: 28, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 29 cost time: 4.247836589813232
Epoch: 29, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 30 cost time: 4.083338975906372
Epoch: 30, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 115489
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.955406904220581
Epoch: 1, Steps: 18 | Train Loss: 3.220 Vali Loss: 3.110 Vali Acc: 0.127 Test Loss: 3.110 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 4.2323853969573975
Epoch: 2, Steps: 18 | Train Loss: 2.971 Vali Loss: 2.841 Vali Acc: 0.227 Test Loss: 2.841 Test Acc: 0.227
Validation loss decreased (-0.126636 --> -0.226638).  Saving model ...
Epoch: 3 cost time: 4.206554412841797
Epoch: 3, Steps: 18 | Train Loss: 2.693 Vali Loss: 2.512 Vali Acc: 0.440 Test Loss: 2.512 Test Acc: 0.440
Validation loss decreased (-0.226638 --> -0.439975).  Saving model ...
Epoch: 4 cost time: 4.282564640045166
Epoch: 4, Steps: 18 | Train Loss: 2.329 Vali Loss: 2.171 Vali Acc: 0.667 Test Loss: 2.171 Test Acc: 0.667
Validation loss decreased (-0.439975 --> -0.666645).  Saving model ...
Epoch: 5 cost time: 4.2049994468688965
Epoch: 5, Steps: 18 | Train Loss: 1.961 Vali Loss: 1.843 Vali Acc: 0.787 Test Loss: 1.843 Test Acc: 0.787
Validation loss decreased (-0.666645 --> -0.786648).  Saving model ...
Epoch: 6 cost time: 4.173667669296265
Epoch: 6, Steps: 18 | Train Loss: 1.558 Vali Loss: 1.531 Vali Acc: 0.827 Test Loss: 1.531 Test Acc: 0.827
Validation loss decreased (-0.786648 --> -0.826651).  Saving model ...
Epoch: 7 cost time: 4.212016820907593
Epoch: 7, Steps: 18 | Train Loss: 1.248 Vali Loss: 1.254 Vali Acc: 0.837 Test Loss: 1.254 Test Acc: 0.837
Validation loss decreased (-0.826651 --> -0.836654).  Saving model ...
Epoch: 8 cost time: 4.393632173538208
Epoch: 8, Steps: 18 | Train Loss: 0.964 Vali Loss: 1.004 Vali Acc: 0.873 Test Loss: 1.004 Test Acc: 0.873
Validation loss decreased (-0.836654 --> -0.873323).  Saving model ...
Epoch: 9 cost time: 4.237149477005005
Epoch: 9, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.807 Vali Acc: 0.890 Test Loss: 0.807 Test Acc: 0.890
Validation loss decreased (-0.873323 --> -0.889992).  Saving model ...
Epoch: 10 cost time: 4.257117748260498
Epoch: 10, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.662 Vali Acc: 0.893 Test Loss: 0.662 Test Acc: 0.893
Validation loss decreased (-0.889992 --> -0.893327).  Saving model ...
Epoch: 11 cost time: 4.230175733566284
Epoch: 11, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.555 Vali Acc: 0.903 Test Loss: 0.555 Test Acc: 0.903
Validation loss decreased (-0.893327 --> -0.903328).  Saving model ...
Epoch: 12 cost time: 4.221704006195068
Epoch: 12, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.480 Vali Acc: 0.907 Test Loss: 0.480 Test Acc: 0.907
Validation loss decreased (-0.903328 --> -0.906662).  Saving model ...
Epoch: 13 cost time: 4.270528316497803
Epoch: 13, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.428 Vali Acc: 0.910 Test Loss: 0.428 Test Acc: 0.910
Validation loss decreased (-0.906662 --> -0.909996).  Saving model ...
Epoch: 14 cost time: 4.234651565551758
Epoch: 14, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.382 Vali Acc: 0.920 Test Loss: 0.382 Test Acc: 0.920
Validation loss decreased (-0.909996 --> -0.919996).  Saving model ...
Epoch: 15 cost time: 4.322270393371582
Epoch: 15, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.354 Vali Acc: 0.923 Test Loss: 0.354 Test Acc: 0.923
Validation loss decreased (-0.919996 --> -0.923330).  Saving model ...
Epoch: 16 cost time: 4.226572751998901
Epoch: 16, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
Validation loss decreased (-0.923330 --> -0.936663).  Saving model ...
Epoch: 17 cost time: 4.229856252670288
Epoch: 17, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.301 Vali Acc: 0.940 Test Loss: 0.301 Test Acc: 0.940
Validation loss decreased (-0.936663 --> -0.939997).  Saving model ...
Epoch: 18 cost time: 4.2673234939575195
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.939997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 4.3107616901397705
Epoch: 19, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.268523454666138
Epoch: 20, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 4.2920823097229
Epoch: 21, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.947 Test Loss: 0.245 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.209777355194092
Epoch: 22, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.141468048095703
Epoch: 23, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 4.136137962341309
Epoch: 24, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 4.199419736862183
Epoch: 25, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 4.33334493637085
Epoch: 26, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.205 Vali Acc: 0.947 Test Loss: 0.205 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.166783809661865
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 4.358982801437378
Epoch: 28, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953331).  Saving model ...
Epoch: 29 cost time: 4.371550559997559
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.372287273406982
Epoch: 30, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 322529
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.614426851272583
Epoch: 1, Steps: 18 | Train Loss: 3.280 Vali Loss: 3.173 Vali Acc: 0.073 Test Loss: 3.173 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 3.7625627517700195
Epoch: 2, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.871 Vali Acc: 0.283 Test Loss: 2.871 Test Acc: 0.283
Validation loss decreased (-0.073302 --> -0.283305).  Saving model ...
Epoch: 3 cost time: 3.766531467437744
Epoch: 3, Steps: 18 | Train Loss: 2.692 Vali Loss: 2.503 Vali Acc: 0.453 Test Loss: 2.503 Test Acc: 0.453
Validation loss decreased (-0.283305 --> -0.453308).  Saving model ...
Epoch: 4 cost time: 3.845937490463257
Epoch: 4, Steps: 18 | Train Loss: 2.338 Vali Loss: 2.113 Vali Acc: 0.673 Test Loss: 2.113 Test Acc: 0.673
Validation loss decreased (-0.453308 --> -0.673312).  Saving model ...
Epoch: 5 cost time: 3.811314344406128
Epoch: 5, Steps: 18 | Train Loss: 1.939 Vali Loss: 1.740 Vali Acc: 0.807 Test Loss: 1.740 Test Acc: 0.807
Validation loss decreased (-0.673312 --> -0.806649).  Saving model ...
Epoch: 6 cost time: 3.9053916931152344
Epoch: 6, Steps: 18 | Train Loss: 1.567 Vali Loss: 1.393 Vali Acc: 0.850 Test Loss: 1.393 Test Acc: 0.850
Validation loss decreased (-0.806649 --> -0.849986).  Saving model ...
Epoch: 7 cost time: 3.76808500289917
Epoch: 7, Steps: 18 | Train Loss: 1.198 Vali Loss: 1.092 Vali Acc: 0.887 Test Loss: 1.092 Test Acc: 0.887
Validation loss decreased (-0.849986 --> -0.886656).  Saving model ...
Epoch: 8 cost time: 3.623741865158081
Epoch: 8, Steps: 18 | Train Loss: 0.925 Vali Loss: 0.850 Vali Acc: 0.920 Test Loss: 0.850 Test Acc: 0.920
Validation loss decreased (-0.886656 --> -0.919992).  Saving model ...
Epoch: 9 cost time: 3.7611663341522217
Epoch: 9, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.663 Vali Acc: 0.923 Test Loss: 0.663 Test Acc: 0.923
Validation loss decreased (-0.919992 --> -0.923327).  Saving model ...
Epoch: 10 cost time: 3.7951152324676514
Epoch: 10, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.533 Vali Acc: 0.933 Test Loss: 0.533 Test Acc: 0.933
Validation loss decreased (-0.923327 --> -0.933328).  Saving model ...
Epoch: 11 cost time: 3.815953254699707
Epoch: 11, Steps: 18 | Train Loss: 0.389 Vali Loss: 0.454 Vali Acc: 0.930 Test Loss: 0.454 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7873053550720215
Epoch: 12, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.393 Vali Acc: 0.947 Test Loss: 0.393 Test Acc: 0.947
Validation loss decreased (-0.933328 --> -0.946663).  Saving model ...
Epoch: 13 cost time: 3.7397944927215576
Epoch: 13, Steps: 18 | Train Loss: 0.263 Vali Loss: 0.353 Vali Acc: 0.940 Test Loss: 0.353 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.744628429412842
Epoch: 14, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.319 Vali Acc: 0.940 Test Loss: 0.319 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8098206520080566
Epoch: 15, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.946663 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 3.8780624866485596
Epoch: 16, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.278 Vali Acc: 0.947 Test Loss: 0.278 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7425341606140137
Epoch: 17, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.266 Vali Acc: 0.953 Test Loss: 0.266 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 18 cost time: 3.7446024417877197
Epoch: 18, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.253 Vali Acc: 0.943 Test Loss: 0.253 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7258193492889404
Epoch: 19, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.238 Vali Acc: 0.953 Test Loss: 0.238 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 20 cost time: 3.6267638206481934
Epoch: 20, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956664).  Saving model ...
Epoch: 21 cost time: 3.6680984497070312
Epoch: 21, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956664).  Saving model ...
Epoch: 22 cost time: 3.620812177658081
Epoch: 22, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.553572654724121
Epoch: 23, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963331).  Saving model ...
Epoch: 24 cost time: 3.6630516052246094
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.641907215118408
Epoch: 25, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 26 cost time: 3.6369211673736572
Epoch: 26, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 27 cost time: 3.58664870262146
Epoch: 27, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 28 cost time: 3.677640438079834
Epoch: 28, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 3.6125457286834717
Epoch: 29, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6592857837677
Epoch: 30, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 115489
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 60.603490114212036
Epoch: 1, Steps: 18 | Train Loss: 2.751 Vali Loss: 1.564 Vali Acc: 0.860 Test Loss: 1.564 Test Acc: 0.860
Validation loss decreased (inf --> -0.859984).  Saving model ...
Epoch: 2 cost time: 54.31774306297302
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.272 Vali Acc: 0.973 Test Loss: 0.272 Test Acc: 0.973
Validation loss decreased (-0.859984 --> -0.973331).  Saving model ...
Epoch: 3 cost time: 62.44812512397766
Epoch: 3, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 64.18875622749329
Epoch: 4, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 63.407753229141235
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 64.21343398094177
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 63.82644033432007
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 60.274765491485596
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 59.08810639381409
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 62.02192187309265
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 61.18573546409607
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 59.42514181137085
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 62.987067461013794
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 61.3119900226593
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 58.05492329597473
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 60.177138805389404
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 62.442866802215576
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 58.83901882171631
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 59.63237905502319
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 62.14296889305115
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 60.32784724235535
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 61.75736165046692
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 64.14474272727966
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 63.77121090888977
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 60.203758001327515
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 59.5430212020874
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 62.46507549285889
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 62.93476748466492
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 62.60690236091614
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 64.72161841392517
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 56701849
model size : 218.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 18.42361807823181
Epoch: 1, Steps: 18 | Train Loss: 2.850 Vali Loss: 1.661 Vali Acc: 0.883 Test Loss: 1.661 Test Acc: 0.883
Validation loss decreased (inf --> -0.883317).  Saving model ...
Epoch: 2 cost time: 16.522053956985474
Epoch: 2, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
Validation loss decreased (-0.883317 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 16.492977619171143
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 16.70522952079773
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 16.53543758392334
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 16.181336164474487
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 15.99273419380188
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.743786811828613
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 16.014491319656372
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 16.011346340179443
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.054755449295044
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 16.074359893798828
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 16.379711627960205
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 15.85936951637268
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 16.33494544029236
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 16.301636934280396
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 15.955359697341919
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 15.813544750213623
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 15.26571774482727
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 15.687225818634033
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 16.048619031906128
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 16.032002449035645
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 16.111380577087402
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 15.946902513504028
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 16.06215810775757
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 16.426387071609497
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 16.022573471069336
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 16.125118255615234
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 16.235698461532593
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 16.067869424819946
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 16984729
model size : 67.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 49.23943090438843
Epoch: 1, Steps: 18 | Train Loss: 2.751 Vali Loss: 1.564 Vali Acc: 0.860 Test Loss: 1.564 Test Acc: 0.860
Validation loss decreased (inf --> -0.859984).  Saving model ...
Epoch: 2 cost time: 45.649603843688965
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.272 Vali Acc: 0.973 Test Loss: 0.272 Test Acc: 0.973
Validation loss decreased (-0.859984 --> -0.973331).  Saving model ...
Epoch: 3 cost time: 45.43865752220154
Epoch: 3, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 46.39848852157593
Epoch: 4, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 47.75363731384277
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 47.65276265144348
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 47.275362968444824
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 47.73500633239746
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 47.52719068527222
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 46.62328624725342
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 44.29232668876648
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 43.345813512802124
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 46.302649974823
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 49.17770314216614
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 47.284260272979736
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 46.50362014770508
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 47.430421590805054
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 47.36848473548889
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 44.26309132575989
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 42.147512674331665
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 42.335577726364136
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 44.52679085731506
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 46.141350746154785
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 44.98822546005249
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 44.52211403846741
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 45.64924693107605
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 46.008373975753784
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 43.72398853302002
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 43.154794454574585
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 43.63667345046997
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 56701849
model size : 218.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.047435998916626
Epoch: 1, Steps: 18 | Train Loss: 2.850 Vali Loss: 1.661 Vali Acc: 0.883 Test Loss: 1.661 Test Acc: 0.883
Validation loss decreased (inf --> -0.883317).  Saving model ...
Epoch: 2 cost time: 12.054427862167358
Epoch: 2, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
Validation loss decreased (-0.883317 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 12.048262357711792
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 12.02535629272461
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 11.948626518249512
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 11.414814710617065
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 11.350322484970093
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.531681060791016
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 12.02083158493042
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 11.583491802215576
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.963059186935425
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 11.90706992149353
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 11.72564959526062
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 12.347443342208862
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 12.162888050079346
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 11.749205827713013
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 12.24878740310669
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 11.975158214569092
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 12.173976421356201
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 11.93352723121643
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 11.497087240219116
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 11.690790176391602
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 11.51551604270935
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 11.708284616470337
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 11.979167938232422
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 12.06572675704956
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 12.171224355697632
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 12.120743751525879
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 11.863370895385742
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 12.100416660308838
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 16984729
model size : 67.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 28.708104848861694
Epoch: 1, Steps: 18 | Train Loss: 2.751 Vali Loss: 1.564 Vali Acc: 0.860 Test Loss: 1.564 Test Acc: 0.860
Validation loss decreased (inf --> -0.859984).  Saving model ...
Epoch: 2 cost time: 26.39013433456421
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.272 Vali Acc: 0.973 Test Loss: 0.272 Test Acc: 0.973
Validation loss decreased (-0.859984 --> -0.973331).  Saving model ...
Epoch: 3 cost time: 24.468048095703125
Epoch: 3, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.055020809173584
Epoch: 4, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.922208547592163
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.633275270462036
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 25.25216794013977
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.214943170547485
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 25.336946964263916
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 24.13120412826538
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 26.09657382965088
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 28.577752590179443
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 28.641936540603638
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 26.03287935256958
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.29118275642395
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 26.581677436828613
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 27.06103539466858
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 26.44875407218933
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 26.174181699752808
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 26.285650968551636
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 27.461385011672974
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 26.53014636039734
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 26.65803837776184
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 27.979173183441162
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 27.473320245742798
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 26.10691237449646
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 25.740150690078735
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 27.861042022705078
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 26.88694429397583
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 25.117398977279663
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 56701849
model size : 218.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.428478956222534
Epoch: 1, Steps: 18 | Train Loss: 2.850 Vali Loss: 1.661 Vali Acc: 0.883 Test Loss: 1.661 Test Acc: 0.883
Validation loss decreased (inf --> -0.883317).  Saving model ...
Epoch: 2 cost time: 7.2814271450042725
Epoch: 2, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
Validation loss decreased (-0.883317 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 7.194952487945557
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 7.154652833938599
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 7.276088237762451
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 7.228636980056763
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 7.177494049072266
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.258729457855225
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 7.3759729862213135
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 6.928084850311279
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.3930463790893555
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 7.340762138366699
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 7.777901649475098
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 7.739938497543335
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 7.639853239059448
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 7.577889919281006
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 7.746046304702759
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 7.774718999862671
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 7.693565845489502
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 7.656416654586792
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 7.508711338043213
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 7.619227886199951
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 7.235961437225342
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 7.5704498291015625
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.486499547958374
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.52125883102417
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.845504999160767
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.019303798675537
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.614375829696655
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.206598281860352
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 16984729
model size : 67.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 30.373529195785522
Epoch: 1, Steps: 18 | Train Loss: 2.843 Vali Loss: 1.658 Vali Acc: 0.863 Test Loss: 1.658 Test Acc: 0.863
Validation loss decreased (inf --> -0.863317).  Saving model ...
Epoch: 2 cost time: 29.032682418823242
Epoch: 2, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.347 Vali Acc: 0.930 Test Loss: 0.347 Test Acc: 0.930
Validation loss decreased (-0.863317 --> -0.929997).  Saving model ...
Epoch: 3 cost time: 28.479549169540405
Epoch: 3, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.929997 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 28.014280557632446
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 28.12977433204651
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 26.249385833740234
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 28.72620463371277
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 28.4618558883667
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 28.7732253074646
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 28.445993661880493
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 28.59831428527832
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 28.708808183670044
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 27.738439083099365
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 28.30801486968994
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 27.193062782287598
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 27.85075044631958
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 28.13357162475586
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 28.344309091567993
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 28.821184873580933
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 27.97801923751831
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 27.408506393432617
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 27.809009790420532
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 29.017001390457153
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 29.31160306930542
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 28.989789485931396
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 29.384599924087524
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 27.74829936027527
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 28.00323462486267
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 28.58988857269287
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 28584601
model size : 111.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 13.56224513053894
Epoch: 1, Steps: 18 | Train Loss: 2.869 Vali Loss: 1.738 Vali Acc: 0.870 Test Loss: 1.738 Test Acc: 0.870
Validation loss decreased (inf --> -0.869983).  Saving model ...
Epoch: 2 cost time: 11.985549688339233
Epoch: 2, Steps: 18 | Train Loss: 0.857 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
Validation loss decreased (-0.869983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 12.009755373001099
Epoch: 3, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.959997 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 12.053907871246338
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 11.60775113105774
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 11.758642196655273
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.714119672775269
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.702350616455078
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.444644689559937
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.336161851882935
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.97283387184143
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.55097246170044
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.397770643234253
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.605150938034058
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.20163345336914
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 8725657
model size : 35.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 21.70040464401245
Epoch: 1, Steps: 18 | Train Loss: 2.843 Vali Loss: 1.658 Vali Acc: 0.863 Test Loss: 1.658 Test Acc: 0.863
Validation loss decreased (inf --> -0.863317).  Saving model ...
Epoch: 2 cost time: 19.42531728744507
Epoch: 2, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.347 Vali Acc: 0.930 Test Loss: 0.347 Test Acc: 0.930
Validation loss decreased (-0.863317 --> -0.929997).  Saving model ...
Epoch: 3 cost time: 20.55251407623291
Epoch: 3, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.929997 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 20.67214035987854
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 19.633047342300415
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 20.210944652557373
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 20.444115161895752
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 19.237107276916504
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 19.523548126220703
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 20.250093460083008
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 19.97066617012024
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 19.741274118423462
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 20.694440841674805
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 21.075751304626465
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.81663703918457
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 21.065265893936157
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 21.227952003479004
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 19.6740140914917
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 19.7117760181427
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 20.81633687019348
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 19.86869525909424
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.616122722625732
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 21.373979091644287
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 21.2374849319458
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 19.849889516830444
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 20.341485500335693
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 21.13909363746643
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 19.640058040618896
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 19.269081592559814
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 28584601
model size : 111.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.912286758422852
Epoch: 1, Steps: 18 | Train Loss: 2.869 Vali Loss: 1.738 Vali Acc: 0.870 Test Loss: 1.738 Test Acc: 0.870
Validation loss decreased (inf --> -0.869983).  Saving model ...
Epoch: 2 cost time: 8.922759056091309
Epoch: 2, Steps: 18 | Train Loss: 0.857 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
Validation loss decreased (-0.869983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 8.334498882293701
Epoch: 3, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.959997 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 8.65131664276123
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 8.733409881591797
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 8.811482667922974
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.279752492904663
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.216869354248047
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.21750020980835
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.854262351989746
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.911740064620972
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.833844661712646
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.874495267868042
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.255532503128052
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.117931842803955
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 8725657
model size : 35.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.49107575416565
Epoch: 1, Steps: 18 | Train Loss: 2.843 Vali Loss: 1.658 Vali Acc: 0.863 Test Loss: 1.658 Test Acc: 0.863
Validation loss decreased (inf --> -0.863317).  Saving model ...
Epoch: 2 cost time: 12.767157316207886
Epoch: 2, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.347 Vali Acc: 0.930 Test Loss: 0.347 Test Acc: 0.930
Validation loss decreased (-0.863317 --> -0.929997).  Saving model ...
Epoch: 3 cost time: 13.104399919509888
Epoch: 3, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.929997 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 12.878091096878052
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 13.907692432403564
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 13.405441999435425
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 13.368601560592651
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 14.070791482925415
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 14.22647476196289
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 13.919240236282349
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 13.461209058761597
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 13.079883575439453
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 13.703509092330933
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 13.726878643035889
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.184966802597046
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 12.836055040359497
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 12.527427673339844
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 13.866844177246094
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 14.19544768333435
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 13.304283380508423
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.028393268585205
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.06716775894165
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 13.918095350265503
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 13.710397481918335
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 13.427585124969482
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 12.931193113327026
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 13.572214126586914
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 14.333259105682373
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 14.615823030471802
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 28584601
model size : 111.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.834416389465332
Epoch: 1, Steps: 18 | Train Loss: 2.869 Vali Loss: 1.738 Vali Acc: 0.870 Test Loss: 1.738 Test Acc: 0.870
Validation loss decreased (inf --> -0.869983).  Saving model ...
Epoch: 2 cost time: 6.1639862060546875
Epoch: 2, Steps: 18 | Train Loss: 0.857 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
Validation loss decreased (-0.869983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 6.249049425125122
Epoch: 3, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.959997 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 6.844553232192993
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 6.743085622787476
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 6.561163902282715
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.81901478767395
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.337292194366455
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.349574089050293
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.365774869918823
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.472317218780518
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.275624990463257
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.815751552581787
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.7773895263671875
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.554793357849121
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 8725657
model size : 35.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 32.6745388507843
Epoch: 1, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.296 Vali Acc: 0.750 Test Loss: 2.296 Test Acc: 0.750
Validation loss decreased (inf --> -0.749977).  Saving model ...
Epoch: 2 cost time: 32.3341338634491
Epoch: 2, Steps: 18 | Train Loss: 1.589 Vali Loss: 0.857 Vali Acc: 0.943 Test Loss: 0.857 Test Acc: 0.943
Validation loss decreased (-0.749977 --> -0.943325).  Saving model ...
Epoch: 3 cost time: 32.237659215927124
Epoch: 3, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
Validation loss decreased (-0.943325 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 32.5082311630249
Epoch: 4, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.943331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 34.462849140167236
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 32.52425408363342
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 33.46710705757141
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 31.69551706314087
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 31.633092641830444
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 30.638641595840454
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 27.086705684661865
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 33.468042612075806
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 32.264169216156006
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 30.958314418792725
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 32.20936441421509
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 30.955561637878418
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 31.53669762611389
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 33.05100202560425
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 31.68964457511902
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 30.584641456604004
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 31.95158290863037
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 29.761255979537964
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 31.349308729171753
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 33.35856103897095
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 30.503053903579712
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 28353241
model size : 109.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.878377199172974
Epoch: 1, Steps: 18 | Train Loss: 3.041 Vali Loss: 2.332 Vali Acc: 0.700 Test Loss: 2.332 Test Acc: 0.700
Validation loss decreased (inf --> -0.699977).  Saving model ...
Epoch: 2 cost time: 13.66991400718689
Epoch: 2, Steps: 18 | Train Loss: 1.611 Vali Loss: 0.920 Vali Acc: 0.943 Test Loss: 0.920 Test Acc: 0.943
Validation loss decreased (-0.699977 --> -0.943324).  Saving model ...
Epoch: 3 cost time: 13.06583547592163
Epoch: 3, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.304 Vali Acc: 0.963 Test Loss: 0.304 Test Acc: 0.963
Validation loss decreased (-0.943324 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 12.669948101043701
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
Validation loss decreased (-0.963330 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 13.23446273803711
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.9214026927948
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.657367467880249
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.390652179718018
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.239716053009033
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.462257623672485
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.812233686447144
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.777601480484009
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.879576683044434
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.068100452423096
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 8493913
model size : 33.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 24.597192525863647
Epoch: 1, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.296 Vali Acc: 0.750 Test Loss: 2.296 Test Acc: 0.750
Validation loss decreased (inf --> -0.749977).  Saving model ...
Epoch: 2 cost time: 24.12020492553711
Epoch: 2, Steps: 18 | Train Loss: 1.589 Vali Loss: 0.857 Vali Acc: 0.943 Test Loss: 0.857 Test Acc: 0.943
Validation loss decreased (-0.749977 --> -0.943325).  Saving model ...
Epoch: 3 cost time: 22.371278762817383
Epoch: 3, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
Validation loss decreased (-0.943325 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 24.527711391448975
Epoch: 4, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.943331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 22.115411043167114
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 23.63327670097351
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 22.379582166671753
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.86389183998108
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.75868320465088
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 24.389708995819092
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 22.505475759506226
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.587204933166504
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 23.30775737762451
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 24.18995451927185
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 23.181981801986694
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 22.811853647232056
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.85050392150879
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.067824602127075
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.275219917297363
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 24.894118547439575
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 23.41843056678772
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 24.158740520477295
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 25.04653000831604
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 25.435097217559814
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 25.183146953582764
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 28353241
model size : 109.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.698812484741211
Epoch: 1, Steps: 18 | Train Loss: 3.041 Vali Loss: 2.332 Vali Acc: 0.700 Test Loss: 2.332 Test Acc: 0.700
Validation loss decreased (inf --> -0.699977).  Saving model ...
Epoch: 2 cost time: 11.161213397979736
Epoch: 2, Steps: 18 | Train Loss: 1.611 Vali Loss: 0.920 Vali Acc: 0.943 Test Loss: 0.920 Test Acc: 0.943
Validation loss decreased (-0.699977 --> -0.943324).  Saving model ...
Epoch: 3 cost time: 11.338937759399414
Epoch: 3, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.304 Vali Acc: 0.963 Test Loss: 0.304 Test Acc: 0.963
Validation loss decreased (-0.943324 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 11.016034603118896
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
Validation loss decreased (-0.963330 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 10.524444580078125
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.86334753036499
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.999193906784058
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.757633447647095
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.057766914367676
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.2010178565979
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.259766340255737
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.714569091796875
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.703828573226929
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.846006155014038
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 8493913
model size : 33.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 17.44802212715149
Epoch: 1, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.296 Vali Acc: 0.750 Test Loss: 2.296 Test Acc: 0.750
Validation loss decreased (inf --> -0.749977).  Saving model ...
Epoch: 2 cost time: 15.424397945404053
Epoch: 2, Steps: 18 | Train Loss: 1.589 Vali Loss: 0.857 Vali Acc: 0.943 Test Loss: 0.857 Test Acc: 0.943
Validation loss decreased (-0.749977 --> -0.943325).  Saving model ...
Epoch: 3 cost time: 15.413422584533691
Epoch: 3, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
Validation loss decreased (-0.943325 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 15.30862545967102
Epoch: 4, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.943331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 15.604620695114136
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 16.296788454055786
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 16.589747428894043
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.579386949539185
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.533578395843506
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 15.945709466934204
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 15.532378673553467
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.149410247802734
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 15.361483097076416
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 15.373830318450928
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 15.483394384384155
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 15.113781452178955
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 15.303754806518555
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.0536630153656
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.910169839859009
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.807196140289307
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.868725776672363
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.757031202316284
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.5486319065094
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.424561500549316
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.27640175819397
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 28353241
model size : 109.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.232750177383423
Epoch: 1, Steps: 18 | Train Loss: 3.041 Vali Loss: 2.332 Vali Acc: 0.700 Test Loss: 2.332 Test Acc: 0.700
Validation loss decreased (inf --> -0.699977).  Saving model ...
Epoch: 2 cost time: 7.382989883422852
Epoch: 2, Steps: 18 | Train Loss: 1.611 Vali Loss: 0.920 Vali Acc: 0.943 Test Loss: 0.920 Test Acc: 0.943
Validation loss decreased (-0.699977 --> -0.943324).  Saving model ...
Epoch: 3 cost time: 7.3655664920806885
Epoch: 3, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.304 Vali Acc: 0.963 Test Loss: 0.304 Test Acc: 0.963
Validation loss decreased (-0.943324 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 7.1581339836120605
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
Validation loss decreased (-0.963330 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 7.138396263122559
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.143687725067139
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.231574535369873
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.3237316608428955
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.17208194732666
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.321275472640991
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.0303425788879395
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.3507208824157715
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.331228733062744
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.330894231796265
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 8493913
model size : 33.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 21.48172950744629
Epoch: 1, Steps: 18 | Train Loss: 3.068 Vali Loss: 2.367 Vali Acc: 0.660 Test Loss: 2.367 Test Acc: 0.660
Validation loss decreased (inf --> -0.659976).  Saving model ...
Epoch: 2 cost time: 20.491914749145508
Epoch: 2, Steps: 18 | Train Loss: 1.658 Vali Loss: 0.893 Vali Acc: 0.957 Test Loss: 0.893 Test Acc: 0.957
Validation loss decreased (-0.659976 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 20.070363521575928
Epoch: 3, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.927361488342285
Epoch: 4, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.956658 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 20.183284282684326
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 19.986286640167236
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 20.586729288101196
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.21556305885315
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 19.94330382347107
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.653416395187378
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 19.36430859565735
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 19.07714819908142
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 19.048985719680786
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.36093020439148
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 19.564183235168457
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.90979528427124
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 20.628334045410156
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 20.52584671974182
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.321211338043213
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 20.689473628997803
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 19.48419690132141
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 19.82671022415161
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 19.51191520690918
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 18.762153148651123
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 19.089672803878784
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 19.56686520576477
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 20.012094020843506
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 14293465
model size : 55.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.768877267837524
Epoch: 1, Steps: 18 | Train Loss: 3.014 Vali Loss: 2.333 Vali Acc: 0.673 Test Loss: 2.333 Test Acc: 0.673
Validation loss decreased (inf --> -0.673310).  Saving model ...
Epoch: 2 cost time: 8.91801118850708
Epoch: 2, Steps: 18 | Train Loss: 1.643 Vali Loss: 0.943 Vali Acc: 0.923 Test Loss: 0.943 Test Acc: 0.923
Validation loss decreased (-0.673310 --> -0.923324).  Saving model ...
Epoch: 3 cost time: 9.004696130752563
Epoch: 3, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.318 Vali Acc: 0.953 Test Loss: 0.318 Test Acc: 0.953
Validation loss decreased (-0.923324 --> -0.953330).  Saving model ...
Epoch: 4 cost time: 9.043097734451294
Epoch: 4, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.953330 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 8.986624717712402
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 9.010462284088135
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 9.065898180007935
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 9.120367288589478
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 9.096124649047852
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 9.05889105796814
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 8.805001020431519
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 8.829911470413208
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 8.865982294082642
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 8.902993202209473
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 9.040294408798218
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 9.056562185287476
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 9.108446836471558
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 9.093114137649536
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 9.114899158477783
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 9.171078205108643
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.127997398376465
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 8.903676748275757
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 9.082988977432251
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 9.07983922958374
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 8.817159175872803
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 8.788534879684448
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 8.60336446762085
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 8.859195470809937
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 8.838877201080322
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 8.849588871002197
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 4363609
model size : 17.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 16.34674310684204
Epoch: 1, Steps: 18 | Train Loss: 3.068 Vali Loss: 2.367 Vali Acc: 0.660 Test Loss: 2.367 Test Acc: 0.660
Validation loss decreased (inf --> -0.659976).  Saving model ...
Epoch: 2 cost time: 14.642184734344482
Epoch: 2, Steps: 18 | Train Loss: 1.658 Vali Loss: 0.893 Vali Acc: 0.957 Test Loss: 0.893 Test Acc: 0.957
Validation loss decreased (-0.659976 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 14.947392702102661
Epoch: 3, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.877213954925537
Epoch: 4, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.956658 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 15.144805669784546
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 15.003568410873413
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 14.867310523986816
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.27437424659729
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 14.741781949996948
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.825727701187134
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 13.558397769927979
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 15.109380006790161
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 14.419655323028564
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.995967149734497
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 14.73650336265564
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.887248039245605
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 14.533963441848755
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 14.340717077255249
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 14.372817516326904
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 14.53103518486023
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 13.923388242721558
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 14.25315260887146
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 14.64673638343811
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 14.76511263847351
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 14.565946578979492
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 14.71032166481018
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 15.073387622833252
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 14293465
model size : 55.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.012961864471436
Epoch: 1, Steps: 18 | Train Loss: 3.014 Vali Loss: 2.333 Vali Acc: 0.673 Test Loss: 2.333 Test Acc: 0.673
Validation loss decreased (inf --> -0.673310).  Saving model ...
Epoch: 2 cost time: 7.524635314941406
Epoch: 2, Steps: 18 | Train Loss: 1.643 Vali Loss: 0.943 Vali Acc: 0.923 Test Loss: 0.943 Test Acc: 0.923
Validation loss decreased (-0.673310 --> -0.923324).  Saving model ...
Epoch: 3 cost time: 7.416839122772217
Epoch: 3, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.318 Vali Acc: 0.953 Test Loss: 0.318 Test Acc: 0.953
Validation loss decreased (-0.923324 --> -0.953330).  Saving model ...
Epoch: 4 cost time: 7.357516288757324
Epoch: 4, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.953330 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 7.551267385482788
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 7.07650899887085
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 7.3279969692230225
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 7.119744777679443
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 7.29880690574646
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 6.986719608306885
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 6.802260160446167
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 5.296136379241943
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 6.87972617149353
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 7.016303777694702
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 6.958395957946777
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 7.014678955078125
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 6.77167820930481
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 6.917308568954468
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 7.024235963821411
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 6.994188070297241
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.933926820755005
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 7.396346569061279
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 7.414142847061157
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 7.597912073135376
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 7.43826961517334
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 7.61677360534668
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 7.6311867237091064
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 7.575200319290161
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 7.557571887969971
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 7.383897066116333
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 4363609
model size : 17.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.815734386444092
Epoch: 1, Steps: 18 | Train Loss: 3.068 Vali Loss: 2.367 Vali Acc: 0.660 Test Loss: 2.367 Test Acc: 0.660
Validation loss decreased (inf --> -0.659976).  Saving model ...
Epoch: 2 cost time: 9.949450016021729
Epoch: 2, Steps: 18 | Train Loss: 1.658 Vali Loss: 0.893 Vali Acc: 0.957 Test Loss: 0.893 Test Acc: 0.957
Validation loss decreased (-0.659976 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 10.009888887405396
Epoch: 3, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.139764308929443
Epoch: 4, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.956658 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 10.116211414337158
Epoch: 5, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 10.016993284225464
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 9.669712781906128
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.533955574035645
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 9.362065076828003
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.778605937957764
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 9.773422718048096
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 9.633572816848755
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 9.30171823501587
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.73371934890747
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 9.76577377319336
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.495854616165161
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 10.035411596298218
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 10.005707502365112
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.985830068588257
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.571723461151123
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.067705392837524
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.116352796554565
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.921761751174927
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 10.139476776123047
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 10.103867292404175
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 9.995278120040894
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 10.16593050956726
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 10.361562013626099
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 10.1893892288208
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 9.895543575286865
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 14293465
model size : 55.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.200595140457153
Epoch: 1, Steps: 18 | Train Loss: 3.014 Vali Loss: 2.333 Vali Acc: 0.673 Test Loss: 2.333 Test Acc: 0.673
Validation loss decreased (inf --> -0.673310).  Saving model ...
Epoch: 2 cost time: 5.503181219100952
Epoch: 2, Steps: 18 | Train Loss: 1.643 Vali Loss: 0.943 Vali Acc: 0.923 Test Loss: 0.943 Test Acc: 0.923
Validation loss decreased (-0.673310 --> -0.923324).  Saving model ...
Epoch: 3 cost time: 5.305701017379761
Epoch: 3, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.317 Vali Acc: 0.957 Test Loss: 0.317 Test Acc: 0.957
Validation loss decreased (-0.923324 --> -0.956663).  Saving model ...
Epoch: 4 cost time: 5.232952833175659
Epoch: 4, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.956663 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 5.279110670089722
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 5.357757568359375
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 5.304006338119507
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 5.051626205444336
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 5.191768407821655
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 5.223597288131714
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 5.327261209487915
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 5.392374753952026
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 5.246318340301514
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 5.1567323207855225
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 4.929577589035034
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 5.316548824310303
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 5.323233127593994
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 5.319001197814941
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 5.238819599151611
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 5.249462842941284
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.456866502761841
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 5.62244987487793
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 5.627654314041138
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 5.543054580688477
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 5.446694374084473
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 5.626933336257935
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 5.675438404083252
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 5.618185043334961
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 5.629920721054077
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 5.509147644042969
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 4363609
model size : 17.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 15.462820768356323
Epoch: 1, Steps: 18 | Train Loss: 3.145 Vali Loss: 2.443 Vali Acc: 0.680 Test Loss: 2.443 Test Acc: 0.680
Validation loss decreased (inf --> -0.679976).  Saving model ...
Epoch: 2 cost time: 13.560970306396484
Epoch: 2, Steps: 18 | Train Loss: 1.715 Vali Loss: 0.968 Vali Acc: 0.940 Test Loss: 0.968 Test Acc: 0.940
Validation loss decreased (-0.679976 --> -0.939990).  Saving model ...
Epoch: 3 cost time: 12.93892788887024
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.299 Vali Acc: 0.963 Test Loss: 0.299 Test Acc: 0.963
Validation loss decreased (-0.939990 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 13.406911373138428
Epoch: 4, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
Validation loss decreased (-0.963330 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 13.359934091567993
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.7785964012146
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 12.69752836227417
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 12.780758619308472
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 12.971813917160034
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.367718935012817
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.176651239395142
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 13.34292459487915
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 13.30830717086792
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 13.150238275527954
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.335794687271118
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 12.997843503952026
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 12.977953910827637
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 12.950419664382935
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 12.771423578262329
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.498230218887329
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 13.57851266860962
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 13.221915006637573
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 13.53396487236023
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 13.089354276657104
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 12.988582611083984
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 13.22209620475769
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.616294860839844
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 13.3718581199646
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 13.389107704162598
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 13.130143165588379
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 7263577
model size : 28.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.932100534439087
Epoch: 1, Steps: 18 | Train Loss: 3.109 Vali Loss: 2.427 Vali Acc: 0.627 Test Loss: 2.427 Test Acc: 0.627
Validation loss decreased (inf --> -0.626642).  Saving model ...
Epoch: 2 cost time: 5.830755710601807
Epoch: 2, Steps: 18 | Train Loss: 1.768 Vali Loss: 1.014 Vali Acc: 0.930 Test Loss: 1.014 Test Acc: 0.930
Validation loss decreased (-0.626642 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 6.169032573699951
Epoch: 3, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.341 Vali Acc: 0.960 Test Loss: 0.341 Test Acc: 0.960
Validation loss decreased (-0.929990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 6.020021438598633
Epoch: 4, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 6.176135301589966
Epoch: 5, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 6.063262939453125
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.605278015136719
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 6.2335288524627686
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 6.622955560684204
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 6.2742908000946045
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 6.626185178756714
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 6.299452066421509
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 6.767258644104004
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 6.277035236358643
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 6.08129620552063
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.9454710483551025
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.764771461486816
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 6.647534132003784
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 6.6532697677612305
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.008243799209595
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.0121729373931885
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 7.192539930343628
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 6.971179962158203
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 7.1156463623046875
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 6.842347860336304
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.991641521453857
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 6.55085015296936
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.571745157241821
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.343706130981445
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.5867369174957275
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2298457
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.077698469161987
Epoch: 1, Steps: 18 | Train Loss: 3.145 Vali Loss: 2.443 Vali Acc: 0.680 Test Loss: 2.443 Test Acc: 0.680
Validation loss decreased (inf --> -0.679976).  Saving model ...
Epoch: 2 cost time: 9.121569156646729
Epoch: 2, Steps: 18 | Train Loss: 1.715 Vali Loss: 0.968 Vali Acc: 0.940 Test Loss: 0.968 Test Acc: 0.940
Validation loss decreased (-0.679976 --> -0.939990).  Saving model ...
Epoch: 3 cost time: 10.38347339630127
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.299 Vali Acc: 0.963 Test Loss: 0.299 Test Acc: 0.963
Validation loss decreased (-0.939990 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 10.39711308479309
Epoch: 4, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
Validation loss decreased (-0.963330 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 10.753626108169556
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.493424654006958
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 10.178110361099243
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 10.242534875869751
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 10.285796642303467
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.372994661331177
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.525036811828613
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 10.69217300415039
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 10.375952005386353
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 10.290838241577148
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.919196128845215
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 9.873758316040039
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 9.442861795425415
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 9.56334400177002
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 9.469453573226929
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.699767589569092
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 10.036191463470459
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 10.523586750030518
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 10.013736486434937
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 10.49661660194397
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 10.443336248397827
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 10.048459768295288
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 9.89117693901062
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 10.07876968383789
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 9.903702735900879
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 10.024338006973267
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 7263577
model size : 28.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.1389219760894775
Epoch: 1, Steps: 18 | Train Loss: 3.109 Vali Loss: 2.427 Vali Acc: 0.627 Test Loss: 2.427 Test Acc: 0.627
Validation loss decreased (inf --> -0.626642).  Saving model ...
Epoch: 2 cost time: 5.245745420455933
Epoch: 2, Steps: 18 | Train Loss: 1.768 Vali Loss: 1.014 Vali Acc: 0.930 Test Loss: 1.014 Test Acc: 0.930
Validation loss decreased (-0.626642 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 5.44829797744751
Epoch: 3, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.341 Vali Acc: 0.960 Test Loss: 0.341 Test Acc: 0.960
Validation loss decreased (-0.929990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 5.537592649459839
Epoch: 4, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 5.451036214828491
Epoch: 5, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 5.198136568069458
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.288797616958618
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 5.246009111404419
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 5.257566452026367
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 5.1372973918914795
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 5.192936420440674
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 5.233273983001709
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 5.431391716003418
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 5.666599750518799
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 5.56956148147583
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 5.300710678100586
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.693025350570679
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 5.57882285118103
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 5.534814119338989
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.6428704261779785
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.658024311065674
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 5.3498756885528564
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 5.369369268417358
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 5.5089240074157715
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 5.34121036529541
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.943860769271851
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 5.324435234069824
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.238948583602905
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.107755184173584
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.526735544204712
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2298457
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.422930240631104
Epoch: 1, Steps: 18 | Train Loss: 3.145 Vali Loss: 2.443 Vali Acc: 0.683 Test Loss: 2.443 Test Acc: 0.683
Validation loss decreased (inf --> -0.683309).  Saving model ...
Epoch: 2 cost time: 7.045316696166992
Epoch: 2, Steps: 18 | Train Loss: 1.715 Vali Loss: 0.969 Vali Acc: 0.940 Test Loss: 0.969 Test Acc: 0.940
Validation loss decreased (-0.683309 --> -0.939990).  Saving model ...
Epoch: 3 cost time: 6.9625020027160645
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.299 Vali Acc: 0.963 Test Loss: 0.299 Test Acc: 0.963
Validation loss decreased (-0.939990 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 6.896751880645752
Epoch: 4, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
Validation loss decreased (-0.963330 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 7.028566598892212
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.610044956207275
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 6.792420148849487
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 6.932606935501099
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 6.751901388168335
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.7769951820373535
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.667955160140991
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 6.8817222118377686
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 7.072787046432495
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 6.855683326721191
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.042224407196045
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 7.0512003898620605
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 6.993933916091919
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 5.585732698440552
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 6.565072774887085
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.228204011917114
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 6.2959043979644775
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 6.467807769775391
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 6.4791200160980225
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 6.590571165084839
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 6.651956796646118
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 6.473822593688965
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.580710411071777
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 6.766985654830933
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 6.983304023742676
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.84178614616394
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 7263577
model size : 28.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.5433290004730225
Epoch: 1, Steps: 18 | Train Loss: 3.109 Vali Loss: 2.427 Vali Acc: 0.627 Test Loss: 2.427 Test Acc: 0.627
Validation loss decreased (inf --> -0.626642).  Saving model ...
Epoch: 2 cost time: 3.8926241397857666
Epoch: 2, Steps: 18 | Train Loss: 1.768 Vali Loss: 1.014 Vali Acc: 0.930 Test Loss: 1.014 Test Acc: 0.930
Validation loss decreased (-0.626642 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 3.7855899333953857
Epoch: 3, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.341 Vali Acc: 0.960 Test Loss: 0.341 Test Acc: 0.960
Validation loss decreased (-0.929990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 3.7330217361450195
Epoch: 4, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 3.931633472442627
Epoch: 5, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 3.54854416847229
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.053183078765869
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 3.812861680984497
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 4.278780460357666
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 4.129226446151733
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 4.135594606399536
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 3.7473723888397217
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 3.15194034576416
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.221346378326416
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.257932424545288
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.238595485687256
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.148716688156128
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 3.9815680980682373
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.8689448833465576
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.0035319328308105
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.022702693939209
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.00018048286438
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.8374381065368652
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.9411392211914062
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.98734450340271
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.002283811569214
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.9937667846679688
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.126375436782837
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.188384294509888
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.12457799911499
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2298457
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 15.170644760131836
Epoch: 1, Steps: 18 | Train Loss: 3.160 Vali Loss: 2.798 Vali Acc: 0.310 Test Loss: 2.798 Test Acc: 0.310
Validation loss decreased (inf --> -0.309972).  Saving model ...
Epoch: 2 cost time: 13.485222816467285
Epoch: 2, Steps: 18 | Train Loss: 2.394 Vali Loss: 1.861 Vali Acc: 0.857 Test Loss: 1.861 Test Acc: 0.857
Validation loss decreased (-0.309972 --> -0.856648).  Saving model ...
Epoch: 3 cost time: 13.40919303894043
Epoch: 3, Steps: 18 | Train Loss: 1.398 Vali Loss: 0.958 Vali Acc: 0.940 Test Loss: 0.958 Test Acc: 0.940
Validation loss decreased (-0.856648 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 13.081959247589111
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.422 Vali Acc: 0.963 Test Loss: 0.422 Test Acc: 0.963
Validation loss decreased (-0.939990 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 13.314980268478394
Epoch: 5, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 13.02738332748413
Epoch: 6, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.150 Vali Acc: 0.983 Test Loss: 0.150 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 13.783868789672852
Epoch: 7, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.481676578521729
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.444470643997192
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.224827527999878
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.528201580047607
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.614825010299683
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.272737503051758
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.683385372161865
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.771039009094238
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.518492937088013
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 13.250574827194214
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.437781810760498
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.761939525604248
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.939019918441772
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.865559816360474
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.702387809753418
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 13.106836318969727
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 12.751552820205688
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 13.294486284255981
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 13.361010074615479
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.946733713150024
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.852086544036865
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 13.123156309127808
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 11.754802703857422
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 7147897
model size : 27.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.492658376693726
Epoch: 1, Steps: 18 | Train Loss: 3.196 Vali Loss: 2.800 Vali Acc: 0.293 Test Loss: 2.800 Test Acc: 0.293
Validation loss decreased (inf --> -0.293305).  Saving model ...
Epoch: 2 cost time: 6.697691202163696
Epoch: 2, Steps: 18 | Train Loss: 2.411 Vali Loss: 1.891 Vali Acc: 0.900 Test Loss: 1.891 Test Acc: 0.900
Validation loss decreased (-0.293305 --> -0.899981).  Saving model ...
Epoch: 3 cost time: 6.750351667404175
Epoch: 3, Steps: 18 | Train Loss: 1.455 Vali Loss: 1.005 Vali Acc: 0.947 Test Loss: 1.005 Test Acc: 0.947
Validation loss decreased (-0.899981 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 6.814823627471924
Epoch: 4, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.459 Vali Acc: 0.967 Test Loss: 0.459 Test Acc: 0.967
Validation loss decreased (-0.946657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 6.863452911376953
Epoch: 5, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.226 Vali Acc: 0.977 Test Loss: 0.226 Test Acc: 0.977
Validation loss decreased (-0.966662 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 6.4621422290802
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.396285533905029
Epoch: 7, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.505706310272217
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.451344728469849
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.182944297790527
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.302433252334595
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.98723578453064
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.537110328674316
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 6.386297702789307
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 6.390071153640747
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 6.608001470565796
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 6.345484733581543
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 6.627878904342651
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 6.125036954879761
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 6.1473517417907715
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 6.330190181732178
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.128702163696289
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 6.378390550613403
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.269575595855713
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.29725456237793
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.618852376937866
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.28181004524231
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.381135940551758
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.545034408569336
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.235195159912109
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2182585
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.74896788597107
Epoch: 1, Steps: 18 | Train Loss: 3.160 Vali Loss: 2.798 Vali Acc: 0.310 Test Loss: 2.798 Test Acc: 0.310
Validation loss decreased (inf --> -0.309972).  Saving model ...
Epoch: 2 cost time: 8.917616605758667
Epoch: 2, Steps: 18 | Train Loss: 2.394 Vali Loss: 1.861 Vali Acc: 0.857 Test Loss: 1.861 Test Acc: 0.857
Validation loss decreased (-0.309972 --> -0.856648).  Saving model ...
Epoch: 3 cost time: 8.473723411560059
Epoch: 3, Steps: 18 | Train Loss: 1.398 Vali Loss: 0.958 Vali Acc: 0.940 Test Loss: 0.958 Test Acc: 0.940
Validation loss decreased (-0.856648 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 8.468097925186157
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.422 Vali Acc: 0.963 Test Loss: 0.422 Test Acc: 0.963
Validation loss decreased (-0.939990 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 9.279499292373657
Epoch: 5, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 9.392666101455688
Epoch: 6, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.150 Vali Acc: 0.983 Test Loss: 0.150 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 9.19348692893982
Epoch: 7, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.95339298248291
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.02300214767456
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.963279008865356
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.829917907714844
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.90128755569458
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.680758237838745
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.956700325012207
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.572859048843384
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.906699419021606
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 9.84694766998291
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.557548522949219
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.49421215057373
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.290504217147827
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.935012578964233
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.210639953613281
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 9.14868450164795
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.266731977462769
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.164874076843262
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.960102081298828
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.495525360107422
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.348756551742554
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.7973313331604
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.844342947006226
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 7147897
model size : 27.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.119889259338379
Epoch: 1, Steps: 18 | Train Loss: 3.196 Vali Loss: 2.800 Vali Acc: 0.293 Test Loss: 2.800 Test Acc: 0.293
Validation loss decreased (inf --> -0.293305).  Saving model ...
Epoch: 2 cost time: 5.481683254241943
Epoch: 2, Steps: 18 | Train Loss: 2.411 Vali Loss: 1.891 Vali Acc: 0.900 Test Loss: 1.891 Test Acc: 0.900
Validation loss decreased (-0.293305 --> -0.899981).  Saving model ...
Epoch: 3 cost time: 5.547300338745117
Epoch: 3, Steps: 18 | Train Loss: 1.455 Vali Loss: 1.005 Vali Acc: 0.947 Test Loss: 1.005 Test Acc: 0.947
Validation loss decreased (-0.899981 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 5.578614950180054
Epoch: 4, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.459 Vali Acc: 0.967 Test Loss: 0.459 Test Acc: 0.967
Validation loss decreased (-0.946657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 5.52410364151001
Epoch: 5, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.226 Vali Acc: 0.977 Test Loss: 0.226 Test Acc: 0.977
Validation loss decreased (-0.966662 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 5.369025707244873
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.550070524215698
Epoch: 7, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.434775114059448
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.265344619750977
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.335902214050293
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.317596435546875
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.2350475788116455
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.856571435928345
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 4.974846363067627
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 5.104529142379761
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 5.06294584274292
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 5.086816787719727
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 5.218033790588379
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 4.901473522186279
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 4.97996973991394
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 5.290642023086548
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.24494743347168
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 5.234150648117065
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.285737037658691
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.286754608154297
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.216906547546387
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.20211124420166
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.468611240386963
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.344664573669434
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.373032569885254
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2182585
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.267289400100708
Epoch: 1, Steps: 18 | Train Loss: 3.160 Vali Loss: 2.799 Vali Acc: 0.310 Test Loss: 2.799 Test Acc: 0.310
Validation loss decreased (inf --> -0.309972).  Saving model ...
Epoch: 2 cost time: 6.307250022888184
Epoch: 2, Steps: 18 | Train Loss: 2.396 Vali Loss: 1.866 Vali Acc: 0.857 Test Loss: 1.866 Test Acc: 0.857
Validation loss decreased (-0.309972 --> -0.856648).  Saving model ...
Epoch: 3 cost time: 6.41397500038147
Epoch: 3, Steps: 18 | Train Loss: 1.401 Vali Loss: 0.961 Vali Acc: 0.940 Test Loss: 0.961 Test Acc: 0.940
Validation loss decreased (-0.856648 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 6.410032510757446
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.423 Vali Acc: 0.967 Test Loss: 0.423 Test Acc: 0.967
Validation loss decreased (-0.939990 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 6.233530759811401
Epoch: 5, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
Validation loss decreased (-0.966662 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 6.57919979095459
Epoch: 6, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.149 Vali Acc: 0.983 Test Loss: 0.149 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 6.455198049545288
Epoch: 7, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.301630735397339
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.316012859344482
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.45577597618103
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.348598003387451
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.745601415634155
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.724348306655884
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.560377836227417
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.726988792419434
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.651066303253174
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 7147897
model size : 27.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.824397563934326
Epoch: 1, Steps: 18 | Train Loss: 3.195 Vali Loss: 2.800 Vali Acc: 0.293 Test Loss: 2.800 Test Acc: 0.293
Validation loss decreased (inf --> -0.293305).  Saving model ...
Epoch: 2 cost time: 4.0904693603515625
Epoch: 2, Steps: 18 | Train Loss: 2.412 Vali Loss: 1.891 Vali Acc: 0.900 Test Loss: 1.891 Test Acc: 0.900
Validation loss decreased (-0.293305 --> -0.899981).  Saving model ...
Epoch: 3 cost time: 3.8454113006591797
Epoch: 3, Steps: 18 | Train Loss: 1.456 Vali Loss: 1.005 Vali Acc: 0.947 Test Loss: 1.005 Test Acc: 0.947
Validation loss decreased (-0.899981 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 4.026640176773071
Epoch: 4, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.458 Vali Acc: 0.967 Test Loss: 0.458 Test Acc: 0.967
Validation loss decreased (-0.946657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 3.0254929065704346
Epoch: 5, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.224 Vali Acc: 0.977 Test Loss: 0.224 Test Acc: 0.977
Validation loss decreased (-0.966662 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 3.4523401260375977
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.027324199676514
Epoch: 7, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.967858076095581
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.922858953475952
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.743722677230835
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 3.990964651107788
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 4.047189235687256
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 4.009994268417358
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.985935688018799
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 3.8010735511779785
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.051697015762329
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.868443250656128
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.080127000808716
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.90944766998291
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 4.1257946491241455
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.469449281692505
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.16478157043457
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.9488043785095215
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.05610203742981
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.0034685134887695
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.904277801513672
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.009679555892944
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.918222427368164
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.0703980922698975
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.8593688011169434
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2182585
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.22018051147461
Epoch: 1, Steps: 18 | Train Loss: 3.055 Vali Loss: 2.733 Vali Acc: 0.340 Test Loss: 2.733 Test Acc: 0.340
Validation loss decreased (inf --> -0.339973).  Saving model ...
Epoch: 2 cost time: 8.387247323989868
Epoch: 2, Steps: 18 | Train Loss: 2.299 Vali Loss: 1.795 Vali Acc: 0.827 Test Loss: 1.795 Test Acc: 0.827
Validation loss decreased (-0.339973 --> -0.826649).  Saving model ...
Epoch: 3 cost time: 8.296883344650269
Epoch: 3, Steps: 18 | Train Loss: 1.320 Vali Loss: 0.942 Vali Acc: 0.927 Test Loss: 0.942 Test Acc: 0.927
Validation loss decreased (-0.826649 --> -0.926657).  Saving model ...
Epoch: 4 cost time: 7.995579957962036
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
Validation loss decreased (-0.926657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 7.3245415687561035
Epoch: 5, Steps: 18 | Train Loss: 0.223 Vali Loss: 0.236 Vali Acc: 0.977 Test Loss: 0.236 Test Acc: 0.977
Validation loss decreased (-0.966662 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 7.790138006210327
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 7.876358509063721
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 7.927035331726074
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 8.187099695205688
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.20977258682251
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.10853362083435
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.944226980209351
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.158327102661133
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.916857481002808
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.821857690811157
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.93550968170166
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.279130220413208
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.24021291732788
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3632377
model size : 14.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.526774168014526
Epoch: 1, Steps: 18 | Train Loss: 3.194 Vali Loss: 2.861 Vali Acc: 0.287 Test Loss: 2.861 Test Acc: 0.287
Validation loss decreased (inf --> -0.286638).  Saving model ...
Epoch: 2 cost time: 5.0086987018585205
Epoch: 2, Steps: 18 | Train Loss: 2.403 Vali Loss: 1.906 Vali Acc: 0.833 Test Loss: 1.906 Test Acc: 0.833
Validation loss decreased (-0.286638 --> -0.833314).  Saving model ...
Epoch: 3 cost time: 4.934788465499878
Epoch: 3, Steps: 18 | Train Loss: 1.394 Vali Loss: 1.002 Vali Acc: 0.940 Test Loss: 1.002 Test Acc: 0.940
Validation loss decreased (-0.833314 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 4.859977722167969
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.463 Vali Acc: 0.960 Test Loss: 0.463 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 4.80600380897522
Epoch: 5, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.252 Vali Acc: 0.970 Test Loss: 0.252 Test Acc: 0.970
Validation loss decreased (-0.959995 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 4.444573640823364
Epoch: 6, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 4.805560827255249
Epoch: 7, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 4.6451356410980225
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 4.663191080093384
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 4.5545127391815186
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 4.952465057373047
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 4.757842302322388
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 4.96045184135437
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 4.883443593978882
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 5.012739658355713
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 5.123091220855713
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 5.163819789886475
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.137133598327637
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 4.967186212539673
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.19017219543457
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.987362384796143
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 5.19878363609314
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.957354784011841
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.203949928283691
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.891450643539429
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.095093250274658
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.8935768604278564
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.099242687225342
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.980806350708008
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.036675930023193
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1149625
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.642374038696289
Epoch: 1, Steps: 18 | Train Loss: 3.055 Vali Loss: 2.733 Vali Acc: 0.340 Test Loss: 2.733 Test Acc: 0.340
Validation loss decreased (inf --> -0.339973).  Saving model ...
Epoch: 2 cost time: 6.4939305782318115
Epoch: 2, Steps: 18 | Train Loss: 2.299 Vali Loss: 1.795 Vali Acc: 0.827 Test Loss: 1.795 Test Acc: 0.827
Validation loss decreased (-0.339973 --> -0.826649).  Saving model ...
Epoch: 3 cost time: 6.672105550765991
Epoch: 3, Steps: 18 | Train Loss: 1.320 Vali Loss: 0.942 Vali Acc: 0.927 Test Loss: 0.942 Test Acc: 0.927
Validation loss decreased (-0.826649 --> -0.926657).  Saving model ...
Epoch: 4 cost time: 6.685530662536621
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
Validation loss decreased (-0.926657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 6.562417030334473
Epoch: 5, Steps: 18 | Train Loss: 0.223 Vali Loss: 0.236 Vali Acc: 0.977 Test Loss: 0.236 Test Acc: 0.977
Validation loss decreased (-0.966662 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 6.675306558609009
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 6.572234869003296
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 5.130805253982544
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 6.726535081863403
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.561670780181885
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.673511743545532
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.879070043563843
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.020045280456543
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.814997434616089
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.757889032363892
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.5787599086761475
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.80043888092041
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.675917148590088
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3632377
model size : 14.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.4112677574157715
Epoch: 1, Steps: 18 | Train Loss: 3.194 Vali Loss: 2.861 Vali Acc: 0.287 Test Loss: 2.861 Test Acc: 0.287
Validation loss decreased (inf --> -0.286638).  Saving model ...
Epoch: 2 cost time: 3.6155354976654053
Epoch: 2, Steps: 18 | Train Loss: 2.403 Vali Loss: 1.906 Vali Acc: 0.833 Test Loss: 1.906 Test Acc: 0.833
Validation loss decreased (-0.286638 --> -0.833314).  Saving model ...
Epoch: 3 cost time: 3.6233999729156494
Epoch: 3, Steps: 18 | Train Loss: 1.394 Vali Loss: 1.002 Vali Acc: 0.940 Test Loss: 1.002 Test Acc: 0.940
Validation loss decreased (-0.833314 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 3.633635997772217
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.463 Vali Acc: 0.960 Test Loss: 0.463 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 3.8260786533355713
Epoch: 5, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.252 Vali Acc: 0.970 Test Loss: 0.252 Test Acc: 0.970
Validation loss decreased (-0.959995 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 3.8973374366760254
Epoch: 6, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 3.9258508682250977
Epoch: 7, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 3.7401793003082275
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 3.5500032901763916
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 3.640958070755005
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 3.683441400527954
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 3.851712703704834
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.9053382873535156
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.8525803089141846
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 3.8382413387298584
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.6874046325683594
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.8254685401916504
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1676251888275146
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 3.7784650325775146
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.154452323913574
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.1849045753479
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 4.125285387039185
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.089249610900879
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.015399694442749
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.057807922363281
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.27536416053772
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.252785682678223
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.2362165451049805
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.254639387130737
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.228305101394653
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1149625
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.318183183670044
Epoch: 1, Steps: 18 | Train Loss: 3.055 Vali Loss: 2.733 Vali Acc: 0.340 Test Loss: 2.733 Test Acc: 0.340
Validation loss decreased (inf --> -0.339973).  Saving model ...
Epoch: 2 cost time: 4.634692907333374
Epoch: 2, Steps: 18 | Train Loss: 2.299 Vali Loss: 1.795 Vali Acc: 0.827 Test Loss: 1.795 Test Acc: 0.827
Validation loss decreased (-0.339973 --> -0.826649).  Saving model ...
Epoch: 3 cost time: 4.902653455734253
Epoch: 3, Steps: 18 | Train Loss: 1.320 Vali Loss: 0.942 Vali Acc: 0.927 Test Loss: 0.942 Test Acc: 0.927
Validation loss decreased (-0.826649 --> -0.926657).  Saving model ...
Epoch: 4 cost time: 4.862402439117432
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
Validation loss decreased (-0.926657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 4.799031019210815
Epoch: 5, Steps: 18 | Train Loss: 0.223 Vali Loss: 0.236 Vali Acc: 0.977 Test Loss: 0.236 Test Acc: 0.977
Validation loss decreased (-0.966662 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 4.827596664428711
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 4.833357334136963
Epoch: 7, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 4.85844874382019
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 4.902913808822632
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.887469053268433
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.835531711578369
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.714676141738892
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.863455295562744
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.828628778457642
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.791368722915649
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.647111892700195
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.855877161026001
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.918910026550293
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.919999837875366
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.919563293457031
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.8877763748168945
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.904268026351929
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.94177770614624
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.925766944885254
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.90021824836731
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.541646718978882
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.791593074798584
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.875183820724487
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.824501276016235
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3632377
model size : 14.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.9320948123931885
Epoch: 1, Steps: 18 | Train Loss: 3.194 Vali Loss: 2.861 Vali Acc: 0.287 Test Loss: 2.861 Test Acc: 0.287
Validation loss decreased (inf --> -0.286638).  Saving model ...
Epoch: 2 cost time: 3.453523635864258
Epoch: 2, Steps: 18 | Train Loss: 2.403 Vali Loss: 1.906 Vali Acc: 0.833 Test Loss: 1.906 Test Acc: 0.833
Validation loss decreased (-0.286638 --> -0.833314).  Saving model ...
Epoch: 3 cost time: 3.5754361152648926
Epoch: 3, Steps: 18 | Train Loss: 1.394 Vali Loss: 1.002 Vali Acc: 0.940 Test Loss: 1.002 Test Acc: 0.940
Validation loss decreased (-0.833314 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 3.401968240737915
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.463 Vali Acc: 0.960 Test Loss: 0.463 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 3.5031213760375977
Epoch: 5, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.252 Vali Acc: 0.970 Test Loss: 0.252 Test Acc: 0.970
Validation loss decreased (-0.959995 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 3.355297088623047
Epoch: 6, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 3.5004334449768066
Epoch: 7, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 3.578462600708008
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 3.5742180347442627
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 3.4361205101013184
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 3.4864161014556885
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 3.396538257598877
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.4901177883148193
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.2720582485198975
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 3.186446189880371
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.5475351810455322
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.4416801929473877
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.36533784866333
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 3.6422781944274902
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 3.7308497428894043
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.6850876808166504
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 3.603044271469116
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.652700662612915
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 3.701195001602173
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 3.606632947921753
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 3.6687710285186768
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 3.579859972000122
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.539170742034912
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.4766430854797363
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5629777908325195
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1149625
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.240975379943848
Epoch: 1, Steps: 18 | Train Loss: 3.153 Vali Loss: 2.829 Vali Acc: 0.277 Test Loss: 2.829 Test Acc: 0.277
Validation loss decreased (inf --> -0.276638).  Saving model ...
Epoch: 2 cost time: 6.623409271240234
Epoch: 2, Steps: 18 | Train Loss: 2.410 Vali Loss: 1.892 Vali Acc: 0.820 Test Loss: 1.892 Test Acc: 0.820
Validation loss decreased (-0.276638 --> -0.819981).  Saving model ...
Epoch: 3 cost time: 6.682984352111816
Epoch: 3, Steps: 18 | Train Loss: 1.415 Vali Loss: 1.051 Vali Acc: 0.927 Test Loss: 1.051 Test Acc: 0.927
Validation loss decreased (-0.819981 --> -0.926656).  Saving model ...
Epoch: 4 cost time: 6.702368259429932
Epoch: 4, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.519 Vali Acc: 0.947 Test Loss: 0.519 Test Acc: 0.947
Validation loss decreased (-0.926656 --> -0.946661).  Saving model ...
Epoch: 5 cost time: 6.591959714889526
Epoch: 5, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.281 Vali Acc: 0.953 Test Loss: 0.281 Test Acc: 0.953
Validation loss decreased (-0.946661 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 6.615220308303833
Epoch: 6, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 7.103423595428467
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 7.05515718460083
Epoch: 8, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 6.9964869022369385
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 6.778639554977417
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 7.136624574661255
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.151812791824341
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.052639484405518
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.869184732437134
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.152761697769165
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.143892288208008
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.949379920959473
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.854346036911011
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.8028199672698975
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.751025199890137
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1874617
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.920188903808594
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.807 Vali Acc: 0.343 Test Loss: 2.807 Test Acc: 0.343
Validation loss decreased (inf --> -0.343305).  Saving model ...
Epoch: 2 cost time: 4.267247915267944
Epoch: 2, Steps: 18 | Train Loss: 2.370 Vali Loss: 1.896 Vali Acc: 0.863 Test Loss: 1.896 Test Acc: 0.863
Validation loss decreased (-0.343305 --> -0.863314).  Saving model ...
Epoch: 3 cost time: 4.393946170806885
Epoch: 3, Steps: 18 | Train Loss: 1.427 Vali Loss: 1.055 Vali Acc: 0.937 Test Loss: 1.055 Test Acc: 0.937
Validation loss decreased (-0.863314 --> -0.936656).  Saving model ...
Epoch: 4 cost time: 4.326153993606567
Epoch: 4, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.525 Vali Acc: 0.953 Test Loss: 0.525 Test Acc: 0.953
Validation loss decreased (-0.936656 --> -0.953328).  Saving model ...
Epoch: 5 cost time: 4.3271777629852295
Epoch: 5, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.4710094928741455
Epoch: 6, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.953328 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 4.492083311080933
Epoch: 7, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 4.588809251785278
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.52271842956543
Epoch: 9, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.468801736831665
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.316616058349609
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 4.581118822097778
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 4.607801198959351
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.597400665283203
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.560744285583496
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.564565896987915
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.590638637542725
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.5780394077301025
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.450543642044067
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.431847810745239
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.407374143600464
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.482202768325806
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 633145
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.3423497676849365
Epoch: 1, Steps: 18 | Train Loss: 3.153 Vali Loss: 2.829 Vali Acc: 0.277 Test Loss: 2.829 Test Acc: 0.277
Validation loss decreased (inf --> -0.276638).  Saving model ...
Epoch: 2 cost time: 5.416406869888306
Epoch: 2, Steps: 18 | Train Loss: 2.410 Vali Loss: 1.892 Vali Acc: 0.820 Test Loss: 1.892 Test Acc: 0.820
Validation loss decreased (-0.276638 --> -0.819981).  Saving model ...
Epoch: 3 cost time: 5.414813280105591
Epoch: 3, Steps: 18 | Train Loss: 1.415 Vali Loss: 1.051 Vali Acc: 0.927 Test Loss: 1.051 Test Acc: 0.927
Validation loss decreased (-0.819981 --> -0.926656).  Saving model ...
Epoch: 4 cost time: 5.612948656082153
Epoch: 4, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.519 Vali Acc: 0.947 Test Loss: 0.519 Test Acc: 0.947
Validation loss decreased (-0.926656 --> -0.946661).  Saving model ...
Epoch: 5 cost time: 5.5801613330841064
Epoch: 5, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.281 Vali Acc: 0.953 Test Loss: 0.281 Test Acc: 0.953
Validation loss decreased (-0.946661 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 5.465368032455444
Epoch: 6, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 5.396669387817383
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 5.5204102993011475
Epoch: 8, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 5.571877717971802
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 5.561600208282471
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 5.373974084854126
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.2893688678741455
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.617707014083862
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.6476149559021
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.678481340408325
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.6950013637542725
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.576662540435791
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.564949989318848
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.5579259395599365
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.464358806610107
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1874617
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.542839288711548
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.807 Vali Acc: 0.343 Test Loss: 2.807 Test Acc: 0.343
Validation loss decreased (inf --> -0.343305).  Saving model ...
Epoch: 2 cost time: 3.9828553199768066
Epoch: 2, Steps: 18 | Train Loss: 2.370 Vali Loss: 1.896 Vali Acc: 0.863 Test Loss: 1.896 Test Acc: 0.863
Validation loss decreased (-0.343305 --> -0.863314).  Saving model ...
Epoch: 3 cost time: 3.8524937629699707
Epoch: 3, Steps: 18 | Train Loss: 1.427 Vali Loss: 1.055 Vali Acc: 0.937 Test Loss: 1.055 Test Acc: 0.937
Validation loss decreased (-0.863314 --> -0.936656).  Saving model ...
Epoch: 4 cost time: 3.775754451751709
Epoch: 4, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.525 Vali Acc: 0.953 Test Loss: 0.525 Test Acc: 0.953
Validation loss decreased (-0.936656 --> -0.953328).  Saving model ...
Epoch: 5 cost time: 3.5013818740844727
Epoch: 5, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7381391525268555
Epoch: 6, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.953328 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 2.9778249263763428
Epoch: 7, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 3.8084664344787598
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7449755668640137
Epoch: 9, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.697378158569336
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7938930988311768
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 3.7145538330078125
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.8690025806427
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6506829261779785
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.739769220352173
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7591116428375244
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.655186653137207
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7713472843170166
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.668609142303467
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.472669839859009
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.6057775020599365
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.6146156787872314
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 633145
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.5685951709747314
Epoch: 1, Steps: 18 | Train Loss: 3.154 Vali Loss: 2.829 Vali Acc: 0.277 Test Loss: 2.829 Test Acc: 0.277
Validation loss decreased (inf --> -0.276638).  Saving model ...
Epoch: 2 cost time: 4.090399265289307
Epoch: 2, Steps: 18 | Train Loss: 2.411 Vali Loss: 1.892 Vali Acc: 0.820 Test Loss: 1.892 Test Acc: 0.820
Validation loss decreased (-0.276638 --> -0.819981).  Saving model ...
Epoch: 3 cost time: 4.074183464050293
Epoch: 3, Steps: 18 | Train Loss: 1.416 Vali Loss: 1.051 Vali Acc: 0.927 Test Loss: 1.051 Test Acc: 0.927
Validation loss decreased (-0.819981 --> -0.926656).  Saving model ...
Epoch: 4 cost time: 4.111807346343994
Epoch: 4, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.518 Vali Acc: 0.947 Test Loss: 0.518 Test Acc: 0.947
Validation loss decreased (-0.926656 --> -0.946661).  Saving model ...
Epoch: 5 cost time: 4.246644735336304
Epoch: 5, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.280 Vali Acc: 0.953 Test Loss: 0.280 Test Acc: 0.953
Validation loss decreased (-0.946661 --> -0.953331).  Saving model ...
Epoch: 6 cost time: 4.183006763458252
Epoch: 6, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 4.25371527671814
Epoch: 7, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 4.24189567565918
Epoch: 8, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 4.115567445755005
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 4.2468225955963135
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 4.125156402587891
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.165172815322876
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.291403293609619
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.09529709815979
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.27313494682312
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.073983430862427
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.8995954990386963
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.148089170455933
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.9243643283843994
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.124624490737915
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1874617
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.596293687820435
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.807 Vali Acc: 0.343 Test Loss: 2.807 Test Acc: 0.343
Validation loss decreased (inf --> -0.343305).  Saving model ...
Epoch: 2 cost time: 2.849994659423828
Epoch: 2, Steps: 18 | Train Loss: 2.370 Vali Loss: 1.896 Vali Acc: 0.863 Test Loss: 1.896 Test Acc: 0.863
Validation loss decreased (-0.343305 --> -0.863314).  Saving model ...
Epoch: 3 cost time: 2.663419246673584
Epoch: 3, Steps: 18 | Train Loss: 1.427 Vali Loss: 1.055 Vali Acc: 0.937 Test Loss: 1.055 Test Acc: 0.937
Validation loss decreased (-0.863314 --> -0.936656).  Saving model ...
Epoch: 4 cost time: 2.872810125350952
Epoch: 4, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.525 Vali Acc: 0.953 Test Loss: 0.525 Test Acc: 0.953
Validation loss decreased (-0.936656 --> -0.953328).  Saving model ...
Epoch: 5 cost time: 2.820200204849243
Epoch: 5, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.634636878967285
Epoch: 6, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.953328 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 2.930112600326538
Epoch: 7, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 2.9214513301849365
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8134982585906982
Epoch: 9, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9358437061309814
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3515231609344482
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.3395237922668457
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.029331922531128
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.013101100921631
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.07024884223938
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0347068309783936
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.010418653488159
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.048919677734375
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.070122241973877
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0821330547332764
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.961873769760132
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.851261615753174
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 633145
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.307516813278198
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.966 Vali Acc: 0.170 Test Loss: 2.966 Test Acc: 0.170
Validation loss decreased (inf --> -0.169970).  Saving model ...
Epoch: 2 cost time: 8.21909236907959
Epoch: 2, Steps: 18 | Train Loss: 2.769 Vali Loss: 2.469 Vali Acc: 0.670 Test Loss: 2.469 Test Acc: 0.670
Validation loss decreased (-0.169970 --> -0.669975).  Saving model ...
Epoch: 3 cost time: 8.244656562805176
Epoch: 3, Steps: 18 | Train Loss: 2.173 Vali Loss: 1.863 Vali Acc: 0.873 Test Loss: 1.863 Test Acc: 0.873
Validation loss decreased (-0.669975 --> -0.873315).  Saving model ...
Epoch: 4 cost time: 8.003629446029663
Epoch: 4, Steps: 18 | Train Loss: 1.564 Vali Loss: 1.269 Vali Acc: 0.927 Test Loss: 1.269 Test Acc: 0.927
Validation loss decreased (-0.873315 --> -0.926654).  Saving model ...
Epoch: 5 cost time: 7.848880290985107
Epoch: 5, Steps: 18 | Train Loss: 0.979 Vali Loss: 0.791 Vali Acc: 0.950 Test Loss: 0.791 Test Acc: 0.950
Validation loss decreased (-0.926654 --> -0.949992).  Saving model ...
Epoch: 6 cost time: 7.991705417633057
Epoch: 6, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 7.685714960098267
Epoch: 7, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.335 Vali Acc: 0.953 Test Loss: 0.335 Test Acc: 0.953
Validation loss decreased (-0.949995 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 7.778644323348999
Epoch: 8, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.262 Vali Acc: 0.960 Test Loss: 0.262 Test Acc: 0.960
Validation loss decreased (-0.953330 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 7.940306186676025
Epoch: 9, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.220 Vali Acc: 0.960 Test Loss: 0.220 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 7.718198776245117
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.934290885925293
Epoch: 11, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.718807220458984
Epoch: 12, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 13 cost time: 7.862599849700928
Epoch: 13, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.01469111442566
Epoch: 14, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 15 cost time: 7.836230278015137
Epoch: 15, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.064382553100586
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.073458909988403
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 18 cost time: 7.43545937538147
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.821588516235352
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.754829168319702
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.5628437995910645
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 22 cost time: 8.078418016433716
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 23 cost time: 7.897845029830933
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.029684782028198
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.001261949539185
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.794412612915039
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.012988090515137
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 7.855014801025391
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.675967216491699
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 8.241324186325073
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1816777
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.464181184768677
Epoch: 1, Steps: 18 | Train Loss: 3.199 Vali Loss: 3.000 Vali Acc: 0.133 Test Loss: 3.000 Test Acc: 0.133
Validation loss decreased (inf --> -0.133303).  Saving model ...
Epoch: 2 cost time: 4.7101709842681885
Epoch: 2, Steps: 18 | Train Loss: 2.796 Vali Loss: 2.451 Vali Acc: 0.630 Test Loss: 2.451 Test Acc: 0.630
Validation loss decreased (-0.133303 --> -0.629975).  Saving model ...
Epoch: 3 cost time: 4.548033237457275
Epoch: 3, Steps: 18 | Train Loss: 2.188 Vali Loss: 1.815 Vali Acc: 0.887 Test Loss: 1.815 Test Acc: 0.887
Validation loss decreased (-0.629975 --> -0.886649).  Saving model ...
Epoch: 4 cost time: 4.458898067474365
Epoch: 4, Steps: 18 | Train Loss: 1.484 Vali Loss: 1.211 Vali Acc: 0.913 Test Loss: 1.211 Test Acc: 0.913
Validation loss decreased (-0.886649 --> -0.913321).  Saving model ...
Epoch: 5 cost time: 4.581044912338257
Epoch: 5, Steps: 18 | Train Loss: 0.933 Vali Loss: 0.744 Vali Acc: 0.937 Test Loss: 0.744 Test Acc: 0.937
Validation loss decreased (-0.913321 --> -0.936659).  Saving model ...
Epoch: 6 cost time: 4.578762054443359
Epoch: 6, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.458 Vali Acc: 0.960 Test Loss: 0.458 Test Acc: 0.960
Validation loss decreased (-0.936659 --> -0.959995).  Saving model ...
Epoch: 7 cost time: 4.595665216445923
Epoch: 7, Steps: 18 | Train Loss: 0.307 Vali Loss: 0.322 Vali Acc: 0.967 Test Loss: 0.322 Test Acc: 0.967
Validation loss decreased (-0.959995 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 4.454358339309692
Epoch: 8, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 4.567036390304565
Epoch: 9, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 4.681979656219482
Epoch: 10, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 4.703316926956177
Epoch: 11, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.51019549369812
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 4.44965386390686
Epoch: 13, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.744521379470825
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 4.715102195739746
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 4.638865947723389
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.415003538131714
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.708258867263794
Epoch: 18, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.70262336730957
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.625951290130615
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 4.598268747329712
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 4.735082149505615
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 4.69138503074646
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 4.612471342086792
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 4.6072070598602295
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 4.62751030921936
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 4.59148645401001
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 4.527365207672119
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 4.513244152069092
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.665449619293213
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 575209
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.167773962020874
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.966 Vali Acc: 0.170 Test Loss: 2.966 Test Acc: 0.170
Validation loss decreased (inf --> -0.169970).  Saving model ...
Epoch: 2 cost time: 6.539458274841309
Epoch: 2, Steps: 18 | Train Loss: 2.769 Vali Loss: 2.469 Vali Acc: 0.670 Test Loss: 2.469 Test Acc: 0.670
Validation loss decreased (-0.169970 --> -0.669975).  Saving model ...
Epoch: 3 cost time: 6.691779136657715
Epoch: 3, Steps: 18 | Train Loss: 2.173 Vali Loss: 1.863 Vali Acc: 0.873 Test Loss: 1.863 Test Acc: 0.873
Validation loss decreased (-0.669975 --> -0.873315).  Saving model ...
Epoch: 4 cost time: 6.606776475906372
Epoch: 4, Steps: 18 | Train Loss: 1.564 Vali Loss: 1.269 Vali Acc: 0.927 Test Loss: 1.269 Test Acc: 0.927
Validation loss decreased (-0.873315 --> -0.926654).  Saving model ...
Epoch: 5 cost time: 6.502662897109985
Epoch: 5, Steps: 18 | Train Loss: 0.979 Vali Loss: 0.791 Vali Acc: 0.950 Test Loss: 0.791 Test Acc: 0.950
Validation loss decreased (-0.926654 --> -0.949992).  Saving model ...
Epoch: 6 cost time: 6.683028221130371
Epoch: 6, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 6.5541346073150635
Epoch: 7, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.335 Vali Acc: 0.953 Test Loss: 0.335 Test Acc: 0.953
Validation loss decreased (-0.949995 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 6.429065704345703
Epoch: 8, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.262 Vali Acc: 0.960 Test Loss: 0.262 Test Acc: 0.960
Validation loss decreased (-0.953330 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 6.670838832855225
Epoch: 9, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.220 Vali Acc: 0.960 Test Loss: 0.220 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 6.597962856292725
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.377002239227295
Epoch: 11, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.377457141876221
Epoch: 12, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 13 cost time: 6.237391233444214
Epoch: 13, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.931164503097534
Epoch: 14, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 15 cost time: 6.379711389541626
Epoch: 15, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.1927080154418945
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.159005880355835
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 18 cost time: 6.335037469863892
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.179480314254761
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.193072319030762
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.458659410476685
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 22 cost time: 6.57925009727478
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 23 cost time: 6.5365259647369385
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.513590574264526
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.659282922744751
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.5942909717559814
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.286197662353516
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 5.945001840591431
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.166962385177612
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.523205041885376
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1816777
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.548327445983887
Epoch: 1, Steps: 18 | Train Loss: 3.199 Vali Loss: 3.000 Vali Acc: 0.133 Test Loss: 3.000 Test Acc: 0.133
Validation loss decreased (inf --> -0.133303).  Saving model ...
Epoch: 2 cost time: 3.939577579498291
Epoch: 2, Steps: 18 | Train Loss: 2.796 Vali Loss: 2.451 Vali Acc: 0.630 Test Loss: 2.451 Test Acc: 0.630
Validation loss decreased (-0.133303 --> -0.629975).  Saving model ...
Epoch: 3 cost time: 3.831083059310913
Epoch: 3, Steps: 18 | Train Loss: 2.188 Vali Loss: 1.815 Vali Acc: 0.887 Test Loss: 1.815 Test Acc: 0.887
Validation loss decreased (-0.629975 --> -0.886649).  Saving model ...
Epoch: 4 cost time: 3.9575726985931396
Epoch: 4, Steps: 18 | Train Loss: 1.484 Vali Loss: 1.211 Vali Acc: 0.913 Test Loss: 1.211 Test Acc: 0.913
Validation loss decreased (-0.886649 --> -0.913321).  Saving model ...
Epoch: 5 cost time: 3.7168915271759033
Epoch: 5, Steps: 18 | Train Loss: 0.933 Vali Loss: 0.744 Vali Acc: 0.937 Test Loss: 0.744 Test Acc: 0.937
Validation loss decreased (-0.913321 --> -0.936659).  Saving model ...
Epoch: 6 cost time: 3.8381893634796143
Epoch: 6, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.458 Vali Acc: 0.960 Test Loss: 0.458 Test Acc: 0.960
Validation loss decreased (-0.936659 --> -0.959995).  Saving model ...
Epoch: 7 cost time: 3.6604204177856445
Epoch: 7, Steps: 18 | Train Loss: 0.307 Vali Loss: 0.322 Vali Acc: 0.967 Test Loss: 0.322 Test Acc: 0.967
Validation loss decreased (-0.959995 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 3.982858896255493
Epoch: 8, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 3.8203847408294678
Epoch: 9, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 4.026886701583862
Epoch: 10, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 3.8825266361236572
Epoch: 11, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.104653835296631
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 3.882608652114868
Epoch: 13, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.159254550933838
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.9416935443878174
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 4.082902908325195
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.053076505661011
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.299408197402954
Epoch: 18, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.125103712081909
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.335234642028809
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 4.142179727554321
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 4.213404893875122
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 4.027120351791382
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 4.23797869682312
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 4.025951623916626
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 4.143083333969116
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 3.9170846939086914
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 4.160054445266724
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 3.860555410385132
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.0679566860198975
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 575209
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.201864719390869
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.966 Vali Acc: 0.170 Test Loss: 2.966 Test Acc: 0.170
Validation loss decreased (inf --> -0.169970).  Saving model ...
Epoch: 2 cost time: 4.548019886016846
Epoch: 2, Steps: 18 | Train Loss: 2.769 Vali Loss: 2.469 Vali Acc: 0.670 Test Loss: 2.469 Test Acc: 0.670
Validation loss decreased (-0.169970 --> -0.669975).  Saving model ...
Epoch: 3 cost time: 4.5181286334991455
Epoch: 3, Steps: 18 | Train Loss: 2.173 Vali Loss: 1.863 Vali Acc: 0.873 Test Loss: 1.863 Test Acc: 0.873
Validation loss decreased (-0.669975 --> -0.873315).  Saving model ...
Epoch: 4 cost time: 4.5027055740356445
Epoch: 4, Steps: 18 | Train Loss: 1.564 Vali Loss: 1.269 Vali Acc: 0.927 Test Loss: 1.269 Test Acc: 0.927
Validation loss decreased (-0.873315 --> -0.926654).  Saving model ...
Epoch: 5 cost time: 4.561722993850708
Epoch: 5, Steps: 18 | Train Loss: 0.979 Vali Loss: 0.791 Vali Acc: 0.950 Test Loss: 0.791 Test Acc: 0.950
Validation loss decreased (-0.926654 --> -0.949992).  Saving model ...
Epoch: 6 cost time: 4.457718849182129
Epoch: 6, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.489 Vali Acc: 0.953 Test Loss: 0.489 Test Acc: 0.953
Validation loss decreased (-0.949992 --> -0.953328).  Saving model ...
Epoch: 7 cost time: 4.588574647903442
Epoch: 7, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.335 Vali Acc: 0.953 Test Loss: 0.335 Test Acc: 0.953
Validation loss decreased (-0.953328 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 4.454039096832275
Epoch: 8, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.261 Vali Acc: 0.960 Test Loss: 0.261 Test Acc: 0.960
Validation loss decreased (-0.953330 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 4.492699146270752
Epoch: 9, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 4.4930009841918945
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.490659952163696
Epoch: 11, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 12 cost time: 4.4604811668396
Epoch: 12, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 13 cost time: 4.619507551193237
Epoch: 13, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.447482585906982
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 15 cost time: 4.7310943603515625
Epoch: 15, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.625497102737427
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.493723154067993
Epoch: 17, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 18 cost time: 4.672621011734009
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.461751461029053
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.679153919219971
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.601732015609741
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.363073825836182
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 23 cost time: 4.67211127281189
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.629703998565674
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.737588882446289
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.6193528175354
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 4.411770820617676
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.694474697113037
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.539034605026245
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.619906425476074
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 1816777
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.580451726913452
Epoch: 1, Steps: 18 | Train Loss: 3.199 Vali Loss: 3.000 Vali Acc: 0.133 Test Loss: 3.000 Test Acc: 0.133
Validation loss decreased (inf --> -0.133303).  Saving model ...
Epoch: 2 cost time: 3.010197162628174
Epoch: 2, Steps: 18 | Train Loss: 2.796 Vali Loss: 2.451 Vali Acc: 0.627 Test Loss: 2.451 Test Acc: 0.627
Validation loss decreased (-0.133303 --> -0.626642).  Saving model ...
Epoch: 3 cost time: 2.9840829372406006
Epoch: 3, Steps: 18 | Train Loss: 2.190 Vali Loss: 1.815 Vali Acc: 0.887 Test Loss: 1.815 Test Acc: 0.887
Validation loss decreased (-0.626642 --> -0.886649).  Saving model ...
Epoch: 4 cost time: 2.846036672592163
Epoch: 4, Steps: 18 | Train Loss: 1.487 Vali Loss: 1.210 Vali Acc: 0.913 Test Loss: 1.210 Test Acc: 0.913
Validation loss decreased (-0.886649 --> -0.913321).  Saving model ...
Epoch: 5 cost time: 3.1256802082061768
Epoch: 5, Steps: 18 | Train Loss: 0.938 Vali Loss: 0.743 Vali Acc: 0.937 Test Loss: 0.743 Test Acc: 0.937
Validation loss decreased (-0.913321 --> -0.936659).  Saving model ...
Epoch: 6 cost time: 3.0575830936431885
Epoch: 6, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.457 Vali Acc: 0.967 Test Loss: 0.457 Test Acc: 0.967
Validation loss decreased (-0.936659 --> -0.966662).  Saving model ...
Epoch: 7 cost time: 2.9738245010375977
Epoch: 7, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.321 Vali Acc: 0.970 Test Loss: 0.321 Test Acc: 0.970
Validation loss decreased (-0.966662 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 3.147949457168579
Epoch: 8, Steps: 18 | Train Loss: 0.197 Vali Loss: 0.244 Vali Acc: 0.967 Test Loss: 0.244 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0615696907043457
Epoch: 9, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 2.872657299041748
Epoch: 10, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 3.052311658859253
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0861387252807617
Epoch: 12, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 2.8979551792144775
Epoch: 13, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.989954710006714
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.1394076347351074
Epoch: 15, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 3.122229814529419
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.857860803604126
Epoch: 17, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1519038677215576
Epoch: 18, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2160146236419678
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.053189516067505
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.2562310695648193
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 3.2128565311431885
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.1960573196411133
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 3.3330237865448
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 3.2728970050811768
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 3.1043918132781982
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 3.2817108631134033
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 3.2917323112487793
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 3.270369052886963
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0168793201446533
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 575209
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.3462324142456055
Epoch: 1, Steps: 18 | Train Loss: 3.273 Vali Loss: 3.104 Vali Acc: 0.073 Test Loss: 3.104 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 5.885610342025757
Epoch: 2, Steps: 18 | Train Loss: 2.895 Vali Loss: 2.636 Vali Acc: 0.487 Test Loss: 2.636 Test Acc: 0.487
Validation loss decreased (-0.073302 --> -0.486640).  Saving model ...
Epoch: 3 cost time: 5.688448905944824
Epoch: 3, Steps: 18 | Train Loss: 2.345 Vali Loss: 2.088 Vali Acc: 0.793 Test Loss: 2.088 Test Acc: 0.793
Validation loss decreased (-0.486640 --> -0.793312).  Saving model ...
Epoch: 4 cost time: 5.840713739395142
Epoch: 4, Steps: 18 | Train Loss: 1.757 Vali Loss: 1.516 Vali Acc: 0.877 Test Loss: 1.516 Test Acc: 0.877
Validation loss decreased (-0.793312 --> -0.876652).  Saving model ...
Epoch: 5 cost time: 5.4353461265563965
Epoch: 5, Steps: 18 | Train Loss: 1.140 Vali Loss: 1.005 Vali Acc: 0.900 Test Loss: 1.005 Test Acc: 0.900
Validation loss decreased (-0.876652 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 5.601869583129883
Epoch: 6, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.625 Vali Acc: 0.923 Test Loss: 0.625 Test Acc: 0.923
Validation loss decreased (-0.899990 --> -0.923327).  Saving model ...
Epoch: 7 cost time: 5.5936901569366455
Epoch: 7, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.404 Vali Acc: 0.953 Test Loss: 0.404 Test Acc: 0.953
Validation loss decreased (-0.923327 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 5.4652018547058105
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.307 Vali Acc: 0.953 Test Loss: 0.307 Test Acc: 0.953
Validation loss decreased (-0.953329 --> -0.953330).  Saving model ...
Epoch: 9 cost time: 5.523274660110474
Epoch: 9, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.247 Vali Acc: 0.963 Test Loss: 0.247 Test Acc: 0.963
Validation loss decreased (-0.953330 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 5.330292701721191
Epoch: 10, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 5.67964243888855
Epoch: 11, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.476039886474609
Epoch: 12, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 5.692938566207886
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.104448318481445
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 5.552770376205444
Epoch: 15, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 5.354586362838745
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 5.601311445236206
Epoch: 17, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 5.364173173904419
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 5.15218448638916
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 4.472015380859375
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 5.2762463092803955
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 5.374860048294067
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 5.618549823760986
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 5.496843338012695
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.503647565841675
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.507536888122559
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 5.524368762969971
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.375437021255493
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.24619722366333
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.304392099380493
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 937609
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.394247055053711
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.973 Vali Acc: 0.163 Test Loss: 2.973 Test Acc: 0.163
Validation loss decreased (inf --> -0.163304).  Saving model ...
Epoch: 2 cost time: 3.5560526847839355
Epoch: 2, Steps: 18 | Train Loss: 2.777 Vali Loss: 2.450 Vali Acc: 0.597 Test Loss: 2.450 Test Acc: 0.597
Validation loss decreased (-0.163304 --> -0.596642).  Saving model ...
Epoch: 3 cost time: 3.5056519508361816
Epoch: 3, Steps: 18 | Train Loss: 2.161 Vali Loss: 1.854 Vali Acc: 0.843 Test Loss: 1.854 Test Acc: 0.843
Validation loss decreased (-0.596642 --> -0.843315).  Saving model ...
Epoch: 4 cost time: 3.732365369796753
Epoch: 4, Steps: 18 | Train Loss: 1.531 Vali Loss: 1.289 Vali Acc: 0.907 Test Loss: 1.289 Test Acc: 0.907
Validation loss decreased (-0.843315 --> -0.906654).  Saving model ...
Epoch: 5 cost time: 3.596447706222534
Epoch: 5, Steps: 18 | Train Loss: 0.970 Vali Loss: 0.834 Vali Acc: 0.937 Test Loss: 0.834 Test Acc: 0.937
Validation loss decreased (-0.906654 --> -0.936658).  Saving model ...
Epoch: 6 cost time: 3.4517970085144043
Epoch: 6, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.532 Vali Acc: 0.940 Test Loss: 0.532 Test Acc: 0.940
Validation loss decreased (-0.936658 --> -0.939995).  Saving model ...
Epoch: 7 cost time: 3.65134859085083
Epoch: 7, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.377 Vali Acc: 0.953 Test Loss: 0.377 Test Acc: 0.953
Validation loss decreased (-0.939995 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 3.5862948894500732
Epoch: 8, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.290 Vali Acc: 0.957 Test Loss: 0.290 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 9 cost time: 3.593266487121582
Epoch: 9, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.248 Vali Acc: 0.960 Test Loss: 0.248 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 3.6672987937927246
Epoch: 10, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 2.910740613937378
Epoch: 11, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8454599380493164
Epoch: 12, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 13 cost time: 3.8385231494903564
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7308151721954346
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 3.557664632797241
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 3.8221869468688965
Epoch: 16, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 3.816606283187866
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.729146957397461
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 19 cost time: 3.5307047367095947
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 20 cost time: 3.8430190086364746
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 21 cost time: 3.786677598953247
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 22 cost time: 3.7037439346313477
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 23 cost time: 3.8473026752471924
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 24 cost time: 3.8448688983917236
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 3.756829261779785
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 26 cost time: 3.564671516418457
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 27 cost time: 3.702057123184204
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 3.5610554218292236
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 3.581650733947754
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.717869997024536
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 316777
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.635526180267334
Epoch: 1, Steps: 18 | Train Loss: 3.273 Vali Loss: 3.104 Vali Acc: 0.073 Test Loss: 3.104 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 4.699187994003296
Epoch: 2, Steps: 18 | Train Loss: 2.895 Vali Loss: 2.636 Vali Acc: 0.487 Test Loss: 2.636 Test Acc: 0.487
Validation loss decreased (-0.073302 --> -0.486640).  Saving model ...
Epoch: 3 cost time: 4.5212721824646
Epoch: 3, Steps: 18 | Train Loss: 2.345 Vali Loss: 2.088 Vali Acc: 0.793 Test Loss: 2.088 Test Acc: 0.793
Validation loss decreased (-0.486640 --> -0.793312).  Saving model ...
Epoch: 4 cost time: 4.67332911491394
Epoch: 4, Steps: 18 | Train Loss: 1.757 Vali Loss: 1.516 Vali Acc: 0.877 Test Loss: 1.516 Test Acc: 0.877
Validation loss decreased (-0.793312 --> -0.876652).  Saving model ...
Epoch: 5 cost time: 4.616571426391602
Epoch: 5, Steps: 18 | Train Loss: 1.140 Vali Loss: 1.005 Vali Acc: 0.900 Test Loss: 1.005 Test Acc: 0.900
Validation loss decreased (-0.876652 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 4.459835052490234
Epoch: 6, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.625 Vali Acc: 0.923 Test Loss: 0.625 Test Acc: 0.923
Validation loss decreased (-0.899990 --> -0.923327).  Saving model ...
Epoch: 7 cost time: 4.80523157119751
Epoch: 7, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.404 Vali Acc: 0.953 Test Loss: 0.404 Test Acc: 0.953
Validation loss decreased (-0.923327 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 4.666148662567139
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.307 Vali Acc: 0.953 Test Loss: 0.307 Test Acc: 0.953
Validation loss decreased (-0.953329 --> -0.953330).  Saving model ...
Epoch: 9 cost time: 4.436373949050903
Epoch: 9, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.247 Vali Acc: 0.963 Test Loss: 0.247 Test Acc: 0.963
Validation loss decreased (-0.953330 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 4.66259241104126
Epoch: 10, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 4.567267894744873
Epoch: 11, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.354328393936157
Epoch: 12, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 4.69148063659668
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.608534097671509
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 4.530872106552124
Epoch: 15, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 4.592245101928711
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 4.694333553314209
Epoch: 17, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 4.846518516540527
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 4.871906280517578
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 4.695262670516968
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 4.8278489112854
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 4.733574390411377
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 4.552869558334351
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 4.771605014801025
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.654239892959595
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.643709182739258
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 4.688947677612305
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.579902172088623
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.480400562286377
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.828928709030151
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 937609
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.974008321762085
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.973 Vali Acc: 0.163 Test Loss: 2.973 Test Acc: 0.163
Validation loss decreased (inf --> -0.163304).  Saving model ...
Epoch: 2 cost time: 3.6334519386291504
Epoch: 2, Steps: 18 | Train Loss: 2.777 Vali Loss: 2.450 Vali Acc: 0.597 Test Loss: 2.450 Test Acc: 0.597
Validation loss decreased (-0.163304 --> -0.596642).  Saving model ...
Epoch: 3 cost time: 3.5840582847595215
Epoch: 3, Steps: 18 | Train Loss: 2.161 Vali Loss: 1.854 Vali Acc: 0.843 Test Loss: 1.854 Test Acc: 0.843
Validation loss decreased (-0.596642 --> -0.843315).  Saving model ...
Epoch: 4 cost time: 3.4482641220092773
Epoch: 4, Steps: 18 | Train Loss: 1.531 Vali Loss: 1.289 Vali Acc: 0.907 Test Loss: 1.289 Test Acc: 0.907
Validation loss decreased (-0.843315 --> -0.906654).  Saving model ...
Epoch: 5 cost time: 3.5772504806518555
Epoch: 5, Steps: 18 | Train Loss: 0.970 Vali Loss: 0.834 Vali Acc: 0.937 Test Loss: 0.834 Test Acc: 0.937
Validation loss decreased (-0.906654 --> -0.936658).  Saving model ...
Epoch: 6 cost time: 3.5782785415649414
Epoch: 6, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.532 Vali Acc: 0.940 Test Loss: 0.532 Test Acc: 0.940
Validation loss decreased (-0.936658 --> -0.939995).  Saving model ...
Epoch: 7 cost time: 3.605560064315796
Epoch: 7, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.377 Vali Acc: 0.953 Test Loss: 0.377 Test Acc: 0.953
Validation loss decreased (-0.939995 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 3.6715283393859863
Epoch: 8, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.290 Vali Acc: 0.957 Test Loss: 0.290 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 9 cost time: 3.6277096271514893
Epoch: 9, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.248 Vali Acc: 0.960 Test Loss: 0.248 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 3.3581130504608154
Epoch: 10, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 3.5399956703186035
Epoch: 11, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5043044090270996
Epoch: 12, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 13 cost time: 3.3353641033172607
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4172520637512207
Epoch: 14, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 3.5281808376312256
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 3.619931936264038
Epoch: 16, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 3.421135425567627
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.564368486404419
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 19 cost time: 3.630629301071167
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 20 cost time: 3.4500112533569336
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 21 cost time: 3.197467565536499
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 22 cost time: 3.497812509536743
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 23 cost time: 3.501512050628662
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 24 cost time: 3.3310320377349854
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 3.5201258659362793
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 26 cost time: 3.3778488636016846
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 27 cost time: 3.3630833625793457
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 3.305588483810425
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 3.513523817062378
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3367056846618652
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 316777
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.255947113037109
Epoch: 1, Steps: 18 | Train Loss: 3.272 Vali Loss: 3.103 Vali Acc: 0.070 Test Loss: 3.103 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 3.6920485496520996
Epoch: 2, Steps: 18 | Train Loss: 2.896 Vali Loss: 2.636 Vali Acc: 0.487 Test Loss: 2.636 Test Acc: 0.487
Validation loss decreased (-0.069969 --> -0.486640).  Saving model ...
Epoch: 3 cost time: 3.548032760620117
Epoch: 3, Steps: 18 | Train Loss: 2.348 Vali Loss: 2.091 Vali Acc: 0.790 Test Loss: 2.091 Test Acc: 0.790
Validation loss decreased (-0.486640 --> -0.789979).  Saving model ...
Epoch: 4 cost time: 3.8535118103027344
Epoch: 4, Steps: 18 | Train Loss: 1.764 Vali Loss: 1.521 Vali Acc: 0.873 Test Loss: 1.521 Test Acc: 0.873
Validation loss decreased (-0.789979 --> -0.873318).  Saving model ...
Epoch: 5 cost time: 3.6082613468170166
Epoch: 5, Steps: 18 | Train Loss: 1.148 Vali Loss: 1.009 Vali Acc: 0.900 Test Loss: 1.009 Test Acc: 0.900
Validation loss decreased (-0.873318 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 3.5943353176116943
Epoch: 6, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.626 Vali Acc: 0.923 Test Loss: 0.626 Test Acc: 0.923
Validation loss decreased (-0.899990 --> -0.923327).  Saving model ...
Epoch: 7 cost time: 3.7467141151428223
Epoch: 7, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.402 Vali Acc: 0.953 Test Loss: 0.402 Test Acc: 0.953
Validation loss decreased (-0.923327 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 3.749999761581421
Epoch: 8, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.305 Vali Acc: 0.957 Test Loss: 0.305 Test Acc: 0.957
Validation loss decreased (-0.953329 --> -0.956664).  Saving model ...
Epoch: 9 cost time: 3.809508800506592
Epoch: 9, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.246 Vali Acc: 0.960 Test Loss: 0.246 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 3.585038423538208
Epoch: 10, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 3.7010583877563477
Epoch: 11, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 3.5524404048919678
Epoch: 12, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 3.5724830627441406
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.031769037246704
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 2.6742265224456787
Epoch: 15, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4659602642059326
Epoch: 16, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 3.260645627975464
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5188162326812744
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1069464683532715
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3334121704101562
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 3.5292019844055176
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.298841953277588
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.532153606414795
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.373478889465332
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.335083246231079
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6075191497802734
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.3595333099365234
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 3.422044515609741
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4693009853363037
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.29184889793396
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 937609
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.273272752761841
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.973 Vali Acc: 0.163 Test Loss: 2.973 Test Acc: 0.163
Validation loss decreased (inf --> -0.163304).  Saving model ...
Epoch: 2 cost time: 2.398498058319092
Epoch: 2, Steps: 18 | Train Loss: 2.777 Vali Loss: 2.450 Vali Acc: 0.597 Test Loss: 2.450 Test Acc: 0.597
Validation loss decreased (-0.163304 --> -0.596642).  Saving model ...
Epoch: 3 cost time: 2.4895310401916504
Epoch: 3, Steps: 18 | Train Loss: 2.161 Vali Loss: 1.854 Vali Acc: 0.843 Test Loss: 1.854 Test Acc: 0.843
Validation loss decreased (-0.596642 --> -0.843315).  Saving model ...
Epoch: 4 cost time: 2.566603183746338
Epoch: 4, Steps: 18 | Train Loss: 1.531 Vali Loss: 1.288 Vali Acc: 0.907 Test Loss: 1.288 Test Acc: 0.907
Validation loss decreased (-0.843315 --> -0.906654).  Saving model ...
Epoch: 5 cost time: 2.602475166320801
Epoch: 5, Steps: 18 | Train Loss: 0.970 Vali Loss: 0.833 Vali Acc: 0.937 Test Loss: 0.833 Test Acc: 0.937
Validation loss decreased (-0.906654 --> -0.936658).  Saving model ...
Epoch: 6 cost time: 2.487637758255005
Epoch: 6, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.531 Vali Acc: 0.940 Test Loss: 0.531 Test Acc: 0.940
Validation loss decreased (-0.936658 --> -0.939995).  Saving model ...
Epoch: 7 cost time: 2.5515520572662354
Epoch: 7, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.377 Vali Acc: 0.953 Test Loss: 0.377 Test Acc: 0.953
Validation loss decreased (-0.939995 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 1.7764060497283936
Epoch: 8, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.290 Vali Acc: 0.960 Test Loss: 0.290 Test Acc: 0.960
Validation loss decreased (-0.953330 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 1.9215025901794434
Epoch: 9, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.248 Vali Acc: 0.960 Test Loss: 0.248 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 2.125828504562378
Epoch: 10, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 2.5947978496551514
Epoch: 11, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5621001720428467
Epoch: 12, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 2.5442378520965576
Epoch: 13, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5245425701141357
Epoch: 14, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 2.57930064201355
Epoch: 15, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 2.5473642349243164
Epoch: 16, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 17 cost time: 2.571390390396118
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4549694061279297
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.466926336288452
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2623140811920166
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 2.376978635787964
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.339951992034912
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2030465602874756
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 2.4319968223571777
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 2.312700033187866
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 2.5077693462371826
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 2.5085513591766357
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 28 cost time: 2.6322903633117676
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.58634352684021
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.033965587615967
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 316777
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.3732359409332275
Epoch: 1, Steps: 18 | Train Loss: 3.220 Vali Loss: 3.046 Vali Acc: 0.090 Test Loss: 3.046 Test Acc: 0.090
Validation loss decreased (inf --> -0.089970).  Saving model ...
Epoch: 2 cost time: 4.575415372848511
Epoch: 2, Steps: 18 | Train Loss: 2.826 Vali Loss: 2.565 Vali Acc: 0.507 Test Loss: 2.565 Test Acc: 0.507
Validation loss decreased (-0.089970 --> -0.506641).  Saving model ...
Epoch: 3 cost time: 4.842087507247925
Epoch: 3, Steps: 18 | Train Loss: 2.273 Vali Loss: 2.015 Vali Acc: 0.767 Test Loss: 2.015 Test Acc: 0.767
Validation loss decreased (-0.506641 --> -0.766647).  Saving model ...
Epoch: 4 cost time: 4.900497674942017
Epoch: 4, Steps: 18 | Train Loss: 1.711 Vali Loss: 1.465 Vali Acc: 0.870 Test Loss: 1.465 Test Acc: 0.870
Validation loss decreased (-0.766647 --> -0.869985).  Saving model ...
Epoch: 5 cost time: 4.250847816467285
Epoch: 5, Steps: 18 | Train Loss: 1.120 Vali Loss: 1.003 Vali Acc: 0.900 Test Loss: 1.003 Test Acc: 0.900
Validation loss decreased (-0.869985 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 3.5200679302215576
Epoch: 6, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.652 Vali Acc: 0.937 Test Loss: 0.652 Test Acc: 0.937
Validation loss decreased (-0.899990 --> -0.936660).  Saving model ...
Epoch: 7 cost time: 4.381739377975464
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.437 Vali Acc: 0.953 Test Loss: 0.437 Test Acc: 0.953
Validation loss decreased (-0.936660 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 5.060340404510498
Epoch: 8, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.321 Vali Acc: 0.970 Test Loss: 0.321 Test Acc: 0.970
Validation loss decreased (-0.953329 --> -0.969997).  Saving model ...
Epoch: 9 cost time: 4.80666446685791
Epoch: 9, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.260 Vali Acc: 0.973 Test Loss: 0.260 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 5.139452219009399
Epoch: 10, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.227 Vali Acc: 0.960 Test Loss: 0.227 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.8922505378723145
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.189 Vali Acc: 0.977 Test Loss: 0.189 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 5.191773176193237
Epoch: 12, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 4.596300840377808
Epoch: 13, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.88484525680542
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.652401924133301
Epoch: 15, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.649134159088135
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.694020986557007
Epoch: 17, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.835023403167725
Epoch: 18, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.93693995475769
Epoch: 19, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.712628364562988
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 5.004715442657471
Epoch: 21, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.740286111831665
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 4.953304767608643
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.5276384353637695
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.853713750839233
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.657664060592651
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.703523635864258
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.679480075836182
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.738516569137573
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.22594952583313
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 498025
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.612162828445435
Epoch: 1, Steps: 18 | Train Loss: 3.176 Vali Loss: 2.997 Vali Acc: 0.100 Test Loss: 2.997 Test Acc: 0.100
Validation loss decreased (inf --> -0.099970).  Saving model ...
Epoch: 2 cost time: 3.632218837738037
Epoch: 2, Steps: 18 | Train Loss: 2.774 Vali Loss: 2.482 Vali Acc: 0.560 Test Loss: 2.482 Test Acc: 0.560
Validation loss decreased (-0.099970 --> -0.559975).  Saving model ...
Epoch: 3 cost time: 3.632755756378174
Epoch: 3, Steps: 18 | Train Loss: 2.196 Vali Loss: 1.900 Vali Acc: 0.803 Test Loss: 1.900 Test Acc: 0.803
Validation loss decreased (-0.559975 --> -0.803314).  Saving model ...
Epoch: 4 cost time: 3.3007874488830566
Epoch: 4, Steps: 18 | Train Loss: 1.569 Vali Loss: 1.354 Vali Acc: 0.907 Test Loss: 1.354 Test Acc: 0.907
Validation loss decreased (-0.803314 --> -0.906653).  Saving model ...
Epoch: 5 cost time: 3.152019500732422
Epoch: 5, Steps: 18 | Train Loss: 1.029 Vali Loss: 0.903 Vali Acc: 0.937 Test Loss: 0.903 Test Acc: 0.937
Validation loss decreased (-0.906653 --> -0.936658).  Saving model ...
Epoch: 6 cost time: 3.4605021476745605
Epoch: 6, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.936658 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 3.299668788909912
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.406 Vali Acc: 0.963 Test Loss: 0.406 Test Acc: 0.963
Validation loss decreased (-0.949994 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 3.451774835586548
Epoch: 8, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.310 Vali Acc: 0.963 Test Loss: 0.310 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 3.513679027557373
Epoch: 9, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 3.517897367477417
Epoch: 10, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.721679210662842
Epoch: 11, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 3.723315954208374
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5843400955200195
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 3.6911845207214355
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.977 Test Loss: 0.170 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 3.59297776222229
Epoch: 15, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 3.534065008163452
Epoch: 16, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4518232345581055
Epoch: 17, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.103874683380127
Epoch: 18, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2637314796447754
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 3.266543388366699
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 3.204646348953247
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2324635982513428
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2821388244628906
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2964258193969727
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.5877249240875244
Epoch: 25, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.4343626499176025
Epoch: 26, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.6637120246887207
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 3.6019511222839355
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4436120986938477
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 3.6059489250183105
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 187561
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.485586166381836
Epoch: 1, Steps: 18 | Train Loss: 3.220 Vali Loss: 3.046 Vali Acc: 0.090 Test Loss: 3.046 Test Acc: 0.090
Validation loss decreased (inf --> -0.089970).  Saving model ...
Epoch: 2 cost time: 3.5565667152404785
Epoch: 2, Steps: 18 | Train Loss: 2.826 Vali Loss: 2.565 Vali Acc: 0.507 Test Loss: 2.565 Test Acc: 0.507
Validation loss decreased (-0.089970 --> -0.506641).  Saving model ...
Epoch: 3 cost time: 3.8648667335510254
Epoch: 3, Steps: 18 | Train Loss: 2.273 Vali Loss: 2.015 Vali Acc: 0.767 Test Loss: 2.015 Test Acc: 0.767
Validation loss decreased (-0.506641 --> -0.766647).  Saving model ...
Epoch: 4 cost time: 3.838557004928589
Epoch: 4, Steps: 18 | Train Loss: 1.711 Vali Loss: 1.465 Vali Acc: 0.870 Test Loss: 1.465 Test Acc: 0.870
Validation loss decreased (-0.766647 --> -0.869985).  Saving model ...
Epoch: 5 cost time: 3.622541904449463
Epoch: 5, Steps: 18 | Train Loss: 1.120 Vali Loss: 1.003 Vali Acc: 0.900 Test Loss: 1.003 Test Acc: 0.900
Validation loss decreased (-0.869985 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 4.1888463497161865
Epoch: 6, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.652 Vali Acc: 0.937 Test Loss: 0.652 Test Acc: 0.937
Validation loss decreased (-0.899990 --> -0.936660).  Saving model ...
Epoch: 7 cost time: 3.9701478481292725
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.437 Vali Acc: 0.953 Test Loss: 0.437 Test Acc: 0.953
Validation loss decreased (-0.936660 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 3.8982791900634766
Epoch: 8, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.321 Vali Acc: 0.970 Test Loss: 0.321 Test Acc: 0.970
Validation loss decreased (-0.953329 --> -0.969997).  Saving model ...
Epoch: 9 cost time: 4.110530376434326
Epoch: 9, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.260 Vali Acc: 0.973 Test Loss: 0.260 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 4.071737051010132
Epoch: 10, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.227 Vali Acc: 0.960 Test Loss: 0.227 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.119187116622925
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.189 Vali Acc: 0.977 Test Loss: 0.189 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 4.129345655441284
Epoch: 12, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 3.779853343963623
Epoch: 13, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8500561714172363
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.7926077842712402
Epoch: 15, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 3.7236826419830322
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9281904697418213
Epoch: 17, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.726628541946411
Epoch: 18, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.752382278442383
Epoch: 19, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.078606605529785
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.8224241733551025
Epoch: 21, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.6158089637756348
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 3.5463271141052246
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6896114349365234
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.867424488067627
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.617061138153076
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.414417266845703
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.471198320388794
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.480344295501709
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7340476512908936
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 498025
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.443711757659912
Epoch: 1, Steps: 18 | Train Loss: 3.176 Vali Loss: 2.997 Vali Acc: 0.100 Test Loss: 2.997 Test Acc: 0.100
Validation loss decreased (inf --> -0.099970).  Saving model ...
Epoch: 2 cost time: 2.909660577774048
Epoch: 2, Steps: 18 | Train Loss: 2.774 Vali Loss: 2.482 Vali Acc: 0.560 Test Loss: 2.482 Test Acc: 0.560
Validation loss decreased (-0.099970 --> -0.559975).  Saving model ...
Epoch: 3 cost time: 2.7085206508636475
Epoch: 3, Steps: 18 | Train Loss: 2.196 Vali Loss: 1.900 Vali Acc: 0.803 Test Loss: 1.900 Test Acc: 0.803
Validation loss decreased (-0.559975 --> -0.803314).  Saving model ...
Epoch: 4 cost time: 2.931609630584717
Epoch: 4, Steps: 18 | Train Loss: 1.569 Vali Loss: 1.354 Vali Acc: 0.907 Test Loss: 1.354 Test Acc: 0.907
Validation loss decreased (-0.803314 --> -0.906653).  Saving model ...
Epoch: 5 cost time: 2.676579475402832
Epoch: 5, Steps: 18 | Train Loss: 1.029 Vali Loss: 0.903 Vali Acc: 0.937 Test Loss: 0.903 Test Acc: 0.937
Validation loss decreased (-0.906653 --> -0.936658).  Saving model ...
Epoch: 6 cost time: 2.7228217124938965
Epoch: 6, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.936658 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 2.952502965927124
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.406 Vali Acc: 0.963 Test Loss: 0.406 Test Acc: 0.963
Validation loss decreased (-0.949994 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 2.695887804031372
Epoch: 8, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.310 Vali Acc: 0.963 Test Loss: 0.310 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 2.7323522567749023
Epoch: 9, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 2.765211820602417
Epoch: 10, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.616119146347046
Epoch: 11, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.8030459880828857
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6628830432891846
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 2.874466896057129
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.977 Test Loss: 0.170 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 2.8992652893066406
Epoch: 15, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 2.8881638050079346
Epoch: 16, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.014775037765503
Epoch: 17, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.850837469100952
Epoch: 18, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.8301422595977783
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 3.0676968097686768
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 2.844883441925049
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0019757747650146
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9634058475494385
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7997684478759766
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.8544504642486572
Epoch: 25, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5812458992004395
Epoch: 26, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.6958506107330322
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 2.780123233795166
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5763285160064697
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 2.557748794555664
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 187561
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.770007610321045
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 3.045 Vali Acc: 0.090 Test Loss: 3.045 Test Acc: 0.090
Validation loss decreased (inf --> -0.089970).  Saving model ...
Epoch: 2 cost time: 2.3936500549316406
Epoch: 2, Steps: 18 | Train Loss: 2.827 Vali Loss: 2.565 Vali Acc: 0.500 Test Loss: 2.565 Test Acc: 0.500
Validation loss decreased (-0.089970 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 2.3917288780212402
Epoch: 3, Steps: 18 | Train Loss: 2.275 Vali Loss: 2.016 Vali Acc: 0.760 Test Loss: 2.016 Test Acc: 0.760
Validation loss decreased (-0.499974 --> -0.759980).  Saving model ...
Epoch: 4 cost time: 3.0441455841064453
Epoch: 4, Steps: 18 | Train Loss: 1.714 Vali Loss: 1.466 Vali Acc: 0.867 Test Loss: 1.466 Test Acc: 0.867
Validation loss decreased (-0.759980 --> -0.866652).  Saving model ...
Epoch: 5 cost time: 3.086181879043579
Epoch: 5, Steps: 18 | Train Loss: 1.124 Vali Loss: 1.005 Vali Acc: 0.900 Test Loss: 1.005 Test Acc: 0.900
Validation loss decreased (-0.866652 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 3.790327787399292
Epoch: 6, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.654 Vali Acc: 0.937 Test Loss: 0.654 Test Acc: 0.937
Validation loss decreased (-0.899990 --> -0.936660).  Saving model ...
Epoch: 7 cost time: 3.5279338359832764
Epoch: 7, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.936660 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 3.6119799613952637
Epoch: 8, Steps: 18 | Train Loss: 0.248 Vali Loss: 0.322 Vali Acc: 0.967 Test Loss: 0.322 Test Acc: 0.967
Validation loss decreased (-0.949996 --> -0.966663).  Saving model ...
Epoch: 9 cost time: 3.2796742916107178
Epoch: 9, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.260 Vali Acc: 0.973 Test Loss: 0.260 Test Acc: 0.973
Validation loss decreased (-0.966663 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 3.595231533050537
Epoch: 10, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.376312255859375
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 3.503636360168457
Epoch: 12, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 3.6766231060028076
Epoch: 13, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4287590980529785
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 3.8746726512908936
Epoch: 15, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 3.7993297576904297
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.03336501121521
Epoch: 17, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8061976432800293
Epoch: 18, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.022106647491455
Epoch: 19, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.776934862136841
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.9583628177642822
Epoch: 21, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 3.5571181774139404
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.7253670692443848
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.741018056869507
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.5477349758148193
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7135701179504395
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.417044162750244
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.674469232559204
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.603914260864258
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.8847835063934326
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 498025
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.3631627559661865
Epoch: 1, Steps: 18 | Train Loss: 3.177 Vali Loss: 2.997 Vali Acc: 0.100 Test Loss: 2.997 Test Acc: 0.100
Validation loss decreased (inf --> -0.099970).  Saving model ...
Epoch: 2 cost time: 2.9441020488739014
Epoch: 2, Steps: 18 | Train Loss: 2.775 Vali Loss: 2.482 Vali Acc: 0.557 Test Loss: 2.482 Test Acc: 0.557
Validation loss decreased (-0.099970 --> -0.556642).  Saving model ...
Epoch: 3 cost time: 2.8332931995391846
Epoch: 3, Steps: 18 | Train Loss: 2.197 Vali Loss: 1.900 Vali Acc: 0.803 Test Loss: 1.900 Test Acc: 0.803
Validation loss decreased (-0.556642 --> -0.803314).  Saving model ...
Epoch: 4 cost time: 2.8367414474487305
Epoch: 4, Steps: 18 | Train Loss: 1.570 Vali Loss: 1.355 Vali Acc: 0.907 Test Loss: 1.355 Test Acc: 0.907
Validation loss decreased (-0.803314 --> -0.906653).  Saving model ...
Epoch: 5 cost time: 3.0343146324157715
Epoch: 5, Steps: 18 | Train Loss: 1.030 Vali Loss: 0.903 Vali Acc: 0.940 Test Loss: 0.903 Test Acc: 0.940
Validation loss decreased (-0.906653 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 2.5992136001586914
Epoch: 6, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.939991 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 2.7894272804260254
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.406 Vali Acc: 0.963 Test Loss: 0.406 Test Acc: 0.963
Validation loss decreased (-0.949994 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 2.5960137844085693
Epoch: 8, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.310 Vali Acc: 0.963 Test Loss: 0.310 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 2.767150402069092
Epoch: 9, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.257 Vali Acc: 0.967 Test Loss: 0.257 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 2.6218066215515137
Epoch: 10, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.225 Vali Acc: 0.967 Test Loss: 0.225 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 11 cost time: 2.8173470497131348
Epoch: 11, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.534555435180664
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.787167549133301
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 2.8715944290161133
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.977 Test Loss: 0.170 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 2.8472635746002197
Epoch: 15, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8712270259857178
Epoch: 16, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.654143810272217
Epoch: 17, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8883674144744873
Epoch: 18, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7996437549591064
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 2.8974380493164062
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 2.764124870300293
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.959329128265381
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.703023672103882
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 2.8307509422302246
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.766850471496582
Epoch: 25, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 2.6155827045440674
Epoch: 26, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4290106296539307
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 2.601112127304077
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7979443073272705
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 2.584667682647705
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 187561
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.733286142349243
Epoch: 1, Steps: 18 | Train Loss: 3.340 Vali Loss: 3.241 Vali Acc: 0.030 Test Loss: 3.241 Test Acc: 0.030
Validation loss decreased (inf --> -0.029968).  Saving model ...
Epoch: 2 cost time: 5.975357294082642
Epoch: 2, Steps: 18 | Train Loss: 3.111 Vali Loss: 2.958 Vali Acc: 0.190 Test Loss: 2.958 Test Acc: 0.190
Validation loss decreased (-0.029968 --> -0.189970).  Saving model ...
Epoch: 3 cost time: 6.826504945755005
Epoch: 3, Steps: 18 | Train Loss: 2.778 Vali Loss: 2.613 Vali Acc: 0.453 Test Loss: 2.613 Test Acc: 0.453
Validation loss decreased (-0.189970 --> -0.453307).  Saving model ...
Epoch: 4 cost time: 6.502406358718872
Epoch: 4, Steps: 18 | Train Loss: 2.446 Vali Loss: 2.237 Vali Acc: 0.673 Test Loss: 2.237 Test Acc: 0.673
Validation loss decreased (-0.453307 --> -0.673311).  Saving model ...
Epoch: 5 cost time: 6.390092611312866
Epoch: 5, Steps: 18 | Train Loss: 1.993 Vali Loss: 1.860 Vali Acc: 0.777 Test Loss: 1.860 Test Acc: 0.777
Validation loss decreased (-0.673311 --> -0.776648).  Saving model ...
Epoch: 6 cost time: 6.469482660293579
Epoch: 6, Steps: 18 | Train Loss: 1.611 Vali Loss: 1.498 Vali Acc: 0.850 Test Loss: 1.498 Test Acc: 0.850
Validation loss decreased (-0.776648 --> -0.849985).  Saving model ...
Epoch: 7 cost time: 6.597602605819702
Epoch: 7, Steps: 18 | Train Loss: 1.242 Vali Loss: 1.178 Vali Acc: 0.873 Test Loss: 1.178 Test Acc: 0.873
Validation loss decreased (-0.849985 --> -0.873322).  Saving model ...
Epoch: 8 cost time: 6.687374114990234
Epoch: 8, Steps: 18 | Train Loss: 0.898 Vali Loss: 0.928 Vali Acc: 0.893 Test Loss: 0.928 Test Acc: 0.893
Validation loss decreased (-0.873322 --> -0.893324).  Saving model ...
Epoch: 9 cost time: 6.4706456661224365
Epoch: 9, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.741 Vali Acc: 0.910 Test Loss: 0.741 Test Acc: 0.910
Validation loss decreased (-0.893324 --> -0.909993).  Saving model ...
Epoch: 10 cost time: 6.856014013290405
Epoch: 10, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.620 Vali Acc: 0.910 Test Loss: 0.620 Test Acc: 0.910
Validation loss decreased (-0.909993 --> -0.909994).  Saving model ...
Epoch: 11 cost time: 6.6764609813690186
Epoch: 11, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.526 Vali Acc: 0.927 Test Loss: 0.526 Test Acc: 0.927
Validation loss decreased (-0.909994 --> -0.926661).  Saving model ...
Epoch: 12 cost time: 6.805437803268433
Epoch: 12, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.460 Vali Acc: 0.923 Test Loss: 0.460 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.542520523071289
Epoch: 13, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
Validation loss decreased (-0.926661 --> -0.933329).  Saving model ...
Epoch: 14 cost time: 6.464884281158447
Epoch: 14, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.387 Vali Acc: 0.930 Test Loss: 0.387 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.712318181991577
Epoch: 15, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.980597972869873
Epoch: 16, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.414549827575684
Epoch: 17, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.177460670471191
Epoch: 18, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.633995771408081
Epoch: 19, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.925609111785889
Epoch: 20, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 6.016436338424683
Epoch: 21, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.936664).  Saving model ...
Epoch: 22 cost time: 6.356459617614746
Epoch: 22, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 23 cost time: 6.249774694442749
Epoch: 23, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 24 cost time: 5.103397846221924
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.900249242782593
Epoch: 25, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.41466212272644
Epoch: 26, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.037692070007324
Epoch: 27, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.539488792419434
Epoch: 28, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 29 cost time: 7.014524221420288
Epoch: 29, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 30 cost time: 6.8441267013549805
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
Validation loss decreased (-0.936664 --> -0.943331).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9433333333333334
model parameter : 908977
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.646140813827515
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 3.124 Vali Acc: 0.070 Test Loss: 3.124 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 4.690664291381836
Epoch: 2, Steps: 18 | Train Loss: 3.024 Vali Loss: 2.844 Vali Acc: 0.273 Test Loss: 2.844 Test Acc: 0.273
Validation loss decreased (-0.069969 --> -0.273305).  Saving model ...
Epoch: 3 cost time: 4.824091196060181
Epoch: 3, Steps: 18 | Train Loss: 2.699 Vali Loss: 2.485 Vali Acc: 0.523 Test Loss: 2.485 Test Acc: 0.523
Validation loss decreased (-0.273305 --> -0.523308).  Saving model ...
Epoch: 4 cost time: 4.876088857650757
Epoch: 4, Steps: 18 | Train Loss: 2.305 Vali Loss: 2.076 Vali Acc: 0.743 Test Loss: 2.076 Test Acc: 0.743
Validation loss decreased (-0.523308 --> -0.743313).  Saving model ...
Epoch: 5 cost time: 4.615115165710449
Epoch: 5, Steps: 18 | Train Loss: 1.878 Vali Loss: 1.663 Vali Acc: 0.843 Test Loss: 1.663 Test Acc: 0.843
Validation loss decreased (-0.743313 --> -0.843317).  Saving model ...
Epoch: 6 cost time: 4.700850009918213
Epoch: 6, Steps: 18 | Train Loss: 1.471 Vali Loss: 1.283 Vali Acc: 0.883 Test Loss: 1.283 Test Acc: 0.883
Validation loss decreased (-0.843317 --> -0.883321).  Saving model ...
Epoch: 7 cost time: 4.436387777328491
Epoch: 7, Steps: 18 | Train Loss: 1.072 Vali Loss: 0.961 Vali Acc: 0.907 Test Loss: 0.961 Test Acc: 0.907
Validation loss decreased (-0.883321 --> -0.906657).  Saving model ...
Epoch: 8 cost time: 4.581716775894165
Epoch: 8, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.726 Vali Acc: 0.950 Test Loss: 0.726 Test Acc: 0.950
Validation loss decreased (-0.906657 --> -0.949993).  Saving model ...
Epoch: 9 cost time: 4.355082273483276
Epoch: 9, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.565 Vali Acc: 0.960 Test Loss: 0.565 Test Acc: 0.960
Validation loss decreased (-0.949993 --> -0.959994).  Saving model ...
Epoch: 10 cost time: 4.59205961227417
Epoch: 10, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.468 Vali Acc: 0.953 Test Loss: 0.468 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.185449838638306
Epoch: 11, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.406 Vali Acc: 0.953 Test Loss: 0.406 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.954326868057251
Epoch: 12, Steps: 18 | Train Loss: 0.264 Vali Loss: 0.342 Vali Acc: 0.957 Test Loss: 0.342 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.381375789642334
Epoch: 13, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.310 Vali Acc: 0.960 Test Loss: 0.310 Test Acc: 0.960
Validation loss decreased (-0.959994 --> -0.959997).  Saving model ...
Epoch: 14 cost time: 4.2602715492248535
Epoch: 14, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959997).  Saving model ...
Epoch: 15 cost time: 4.439132928848267
Epoch: 15, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.256 Vali Acc: 0.963 Test Loss: 0.256 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 16 cost time: 4.184558629989624
Epoch: 16, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 17 cost time: 4.462714195251465
Epoch: 17, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.203466176986694
Epoch: 18, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.457216024398804
Epoch: 19, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 20 cost time: 4.0443949699401855
Epoch: 20, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9394524097442627
Epoch: 21, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 22 cost time: 4.424329996109009
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.224866151809692
Epoch: 23, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.3782799243927
Epoch: 24, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 25 cost time: 4.3813581466674805
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 26 cost time: 4.840016603469849
Epoch: 26, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.596894264221191
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 28 cost time: 4.9121551513671875
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 4.813042402267456
Epoch: 29, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.6847522258758545
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 288001
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.691190004348755
Epoch: 1, Steps: 18 | Train Loss: 3.340 Vali Loss: 3.241 Vali Acc: 0.030 Test Loss: 3.241 Test Acc: 0.030
Validation loss decreased (inf --> -0.029968).  Saving model ...
Epoch: 2 cost time: 5.726329326629639
Epoch: 2, Steps: 18 | Train Loss: 3.111 Vali Loss: 2.958 Vali Acc: 0.190 Test Loss: 2.958 Test Acc: 0.190
Validation loss decreased (-0.029968 --> -0.189970).  Saving model ...
Epoch: 3 cost time: 5.775866508483887
Epoch: 3, Steps: 18 | Train Loss: 2.778 Vali Loss: 2.613 Vali Acc: 0.453 Test Loss: 2.613 Test Acc: 0.453
Validation loss decreased (-0.189970 --> -0.453307).  Saving model ...
Epoch: 4 cost time: 5.574097633361816
Epoch: 4, Steps: 18 | Train Loss: 2.446 Vali Loss: 2.237 Vali Acc: 0.673 Test Loss: 2.237 Test Acc: 0.673
Validation loss decreased (-0.453307 --> -0.673311).  Saving model ...
Epoch: 5 cost time: 5.7961554527282715
Epoch: 5, Steps: 18 | Train Loss: 1.993 Vali Loss: 1.860 Vali Acc: 0.777 Test Loss: 1.860 Test Acc: 0.777
Validation loss decreased (-0.673311 --> -0.776648).  Saving model ...
Epoch: 6 cost time: 5.772027492523193
Epoch: 6, Steps: 18 | Train Loss: 1.611 Vali Loss: 1.498 Vali Acc: 0.850 Test Loss: 1.498 Test Acc: 0.850
Validation loss decreased (-0.776648 --> -0.849985).  Saving model ...
Epoch: 7 cost time: 5.892507314682007
Epoch: 7, Steps: 18 | Train Loss: 1.242 Vali Loss: 1.178 Vali Acc: 0.873 Test Loss: 1.178 Test Acc: 0.873
Validation loss decreased (-0.849985 --> -0.873322).  Saving model ...
Epoch: 8 cost time: 5.6859660148620605
Epoch: 8, Steps: 18 | Train Loss: 0.898 Vali Loss: 0.928 Vali Acc: 0.893 Test Loss: 0.928 Test Acc: 0.893
Validation loss decreased (-0.873322 --> -0.893324).  Saving model ...
Epoch: 9 cost time: 5.849010705947876
Epoch: 9, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.741 Vali Acc: 0.910 Test Loss: 0.741 Test Acc: 0.910
Validation loss decreased (-0.893324 --> -0.909993).  Saving model ...
Epoch: 10 cost time: 5.759874105453491
Epoch: 10, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.620 Vali Acc: 0.910 Test Loss: 0.620 Test Acc: 0.910
Validation loss decreased (-0.909993 --> -0.909994).  Saving model ...
Epoch: 11 cost time: 5.751311540603638
Epoch: 11, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.526 Vali Acc: 0.927 Test Loss: 0.526 Test Acc: 0.927
Validation loss decreased (-0.909994 --> -0.926661).  Saving model ...
Epoch: 12 cost time: 5.5348734855651855
Epoch: 12, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.460 Vali Acc: 0.923 Test Loss: 0.460 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.503247022628784
Epoch: 13, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
Validation loss decreased (-0.926661 --> -0.933329).  Saving model ...
Epoch: 14 cost time: 5.149445056915283
Epoch: 14, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.387 Vali Acc: 0.930 Test Loss: 0.387 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.204103469848633
Epoch: 15, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.066487073898315
Epoch: 16, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.544737100601196
Epoch: 17, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.3765904903411865
Epoch: 18, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.6558473110198975
Epoch: 19, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.663479328155518
Epoch: 20, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 5.654086351394653
Epoch: 21, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.936664).  Saving model ...
Epoch: 22 cost time: 5.691192865371704
Epoch: 22, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 23 cost time: 5.607844352722168
Epoch: 23, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 24 cost time: 5.6025731563568115
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.170475006103516
Epoch: 25, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.269172191619873
Epoch: 26, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.454272031784058
Epoch: 27, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.65031361579895
Epoch: 28, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 29 cost time: 5.76226544380188
Epoch: 29, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
Epoch: 30 cost time: 5.813257694244385
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
Validation loss decreased (-0.936664 --> -0.943331).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9433333333333334
model parameter : 908977
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.4844560623168945
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 3.124 Vali Acc: 0.070 Test Loss: 3.124 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 3.730989694595337
Epoch: 2, Steps: 18 | Train Loss: 3.024 Vali Loss: 2.844 Vali Acc: 0.273 Test Loss: 2.844 Test Acc: 0.273
Validation loss decreased (-0.069969 --> -0.273305).  Saving model ...
Epoch: 3 cost time: 3.5079777240753174
Epoch: 3, Steps: 18 | Train Loss: 2.699 Vali Loss: 2.485 Vali Acc: 0.523 Test Loss: 2.485 Test Acc: 0.523
Validation loss decreased (-0.273305 --> -0.523308).  Saving model ...
Epoch: 4 cost time: 3.4114789962768555
Epoch: 4, Steps: 18 | Train Loss: 2.305 Vali Loss: 2.076 Vali Acc: 0.743 Test Loss: 2.076 Test Acc: 0.743
Validation loss decreased (-0.523308 --> -0.743313).  Saving model ...
Epoch: 5 cost time: 3.698622941970825
Epoch: 5, Steps: 18 | Train Loss: 1.878 Vali Loss: 1.663 Vali Acc: 0.843 Test Loss: 1.663 Test Acc: 0.843
Validation loss decreased (-0.743313 --> -0.843317).  Saving model ...
Epoch: 6 cost time: 3.4160842895507812
Epoch: 6, Steps: 18 | Train Loss: 1.471 Vali Loss: 1.283 Vali Acc: 0.883 Test Loss: 1.283 Test Acc: 0.883
Validation loss decreased (-0.843317 --> -0.883321).  Saving model ...
Epoch: 7 cost time: 3.2546024322509766
Epoch: 7, Steps: 18 | Train Loss: 1.072 Vali Loss: 0.961 Vali Acc: 0.907 Test Loss: 0.961 Test Acc: 0.907
Validation loss decreased (-0.883321 --> -0.906657).  Saving model ...
Epoch: 8 cost time: 3.4670462608337402
Epoch: 8, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.726 Vali Acc: 0.950 Test Loss: 0.726 Test Acc: 0.950
Validation loss decreased (-0.906657 --> -0.949993).  Saving model ...
Epoch: 9 cost time: 3.5547170639038086
Epoch: 9, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.565 Vali Acc: 0.960 Test Loss: 0.565 Test Acc: 0.960
Validation loss decreased (-0.949993 --> -0.959994).  Saving model ...
Epoch: 10 cost time: 3.2160825729370117
Epoch: 10, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.468 Vali Acc: 0.953 Test Loss: 0.468 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3439483642578125
Epoch: 11, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.406 Vali Acc: 0.953 Test Loss: 0.406 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.438858985900879
Epoch: 12, Steps: 18 | Train Loss: 0.264 Vali Loss: 0.342 Vali Acc: 0.957 Test Loss: 0.342 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.570894241333008
Epoch: 13, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.310 Vali Acc: 0.960 Test Loss: 0.310 Test Acc: 0.960
Validation loss decreased (-0.959994 --> -0.959997).  Saving model ...
Epoch: 14 cost time: 3.4472577571868896
Epoch: 14, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959997).  Saving model ...
Epoch: 15 cost time: 3.750511407852173
Epoch: 15, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.256 Vali Acc: 0.963 Test Loss: 0.256 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 16 cost time: 3.7754955291748047
Epoch: 16, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 17 cost time: 3.550203800201416
Epoch: 17, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.447502374649048
Epoch: 18, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6905951499938965
Epoch: 19, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 20 cost time: 3.4675800800323486
Epoch: 20, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3735296726226807
Epoch: 21, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 22 cost time: 3.633981227874756
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.19112229347229
Epoch: 23, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7523555755615234
Epoch: 24, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 25 cost time: 3.1562607288360596
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 26 cost time: 3.532132387161255
Epoch: 26, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4956395626068115
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 28 cost time: 3.6247289180755615
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 3.3473973274230957
Epoch: 29, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.422865390777588
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 288001
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.95208477973938
Epoch: 1, Steps: 18 | Train Loss: 3.338 Vali Loss: 3.241 Vali Acc: 0.030 Test Loss: 3.241 Test Acc: 0.030
Validation loss decreased (inf --> -0.029968).  Saving model ...
Epoch: 2 cost time: 4.22347092628479
Epoch: 2, Steps: 18 | Train Loss: 3.112 Vali Loss: 2.959 Vali Acc: 0.190 Test Loss: 2.959 Test Acc: 0.190
Validation loss decreased (-0.029968 --> -0.189970).  Saving model ...
Epoch: 3 cost time: 4.018030881881714
Epoch: 3, Steps: 18 | Train Loss: 2.780 Vali Loss: 2.614 Vali Acc: 0.450 Test Loss: 2.614 Test Acc: 0.450
Validation loss decreased (-0.189970 --> -0.449974).  Saving model ...
Epoch: 4 cost time: 4.231215238571167
Epoch: 4, Steps: 18 | Train Loss: 2.450 Vali Loss: 2.239 Vali Acc: 0.677 Test Loss: 2.239 Test Acc: 0.677
Validation loss decreased (-0.449974 --> -0.676644).  Saving model ...
Epoch: 5 cost time: 4.183964490890503
Epoch: 5, Steps: 18 | Train Loss: 2.000 Vali Loss: 1.863 Vali Acc: 0.780 Test Loss: 1.863 Test Acc: 0.780
Validation loss decreased (-0.676644 --> -0.779981).  Saving model ...
Epoch: 6 cost time: 4.134967088699341
Epoch: 6, Steps: 18 | Train Loss: 1.620 Vali Loss: 1.498 Vali Acc: 0.850 Test Loss: 1.498 Test Acc: 0.850
Validation loss decreased (-0.779981 --> -0.849985).  Saving model ...
Epoch: 7 cost time: 4.234330415725708
Epoch: 7, Steps: 18 | Train Loss: 1.252 Vali Loss: 1.172 Vali Acc: 0.880 Test Loss: 1.172 Test Acc: 0.880
Validation loss decreased (-0.849985 --> -0.879988).  Saving model ...
Epoch: 8 cost time: 4.025069713592529
Epoch: 8, Steps: 18 | Train Loss: 0.908 Vali Loss: 0.922 Vali Acc: 0.897 Test Loss: 0.922 Test Acc: 0.897
Validation loss decreased (-0.879988 --> -0.896657).  Saving model ...
Epoch: 9 cost time: 4.1526570320129395
Epoch: 9, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.730 Vali Acc: 0.917 Test Loss: 0.730 Test Acc: 0.917
Validation loss decreased (-0.896657 --> -0.916659).  Saving model ...
Epoch: 10 cost time: 4.047707796096802
Epoch: 10, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.607 Vali Acc: 0.917 Test Loss: 0.607 Test Acc: 0.917
Validation loss decreased (-0.916659 --> -0.916661).  Saving model ...
Epoch: 11 cost time: 4.268102407455444
Epoch: 11, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.515 Vali Acc: 0.927 Test Loss: 0.515 Test Acc: 0.927
Validation loss decreased (-0.916661 --> -0.926662).  Saving model ...
Epoch: 12 cost time: 4.280060768127441
Epoch: 12, Steps: 18 | Train Loss: 0.293 Vali Loss: 0.445 Vali Acc: 0.933 Test Loss: 0.445 Test Acc: 0.933
Validation loss decreased (-0.926662 --> -0.933329).  Saving model ...
Epoch: 13 cost time: 4.587658166885376
Epoch: 13, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.401 Vali Acc: 0.940 Test Loss: 0.401 Test Acc: 0.940
Validation loss decreased (-0.933329 --> -0.939996).  Saving model ...
Epoch: 14 cost time: 4.55291748046875
Epoch: 14, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.375 Vali Acc: 0.937 Test Loss: 0.375 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.535761833190918
Epoch: 15, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.345 Vali Acc: 0.940 Test Loss: 0.345 Test Acc: 0.940
Validation loss decreased (-0.939996 --> -0.939997).  Saving model ...
Epoch: 16 cost time: 4.7647624015808105
Epoch: 16, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.6202476024627686
Epoch: 17, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.300 Vali Acc: 0.940 Test Loss: 0.300 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 18 cost time: 4.660582780838013
Epoch: 18, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.287 Vali Acc: 0.940 Test Loss: 0.287 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 19 cost time: 4.403860092163086
Epoch: 19, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.492080450057983
Epoch: 20, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.261 Vali Acc: 0.940 Test Loss: 0.261 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 21 cost time: 4.28176474571228
Epoch: 21, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 22 cost time: 4.278137683868408
Epoch: 22, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
Validation loss decreased (-0.939997 --> -0.943331).  Saving model ...
Epoch: 23 cost time: 4.345473766326904
Epoch: 23, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
Validation loss decreased (-0.943331 --> -0.943331).  Saving model ...
Epoch: 24 cost time: 4.2105796337127686
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
Validation loss decreased (-0.943331 --> -0.943331).  Saving model ...
Epoch: 25 cost time: 4.15274453163147
Epoch: 25, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
Validation loss decreased (-0.943331 --> -0.943331).  Saving model ...
Epoch: 26 cost time: 3.9351701736450195
Epoch: 26, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.228 Vali Acc: 0.940 Test Loss: 0.228 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.542898893356323
Epoch: 27, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.225 Vali Acc: 0.947 Test Loss: 0.225 Test Acc: 0.947
Validation loss decreased (-0.943331 --> -0.946664).  Saving model ...
Epoch: 28 cost time: 4.17978048324585
Epoch: 28, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 4.355987548828125
Epoch: 29, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 3.8394532203674316
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.953 Test Loss: 0.207 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953331).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 908977
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.745044946670532
Epoch: 1, Steps: 18 | Train Loss: 3.234 Vali Loss: 3.127 Vali Acc: 0.073 Test Loss: 3.127 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 2.510786294937134
Epoch: 2, Steps: 18 | Train Loss: 3.027 Vali Loss: 2.849 Vali Acc: 0.270 Test Loss: 2.849 Test Acc: 0.270
Validation loss decreased (-0.073302 --> -0.269972).  Saving model ...
Epoch: 3 cost time: 2.8862781524658203
Epoch: 3, Steps: 18 | Train Loss: 2.704 Vali Loss: 2.490 Vali Acc: 0.517 Test Loss: 2.490 Test Acc: 0.517
Validation loss decreased (-0.269972 --> -0.516642).  Saving model ...
Epoch: 4 cost time: 2.6817243099212646
Epoch: 4, Steps: 18 | Train Loss: 2.313 Vali Loss: 2.078 Vali Acc: 0.743 Test Loss: 2.078 Test Acc: 0.743
Validation loss decreased (-0.516642 --> -0.743313).  Saving model ...
Epoch: 5 cost time: 2.864708662033081
Epoch: 5, Steps: 18 | Train Loss: 1.883 Vali Loss: 1.663 Vali Acc: 0.843 Test Loss: 1.663 Test Acc: 0.843
Validation loss decreased (-0.743313 --> -0.843317).  Saving model ...
Epoch: 6 cost time: 2.706423044204712
Epoch: 6, Steps: 18 | Train Loss: 1.477 Vali Loss: 1.280 Vali Acc: 0.887 Test Loss: 1.280 Test Acc: 0.887
Validation loss decreased (-0.843317 --> -0.886654).  Saving model ...
Epoch: 7 cost time: 2.865004062652588
Epoch: 7, Steps: 18 | Train Loss: 1.074 Vali Loss: 0.958 Vali Acc: 0.913 Test Loss: 0.958 Test Acc: 0.913
Validation loss decreased (-0.886654 --> -0.913324).  Saving model ...
Epoch: 8 cost time: 2.659543752670288
Epoch: 8, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.724 Vali Acc: 0.953 Test Loss: 0.724 Test Acc: 0.953
Validation loss decreased (-0.913324 --> -0.953326).  Saving model ...
Epoch: 9 cost time: 2.894759178161621
Epoch: 9, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.562 Vali Acc: 0.953 Test Loss: 0.562 Test Acc: 0.953
Validation loss decreased (-0.953326 --> -0.953328).  Saving model ...
Epoch: 10 cost time: 2.8162553310394287
Epoch: 10, Steps: 18 | Train Loss: 0.444 Vali Loss: 0.463 Vali Acc: 0.957 Test Loss: 0.463 Test Acc: 0.957
Validation loss decreased (-0.953328 --> -0.956662).  Saving model ...
Epoch: 11 cost time: 3.2189247608184814
Epoch: 11, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.401 Vali Acc: 0.953 Test Loss: 0.401 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.086104154586792
Epoch: 12, Steps: 18 | Train Loss: 0.264 Vali Loss: 0.337 Vali Acc: 0.957 Test Loss: 0.337 Test Acc: 0.957
Validation loss decreased (-0.956662 --> -0.956663).  Saving model ...
Epoch: 13 cost time: 3.1681833267211914
Epoch: 13, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.304 Vali Acc: 0.957 Test Loss: 0.304 Test Acc: 0.957
Validation loss decreased (-0.956663 --> -0.956664).  Saving model ...
Epoch: 14 cost time: 3.3231730461120605
Epoch: 14, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.275 Vali Acc: 0.960 Test Loss: 0.275 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959997).  Saving model ...
Epoch: 15 cost time: 3.1484532356262207
Epoch: 15, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.251 Vali Acc: 0.960 Test Loss: 0.251 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959997).  Saving model ...
Epoch: 16 cost time: 3.2951555252075195
Epoch: 16, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.235 Vali Acc: 0.963 Test Loss: 0.235 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 17 cost time: 3.1110713481903076
Epoch: 17, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.218 Vali Acc: 0.960 Test Loss: 0.218 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.310476779937744
Epoch: 18, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 19 cost time: 3.0445914268493652
Epoch: 19, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 20 cost time: 2.8875510692596436
Epoch: 20, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.427112579345703
Epoch: 21, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.445047378540039
Epoch: 22, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9570200443267822
Epoch: 23, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.15187668800354
Epoch: 24, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 3.128641128540039
Epoch: 25, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9840786457061768
Epoch: 26, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 27 cost time: 2.798246145248413
Epoch: 27, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9470467567443848
Epoch: 28, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2032570838928223
Epoch: 29, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2689208984375
Epoch: 30, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 288001
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.419100522994995
Epoch: 1, Steps: 18 | Train Loss: 3.199 Vali Loss: 3.131 Vali Acc: 0.063 Test Loss: 3.131 Test Acc: 0.063
Validation loss decreased (inf --> -0.063302).  Saving model ...
Epoch: 2 cost time: 5.140375375747681
Epoch: 2, Steps: 18 | Train Loss: 3.028 Vali Loss: 2.878 Vali Acc: 0.197 Test Loss: 2.878 Test Acc: 0.197
Validation loss decreased (-0.063302 --> -0.196638).  Saving model ...
Epoch: 3 cost time: 5.2986743450164795
Epoch: 3, Steps: 18 | Train Loss: 2.739 Vali Loss: 2.566 Vali Acc: 0.457 Test Loss: 2.566 Test Acc: 0.457
Validation loss decreased (-0.196638 --> -0.456641).  Saving model ...
Epoch: 4 cost time: 4.855841636657715
Epoch: 4, Steps: 18 | Train Loss: 2.374 Vali Loss: 2.230 Vali Acc: 0.680 Test Loss: 2.230 Test Acc: 0.680
Validation loss decreased (-0.456641 --> -0.679978).  Saving model ...
Epoch: 5 cost time: 4.831405162811279
Epoch: 5, Steps: 18 | Train Loss: 1.961 Vali Loss: 1.891 Vali Acc: 0.780 Test Loss: 1.891 Test Acc: 0.780
Validation loss decreased (-0.679978 --> -0.779981).  Saving model ...
Epoch: 6 cost time: 4.689828872680664
Epoch: 6, Steps: 18 | Train Loss: 1.629 Vali Loss: 1.565 Vali Acc: 0.823 Test Loss: 1.565 Test Acc: 0.823
Validation loss decreased (-0.779981 --> -0.823318).  Saving model ...
Epoch: 7 cost time: 4.492579698562622
Epoch: 7, Steps: 18 | Train Loss: 1.249 Vali Loss: 1.263 Vali Acc: 0.867 Test Loss: 1.263 Test Acc: 0.867
Validation loss decreased (-0.823318 --> -0.866654).  Saving model ...
Epoch: 8 cost time: 4.660647392272949
Epoch: 8, Steps: 18 | Train Loss: 0.931 Vali Loss: 0.996 Vali Acc: 0.893 Test Loss: 0.996 Test Acc: 0.893
Validation loss decreased (-0.866654 --> -0.893323).  Saving model ...
Epoch: 9 cost time: 4.853037595748901
Epoch: 9, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.783 Vali Acc: 0.903 Test Loss: 0.783 Test Acc: 0.903
Validation loss decreased (-0.893323 --> -0.903326).  Saving model ...
Epoch: 10 cost time: 5.116393089294434
Epoch: 10, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.631 Vali Acc: 0.923 Test Loss: 0.631 Test Acc: 0.923
Validation loss decreased (-0.903326 --> -0.923327).  Saving model ...
Epoch: 11 cost time: 4.958210468292236
Epoch: 11, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.520 Vali Acc: 0.930 Test Loss: 0.520 Test Acc: 0.930
Validation loss decreased (-0.923327 --> -0.929995).  Saving model ...
Epoch: 12 cost time: 3.1132359504699707
Epoch: 12, Steps: 18 | Train Loss: 0.274 Vali Loss: 0.455 Vali Acc: 0.937 Test Loss: 0.455 Test Acc: 0.937
Validation loss decreased (-0.929995 --> -0.936662).  Saving model ...
Epoch: 13 cost time: 3.137925863265991
Epoch: 13, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.396 Vali Acc: 0.940 Test Loss: 0.396 Test Acc: 0.940
Validation loss decreased (-0.936662 --> -0.939996).  Saving model ...
Epoch: 14 cost time: 5.495899200439453
Epoch: 14, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.663577556610107
Epoch: 15, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.334 Vali Acc: 0.943 Test Loss: 0.334 Test Acc: 0.943
Validation loss decreased (-0.939996 --> -0.943330).  Saving model ...
Epoch: 16 cost time: 5.69996452331543
Epoch: 16, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.312 Vali Acc: 0.943 Test Loss: 0.312 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943330).  Saving model ...
Epoch: 17 cost time: 5.61527156829834
Epoch: 17, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
Validation loss decreased (-0.943330 --> -0.946664).  Saving model ...
Epoch: 18 cost time: 5.673317909240723
Epoch: 18, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.276 Vali Acc: 0.940 Test Loss: 0.276 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.032960653305054
Epoch: 19, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.8767478466033936
Epoch: 20, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.257 Vali Acc: 0.947 Test Loss: 0.257 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 21 cost time: 5.945404529571533
Epoch: 21, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.250 Vali Acc: 0.947 Test Loss: 0.250 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 22 cost time: 5.602863788604736
Epoch: 22, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.608619451522827
Epoch: 23, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.242 Vali Acc: 0.947 Test Loss: 0.242 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 24 cost time: 5.763498306274414
Epoch: 24, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.51422119140625
Epoch: 25, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.953 Test Loss: 0.230 Test Acc: 0.953
Validation loss decreased (-0.946664 --> -0.953331).  Saving model ...
Epoch: 26 cost time: 5.4098920822143555
Epoch: 26, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.228 Vali Acc: 0.943 Test Loss: 0.228 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.49557900428772
Epoch: 27, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.722259044647217
Epoch: 28, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.947 Test Loss: 0.219 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.744813919067383
Epoch: 29, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.881756067276001
Epoch: 30, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 469105
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.779010057449341
Epoch: 1, Steps: 18 | Train Loss: 3.273 Vali Loss: 3.186 Vali Acc: 0.027 Test Loss: 3.186 Test Acc: 0.027
Validation loss decreased (inf --> -0.026635).  Saving model ...
Epoch: 2 cost time: 3.9005908966064453
Epoch: 2, Steps: 18 | Train Loss: 3.085 Vali Loss: 2.923 Vali Acc: 0.207 Test Loss: 2.923 Test Acc: 0.207
Validation loss decreased (-0.026635 --> -0.206637).  Saving model ...
Epoch: 3 cost time: 3.4987685680389404
Epoch: 3, Steps: 18 | Train Loss: 2.783 Vali Loss: 2.605 Vali Acc: 0.487 Test Loss: 2.605 Test Acc: 0.487
Validation loss decreased (-0.206637 --> -0.486641).  Saving model ...
Epoch: 4 cost time: 4.036916971206665
Epoch: 4, Steps: 18 | Train Loss: 2.439 Vali Loss: 2.247 Vali Acc: 0.637 Test Loss: 2.247 Test Acc: 0.637
Validation loss decreased (-0.486641 --> -0.636644).  Saving model ...
Epoch: 5 cost time: 3.911585569381714
Epoch: 5, Steps: 18 | Train Loss: 2.046 Vali Loss: 1.882 Vali Acc: 0.737 Test Loss: 1.882 Test Acc: 0.737
Validation loss decreased (-0.636644 --> -0.736648).  Saving model ...
Epoch: 6 cost time: 3.416145086288452
Epoch: 6, Steps: 18 | Train Loss: 1.722 Vali Loss: 1.529 Vali Acc: 0.807 Test Loss: 1.529 Test Acc: 0.807
Validation loss decreased (-0.736648 --> -0.806651).  Saving model ...
Epoch: 7 cost time: 3.6412086486816406
Epoch: 7, Steps: 18 | Train Loss: 1.290 Vali Loss: 1.201 Vali Acc: 0.873 Test Loss: 1.201 Test Acc: 0.873
Validation loss decreased (-0.806651 --> -0.873321).  Saving model ...
Epoch: 8 cost time: 3.607300281524658
Epoch: 8, Steps: 18 | Train Loss: 0.992 Vali Loss: 0.913 Vali Acc: 0.923 Test Loss: 0.913 Test Acc: 0.923
Validation loss decreased (-0.873321 --> -0.923324).  Saving model ...
Epoch: 9 cost time: 3.7518558502197266
Epoch: 9, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.703 Vali Acc: 0.940 Test Loss: 0.703 Test Acc: 0.940
Validation loss decreased (-0.923324 --> -0.939993).  Saving model ...
Epoch: 10 cost time: 3.391878366470337
Epoch: 10, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.558 Vali Acc: 0.957 Test Loss: 0.558 Test Acc: 0.957
Validation loss decreased (-0.939993 --> -0.956661).  Saving model ...
Epoch: 11 cost time: 3.6179943084716797
Epoch: 11, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.458 Vali Acc: 0.957 Test Loss: 0.458 Test Acc: 0.957
Validation loss decreased (-0.956661 --> -0.956662).  Saving model ...
Epoch: 12 cost time: 3.696932315826416
Epoch: 12, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.387 Vali Acc: 0.960 Test Loss: 0.387 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959996).  Saving model ...
Epoch: 13 cost time: 3.5138463973999023
Epoch: 13, Steps: 18 | Train Loss: 0.229 Vali Loss: 0.339 Vali Acc: 0.960 Test Loss: 0.339 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959997).  Saving model ...
Epoch: 14 cost time: 3.1127185821533203
Epoch: 14, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.306 Vali Acc: 0.963 Test Loss: 0.306 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963330).  Saving model ...
Epoch: 15 cost time: 3.808035373687744
Epoch: 15, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.777891159057617
Epoch: 16, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.259 Vali Acc: 0.963 Test Loss: 0.259 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 17 cost time: 3.5823800563812256
Epoch: 17, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 18 cost time: 3.0871808528900146
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.226 Vali Acc: 0.970 Test Loss: 0.226 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 19 cost time: 2.9972171783447266
Epoch: 19, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.416639804840088
Epoch: 20, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.613417387008667
Epoch: 21, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7751176357269287
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5388004779815674
Epoch: 23, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2349374294281006
Epoch: 24, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4636635780334473
Epoch: 25, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 26 cost time: 3.5590481758117676
Epoch: 26, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.305187940597534
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3680148124694824
Epoch: 28, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 29 cost time: 3.4140310287475586
Epoch: 29, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5589771270751953
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 158593
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.05479097366333
Epoch: 1, Steps: 18 | Train Loss: 3.199 Vali Loss: 3.131 Vali Acc: 0.063 Test Loss: 3.131 Test Acc: 0.063
Validation loss decreased (inf --> -0.063302).  Saving model ...
Epoch: 2 cost time: 4.410383224487305
Epoch: 2, Steps: 18 | Train Loss: 3.028 Vali Loss: 2.878 Vali Acc: 0.197 Test Loss: 2.878 Test Acc: 0.197
Validation loss decreased (-0.063302 --> -0.196638).  Saving model ...
Epoch: 3 cost time: 4.486444473266602
Epoch: 3, Steps: 18 | Train Loss: 2.739 Vali Loss: 2.566 Vali Acc: 0.457 Test Loss: 2.566 Test Acc: 0.457
Validation loss decreased (-0.196638 --> -0.456641).  Saving model ...
Epoch: 4 cost time: 3.948737144470215
Epoch: 4, Steps: 18 | Train Loss: 2.374 Vali Loss: 2.230 Vali Acc: 0.680 Test Loss: 2.230 Test Acc: 0.680
Validation loss decreased (-0.456641 --> -0.679978).  Saving model ...
Epoch: 5 cost time: 4.216344833374023
Epoch: 5, Steps: 18 | Train Loss: 1.961 Vali Loss: 1.891 Vali Acc: 0.780 Test Loss: 1.891 Test Acc: 0.780
Validation loss decreased (-0.679978 --> -0.779981).  Saving model ...
Epoch: 6 cost time: 5.076315641403198
Epoch: 6, Steps: 18 | Train Loss: 1.629 Vali Loss: 1.565 Vali Acc: 0.823 Test Loss: 1.565 Test Acc: 0.823
Validation loss decreased (-0.779981 --> -0.823318).  Saving model ...
Epoch: 7 cost time: 4.894289493560791
Epoch: 7, Steps: 18 | Train Loss: 1.249 Vali Loss: 1.263 Vali Acc: 0.867 Test Loss: 1.263 Test Acc: 0.867
Validation loss decreased (-0.823318 --> -0.866654).  Saving model ...
Epoch: 8 cost time: 4.928529739379883
Epoch: 8, Steps: 18 | Train Loss: 0.931 Vali Loss: 0.996 Vali Acc: 0.893 Test Loss: 0.996 Test Acc: 0.893
Validation loss decreased (-0.866654 --> -0.893323).  Saving model ...
Epoch: 9 cost time: 5.036828517913818
Epoch: 9, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.783 Vali Acc: 0.903 Test Loss: 0.783 Test Acc: 0.903
Validation loss decreased (-0.893323 --> -0.903326).  Saving model ...
Epoch: 10 cost time: 5.0127997398376465
Epoch: 10, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.631 Vali Acc: 0.923 Test Loss: 0.631 Test Acc: 0.923
Validation loss decreased (-0.903326 --> -0.923327).  Saving model ...
Epoch: 11 cost time: 4.707596778869629
Epoch: 11, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.520 Vali Acc: 0.930 Test Loss: 0.520 Test Acc: 0.930
Validation loss decreased (-0.923327 --> -0.929995).  Saving model ...
Epoch: 12 cost time: 4.74883508682251
Epoch: 12, Steps: 18 | Train Loss: 0.274 Vali Loss: 0.455 Vali Acc: 0.937 Test Loss: 0.455 Test Acc: 0.937
Validation loss decreased (-0.929995 --> -0.936662).  Saving model ...
Epoch: 13 cost time: 4.549842596054077
Epoch: 13, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.396 Vali Acc: 0.940 Test Loss: 0.396 Test Acc: 0.940
Validation loss decreased (-0.936662 --> -0.939996).  Saving model ...
Epoch: 14 cost time: 4.355069398880005
Epoch: 14, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.527935743331909
Epoch: 15, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.334 Vali Acc: 0.943 Test Loss: 0.334 Test Acc: 0.943
Validation loss decreased (-0.939996 --> -0.943330).  Saving model ...
Epoch: 16 cost time: 4.273411512374878
Epoch: 16, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.312 Vali Acc: 0.943 Test Loss: 0.312 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943330).  Saving model ...
Epoch: 17 cost time: 4.683988094329834
Epoch: 17, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
Validation loss decreased (-0.943330 --> -0.946664).  Saving model ...
Epoch: 18 cost time: 4.790165424346924
Epoch: 18, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.276 Vali Acc: 0.940 Test Loss: 0.276 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.567955017089844
Epoch: 19, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.7810142040252686
Epoch: 20, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.257 Vali Acc: 0.947 Test Loss: 0.257 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 21 cost time: 4.539665222167969
Epoch: 21, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.250 Vali Acc: 0.947 Test Loss: 0.250 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 22 cost time: 4.470173358917236
Epoch: 22, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.614093065261841
Epoch: 23, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.242 Vali Acc: 0.947 Test Loss: 0.242 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946664).  Saving model ...
Epoch: 24 cost time: 4.4595489501953125
Epoch: 24, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.447994947433472
Epoch: 25, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.953 Test Loss: 0.230 Test Acc: 0.953
Validation loss decreased (-0.946664 --> -0.953331).  Saving model ...
Epoch: 26 cost time: 4.497117280960083
Epoch: 26, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.228 Vali Acc: 0.943 Test Loss: 0.228 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.36730694770813
Epoch: 27, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.200466156005859
Epoch: 28, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.947 Test Loss: 0.219 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.385046720504761
Epoch: 29, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.517483234405518
Epoch: 30, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 469105
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.419467926025391
Epoch: 1, Steps: 18 | Train Loss: 3.273 Vali Loss: 3.186 Vali Acc: 0.027 Test Loss: 3.186 Test Acc: 0.027
Validation loss decreased (inf --> -0.026635).  Saving model ...
Epoch: 2 cost time: 3.599245309829712
Epoch: 2, Steps: 18 | Train Loss: 3.085 Vali Loss: 2.923 Vali Acc: 0.207 Test Loss: 2.923 Test Acc: 0.207
Validation loss decreased (-0.026635 --> -0.206637).  Saving model ...
Epoch: 3 cost time: 3.5815577507019043
Epoch: 3, Steps: 18 | Train Loss: 2.783 Vali Loss: 2.605 Vali Acc: 0.487 Test Loss: 2.605 Test Acc: 0.487
Validation loss decreased (-0.206637 --> -0.486641).  Saving model ...
Epoch: 4 cost time: 3.7459487915039062
Epoch: 4, Steps: 18 | Train Loss: 2.439 Vali Loss: 2.247 Vali Acc: 0.637 Test Loss: 2.247 Test Acc: 0.637
Validation loss decreased (-0.486641 --> -0.636644).  Saving model ...
Epoch: 5 cost time: 3.554598808288574
Epoch: 5, Steps: 18 | Train Loss: 2.046 Vali Loss: 1.882 Vali Acc: 0.737 Test Loss: 1.882 Test Acc: 0.737
Validation loss decreased (-0.636644 --> -0.736648).  Saving model ...
Epoch: 6 cost time: 3.623624324798584
Epoch: 6, Steps: 18 | Train Loss: 1.722 Vali Loss: 1.529 Vali Acc: 0.807 Test Loss: 1.529 Test Acc: 0.807
Validation loss decreased (-0.736648 --> -0.806651).  Saving model ...
Epoch: 7 cost time: 3.728044271469116
Epoch: 7, Steps: 18 | Train Loss: 1.290 Vali Loss: 1.201 Vali Acc: 0.873 Test Loss: 1.201 Test Acc: 0.873
Validation loss decreased (-0.806651 --> -0.873321).  Saving model ...
Epoch: 8 cost time: 3.7060739994049072
Epoch: 8, Steps: 18 | Train Loss: 0.992 Vali Loss: 0.913 Vali Acc: 0.923 Test Loss: 0.913 Test Acc: 0.923
Validation loss decreased (-0.873321 --> -0.923324).  Saving model ...
Epoch: 9 cost time: 3.6413028240203857
Epoch: 9, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.703 Vali Acc: 0.940 Test Loss: 0.703 Test Acc: 0.940
Validation loss decreased (-0.923324 --> -0.939993).  Saving model ...
Epoch: 10 cost time: 3.7197377681732178
Epoch: 10, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.558 Vali Acc: 0.957 Test Loss: 0.558 Test Acc: 0.957
Validation loss decreased (-0.939993 --> -0.956661).  Saving model ...
Epoch: 11 cost time: 3.720764398574829
Epoch: 11, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.458 Vali Acc: 0.957 Test Loss: 0.458 Test Acc: 0.957
Validation loss decreased (-0.956661 --> -0.956662).  Saving model ...
Epoch: 12 cost time: 3.5642077922821045
Epoch: 12, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.387 Vali Acc: 0.960 Test Loss: 0.387 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959996).  Saving model ...
Epoch: 13 cost time: 3.765643358230591
Epoch: 13, Steps: 18 | Train Loss: 0.229 Vali Loss: 0.339 Vali Acc: 0.960 Test Loss: 0.339 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959997).  Saving model ...
Epoch: 14 cost time: 3.816132068634033
Epoch: 14, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.306 Vali Acc: 0.963 Test Loss: 0.306 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963330).  Saving model ...
Epoch: 15 cost time: 3.442284345626831
Epoch: 15, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.650085926055908
Epoch: 16, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.259 Vali Acc: 0.963 Test Loss: 0.259 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 17 cost time: 3.6195216178894043
Epoch: 17, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 18 cost time: 3.691878080368042
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.226 Vali Acc: 0.970 Test Loss: 0.226 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 19 cost time: 3.226921796798706
Epoch: 19, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6350347995758057
Epoch: 20, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3201894760131836
Epoch: 21, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3521766662597656
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.192929983139038
Epoch: 23, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5132479667663574
Epoch: 24, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4147047996520996
Epoch: 25, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 26 cost time: 3.4177117347717285
Epoch: 26, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4674389362335205
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.543718099594116
Epoch: 28, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 29 cost time: 3.2146494388580322
Epoch: 29, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.475541114807129
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 158593
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.181133508682251
Epoch: 1, Steps: 18 | Train Loss: 3.200 Vali Loss: 3.131 Vali Acc: 0.063 Test Loss: 3.131 Test Acc: 0.063
Validation loss decreased (inf --> -0.063302).  Saving model ...
Epoch: 2 cost time: 3.673384189605713
Epoch: 2, Steps: 18 | Train Loss: 3.028 Vali Loss: 2.878 Vali Acc: 0.193 Test Loss: 2.878 Test Acc: 0.193
Validation loss decreased (-0.063302 --> -0.193305).  Saving model ...
Epoch: 3 cost time: 3.598308801651001
Epoch: 3, Steps: 18 | Train Loss: 2.740 Vali Loss: 2.567 Vali Acc: 0.453 Test Loss: 2.567 Test Acc: 0.453
Validation loss decreased (-0.193305 --> -0.453308).  Saving model ...
Epoch: 4 cost time: 3.3724818229675293
Epoch: 4, Steps: 18 | Train Loss: 2.377 Vali Loss: 2.231 Vali Acc: 0.680 Test Loss: 2.231 Test Acc: 0.680
Validation loss decreased (-0.453308 --> -0.679978).  Saving model ...
Epoch: 5 cost time: 3.4838016033172607
Epoch: 5, Steps: 18 | Train Loss: 1.964 Vali Loss: 1.892 Vali Acc: 0.793 Test Loss: 1.892 Test Acc: 0.793
Validation loss decreased (-0.679978 --> -0.793314).  Saving model ...
Epoch: 6 cost time: 3.6121034622192383
Epoch: 6, Steps: 18 | Train Loss: 1.635 Vali Loss: 1.566 Vali Acc: 0.823 Test Loss: 1.566 Test Acc: 0.823
Validation loss decreased (-0.793314 --> -0.823318).  Saving model ...
Epoch: 7 cost time: 3.4335122108459473
Epoch: 7, Steps: 18 | Train Loss: 1.257 Vali Loss: 1.263 Vali Acc: 0.870 Test Loss: 1.263 Test Acc: 0.870
Validation loss decreased (-0.823318 --> -0.869987).  Saving model ...
Epoch: 8 cost time: 3.3950324058532715
Epoch: 8, Steps: 18 | Train Loss: 0.939 Vali Loss: 0.997 Vali Acc: 0.897 Test Loss: 0.997 Test Acc: 0.897
Validation loss decreased (-0.869987 --> -0.896657).  Saving model ...
Epoch: 9 cost time: 3.5774781703948975
Epoch: 9, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.781 Vali Acc: 0.907 Test Loss: 0.781 Test Acc: 0.907
Validation loss decreased (-0.896657 --> -0.906659).  Saving model ...
Epoch: 10 cost time: 3.4167420864105225
Epoch: 10, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.627 Vali Acc: 0.927 Test Loss: 0.627 Test Acc: 0.927
Validation loss decreased (-0.906659 --> -0.926660).  Saving model ...
Epoch: 11 cost time: 3.576355218887329
Epoch: 11, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.514 Vali Acc: 0.933 Test Loss: 0.514 Test Acc: 0.933
Validation loss decreased (-0.926660 --> -0.933328).  Saving model ...
Epoch: 12 cost time: 3.5905866622924805
Epoch: 12, Steps: 18 | Train Loss: 0.280 Vali Loss: 0.447 Vali Acc: 0.937 Test Loss: 0.447 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.936662).  Saving model ...
Epoch: 13 cost time: 3.7748022079467773
Epoch: 13, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.388 Vali Acc: 0.940 Test Loss: 0.388 Test Acc: 0.940
Validation loss decreased (-0.936662 --> -0.939996).  Saving model ...
Epoch: 14 cost time: 3.5599355697631836
Epoch: 14, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.361 Vali Acc: 0.933 Test Loss: 0.361 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.800828456878662
Epoch: 15, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.325 Vali Acc: 0.947 Test Loss: 0.325 Test Acc: 0.947
Validation loss decreased (-0.939996 --> -0.946663).  Saving model ...
Epoch: 16 cost time: 3.820803642272949
Epoch: 16, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.303 Vali Acc: 0.947 Test Loss: 0.303 Test Acc: 0.947
Validation loss decreased (-0.946663 --> -0.946664).  Saving model ...
Epoch: 17 cost time: 3.6695079803466797
Epoch: 17, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.283 Vali Acc: 0.953 Test Loss: 0.283 Test Acc: 0.953
Validation loss decreased (-0.946664 --> -0.953331).  Saving model ...
Epoch: 18 cost time: 3.4968574047088623
Epoch: 18, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.268 Vali Acc: 0.947 Test Loss: 0.268 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.085919141769409
Epoch: 19, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.261 Vali Acc: 0.953 Test Loss: 0.261 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 20 cost time: 3.259722948074341
Epoch: 20, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.248 Vali Acc: 0.953 Test Loss: 0.248 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 21 cost time: 3.757209062576294
Epoch: 21, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 22 cost time: 3.7928433418273926
Epoch: 22, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8112688064575195
Epoch: 23, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.234 Vali Acc: 0.953 Test Loss: 0.234 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 24 cost time: 3.737074851989746
Epoch: 24, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.228 Vali Acc: 0.947 Test Loss: 0.228 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4648520946502686
Epoch: 25, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 26 cost time: 3.6254608631134033
Epoch: 26, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5620975494384766
Epoch: 27, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.566865921020508
Epoch: 28, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 29 cost time: 3.581862449645996
Epoch: 29, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 30 cost time: 3.5456392765045166
Epoch: 30, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 469105
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.843687295913696
Epoch: 1, Steps: 18 | Train Loss: 3.272 Vali Loss: 3.184 Vali Acc: 0.027 Test Loss: 3.184 Test Acc: 0.027
Validation loss decreased (inf --> -0.026635).  Saving model ...
Epoch: 2 cost time: 3.017956018447876
Epoch: 2, Steps: 18 | Train Loss: 3.084 Vali Loss: 2.921 Vali Acc: 0.207 Test Loss: 2.921 Test Acc: 0.207
Validation loss decreased (-0.026635 --> -0.206637).  Saving model ...
Epoch: 3 cost time: 3.271737575531006
Epoch: 3, Steps: 18 | Train Loss: 2.782 Vali Loss: 2.603 Vali Acc: 0.483 Test Loss: 2.603 Test Acc: 0.483
Validation loss decreased (-0.206637 --> -0.483307).  Saving model ...
Epoch: 4 cost time: 3.306168556213379
Epoch: 4, Steps: 18 | Train Loss: 2.438 Vali Loss: 2.245 Vali Acc: 0.637 Test Loss: 2.245 Test Acc: 0.637
Validation loss decreased (-0.483307 --> -0.636644).  Saving model ...
Epoch: 5 cost time: 3.25544810295105
Epoch: 5, Steps: 18 | Train Loss: 2.046 Vali Loss: 1.880 Vali Acc: 0.737 Test Loss: 1.880 Test Acc: 0.737
Validation loss decreased (-0.636644 --> -0.736648).  Saving model ...
Epoch: 6 cost time: 3.2789103984832764
Epoch: 6, Steps: 18 | Train Loss: 1.722 Vali Loss: 1.527 Vali Acc: 0.810 Test Loss: 1.527 Test Acc: 0.810
Validation loss decreased (-0.736648 --> -0.809985).  Saving model ...
Epoch: 7 cost time: 3.022162675857544
Epoch: 7, Steps: 18 | Train Loss: 1.290 Vali Loss: 1.200 Vali Acc: 0.877 Test Loss: 1.200 Test Acc: 0.877
Validation loss decreased (-0.809985 --> -0.876655).  Saving model ...
Epoch: 8 cost time: 2.508157730102539
Epoch: 8, Steps: 18 | Train Loss: 0.993 Vali Loss: 0.911 Vali Acc: 0.923 Test Loss: 0.911 Test Acc: 0.923
Validation loss decreased (-0.876655 --> -0.923324).  Saving model ...
Epoch: 9 cost time: 2.5690829753875732
Epoch: 9, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.701 Vali Acc: 0.940 Test Loss: 0.701 Test Acc: 0.940
Validation loss decreased (-0.923324 --> -0.939993).  Saving model ...
Epoch: 10 cost time: 3.3099145889282227
Epoch: 10, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.555 Vali Acc: 0.957 Test Loss: 0.555 Test Acc: 0.957
Validation loss decreased (-0.939993 --> -0.956661).  Saving model ...
Epoch: 11 cost time: 3.0256128311157227
Epoch: 11, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.455 Vali Acc: 0.957 Test Loss: 0.455 Test Acc: 0.957
Validation loss decreased (-0.956661 --> -0.956662).  Saving model ...
Epoch: 12 cost time: 3.2682700157165527
Epoch: 12, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.384 Vali Acc: 0.960 Test Loss: 0.384 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959996).  Saving model ...
Epoch: 13 cost time: 3.0968799591064453
Epoch: 13, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.335 Vali Acc: 0.960 Test Loss: 0.335 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959997).  Saving model ...
Epoch: 14 cost time: 3.0792927742004395
Epoch: 14, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.302 Vali Acc: 0.963 Test Loss: 0.302 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963330).  Saving model ...
Epoch: 15 cost time: 2.920466661453247
Epoch: 15, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.275 Vali Acc: 0.960 Test Loss: 0.275 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.077808141708374
Epoch: 16, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.255 Vali Acc: 0.960 Test Loss: 0.255 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1313366889953613
Epoch: 17, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 18 cost time: 3.054198980331421
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 19 cost time: 3.1068620681762695
Epoch: 19, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.969418525695801
Epoch: 20, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.138213634490967
Epoch: 21, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9481735229492188
Epoch: 22, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.223581552505493
Epoch: 23, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0320329666137695
Epoch: 24, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.9999096393585205
Epoch: 25, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 26 cost time: 3.044490337371826
Epoch: 26, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0277974605560303
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1081786155700684
Epoch: 28, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 2.8606083393096924
Epoch: 29, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1168272495269775
Epoch: 30, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 158593
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.892924547195435
Epoch: 1, Steps: 18 | Train Loss: 3.289 Vali Loss: 3.195 Vali Acc: 0.077 Test Loss: 3.195 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 4.534766674041748
Epoch: 2, Steps: 18 | Train Loss: 3.060 Vali Loss: 2.912 Vali Acc: 0.220 Test Loss: 2.912 Test Acc: 0.220
Validation loss decreased (-0.076635 --> -0.219971).  Saving model ...
Epoch: 3 cost time: 4.509117364883423
Epoch: 3, Steps: 18 | Train Loss: 2.750 Vali Loss: 2.560 Vali Acc: 0.483 Test Loss: 2.560 Test Acc: 0.483
Validation loss decreased (-0.219971 --> -0.483308).  Saving model ...
Epoch: 4 cost time: 4.6844398975372314
Epoch: 4, Steps: 18 | Train Loss: 2.378 Vali Loss: 2.176 Vali Acc: 0.707 Test Loss: 2.176 Test Acc: 0.707
Validation loss decreased (-0.483308 --> -0.706645).  Saving model ...
Epoch: 5 cost time: 5.001962184906006
Epoch: 5, Steps: 18 | Train Loss: 1.967 Vali Loss: 1.791 Vali Acc: 0.817 Test Loss: 1.791 Test Acc: 0.817
Validation loss decreased (-0.706645 --> -0.816649).  Saving model ...
Epoch: 6 cost time: 4.607282400131226
Epoch: 6, Steps: 18 | Train Loss: 1.601 Vali Loss: 1.425 Vali Acc: 0.847 Test Loss: 1.425 Test Acc: 0.847
Validation loss decreased (-0.816649 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 4.67339563369751
Epoch: 7, Steps: 18 | Train Loss: 1.225 Vali Loss: 1.116 Vali Acc: 0.883 Test Loss: 1.116 Test Acc: 0.883
Validation loss decreased (-0.846652 --> -0.883322).  Saving model ...
Epoch: 8 cost time: 4.939471006393433
Epoch: 8, Steps: 18 | Train Loss: 0.959 Vali Loss: 0.862 Vali Acc: 0.920 Test Loss: 0.862 Test Acc: 0.920
Validation loss decreased (-0.883322 --> -0.919991).  Saving model ...
Epoch: 9 cost time: 5.044509410858154
Epoch: 9, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.680 Vali Acc: 0.927 Test Loss: 0.680 Test Acc: 0.927
Validation loss decreased (-0.919991 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 4.922778129577637
Epoch: 10, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.552 Vali Acc: 0.943 Test Loss: 0.552 Test Acc: 0.943
Validation loss decreased (-0.926660 --> -0.943328).  Saving model ...
Epoch: 11 cost time: 4.877134561538696
Epoch: 11, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.455 Vali Acc: 0.957 Test Loss: 0.455 Test Acc: 0.957
Validation loss decreased (-0.943328 --> -0.956662).  Saving model ...
Epoch: 12 cost time: 5.092400074005127
Epoch: 12, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.390 Vali Acc: 0.960 Test Loss: 0.390 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959996).  Saving model ...
Epoch: 13 cost time: 5.184965133666992
Epoch: 13, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.338 Vali Acc: 0.963 Test Loss: 0.338 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 14 cost time: 4.949013710021973
Epoch: 14, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.297 Vali Acc: 0.970 Test Loss: 0.297 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969997).  Saving model ...
Epoch: 15 cost time: 5.097905874252319
Epoch: 15, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.276 Vali Acc: 0.963 Test Loss: 0.276 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.200724840164185
Epoch: 16, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.246 Vali Acc: 0.973 Test Loss: 0.246 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 17 cost time: 5.270965099334717
Epoch: 17, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.225 Vali Acc: 0.977 Test Loss: 0.225 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976664).  Saving model ...
Epoch: 18 cost time: 5.166411399841309
Epoch: 18, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.210 Vali Acc: 0.977 Test Loss: 0.210 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 4.940948486328125
Epoch: 19, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 0.973 Test Loss: 0.196 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.919810056686401
Epoch: 20, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 21 cost time: 4.7956883907318115
Epoch: 21, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.9588942527771
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.32803201675415
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.7261064052581787
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.817145347595215
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 4.812453269958496
Epoch: 26, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.123428106307983
Epoch: 27, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.123722076416016
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.068840265274048
Epoch: 29, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 5.347862958908081
Epoch: 30, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 249169
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.65151572227478
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.117 Vali Acc: 0.090 Test Loss: 3.117 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 3.8161935806274414
Epoch: 2, Steps: 18 | Train Loss: 3.027 Vali Loss: 2.858 Vali Acc: 0.247 Test Loss: 2.858 Test Acc: 0.247
Validation loss decreased (-0.089969 --> -0.246638).  Saving model ...
Epoch: 3 cost time: 3.934640407562256
Epoch: 3, Steps: 18 | Train Loss: 2.736 Vali Loss: 2.533 Vali Acc: 0.513 Test Loss: 2.533 Test Acc: 0.513
Validation loss decreased (-0.246638 --> -0.513308).  Saving model ...
Epoch: 4 cost time: 3.789367914199829
Epoch: 4, Steps: 18 | Train Loss: 2.382 Vali Loss: 2.164 Vali Acc: 0.700 Test Loss: 2.164 Test Acc: 0.700
Validation loss decreased (-0.513308 --> -0.699978).  Saving model ...
Epoch: 5 cost time: 3.7667605876922607
Epoch: 5, Steps: 18 | Train Loss: 1.971 Vali Loss: 1.780 Vali Acc: 0.803 Test Loss: 1.780 Test Acc: 0.803
Validation loss decreased (-0.699978 --> -0.803316).  Saving model ...
Epoch: 6 cost time: 3.7117037773132324
Epoch: 6, Steps: 18 | Train Loss: 1.555 Vali Loss: 1.409 Vali Acc: 0.867 Test Loss: 1.409 Test Acc: 0.867
Validation loss decreased (-0.803316 --> -0.866653).  Saving model ...
Epoch: 7 cost time: 3.588115692138672
Epoch: 7, Steps: 18 | Train Loss: 1.207 Vali Loss: 1.093 Vali Acc: 0.887 Test Loss: 1.093 Test Acc: 0.887
Validation loss decreased (-0.866653 --> -0.886656).  Saving model ...
Epoch: 8 cost time: 3.6922268867492676
Epoch: 8, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.848 Vali Acc: 0.910 Test Loss: 0.848 Test Acc: 0.910
Validation loss decreased (-0.886656 --> -0.909992).  Saving model ...
Epoch: 9 cost time: 3.642770528793335
Epoch: 9, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.672 Vali Acc: 0.917 Test Loss: 0.672 Test Acc: 0.917
Validation loss decreased (-0.909992 --> -0.916660).  Saving model ...
Epoch: 10 cost time: 3.5494134426116943
Epoch: 10, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.554 Vali Acc: 0.923 Test Loss: 0.554 Test Acc: 0.923
Validation loss decreased (-0.916660 --> -0.923328).  Saving model ...
Epoch: 11 cost time: 3.664447784423828
Epoch: 11, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.473 Vali Acc: 0.927 Test Loss: 0.473 Test Acc: 0.927
Validation loss decreased (-0.923328 --> -0.926662).  Saving model ...
Epoch: 12 cost time: 3.339754343032837
Epoch: 12, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.418 Vali Acc: 0.933 Test Loss: 0.418 Test Acc: 0.933
Validation loss decreased (-0.926662 --> -0.933329).  Saving model ...
Epoch: 13 cost time: 3.757594347000122
Epoch: 13, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 14 cost time: 3.388368606567383
Epoch: 14, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.345 Vali Acc: 0.927 Test Loss: 0.345 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.549187183380127
Epoch: 15, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.317 Vali Acc: 0.937 Test Loss: 0.317 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.936663).  Saving model ...
Epoch: 16 cost time: 3.5473740100860596
Epoch: 16, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.293 Vali Acc: 0.940 Test Loss: 0.293 Test Acc: 0.940
Validation loss decreased (-0.936663 --> -0.939997).  Saving model ...
Epoch: 17 cost time: 3.5294859409332275
Epoch: 17, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1414687633514404
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.256 Vali Acc: 0.943 Test Loss: 0.256 Test Acc: 0.943
Validation loss decreased (-0.939997 --> -0.943331).  Saving model ...
Epoch: 19 cost time: 2.996908664703369
Epoch: 19, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 3.4159436225891113
Epoch: 20, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 3.4546310901641846
Epoch: 21, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 3.396785020828247
Epoch: 22, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 3.39829421043396
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 24 cost time: 3.4943718910217285
Epoch: 24, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0354816913604736
Epoch: 25, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 26 cost time: 3.2657718658447266
Epoch: 26, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.251755952835083
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9862754344940186
Epoch: 28, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 29 cost time: 3.3123223781585693
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 30 cost time: 2.949758529663086
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 93889
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.102524518966675
Epoch: 1, Steps: 18 | Train Loss: 3.289 Vali Loss: 3.195 Vali Acc: 0.077 Test Loss: 3.195 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 4.583903789520264
Epoch: 2, Steps: 18 | Train Loss: 3.060 Vali Loss: 2.912 Vali Acc: 0.220 Test Loss: 2.912 Test Acc: 0.220
Validation loss decreased (-0.076635 --> -0.219971).  Saving model ...
Epoch: 3 cost time: 4.175591230392456
Epoch: 3, Steps: 18 | Train Loss: 2.750 Vali Loss: 2.560 Vali Acc: 0.483 Test Loss: 2.560 Test Acc: 0.483
Validation loss decreased (-0.219971 --> -0.483308).  Saving model ...
Epoch: 4 cost time: 4.3115620613098145
Epoch: 4, Steps: 18 | Train Loss: 2.378 Vali Loss: 2.176 Vali Acc: 0.707 Test Loss: 2.176 Test Acc: 0.707
Validation loss decreased (-0.483308 --> -0.706645).  Saving model ...
Epoch: 5 cost time: 3.983819007873535
Epoch: 5, Steps: 18 | Train Loss: 1.967 Vali Loss: 1.791 Vali Acc: 0.817 Test Loss: 1.791 Test Acc: 0.817
Validation loss decreased (-0.706645 --> -0.816649).  Saving model ...
Epoch: 6 cost time: 4.2315003871917725
Epoch: 6, Steps: 18 | Train Loss: 1.601 Vali Loss: 1.425 Vali Acc: 0.847 Test Loss: 1.425 Test Acc: 0.847
Validation loss decreased (-0.816649 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 4.108269691467285
Epoch: 7, Steps: 18 | Train Loss: 1.225 Vali Loss: 1.116 Vali Acc: 0.883 Test Loss: 1.116 Test Acc: 0.883
Validation loss decreased (-0.846652 --> -0.883322).  Saving model ...
Epoch: 8 cost time: 4.696391582489014
Epoch: 8, Steps: 18 | Train Loss: 0.959 Vali Loss: 0.862 Vali Acc: 0.920 Test Loss: 0.862 Test Acc: 0.920
Validation loss decreased (-0.883322 --> -0.919991).  Saving model ...
Epoch: 9 cost time: 4.489843130111694
Epoch: 9, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.680 Vali Acc: 0.927 Test Loss: 0.680 Test Acc: 0.927
Validation loss decreased (-0.919991 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 4.562871217727661
Epoch: 10, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.552 Vali Acc: 0.943 Test Loss: 0.552 Test Acc: 0.943
Validation loss decreased (-0.926660 --> -0.943328).  Saving model ...
Epoch: 11 cost time: 4.5615410804748535
Epoch: 11, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.455 Vali Acc: 0.957 Test Loss: 0.455 Test Acc: 0.957
Validation loss decreased (-0.943328 --> -0.956662).  Saving model ...
Epoch: 12 cost time: 4.154933929443359
Epoch: 12, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.390 Vali Acc: 0.960 Test Loss: 0.390 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959996).  Saving model ...
Epoch: 13 cost time: 4.396600723266602
Epoch: 13, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.338 Vali Acc: 0.963 Test Loss: 0.338 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 14 cost time: 4.05902624130249
Epoch: 14, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.297 Vali Acc: 0.970 Test Loss: 0.297 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969997).  Saving model ...
Epoch: 15 cost time: 4.292594909667969
Epoch: 15, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.276 Vali Acc: 0.963 Test Loss: 0.276 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.3396172523498535
Epoch: 16, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.246 Vali Acc: 0.973 Test Loss: 0.246 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 17 cost time: 4.646139144897461
Epoch: 17, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.225 Vali Acc: 0.977 Test Loss: 0.225 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976664).  Saving model ...
Epoch: 18 cost time: 4.336735486984253
Epoch: 18, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.210 Vali Acc: 0.977 Test Loss: 0.210 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 4.3876259326934814
Epoch: 19, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 0.973 Test Loss: 0.196 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.010540008544922
Epoch: 20, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 21 cost time: 3.8937220573425293
Epoch: 21, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.048914432525635
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.985525608062744
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.136714220046997
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.079413652420044
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 4.389321565628052
Epoch: 26, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.212016344070435
Epoch: 27, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.521585464477539
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.07377290725708
Epoch: 29, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 4.377534866333008
Epoch: 30, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 249169
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.960707187652588
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.117 Vali Acc: 0.090 Test Loss: 3.117 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 2.5928492546081543
Epoch: 2, Steps: 18 | Train Loss: 3.027 Vali Loss: 2.858 Vali Acc: 0.247 Test Loss: 2.858 Test Acc: 0.247
Validation loss decreased (-0.089969 --> -0.246638).  Saving model ...
Epoch: 3 cost time: 3.2189061641693115
Epoch: 3, Steps: 18 | Train Loss: 2.736 Vali Loss: 2.533 Vali Acc: 0.513 Test Loss: 2.533 Test Acc: 0.513
Validation loss decreased (-0.246638 --> -0.513308).  Saving model ...
Epoch: 4 cost time: 3.284976005554199
Epoch: 4, Steps: 18 | Train Loss: 2.382 Vali Loss: 2.164 Vali Acc: 0.700 Test Loss: 2.164 Test Acc: 0.700
Validation loss decreased (-0.513308 --> -0.699978).  Saving model ...
Epoch: 5 cost time: 3.170222043991089
Epoch: 5, Steps: 18 | Train Loss: 1.971 Vali Loss: 1.780 Vali Acc: 0.803 Test Loss: 1.780 Test Acc: 0.803
Validation loss decreased (-0.699978 --> -0.803316).  Saving model ...
Epoch: 6 cost time: 3.0693676471710205
Epoch: 6, Steps: 18 | Train Loss: 1.555 Vali Loss: 1.409 Vali Acc: 0.867 Test Loss: 1.409 Test Acc: 0.867
Validation loss decreased (-0.803316 --> -0.866653).  Saving model ...
Epoch: 7 cost time: 3.137068510055542
Epoch: 7, Steps: 18 | Train Loss: 1.207 Vali Loss: 1.093 Vali Acc: 0.887 Test Loss: 1.093 Test Acc: 0.887
Validation loss decreased (-0.866653 --> -0.886656).  Saving model ...
Epoch: 8 cost time: 3.2673933506011963
Epoch: 8, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.848 Vali Acc: 0.910 Test Loss: 0.848 Test Acc: 0.910
Validation loss decreased (-0.886656 --> -0.909992).  Saving model ...
Epoch: 9 cost time: 2.908278703689575
Epoch: 9, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.672 Vali Acc: 0.917 Test Loss: 0.672 Test Acc: 0.917
Validation loss decreased (-0.909992 --> -0.916660).  Saving model ...
Epoch: 10 cost time: 2.8659615516662598
Epoch: 10, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.554 Vali Acc: 0.923 Test Loss: 0.554 Test Acc: 0.923
Validation loss decreased (-0.916660 --> -0.923328).  Saving model ...
Epoch: 11 cost time: 3.204275369644165
Epoch: 11, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.473 Vali Acc: 0.927 Test Loss: 0.473 Test Acc: 0.927
Validation loss decreased (-0.923328 --> -0.926662).  Saving model ...
Epoch: 12 cost time: 3.296586513519287
Epoch: 12, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.418 Vali Acc: 0.933 Test Loss: 0.418 Test Acc: 0.933
Validation loss decreased (-0.926662 --> -0.933329).  Saving model ...
Epoch: 13 cost time: 3.1566431522369385
Epoch: 13, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 14 cost time: 3.2834818363189697
Epoch: 14, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.345 Vali Acc: 0.927 Test Loss: 0.345 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3155436515808105
Epoch: 15, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.317 Vali Acc: 0.937 Test Loss: 0.317 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.936663).  Saving model ...
Epoch: 16 cost time: 2.9569308757781982
Epoch: 16, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.293 Vali Acc: 0.940 Test Loss: 0.293 Test Acc: 0.940
Validation loss decreased (-0.936663 --> -0.939997).  Saving model ...
Epoch: 17 cost time: 2.783658266067505
Epoch: 17, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.954761028289795
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.256 Vali Acc: 0.943 Test Loss: 0.256 Test Acc: 0.943
Validation loss decreased (-0.939997 --> -0.943331).  Saving model ...
Epoch: 19 cost time: 3.0093941688537598
Epoch: 19, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 2.8922910690307617
Epoch: 20, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 2.815608024597168
Epoch: 21, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 3.0648725032806396
Epoch: 22, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 3.208178997039795
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 24 cost time: 2.96832275390625
Epoch: 24, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7361040115356445
Epoch: 25, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 26 cost time: 3.358283758163452
Epoch: 26, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0864484310150146
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.80019474029541
Epoch: 28, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 29 cost time: 3.2968411445617676
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 30 cost time: 3.246727705001831
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 93889
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.0802671909332275
Epoch: 1, Steps: 18 | Train Loss: 3.289 Vali Loss: 3.195 Vali Acc: 0.077 Test Loss: 3.195 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 3.519253969192505
Epoch: 2, Steps: 18 | Train Loss: 3.060 Vali Loss: 2.912 Vali Acc: 0.223 Test Loss: 2.912 Test Acc: 0.223
Validation loss decreased (-0.076635 --> -0.223304).  Saving model ...
Epoch: 3 cost time: 3.424173355102539
Epoch: 3, Steps: 18 | Train Loss: 2.751 Vali Loss: 2.560 Vali Acc: 0.483 Test Loss: 2.560 Test Acc: 0.483
Validation loss decreased (-0.223304 --> -0.483308).  Saving model ...
Epoch: 4 cost time: 3.256108522415161
Epoch: 4, Steps: 18 | Train Loss: 2.381 Vali Loss: 2.175 Vali Acc: 0.703 Test Loss: 2.175 Test Acc: 0.703
Validation loss decreased (-0.483308 --> -0.703312).  Saving model ...
Epoch: 5 cost time: 3.468437433242798
Epoch: 5, Steps: 18 | Train Loss: 1.968 Vali Loss: 1.791 Vali Acc: 0.813 Test Loss: 1.791 Test Acc: 0.813
Validation loss decreased (-0.703312 --> -0.813315).  Saving model ...
Epoch: 6 cost time: 3.2608282566070557
Epoch: 6, Steps: 18 | Train Loss: 1.602 Vali Loss: 1.425 Vali Acc: 0.847 Test Loss: 1.425 Test Acc: 0.847
Validation loss decreased (-0.813315 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 2.993100643157959
Epoch: 7, Steps: 18 | Train Loss: 1.226 Vali Loss: 1.116 Vali Acc: 0.890 Test Loss: 1.116 Test Acc: 0.890
Validation loss decreased (-0.846652 --> -0.889989).  Saving model ...
Epoch: 8 cost time: 2.904431104660034
Epoch: 8, Steps: 18 | Train Loss: 0.961 Vali Loss: 0.862 Vali Acc: 0.920 Test Loss: 0.862 Test Acc: 0.920
Validation loss decreased (-0.889989 --> -0.919991).  Saving model ...
Epoch: 9 cost time: 3.301783800125122
Epoch: 9, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.679 Vali Acc: 0.927 Test Loss: 0.679 Test Acc: 0.927
Validation loss decreased (-0.919991 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 3.142627000808716
Epoch: 10, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.551 Vali Acc: 0.947 Test Loss: 0.551 Test Acc: 0.947
Validation loss decreased (-0.926660 --> -0.946661).  Saving model ...
Epoch: 11 cost time: 3.287341833114624
Epoch: 11, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.453 Vali Acc: 0.957 Test Loss: 0.453 Test Acc: 0.957
Validation loss decreased (-0.946661 --> -0.956662).  Saving model ...
Epoch: 12 cost time: 2.7854480743408203
Epoch: 12, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.388 Vali Acc: 0.960 Test Loss: 0.388 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959996).  Saving model ...
Epoch: 13 cost time: 2.772040843963623
Epoch: 13, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.335 Vali Acc: 0.963 Test Loss: 0.335 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 14 cost time: 3.5401322841644287
Epoch: 14, Steps: 18 | Train Loss: 0.217 Vali Loss: 0.293 Vali Acc: 0.970 Test Loss: 0.293 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969997).  Saving model ...
Epoch: 15 cost time: 3.2957375049591064
Epoch: 15, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2954094409942627
Epoch: 16, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.242 Vali Acc: 0.973 Test Loss: 0.242 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 17 cost time: 3.1524879932403564
Epoch: 17, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.220 Vali Acc: 0.977 Test Loss: 0.220 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976664).  Saving model ...
Epoch: 18 cost time: 2.993347644805908
Epoch: 18, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 3.1247646808624268
Epoch: 19, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8691680431365967
Epoch: 20, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 21 cost time: 3.187656879425049
Epoch: 21, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4808568954467773
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 23 cost time: 3.251020669937134
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4431939125061035
Epoch: 24, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2900218963623047
Epoch: 25, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.421023368835449
Epoch: 26, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1040706634521484
Epoch: 27, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.953575372695923
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1451327800750732
Epoch: 29, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 3.244340658187866
Epoch: 30, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 249169
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.553370952606201
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.118 Vali Acc: 0.093 Test Loss: 3.118 Test Acc: 0.093
Validation loss decreased (inf --> -0.093302).  Saving model ...
Epoch: 2 cost time: 3.0998053550720215
Epoch: 2, Steps: 18 | Train Loss: 3.027 Vali Loss: 2.859 Vali Acc: 0.243 Test Loss: 2.859 Test Acc: 0.243
Validation loss decreased (-0.093302 --> -0.243305).  Saving model ...
Epoch: 3 cost time: 2.9440419673919678
Epoch: 3, Steps: 18 | Train Loss: 2.736 Vali Loss: 2.534 Vali Acc: 0.507 Test Loss: 2.534 Test Acc: 0.507
Validation loss decreased (-0.243305 --> -0.506641).  Saving model ...
Epoch: 4 cost time: 2.9849295616149902
Epoch: 4, Steps: 18 | Train Loss: 2.383 Vali Loss: 2.164 Vali Acc: 0.700 Test Loss: 2.164 Test Acc: 0.700
Validation loss decreased (-0.506641 --> -0.699978).  Saving model ...
Epoch: 5 cost time: 3.0393290519714355
Epoch: 5, Steps: 18 | Train Loss: 1.971 Vali Loss: 1.780 Vali Acc: 0.807 Test Loss: 1.780 Test Acc: 0.807
Validation loss decreased (-0.699978 --> -0.806649).  Saving model ...
Epoch: 6 cost time: 2.7072668075561523
Epoch: 6, Steps: 18 | Train Loss: 1.555 Vali Loss: 1.409 Vali Acc: 0.867 Test Loss: 1.409 Test Acc: 0.867
Validation loss decreased (-0.806649 --> -0.866653).  Saving model ...
Epoch: 7 cost time: 3.030604600906372
Epoch: 7, Steps: 18 | Train Loss: 1.208 Vali Loss: 1.093 Vali Acc: 0.883 Test Loss: 1.093 Test Acc: 0.883
Validation loss decreased (-0.866653 --> -0.883322).  Saving model ...
Epoch: 8 cost time: 2.541254997253418
Epoch: 8, Steps: 18 | Train Loss: 0.895 Vali Loss: 0.848 Vali Acc: 0.913 Test Loss: 0.848 Test Acc: 0.913
Validation loss decreased (-0.883322 --> -0.913325).  Saving model ...
Epoch: 9 cost time: 2.7796757221221924
Epoch: 9, Steps: 18 | Train Loss: 0.684 Vali Loss: 0.672 Vali Acc: 0.917 Test Loss: 0.672 Test Acc: 0.917
Validation loss decreased (-0.913325 --> -0.916660).  Saving model ...
Epoch: 10 cost time: 2.782912254333496
Epoch: 10, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.552 Vali Acc: 0.930 Test Loss: 0.552 Test Acc: 0.930
Validation loss decreased (-0.916660 --> -0.929994).  Saving model ...
Epoch: 11 cost time: 2.98869252204895
Epoch: 11, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.471 Vali Acc: 0.933 Test Loss: 0.471 Test Acc: 0.933
Validation loss decreased (-0.929994 --> -0.933329).  Saving model ...
Epoch: 12 cost time: 3.0843355655670166
Epoch: 12, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.416 Vali Acc: 0.937 Test Loss: 0.416 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.936663).  Saving model ...
Epoch: 13 cost time: 2.8401103019714355
Epoch: 13, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0303990840911865
Epoch: 14, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8616678714752197
Epoch: 15, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.314 Vali Acc: 0.940 Test Loss: 0.314 Test Acc: 0.940
Validation loss decreased (-0.936663 --> -0.939997).  Saving model ...
Epoch: 16 cost time: 2.794888496398926
Epoch: 16, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.289 Vali Acc: 0.940 Test Loss: 0.289 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 17 cost time: 2.8627264499664307
Epoch: 17, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6938936710357666
Epoch: 18, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.252 Vali Acc: 0.940 Test Loss: 0.252 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939997).  Saving model ...
Epoch: 19 cost time: 2.8523380756378174
Epoch: 19, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.939997 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 2.565256357192993
Epoch: 20, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.230 Vali Acc: 0.953 Test Loss: 0.230 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953331).  Saving model ...
Epoch: 21 cost time: 2.2445006370544434
Epoch: 21, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 22 cost time: 2.681288719177246
Epoch: 22, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7088019847869873
Epoch: 23, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 24 cost time: 2.544461965560913
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.196 Vali Acc: 0.953 Test Loss: 0.196 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2202563285827637
Epoch: 25, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 26 cost time: 2.5051252841949463
Epoch: 26, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.976031541824341
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.028400421142578
Epoch: 28, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 29 cost time: 3.119873285293579
Epoch: 29, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 30 cost time: 2.923732042312622
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 93889
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 33.2928900718689
Epoch: 1, Steps: 18 | Train Loss: 2.853 Vali Loss: 1.629 Vali Acc: 0.887 Test Loss: 1.629 Test Acc: 0.887
Validation loss decreased (inf --> -0.886650).  Saving model ...
Epoch: 2 cost time: 34.154749631881714
Epoch: 2, Steps: 18 | Train Loss: 0.819 Vali Loss: 0.308 Vali Acc: 0.963 Test Loss: 0.308 Test Acc: 0.963
Validation loss decreased (-0.886650 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 33.06255769729614
Epoch: 3, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 31.737300634384155
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 30.56323003768921
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.00827217102051
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 33.09453892707825
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.43496823310852
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 34.79679083824158
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 34.22418570518494
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 33.68891143798828
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 33.574137687683105
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 34.12452554702759
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 33.74522042274475
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 34.25158929824829
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 32.98161864280701
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37956249
model size : 147.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.44023323059082
Epoch: 1, Steps: 18 | Train Loss: 2.839 Vali Loss: 1.660 Vali Acc: 0.870 Test Loss: 1.660 Test Acc: 0.870
Validation loss decreased (inf --> -0.869983).  Saving model ...
Epoch: 2 cost time: 9.991845846176147
Epoch: 2, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.312 Vali Acc: 0.960 Test Loss: 0.312 Test Acc: 0.960
Validation loss decreased (-0.869983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 12.824466466903687
Epoch: 3, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.936797857284546
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 13.08655834197998
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.498165130615234
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.382533311843872
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 13.455444097518921
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 12.935749053955078
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 12.648975372314453
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 12.398066520690918
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 12.399334907531738
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 11.319162845611572
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 12.062887907028198
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 11.43116569519043
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 12.100294351577759
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 11.953539848327637
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 12.11907696723938
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 11.863563060760498
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 12.310039281845093
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.126778602600098
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.13337779045105
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.598848104476929
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 12.05848479270935
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 12.312283039093018
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 12.662985563278198
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 12.959817171096802
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 12.44941234588623
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 12.205383777618408
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 11.768991947174072
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 11478169
model size : 46.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 24.802818059921265
Epoch: 1, Steps: 18 | Train Loss: 2.853 Vali Loss: 1.629 Vali Acc: 0.887 Test Loss: 1.629 Test Acc: 0.887
Validation loss decreased (inf --> -0.886650).  Saving model ...
Epoch: 2 cost time: 19.289393186569214
Epoch: 2, Steps: 18 | Train Loss: 0.819 Vali Loss: 0.308 Vali Acc: 0.963 Test Loss: 0.308 Test Acc: 0.963
Validation loss decreased (-0.886650 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 21.79670810699463
Epoch: 3, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 21.655661821365356
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 21.590351819992065
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.293403387069702
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 22.067932844161987
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.665358066558838
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.58402919769287
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.450526237487793
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 24.28376078605652
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.19224524497986
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 21.58621644973755
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 19.44401717185974
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 21.74687886238098
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.693462371826172
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37956249
model size : 147.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.363060712814331
Epoch: 1, Steps: 18 | Train Loss: 2.839 Vali Loss: 1.660 Vali Acc: 0.870 Test Loss: 1.660 Test Acc: 0.870
Validation loss decreased (inf --> -0.869983).  Saving model ...
Epoch: 2 cost time: 7.480008125305176
Epoch: 2, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.312 Vali Acc: 0.960 Test Loss: 0.312 Test Acc: 0.960
Validation loss decreased (-0.869983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 9.421881675720215
Epoch: 3, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.195854187011719
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 9.146996021270752
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.429969310760498
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.32396936416626
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 9.268085241317749
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 9.006555795669556
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 9.52110743522644
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 9.594074726104736
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 9.405055284500122
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 9.55057430267334
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 9.572518825531006
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 9.716573476791382
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 9.84369158744812
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 9.322892904281616
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 9.437318563461304
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 9.315880298614502
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 9.24263334274292
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.754291296005249
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.174926996231079
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.668416261672974
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.830337047576904
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 9.06663703918457
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 9.462469100952148
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 9.9435555934906
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 9.956273555755615
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 9.866237878799438
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 9.554553031921387
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 11478169
model size : 46.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 15.176674127578735
Epoch: 1, Steps: 18 | Train Loss: 2.853 Vali Loss: 1.629 Vali Acc: 0.887 Test Loss: 1.629 Test Acc: 0.887
Validation loss decreased (inf --> -0.886650).  Saving model ...
Epoch: 2 cost time: 13.45210599899292
Epoch: 2, Steps: 18 | Train Loss: 0.819 Vali Loss: 0.308 Vali Acc: 0.963 Test Loss: 0.308 Test Acc: 0.963
Validation loss decreased (-0.886650 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 13.746750831604004
Epoch: 3, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 15.033501148223877
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 14.901612997055054
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.531860589981079
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 13.992378234863281
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.117057085037231
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.10903525352478
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.791179656982422
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.734993934631348
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.159083843231201
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 15.051661729812622
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.905518770217896
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.790467500686646
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.793392181396484
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 37956249
model size : 147.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.979941368103027
Epoch: 1, Steps: 18 | Train Loss: 2.839 Vali Loss: 1.660 Vali Acc: 0.870 Test Loss: 1.660 Test Acc: 0.870
Validation loss decreased (inf --> -0.869983).  Saving model ...
Epoch: 2 cost time: 6.342000484466553
Epoch: 2, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.312 Vali Acc: 0.960 Test Loss: 0.312 Test Acc: 0.960
Validation loss decreased (-0.869983 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 6.183139324188232
Epoch: 3, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.029444456100464
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 6.1827898025512695
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.211395978927612
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.333442687988281
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 8 cost time: 6.354239463806152
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 9 cost time: 6.341626405715942
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 10 cost time: 6.5046796798706055
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 11 cost time: 6.462812423706055
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 6.332420825958252
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 6.055783987045288
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 6.30328369140625
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 6.186654806137085
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 6.365674018859863
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 6.208283185958862
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 5.060538053512573
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 5.681742906570435
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 5.720815181732178
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.9643285274505615
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.635416030883789
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.508962392807007
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 5.469944477081299
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 4.8780152797698975
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.789930105209351
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.3869287967681885
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.252000093460083
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.301726579666138
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.322118759155273
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 11478169
model size : 46.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 19.27994680404663
Epoch: 1, Steps: 18 | Train Loss: 2.814 Vali Loss: 1.678 Vali Acc: 0.890 Test Loss: 1.678 Test Acc: 0.890
Validation loss decreased (inf --> -0.889983).  Saving model ...
Epoch: 2 cost time: 16.730570793151855
Epoch: 2, Steps: 18 | Train Loss: 0.858 Vali Loss: 0.337 Vali Acc: 0.967 Test Loss: 0.337 Test Acc: 0.967
Validation loss decreased (-0.889983 --> -0.966663).  Saving model ...
Epoch: 3 cost time: 16.471415996551514
Epoch: 3, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.57787847518921
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.966663 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 17.09725856781006
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.503647565841675
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 18.486059427261353
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.45326280593872
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.467942237854004
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.530575037002563
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.744814157485962
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.204546213150024
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.59719204902649
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.923818826675415
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.886706352233887
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 18.526190757751465
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 19211417
model size : 75.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.547209024429321
Epoch: 1, Steps: 18 | Train Loss: 2.845 Vali Loss: 1.710 Vali Acc: 0.890 Test Loss: 1.710 Test Acc: 0.890
Validation loss decreased (inf --> -0.889983).  Saving model ...
Epoch: 2 cost time: 9.22338581085205
Epoch: 2, Steps: 18 | Train Loss: 0.871 Vali Loss: 0.354 Vali Acc: 0.967 Test Loss: 0.354 Test Acc: 0.967
Validation loss decreased (-0.889983 --> -0.966663).  Saving model ...
Epoch: 3 cost time: 8.93248200416565
Epoch: 3, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.483267307281494
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.966663 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 8.435173988342285
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 9.55100131034851
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 9.071002006530762
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.149469137191772
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 9.341026306152344
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 9.807557106018066
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 9.609282970428467
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 9.488981246948242
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 9.536346197128296
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 9.723195552825928
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 9.459181785583496
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.473884105682373
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.75625205039978
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 9.093921899795532
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 8.948588848114014
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 9.15733790397644
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.712125778198242
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.121405601501465
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.508562088012695
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 9.61470651626587
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 9.989519834518433
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.706359148025513
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 10.338390350341797
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.804242849349976
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 9.83520793914795
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 9.678034543991089
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5972121
model size : 25.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 19.392640590667725
Epoch: 1, Steps: 18 | Train Loss: 2.814 Vali Loss: 1.678 Vali Acc: 0.890 Test Loss: 1.678 Test Acc: 0.890
Validation loss decreased (inf --> -0.889983).  Saving model ...
Epoch: 2 cost time: 16.545408487319946
Epoch: 2, Steps: 18 | Train Loss: 0.858 Vali Loss: 0.337 Vali Acc: 0.967 Test Loss: 0.337 Test Acc: 0.967
Validation loss decreased (-0.889983 --> -0.966663).  Saving model ...
Epoch: 3 cost time: 15.91896390914917
Epoch: 3, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.376464128494263
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.966663 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 15.726170778274536
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.68960428237915
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 17.19911241531372
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.851709127426147
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.468169450759888
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.26566791534424
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.11346745491028
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.989304780960083
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 15.235159873962402
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.129237413406372
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.523804903030396
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.32258701324463
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 19211417
model size : 75.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.939801692962646
Epoch: 1, Steps: 18 | Train Loss: 2.845 Vali Loss: 1.710 Vali Acc: 0.890 Test Loss: 1.710 Test Acc: 0.890
Validation loss decreased (inf --> -0.889983).  Saving model ...
Epoch: 2 cost time: 7.945435523986816
Epoch: 2, Steps: 18 | Train Loss: 0.871 Vali Loss: 0.354 Vali Acc: 0.967 Test Loss: 0.354 Test Acc: 0.967
Validation loss decreased (-0.889983 --> -0.966663).  Saving model ...
Epoch: 3 cost time: 7.580439567565918
Epoch: 3, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.805417060852051
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.966663 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 8.129580020904541
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 8.342694282531738
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 7.747018575668335
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.647396802902222
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 6.15138840675354
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 7.51494288444519
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 7.560474634170532
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 7.258849143981934
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 7.287707090377808
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 7.087055206298828
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 7.724684715270996
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.470537900924683
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.550884008407593
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 7.335835218429565
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 7.812563896179199
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 8.030515909194946
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.528887510299683
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.740207672119141
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.517399549484253
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 8.502668857574463
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 7.837811231613159
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.702392339706421
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.632586479187012
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.219751596450806
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 7.8034515380859375
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 7.478169202804565
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5972121
model size : 25.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.749928951263428
Epoch: 1, Steps: 18 | Train Loss: 2.814 Vali Loss: 1.678 Vali Acc: 0.890 Test Loss: 1.678 Test Acc: 0.890
Validation loss decreased (inf --> -0.889983).  Saving model ...
Epoch: 2 cost time: 11.322033643722534
Epoch: 2, Steps: 18 | Train Loss: 0.858 Vali Loss: 0.337 Vali Acc: 0.967 Test Loss: 0.337 Test Acc: 0.967
Validation loss decreased (-0.889983 --> -0.966663).  Saving model ...
Epoch: 3 cost time: 11.584525108337402
Epoch: 3, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.119365453720093
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.966663 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 11.138980865478516
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.344611406326294
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 9.620389938354492
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.934086799621582
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.2030770778656
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.515898942947388
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.599218368530273
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.478859186172485
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.940574169158936
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.853224039077759
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.063647747039795
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.166343450546265
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 19211417
model size : 75.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.203380346298218
Epoch: 1, Steps: 18 | Train Loss: 2.845 Vali Loss: 1.710 Vali Acc: 0.890 Test Loss: 1.710 Test Acc: 0.890
Validation loss decreased (inf --> -0.889983).  Saving model ...
Epoch: 2 cost time: 5.464442253112793
Epoch: 2, Steps: 18 | Train Loss: 0.871 Vali Loss: 0.354 Vali Acc: 0.967 Test Loss: 0.354 Test Acc: 0.967
Validation loss decreased (-0.889983 --> -0.966663).  Saving model ...
Epoch: 3 cost time: 5.3577721118927
Epoch: 3, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.790692567825317
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.966663 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 5.433856248855591
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 5.835534572601318
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 6.113721609115601
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.5748021602630615
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 5.648895263671875
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 5.379519462585449
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 5.763916254043579
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 4.839278697967529
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 5.283699989318848
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 5.1828460693359375
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 5.077100038528442
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.248505353927612
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.116063117980957
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 5.265409708023071
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 5.334808111190796
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.656755208969116
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.739236831665039
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.823434114456177
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.603915214538574
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 5.696577072143555
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 5.887518405914307
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.004594087600708
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.508331298828125
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.716815233230591
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 5.316704750061035
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 4.9407312870025635
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5972121
model size : 25.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 26.04236674308777
Epoch: 1, Steps: 18 | Train Loss: 3.149 Vali Loss: 2.454 Vali Acc: 0.610 Test Loss: 2.454 Test Acc: 0.610
Validation loss decreased (inf --> -0.609975).  Saving model ...
Epoch: 2 cost time: 24.99307632446289
Epoch: 2, Steps: 18 | Train Loss: 1.718 Vali Loss: 1.000 Vali Acc: 0.930 Test Loss: 1.000 Test Acc: 0.930
Validation loss decreased (-0.609975 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 23.667398929595947
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
Validation loss decreased (-0.929990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 24.66912269592285
Epoch: 4, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979998).  Saving model ...
Epoch: 5 cost time: 24.193838357925415
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.251426458358765
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 24.7230441570282
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.906366109848022
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 25.788873195648193
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.363666534423828
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 24.53530979156494
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 25.25712299346924
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.572369813919067
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.263522148132324
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.638290405273438
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 23.778029441833496
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 25.929325580596924
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 25.177937984466553
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 27.518091201782227
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 25.52329397201538
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 24.2197482585907
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 24.509028911590576
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 25.88556456565857
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 24.49600100517273
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 24.336275577545166
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 24.989953756332397
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 24.261162042617798
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 23.252344369888306
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 25.656217336654663
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 23.922608375549316
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 18979673
model size : 73.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.386398077011108
Epoch: 1, Steps: 18 | Train Loss: 3.103 Vali Loss: 2.392 Vali Acc: 0.633 Test Loss: 2.392 Test Acc: 0.633
Validation loss decreased (inf --> -0.633309).  Saving model ...
Epoch: 2 cost time: 10.03089427947998
Epoch: 2, Steps: 18 | Train Loss: 1.680 Vali Loss: 0.972 Vali Acc: 0.940 Test Loss: 0.972 Test Acc: 0.940
Validation loss decreased (-0.633309 --> -0.939990).  Saving model ...
Epoch: 3 cost time: 11.069719314575195
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.309 Vali Acc: 0.960 Test Loss: 0.309 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 10.630112648010254
Epoch: 4, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 10.769282341003418
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.128376960754395
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.232752323150635
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.319033861160278
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.578611373901367
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.64522647857666
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.604695796966553
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.15495777130127
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.727679014205933
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.819255590438843
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5740121
model size : 23.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 19.742653608322144
Epoch: 1, Steps: 18 | Train Loss: 3.149 Vali Loss: 2.454 Vali Acc: 0.610 Test Loss: 2.454 Test Acc: 0.610
Validation loss decreased (inf --> -0.609975).  Saving model ...
Epoch: 2 cost time: 18.74392580986023
Epoch: 2, Steps: 18 | Train Loss: 1.718 Vali Loss: 1.000 Vali Acc: 0.930 Test Loss: 1.000 Test Acc: 0.930
Validation loss decreased (-0.609975 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 17.909727811813354
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
Validation loss decreased (-0.929990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 16.608692407608032
Epoch: 4, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979998).  Saving model ...
Epoch: 5 cost time: 12.798864126205444
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.592331647872925
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 16.179259777069092
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.061057806015015
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 16.119892835617065
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.705661058425903
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 18.56716513633728
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 17.591638565063477
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.70335865020752
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.890376091003418
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.226938247680664
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 18.129135608673096
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 17.734116077423096
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 18.43152618408203
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 20.219892740249634
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 18.515496492385864
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 18.605218172073364
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 18.836360454559326
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 18.52024531364441
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 18.83949565887451
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 17.127290725708008
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 16.683583974838257
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 17.107691764831543
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 17.26574993133545
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 15.405041933059692
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 16.76799201965332
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 18979673
model size : 73.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.65812349319458
Epoch: 1, Steps: 18 | Train Loss: 3.103 Vali Loss: 2.392 Vali Acc: 0.633 Test Loss: 2.392 Test Acc: 0.633
Validation loss decreased (inf --> -0.633309).  Saving model ...
Epoch: 2 cost time: 7.732037544250488
Epoch: 2, Steps: 18 | Train Loss: 1.680 Vali Loss: 0.972 Vali Acc: 0.940 Test Loss: 0.972 Test Acc: 0.940
Validation loss decreased (-0.633309 --> -0.939990).  Saving model ...
Epoch: 3 cost time: 7.023163318634033
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.309 Vali Acc: 0.960 Test Loss: 0.309 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 9.077468156814575
Epoch: 4, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 9.398629665374756
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.849216222763062
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.742079734802246
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.367666006088257
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.841846227645874
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.495141744613647
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.033405542373657
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.233465194702148
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.68847393989563
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.248630046844482
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5740121
model size : 23.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.162466764450073
Epoch: 1, Steps: 18 | Train Loss: 3.149 Vali Loss: 2.454 Vali Acc: 0.610 Test Loss: 2.454 Test Acc: 0.610
Validation loss decreased (inf --> -0.609975).  Saving model ...
Epoch: 2 cost time: 12.829588413238525
Epoch: 2, Steps: 18 | Train Loss: 1.718 Vali Loss: 1.000 Vali Acc: 0.930 Test Loss: 1.000 Test Acc: 0.930
Validation loss decreased (-0.609975 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 12.329265356063843
Epoch: 3, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.320 Vali Acc: 0.960 Test Loss: 0.320 Test Acc: 0.960
Validation loss decreased (-0.929990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 11.854055643081665
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979998).  Saving model ...
Epoch: 5 cost time: 10.361167669296265
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.455606937408447
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 11.097068786621094
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.363003730773926
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 11.784130573272705
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.463372230529785
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 11.1653311252594
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 11.29242205619812
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.194257259368896
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.874629974365234
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.438423156738281
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.836703062057495
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.464601993560791
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 11.143431425094604
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 10.81295919418335
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 11.608323574066162
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 11.530892610549927
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 12.137312889099121
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 12.360586643218994
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 12.383737087249756
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.775939226150513
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.614372491836548
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 11.429589748382568
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.527524471282959
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 11.388252973556519
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 12.27215051651001
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 18979673
model size : 73.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.552323579788208
Epoch: 1, Steps: 18 | Train Loss: 3.103 Vali Loss: 2.392 Vali Acc: 0.633 Test Loss: 2.392 Test Acc: 0.633
Validation loss decreased (inf --> -0.633309).  Saving model ...
Epoch: 2 cost time: 5.224936246871948
Epoch: 2, Steps: 18 | Train Loss: 1.680 Vali Loss: 0.972 Vali Acc: 0.940 Test Loss: 0.972 Test Acc: 0.940
Validation loss decreased (-0.633309 --> -0.939990).  Saving model ...
Epoch: 3 cost time: 5.055450201034546
Epoch: 3, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.309 Vali Acc: 0.960 Test Loss: 0.309 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 5.447925329208374
Epoch: 4, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 5.545148134231567
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.212276935577393
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.569078207015991
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.113625526428223
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.56662654876709
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.8876872062683105
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.215089559555054
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.347184419631958
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.243960857391357
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.088968753814697
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5740121
model size : 23.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 14.121135711669922
Epoch: 1, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.422 Vali Acc: 0.660 Test Loss: 2.422 Test Acc: 0.660
Validation loss decreased (inf --> -0.659976).  Saving model ...
Epoch: 2 cost time: 12.444683313369751
Epoch: 2, Steps: 18 | Train Loss: 1.711 Vali Loss: 1.025 Vali Acc: 0.937 Test Loss: 1.025 Test Acc: 0.937
Validation loss decreased (-0.659976 --> -0.936656).  Saving model ...
Epoch: 3 cost time: 11.802351236343384
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.343 Vali Acc: 0.963 Test Loss: 0.343 Test Acc: 0.963
Validation loss decreased (-0.936656 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 11.353170394897461
Epoch: 4, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
Validation loss decreased (-0.963330 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 13.635027170181274
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.391651153564453
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.820552110671997
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 13.015479803085327
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.033875226974487
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.698528528213501
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.800167083740234
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.337599992752075
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.282967805862427
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.067734718322754
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.072774171829224
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.382439374923706
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.331318616867065
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9606489
model size : 37.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.006545543670654
Epoch: 1, Steps: 18 | Train Loss: 3.065 Vali Loss: 2.393 Vali Acc: 0.590 Test Loss: 2.393 Test Acc: 0.590
Validation loss decreased (inf --> -0.589976).  Saving model ...
Epoch: 2 cost time: 5.756111145019531
Epoch: 2, Steps: 18 | Train Loss: 1.675 Vali Loss: 0.991 Vali Acc: 0.927 Test Loss: 0.991 Test Acc: 0.927
Validation loss decreased (-0.589976 --> -0.926657).  Saving model ...
Epoch: 3 cost time: 6.862560510635376
Epoch: 3, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.322 Vali Acc: 0.960 Test Loss: 0.322 Test Acc: 0.960
Validation loss decreased (-0.926657 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 6.62190842628479
Epoch: 4, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 6.780708074569702
Epoch: 5, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 6.738367319107056
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.4671008586883545
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.715272665023804
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 6.454533815383911
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.497692584991455
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.577666759490967
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.602907419204712
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.6337621212005615
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.819737195968628
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.835243463516235
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.885588645935059
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.860147476196289
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.8040454387664795
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2986585
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 12.479403257369995
Epoch: 1, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.422 Vali Acc: 0.660 Test Loss: 2.422 Test Acc: 0.660
Validation loss decreased (inf --> -0.659976).  Saving model ...
Epoch: 2 cost time: 10.456034898757935
Epoch: 2, Steps: 18 | Train Loss: 1.711 Vali Loss: 1.025 Vali Acc: 0.937 Test Loss: 1.025 Test Acc: 0.937
Validation loss decreased (-0.659976 --> -0.936656).  Saving model ...
Epoch: 3 cost time: 10.55614185333252
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.343 Vali Acc: 0.963 Test Loss: 0.343 Test Acc: 0.963
Validation loss decreased (-0.936656 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 9.29127025604248
Epoch: 4, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
Validation loss decreased (-0.963330 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 10.674896001815796
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.600044012069702
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.307126760482788
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 11.018298149108887
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.029701232910156
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.285078525543213
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.041733264923096
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.600466251373291
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.679699897766113
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.728562593460083
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.1753568649292
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.167460680007935
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.233629941940308
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9606489
model size : 37.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.093987226486206
Epoch: 1, Steps: 18 | Train Loss: 3.065 Vali Loss: 2.393 Vali Acc: 0.590 Test Loss: 2.393 Test Acc: 0.590
Validation loss decreased (inf --> -0.589976).  Saving model ...
Epoch: 2 cost time: 5.564800500869751
Epoch: 2, Steps: 18 | Train Loss: 1.675 Vali Loss: 0.991 Vali Acc: 0.927 Test Loss: 0.991 Test Acc: 0.927
Validation loss decreased (-0.589976 --> -0.926657).  Saving model ...
Epoch: 3 cost time: 5.436521053314209
Epoch: 3, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.322 Vali Acc: 0.960 Test Loss: 0.322 Test Acc: 0.960
Validation loss decreased (-0.926657 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 4.962320566177368
Epoch: 4, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 5.215794801712036
Epoch: 5, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 5.484544992446899
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.221404075622559
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.072488307952881
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 5.476771831512451
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.268751382827759
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.5729591846466064
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.903894424438477
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.258329391479492
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.929936647415161
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.0670201778411865
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.032383918762207
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.922270774841309
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.96422553062439
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2986585
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.868306636810303
Epoch: 1, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.422 Vali Acc: 0.660 Test Loss: 2.422 Test Acc: 0.660
Validation loss decreased (inf --> -0.659976).  Saving model ...
Epoch: 2 cost time: 6.792670726776123
Epoch: 2, Steps: 18 | Train Loss: 1.711 Vali Loss: 1.025 Vali Acc: 0.937 Test Loss: 1.025 Test Acc: 0.937
Validation loss decreased (-0.659976 --> -0.936656).  Saving model ...
Epoch: 3 cost time: 6.835673570632935
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.343 Vali Acc: 0.963 Test Loss: 0.343 Test Acc: 0.963
Validation loss decreased (-0.936656 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 6.9314563274383545
Epoch: 4, Steps: 18 | Train Loss: 0.154 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
Validation loss decreased (-0.963330 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 6.91187596321106
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.730011701583862
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.432035446166992
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 7.417956352233887
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.3760364055633545
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.467669725418091
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.5204808712005615
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.983317136764526
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.9268224239349365
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.054710626602173
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.040201187133789
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.648475170135498
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.784964084625244
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 9606489
model size : 37.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.851713418960571
Epoch: 1, Steps: 18 | Train Loss: 3.065 Vali Loss: 2.393 Vali Acc: 0.590 Test Loss: 2.393 Test Acc: 0.590
Validation loss decreased (inf --> -0.589976).  Saving model ...
Epoch: 2 cost time: 3.998753786087036
Epoch: 2, Steps: 18 | Train Loss: 1.675 Vali Loss: 0.991 Vali Acc: 0.927 Test Loss: 0.991 Test Acc: 0.927
Validation loss decreased (-0.589976 --> -0.926657).  Saving model ...
Epoch: 3 cost time: 3.967013359069824
Epoch: 3, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.322 Vali Acc: 0.960 Test Loss: 0.322 Test Acc: 0.960
Validation loss decreased (-0.926657 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 3.5183160305023193
Epoch: 4, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 3.786639928817749
Epoch: 5, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 3.9852163791656494
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.087157726287842
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.0174431800842285
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 3.9375436305999756
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.125707626342773
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.134528398513794
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.853219985961914
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.956749677658081
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.121715068817139
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.8895349502563477
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.8395187854766846
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.7157835960388184
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.5009098052978516
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2986585
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 10.745351076126099
Epoch: 1, Steps: 18 | Train Loss: 3.000 Vali Loss: 2.382 Vali Acc: 0.643 Test Loss: 2.382 Test Acc: 0.643
Validation loss decreased (inf --> -0.643310).  Saving model ...
Epoch: 2 cost time: 9.252264976501465
Epoch: 2, Steps: 18 | Train Loss: 1.704 Vali Loss: 1.026 Vali Acc: 0.937 Test Loss: 1.026 Test Acc: 0.937
Validation loss decreased (-0.643310 --> -0.936656).  Saving model ...
Epoch: 3 cost time: 9.544168949127197
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.382 Vali Acc: 0.947 Test Loss: 0.382 Test Acc: 0.947
Validation loss decreased (-0.936656 --> -0.946663).  Saving model ...
Epoch: 4 cost time: 10.044471740722656
Epoch: 4, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
Validation loss decreased (-0.946663 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 10.083517074584961
Epoch: 5, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 10.13707685470581
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 10.07854676246643
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.0465087890625
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 9.687490463256836
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.320630550384521
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 9.35434341430664
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 9.675029039382935
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 9.84986925125122
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 8.949471712112427
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 9.600846767425537
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 9.344524621963501
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 9.307553768157959
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.925191879272461
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 8.756510257720947
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 8.824931621551514
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 8.101468086242676
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.119544267654419
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 8.920114040374756
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 9.181649684906006
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 9.184351205825806
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 9.695066690444946
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 9.131880283355713
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 9.19662070274353
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 9.321100950241089
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 9.201775550842285
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 4919897
model size : 20.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.4008870124816895
Epoch: 1, Steps: 18 | Train Loss: 3.101 Vali Loss: 2.417 Vali Acc: 0.513 Test Loss: 2.417 Test Acc: 0.513
Validation loss decreased (inf --> -0.513309).  Saving model ...
Epoch: 2 cost time: 4.7106640338897705
Epoch: 2, Steps: 18 | Train Loss: 1.740 Vali Loss: 1.045 Vali Acc: 0.930 Test Loss: 1.045 Test Acc: 0.930
Validation loss decreased (-0.513309 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 3.922778367996216
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.370 Vali Acc: 0.963 Test Loss: 0.370 Test Acc: 0.963
Validation loss decreased (-0.929990 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 3.8849422931671143
Epoch: 4, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 4.709841012954712
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 4.676616430282593
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 4.526042699813843
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.569598436355591
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.701152801513672
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 4.762892246246338
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 4.714341640472412
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.677367687225342
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.800195217132568
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.700111627578735
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.93780779838562
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 5.20380425453186
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 5.072108507156372
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 5.090458154678345
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.943558931350708
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.820313215255737
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.0022852420806885
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.9499006271362305
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.817485809326172
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 4.794044494628906
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 4.901159763336182
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 4.737172842025757
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 5.2146384716033936
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.48623251914978
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 5.526158571243286
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.513176441192627
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1609817
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 9.685743808746338
Epoch: 1, Steps: 18 | Train Loss: 3.000 Vali Loss: 2.382 Vali Acc: 0.643 Test Loss: 2.382 Test Acc: 0.643
Validation loss decreased (inf --> -0.643310).  Saving model ...
Epoch: 2 cost time: 7.7589874267578125
Epoch: 2, Steps: 18 | Train Loss: 1.704 Vali Loss: 1.026 Vali Acc: 0.937 Test Loss: 1.026 Test Acc: 0.937
Validation loss decreased (-0.643310 --> -0.936656).  Saving model ...
Epoch: 3 cost time: 7.9598069190979
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.382 Vali Acc: 0.947 Test Loss: 0.382 Test Acc: 0.947
Validation loss decreased (-0.936656 --> -0.946663).  Saving model ...
Epoch: 4 cost time: 7.546172618865967
Epoch: 4, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
Validation loss decreased (-0.946663 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 7.247006893157959
Epoch: 5, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 6.923463582992554
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 6.011326313018799
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.386431455612183
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 6.802083730697632
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.87678599357605
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 7.178508996963501
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 7.061568737030029
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 7.133314847946167
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 7.036927938461304
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 6.842420339584351
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 7.138934373855591
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 7.130427360534668
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.950788736343384
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 6.937199354171753
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 6.862297058105469
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 7.139671325683594
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.939183473587036
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 7.132260799407959
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 7.282212257385254
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 7.6723456382751465
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 7.411559104919434
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.688464403152466
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.65038537979126
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.492857456207275
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.701539993286133
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 4919897
model size : 20.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.542052984237671
Epoch: 1, Steps: 18 | Train Loss: 3.101 Vali Loss: 2.417 Vali Acc: 0.513 Test Loss: 2.417 Test Acc: 0.513
Validation loss decreased (inf --> -0.513309).  Saving model ...
Epoch: 2 cost time: 3.8495123386383057
Epoch: 2, Steps: 18 | Train Loss: 1.740 Vali Loss: 1.045 Vali Acc: 0.930 Test Loss: 1.045 Test Acc: 0.930
Validation loss decreased (-0.513309 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 4.103353261947632
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.370 Vali Acc: 0.963 Test Loss: 0.370 Test Acc: 0.963
Validation loss decreased (-0.929990 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 4.152628183364868
Epoch: 4, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 4.087679386138916
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 3.955002546310425
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 4.103857755661011
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.269176721572876
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.2976157665252686
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 4.357339143753052
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 4.364009380340576
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.288578271865845
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.208935976028442
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.116408586502075
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.397206544876099
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 4.488077402114868
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 4.293421030044556
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 4.358148097991943
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.374598264694214
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.120936393737793
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6907076835632324
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.6180238723754883
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7603514194488525
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.59867262840271
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.7319774627685547
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.845863103866577
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.7263646125793457
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.0348169803619385
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 4.132079839706421
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.21252179145813
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1609817
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.777343034744263
Epoch: 1, Steps: 18 | Train Loss: 3.000 Vali Loss: 2.382 Vali Acc: 0.643 Test Loss: 2.382 Test Acc: 0.643
Validation loss decreased (inf --> -0.643310).  Saving model ...
Epoch: 2 cost time: 5.015295028686523
Epoch: 2, Steps: 18 | Train Loss: 1.704 Vali Loss: 1.026 Vali Acc: 0.937 Test Loss: 1.026 Test Acc: 0.937
Validation loss decreased (-0.643310 --> -0.936656).  Saving model ...
Epoch: 3 cost time: 5.088071823120117
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.382 Vali Acc: 0.947 Test Loss: 0.382 Test Acc: 0.947
Validation loss decreased (-0.936656 --> -0.946663).  Saving model ...
Epoch: 4 cost time: 4.920027017593384
Epoch: 4, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
Validation loss decreased (-0.946663 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 4.998741388320923
Epoch: 5, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 5.052983522415161
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 4.8043599128723145
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.667710781097412
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 4.618210792541504
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.530613899230957
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 4.265286445617676
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 4.242735385894775
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 3.941423177719116
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 4.289278984069824
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 4.700810194015503
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 4.8727264404296875
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 4.809627532958984
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.749032735824585
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 4.6121461391448975
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 4.756614685058594
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 4.774862051010132
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 5.208210468292236
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 5.263010740280151
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 5.122464418411255
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 4.937934637069702
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 4.4536426067352295
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.769153118133545
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.904680967330933
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.912090301513672
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 4.778402090072632
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 4919897
model size : 20.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.4632110595703125
Epoch: 1, Steps: 18 | Train Loss: 3.101 Vali Loss: 2.416 Vali Acc: 0.513 Test Loss: 2.416 Test Acc: 0.513
Validation loss decreased (inf --> -0.513309).  Saving model ...
Epoch: 2 cost time: 2.9641385078430176
Epoch: 2, Steps: 18 | Train Loss: 1.740 Vali Loss: 1.045 Vali Acc: 0.930 Test Loss: 1.045 Test Acc: 0.930
Validation loss decreased (-0.513309 --> -0.929990).  Saving model ...
Epoch: 3 cost time: 2.9681718349456787
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.369 Vali Acc: 0.963 Test Loss: 0.369 Test Acc: 0.963
Validation loss decreased (-0.929990 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 2.974235773086548
Epoch: 4, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 2.997206687927246
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 3.0318915843963623
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 2.9212498664855957
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.876635789871216
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5022099018096924
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.9181931018829346
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.9977447986602783
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9462225437164307
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.90035343170166
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.8586483001708984
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.916839122772217
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.7254724502563477
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.1352217197418213
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.8343706130981445
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.879502773284912
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.891883611679077
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9466238021850586
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.8734354972839355
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9176793098449707
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.6292192935943604
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.8313610553741455
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.864049196243286
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.189844846725464
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.249183177947998
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.3031623363494873
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.295919895172119
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1609817
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 11.358192443847656
Epoch: 1, Steps: 18 | Train Loss: 3.204 Vali Loss: 2.835 Vali Acc: 0.280 Test Loss: 2.835 Test Acc: 0.280
Validation loss decreased (inf --> -0.279972).  Saving model ...
Epoch: 2 cost time: 9.177087545394897
Epoch: 2, Steps: 18 | Train Loss: 2.385 Vali Loss: 1.841 Vali Acc: 0.840 Test Loss: 1.841 Test Acc: 0.840
Validation loss decreased (-0.279972 --> -0.839982).  Saving model ...
Epoch: 3 cost time: 9.19474720954895
Epoch: 3, Steps: 18 | Train Loss: 1.325 Vali Loss: 0.942 Vali Acc: 0.947 Test Loss: 0.942 Test Acc: 0.947
Validation loss decreased (-0.839982 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 8.896682024002075
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
Validation loss decreased (-0.946657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 8.144689321517944
Epoch: 5, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.242 Vali Acc: 0.963 Test Loss: 0.242 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.568550825119019
Epoch: 6, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
Validation loss decreased (-0.966662 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 8.482462167739868
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 8.639355182647705
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 8.443363666534424
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 8.415027141571045
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 8.896277666091919
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 6.920638799667358
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 8.542794704437256
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 8.768949508666992
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 8.71984338760376
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 7.5052385330200195
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 7.461031198501587
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 7.512742280960083
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 7.9214255809783936
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 7.958858013153076
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 7.618718385696411
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 7.955357313156128
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.169300079345703
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.383003234863281
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 9.154853343963623
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.118849992752075
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 8.603082656860352
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 8.064136266708374
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 8.084834098815918
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 8.487525463104248
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 4804025
model size : 18.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.274409055709839
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 2.857 Vali Acc: 0.273 Test Loss: 2.857 Test Acc: 0.273
Validation loss decreased (inf --> -0.273305).  Saving model ...
Epoch: 2 cost time: 4.405083656311035
Epoch: 2, Steps: 18 | Train Loss: 2.455 Vali Loss: 1.947 Vali Acc: 0.813 Test Loss: 1.947 Test Acc: 0.813
Validation loss decreased (-0.273305 --> -0.813314).  Saving model ...
Epoch: 3 cost time: 4.362962484359741
Epoch: 3, Steps: 18 | Train Loss: 1.474 Vali Loss: 1.096 Vali Acc: 0.933 Test Loss: 1.096 Test Acc: 0.933
Validation loss decreased (-0.813314 --> -0.933322).  Saving model ...
Epoch: 4 cost time: 4.324583292007446
Epoch: 4, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.551 Vali Acc: 0.947 Test Loss: 0.551 Test Acc: 0.947
Validation loss decreased (-0.933322 --> -0.946661).  Saving model ...
Epoch: 5 cost time: 4.399667263031006
Epoch: 5, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.299 Vali Acc: 0.963 Test Loss: 0.299 Test Acc: 0.963
Validation loss decreased (-0.946661 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 4.290877342224121
Epoch: 6, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 4.397714614868164
Epoch: 7, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 4.91708517074585
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 4.8731303215026855
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 4.871648073196411
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 4.513769149780273
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 4.560805559158325
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 4.435923337936401
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 4.371948957443237
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.432465553283691
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 4.631505966186523
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.767454385757446
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 4.312325716018677
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.529737710952759
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 4.3900463581085205
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.309935569763184
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.30737042427063
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.181911468505859
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.874267339706421
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.666298151016235
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.333670616149902
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.7086920738220215
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.6959428787231445
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.565062046051025
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1493817
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 8.152705669403076
Epoch: 1, Steps: 18 | Train Loss: 3.204 Vali Loss: 2.835 Vali Acc: 0.280 Test Loss: 2.835 Test Acc: 0.280
Validation loss decreased (inf --> -0.279972).  Saving model ...
Epoch: 2 cost time: 6.574893951416016
Epoch: 2, Steps: 18 | Train Loss: 2.385 Vali Loss: 1.841 Vali Acc: 0.840 Test Loss: 1.841 Test Acc: 0.840
Validation loss decreased (-0.279972 --> -0.839982).  Saving model ...
Epoch: 3 cost time: 6.922868728637695
Epoch: 3, Steps: 18 | Train Loss: 1.325 Vali Loss: 0.942 Vali Acc: 0.947 Test Loss: 0.942 Test Acc: 0.947
Validation loss decreased (-0.839982 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 6.74895453453064
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
Validation loss decreased (-0.946657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 6.155517816543579
Epoch: 5, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.242 Vali Acc: 0.963 Test Loss: 0.242 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.782856464385986
Epoch: 6, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
Validation loss decreased (-0.966662 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 6.097406625747681
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 6.320156097412109
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 6.640690088272095
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 6.492619276046753
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 6.683074474334717
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 6.059956073760986
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 5.793785810470581
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 5.9127280712127686
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 6.234087705612183
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 6.600740432739258
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 6.721262693405151
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 6.691567659378052
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 6.4941277503967285
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 6.65481424331665
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 6.646387815475464
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 6.084953308105469
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.439453363418579
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.500433921813965
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.290377140045166
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.85956597328186
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.97229790687561
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.852398157119751
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.98121190071106
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.928805589675903
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 4804025
model size : 18.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.169609308242798
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 2.857 Vali Acc: 0.273 Test Loss: 2.857 Test Acc: 0.273
Validation loss decreased (inf --> -0.273305).  Saving model ...
Epoch: 2 cost time: 3.809375286102295
Epoch: 2, Steps: 18 | Train Loss: 2.455 Vali Loss: 1.947 Vali Acc: 0.813 Test Loss: 1.947 Test Acc: 0.813
Validation loss decreased (-0.273305 --> -0.813314).  Saving model ...
Epoch: 3 cost time: 3.806171178817749
Epoch: 3, Steps: 18 | Train Loss: 1.474 Vali Loss: 1.096 Vali Acc: 0.933 Test Loss: 1.096 Test Acc: 0.933
Validation loss decreased (-0.813314 --> -0.933322).  Saving model ...
Epoch: 4 cost time: 3.9272117614746094
Epoch: 4, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.551 Vali Acc: 0.947 Test Loss: 0.551 Test Acc: 0.947
Validation loss decreased (-0.933322 --> -0.946661).  Saving model ...
Epoch: 5 cost time: 3.885389804840088
Epoch: 5, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.299 Vali Acc: 0.963 Test Loss: 0.299 Test Acc: 0.963
Validation loss decreased (-0.946661 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 3.8005969524383545
Epoch: 6, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 4.159995079040527
Epoch: 7, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 4.151121616363525
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 3.689539909362793
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 3.9094955921173096
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 3.8214735984802246
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 3.447580337524414
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.3872435092926025
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.4526522159576416
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.601881504058838
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.5492358207702637
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.176795482635498
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 3.9465010166168213
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7550840377807617
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 4.143754482269287
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.040530681610107
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.956111192703247
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.845989465713501
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.9365527629852295
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.125638008117676
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.966209650039673
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.221932888031006
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.145881652832031
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.261104583740234
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1493817
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.120543718338013
Epoch: 1, Steps: 18 | Train Loss: 3.204 Vali Loss: 2.836 Vali Acc: 0.280 Test Loss: 2.836 Test Acc: 0.280
Validation loss decreased (inf --> -0.279972).  Saving model ...
Epoch: 2 cost time: 4.090488910675049
Epoch: 2, Steps: 18 | Train Loss: 2.390 Vali Loss: 1.842 Vali Acc: 0.840 Test Loss: 1.842 Test Acc: 0.840
Validation loss decreased (-0.279972 --> -0.839982).  Saving model ...
Epoch: 3 cost time: 3.9261858463287354
Epoch: 3, Steps: 18 | Train Loss: 1.328 Vali Loss: 0.942 Vali Acc: 0.947 Test Loss: 0.942 Test Acc: 0.947
Validation loss decreased (-0.839982 --> -0.946657).  Saving model ...
Epoch: 4 cost time: 3.8230929374694824
Epoch: 4, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.433 Vali Acc: 0.967 Test Loss: 0.433 Test Acc: 0.967
Validation loss decreased (-0.946657 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 4.179788589477539
Epoch: 5, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.241 Vali Acc: 0.963 Test Loss: 0.241 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.448122978210449
Epoch: 6, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
Validation loss decreased (-0.966662 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 4.338993787765503
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 4.407517671585083
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 4.123178958892822
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 4.234392166137695
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 4.385823488235474
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 4.392718553543091
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 4.32487678527832
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.31645941734314
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.3936047554016113
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9843056201934814
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 3.368778705596924
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 4.939096212387085
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.939465522766113
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.877695322036743
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 4.829076051712036
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.83214545249939
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 4.568943023681641
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.64559531211853
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.714437246322632
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.664553642272949
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.642157554626465
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.760264873504639
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.937283515930176
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.999488592147827
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 4804025
model size : 18.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.792365312576294
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 2.857 Vali Acc: 0.273 Test Loss: 2.857 Test Acc: 0.273
Validation loss decreased (inf --> -0.273305).  Saving model ...
Epoch: 2 cost time: 3.235349178314209
Epoch: 2, Steps: 18 | Train Loss: 2.455 Vali Loss: 1.947 Vali Acc: 0.813 Test Loss: 1.947 Test Acc: 0.813
Validation loss decreased (-0.273305 --> -0.813314).  Saving model ...
Epoch: 3 cost time: 3.220335006713867
Epoch: 3, Steps: 18 | Train Loss: 1.474 Vali Loss: 1.096 Vali Acc: 0.933 Test Loss: 1.096 Test Acc: 0.933
Validation loss decreased (-0.813314 --> -0.933322).  Saving model ...
Epoch: 4 cost time: 3.0483505725860596
Epoch: 4, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.551 Vali Acc: 0.947 Test Loss: 0.551 Test Acc: 0.947
Validation loss decreased (-0.933322 --> -0.946661).  Saving model ...
Epoch: 5 cost time: 3.0927600860595703
Epoch: 5, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.299 Vali Acc: 0.963 Test Loss: 0.299 Test Acc: 0.963
Validation loss decreased (-0.946661 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 3.0391128063201904
Epoch: 6, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 3.1689460277557373
Epoch: 7, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 3.225510597229004
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 3.294060230255127
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 3.3278818130493164
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 3.2915802001953125
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 3.242652654647827
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.2952780723571777
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.3982417583465576
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 3.063126564025879
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.2102794647216797
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3074028491973877
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 3.10245943069458
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1822597980499268
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 3.314885139465332
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.362680435180664
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.270624876022339
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.348306179046631
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.255936861038208
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.1943554878234863
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.166445255279541
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.093991756439209
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.9572174549102783
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.9391582012176514
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1493817
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 7.478944778442383
Epoch: 1, Steps: 18 | Train Loss: 3.213 Vali Loss: 2.818 Vali Acc: 0.323 Test Loss: 2.818 Test Acc: 0.323
Validation loss decreased (inf --> -0.323305).  Saving model ...
Epoch: 2 cost time: 5.998863220214844
Epoch: 2, Steps: 18 | Train Loss: 2.394 Vali Loss: 1.888 Vali Acc: 0.853 Test Loss: 1.888 Test Acc: 0.853
Validation loss decreased (-0.323305 --> -0.853314).  Saving model ...
Epoch: 3 cost time: 6.2299394607543945
Epoch: 3, Steps: 18 | Train Loss: 1.425 Vali Loss: 1.025 Vali Acc: 0.933 Test Loss: 1.025 Test Acc: 0.933
Validation loss decreased (-0.853314 --> -0.933323).  Saving model ...
Epoch: 4 cost time: 6.2951343059539795
Epoch: 4, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.488 Vali Acc: 0.957 Test Loss: 0.488 Test Acc: 0.957
Validation loss decreased (-0.933323 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 6.480956792831421
Epoch: 5, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.261 Vali Acc: 0.967 Test Loss: 0.261 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 6.198260545730591
Epoch: 6, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 5.990704536437988
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 6.067218065261841
Epoch: 8, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 6.113291025161743
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 6.224639892578125
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 6.424147605895996
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 6.407813787460327
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 6.326092958450317
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 6.2283289432525635
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.986947774887085
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 5.971613883972168
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 6.078707456588745
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.242215394973755
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 6.533680200576782
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.673420190811157
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.665680408477783
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.564550876617432
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 6.1538238525390625
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 6.046360969543457
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.1961588859558105
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 6.370862007141113
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.591302394866943
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.448155403137207
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.362709999084473
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.393813371658325
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2460345
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.577696323394775
Epoch: 1, Steps: 18 | Train Loss: 3.132 Vali Loss: 2.751 Vali Acc: 0.337 Test Loss: 2.751 Test Acc: 0.337
Validation loss decreased (inf --> -0.336639).  Saving model ...
Epoch: 2 cost time: 3.6094486713409424
Epoch: 2, Steps: 18 | Train Loss: 2.357 Vali Loss: 1.841 Vali Acc: 0.857 Test Loss: 1.841 Test Acc: 0.857
Validation loss decreased (-0.336639 --> -0.856648).  Saving model ...
Epoch: 3 cost time: 3.7110469341278076
Epoch: 3, Steps: 18 | Train Loss: 1.388 Vali Loss: 0.981 Vali Acc: 0.943 Test Loss: 0.981 Test Acc: 0.943
Validation loss decreased (-0.856648 --> -0.943324).  Saving model ...
Epoch: 4 cost time: 3.802332878112793
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.461 Vali Acc: 0.967 Test Loss: 0.461 Test Acc: 0.967
Validation loss decreased (-0.943324 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 3.957615613937378
Epoch: 5, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
Validation loss decreased (-0.966662 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 3.88293719291687
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 4.016629695892334
Epoch: 7, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9660680294036865
Epoch: 8, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 4.023828029632568
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 4.017597675323486
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 3.758511781692505
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 3.698429584503174
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 3.851289749145508
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.77299165725708
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.6668076515197754
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 3.6841816902160645
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 3.191072463989258
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.883669137954712
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.757026195526123
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.8399765491485596
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.767108917236328
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.725583791732788
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.3733608722686768
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.4048831462860107
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.678203582763672
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.734516143798828
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.639968156814575
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 3.559512138366699
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.7751076221466064
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8450400829315186
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 805177
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.647746324539185
Epoch: 1, Steps: 18 | Train Loss: 3.213 Vali Loss: 2.818 Vali Acc: 0.323 Test Loss: 2.818 Test Acc: 0.323
Validation loss decreased (inf --> -0.323305).  Saving model ...
Epoch: 2 cost time: 4.307607412338257
Epoch: 2, Steps: 18 | Train Loss: 2.394 Vali Loss: 1.888 Vali Acc: 0.853 Test Loss: 1.888 Test Acc: 0.853
Validation loss decreased (-0.323305 --> -0.853314).  Saving model ...
Epoch: 3 cost time: 4.591763973236084
Epoch: 3, Steps: 18 | Train Loss: 1.425 Vali Loss: 1.025 Vali Acc: 0.933 Test Loss: 1.025 Test Acc: 0.933
Validation loss decreased (-0.853314 --> -0.933323).  Saving model ...
Epoch: 4 cost time: 4.523962020874023
Epoch: 4, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.488 Vali Acc: 0.957 Test Loss: 0.488 Test Acc: 0.957
Validation loss decreased (-0.933323 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 4.448378086090088
Epoch: 5, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.261 Vali Acc: 0.967 Test Loss: 0.261 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 4.426831007003784
Epoch: 6, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 4.498939275741577
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 4.965038299560547
Epoch: 8, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 5.050583362579346
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 4.99639105796814
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 5.00352144241333
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 4.841176271438599
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 4.940490484237671
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 5.129889249801636
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.021127462387085
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 4.894132852554321
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 5.108232021331787
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.365393877029419
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 5.18603515625
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.160561800003052
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.444708824157715
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.1822731494903564
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 5.12192440032959
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 5.1527793407440186
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.848309516906738
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 4.676348447799683
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.141103267669678
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.194195508956909
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.401323318481445
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.996006727218628
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2460345
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.264249801635742
Epoch: 1, Steps: 18 | Train Loss: 3.132 Vali Loss: 2.751 Vali Acc: 0.337 Test Loss: 2.751 Test Acc: 0.337
Validation loss decreased (inf --> -0.336639).  Saving model ...
Epoch: 2 cost time: 3.184730291366577
Epoch: 2, Steps: 18 | Train Loss: 2.357 Vali Loss: 1.841 Vali Acc: 0.857 Test Loss: 1.841 Test Acc: 0.857
Validation loss decreased (-0.336639 --> -0.856648).  Saving model ...
Epoch: 3 cost time: 3.0888590812683105
Epoch: 3, Steps: 18 | Train Loss: 1.388 Vali Loss: 0.981 Vali Acc: 0.943 Test Loss: 0.981 Test Acc: 0.943
Validation loss decreased (-0.856648 --> -0.943324).  Saving model ...
Epoch: 4 cost time: 3.281991720199585
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.461 Vali Acc: 0.967 Test Loss: 0.461 Test Acc: 0.967
Validation loss decreased (-0.943324 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 3.189797878265381
Epoch: 5, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
Validation loss decreased (-0.966662 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 3.1193790435791016
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 3.2563188076019287
Epoch: 7, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.171344518661499
Epoch: 8, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 3.281867027282715
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 3.171973943710327
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 3.171355724334717
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.990485668182373
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 3.159895896911621
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.2105703353881836
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.248811960220337
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.850918769836426
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.8992183208465576
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 3.050593614578247
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.0932984352111816
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.8964009284973145
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.9807097911834717
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.1728951930999756
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.9701101779937744
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.753178834915161
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.0284411907196045
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9132940769195557
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.927949905395508
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 3.043165922164917
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.7659521102905273
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.8781628608703613
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 805177
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.072668790817261
Epoch: 1, Steps: 18 | Train Loss: 3.213 Vali Loss: 2.818 Vali Acc: 0.323 Test Loss: 2.818 Test Acc: 0.323
Validation loss decreased (inf --> -0.323305).  Saving model ...
Epoch: 2 cost time: 3.670341730117798
Epoch: 2, Steps: 18 | Train Loss: 2.394 Vali Loss: 1.888 Vali Acc: 0.853 Test Loss: 1.888 Test Acc: 0.853
Validation loss decreased (-0.323305 --> -0.853314).  Saving model ...
Epoch: 3 cost time: 3.6528637409210205
Epoch: 3, Steps: 18 | Train Loss: 1.425 Vali Loss: 1.025 Vali Acc: 0.933 Test Loss: 1.025 Test Acc: 0.933
Validation loss decreased (-0.853314 --> -0.933323).  Saving model ...
Epoch: 4 cost time: 3.5851783752441406
Epoch: 4, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.488 Vali Acc: 0.957 Test Loss: 0.488 Test Acc: 0.957
Validation loss decreased (-0.933323 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 3.369671583175659
Epoch: 5, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.261 Vali Acc: 0.967 Test Loss: 0.261 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 3.894808292388916
Epoch: 6, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 3.5561814308166504
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 3.614814519882202
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 3.5105600357055664
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 3.5280086994171143
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 3.5112032890319824
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 3.5313122272491455
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.4931671619415283
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.8567354679107666
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.614689588546753
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.292668342590332
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.7819859981536865
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6920785903930664
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 3.572628974914551
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6858644485473633
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4584600925445557
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6205251216888428
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.5348222255706787
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 3.548806667327881
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4620072841644287
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 3.1987102031707764
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.10713529586792
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6833951473236084
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6503777503967285
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.828734874725342
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2460345
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.615509033203125
Epoch: 1, Steps: 18 | Train Loss: 3.131 Vali Loss: 2.751 Vali Acc: 0.337 Test Loss: 2.751 Test Acc: 0.337
Validation loss decreased (inf --> -0.336639).  Saving model ...
Epoch: 2 cost time: 2.696645498275757
Epoch: 2, Steps: 18 | Train Loss: 2.357 Vali Loss: 1.841 Vali Acc: 0.857 Test Loss: 1.841 Test Acc: 0.857
Validation loss decreased (-0.336639 --> -0.856648).  Saving model ...
Epoch: 3 cost time: 2.479071855545044
Epoch: 3, Steps: 18 | Train Loss: 1.389 Vali Loss: 0.981 Vali Acc: 0.943 Test Loss: 0.981 Test Acc: 0.943
Validation loss decreased (-0.856648 --> -0.943324).  Saving model ...
Epoch: 4 cost time: 2.5122244358062744
Epoch: 4, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.460 Vali Acc: 0.967 Test Loss: 0.460 Test Acc: 0.967
Validation loss decreased (-0.943324 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 2.548135995864868
Epoch: 5, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.251 Vali Acc: 0.973 Test Loss: 0.251 Test Acc: 0.973
Validation loss decreased (-0.966662 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 2.6540794372558594
Epoch: 6, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 2.605654716491699
Epoch: 7, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4436986446380615
Epoch: 8, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5134103298187256
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.3887462615966797
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.1249420642852783
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.507572650909424
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 2.6777491569519043
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.568296432495117
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.6208198070526123
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.408682107925415
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.419410228729248
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.3414297103881836
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.009253740310669
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.465782403945923
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.6949379444122314
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.772062301635742
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.7341508865356445
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.595533847808838
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.6623005867004395
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6387195587158203
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.589031934738159
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.4693245887756348
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6592509746551514
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.664773464202881
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 805177
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.174278259277344
Epoch: 1, Steps: 18 | Train Loss: 3.197 Vali Loss: 2.850 Vali Acc: 0.223 Test Loss: 2.850 Test Acc: 0.223
Validation loss decreased (inf --> -0.223305).  Saving model ...
Epoch: 2 cost time: 4.07402777671814
Epoch: 2, Steps: 18 | Train Loss: 2.406 Vali Loss: 1.927 Vali Acc: 0.820 Test Loss: 1.927 Test Acc: 0.820
Validation loss decreased (-0.223305 --> -0.819981).  Saving model ...
Epoch: 3 cost time: 3.8182027339935303
Epoch: 3, Steps: 18 | Train Loss: 1.433 Vali Loss: 1.068 Vali Acc: 0.913 Test Loss: 1.068 Test Acc: 0.913
Validation loss decreased (-0.819981 --> -0.913323).  Saving model ...
Epoch: 4 cost time: 4.018841743469238
Epoch: 4, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.913323 --> -0.949995).  Saving model ...
Epoch: 5 cost time: 4.527647495269775
Epoch: 5, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.291 Vali Acc: 0.963 Test Loss: 0.291 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 4.189133882522583
Epoch: 6, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 4.231447458267212
Epoch: 7, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 4.078787565231323
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 4.225383758544922
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.497512340545654
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 4.501251459121704
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 3.923862934112549
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 3.596958875656128
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 4.109231233596802
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 4.117769718170166
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 4.423370599746704
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.425333023071289
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.19004487991333
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.188043594360352
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.107744455337524
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.994051456451416
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9622457027435303
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.2646355628967285
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.137385845184326
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 3.00995135307312
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 4.236023426055908
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.748779296875
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.6562275886535645
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 4.424683094024658
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.420786380767822
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1288505
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.090946912765503
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.843 Vali Acc: 0.253 Test Loss: 2.843 Test Acc: 0.253
Validation loss decreased (inf --> -0.253305).  Saving model ...
Epoch: 2 cost time: 3.050328016281128
Epoch: 2, Steps: 18 | Train Loss: 2.436 Vali Loss: 1.921 Vali Acc: 0.803 Test Loss: 1.921 Test Acc: 0.803
Validation loss decreased (-0.253305 --> -0.803314).  Saving model ...
Epoch: 3 cost time: 3.0557093620300293
Epoch: 3, Steps: 18 | Train Loss: 1.470 Vali Loss: 1.086 Vali Acc: 0.943 Test Loss: 1.086 Test Acc: 0.943
Validation loss decreased (-0.803314 --> -0.943322).  Saving model ...
Epoch: 4 cost time: 2.8206136226654053
Epoch: 4, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.544 Vali Acc: 0.960 Test Loss: 0.544 Test Acc: 0.960
Validation loss decreased (-0.943322 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 2.8137669563293457
Epoch: 5, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.306 Vali Acc: 0.957 Test Loss: 0.306 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8643596172332764
Epoch: 6, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.959995 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 2.873080253601074
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 2.768247365951538
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.022063732147217
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 2.9324631690979004
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.035733222961426
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.922898292541504
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.7989425659179688
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.8716013431549072
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.8463382720947266
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.943463087081909
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.1444334983825684
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 3.0994980335235596
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 3.0810775756835938
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.270134687423706
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.9164018630981445
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.8558242321014404
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.8340439796447754
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.9146392345428467
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 3.081087350845337
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0095129013061523
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 3.034933090209961
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.537334680557251
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.8544881343841553
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 2.13968563079834
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 460857
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.198367595672607
Epoch: 1, Steps: 18 | Train Loss: 3.197 Vali Loss: 2.850 Vali Acc: 0.223 Test Loss: 2.850 Test Acc: 0.223
Validation loss decreased (inf --> -0.223305).  Saving model ...
Epoch: 2 cost time: 4.38930344581604
Epoch: 2, Steps: 18 | Train Loss: 2.406 Vali Loss: 1.927 Vali Acc: 0.820 Test Loss: 1.927 Test Acc: 0.820
Validation loss decreased (-0.223305 --> -0.819981).  Saving model ...
Epoch: 3 cost time: 4.583252191543579
Epoch: 3, Steps: 18 | Train Loss: 1.433 Vali Loss: 1.068 Vali Acc: 0.913 Test Loss: 1.068 Test Acc: 0.913
Validation loss decreased (-0.819981 --> -0.913323).  Saving model ...
Epoch: 4 cost time: 4.603704214096069
Epoch: 4, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.913323 --> -0.949995).  Saving model ...
Epoch: 5 cost time: 4.541694641113281
Epoch: 5, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.291 Vali Acc: 0.963 Test Loss: 0.291 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 4.638949394226074
Epoch: 6, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 4.9074318408966064
Epoch: 7, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 4.860818862915039
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 4.979580640792847
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.070918798446655
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 4.941760063171387
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 4.944493532180786
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 5.0398640632629395
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 5.054693222045898
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 4.840784549713135
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 4.737159967422485
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.749171495437622
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.760392189025879
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.592738389968872
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.586672782897949
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 4.756932020187378
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.919456720352173
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 4.882904291152954
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.707062005996704
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 4.8156657218933105
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 4.84065055847168
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.8130714893341064
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.846061944961548
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 4.6403117179870605
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.936392545700073
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1288505
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.649526834487915
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.843 Vali Acc: 0.253 Test Loss: 2.843 Test Acc: 0.253
Validation loss decreased (inf --> -0.253305).  Saving model ...
Epoch: 2 cost time: 3.6271865367889404
Epoch: 2, Steps: 18 | Train Loss: 2.436 Vali Loss: 1.921 Vali Acc: 0.803 Test Loss: 1.921 Test Acc: 0.803
Validation loss decreased (-0.253305 --> -0.803314).  Saving model ...
Epoch: 3 cost time: 3.49076771736145
Epoch: 3, Steps: 18 | Train Loss: 1.470 Vali Loss: 1.086 Vali Acc: 0.943 Test Loss: 1.086 Test Acc: 0.943
Validation loss decreased (-0.803314 --> -0.943322).  Saving model ...
Epoch: 4 cost time: 3.5029027462005615
Epoch: 4, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.544 Vali Acc: 0.960 Test Loss: 0.544 Test Acc: 0.960
Validation loss decreased (-0.943322 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 3.5601212978363037
Epoch: 5, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.306 Vali Acc: 0.957 Test Loss: 0.306 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.561321258544922
Epoch: 6, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.959995 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 3.548583507537842
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 3.67437744140625
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7814526557922363
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 3.622893810272217
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6357033252716064
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 3.7489640712738037
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.5265369415283203
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.52862286567688
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 3.178809642791748
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.2088253498077393
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.2183988094329834
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 3.1909682750701904
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 3.119976282119751
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 3.1259970664978027
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.1990528106689453
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 3.2572290897369385
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.1829745769500732
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.9535152912139893
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 3.1592464447021484
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.391493082046509
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 3.3533194065093994
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.498565196990967
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 3.337991714477539
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 3.5997328758239746
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 460857
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.7250306606292725
Epoch: 1, Steps: 18 | Train Loss: 3.197 Vali Loss: 2.850 Vali Acc: 0.223 Test Loss: 2.850 Test Acc: 0.223
Validation loss decreased (inf --> -0.223305).  Saving model ...
Epoch: 2 cost time: 3.8619048595428467
Epoch: 2, Steps: 18 | Train Loss: 2.406 Vali Loss: 1.926 Vali Acc: 0.820 Test Loss: 1.926 Test Acc: 0.820
Validation loss decreased (-0.223305 --> -0.819981).  Saving model ...
Epoch: 3 cost time: 3.896817445755005
Epoch: 3, Steps: 18 | Train Loss: 1.433 Vali Loss: 1.068 Vali Acc: 0.913 Test Loss: 1.068 Test Acc: 0.913
Validation loss decreased (-0.819981 --> -0.913323).  Saving model ...
Epoch: 4 cost time: 3.8483057022094727
Epoch: 4, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.913323 --> -0.949995).  Saving model ...
Epoch: 5 cost time: 3.8307101726531982
Epoch: 5, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.291 Vali Acc: 0.963 Test Loss: 0.291 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 3.742518663406372
Epoch: 6, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 3.632317304611206
Epoch: 7, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 3.6577417850494385
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 3.5288748741149902
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6053192615509033
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 3.509199619293213
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 3.523879289627075
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 3.4353737831115723
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 3.62439227104187
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.516491413116455
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.508545160293579
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.558962345123291
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.600989818572998
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6817269325256348
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.547407627105713
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.5080580711364746
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7134463787078857
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.847195863723755
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6262402534484863
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 3.651777982711792
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 3.868335008621216
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.563920736312866
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5263712406158447
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 3.5653903484344482
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6176865100860596
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1288505
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.686391592025757
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.843 Vali Acc: 0.253 Test Loss: 2.843 Test Acc: 0.253
Validation loss decreased (inf --> -0.253305).  Saving model ...
Epoch: 2 cost time: 2.0637457370758057
Epoch: 2, Steps: 18 | Train Loss: 2.436 Vali Loss: 1.921 Vali Acc: 0.803 Test Loss: 1.921 Test Acc: 0.803
Validation loss decreased (-0.253305 --> -0.803314).  Saving model ...
Epoch: 3 cost time: 2.11486554145813
Epoch: 3, Steps: 18 | Train Loss: 1.470 Vali Loss: 1.086 Vali Acc: 0.943 Test Loss: 1.086 Test Acc: 0.943
Validation loss decreased (-0.803314 --> -0.943322).  Saving model ...
Epoch: 4 cost time: 2.2074310779571533
Epoch: 4, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.544 Vali Acc: 0.960 Test Loss: 0.544 Test Acc: 0.960
Validation loss decreased (-0.943322 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 2.182901620864868
Epoch: 5, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.306 Vali Acc: 0.957 Test Loss: 0.306 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2294235229492188
Epoch: 6, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.959995 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 2.0708186626434326
Epoch: 7, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 2.09736967086792
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9804952144622803
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.7444899082183838
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.003549814224243
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.111994981765747
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.0396738052368164
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.0346713066101074
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.066781759262085
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.0913403034210205
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.916835069656372
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.9920375347137451
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.102487325668335
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.1366524696350098
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.0468878746032715
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.2047038078308105
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.201077699661255
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.256169080734253
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.217538356781006
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0554046630859375
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 2.063788652420044
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9869272708892822
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.0997557640075684
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8430919647216797
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 460857
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.444502115249634
Epoch: 1, Steps: 18 | Train Loss: 3.209 Vali Loss: 3.013 Vali Acc: 0.157 Test Loss: 3.013 Test Acc: 0.157
Validation loss decreased (inf --> -0.156637).  Saving model ...
Epoch: 2 cost time: 5.436997413635254
Epoch: 2, Steps: 18 | Train Loss: 2.801 Vali Loss: 2.497 Vali Acc: 0.580 Test Loss: 2.497 Test Acc: 0.580
Validation loss decreased (-0.156637 --> -0.579975).  Saving model ...
Epoch: 3 cost time: 5.611210584640503
Epoch: 3, Steps: 18 | Train Loss: 2.175 Vali Loss: 1.905 Vali Acc: 0.847 Test Loss: 1.905 Test Acc: 0.847
Validation loss decreased (-0.579975 --> -0.846648).  Saving model ...
Epoch: 4 cost time: 5.823540687561035
Epoch: 4, Steps: 18 | Train Loss: 1.561 Vali Loss: 1.314 Vali Acc: 0.933 Test Loss: 1.314 Test Acc: 0.933
Validation loss decreased (-0.846648 --> -0.933320).  Saving model ...
Epoch: 5 cost time: 5.566877365112305
Epoch: 5, Steps: 18 | Train Loss: 0.983 Vali Loss: 0.827 Vali Acc: 0.953 Test Loss: 0.827 Test Acc: 0.953
Validation loss decreased (-0.933320 --> -0.953325).  Saving model ...
Epoch: 6 cost time: 5.597261905670166
Epoch: 6, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.511 Vali Acc: 0.957 Test Loss: 0.511 Test Acc: 0.957
Validation loss decreased (-0.953325 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 5.5993971824646
Epoch: 7, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.349 Vali Acc: 0.953 Test Loss: 0.349 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.752135515213013
Epoch: 8, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.264 Vali Acc: 0.963 Test Loss: 0.264 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 5.888098478317261
Epoch: 9, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 5.490650415420532
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 5.341683864593506
Epoch: 11, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 5.028998136520386
Epoch: 12, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 5.129713773727417
Epoch: 13, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 5.264648914337158
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 5.28472113609314
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 5.382103681564331
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 5.907322883605957
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 5.67423415184021
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 5.890618085861206
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 5.834350109100342
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 5.820370197296143
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 5.7228381633758545
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 5.870961427688599
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 5.3745434284210205
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.501014471054077
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.516734838485718
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 5.547893285751343
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 5.127970457077026
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.208852529525757
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.462585926055908
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1230569
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.5237226486206055
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 3.057 Vali Acc: 0.157 Test Loss: 3.057 Test Acc: 0.157
Validation loss decreased (inf --> -0.156636).  Saving model ...
Epoch: 2 cost time: 3.2276792526245117
Epoch: 2, Steps: 18 | Train Loss: 2.821 Vali Loss: 2.549 Vali Acc: 0.493 Test Loss: 2.549 Test Acc: 0.493
Validation loss decreased (-0.156636 --> -0.493308).  Saving model ...
Epoch: 3 cost time: 3.269497871398926
Epoch: 3, Steps: 18 | Train Loss: 2.272 Vali Loss: 1.950 Vali Acc: 0.717 Test Loss: 1.950 Test Acc: 0.717
Validation loss decreased (-0.493308 --> -0.716647).  Saving model ...
Epoch: 4 cost time: 3.270988941192627
Epoch: 4, Steps: 18 | Train Loss: 1.612 Vali Loss: 1.367 Vali Acc: 0.877 Test Loss: 1.367 Test Acc: 0.877
Validation loss decreased (-0.716647 --> -0.876653).  Saving model ...
Epoch: 5 cost time: 3.2489798069000244
Epoch: 5, Steps: 18 | Train Loss: 1.058 Vali Loss: 0.892 Vali Acc: 0.930 Test Loss: 0.892 Test Acc: 0.930
Validation loss decreased (-0.876653 --> -0.929991).  Saving model ...
Epoch: 6 cost time: 3.201059341430664
Epoch: 6, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.929991 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 3.3409175872802734
Epoch: 7, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.378 Vali Acc: 0.967 Test Loss: 0.378 Test Acc: 0.967
Validation loss decreased (-0.949994 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 3.3103973865509033
Epoch: 8, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 3.1040186882019043
Epoch: 9, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.048823595046997
Epoch: 10, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 11 cost time: 2.716284990310669
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.173 Vali Acc: 0.977 Test Loss: 0.173 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.2863974571228027
Epoch: 12, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 2.239992141723633
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 2.941786289215088
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 3.082085132598877
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 3.103247880935669
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.7750539779663086
Epoch: 17, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 3.1999094486236572
Epoch: 18, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.1876871585845947
Epoch: 19, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.1986961364746094
Epoch: 20, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.903294324874878
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.2022526264190674
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.3446338176727295
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.182122230529785
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.317308187484741
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.097903251647949
Epoch: 26, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.3449063301086426
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 3.1716504096984863
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.3595407009124756
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 3.3197104930877686
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 402857
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.336480617523193
Epoch: 1, Steps: 18 | Train Loss: 3.209 Vali Loss: 3.013 Vali Acc: 0.157 Test Loss: 3.013 Test Acc: 0.157
Validation loss decreased (inf --> -0.156637).  Saving model ...
Epoch: 2 cost time: 3.979478120803833
Epoch: 2, Steps: 18 | Train Loss: 2.801 Vali Loss: 2.497 Vali Acc: 0.580 Test Loss: 2.497 Test Acc: 0.580
Validation loss decreased (-0.156637 --> -0.579975).  Saving model ...
Epoch: 3 cost time: 4.274509429931641
Epoch: 3, Steps: 18 | Train Loss: 2.175 Vali Loss: 1.905 Vali Acc: 0.847 Test Loss: 1.905 Test Acc: 0.847
Validation loss decreased (-0.579975 --> -0.846648).  Saving model ...
Epoch: 4 cost time: 4.540272235870361
Epoch: 4, Steps: 18 | Train Loss: 1.561 Vali Loss: 1.314 Vali Acc: 0.933 Test Loss: 1.314 Test Acc: 0.933
Validation loss decreased (-0.846648 --> -0.933320).  Saving model ...
Epoch: 5 cost time: 4.503526926040649
Epoch: 5, Steps: 18 | Train Loss: 0.983 Vali Loss: 0.827 Vali Acc: 0.953 Test Loss: 0.827 Test Acc: 0.953
Validation loss decreased (-0.933320 --> -0.953325).  Saving model ...
Epoch: 6 cost time: 4.488427639007568
Epoch: 6, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.511 Vali Acc: 0.957 Test Loss: 0.511 Test Acc: 0.957
Validation loss decreased (-0.953325 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 4.528884172439575
Epoch: 7, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.349 Vali Acc: 0.953 Test Loss: 0.349 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.647215127944946
Epoch: 8, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.264 Vali Acc: 0.963 Test Loss: 0.264 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 4.5769453048706055
Epoch: 9, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 4.523306131362915
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 4.536774158477783
Epoch: 11, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 4.56577205657959
Epoch: 12, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 4.28400731086731
Epoch: 13, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 4.165444850921631
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 4.346796274185181
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 4.095310926437378
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 4.191124677658081
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 4.406497478485107
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 4.306471586227417
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 4.531750917434692
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 4.578831672668457
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 4.60231876373291
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 4.574759244918823
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 4.5705626010894775
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.468286991119385
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.390423536300659
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 4.473450183868408
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 4.502780199050903
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.7701845169067383
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.073281526565552
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1230569
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.980825424194336
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 3.057 Vali Acc: 0.157 Test Loss: 3.057 Test Acc: 0.157
Validation loss decreased (inf --> -0.156636).  Saving model ...
Epoch: 2 cost time: 2.746123790740967
Epoch: 2, Steps: 18 | Train Loss: 2.821 Vali Loss: 2.549 Vali Acc: 0.493 Test Loss: 2.549 Test Acc: 0.493
Validation loss decreased (-0.156636 --> -0.493308).  Saving model ...
Epoch: 3 cost time: 2.700871229171753
Epoch: 3, Steps: 18 | Train Loss: 2.272 Vali Loss: 1.950 Vali Acc: 0.717 Test Loss: 1.950 Test Acc: 0.717
Validation loss decreased (-0.493308 --> -0.716647).  Saving model ...
Epoch: 4 cost time: 2.203789472579956
Epoch: 4, Steps: 18 | Train Loss: 1.612 Vali Loss: 1.367 Vali Acc: 0.877 Test Loss: 1.367 Test Acc: 0.877
Validation loss decreased (-0.716647 --> -0.876653).  Saving model ...
Epoch: 5 cost time: 2.8613133430480957
Epoch: 5, Steps: 18 | Train Loss: 1.058 Vali Loss: 0.892 Vali Acc: 0.930 Test Loss: 0.892 Test Acc: 0.930
Validation loss decreased (-0.876653 --> -0.929991).  Saving model ...
Epoch: 6 cost time: 2.915177822113037
Epoch: 6, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.929991 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 2.7113747596740723
Epoch: 7, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.378 Vali Acc: 0.967 Test Loss: 0.378 Test Acc: 0.967
Validation loss decreased (-0.949994 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 2.4409430027008057
Epoch: 8, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 2.837959051132202
Epoch: 9, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.87725830078125
Epoch: 10, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 11 cost time: 2.570946455001831
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.173 Vali Acc: 0.977 Test Loss: 0.173 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.363518238067627
Epoch: 12, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 2.8624768257141113
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 2.8864619731903076
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 2.6104695796966553
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 2.556049108505249
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.658609390258789
Epoch: 17, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.684067964553833
Epoch: 18, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.37467885017395
Epoch: 19, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.1237685680389404
Epoch: 20, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.7243475914001465
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.877967596054077
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.5298876762390137
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.4497063159942627
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.853224277496338
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.8898401260375977
Epoch: 26, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.7002432346343994
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.5485448837280273
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.9543187618255615
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 2.935408353805542
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 402857
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.085544586181641
Epoch: 1, Steps: 18 | Train Loss: 3.209 Vali Loss: 3.014 Vali Acc: 0.160 Test Loss: 3.014 Test Acc: 0.160
Validation loss decreased (inf --> -0.159970).  Saving model ...
Epoch: 2 cost time: 3.1028993129730225
Epoch: 2, Steps: 18 | Train Loss: 2.803 Vali Loss: 2.500 Vali Acc: 0.580 Test Loss: 2.500 Test Acc: 0.580
Validation loss decreased (-0.159970 --> -0.579975).  Saving model ...
Epoch: 3 cost time: 3.236854314804077
Epoch: 3, Steps: 18 | Train Loss: 2.181 Vali Loss: 1.910 Vali Acc: 0.847 Test Loss: 1.910 Test Acc: 0.847
Validation loss decreased (-0.579975 --> -0.846648).  Saving model ...
Epoch: 4 cost time: 3.1693098545074463
Epoch: 4, Steps: 18 | Train Loss: 1.572 Vali Loss: 1.319 Vali Acc: 0.933 Test Loss: 1.319 Test Acc: 0.933
Validation loss decreased (-0.846648 --> -0.933320).  Saving model ...
Epoch: 5 cost time: 3.0661838054656982
Epoch: 5, Steps: 18 | Train Loss: 0.995 Vali Loss: 0.827 Vali Acc: 0.953 Test Loss: 0.827 Test Acc: 0.953
Validation loss decreased (-0.933320 --> -0.953325).  Saving model ...
Epoch: 6 cost time: 3.0934181213378906
Epoch: 6, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.505 Vali Acc: 0.957 Test Loss: 0.505 Test Acc: 0.957
Validation loss decreased (-0.953325 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 3.1111226081848145
Epoch: 7, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.338 Vali Acc: 0.960 Test Loss: 0.338 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 3.1415982246398926
Epoch: 8, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.252 Vali Acc: 0.967 Test Loss: 0.252 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 2.9847378730773926
Epoch: 9, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 3.0804858207702637
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 2.971184015274048
Epoch: 11, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 3.283578634262085
Epoch: 12, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 3.140279531478882
Epoch: 13, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 3.1788997650146484
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.2689731121063232
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 3.18621563911438
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 3.2422139644622803
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 3.1507973670959473
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 3.1325690746307373
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 3.218688488006592
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 3.34428334236145
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 3.365675210952759
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.227022409439087
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 3.210941791534424
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.261470317840576
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 2.344299077987671
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 3.063105583190918
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 3.1916511058807373
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.90030837059021
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 3.1051440238952637
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1230569
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.23836088180542
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 3.057 Vali Acc: 0.157 Test Loss: 3.057 Test Acc: 0.157
Validation loss decreased (inf --> -0.156636).  Saving model ...
Epoch: 2 cost time: 2.3915457725524902
Epoch: 2, Steps: 18 | Train Loss: 2.822 Vali Loss: 2.549 Vali Acc: 0.493 Test Loss: 2.549 Test Acc: 0.493
Validation loss decreased (-0.156636 --> -0.493308).  Saving model ...
Epoch: 3 cost time: 2.309382677078247
Epoch: 3, Steps: 18 | Train Loss: 2.274 Vali Loss: 1.951 Vali Acc: 0.717 Test Loss: 1.951 Test Acc: 0.717
Validation loss decreased (-0.493308 --> -0.716647).  Saving model ...
Epoch: 4 cost time: 2.25939679145813
Epoch: 4, Steps: 18 | Train Loss: 1.616 Vali Loss: 1.369 Vali Acc: 0.877 Test Loss: 1.369 Test Acc: 0.877
Validation loss decreased (-0.716647 --> -0.876653).  Saving model ...
Epoch: 5 cost time: 2.3562707901000977
Epoch: 5, Steps: 18 | Train Loss: 1.063 Vali Loss: 0.893 Vali Acc: 0.930 Test Loss: 0.893 Test Acc: 0.930
Validation loss decreased (-0.876653 --> -0.929991).  Saving model ...
Epoch: 6 cost time: 2.2780234813690186
Epoch: 6, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.559 Vali Acc: 0.950 Test Loss: 0.559 Test Acc: 0.950
Validation loss decreased (-0.929991 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 2.403388738632202
Epoch: 7, Steps: 18 | Train Loss: 0.365 Vali Loss: 0.378 Vali Acc: 0.967 Test Loss: 0.378 Test Acc: 0.967
Validation loss decreased (-0.949994 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 2.2300219535827637
Epoch: 8, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 2.1892309188842773
Epoch: 9, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.135544538497925
Epoch: 10, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 11 cost time: 2.2315897941589355
Epoch: 11, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.173 Vali Acc: 0.977 Test Loss: 0.173 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.34256649017334
Epoch: 12, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 2.288381814956665
Epoch: 13, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 2.2882134914398193
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 2.3646328449249268
Epoch: 15, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 2.184318780899048
Epoch: 16, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.178619384765625
Epoch: 17, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.9290733337402344
Epoch: 18, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.1995737552642822
Epoch: 19, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.1772282123565674
Epoch: 20, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.013902425765991
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.1693530082702637
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1767399311065674
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.090222120285034
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.1484081745147705
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.0941078662872314
Epoch: 26, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.040513038635254
Epoch: 27, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 2.2004616260528564
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.234924554824829
Epoch: 29, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2125539779663086
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 402857
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.756811857223511
Epoch: 1, Steps: 18 | Train Loss: 3.268 Vali Loss: 3.081 Vali Acc: 0.117 Test Loss: 3.081 Test Acc: 0.117
Validation loss decreased (inf --> -0.116636).  Saving model ...
Epoch: 2 cost time: 3.276388168334961
Epoch: 2, Steps: 18 | Train Loss: 2.869 Vali Loss: 2.577 Vali Acc: 0.537 Test Loss: 2.577 Test Acc: 0.537
Validation loss decreased (-0.116636 --> -0.536641).  Saving model ...
Epoch: 3 cost time: 4.0252604484558105
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 1.990 Vali Acc: 0.810 Test Loss: 1.990 Test Acc: 0.810
Validation loss decreased (-0.536641 --> -0.809980).  Saving model ...
Epoch: 4 cost time: 4.005957841873169
Epoch: 4, Steps: 18 | Train Loss: 1.687 Vali Loss: 1.415 Vali Acc: 0.900 Test Loss: 1.415 Test Acc: 0.900
Validation loss decreased (-0.809980 --> -0.899986).  Saving model ...
Epoch: 5 cost time: 3.9674928188323975
Epoch: 5, Steps: 18 | Train Loss: 1.088 Vali Loss: 0.921 Vali Acc: 0.940 Test Loss: 0.921 Test Acc: 0.940
Validation loss decreased (-0.899986 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 4.011128902435303
Epoch: 6, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.576 Vali Acc: 0.953 Test Loss: 0.576 Test Acc: 0.953
Validation loss decreased (-0.939991 --> -0.953328).  Saving model ...
Epoch: 7 cost time: 3.807964563369751
Epoch: 7, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.389 Vali Acc: 0.953 Test Loss: 0.389 Test Acc: 0.953
Validation loss decreased (-0.953328 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 3.72872257232666
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.298 Vali Acc: 0.960 Test Loss: 0.298 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 3.7060625553131104
Epoch: 9, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.244 Vali Acc: 0.960 Test Loss: 0.244 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 3.701970100402832
Epoch: 10, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 3.68768572807312
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 3.1285743713378906
Epoch: 12, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 3.7250266075134277
Epoch: 13, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 3.6342389583587646
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.8783724308013916
Epoch: 15, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 4.017829179763794
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 4.021860837936401
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 4.104206562042236
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 4.094136476516724
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.077164173126221
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 4.100980758666992
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 4.014971017837524
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.156684637069702
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 4.143892526626587
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.868561029434204
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.9580416679382324
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.9410650730133057
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.9067680835723877
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.7498466968536377
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.898796558380127
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 644457
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.701168537139893
Epoch: 1, Steps: 18 | Train Loss: 3.303 Vali Loss: 3.106 Vali Acc: 0.070 Test Loss: 3.106 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 2.9567878246307373
Epoch: 2, Steps: 18 | Train Loss: 2.933 Vali Loss: 2.614 Vali Acc: 0.463 Test Loss: 2.614 Test Acc: 0.463
Validation loss decreased (-0.069969 --> -0.463307).  Saving model ...
Epoch: 3 cost time: 3.078075408935547
Epoch: 3, Steps: 18 | Train Loss: 2.370 Vali Loss: 2.041 Vali Acc: 0.830 Test Loss: 2.041 Test Acc: 0.830
Validation loss decreased (-0.463307 --> -0.829980).  Saving model ...
Epoch: 4 cost time: 3.1008119583129883
Epoch: 4, Steps: 18 | Train Loss: 1.743 Vali Loss: 1.467 Vali Acc: 0.893 Test Loss: 1.467 Test Acc: 0.893
Validation loss decreased (-0.829980 --> -0.893319).  Saving model ...
Epoch: 5 cost time: 3.0739057064056396
Epoch: 5, Steps: 18 | Train Loss: 1.171 Vali Loss: 0.982 Vali Acc: 0.940 Test Loss: 0.982 Test Acc: 0.940
Validation loss decreased (-0.893319 --> -0.939990).  Saving model ...
Epoch: 6 cost time: 3.015761137008667
Epoch: 6, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.637 Vali Acc: 0.940 Test Loss: 0.637 Test Acc: 0.940
Validation loss decreased (-0.939990 --> -0.939994).  Saving model ...
Epoch: 7 cost time: 3.0545144081115723
Epoch: 7, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.428 Vali Acc: 0.960 Test Loss: 0.428 Test Acc: 0.960
Validation loss decreased (-0.939994 --> -0.959996).  Saving model ...
Epoch: 8 cost time: 2.9842724800109863
Epoch: 8, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.317 Vali Acc: 0.963 Test Loss: 0.317 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 3.014678955078125
Epoch: 9, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.266 Vali Acc: 0.963 Test Loss: 0.266 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 2.8995461463928223
Epoch: 10, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 3.009711503982544
Epoch: 11, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 2.953566789627075
Epoch: 12, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 3.0417494773864746
Epoch: 13, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 2.918921709060669
Epoch: 14, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 2.802093267440796
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 2.7630488872528076
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 2.823498010635376
Epoch: 17, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 2.782166004180908
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 2.7668516635894775
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 2.7376465797424316
Epoch: 20, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6217010021209717
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 2.5095908641815186
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 2.7374675273895264
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 2.886836051940918
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 2.8988358974456787
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 2.9566826820373535
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5908095836639404
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8985707759857178
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.9327094554901123
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.956690549850464
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 230569
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.524544715881348
Epoch: 1, Steps: 18 | Train Loss: 3.268 Vali Loss: 3.081 Vali Acc: 0.117 Test Loss: 3.081 Test Acc: 0.117
Validation loss decreased (inf --> -0.116636).  Saving model ...
Epoch: 2 cost time: 3.6370468139648438
Epoch: 2, Steps: 18 | Train Loss: 2.869 Vali Loss: 2.577 Vali Acc: 0.537 Test Loss: 2.577 Test Acc: 0.537
Validation loss decreased (-0.116636 --> -0.536641).  Saving model ...
Epoch: 3 cost time: 3.441927433013916
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 1.990 Vali Acc: 0.810 Test Loss: 1.990 Test Acc: 0.810
Validation loss decreased (-0.536641 --> -0.809980).  Saving model ...
Epoch: 4 cost time: 3.411802291870117
Epoch: 4, Steps: 18 | Train Loss: 1.687 Vali Loss: 1.415 Vali Acc: 0.900 Test Loss: 1.415 Test Acc: 0.900
Validation loss decreased (-0.809980 --> -0.899986).  Saving model ...
Epoch: 5 cost time: 3.4287712574005127
Epoch: 5, Steps: 18 | Train Loss: 1.088 Vali Loss: 0.921 Vali Acc: 0.940 Test Loss: 0.921 Test Acc: 0.940
Validation loss decreased (-0.899986 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 3.4193575382232666
Epoch: 6, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.576 Vali Acc: 0.953 Test Loss: 0.576 Test Acc: 0.953
Validation loss decreased (-0.939991 --> -0.953328).  Saving model ...
Epoch: 7 cost time: 3.407249689102173
Epoch: 7, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.389 Vali Acc: 0.953 Test Loss: 0.389 Test Acc: 0.953
Validation loss decreased (-0.953328 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 3.4476850032806396
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.298 Vali Acc: 0.960 Test Loss: 0.298 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 3.53904128074646
Epoch: 9, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.244 Vali Acc: 0.960 Test Loss: 0.244 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 3.4323911666870117
Epoch: 10, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 3.388563394546509
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 3.600740909576416
Epoch: 12, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 3.617622137069702
Epoch: 13, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 3.705301284790039
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.6961770057678223
Epoch: 15, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 3.7284862995147705
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 3.6711549758911133
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 3.696126699447632
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 3.7397866249084473
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.6183173656463623
Epoch: 20, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.7100696563720703
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.6652419567108154
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.499638557434082
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.4936773777008057
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.5365967750549316
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.4696333408355713
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.645686626434326
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6273066997528076
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.693394422531128
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6331920623779297
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 644457
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.741192102432251
Epoch: 1, Steps: 18 | Train Loss: 3.303 Vali Loss: 3.106 Vali Acc: 0.070 Test Loss: 3.106 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 2.7679169178009033
Epoch: 2, Steps: 18 | Train Loss: 2.933 Vali Loss: 2.614 Vali Acc: 0.463 Test Loss: 2.614 Test Acc: 0.463
Validation loss decreased (-0.069969 --> -0.463307).  Saving model ...
Epoch: 3 cost time: 2.757826805114746
Epoch: 3, Steps: 18 | Train Loss: 2.370 Vali Loss: 2.041 Vali Acc: 0.830 Test Loss: 2.041 Test Acc: 0.830
Validation loss decreased (-0.463307 --> -0.829980).  Saving model ...
Epoch: 4 cost time: 2.792973279953003
Epoch: 4, Steps: 18 | Train Loss: 1.743 Vali Loss: 1.467 Vali Acc: 0.893 Test Loss: 1.467 Test Acc: 0.893
Validation loss decreased (-0.829980 --> -0.893319).  Saving model ...
Epoch: 5 cost time: 2.7930691242218018
Epoch: 5, Steps: 18 | Train Loss: 1.171 Vali Loss: 0.982 Vali Acc: 0.940 Test Loss: 0.982 Test Acc: 0.940
Validation loss decreased (-0.893319 --> -0.939990).  Saving model ...
Epoch: 6 cost time: 2.8065531253814697
Epoch: 6, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.637 Vali Acc: 0.940 Test Loss: 0.637 Test Acc: 0.940
Validation loss decreased (-0.939990 --> -0.939994).  Saving model ...
Epoch: 7 cost time: 2.8675968647003174
Epoch: 7, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.428 Vali Acc: 0.960 Test Loss: 0.428 Test Acc: 0.960
Validation loss decreased (-0.939994 --> -0.959996).  Saving model ...
Epoch: 8 cost time: 3.0416460037231445
Epoch: 8, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.317 Vali Acc: 0.963 Test Loss: 0.317 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 2.8980813026428223
Epoch: 9, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.266 Vali Acc: 0.963 Test Loss: 0.266 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 2.873387575149536
Epoch: 10, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 2.6998884677886963
Epoch: 11, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 2.685832977294922
Epoch: 12, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 2.7372071743011475
Epoch: 13, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 2.5742173194885254
Epoch: 14, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 2.752346992492676
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 2.673041820526123
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 2.6670711040496826
Epoch: 17, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 2.80476450920105
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 2.686922550201416
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 2.745687484741211
Epoch: 20, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.848418951034546
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 2.8981642723083496
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 2.79691743850708
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 2.860842704772949
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 2.912349224090576
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 2.836843252182007
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.847785234451294
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1855194568634033
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2380619049072266
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.85115385055542
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 230569
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.694246530532837
Epoch: 1, Steps: 18 | Train Loss: 3.268 Vali Loss: 3.081 Vali Acc: 0.117 Test Loss: 3.081 Test Acc: 0.117
Validation loss decreased (inf --> -0.116636).  Saving model ...
Epoch: 2 cost time: 2.6995973587036133
Epoch: 2, Steps: 18 | Train Loss: 2.869 Vali Loss: 2.577 Vali Acc: 0.537 Test Loss: 2.577 Test Acc: 0.537
Validation loss decreased (-0.116636 --> -0.536641).  Saving model ...
Epoch: 3 cost time: 2.8740053176879883
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 1.990 Vali Acc: 0.810 Test Loss: 1.990 Test Acc: 0.810
Validation loss decreased (-0.536641 --> -0.809980).  Saving model ...
Epoch: 4 cost time: 2.900801658630371
Epoch: 4, Steps: 18 | Train Loss: 1.687 Vali Loss: 1.416 Vali Acc: 0.900 Test Loss: 1.416 Test Acc: 0.900
Validation loss decreased (-0.809980 --> -0.899986).  Saving model ...
Epoch: 5 cost time: 2.7871291637420654
Epoch: 5, Steps: 18 | Train Loss: 1.088 Vali Loss: 0.921 Vali Acc: 0.940 Test Loss: 0.921 Test Acc: 0.940
Validation loss decreased (-0.899986 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 2.5727295875549316
Epoch: 6, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.576 Vali Acc: 0.953 Test Loss: 0.576 Test Acc: 0.953
Validation loss decreased (-0.939991 --> -0.953328).  Saving model ...
Epoch: 7 cost time: 2.402329683303833
Epoch: 7, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.389 Vali Acc: 0.953 Test Loss: 0.389 Test Acc: 0.953
Validation loss decreased (-0.953328 --> -0.953329).  Saving model ...
Epoch: 8 cost time: 2.5574190616607666
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.298 Vali Acc: 0.960 Test Loss: 0.298 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 2.7581937313079834
Epoch: 9, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.244 Vali Acc: 0.960 Test Loss: 0.244 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 2.820152997970581
Epoch: 10, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 2.6562299728393555
Epoch: 11, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 2.7605724334716797
Epoch: 12, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 2.821634292602539
Epoch: 13, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 2.8326377868652344
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 2.942169189453125
Epoch: 15, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 3.004152297973633
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 3.10536789894104
Epoch: 17, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 3.1180291175842285
Epoch: 18, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 3.042487621307373
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.0757341384887695
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.0290729999542236
Epoch: 21, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.070382833480835
Epoch: 22, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.8747129440307617
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.866910457611084
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.624732494354248
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.8660264015197754
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.876098394393921
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8579154014587402
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8294565677642822
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.792018175125122
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 644457
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.112532377243042
Epoch: 1, Steps: 18 | Train Loss: 3.302 Vali Loss: 3.106 Vali Acc: 0.070 Test Loss: 3.106 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 2.4317209720611572
Epoch: 2, Steps: 18 | Train Loss: 2.937 Vali Loss: 2.617 Vali Acc: 0.457 Test Loss: 2.617 Test Acc: 0.457
Validation loss decreased (-0.069969 --> -0.456640).  Saving model ...
Epoch: 3 cost time: 2.2987561225891113
Epoch: 3, Steps: 18 | Train Loss: 2.374 Vali Loss: 2.047 Vali Acc: 0.820 Test Loss: 2.047 Test Acc: 0.820
Validation loss decreased (-0.456640 --> -0.819980).  Saving model ...
Epoch: 4 cost time: 2.320436477661133
Epoch: 4, Steps: 18 | Train Loss: 1.751 Vali Loss: 1.475 Vali Acc: 0.890 Test Loss: 1.475 Test Acc: 0.890
Validation loss decreased (-0.819980 --> -0.889985).  Saving model ...
Epoch: 5 cost time: 2.319634437561035
Epoch: 5, Steps: 18 | Train Loss: 1.181 Vali Loss: 0.991 Vali Acc: 0.940 Test Loss: 0.991 Test Acc: 0.940
Validation loss decreased (-0.889985 --> -0.939990).  Saving model ...
Epoch: 6 cost time: 2.4009783267974854
Epoch: 6, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.642 Vali Acc: 0.937 Test Loss: 0.642 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.398609161376953
Epoch: 7, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.428 Vali Acc: 0.960 Test Loss: 0.428 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959996).  Saving model ...
Epoch: 8 cost time: 2.3066368103027344
Epoch: 8, Steps: 18 | Train Loss: 0.259 Vali Loss: 0.315 Vali Acc: 0.963 Test Loss: 0.315 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 2.0918378829956055
Epoch: 9, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.264 Vali Acc: 0.963 Test Loss: 0.264 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 2.0909738540649414
Epoch: 10, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 2.3053953647613525
Epoch: 11, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 2.031564950942993
Epoch: 12, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 2.263002634048462
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 2.2723612785339355
Epoch: 14, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 2.244558811187744
Epoch: 15, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 2.187654972076416
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 2.274033546447754
Epoch: 17, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 2.2773051261901855
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 2.238619327545166
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 2.0586533546447754
Epoch: 20, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0199649333953857
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 2.277174949645996
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 2.296718120574951
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 2.253626585006714
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 2.419799566268921
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 2.3267765045166016
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3466408252716064
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4727842807769775
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.418149471282959
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.408067226409912
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 230569
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.386340379714966
Epoch: 1, Steps: 18 | Train Loss: 3.207 Vali Loss: 3.005 Vali Acc: 0.167 Test Loss: 3.005 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 3.285224199295044
Epoch: 2, Steps: 18 | Train Loss: 2.780 Vali Loss: 2.495 Vali Acc: 0.603 Test Loss: 2.495 Test Acc: 0.603
Validation loss decreased (-0.166637 --> -0.603308).  Saving model ...
Epoch: 3 cost time: 4.173858642578125
Epoch: 3, Steps: 18 | Train Loss: 2.223 Vali Loss: 1.920 Vali Acc: 0.857 Test Loss: 1.920 Test Acc: 0.857
Validation loss decreased (-0.603308 --> -0.856647).  Saving model ...
Epoch: 4 cost time: 4.176384925842285
Epoch: 4, Steps: 18 | Train Loss: 1.622 Vali Loss: 1.373 Vali Acc: 0.927 Test Loss: 1.373 Test Acc: 0.927
Validation loss decreased (-0.856647 --> -0.926653).  Saving model ...
Epoch: 5 cost time: 4.009648561477661
Epoch: 5, Steps: 18 | Train Loss: 1.098 Vali Loss: 0.916 Vali Acc: 0.940 Test Loss: 0.916 Test Acc: 0.940
Validation loss decreased (-0.926653 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 4.169102430343628
Epoch: 6, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.584 Vali Acc: 0.957 Test Loss: 0.584 Test Acc: 0.957
Validation loss decreased (-0.939991 --> -0.956661).  Saving model ...
Epoch: 7 cost time: 4.088159561157227
Epoch: 7, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.392 Vali Acc: 0.970 Test Loss: 0.392 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969996).  Saving model ...
Epoch: 8 cost time: 3.9182772636413574
Epoch: 8, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.288 Vali Acc: 0.977 Test Loss: 0.288 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976664).  Saving model ...
Epoch: 9 cost time: 3.6870055198669434
Epoch: 9, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.234 Vali Acc: 0.977 Test Loss: 0.234 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976664).  Saving model ...
Epoch: 10 cost time: 4.176338195800781
Epoch: 10, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.201 Vali Acc: 0.977 Test Loss: 0.201 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 4.150467395782471
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 4.057987928390503
Epoch: 12, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 4.429293632507324
Epoch: 13, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 4.4457316398620605
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 4.261578559875488
Epoch: 15, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.323251485824585
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 4.184101104736328
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.329794883728027
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.252883672714233
Epoch: 19, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 4.376360654830933
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.295618772506714
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.22972559928894
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 4.158555507659912
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.8860692977905273
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.740182876586914
Epoch: 25, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7686405181884766
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.95692777633667
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9854140281677246
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.022645473480225
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.916696786880493
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 351401
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.154262065887451
Epoch: 1, Steps: 18 | Train Loss: 3.216 Vali Loss: 3.051 Vali Acc: 0.173 Test Loss: 3.051 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 2.938145875930786
Epoch: 2, Steps: 18 | Train Loss: 2.809 Vali Loss: 2.596 Vali Acc: 0.510 Test Loss: 2.596 Test Acc: 0.510
Validation loss decreased (-0.173303 --> -0.509974).  Saving model ...
Epoch: 3 cost time: 3.0922815799713135
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 2.066 Vali Acc: 0.767 Test Loss: 2.066 Test Acc: 0.767
Validation loss decreased (-0.509974 --> -0.766646).  Saving model ...
Epoch: 4 cost time: 3.0837514400482178
Epoch: 4, Steps: 18 | Train Loss: 1.727 Vali Loss: 1.541 Vali Acc: 0.870 Test Loss: 1.541 Test Acc: 0.870
Validation loss decreased (-0.766646 --> -0.869985).  Saving model ...
Epoch: 5 cost time: 3.0893282890319824
Epoch: 5, Steps: 18 | Train Loss: 1.210 Vali Loss: 1.086 Vali Acc: 0.913 Test Loss: 1.086 Test Acc: 0.913
Validation loss decreased (-0.869985 --> -0.913322).  Saving model ...
Epoch: 6 cost time: 3.1095266342163086
Epoch: 6, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.734 Vali Acc: 0.943 Test Loss: 0.734 Test Acc: 0.943
Validation loss decreased (-0.913322 --> -0.943326).  Saving model ...
Epoch: 7 cost time: 3.066287040710449
Epoch: 7, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.503 Vali Acc: 0.943 Test Loss: 0.503 Test Acc: 0.943
Validation loss decreased (-0.943326 --> -0.943328).  Saving model ...
Epoch: 8 cost time: 3.1998226642608643
Epoch: 8, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.943328 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 2.988402843475342
Epoch: 9, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 2.8685965538024902
Epoch: 10, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.266 Vali Acc: 0.953 Test Loss: 0.266 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 11 cost time: 3.077310085296631
Epoch: 11, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963331).  Saving model ...
Epoch: 12 cost time: 3.034104585647583
Epoch: 12, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.117136001586914
Epoch: 13, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0248873233795166
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 15 cost time: 3.10514497756958
Epoch: 15, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 3.1647112369537354
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 2.9923505783081055
Epoch: 17, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.127713203430176
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2585384845733643
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 20 cost time: 3.2248430252075195
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 21 cost time: 3.2257883548736572
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2627174854278564
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.18814754486084
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2564282417297363
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 3.2780888080596924
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 3.2957046031951904
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 3.3368399143218994
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1726365089416504
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 3.194098711013794
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 3.2533986568450928
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 144425
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.512053728103638
Epoch: 1, Steps: 18 | Train Loss: 3.207 Vali Loss: 3.005 Vali Acc: 0.167 Test Loss: 3.005 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 3.431403875350952
Epoch: 2, Steps: 18 | Train Loss: 2.780 Vali Loss: 2.495 Vali Acc: 0.603 Test Loss: 2.495 Test Acc: 0.603
Validation loss decreased (-0.166637 --> -0.603308).  Saving model ...
Epoch: 3 cost time: 3.3652007579803467
Epoch: 3, Steps: 18 | Train Loss: 2.223 Vali Loss: 1.920 Vali Acc: 0.857 Test Loss: 1.920 Test Acc: 0.857
Validation loss decreased (-0.603308 --> -0.856647).  Saving model ...
Epoch: 4 cost time: 3.408552408218384
Epoch: 4, Steps: 18 | Train Loss: 1.622 Vali Loss: 1.373 Vali Acc: 0.927 Test Loss: 1.373 Test Acc: 0.927
Validation loss decreased (-0.856647 --> -0.926653).  Saving model ...
Epoch: 5 cost time: 3.166429281234741
Epoch: 5, Steps: 18 | Train Loss: 1.098 Vali Loss: 0.916 Vali Acc: 0.940 Test Loss: 0.916 Test Acc: 0.940
Validation loss decreased (-0.926653 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 3.0538837909698486
Epoch: 6, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.584 Vali Acc: 0.957 Test Loss: 0.584 Test Acc: 0.957
Validation loss decreased (-0.939991 --> -0.956661).  Saving model ...
Epoch: 7 cost time: 3.3888187408447266
Epoch: 7, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.392 Vali Acc: 0.970 Test Loss: 0.392 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969996).  Saving model ...
Epoch: 8 cost time: 3.3348822593688965
Epoch: 8, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.288 Vali Acc: 0.977 Test Loss: 0.288 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976664).  Saving model ...
Epoch: 9 cost time: 3.3441162109375
Epoch: 9, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.234 Vali Acc: 0.977 Test Loss: 0.234 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976664).  Saving model ...
Epoch: 10 cost time: 3.3440444469451904
Epoch: 10, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.201 Vali Acc: 0.977 Test Loss: 0.201 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 2.896043539047241
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 2.9091427326202393
Epoch: 12, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 3.263453245162964
Epoch: 13, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.3628480434417725
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.3736460208892822
Epoch: 15, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4559614658355713
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 3.4186041355133057
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.232815980911255
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1855173110961914
Epoch: 19, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.107006788253784
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1478610038757324
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.000551223754883
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.209516763687134
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.3174188137054443
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.367002010345459
Epoch: 25, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4150822162628174
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.37101674079895
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.484170436859131
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2298386096954346
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.035486936569214
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 351401
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.347890853881836
Epoch: 1, Steps: 18 | Train Loss: 3.216 Vali Loss: 3.051 Vali Acc: 0.173 Test Loss: 3.051 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 2.46602201461792
Epoch: 2, Steps: 18 | Train Loss: 2.809 Vali Loss: 2.596 Vali Acc: 0.510 Test Loss: 2.596 Test Acc: 0.510
Validation loss decreased (-0.173303 --> -0.509974).  Saving model ...
Epoch: 3 cost time: 2.5318715572357178
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 2.066 Vali Acc: 0.767 Test Loss: 2.066 Test Acc: 0.767
Validation loss decreased (-0.509974 --> -0.766646).  Saving model ...
Epoch: 4 cost time: 2.4649863243103027
Epoch: 4, Steps: 18 | Train Loss: 1.727 Vali Loss: 1.541 Vali Acc: 0.870 Test Loss: 1.541 Test Acc: 0.870
Validation loss decreased (-0.766646 --> -0.869985).  Saving model ...
Epoch: 5 cost time: 2.46264386177063
Epoch: 5, Steps: 18 | Train Loss: 1.210 Vali Loss: 1.086 Vali Acc: 0.913 Test Loss: 1.086 Test Acc: 0.913
Validation loss decreased (-0.869985 --> -0.913322).  Saving model ...
Epoch: 6 cost time: 2.473285436630249
Epoch: 6, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.734 Vali Acc: 0.943 Test Loss: 0.734 Test Acc: 0.943
Validation loss decreased (-0.913322 --> -0.943326).  Saving model ...
Epoch: 7 cost time: 2.2532215118408203
Epoch: 7, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.503 Vali Acc: 0.943 Test Loss: 0.503 Test Acc: 0.943
Validation loss decreased (-0.943326 --> -0.943328).  Saving model ...
Epoch: 8 cost time: 2.5263001918792725
Epoch: 8, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.943328 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 2.4377031326293945
Epoch: 9, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 2.247905731201172
Epoch: 10, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.266 Vali Acc: 0.953 Test Loss: 0.266 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 11 cost time: 2.2797505855560303
Epoch: 11, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963331).  Saving model ...
Epoch: 12 cost time: 2.3092832565307617
Epoch: 12, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3375589847564697
Epoch: 13, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.26946759223938
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 15 cost time: 2.3679981231689453
Epoch: 15, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 2.386058807373047
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 2.525010108947754
Epoch: 17, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4660251140594482
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3643503189086914
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 20 cost time: 2.473667621612549
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 21 cost time: 2.736753463745117
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6162467002868652
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4160330295562744
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.421802043914795
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 2.4085395336151123
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 2.4871022701263428
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 2.3924858570098877
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3355963230133057
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 2.354384660720825
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 2.466299057006836
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 144425
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.173598289489746
Epoch: 1, Steps: 18 | Train Loss: 3.207 Vali Loss: 3.005 Vali Acc: 0.167 Test Loss: 3.005 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 2.707615375518799
Epoch: 2, Steps: 18 | Train Loss: 2.781 Vali Loss: 2.494 Vali Acc: 0.603 Test Loss: 2.494 Test Acc: 0.603
Validation loss decreased (-0.166637 --> -0.603308).  Saving model ...
Epoch: 3 cost time: 2.6443278789520264
Epoch: 3, Steps: 18 | Train Loss: 2.225 Vali Loss: 1.919 Vali Acc: 0.857 Test Loss: 1.919 Test Acc: 0.857
Validation loss decreased (-0.603308 --> -0.856647).  Saving model ...
Epoch: 4 cost time: 2.2815239429473877
Epoch: 4, Steps: 18 | Train Loss: 1.624 Vali Loss: 1.373 Vali Acc: 0.930 Test Loss: 1.373 Test Acc: 0.930
Validation loss decreased (-0.856647 --> -0.929986).  Saving model ...
Epoch: 5 cost time: 2.7477502822875977
Epoch: 5, Steps: 18 | Train Loss: 1.101 Vali Loss: 0.916 Vali Acc: 0.940 Test Loss: 0.916 Test Acc: 0.940
Validation loss decreased (-0.929986 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 2.7584025859832764
Epoch: 6, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.584 Vali Acc: 0.957 Test Loss: 0.584 Test Acc: 0.957
Validation loss decreased (-0.939991 --> -0.956661).  Saving model ...
Epoch: 7 cost time: 2.5513744354248047
Epoch: 7, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.392 Vali Acc: 0.970 Test Loss: 0.392 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969996).  Saving model ...
Epoch: 8 cost time: 2.6622250080108643
Epoch: 8, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.287 Vali Acc: 0.977 Test Loss: 0.287 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976664).  Saving model ...
Epoch: 9 cost time: 2.906501054763794
Epoch: 9, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.233 Vali Acc: 0.977 Test Loss: 0.233 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976664).  Saving model ...
Epoch: 10 cost time: 2.9182801246643066
Epoch: 10, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.200 Vali Acc: 0.980 Test Loss: 0.200 Test Acc: 0.980
Validation loss decreased (-0.976664 --> -0.979998).  Saving model ...
Epoch: 11 cost time: 2.8652477264404297
Epoch: 11, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.946776866912842
Epoch: 12, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9478869438171387
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.872389078140259
Epoch: 14, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.8321871757507324
Epoch: 15, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.499236583709717
Epoch: 16, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.654109239578247
Epoch: 17, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6455416679382324
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4296579360961914
Epoch: 19, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.4581661224365234
Epoch: 20, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.848111867904663
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7731080055236816
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.6745874881744385
Epoch: 23, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.940364122390747
Epoch: 24, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.002617359161377
Epoch: 25, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.884305477142334
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.2933671474456787
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.685309886932373
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7120885848999023
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.7035539150238037
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 351401
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.454590320587158
Epoch: 1, Steps: 18 | Train Loss: 3.216 Vali Loss: 3.050 Vali Acc: 0.173 Test Loss: 3.050 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 2.459578037261963
Epoch: 2, Steps: 18 | Train Loss: 2.808 Vali Loss: 2.595 Vali Acc: 0.513 Test Loss: 2.595 Test Acc: 0.513
Validation loss decreased (-0.173303 --> -0.513307).  Saving model ...
Epoch: 3 cost time: 2.360718250274658
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 2.065 Vali Acc: 0.767 Test Loss: 2.065 Test Acc: 0.767
Validation loss decreased (-0.513307 --> -0.766646).  Saving model ...
Epoch: 4 cost time: 2.4772253036499023
Epoch: 4, Steps: 18 | Train Loss: 1.727 Vali Loss: 1.541 Vali Acc: 0.870 Test Loss: 1.541 Test Acc: 0.870
Validation loss decreased (-0.766646 --> -0.869985).  Saving model ...
Epoch: 5 cost time: 2.386969566345215
Epoch: 5, Steps: 18 | Train Loss: 1.210 Vali Loss: 1.086 Vali Acc: 0.913 Test Loss: 1.086 Test Acc: 0.913
Validation loss decreased (-0.869985 --> -0.913322).  Saving model ...
Epoch: 6 cost time: 2.4119412899017334
Epoch: 6, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.733 Vali Acc: 0.943 Test Loss: 0.733 Test Acc: 0.943
Validation loss decreased (-0.913322 --> -0.943326).  Saving model ...
Epoch: 7 cost time: 2.186290740966797
Epoch: 7, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.502 Vali Acc: 0.943 Test Loss: 0.502 Test Acc: 0.943
Validation loss decreased (-0.943326 --> -0.943328).  Saving model ...
Epoch: 8 cost time: 2.2488977909088135
Epoch: 8, Steps: 18 | Train Loss: 0.256 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.943328 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 2.1515378952026367
Epoch: 9, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 2.270447015762329
Epoch: 10, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.266 Vali Acc: 0.953 Test Loss: 0.266 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 11 cost time: 2.014634370803833
Epoch: 11, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963331).  Saving model ...
Epoch: 12 cost time: 1.9200947284698486
Epoch: 12, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2237823009490967
Epoch: 13, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.204 Vali Acc: 0.960 Test Loss: 0.204 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0973093509674072
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 15 cost time: 2.203368663787842
Epoch: 15, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 2.2274672985076904
Epoch: 16, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3823986053466797
Epoch: 17, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.353316068649292
Epoch: 18, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2801706790924072
Epoch: 19, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 20 cost time: 2.224968194961548
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 21 cost time: 2.1470422744750977
Epoch: 21, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5711913108825684
Epoch: 22, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 23 cost time: 1.5656309127807617
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6204068660736084
Epoch: 24, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 1.6888844966888428
Epoch: 25, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 2.13596773147583
Epoch: 26, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 2.103708028793335
Epoch: 27, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.194298028945923
Epoch: 28, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 2.246065616607666
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2415831089019775
Epoch: 30, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 144425
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.874796152114868
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 3.149 Vali Acc: 0.057 Test Loss: 3.149 Test Acc: 0.057
Validation loss decreased (inf --> -0.056635).  Saving model ...
Epoch: 2 cost time: 4.434294939041138
Epoch: 2, Steps: 18 | Train Loss: 3.039 Vali Loss: 2.888 Vali Acc: 0.263 Test Loss: 2.888 Test Acc: 0.263
Validation loss decreased (-0.056635 --> -0.263304).  Saving model ...
Epoch: 3 cost time: 4.352740049362183
Epoch: 3, Steps: 18 | Train Loss: 2.722 Vali Loss: 2.560 Vali Acc: 0.527 Test Loss: 2.560 Test Acc: 0.527
Validation loss decreased (-0.263304 --> -0.526641).  Saving model ...
Epoch: 4 cost time: 3.9983508586883545
Epoch: 4, Steps: 18 | Train Loss: 2.362 Vali Loss: 2.181 Vali Acc: 0.710 Test Loss: 2.181 Test Acc: 0.710
Validation loss decreased (-0.526641 --> -0.709978).  Saving model ...
Epoch: 5 cost time: 4.48998236656189
Epoch: 5, Steps: 18 | Train Loss: 1.955 Vali Loss: 1.795 Vali Acc: 0.767 Test Loss: 1.795 Test Acc: 0.767
Validation loss decreased (-0.709978 --> -0.766649).  Saving model ...
Epoch: 6 cost time: 4.82346773147583
Epoch: 6, Steps: 18 | Train Loss: 1.518 Vali Loss: 1.439 Vali Acc: 0.843 Test Loss: 1.439 Test Acc: 0.843
Validation loss decreased (-0.766649 --> -0.843319).  Saving model ...
Epoch: 7 cost time: 4.756772518157959
Epoch: 7, Steps: 18 | Train Loss: 1.176 Vali Loss: 1.120 Vali Acc: 0.887 Test Loss: 1.120 Test Acc: 0.887
Validation loss decreased (-0.843319 --> -0.886655).  Saving model ...
Epoch: 8 cost time: 4.497727155685425
Epoch: 8, Steps: 18 | Train Loss: 0.859 Vali Loss: 0.861 Vali Acc: 0.903 Test Loss: 0.861 Test Acc: 0.903
Validation loss decreased (-0.886655 --> -0.903325).  Saving model ...
Epoch: 9 cost time: 4.867037534713745
Epoch: 9, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.668 Vali Acc: 0.927 Test Loss: 0.668 Test Acc: 0.927
Validation loss decreased (-0.903325 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 4.661358118057251
Epoch: 10, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.529 Vali Acc: 0.937 Test Loss: 0.529 Test Acc: 0.937
Validation loss decreased (-0.926660 --> -0.936661).  Saving model ...
Epoch: 11 cost time: 4.405109405517578
Epoch: 11, Steps: 18 | Train Loss: 0.350 Vali Loss: 0.436 Vali Acc: 0.940 Test Loss: 0.436 Test Acc: 0.940
Validation loss decreased (-0.936661 --> -0.939996).  Saving model ...
Epoch: 12 cost time: 4.30510950088501
Epoch: 12, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.373 Vali Acc: 0.940 Test Loss: 0.373 Test Acc: 0.940
Validation loss decreased (-0.939996 --> -0.939996).  Saving model ...
Epoch: 13 cost time: 4.435603141784668
Epoch: 13, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.325 Vali Acc: 0.947 Test Loss: 0.325 Test Acc: 0.947
Validation loss decreased (-0.939996 --> -0.946663).  Saving model ...
Epoch: 14 cost time: 4.397730112075806
Epoch: 14, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.946663 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 4.876024961471558
Epoch: 15, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 4.795778751373291
Epoch: 16, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 4.653997421264648
Epoch: 17, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.232 Vali Acc: 0.953 Test Loss: 0.232 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 18 cost time: 5.176202297210693
Epoch: 18, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959998).  Saving model ...
Epoch: 19 cost time: 5.032866477966309
Epoch: 19, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.801703453063965
Epoch: 20, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.623193025588989
Epoch: 21, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.739510536193848
Epoch: 22, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.760441780090332
Epoch: 23, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.063700199127197
Epoch: 24, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 25 cost time: 5.044700622558594
Epoch: 25, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.181 Vali Acc: 0.947 Test Loss: 0.181 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.088587760925293
Epoch: 26, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.009823799133301
Epoch: 27, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.77933669090271
Epoch: 28, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 29 cost time: 4.7316575050354
Epoch: 29, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 30 cost time: 4.720520257949829
Epoch: 30, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 615681
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.3457207679748535
Epoch: 1, Steps: 18 | Train Loss: 3.268 Vali Loss: 3.192 Vali Acc: 0.103 Test Loss: 3.192 Test Acc: 0.103
Validation loss decreased (inf --> -0.103301).  Saving model ...
Epoch: 2 cost time: 3.2857718467712402
Epoch: 2, Steps: 18 | Train Loss: 3.105 Vali Loss: 2.972 Vali Acc: 0.167 Test Loss: 2.972 Test Acc: 0.167
Validation loss decreased (-0.103301 --> -0.166637).  Saving model ...
Epoch: 3 cost time: 3.3517377376556396
Epoch: 3, Steps: 18 | Train Loss: 2.854 Vali Loss: 2.697 Vali Acc: 0.313 Test Loss: 2.697 Test Acc: 0.313
Validation loss decreased (-0.166637 --> -0.313306).  Saving model ...
Epoch: 4 cost time: 3.2877635955810547
Epoch: 4, Steps: 18 | Train Loss: 2.524 Vali Loss: 2.378 Vali Acc: 0.567 Test Loss: 2.378 Test Acc: 0.567
Validation loss decreased (-0.313306 --> -0.566643).  Saving model ...
Epoch: 5 cost time: 3.2481820583343506
Epoch: 5, Steps: 18 | Train Loss: 2.193 Vali Loss: 2.039 Vali Acc: 0.680 Test Loss: 2.039 Test Acc: 0.680
Validation loss decreased (-0.566643 --> -0.679980).  Saving model ...
Epoch: 6 cost time: 2.988027811050415
Epoch: 6, Steps: 18 | Train Loss: 1.822 Vali Loss: 1.705 Vali Acc: 0.770 Test Loss: 1.705 Test Acc: 0.770
Validation loss decreased (-0.679980 --> -0.769983).  Saving model ...
Epoch: 7 cost time: 2.866572856903076
Epoch: 7, Steps: 18 | Train Loss: 1.444 Vali Loss: 1.391 Vali Acc: 0.823 Test Loss: 1.391 Test Acc: 0.823
Validation loss decreased (-0.769983 --> -0.823319).  Saving model ...
Epoch: 8 cost time: 3.1158664226531982
Epoch: 8, Steps: 18 | Train Loss: 1.126 Vali Loss: 1.111 Vali Acc: 0.863 Test Loss: 1.111 Test Acc: 0.863
Validation loss decreased (-0.823319 --> -0.863322).  Saving model ...
Epoch: 9 cost time: 3.043196439743042
Epoch: 9, Steps: 18 | Train Loss: 0.850 Vali Loss: 0.894 Vali Acc: 0.880 Test Loss: 0.894 Test Acc: 0.880
Validation loss decreased (-0.863322 --> -0.879991).  Saving model ...
Epoch: 10 cost time: 3.0303328037261963
Epoch: 10, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.879991 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 3.174309015274048
Epoch: 11, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 3.3056070804595947
Epoch: 12, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.544 Vali Acc: 0.910 Test Loss: 0.544 Test Acc: 0.910
Validation loss decreased (-0.899994 --> -0.909995).  Saving model ...
Epoch: 13 cost time: 3.3615775108337402
Epoch: 13, Steps: 18 | Train Loss: 0.316 Vali Loss: 0.484 Vali Acc: 0.910 Test Loss: 0.484 Test Acc: 0.910
Validation loss decreased (-0.909995 --> -0.909995).  Saving model ...
Epoch: 14 cost time: 3.2913897037506104
Epoch: 14, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.433 Vali Acc: 0.927 Test Loss: 0.433 Test Acc: 0.927
Validation loss decreased (-0.909995 --> -0.926662).  Saving model ...
Epoch: 15 cost time: 3.264685869216919
Epoch: 15, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.406 Vali Acc: 0.927 Test Loss: 0.406 Test Acc: 0.927
Validation loss decreased (-0.926662 --> -0.926663).  Saving model ...
Epoch: 16 cost time: 3.295177698135376
Epoch: 16, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.377 Vali Acc: 0.943 Test Loss: 0.377 Test Acc: 0.943
Validation loss decreased (-0.926663 --> -0.943330).  Saving model ...
Epoch: 17 cost time: 3.3079874515533447
Epoch: 17, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.355 Vali Acc: 0.927 Test Loss: 0.355 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.198586940765381
Epoch: 18, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1439499855041504
Epoch: 19, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1603899002075195
Epoch: 20, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.029620885848999
Epoch: 21, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.864010810852051
Epoch: 22, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9228720664978027
Epoch: 23, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.271 Vali Acc: 0.940 Test Loss: 0.271 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.120820999145508
Epoch: 24, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.261 Vali Acc: 0.947 Test Loss: 0.261 Test Acc: 0.947
Validation loss decreased (-0.943330 --> -0.946664).  Saving model ...
Epoch: 25 cost time: 3.2356903553009033
Epoch: 25, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.258 Vali Acc: 0.940 Test Loss: 0.258 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.156694173812866
Epoch: 26, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.940 Test Loss: 0.253 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0703210830688477
Epoch: 27, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.1974880695343018
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.1008174419403076
Epoch: 29, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.3009564876556396
Epoch: 30, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.234 Vali Acc: 0.940 Test Loss: 0.234 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9466666666666667
model parameter : 201697
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.6268839836120605
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 3.149 Vali Acc: 0.057 Test Loss: 3.149 Test Acc: 0.057
Validation loss decreased (inf --> -0.056635).  Saving model ...
Epoch: 2 cost time: 3.6580424308776855
Epoch: 2, Steps: 18 | Train Loss: 3.039 Vali Loss: 2.888 Vali Acc: 0.263 Test Loss: 2.888 Test Acc: 0.263
Validation loss decreased (-0.056635 --> -0.263304).  Saving model ...
Epoch: 3 cost time: 3.7682507038116455
Epoch: 3, Steps: 18 | Train Loss: 2.722 Vali Loss: 2.560 Vali Acc: 0.527 Test Loss: 2.560 Test Acc: 0.527
Validation loss decreased (-0.263304 --> -0.526641).  Saving model ...
Epoch: 4 cost time: 3.483765125274658
Epoch: 4, Steps: 18 | Train Loss: 2.362 Vali Loss: 2.181 Vali Acc: 0.710 Test Loss: 2.181 Test Acc: 0.710
Validation loss decreased (-0.526641 --> -0.709978).  Saving model ...
Epoch: 5 cost time: 3.6298458576202393
Epoch: 5, Steps: 18 | Train Loss: 1.955 Vali Loss: 1.795 Vali Acc: 0.767 Test Loss: 1.795 Test Acc: 0.767
Validation loss decreased (-0.709978 --> -0.766649).  Saving model ...
Epoch: 6 cost time: 3.3099827766418457
Epoch: 6, Steps: 18 | Train Loss: 1.518 Vali Loss: 1.439 Vali Acc: 0.843 Test Loss: 1.439 Test Acc: 0.843
Validation loss decreased (-0.766649 --> -0.843319).  Saving model ...
Epoch: 7 cost time: 3.5467708110809326
Epoch: 7, Steps: 18 | Train Loss: 1.176 Vali Loss: 1.120 Vali Acc: 0.887 Test Loss: 1.120 Test Acc: 0.887
Validation loss decreased (-0.843319 --> -0.886655).  Saving model ...
Epoch: 8 cost time: 3.1281113624572754
Epoch: 8, Steps: 18 | Train Loss: 0.859 Vali Loss: 0.861 Vali Acc: 0.903 Test Loss: 0.861 Test Acc: 0.903
Validation loss decreased (-0.886655 --> -0.903325).  Saving model ...
Epoch: 9 cost time: 3.4907941818237305
Epoch: 9, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.668 Vali Acc: 0.927 Test Loss: 0.668 Test Acc: 0.927
Validation loss decreased (-0.903325 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 3.4177746772766113
Epoch: 10, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.529 Vali Acc: 0.937 Test Loss: 0.529 Test Acc: 0.937
Validation loss decreased (-0.926660 --> -0.936661).  Saving model ...
Epoch: 11 cost time: 3.5253374576568604
Epoch: 11, Steps: 18 | Train Loss: 0.350 Vali Loss: 0.436 Vali Acc: 0.940 Test Loss: 0.436 Test Acc: 0.940
Validation loss decreased (-0.936661 --> -0.939996).  Saving model ...
Epoch: 12 cost time: 3.545729398727417
Epoch: 12, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.373 Vali Acc: 0.940 Test Loss: 0.373 Test Acc: 0.940
Validation loss decreased (-0.939996 --> -0.939996).  Saving model ...
Epoch: 13 cost time: 3.434096097946167
Epoch: 13, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.325 Vali Acc: 0.947 Test Loss: 0.325 Test Acc: 0.947
Validation loss decreased (-0.939996 --> -0.946663).  Saving model ...
Epoch: 14 cost time: 3.732970714569092
Epoch: 14, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.946663 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 3.6048378944396973
Epoch: 15, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 3.681121826171875
Epoch: 16, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 3.50488543510437
Epoch: 17, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.232 Vali Acc: 0.953 Test Loss: 0.232 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 18 cost time: 3.3861236572265625
Epoch: 18, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959998).  Saving model ...
Epoch: 19 cost time: 3.1712896823883057
Epoch: 19, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.510554790496826
Epoch: 20, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4484779834747314
Epoch: 21, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5730226039886475
Epoch: 22, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.7996370792388916
Epoch: 23, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5752735137939453
Epoch: 24, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 25 cost time: 3.822953939437866
Epoch: 25, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.181 Vali Acc: 0.947 Test Loss: 0.181 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.825664520263672
Epoch: 26, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8769233226776123
Epoch: 27, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.258749008178711
Epoch: 28, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 29 cost time: 2.860703706741333
Epoch: 29, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 30 cost time: 2.5691399574279785
Epoch: 30, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 615681
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.857520341873169
Epoch: 1, Steps: 18 | Train Loss: 3.268 Vali Loss: 3.192 Vali Acc: 0.103 Test Loss: 3.192 Test Acc: 0.103
Validation loss decreased (inf --> -0.103301).  Saving model ...
Epoch: 2 cost time: 2.850262403488159
Epoch: 2, Steps: 18 | Train Loss: 3.105 Vali Loss: 2.972 Vali Acc: 0.167 Test Loss: 2.972 Test Acc: 0.167
Validation loss decreased (-0.103301 --> -0.166637).  Saving model ...
Epoch: 3 cost time: 2.9236013889312744
Epoch: 3, Steps: 18 | Train Loss: 2.854 Vali Loss: 2.697 Vali Acc: 0.310 Test Loss: 2.697 Test Acc: 0.310
Validation loss decreased (-0.166637 --> -0.309973).  Saving model ...
Epoch: 4 cost time: 2.272052049636841
Epoch: 4, Steps: 18 | Train Loss: 2.524 Vali Loss: 2.378 Vali Acc: 0.573 Test Loss: 2.378 Test Acc: 0.573
Validation loss decreased (-0.309973 --> -0.573310).  Saving model ...
Epoch: 5 cost time: 2.343320369720459
Epoch: 5, Steps: 18 | Train Loss: 2.193 Vali Loss: 2.039 Vali Acc: 0.680 Test Loss: 2.039 Test Acc: 0.680
Validation loss decreased (-0.573310 --> -0.679980).  Saving model ...
Epoch: 6 cost time: 2.327540874481201
Epoch: 6, Steps: 18 | Train Loss: 1.822 Vali Loss: 1.705 Vali Acc: 0.770 Test Loss: 1.705 Test Acc: 0.770
Validation loss decreased (-0.679980 --> -0.769983).  Saving model ...
Epoch: 7 cost time: 2.1967809200286865
Epoch: 7, Steps: 18 | Train Loss: 1.444 Vali Loss: 1.391 Vali Acc: 0.827 Test Loss: 1.391 Test Acc: 0.827
Validation loss decreased (-0.769983 --> -0.826653).  Saving model ...
Epoch: 8 cost time: 2.1801791191101074
Epoch: 8, Steps: 18 | Train Loss: 1.126 Vali Loss: 1.111 Vali Acc: 0.870 Test Loss: 1.111 Test Acc: 0.870
Validation loss decreased (-0.826653 --> -0.869989).  Saving model ...
Epoch: 9 cost time: 2.159787178039551
Epoch: 9, Steps: 18 | Train Loss: 0.850 Vali Loss: 0.894 Vali Acc: 0.880 Test Loss: 0.894 Test Acc: 0.880
Validation loss decreased (-0.869989 --> -0.879991).  Saving model ...
Epoch: 10 cost time: 2.4385979175567627
Epoch: 10, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.879991 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 2.762746810913086
Epoch: 11, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.624 Vali Acc: 0.903 Test Loss: 0.624 Test Acc: 0.903
Validation loss decreased (-0.899993 --> -0.903327).  Saving model ...
Epoch: 12 cost time: 2.7812397480010986
Epoch: 12, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.544 Vali Acc: 0.910 Test Loss: 0.544 Test Acc: 0.910
Validation loss decreased (-0.903327 --> -0.909995).  Saving model ...
Epoch: 13 cost time: 2.9197185039520264
Epoch: 13, Steps: 18 | Train Loss: 0.316 Vali Loss: 0.484 Vali Acc: 0.913 Test Loss: 0.484 Test Acc: 0.913
Validation loss decreased (-0.909995 --> -0.913328).  Saving model ...
Epoch: 14 cost time: 2.827641248703003
Epoch: 14, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.433 Vali Acc: 0.927 Test Loss: 0.433 Test Acc: 0.927
Validation loss decreased (-0.913328 --> -0.926662).  Saving model ...
Epoch: 15 cost time: 2.852400064468384
Epoch: 15, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.406 Vali Acc: 0.923 Test Loss: 0.406 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.839486837387085
Epoch: 16, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.377 Vali Acc: 0.943 Test Loss: 0.377 Test Acc: 0.943
Validation loss decreased (-0.926662 --> -0.943330).  Saving model ...
Epoch: 17 cost time: 2.8794240951538086
Epoch: 17, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.354 Vali Acc: 0.923 Test Loss: 0.354 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9927303791046143
Epoch: 18, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6438252925872803
Epoch: 19, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.766608476638794
Epoch: 20, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8051042556762695
Epoch: 21, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6442434787750244
Epoch: 22, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.707549571990967
Epoch: 23, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.271 Vali Acc: 0.940 Test Loss: 0.271 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6878674030303955
Epoch: 24, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.261 Vali Acc: 0.947 Test Loss: 0.261 Test Acc: 0.947
Validation loss decreased (-0.943330 --> -0.946664).  Saving model ...
Epoch: 25 cost time: 2.7305819988250732
Epoch: 25, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.257 Vali Acc: 0.940 Test Loss: 0.257 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.689735174179077
Epoch: 26, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.252 Vali Acc: 0.940 Test Loss: 0.252 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0108394622802734
Epoch: 27, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.976055145263672
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.920083522796631
Epoch: 29, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.238 Vali Acc: 0.943 Test Loss: 0.238 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.0002145767211914
Epoch: 30, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.234 Vali Acc: 0.940 Test Loss: 0.234 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9466666666666667
model parameter : 201697
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.1372809410095215
Epoch: 1, Steps: 18 | Train Loss: 3.233 Vali Loss: 3.151 Vali Acc: 0.057 Test Loss: 3.151 Test Acc: 0.057
Validation loss decreased (inf --> -0.056635).  Saving model ...
Epoch: 2 cost time: 2.9134511947631836
Epoch: 2, Steps: 18 | Train Loss: 3.042 Vali Loss: 2.891 Vali Acc: 0.263 Test Loss: 2.891 Test Acc: 0.263
Validation loss decreased (-0.056635 --> -0.263304).  Saving model ...
Epoch: 3 cost time: 2.903127908706665
Epoch: 3, Steps: 18 | Train Loss: 2.726 Vali Loss: 2.565 Vali Acc: 0.523 Test Loss: 2.565 Test Acc: 0.523
Validation loss decreased (-0.263304 --> -0.523308).  Saving model ...
Epoch: 4 cost time: 2.5547678470611572
Epoch: 4, Steps: 18 | Train Loss: 2.369 Vali Loss: 2.188 Vali Acc: 0.700 Test Loss: 2.188 Test Acc: 0.700
Validation loss decreased (-0.523308 --> -0.699978).  Saving model ...
Epoch: 5 cost time: 2.9622535705566406
Epoch: 5, Steps: 18 | Train Loss: 1.965 Vali Loss: 1.806 Vali Acc: 0.767 Test Loss: 1.806 Test Acc: 0.767
Validation loss decreased (-0.699978 --> -0.766649).  Saving model ...
Epoch: 6 cost time: 2.4918134212493896
Epoch: 6, Steps: 18 | Train Loss: 1.535 Vali Loss: 1.453 Vali Acc: 0.847 Test Loss: 1.453 Test Acc: 0.847
Validation loss decreased (-0.766649 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 3.138366460800171
Epoch: 7, Steps: 18 | Train Loss: 1.187 Vali Loss: 1.136 Vali Acc: 0.887 Test Loss: 1.136 Test Acc: 0.887
Validation loss decreased (-0.846652 --> -0.886655).  Saving model ...
Epoch: 8 cost time: 3.1802306175231934
Epoch: 8, Steps: 18 | Train Loss: 0.871 Vali Loss: 0.873 Vali Acc: 0.907 Test Loss: 0.873 Test Acc: 0.907
Validation loss decreased (-0.886655 --> -0.906658).  Saving model ...
Epoch: 9 cost time: 3.0461697578430176
Epoch: 9, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.675 Vali Acc: 0.923 Test Loss: 0.675 Test Acc: 0.923
Validation loss decreased (-0.906658 --> -0.923327).  Saving model ...
Epoch: 10 cost time: 2.850825786590576
Epoch: 10, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.534 Vali Acc: 0.930 Test Loss: 0.534 Test Acc: 0.930
Validation loss decreased (-0.923327 --> -0.929995).  Saving model ...
Epoch: 11 cost time: 2.9190878868103027
Epoch: 11, Steps: 18 | Train Loss: 0.350 Vali Loss: 0.440 Vali Acc: 0.937 Test Loss: 0.440 Test Acc: 0.937
Validation loss decreased (-0.929995 --> -0.936662).  Saving model ...
Epoch: 12 cost time: 2.8219900131225586
Epoch: 12, Steps: 18 | Train Loss: 0.256 Vali Loss: 0.376 Vali Acc: 0.940 Test Loss: 0.376 Test Acc: 0.940
Validation loss decreased (-0.936662 --> -0.939996).  Saving model ...
Epoch: 13 cost time: 2.898174285888672
Epoch: 13, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.327 Vali Acc: 0.940 Test Loss: 0.327 Test Acc: 0.940
Validation loss decreased (-0.939996 --> -0.939997).  Saving model ...
Epoch: 14 cost time: 2.8637914657592773
Epoch: 14, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.298 Vali Acc: 0.943 Test Loss: 0.298 Test Acc: 0.943
Validation loss decreased (-0.939997 --> -0.943330).  Saving model ...
Epoch: 15 cost time: 2.8289473056793213
Epoch: 15, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.265 Vali Acc: 0.947 Test Loss: 0.265 Test Acc: 0.947
Validation loss decreased (-0.943330 --> -0.946664).  Saving model ...
Epoch: 16 cost time: 3.21636962890625
Epoch: 16, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3307595252990723
Epoch: 17, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 3.0323386192321777
Epoch: 18, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 3.343190908432007
Epoch: 19, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3030290603637695
Epoch: 20, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 21 cost time: 2.9334003925323486
Epoch: 21, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 22 cost time: 3.047961711883545
Epoch: 22, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1216907501220703
Epoch: 23, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.145169496536255
Epoch: 24, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 3.154690980911255
Epoch: 25, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.149674415588379
Epoch: 26, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.393747568130493
Epoch: 27, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3127996921539307
Epoch: 28, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.331829071044922
Epoch: 29, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.300706624984741
Epoch: 30, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 615681
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.591206073760986
Epoch: 1, Steps: 18 | Train Loss: 3.265 Vali Loss: 3.190 Vali Acc: 0.103 Test Loss: 3.190 Test Acc: 0.103
Validation loss decreased (inf --> -0.103301).  Saving model ...
Epoch: 2 cost time: 2.3685996532440186
Epoch: 2, Steps: 18 | Train Loss: 3.105 Vali Loss: 2.972 Vali Acc: 0.167 Test Loss: 2.972 Test Acc: 0.167
Validation loss decreased (-0.103301 --> -0.166637).  Saving model ...
Epoch: 3 cost time: 2.3777482509613037
Epoch: 3, Steps: 18 | Train Loss: 2.856 Vali Loss: 2.697 Vali Acc: 0.310 Test Loss: 2.697 Test Acc: 0.310
Validation loss decreased (-0.166637 --> -0.309973).  Saving model ...
Epoch: 4 cost time: 2.2300260066986084
Epoch: 4, Steps: 18 | Train Loss: 2.528 Vali Loss: 2.378 Vali Acc: 0.570 Test Loss: 2.378 Test Acc: 0.570
Validation loss decreased (-0.309973 --> -0.569976).  Saving model ...
Epoch: 5 cost time: 2.223541021347046
Epoch: 5, Steps: 18 | Train Loss: 2.199 Vali Loss: 2.040 Vali Acc: 0.683 Test Loss: 2.040 Test Acc: 0.683
Validation loss decreased (-0.569976 --> -0.683313).  Saving model ...
Epoch: 6 cost time: 1.910146951675415
Epoch: 6, Steps: 18 | Train Loss: 1.829 Vali Loss: 1.708 Vali Acc: 0.773 Test Loss: 1.708 Test Acc: 0.773
Validation loss decreased (-0.683313 --> -0.773316).  Saving model ...
Epoch: 7 cost time: 2.294909954071045
Epoch: 7, Steps: 18 | Train Loss: 1.452 Vali Loss: 1.394 Vali Acc: 0.817 Test Loss: 1.394 Test Acc: 0.817
Validation loss decreased (-0.773316 --> -0.816653).  Saving model ...
Epoch: 8 cost time: 2.287212610244751
Epoch: 8, Steps: 18 | Train Loss: 1.133 Vali Loss: 1.114 Vali Acc: 0.860 Test Loss: 1.114 Test Acc: 0.860
Validation loss decreased (-0.816653 --> -0.859989).  Saving model ...
Epoch: 9 cost time: 2.1599550247192383
Epoch: 9, Steps: 18 | Train Loss: 0.856 Vali Loss: 0.897 Vali Acc: 0.870 Test Loss: 0.897 Test Acc: 0.870
Validation loss decreased (-0.859989 --> -0.869991).  Saving model ...
Epoch: 10 cost time: 2.400141716003418
Epoch: 10, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.737 Vali Acc: 0.893 Test Loss: 0.737 Test Acc: 0.893
Validation loss decreased (-0.869991 --> -0.893326).  Saving model ...
Epoch: 11 cost time: 2.417776107788086
Epoch: 11, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.626 Vali Acc: 0.900 Test Loss: 0.626 Test Acc: 0.900
Validation loss decreased (-0.893326 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 2.3716671466827393
Epoch: 12, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.546 Vali Acc: 0.910 Test Loss: 0.546 Test Acc: 0.910
Validation loss decreased (-0.899994 --> -0.909995).  Saving model ...
Epoch: 13 cost time: 2.240737199783325
Epoch: 13, Steps: 18 | Train Loss: 0.320 Vali Loss: 0.485 Vali Acc: 0.910 Test Loss: 0.485 Test Acc: 0.910
Validation loss decreased (-0.909995 --> -0.909995).  Saving model ...
Epoch: 14 cost time: 2.267998695373535
Epoch: 14, Steps: 18 | Train Loss: 0.256 Vali Loss: 0.435 Vali Acc: 0.917 Test Loss: 0.435 Test Acc: 0.917
Validation loss decreased (-0.909995 --> -0.916662).  Saving model ...
Epoch: 15 cost time: 2.243859052658081
Epoch: 15, Steps: 18 | Train Loss: 0.205 Vali Loss: 0.406 Vali Acc: 0.923 Test Loss: 0.406 Test Acc: 0.923
Validation loss decreased (-0.916662 --> -0.923329).  Saving model ...
Epoch: 16 cost time: 2.3562891483306885
Epoch: 16, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.372 Vali Acc: 0.923 Test Loss: 0.372 Test Acc: 0.923
Validation loss decreased (-0.923329 --> -0.923330).  Saving model ...
Epoch: 17 cost time: 2.280378818511963
Epoch: 17, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.352 Vali Acc: 0.930 Test Loss: 0.352 Test Acc: 0.930
Validation loss decreased (-0.923330 --> -0.929996).  Saving model ...
Epoch: 18 cost time: 2.312695026397705
Epoch: 18, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.331 Vali Acc: 0.923 Test Loss: 0.331 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6078388690948486
Epoch: 19, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.929996 --> -0.929997).  Saving model ...
Epoch: 20 cost time: 2.327571392059326
Epoch: 20, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.929997 --> -0.929997).  Saving model ...
Epoch: 21 cost time: 2.4071998596191406
Epoch: 21, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
Validation loss decreased (-0.929997 --> -0.929997).  Saving model ...
Epoch: 22 cost time: 2.378602981567383
Epoch: 22, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.929997 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 2.364412784576416
Epoch: 23, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1899189949035645
Epoch: 24, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 2.267881155014038
Epoch: 25, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3176605701446533
Epoch: 26, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2806975841522217
Epoch: 27, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 2.4148755073547363
Epoch: 28, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.936664).  Saving model ...
Epoch: 29 cost time: 2.3185312747955322
Epoch: 29, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.349146604537964
Epoch: 30, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.936664 --> -0.936664).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9366666666666666
model parameter : 201697
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.143320560455322
Epoch: 1, Steps: 18 | Train Loss: 3.303 Vali Loss: 3.229 Vali Acc: 0.043 Test Loss: 3.229 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 3.154975414276123
Epoch: 2, Steps: 18 | Train Loss: 3.121 Vali Loss: 2.972 Vali Acc: 0.200 Test Loss: 2.972 Test Acc: 0.200
Validation loss decreased (-0.043301 --> -0.199970).  Saving model ...
Epoch: 3 cost time: 3.129188299179077
Epoch: 3, Steps: 18 | Train Loss: 2.843 Vali Loss: 2.648 Vali Acc: 0.473 Test Loss: 2.648 Test Acc: 0.473
Validation loss decreased (-0.199970 --> -0.473307).  Saving model ...
Epoch: 4 cost time: 4.115404367446899
Epoch: 4, Steps: 18 | Train Loss: 2.464 Vali Loss: 2.289 Vali Acc: 0.657 Test Loss: 2.289 Test Acc: 0.657
Validation loss decreased (-0.473307 --> -0.656644).  Saving model ...
Epoch: 5 cost time: 4.273426055908203
Epoch: 5, Steps: 18 | Train Loss: 2.075 Vali Loss: 1.896 Vali Acc: 0.797 Test Loss: 1.896 Test Acc: 0.797
Validation loss decreased (-0.656644 --> -0.796648).  Saving model ...
Epoch: 6 cost time: 4.172733783721924
Epoch: 6, Steps: 18 | Train Loss: 1.658 Vali Loss: 1.512 Vali Acc: 0.847 Test Loss: 1.512 Test Acc: 0.847
Validation loss decreased (-0.796648 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 4.188131332397461
Epoch: 7, Steps: 18 | Train Loss: 1.266 Vali Loss: 1.172 Vali Acc: 0.880 Test Loss: 1.172 Test Acc: 0.880
Validation loss decreased (-0.846652 --> -0.879988).  Saving model ...
Epoch: 8 cost time: 4.1676201820373535
Epoch: 8, Steps: 18 | Train Loss: 0.933 Vali Loss: 0.896 Vali Acc: 0.887 Test Loss: 0.896 Test Acc: 0.887
Validation loss decreased (-0.879988 --> -0.886658).  Saving model ...
Epoch: 9 cost time: 4.314192533493042
Epoch: 9, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.707 Vali Acc: 0.920 Test Loss: 0.707 Test Acc: 0.920
Validation loss decreased (-0.886658 --> -0.919993).  Saving model ...
Epoch: 10 cost time: 4.2032225131988525
Epoch: 10, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.577 Vali Acc: 0.923 Test Loss: 0.577 Test Acc: 0.923
Validation loss decreased (-0.919993 --> -0.923328).  Saving model ...
Epoch: 11 cost time: 3.926898241043091
Epoch: 11, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.494 Vali Acc: 0.920 Test Loss: 0.494 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.636472225189209
Epoch: 12, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.423 Vali Acc: 0.923 Test Loss: 0.423 Test Acc: 0.923
Validation loss decreased (-0.923328 --> -0.923329).  Saving model ...
Epoch: 13 cost time: 3.65118670463562
Epoch: 13, Steps: 18 | Train Loss: 0.239 Vali Loss: 0.383 Vali Acc: 0.930 Test Loss: 0.383 Test Acc: 0.930
Validation loss decreased (-0.923329 --> -0.929996).  Saving model ...
Epoch: 14 cost time: 3.799393653869629
Epoch: 14, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.929996 --> -0.929996).  Saving model ...
Epoch: 15 cost time: 3.584421157836914
Epoch: 15, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
Validation loss decreased (-0.929996 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 3.7237348556518555
Epoch: 16, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.936664).  Saving model ...
Epoch: 17 cost time: 3.7030177116394043
Epoch: 17, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.1576621532440186
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.938011646270752
Epoch: 19, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.956210136413574
Epoch: 20, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.932097911834717
Epoch: 21, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
Validation loss decreased (-0.936664 --> -0.939997).  Saving model ...
Epoch: 22 cost time: 3.896707057952881
Epoch: 22, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.932145357131958
Epoch: 23, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.239 Vali Acc: 0.940 Test Loss: 0.239 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939998).  Saving model ...
Epoch: 24 cost time: 4.058379411697388
Epoch: 24, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.947 Test Loss: 0.234 Test Acc: 0.947
Validation loss decreased (-0.939998 --> -0.946664).  Saving model ...
Epoch: 25 cost time: 3.4761786460876465
Epoch: 25, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 3.597337245941162
Epoch: 26, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956664).  Saving model ...
Epoch: 27 cost time: 3.566070795059204
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.953 Test Loss: 0.223 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.885683059692383
Epoch: 28, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9216771125793457
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8130533695220947
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 322433
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.441064119338989
Epoch: 1, Steps: 18 | Train Loss: 3.254 Vali Loss: 3.137 Vali Acc: 0.090 Test Loss: 3.137 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 3.1168222427368164
Epoch: 2, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.848 Vali Acc: 0.260 Test Loss: 2.848 Test Acc: 0.260
Validation loss decreased (-0.089969 --> -0.259972).  Saving model ...
Epoch: 3 cost time: 3.0261247158050537
Epoch: 3, Steps: 18 | Train Loss: 2.728 Vali Loss: 2.501 Vali Acc: 0.503 Test Loss: 2.501 Test Acc: 0.503
Validation loss decreased (-0.259972 --> -0.503308).  Saving model ...
Epoch: 4 cost time: 3.07080340385437
Epoch: 4, Steps: 18 | Train Loss: 2.346 Vali Loss: 2.114 Vali Acc: 0.743 Test Loss: 2.114 Test Acc: 0.743
Validation loss decreased (-0.503308 --> -0.743312).  Saving model ...
Epoch: 5 cost time: 3.0660288333892822
Epoch: 5, Steps: 18 | Train Loss: 1.971 Vali Loss: 1.733 Vali Acc: 0.817 Test Loss: 1.733 Test Acc: 0.817
Validation loss decreased (-0.743312 --> -0.816649).  Saving model ...
Epoch: 6 cost time: 3.0116775035858154
Epoch: 6, Steps: 18 | Train Loss: 1.558 Vali Loss: 1.386 Vali Acc: 0.897 Test Loss: 1.386 Test Acc: 0.897
Validation loss decreased (-0.816649 --> -0.896653).  Saving model ...
Epoch: 7 cost time: 2.9618029594421387
Epoch: 7, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.072 Vali Acc: 0.920 Test Loss: 1.072 Test Acc: 0.920
Validation loss decreased (-0.896653 --> -0.919989).  Saving model ...
Epoch: 8 cost time: 2.8024001121520996
Epoch: 8, Steps: 18 | Train Loss: 0.926 Vali Loss: 0.818 Vali Acc: 0.930 Test Loss: 0.818 Test Acc: 0.930
Validation loss decreased (-0.919989 --> -0.929992).  Saving model ...
Epoch: 9 cost time: 2.821904420852661
Epoch: 9, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.635 Vali Acc: 0.937 Test Loss: 0.635 Test Acc: 0.937
Validation loss decreased (-0.929992 --> -0.936660).  Saving model ...
Epoch: 10 cost time: 2.8828983306884766
Epoch: 10, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.511 Vali Acc: 0.943 Test Loss: 0.511 Test Acc: 0.943
Validation loss decreased (-0.936660 --> -0.943328).  Saving model ...
Epoch: 11 cost time: 2.821924924850464
Epoch: 11, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.424 Vali Acc: 0.943 Test Loss: 0.424 Test Acc: 0.943
Validation loss decreased (-0.943328 --> -0.943329).  Saving model ...
Epoch: 12 cost time: 2.7475521564483643
Epoch: 12, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.365 Vali Acc: 0.943 Test Loss: 0.365 Test Acc: 0.943
Validation loss decreased (-0.943329 --> -0.943330).  Saving model ...
Epoch: 13 cost time: 2.827207565307617
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.943330 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 2.723613977432251
Epoch: 14, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.291 Vali Acc: 0.940 Test Loss: 0.291 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7299695014953613
Epoch: 15, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 2.650197744369507
Epoch: 16, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.249 Vali Acc: 0.953 Test Loss: 0.249 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 17 cost time: 2.7914016246795654
Epoch: 17, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9045679569244385
Epoch: 18, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 19 cost time: 3.6402337551116943
Epoch: 19, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 20 cost time: 3.514268159866333
Epoch: 20, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 21 cost time: 3.415818452835083
Epoch: 21, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 22 cost time: 3.384531259536743
Epoch: 22, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.466845989227295
Epoch: 23, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963331).  Saving model ...
Epoch: 24 cost time: 3.5148231983184814
Epoch: 24, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 3.345412254333496
Epoch: 25, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.467942953109741
Epoch: 26, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.532372236251831
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.133589506149292
Epoch: 28, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 29 cost time: 2.733668088912964
Epoch: 29, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.507880687713623
Epoch: 30, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 115425
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.1054229736328125
Epoch: 1, Steps: 18 | Train Loss: 3.303 Vali Loss: 3.229 Vali Acc: 0.043 Test Loss: 3.229 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 3.7663276195526123
Epoch: 2, Steps: 18 | Train Loss: 3.121 Vali Loss: 2.972 Vali Acc: 0.200 Test Loss: 2.972 Test Acc: 0.200
Validation loss decreased (-0.043301 --> -0.199970).  Saving model ...
Epoch: 3 cost time: 3.3045525550842285
Epoch: 3, Steps: 18 | Train Loss: 2.843 Vali Loss: 2.648 Vali Acc: 0.473 Test Loss: 2.648 Test Acc: 0.473
Validation loss decreased (-0.199970 --> -0.473307).  Saving model ...
Epoch: 4 cost time: 4.335794687271118
Epoch: 4, Steps: 18 | Train Loss: 2.464 Vali Loss: 2.289 Vali Acc: 0.657 Test Loss: 2.289 Test Acc: 0.657
Validation loss decreased (-0.473307 --> -0.656644).  Saving model ...
Epoch: 5 cost time: 4.12564754486084
Epoch: 5, Steps: 18 | Train Loss: 2.075 Vali Loss: 1.896 Vali Acc: 0.797 Test Loss: 1.896 Test Acc: 0.797
Validation loss decreased (-0.656644 --> -0.796648).  Saving model ...
Epoch: 6 cost time: 3.5957045555114746
Epoch: 6, Steps: 18 | Train Loss: 1.658 Vali Loss: 1.512 Vali Acc: 0.847 Test Loss: 1.512 Test Acc: 0.847
Validation loss decreased (-0.796648 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 4.259302854537964
Epoch: 7, Steps: 18 | Train Loss: 1.266 Vali Loss: 1.172 Vali Acc: 0.880 Test Loss: 1.172 Test Acc: 0.880
Validation loss decreased (-0.846652 --> -0.879988).  Saving model ...
Epoch: 8 cost time: 4.198112487792969
Epoch: 8, Steps: 18 | Train Loss: 0.933 Vali Loss: 0.896 Vali Acc: 0.887 Test Loss: 0.896 Test Acc: 0.887
Validation loss decreased (-0.879988 --> -0.886658).  Saving model ...
Epoch: 9 cost time: 4.004945755004883
Epoch: 9, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.707 Vali Acc: 0.920 Test Loss: 0.707 Test Acc: 0.920
Validation loss decreased (-0.886658 --> -0.919993).  Saving model ...
Epoch: 10 cost time: 4.177364349365234
Epoch: 10, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.577 Vali Acc: 0.923 Test Loss: 0.577 Test Acc: 0.923
Validation loss decreased (-0.919993 --> -0.923328).  Saving model ...
Epoch: 11 cost time: 4.12419581413269
Epoch: 11, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.494 Vali Acc: 0.920 Test Loss: 0.494 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7235429286956787
Epoch: 12, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.423 Vali Acc: 0.923 Test Loss: 0.423 Test Acc: 0.923
Validation loss decreased (-0.923328 --> -0.923329).  Saving model ...
Epoch: 13 cost time: 4.054352045059204
Epoch: 13, Steps: 18 | Train Loss: 0.239 Vali Loss: 0.383 Vali Acc: 0.930 Test Loss: 0.383 Test Acc: 0.930
Validation loss decreased (-0.923329 --> -0.929996).  Saving model ...
Epoch: 14 cost time: 3.9049293994903564
Epoch: 14, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.929996 --> -0.929996).  Saving model ...
Epoch: 15 cost time: 3.8918375968933105
Epoch: 15, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
Validation loss decreased (-0.929996 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 3.721714973449707
Epoch: 16, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.936664).  Saving model ...
Epoch: 17 cost time: 4.098123550415039
Epoch: 17, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.017816543579102
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.289832830429077
Epoch: 19, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.282383441925049
Epoch: 20, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.0853986740112305
Epoch: 21, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
Validation loss decreased (-0.936664 --> -0.939997).  Saving model ...
Epoch: 22 cost time: 4.22149395942688
Epoch: 22, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.190012454986572
Epoch: 23, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.239 Vali Acc: 0.940 Test Loss: 0.239 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939998).  Saving model ...
Epoch: 24 cost time: 3.8491690158843994
Epoch: 24, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.947 Test Loss: 0.234 Test Acc: 0.947
Validation loss decreased (-0.939998 --> -0.946664).  Saving model ...
Epoch: 25 cost time: 4.107438802719116
Epoch: 25, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.946664 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 4.102298736572266
Epoch: 26, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956664).  Saving model ...
Epoch: 27 cost time: 3.7376303672790527
Epoch: 27, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.953 Test Loss: 0.223 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9690327644348145
Epoch: 28, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.876460552215576
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6439590454101562
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 322433
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.925419807434082
Epoch: 1, Steps: 18 | Train Loss: 3.254 Vali Loss: 3.137 Vali Acc: 0.090 Test Loss: 3.137 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 3.053556442260742
Epoch: 2, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.848 Vali Acc: 0.260 Test Loss: 2.848 Test Acc: 0.260
Validation loss decreased (-0.089969 --> -0.259972).  Saving model ...
Epoch: 3 cost time: 3.1889071464538574
Epoch: 3, Steps: 18 | Train Loss: 2.728 Vali Loss: 2.501 Vali Acc: 0.503 Test Loss: 2.501 Test Acc: 0.503
Validation loss decreased (-0.259972 --> -0.503308).  Saving model ...
Epoch: 4 cost time: 3.1469857692718506
Epoch: 4, Steps: 18 | Train Loss: 2.346 Vali Loss: 2.114 Vali Acc: 0.743 Test Loss: 2.114 Test Acc: 0.743
Validation loss decreased (-0.503308 --> -0.743312).  Saving model ...
Epoch: 5 cost time: 2.8261709213256836
Epoch: 5, Steps: 18 | Train Loss: 1.971 Vali Loss: 1.733 Vali Acc: 0.817 Test Loss: 1.733 Test Acc: 0.817
Validation loss decreased (-0.743312 --> -0.816649).  Saving model ...
Epoch: 6 cost time: 3.279062271118164
Epoch: 6, Steps: 18 | Train Loss: 1.558 Vali Loss: 1.386 Vali Acc: 0.897 Test Loss: 1.386 Test Acc: 0.897
Validation loss decreased (-0.816649 --> -0.896653).  Saving model ...
Epoch: 7 cost time: 3.153297185897827
Epoch: 7, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.072 Vali Acc: 0.920 Test Loss: 1.072 Test Acc: 0.920
Validation loss decreased (-0.896653 --> -0.919989).  Saving model ...
Epoch: 8 cost time: 2.9884400367736816
Epoch: 8, Steps: 18 | Train Loss: 0.926 Vali Loss: 0.818 Vali Acc: 0.930 Test Loss: 0.818 Test Acc: 0.930
Validation loss decreased (-0.919989 --> -0.929992).  Saving model ...
Epoch: 9 cost time: 3.2523272037506104
Epoch: 9, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.635 Vali Acc: 0.937 Test Loss: 0.635 Test Acc: 0.937
Validation loss decreased (-0.929992 --> -0.936660).  Saving model ...
Epoch: 10 cost time: 3.1240293979644775
Epoch: 10, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.511 Vali Acc: 0.943 Test Loss: 0.511 Test Acc: 0.943
Validation loss decreased (-0.936660 --> -0.943328).  Saving model ...
Epoch: 11 cost time: 3.2997093200683594
Epoch: 11, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.424 Vali Acc: 0.943 Test Loss: 0.424 Test Acc: 0.943
Validation loss decreased (-0.943328 --> -0.943329).  Saving model ...
Epoch: 12 cost time: 3.112865924835205
Epoch: 12, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.365 Vali Acc: 0.943 Test Loss: 0.365 Test Acc: 0.943
Validation loss decreased (-0.943329 --> -0.943330).  Saving model ...
Epoch: 13 cost time: 3.2182352542877197
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.943330 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 3.210620641708374
Epoch: 14, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.291 Vali Acc: 0.940 Test Loss: 0.291 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.083526611328125
Epoch: 15, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 3.2403929233551025
Epoch: 16, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.249 Vali Acc: 0.953 Test Loss: 0.249 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 17 cost time: 3.144209384918213
Epoch: 17, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1158618927001953
Epoch: 18, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 19 cost time: 3.0817954540252686
Epoch: 19, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 20 cost time: 3.207716226577759
Epoch: 20, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 21 cost time: 3.1802499294281006
Epoch: 21, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 22 cost time: 3.2404391765594482
Epoch: 22, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.364574670791626
Epoch: 23, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963331).  Saving model ...
Epoch: 24 cost time: 3.3439888954162598
Epoch: 24, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 3.260418176651001
Epoch: 25, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.178220510482788
Epoch: 26, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3585410118103027
Epoch: 27, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.385277271270752
Epoch: 28, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 29 cost time: 3.2177693843841553
Epoch: 29, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2651162147521973
Epoch: 30, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 115425
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.413011312484741
Epoch: 1, Steps: 18 | Train Loss: 3.304 Vali Loss: 3.230 Vali Acc: 0.043 Test Loss: 3.230 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 3.0872256755828857
Epoch: 2, Steps: 18 | Train Loss: 3.121 Vali Loss: 2.973 Vali Acc: 0.200 Test Loss: 2.973 Test Acc: 0.200
Validation loss decreased (-0.043301 --> -0.199970).  Saving model ...
Epoch: 3 cost time: 2.8410887718200684
Epoch: 3, Steps: 18 | Train Loss: 2.843 Vali Loss: 2.649 Vali Acc: 0.473 Test Loss: 2.649 Test Acc: 0.473
Validation loss decreased (-0.199970 --> -0.473307).  Saving model ...
Epoch: 4 cost time: 2.856682300567627
Epoch: 4, Steps: 18 | Train Loss: 2.466 Vali Loss: 2.291 Vali Acc: 0.657 Test Loss: 2.291 Test Acc: 0.657
Validation loss decreased (-0.473307 --> -0.656644).  Saving model ...
Epoch: 5 cost time: 3.0881307125091553
Epoch: 5, Steps: 18 | Train Loss: 2.078 Vali Loss: 1.898 Vali Acc: 0.797 Test Loss: 1.898 Test Acc: 0.797
Validation loss decreased (-0.656644 --> -0.796648).  Saving model ...
Epoch: 6 cost time: 2.8679611682891846
Epoch: 6, Steps: 18 | Train Loss: 1.661 Vali Loss: 1.515 Vali Acc: 0.847 Test Loss: 1.515 Test Acc: 0.847
Validation loss decreased (-0.796648 --> -0.846652).  Saving model ...
Epoch: 7 cost time: 2.707289218902588
Epoch: 7, Steps: 18 | Train Loss: 1.269 Vali Loss: 1.174 Vali Acc: 0.880 Test Loss: 1.174 Test Acc: 0.880
Validation loss decreased (-0.846652 --> -0.879988).  Saving model ...
Epoch: 8 cost time: 2.677889823913574
Epoch: 8, Steps: 18 | Train Loss: 0.937 Vali Loss: 0.897 Vali Acc: 0.887 Test Loss: 0.897 Test Acc: 0.887
Validation loss decreased (-0.879988 --> -0.886658).  Saving model ...
Epoch: 9 cost time: 2.456552028656006
Epoch: 9, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.708 Vali Acc: 0.920 Test Loss: 0.708 Test Acc: 0.920
Validation loss decreased (-0.886658 --> -0.919993).  Saving model ...
Epoch: 10 cost time: 2.625164747238159
Epoch: 10, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.578 Vali Acc: 0.927 Test Loss: 0.578 Test Acc: 0.927
Validation loss decreased (-0.919993 --> -0.926661).  Saving model ...
Epoch: 11 cost time: 3.0925180912017822
Epoch: 11, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.495 Vali Acc: 0.917 Test Loss: 0.495 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.89918851852417
Epoch: 12, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.424 Vali Acc: 0.920 Test Loss: 0.424 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.023085832595825
Epoch: 13, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.926661 --> -0.929996).  Saving model ...
Epoch: 14 cost time: 3.2254626750946045
Epoch: 14, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.356 Vali Acc: 0.927 Test Loss: 0.356 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7938692569732666
Epoch: 15, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.328 Vali Acc: 0.923 Test Loss: 0.328 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9344892501831055
Epoch: 16, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.305 Vali Acc: 0.927 Test Loss: 0.305 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.247424602508545
Epoch: 17, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.302 Vali Acc: 0.917 Test Loss: 0.302 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.876537799835205
Epoch: 18, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.281 Vali Acc: 0.923 Test Loss: 0.281 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9021623134613037
Epoch: 19, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.274 Vali Acc: 0.923 Test Loss: 0.274 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.830925941467285
Epoch: 20, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.267 Vali Acc: 0.923 Test Loss: 0.267 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.781522750854492
Epoch: 21, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
Validation loss decreased (-0.929996 --> -0.943331).  Saving model ...
Epoch: 22 cost time: 3.090355157852173
Epoch: 22, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6858482360839844
Epoch: 23, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.940 Test Loss: 0.245 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9560017585754395
Epoch: 24, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.943 Test Loss: 0.237 Test Acc: 0.943
Validation loss decreased (-0.943331 --> -0.943331).  Saving model ...
Epoch: 25 cost time: 3.235147476196289
Epoch: 25, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.947 Test Loss: 0.230 Test Acc: 0.947
Validation loss decreased (-0.943331 --> -0.946664).  Saving model ...
Epoch: 26 cost time: 2.921412944793701
Epoch: 26, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.228 Vali Acc: 0.953 Test Loss: 0.228 Test Acc: 0.953
Validation loss decreased (-0.946664 --> -0.953331).  Saving model ...
Epoch: 27 cost time: 3.0899364948272705
Epoch: 27, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 28 cost time: 3.241107940673828
Epoch: 28, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.172015428543091
Epoch: 29, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2450146675109863
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.947 Test Loss: 0.219 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 322433
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.992810487747192
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.134 Vali Acc: 0.090 Test Loss: 3.134 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 2.970876932144165
Epoch: 2, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.846 Vali Acc: 0.260 Test Loss: 2.846 Test Acc: 0.260
Validation loss decreased (-0.089969 --> -0.259972).  Saving model ...
Epoch: 3 cost time: 2.7020184993743896
Epoch: 3, Steps: 18 | Train Loss: 2.729 Vali Loss: 2.499 Vali Acc: 0.510 Test Loss: 2.499 Test Acc: 0.510
Validation loss decreased (-0.259972 --> -0.509975).  Saving model ...
Epoch: 4 cost time: 2.904186964035034
Epoch: 4, Steps: 18 | Train Loss: 2.347 Vali Loss: 2.112 Vali Acc: 0.747 Test Loss: 2.112 Test Acc: 0.747
Validation loss decreased (-0.509975 --> -0.746646).  Saving model ...
Epoch: 5 cost time: 2.6536943912506104
Epoch: 5, Steps: 18 | Train Loss: 1.973 Vali Loss: 1.731 Vali Acc: 0.820 Test Loss: 1.731 Test Acc: 0.820
Validation loss decreased (-0.746646 --> -0.819983).  Saving model ...
Epoch: 6 cost time: 2.5789976119995117
Epoch: 6, Steps: 18 | Train Loss: 1.561 Vali Loss: 1.385 Vali Acc: 0.897 Test Loss: 1.385 Test Acc: 0.897
Validation loss decreased (-0.819983 --> -0.896653).  Saving model ...
Epoch: 7 cost time: 2.8653855323791504
Epoch: 7, Steps: 18 | Train Loss: 1.193 Vali Loss: 1.071 Vali Acc: 0.920 Test Loss: 1.071 Test Acc: 0.920
Validation loss decreased (-0.896653 --> -0.919989).  Saving model ...
Epoch: 8 cost time: 2.567840814590454
Epoch: 8, Steps: 18 | Train Loss: 0.931 Vali Loss: 0.819 Vali Acc: 0.937 Test Loss: 0.819 Test Acc: 0.937
Validation loss decreased (-0.919989 --> -0.936658).  Saving model ...
Epoch: 9 cost time: 2.3430094718933105
Epoch: 9, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.636 Vali Acc: 0.940 Test Loss: 0.636 Test Acc: 0.940
Validation loss decreased (-0.936658 --> -0.939994).  Saving model ...
Epoch: 10 cost time: 2.3478431701660156
Epoch: 10, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.511 Vali Acc: 0.947 Test Loss: 0.511 Test Acc: 0.947
Validation loss decreased (-0.939994 --> -0.946662).  Saving model ...
Epoch: 11 cost time: 2.6785523891448975
Epoch: 11, Steps: 18 | Train Loss: 0.361 Vali Loss: 0.423 Vali Acc: 0.947 Test Loss: 0.423 Test Acc: 0.947
Validation loss decreased (-0.946662 --> -0.946662).  Saving model ...
Epoch: 12 cost time: 2.930330753326416
Epoch: 12, Steps: 18 | Train Loss: 0.285 Vali Loss: 0.364 Vali Acc: 0.943 Test Loss: 0.364 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5809738636016846
Epoch: 13, Steps: 18 | Train Loss: 0.226 Vali Loss: 0.319 Vali Acc: 0.953 Test Loss: 0.319 Test Acc: 0.953
Validation loss decreased (-0.946662 --> -0.953330).  Saving model ...
Epoch: 14 cost time: 2.7352349758148193
Epoch: 14, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.288 Vali Acc: 0.943 Test Loss: 0.288 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7691516876220703
Epoch: 15, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.263 Vali Acc: 0.953 Test Loss: 0.263 Test Acc: 0.953
Validation loss decreased (-0.953330 --> -0.953331).  Saving model ...
Epoch: 16 cost time: 2.5826756954193115
Epoch: 16, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.246 Vali Acc: 0.957 Test Loss: 0.246 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956664).  Saving model ...
Epoch: 17 cost time: 2.9739723205566406
Epoch: 17, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.231 Vali Acc: 0.953 Test Loss: 0.231 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7198901176452637
Epoch: 18, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.536137819290161
Epoch: 19, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.958677291870117
Epoch: 20, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 21 cost time: 2.8565683364868164
Epoch: 21, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 22 cost time: 2.1313416957855225
Epoch: 22, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8976781368255615
Epoch: 23, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963332).  Saving model ...
Epoch: 24 cost time: 2.9092020988464355
Epoch: 24, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 2.223750591278076
Epoch: 25, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.743405818939209
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.6276824474334717
Epoch: 27, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.168747901916504
Epoch: 28, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 2.5993294715881348
Epoch: 29, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.591283082962036
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 115425
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.951635360717773
Epoch: 1, Steps: 18 | Train Loss: 3.304 Vali Loss: 3.177 Vali Acc: 0.087 Test Loss: 3.177 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 4.077552080154419
Epoch: 2, Steps: 18 | Train Loss: 3.081 Vali Loss: 2.901 Vali Acc: 0.187 Test Loss: 2.901 Test Acc: 0.187
Validation loss decreased (-0.086635 --> -0.186638).  Saving model ...
Epoch: 3 cost time: 3.472461223602295
Epoch: 3, Steps: 18 | Train Loss: 2.724 Vali Loss: 2.560 Vali Acc: 0.480 Test Loss: 2.560 Test Acc: 0.480
Validation loss decreased (-0.186638 --> -0.479974).  Saving model ...
Epoch: 4 cost time: 4.563999176025391
Epoch: 4, Steps: 18 | Train Loss: 2.364 Vali Loss: 2.200 Vali Acc: 0.713 Test Loss: 2.200 Test Acc: 0.713
Validation loss decreased (-0.479974 --> -0.713311).  Saving model ...
Epoch: 5 cost time: 4.174874305725098
Epoch: 5, Steps: 18 | Train Loss: 1.985 Vali Loss: 1.828 Vali Acc: 0.807 Test Loss: 1.828 Test Acc: 0.807
Validation loss decreased (-0.713311 --> -0.806648).  Saving model ...
Epoch: 6 cost time: 4.509237766265869
Epoch: 6, Steps: 18 | Train Loss: 1.573 Vali Loss: 1.470 Vali Acc: 0.830 Test Loss: 1.470 Test Acc: 0.830
Validation loss decreased (-0.806648 --> -0.829985).  Saving model ...
Epoch: 7 cost time: 4.242811918258667
Epoch: 7, Steps: 18 | Train Loss: 1.226 Vali Loss: 1.155 Vali Acc: 0.863 Test Loss: 1.155 Test Acc: 0.863
Validation loss decreased (-0.829985 --> -0.863322).  Saving model ...
Epoch: 8 cost time: 4.4894208908081055
Epoch: 8, Steps: 18 | Train Loss: 0.910 Vali Loss: 0.899 Vali Acc: 0.900 Test Loss: 0.899 Test Acc: 0.900
Validation loss decreased (-0.863322 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 4.19080114364624
Epoch: 9, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.715 Vali Acc: 0.927 Test Loss: 0.715 Test Acc: 0.927
Validation loss decreased (-0.899991 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 4.488180637359619
Epoch: 10, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.586 Vali Acc: 0.940 Test Loss: 0.586 Test Acc: 0.940
Validation loss decreased (-0.926660 --> -0.939994).  Saving model ...
Epoch: 11 cost time: 4.106943130493164
Epoch: 11, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.497 Vali Acc: 0.937 Test Loss: 0.497 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.341223955154419
Epoch: 12, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.435 Vali Acc: 0.943 Test Loss: 0.435 Test Acc: 0.943
Validation loss decreased (-0.939994 --> -0.943329).  Saving model ...
Epoch: 13 cost time: 3.980583429336548
Epoch: 13, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.391 Vali Acc: 0.947 Test Loss: 0.391 Test Acc: 0.947
Validation loss decreased (-0.943329 --> -0.946663).  Saving model ...
Epoch: 14 cost time: 4.365646600723267
Epoch: 14, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.348 Vali Acc: 0.953 Test Loss: 0.348 Test Acc: 0.953
Validation loss decreased (-0.946663 --> -0.953330).  Saving model ...
Epoch: 15 cost time: 4.156105279922485
Epoch: 15, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.325 Vali Acc: 0.943 Test Loss: 0.325 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.1945109367370605
Epoch: 16, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.301 Vali Acc: 0.940 Test Loss: 0.301 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.348045349121094
Epoch: 17, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.285 Vali Acc: 0.947 Test Loss: 0.285 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.722138166427612
Epoch: 18, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.268 Vali Acc: 0.947 Test Loss: 0.268 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.466473579406738
Epoch: 19, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.255 Vali Acc: 0.947 Test Loss: 0.255 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.608334302902222
Epoch: 20, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.345508098602295
Epoch: 21, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.5587780475616455
Epoch: 22, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.231 Vali Acc: 0.947 Test Loss: 0.231 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.19411301612854
Epoch: 23, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 24 cost time: 3.554809331893921
Epoch: 24, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.418586015701294
Epoch: 25, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 26 cost time: 3.861577033996582
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.8332924842834473
Epoch: 27, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.9940249919891357
Epoch: 28, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.11398458480835
Epoch: 29, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 30 cost time: 4.020641803741455
Epoch: 30, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 175809
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.142527341842651
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.142 Vali Acc: 0.070 Test Loss: 3.142 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 3.1758759021759033
Epoch: 2, Steps: 18 | Train Loss: 3.022 Vali Loss: 2.865 Vali Acc: 0.247 Test Loss: 2.865 Test Acc: 0.247
Validation loss decreased (-0.069969 --> -0.246638).  Saving model ...
Epoch: 3 cost time: 3.2625622749328613
Epoch: 3, Steps: 18 | Train Loss: 2.749 Vali Loss: 2.528 Vali Acc: 0.517 Test Loss: 2.528 Test Acc: 0.517
Validation loss decreased (-0.246638 --> -0.516641).  Saving model ...
Epoch: 4 cost time: 3.1597330570220947
Epoch: 4, Steps: 18 | Train Loss: 2.388 Vali Loss: 2.178 Vali Acc: 0.697 Test Loss: 2.178 Test Acc: 0.697
Validation loss decreased (-0.516641 --> -0.696645).  Saving model ...
Epoch: 5 cost time: 2.7890264987945557
Epoch: 5, Steps: 18 | Train Loss: 2.011 Vali Loss: 1.823 Vali Acc: 0.777 Test Loss: 1.823 Test Acc: 0.777
Validation loss decreased (-0.696645 --> -0.776648).  Saving model ...
Epoch: 6 cost time: 2.7824344635009766
Epoch: 6, Steps: 18 | Train Loss: 1.654 Vali Loss: 1.493 Vali Acc: 0.833 Test Loss: 1.493 Test Acc: 0.833
Validation loss decreased (-0.776648 --> -0.833318).  Saving model ...
Epoch: 7 cost time: 3.0055525302886963
Epoch: 7, Steps: 18 | Train Loss: 1.320 Vali Loss: 1.200 Vali Acc: 0.877 Test Loss: 1.200 Test Acc: 0.877
Validation loss decreased (-0.833318 --> -0.876655).  Saving model ...
Epoch: 8 cost time: 3.1867220401763916
Epoch: 8, Steps: 18 | Train Loss: 1.028 Vali Loss: 0.955 Vali Acc: 0.920 Test Loss: 0.955 Test Acc: 0.920
Validation loss decreased (-0.876655 --> -0.919990).  Saving model ...
Epoch: 9 cost time: 3.127500534057617
Epoch: 9, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.763 Vali Acc: 0.917 Test Loss: 0.763 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2339394092559814
Epoch: 10, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.626 Vali Acc: 0.933 Test Loss: 0.626 Test Acc: 0.933
Validation loss decreased (-0.919990 --> -0.933327).  Saving model ...
Epoch: 11 cost time: 2.988003969192505
Epoch: 11, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.933327 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 3.021803855895996
Epoch: 12, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 2.7884933948516846
Epoch: 13, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.394 Vali Acc: 0.963 Test Loss: 0.394 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963329).  Saving model ...
Epoch: 14 cost time: 3.098076105117798
Epoch: 14, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.351 Vali Acc: 0.963 Test Loss: 0.351 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 15 cost time: 3.2284533977508545
Epoch: 15, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.320 Vali Acc: 0.960 Test Loss: 0.320 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2169957160949707
Epoch: 16, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.291 Vali Acc: 0.957 Test Loss: 0.291 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.843416690826416
Epoch: 17, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.269 Vali Acc: 0.963 Test Loss: 0.269 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 18 cost time: 2.920565605163574
Epoch: 18, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.257 Vali Acc: 0.960 Test Loss: 0.257 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.892090082168579
Epoch: 19, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.238 Vali Acc: 0.963 Test Loss: 0.238 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 20 cost time: 3.4223287105560303
Epoch: 20, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0878114700317383
Epoch: 21, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.254265308380127
Epoch: 22, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.877667188644409
Epoch: 23, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.452363967895508
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.282111167907715
Epoch: 25, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4471371173858643
Epoch: 26, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.0798280239105225
Epoch: 27, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.118314504623413
Epoch: 28, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.94840669631958
Epoch: 29, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 72289
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.677694082260132
Epoch: 1, Steps: 18 | Train Loss: 3.304 Vali Loss: 3.177 Vali Acc: 0.087 Test Loss: 3.177 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 3.308945417404175
Epoch: 2, Steps: 18 | Train Loss: 3.081 Vali Loss: 2.901 Vali Acc: 0.187 Test Loss: 2.901 Test Acc: 0.187
Validation loss decreased (-0.086635 --> -0.186638).  Saving model ...
Epoch: 3 cost time: 3.318830966949463
Epoch: 3, Steps: 18 | Train Loss: 2.724 Vali Loss: 2.560 Vali Acc: 0.480 Test Loss: 2.560 Test Acc: 0.480
Validation loss decreased (-0.186638 --> -0.479974).  Saving model ...
Epoch: 4 cost time: 3.351478338241577
Epoch: 4, Steps: 18 | Train Loss: 2.364 Vali Loss: 2.200 Vali Acc: 0.713 Test Loss: 2.200 Test Acc: 0.713
Validation loss decreased (-0.479974 --> -0.713311).  Saving model ...
Epoch: 5 cost time: 3.810631513595581
Epoch: 5, Steps: 18 | Train Loss: 1.985 Vali Loss: 1.828 Vali Acc: 0.807 Test Loss: 1.828 Test Acc: 0.807
Validation loss decreased (-0.713311 --> -0.806648).  Saving model ...
Epoch: 6 cost time: 3.6471047401428223
Epoch: 6, Steps: 18 | Train Loss: 1.573 Vali Loss: 1.470 Vali Acc: 0.830 Test Loss: 1.470 Test Acc: 0.830
Validation loss decreased (-0.806648 --> -0.829985).  Saving model ...
Epoch: 7 cost time: 3.9488677978515625
Epoch: 7, Steps: 18 | Train Loss: 1.226 Vali Loss: 1.155 Vali Acc: 0.863 Test Loss: 1.155 Test Acc: 0.863
Validation loss decreased (-0.829985 --> -0.863322).  Saving model ...
Epoch: 8 cost time: 3.614546775817871
Epoch: 8, Steps: 18 | Train Loss: 0.910 Vali Loss: 0.899 Vali Acc: 0.900 Test Loss: 0.899 Test Acc: 0.900
Validation loss decreased (-0.863322 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 3.595186948776245
Epoch: 9, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.715 Vali Acc: 0.927 Test Loss: 0.715 Test Acc: 0.927
Validation loss decreased (-0.899991 --> -0.926660).  Saving model ...
Epoch: 10 cost time: 4.012569904327393
Epoch: 10, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.586 Vali Acc: 0.940 Test Loss: 0.586 Test Acc: 0.940
Validation loss decreased (-0.926660 --> -0.939994).  Saving model ...
Epoch: 11 cost time: 3.7634968757629395
Epoch: 11, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.497 Vali Acc: 0.937 Test Loss: 0.497 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5007293224334717
Epoch: 12, Steps: 18 | Train Loss: 0.288 Vali Loss: 0.435 Vali Acc: 0.943 Test Loss: 0.435 Test Acc: 0.943
Validation loss decreased (-0.939994 --> -0.943329).  Saving model ...
Epoch: 13 cost time: 3.9290809631347656
Epoch: 13, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.391 Vali Acc: 0.947 Test Loss: 0.391 Test Acc: 0.947
Validation loss decreased (-0.943329 --> -0.946663).  Saving model ...
Epoch: 14 cost time: 3.527130603790283
Epoch: 14, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.348 Vali Acc: 0.953 Test Loss: 0.348 Test Acc: 0.953
Validation loss decreased (-0.946663 --> -0.953330).  Saving model ...
Epoch: 15 cost time: 3.2962005138397217
Epoch: 15, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.325 Vali Acc: 0.943 Test Loss: 0.325 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.904036521911621
Epoch: 16, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.301 Vali Acc: 0.940 Test Loss: 0.301 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3838093280792236
Epoch: 17, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.285 Vali Acc: 0.947 Test Loss: 0.285 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7505955696105957
Epoch: 18, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.268 Vali Acc: 0.947 Test Loss: 0.268 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.963524580001831
Epoch: 19, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.255 Vali Acc: 0.947 Test Loss: 0.255 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5869765281677246
Epoch: 20, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.761023998260498
Epoch: 21, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.140936374664307
Epoch: 22, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.231 Vali Acc: 0.947 Test Loss: 0.231 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.6984755992889404
Epoch: 23, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 24 cost time: 3.8412744998931885
Epoch: 24, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.090151786804199
Epoch: 25, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 26 cost time: 3.649096727371216
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.867729663848877
Epoch: 27, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.911137580871582
Epoch: 28, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.425020694732666
Epoch: 29, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 30 cost time: 3.8327667713165283
Epoch: 30, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 175809
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.087482213973999
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.142 Vali Acc: 0.070 Test Loss: 3.142 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 2.882371187210083
Epoch: 2, Steps: 18 | Train Loss: 3.022 Vali Loss: 2.865 Vali Acc: 0.247 Test Loss: 2.865 Test Acc: 0.247
Validation loss decreased (-0.069969 --> -0.246638).  Saving model ...
Epoch: 3 cost time: 2.7800793647766113
Epoch: 3, Steps: 18 | Train Loss: 2.749 Vali Loss: 2.528 Vali Acc: 0.517 Test Loss: 2.528 Test Acc: 0.517
Validation loss decreased (-0.246638 --> -0.516641).  Saving model ...
Epoch: 4 cost time: 2.692251443862915
Epoch: 4, Steps: 18 | Train Loss: 2.388 Vali Loss: 2.178 Vali Acc: 0.697 Test Loss: 2.178 Test Acc: 0.697
Validation loss decreased (-0.516641 --> -0.696645).  Saving model ...
Epoch: 5 cost time: 2.512977123260498
Epoch: 5, Steps: 18 | Train Loss: 2.011 Vali Loss: 1.823 Vali Acc: 0.777 Test Loss: 1.823 Test Acc: 0.777
Validation loss decreased (-0.696645 --> -0.776648).  Saving model ...
Epoch: 6 cost time: 2.4088900089263916
Epoch: 6, Steps: 18 | Train Loss: 1.654 Vali Loss: 1.493 Vali Acc: 0.833 Test Loss: 1.493 Test Acc: 0.833
Validation loss decreased (-0.776648 --> -0.833318).  Saving model ...
Epoch: 7 cost time: 2.5019874572753906
Epoch: 7, Steps: 18 | Train Loss: 1.321 Vali Loss: 1.200 Vali Acc: 0.877 Test Loss: 1.200 Test Acc: 0.877
Validation loss decreased (-0.833318 --> -0.876655).  Saving model ...
Epoch: 8 cost time: 2.558764696121216
Epoch: 8, Steps: 18 | Train Loss: 1.028 Vali Loss: 0.955 Vali Acc: 0.923 Test Loss: 0.955 Test Acc: 0.923
Validation loss decreased (-0.876655 --> -0.923324).  Saving model ...
Epoch: 9 cost time: 2.7557833194732666
Epoch: 9, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.763 Vali Acc: 0.917 Test Loss: 0.763 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7421927452087402
Epoch: 10, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.625 Vali Acc: 0.933 Test Loss: 0.625 Test Acc: 0.933
Validation loss decreased (-0.923324 --> -0.933327).  Saving model ...
Epoch: 11 cost time: 2.8005692958831787
Epoch: 11, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.520 Vali Acc: 0.950 Test Loss: 0.520 Test Acc: 0.950
Validation loss decreased (-0.933327 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 2.764242649078369
Epoch: 12, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.450 Vali Acc: 0.947 Test Loss: 0.450 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7835566997528076
Epoch: 13, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.394 Vali Acc: 0.963 Test Loss: 0.394 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963329).  Saving model ...
Epoch: 14 cost time: 2.7630105018615723
Epoch: 14, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.350 Vali Acc: 0.963 Test Loss: 0.350 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 15 cost time: 2.780189275741577
Epoch: 15, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.320 Vali Acc: 0.957 Test Loss: 0.320 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.802349805831909
Epoch: 16, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.290 Vali Acc: 0.957 Test Loss: 0.290 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.710304021835327
Epoch: 17, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.268 Vali Acc: 0.963 Test Loss: 0.268 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 18 cost time: 2.4829163551330566
Epoch: 18, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.257 Vali Acc: 0.960 Test Loss: 0.257 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.403465509414673
Epoch: 19, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.237 Vali Acc: 0.963 Test Loss: 0.237 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 20 cost time: 2.2684922218322754
Epoch: 20, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.149757146835327
Epoch: 21, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8729379177093506
Epoch: 22, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.8243179321289062
Epoch: 23, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.9181439876556396
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8053691387176514
Epoch: 25, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.556591749191284
Epoch: 26, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 27 cost time: 3.0103230476379395
Epoch: 27, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9174132347106934
Epoch: 28, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1399972438812256
Epoch: 29, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0032835006713867
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 72289
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.009621858596802
Epoch: 1, Steps: 18 | Train Loss: 3.303 Vali Loss: 3.176 Vali Acc: 0.083 Test Loss: 3.176 Test Acc: 0.083
Validation loss decreased (inf --> -0.083302).  Saving model ...
Epoch: 2 cost time: 3.284721851348877
Epoch: 2, Steps: 18 | Train Loss: 3.080 Vali Loss: 2.900 Vali Acc: 0.180 Test Loss: 2.900 Test Acc: 0.180
Validation loss decreased (-0.083302 --> -0.179971).  Saving model ...
Epoch: 3 cost time: 3.3033244609832764
Epoch: 3, Steps: 18 | Train Loss: 2.724 Vali Loss: 2.559 Vali Acc: 0.483 Test Loss: 2.559 Test Acc: 0.483
Validation loss decreased (-0.179971 --> -0.483308).  Saving model ...
Epoch: 4 cost time: 3.0941593647003174
Epoch: 4, Steps: 18 | Train Loss: 2.366 Vali Loss: 2.200 Vali Acc: 0.713 Test Loss: 2.200 Test Acc: 0.713
Validation loss decreased (-0.483308 --> -0.713311).  Saving model ...
Epoch: 5 cost time: 2.9401800632476807
Epoch: 5, Steps: 18 | Train Loss: 1.987 Vali Loss: 1.828 Vali Acc: 0.807 Test Loss: 1.828 Test Acc: 0.807
Validation loss decreased (-0.713311 --> -0.806648).  Saving model ...
Epoch: 6 cost time: 2.9290473461151123
Epoch: 6, Steps: 18 | Train Loss: 1.575 Vali Loss: 1.471 Vali Acc: 0.827 Test Loss: 1.471 Test Acc: 0.827
Validation loss decreased (-0.806648 --> -0.826652).  Saving model ...
Epoch: 7 cost time: 3.135704517364502
Epoch: 7, Steps: 18 | Train Loss: 1.229 Vali Loss: 1.156 Vali Acc: 0.867 Test Loss: 1.156 Test Acc: 0.867
Validation loss decreased (-0.826652 --> -0.866655).  Saving model ...
Epoch: 8 cost time: 2.9902820587158203
Epoch: 8, Steps: 18 | Train Loss: 0.914 Vali Loss: 0.899 Vali Acc: 0.897 Test Loss: 0.899 Test Acc: 0.897
Validation loss decreased (-0.866655 --> -0.896658).  Saving model ...
Epoch: 9 cost time: 3.2589266300201416
Epoch: 9, Steps: 18 | Train Loss: 0.685 Vali Loss: 0.714 Vali Acc: 0.920 Test Loss: 0.714 Test Acc: 0.920
Validation loss decreased (-0.896658 --> -0.919993).  Saving model ...
Epoch: 10 cost time: 2.897146224975586
Epoch: 10, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.585 Vali Acc: 0.937 Test Loss: 0.585 Test Acc: 0.937
Validation loss decreased (-0.919993 --> -0.936661).  Saving model ...
Epoch: 11 cost time: 3.164097309112549
Epoch: 11, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.495 Vali Acc: 0.937 Test Loss: 0.495 Test Acc: 0.937
Validation loss decreased (-0.936661 --> -0.936662).  Saving model ...
Epoch: 12 cost time: 2.844651460647583
Epoch: 12, Steps: 18 | Train Loss: 0.293 Vali Loss: 0.432 Vali Acc: 0.943 Test Loss: 0.432 Test Acc: 0.943
Validation loss decreased (-0.936662 --> -0.943329).  Saving model ...
Epoch: 13 cost time: 3.099205493927002
Epoch: 13, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.387 Vali Acc: 0.940 Test Loss: 0.387 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.147122859954834
Epoch: 14, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.943329 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 2.8639814853668213
Epoch: 15, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.320 Vali Acc: 0.940 Test Loss: 0.320 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2576613426208496
Epoch: 16, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.295 Vali Acc: 0.953 Test Loss: 0.295 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953330).  Saving model ...
Epoch: 17 cost time: 3.0755436420440674
Epoch: 17, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 18 cost time: 3.138371229171753
Epoch: 18, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2367613315582275
Epoch: 19, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.249 Vali Acc: 0.953 Test Loss: 0.249 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.340217113494873
Epoch: 20, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9722697734832764
Epoch: 21, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.162984848022461
Epoch: 22, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9162847995758057
Epoch: 23, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 24 cost time: 3.1355183124542236
Epoch: 24, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 25 cost time: 2.9722487926483154
Epoch: 25, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 26 cost time: 3.1198654174804688
Epoch: 26, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 27 cost time: 2.7698731422424316
Epoch: 27, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0789475440979004
Epoch: 28, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8752079010009766
Epoch: 29, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.042503833770752
Epoch: 30, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 175809
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.705575466156006
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.142 Vali Acc: 0.070 Test Loss: 3.142 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 2.694025754928589
Epoch: 2, Steps: 18 | Train Loss: 3.022 Vali Loss: 2.865 Vali Acc: 0.247 Test Loss: 2.865 Test Acc: 0.247
Validation loss decreased (-0.069969 --> -0.246638).  Saving model ...
Epoch: 3 cost time: 2.4550466537475586
Epoch: 3, Steps: 18 | Train Loss: 2.749 Vali Loss: 2.529 Vali Acc: 0.517 Test Loss: 2.529 Test Acc: 0.517
Validation loss decreased (-0.246638 --> -0.516641).  Saving model ...
Epoch: 4 cost time: 2.3854620456695557
Epoch: 4, Steps: 18 | Train Loss: 2.391 Vali Loss: 2.179 Vali Acc: 0.697 Test Loss: 2.179 Test Acc: 0.697
Validation loss decreased (-0.516641 --> -0.696645).  Saving model ...
Epoch: 5 cost time: 2.385380983352661
Epoch: 5, Steps: 18 | Train Loss: 2.012 Vali Loss: 1.824 Vali Acc: 0.773 Test Loss: 1.824 Test Acc: 0.773
Validation loss decreased (-0.696645 --> -0.773315).  Saving model ...
Epoch: 6 cost time: 2.679259777069092
Epoch: 6, Steps: 18 | Train Loss: 1.655 Vali Loss: 1.494 Vali Acc: 0.840 Test Loss: 1.494 Test Acc: 0.840
Validation loss decreased (-0.773315 --> -0.839985).  Saving model ...
Epoch: 7 cost time: 2.587254285812378
Epoch: 7, Steps: 18 | Train Loss: 1.323 Vali Loss: 1.200 Vali Acc: 0.883 Test Loss: 1.200 Test Acc: 0.883
Validation loss decreased (-0.839985 --> -0.883321).  Saving model ...
Epoch: 8 cost time: 2.3693158626556396
Epoch: 8, Steps: 18 | Train Loss: 1.029 Vali Loss: 0.954 Vali Acc: 0.923 Test Loss: 0.954 Test Acc: 0.923
Validation loss decreased (-0.883321 --> -0.923324).  Saving model ...
Epoch: 9 cost time: 2.5373377799987793
Epoch: 9, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.761 Vali Acc: 0.927 Test Loss: 0.761 Test Acc: 0.927
Validation loss decreased (-0.923324 --> -0.926659).  Saving model ...
Epoch: 10 cost time: 2.477834463119507
Epoch: 10, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.623 Vali Acc: 0.940 Test Loss: 0.623 Test Acc: 0.940
Validation loss decreased (-0.926659 --> -0.939994).  Saving model ...
Epoch: 11 cost time: 2.545620918273926
Epoch: 11, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.518 Vali Acc: 0.953 Test Loss: 0.518 Test Acc: 0.953
Validation loss decreased (-0.939994 --> -0.953328).  Saving model ...
Epoch: 12 cost time: 2.527240753173828
Epoch: 12, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6140880584716797
Epoch: 13, Steps: 18 | Train Loss: 0.286 Vali Loss: 0.392 Vali Acc: 0.960 Test Loss: 0.392 Test Acc: 0.960
Validation loss decreased (-0.953328 --> -0.959996).  Saving model ...
Epoch: 14 cost time: 2.5537798404693604
Epoch: 14, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.349 Vali Acc: 0.970 Test Loss: 0.349 Test Acc: 0.970
Validation loss decreased (-0.959996 --> -0.969997).  Saving model ...
Epoch: 15 cost time: 2.495527744293213
Epoch: 15, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.319 Vali Acc: 0.957 Test Loss: 0.319 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.458386182785034
Epoch: 16, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.290 Vali Acc: 0.960 Test Loss: 0.290 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6092326641082764
Epoch: 17, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.269 Vali Acc: 0.960 Test Loss: 0.269 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.770364761352539
Epoch: 18, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.258 Vali Acc: 0.957 Test Loss: 0.258 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.850778341293335
Epoch: 19, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.239 Vali Acc: 0.960 Test Loss: 0.239 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6731512546539307
Epoch: 20, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.226 Vali Acc: 0.960 Test Loss: 0.226 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.561211109161377
Epoch: 21, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.218 Vali Acc: 0.960 Test Loss: 0.218 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6407487392425537
Epoch: 22, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.8006808757781982
Epoch: 23, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7734479904174805
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_TimesNet_UEA_ftM_sl144_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 72289
model size : 0.44MB
