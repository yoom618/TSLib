Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 26.139609813690186
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.445 Vali Acc: 0.528 Test Loss: 1.445 Test Acc: 0.528
Validation loss decreased (inf --> -0.527763).  Saving model ...
Epoch: 2 cost time: 28.75233554840088
Epoch: 2, Steps: 12 | Train Loss: 1.198 Vali Loss: 0.873 Vali Acc: 0.733 Test Loss: 0.873 Test Acc: 0.733
Validation loss decreased (-0.527763 --> -0.733325).  Saving model ...
Epoch: 3 cost time: 29.00884222984314
Epoch: 3, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761105).  Saving model ...
Epoch: 4 cost time: 26.006402015686035
Epoch: 4, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.477 Vali Acc: 0.778 Test Loss: 0.477 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 27.504783153533936
Epoch: 5, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
Validation loss decreased (-0.777773 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 27.402936697006226
Epoch: 6, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 27.994760751724243
Epoch: 7, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.440 Vali Acc: 0.811 Test Loss: 0.440 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 28.591063261032104
Epoch: 8, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 26.579133987426758
Epoch: 9, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 28.559695720672607
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 28.43888759613037
Epoch: 11, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 27.551079988479614
Epoch: 12, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 28.443350553512573
Epoch: 13, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 28.07346224784851
Epoch: 14, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.274993419647217
Epoch: 15, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 27.52768349647522
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 27.138527631759644
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 27.565264225006104
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 26.630707025527954
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 28.616920232772827
Epoch: 20, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 27.576974153518677
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.536 Vali Acc: 0.872 Test Loss: 0.536 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 28.52073836326599
Epoch: 22, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.152 Vali Acc: 0.917 Test Loss: 0.152 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 28.33825135231018
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.335 Vali Acc: 0.911 Test Loss: 0.335 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 26.942575216293335
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 27.404381275177002
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
Validation loss decreased (-0.922220 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 26.4334979057312
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.944441 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 25.93077540397644
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 27.415008306503296
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 27.18483805656433
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 27.71103000640869
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 75031558
model size : 288.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 10.61268162727356
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.544 Vali Acc: 0.450 Test Loss: 1.544 Test Acc: 0.450
Validation loss decreased (inf --> -0.449985).  Saving model ...
Epoch: 2 cost time: 8.471930027008057
Epoch: 2, Steps: 12 | Train Loss: 1.299 Vali Loss: 0.971 Vali Acc: 0.678 Test Loss: 0.971 Test Acc: 0.678
Validation loss decreased (-0.449985 --> -0.677768).  Saving model ...
Epoch: 3 cost time: 8.941816329956055
Epoch: 3, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
Validation loss decreased (-0.677768 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 8.414013862609863
Epoch: 4, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.472 Vali Acc: 0.794 Test Loss: 0.472 Test Acc: 0.794
Validation loss decreased (-0.738882 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 9.066675186157227
Epoch: 5, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.794440 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 8.121151685714722
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 7 cost time: 9.154728889465332
Epoch: 7, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.445 Vali Acc: 0.822 Test Loss: 0.445 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.619078636169434
Epoch: 8, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.773708820343018
Epoch: 9, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.279 Vali Acc: 0.844 Test Loss: 0.279 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.991753578186035
Epoch: 10, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.293 Vali Acc: 0.844 Test Loss: 0.293 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.87661600112915
Epoch: 11, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.211 Vali Acc: 0.889 Test Loss: 0.211 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888887).  Saving model ...
Epoch: 12 cost time: 8.450362205505371
Epoch: 12, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
Validation loss decreased (-0.888887 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 8.979333639144897
Epoch: 13, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.911109 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 8.613547563552856
Epoch: 14, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.862 Vali Acc: 0.828 Test Loss: 0.862 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.844416856765747
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.803070068359375
Epoch: 16, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.815813064575195
Epoch: 17, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.832396268844604
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.757070064544678
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.461 Vali Acc: 0.878 Test Loss: 0.461 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.9319486618042
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.342 Vali Acc: 0.906 Test Loss: 0.342 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.057631254196167
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.369015216827393
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
Validation loss decreased (-0.949998 --> -0.961109).  Saving model ...
Epoch: 23 cost time: 8.702842473983765
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.219544649124146
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.728981018066406
Epoch: 25, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.199652433395386
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.689646482467651
Epoch: 27, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.911 Test Loss: 0.294 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.226718664169312
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 8.733625888824463
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.168387174606323
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 22075398
model size : 86.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 23.939770221710205
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.445 Vali Acc: 0.528 Test Loss: 1.445 Test Acc: 0.528
Validation loss decreased (inf --> -0.527763).  Saving model ...
Epoch: 2 cost time: 21.376281261444092
Epoch: 2, Steps: 12 | Train Loss: 1.198 Vali Loss: 0.873 Vali Acc: 0.733 Test Loss: 0.873 Test Acc: 0.733
Validation loss decreased (-0.527763 --> -0.733325).  Saving model ...
Epoch: 3 cost time: 21.770142078399658
Epoch: 3, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.578 Vali Acc: 0.761 Test Loss: 0.578 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761105).  Saving model ...
Epoch: 4 cost time: 22.01787805557251
Epoch: 4, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.477 Vali Acc: 0.772 Test Loss: 0.477 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 21.314245462417603
Epoch: 5, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
Validation loss decreased (-0.772217 --> -0.833329).  Saving model ...
Epoch: 6 cost time: 21.497397661209106
Epoch: 6, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.320 Vali Acc: 0.833 Test Loss: 0.320 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 19.903379201889038
Epoch: 7, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.440 Vali Acc: 0.811 Test Loss: 0.440 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.3812997341156
Epoch: 8, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 20.207488536834717
Epoch: 9, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.642113208770752
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.299 Vali Acc: 0.867 Test Loss: 0.299 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 21.954508066177368
Epoch: 11, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.23128890991211
Epoch: 12, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.835744619369507
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 20.557002782821655
Epoch: 14, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.32944965362549
Epoch: 15, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
Validation loss decreased (-0.872219 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 20.350626707077026
Epoch: 16, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.383 Vali Acc: 0.883 Test Loss: 0.383 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.630813121795654
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.229 Vali Acc: 0.889 Test Loss: 0.229 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 20.29216432571411
Epoch: 18, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 19.326801538467407
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.216 Vali Acc: 0.917 Test Loss: 0.216 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 20.008602619171143
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.168 Vali Acc: 0.939 Test Loss: 0.168 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 21 cost time: 20.96480655670166
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 20.77786087989807
Epoch: 22, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.207 Vali Acc: 0.894 Test Loss: 0.207 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 21.608717679977417
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 21.084412813186646
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 21.297422170639038
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 20.09074378013611
Epoch: 26, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 18.189958810806274
Epoch: 27, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 20.428303241729736
Epoch: 28, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.373 Vali Acc: 0.894 Test Loss: 0.373 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 20.426170825958252
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 20.14069890975952
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.617 Vali Acc: 0.911 Test Loss: 0.617 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 75031558
model size : 288.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.300402164459229
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.544 Vali Acc: 0.450 Test Loss: 1.544 Test Acc: 0.450
Validation loss decreased (inf --> -0.449985).  Saving model ...
Epoch: 2 cost time: 7.1856303215026855
Epoch: 2, Steps: 12 | Train Loss: 1.299 Vali Loss: 0.971 Vali Acc: 0.678 Test Loss: 0.971 Test Acc: 0.678
Validation loss decreased (-0.449985 --> -0.677768).  Saving model ...
Epoch: 3 cost time: 6.792322158813477
Epoch: 3, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.644 Vali Acc: 0.739 Test Loss: 0.644 Test Acc: 0.739
Validation loss decreased (-0.677768 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 7.230650901794434
Epoch: 4, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.472 Vali Acc: 0.794 Test Loss: 0.472 Test Acc: 0.794
Validation loss decreased (-0.738882 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 6.532315969467163
Epoch: 5, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.794440 --> -0.849996).  Saving model ...
Epoch: 6 cost time: 7.233370780944824
Epoch: 6, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 7 cost time: 6.513469696044922
Epoch: 7, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.1954121589660645
Epoch: 8, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.856009244918823
Epoch: 9, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.281 Vali Acc: 0.844 Test Loss: 0.281 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.038899898529053
Epoch: 10, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.477113246917725
Epoch: 11, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.210 Vali Acc: 0.889 Test Loss: 0.210 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888887).  Saving model ...
Epoch: 12 cost time: 6.968231678009033
Epoch: 12, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
Validation loss decreased (-0.888887 --> -0.927776).  Saving model ...
Epoch: 13 cost time: 6.9222564697265625
Epoch: 13, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 6.573577642440796
Epoch: 14, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.061427354812622
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.527827262878418
Epoch: 16, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.212 Vali Acc: 0.856 Test Loss: 0.212 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.069472789764404
Epoch: 17, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.667909383773804
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.447 Vali Acc: 0.861 Test Loss: 0.447 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.107129096984863
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.490 Vali Acc: 0.883 Test Loss: 0.490 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.586039304733276
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.134389638900757
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.213 Vali Acc: 0.939 Test Loss: 0.213 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.074400901794434
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.944 Test Loss: 0.152 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 6.8899030685424805
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.429 Vali Acc: 0.917 Test Loss: 0.429 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.4788548946380615
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.756786823272705
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.328 Vali Acc: 0.933 Test Loss: 0.328 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.540957450866699
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.255 Vali Acc: 0.939 Test Loss: 0.255 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.649842977523804
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.622127294540405
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.323 Vali Acc: 0.883 Test Loss: 0.323 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.585255861282349
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.15335488319397
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 22075398
model size : 86.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 12.874729633331299
Epoch: 1, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.457 Vali Acc: 0.522 Test Loss: 1.457 Test Acc: 0.522
Validation loss decreased (inf --> -0.522208).  Saving model ...
Epoch: 2 cost time: 10.579869747161865
Epoch: 2, Steps: 12 | Train Loss: 1.199 Vali Loss: 0.907 Vali Acc: 0.717 Test Loss: 0.907 Test Acc: 0.717
Validation loss decreased (-0.522208 --> -0.716658).  Saving model ...
Epoch: 3 cost time: 10.55240797996521
Epoch: 3, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.608 Vali Acc: 0.744 Test Loss: 0.608 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 10.836811304092407
Epoch: 4, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.500 Vali Acc: 0.767 Test Loss: 0.500 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 11.394243717193604
Epoch: 5, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 10.85658860206604
Epoch: 6, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 11.344000339508057
Epoch: 7, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.452 Vali Acc: 0.806 Test Loss: 0.452 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.88521432876587
Epoch: 8, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.361 Vali Acc: 0.844 Test Loss: 0.361 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 11.36805510520935
Epoch: 9, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.910964488983154
Epoch: 10, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 11 cost time: 11.334414005279541
Epoch: 11, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.9083993434906
Epoch: 12, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.317 Vali Acc: 0.867 Test Loss: 0.317 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.564181327819824
Epoch: 13, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 11.058439254760742
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.582699060440063
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 11.186608791351318
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927776).  Saving model ...
Epoch: 17 cost time: 11.57984209060669
Epoch: 17, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.213 Vali Acc: 0.917 Test Loss: 0.213 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.323641777038574
Epoch: 18, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.148 Vali Acc: 0.933 Test Loss: 0.148 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 19 cost time: 11.487554788589478
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.399 Vali Acc: 0.883 Test Loss: 0.399 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.6198410987854
Epoch: 20, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.381 Vali Acc: 0.878 Test Loss: 0.381 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.207727670669556
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.281703233718872
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.199 Vali Acc: 0.917 Test Loss: 0.199 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.265685558319092
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.251029253005981
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 11.009873390197754
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.468 Vali Acc: 0.906 Test Loss: 0.468 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 11.361443758010864
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.170 Vali Acc: 0.939 Test Loss: 0.170 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 10.919341564178467
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.362608432769775
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 10.891804456710815
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 8.77757453918457
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.456 Vali Acc: 0.911 Test Loss: 0.456 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 75031558
model size : 288.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.2499306201934814
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.559 Vali Acc: 0.439 Test Loss: 1.559 Test Acc: 0.439
Validation loss decreased (inf --> -0.438873).  Saving model ...
Epoch: 2 cost time: 4.2532875537872314
Epoch: 2, Steps: 12 | Train Loss: 1.301 Vali Loss: 1.010 Vali Acc: 0.656 Test Loss: 1.010 Test Acc: 0.656
Validation loss decreased (-0.438873 --> -0.655545).  Saving model ...
Epoch: 3 cost time: 4.67280650138855
Epoch: 3, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
Validation loss decreased (-0.655545 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 4.189683437347412
Epoch: 4, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
Validation loss decreased (-0.716660 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 4.5606162548065186
Epoch: 5, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.783328 --> -0.844441).  Saving model ...
Epoch: 6 cost time: 4.182279825210571
Epoch: 6, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883330).  Saving model ...
Epoch: 7 cost time: 4.606875658035278
Epoch: 7, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.037852764129639
Epoch: 8, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.298272132873535
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.296 Vali Acc: 0.839 Test Loss: 0.296 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9959311485290527
Epoch: 10, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.363488674163818
Epoch: 11, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.883330 --> -0.927776).  Saving model ...
Epoch: 12 cost time: 4.031393051147461
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.1931493282318115
Epoch: 13, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8071413040161133
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.196380853652954
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.833481788635254
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.1956212520599365
Epoch: 17, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.926543951034546
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.021568775177002
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.8176708221435547
Epoch: 20, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
Validation loss decreased (-0.927776 --> -0.949999).  Saving model ...
Epoch: 21 cost time: 4.0131189823150635
Epoch: 21, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.129214525222778
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
Validation loss decreased (-0.949999 --> -0.966665).  Saving model ...
Epoch: 23 cost time: 3.929741621017456
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.23982048034668
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.9030661582946777
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.2873899936676025
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.956 Test Loss: 0.124 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.893528938293457
Epoch: 27, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.285578012466431
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.331775188446045
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.461014747619629
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.366 Vali Acc: 0.917 Test Loss: 0.366 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9666666666666667
model parameter : 22075398
model size : 86.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 17.062634229660034
Epoch: 1, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.455 Vali Acc: 0.578 Test Loss: 1.455 Test Acc: 0.578
Validation loss decreased (inf --> -0.577763).  Saving model ...
Epoch: 2 cost time: 15.24650263786316
Epoch: 2, Steps: 12 | Train Loss: 1.236 Vali Loss: 0.960 Vali Acc: 0.728 Test Loss: 0.960 Test Acc: 0.728
Validation loss decreased (-0.577763 --> -0.727768).  Saving model ...
Epoch: 3 cost time: 13.487080097198486
Epoch: 3, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 16.455148220062256
Epoch: 4, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 16.06993055343628
Epoch: 5, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.388 Vali Acc: 0.806 Test Loss: 0.388 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 16.74376344680786
Epoch: 6, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 16.405483961105347
Epoch: 7, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 15.871562719345093
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.497376441955566
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 15.523860216140747
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.204805850982666
Epoch: 11, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.274 Vali Acc: 0.850 Test Loss: 0.274 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.40866208076477
Epoch: 12, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
Validation loss decreased (-0.861108 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 15.435379028320312
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.404 Vali Acc: 0.856 Test Loss: 0.404 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.82511305809021
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.54608917236328
Epoch: 15, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 16 cost time: 16.307737350463867
Epoch: 16, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 17 cost time: 16.84663414955139
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 15.894423246383667
Epoch: 18, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.413 Vali Acc: 0.917 Test Loss: 0.413 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 16.645073652267456
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 16.447850227355957
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 15.841279745101929
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.933 Test Loss: 0.152 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 22 cost time: 16.46088171005249
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.558 Vali Acc: 0.917 Test Loss: 0.558 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.48020339012146
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.222693681716919
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
Validation loss decreased (-0.933332 --> -0.949999).  Saving model ...
Epoch: 25 cost time: 15.699597120285034
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 15.461925268173218
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (-0.949999 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 15.782983779907227
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 16.102641820907593
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 15.324479103088379
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.961 Test Loss: 0.114 Test Acc: 0.961
Validation loss decreased (-0.955554 --> -0.961110).  Saving model ...
Epoch: 30 cost time: 16.56628918647766
Epoch: 30, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.446 Vali Acc: 0.917 Test Loss: 0.446 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 37541894
model size : 145.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.804429292678833
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.551 Vali Acc: 0.411 Test Loss: 1.551 Test Acc: 0.411
Validation loss decreased (inf --> -0.411096).  Saving model ...
Epoch: 2 cost time: 5.664983749389648
Epoch: 2, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.096 Vali Acc: 0.628 Test Loss: 1.096 Test Acc: 0.628
Validation loss decreased (-0.411096 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 6.010677814483643
Epoch: 3, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.627767 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 6.049363613128662
Epoch: 4, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.575 Vali Acc: 0.728 Test Loss: 0.575 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.876488924026489
Epoch: 5, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.460 Vali Acc: 0.767 Test Loss: 0.460 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 5.717836141586304
Epoch: 6, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
Validation loss decreased (-0.766662 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 6.0697996616363525
Epoch: 7, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.329 Vali Acc: 0.822 Test Loss: 0.329 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.018450975418091
Epoch: 8, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 5.6201512813568115
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.266 Vali Acc: 0.856 Test Loss: 0.266 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 6.070385932922363
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 6.034610033035278
Epoch: 11, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.8853759765625
Epoch: 12, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.299 Vali Acc: 0.861 Test Loss: 0.299 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.876684904098511
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.010006427764893
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.233 Vali Acc: 0.883 Test Loss: 0.233 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.112338066101074
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.190 Vali Acc: 0.911 Test Loss: 0.190 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 5.899296998977661
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.871232032775879
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.911109 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 6.0890936851501465
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.939 Test Loss: 0.254 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.077237606048584
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.773168087005615
Epoch: 20, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.331 Vali Acc: 0.917 Test Loss: 0.331 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.963306903839111
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.626760244369507
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.911678075790405
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.734815359115601
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.919874668121338
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.350 Vali Acc: 0.939 Test Loss: 0.350 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.4795238971710205
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.939 Test Loss: 0.386 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.985560417175293
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.933 Test Loss: 0.347 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 11063302
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 12.841597080230713
Epoch: 1, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.455 Vali Acc: 0.578 Test Loss: 1.455 Test Acc: 0.578
Validation loss decreased (inf --> -0.577763).  Saving model ...
Epoch: 2 cost time: 10.807372808456421
Epoch: 2, Steps: 12 | Train Loss: 1.236 Vali Loss: 0.960 Vali Acc: 0.728 Test Loss: 0.960 Test Acc: 0.728
Validation loss decreased (-0.577763 --> -0.727768).  Saving model ...
Epoch: 3 cost time: 10.979339122772217
Epoch: 3, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 11.213399410247803
Epoch: 4, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 5 cost time: 11.578786611557007
Epoch: 5, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.388 Vali Acc: 0.806 Test Loss: 0.388 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805552).  Saving model ...
Epoch: 6 cost time: 11.289469718933105
Epoch: 6, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 11.247456312179565
Epoch: 7, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.288 Vali Acc: 0.850 Test Loss: 0.288 Test Acc: 0.850
Validation loss decreased (-0.822219 --> -0.849997).  Saving model ...
Epoch: 8 cost time: 11.188116073608398
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.082804918289185
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 11.184880256652832
Epoch: 10, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.406 Vali Acc: 0.817 Test Loss: 0.406 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.054139614105225
Epoch: 11, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.273 Vali Acc: 0.850 Test Loss: 0.273 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.780956029891968
Epoch: 12, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
Validation loss decreased (-0.861108 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 10.248696327209473
Epoch: 13, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.407 Vali Acc: 0.856 Test Loss: 0.407 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.373334884643555
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.36768889427185
Epoch: 15, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 10.568248987197876
Epoch: 16, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.948326349258423
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 8.74514889717102
Epoch: 18, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.447634220123291
Epoch: 19, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.025487422943115
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.116822242736816
Epoch: 21, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 11.827244997024536
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.461 Vali Acc: 0.928 Test Loss: 0.461 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.281352043151855
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.830283403396606
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.599 Vali Acc: 0.894 Test Loss: 0.599 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.819025993347168
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.794374942779541
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.117385625839233
Epoch: 27, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 11.830878019332886
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 11.767356395721436
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 11.633639097213745
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.956 Test Loss: 0.260 Test Acc: 0.956
Validation loss decreased (-0.933331 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 37541894
model size : 145.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.587734222412109
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.551 Vali Acc: 0.411 Test Loss: 1.551 Test Acc: 0.411
Validation loss decreased (inf --> -0.411096).  Saving model ...
Epoch: 2 cost time: 5.07670259475708
Epoch: 2, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.096 Vali Acc: 0.628 Test Loss: 1.096 Test Acc: 0.628
Validation loss decreased (-0.411096 --> -0.627767).  Saving model ...
Epoch: 3 cost time: 5.035512208938599
Epoch: 3, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.627767 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 4.911827802658081
Epoch: 4, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.575 Vali Acc: 0.728 Test Loss: 0.575 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.346013784408569
Epoch: 5, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.460 Vali Acc: 0.767 Test Loss: 0.460 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766662).  Saving model ...
Epoch: 6 cost time: 5.070921897888184
Epoch: 6, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
Validation loss decreased (-0.766662 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 4.9954307079315186
Epoch: 7, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.329 Vali Acc: 0.822 Test Loss: 0.329 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.908322334289551
Epoch: 8, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 4.98943305015564
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.266 Vali Acc: 0.856 Test Loss: 0.266 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 10 cost time: 5.025848627090454
Epoch: 10, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 4.670883655548096
Epoch: 11, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.0056586265563965
Epoch: 12, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.9990270137786865
Epoch: 13, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.763185501098633
Epoch: 14, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.234 Vali Acc: 0.883 Test Loss: 0.234 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.703326463699341
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.192 Vali Acc: 0.911 Test Loss: 0.192 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 4.991349458694458
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.9233338832855225
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 18 cost time: 4.879075765609741
Epoch: 18, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.9741010665893555
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.987210273742676
Epoch: 20, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.79153847694397
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.787107706069946
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 4.94823145866394
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.821440935134888
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.701686382293701
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.939 Test Loss: 0.238 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.128367900848389
Epoch: 26, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.0176496505737305
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.965696096420288
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 5.057491779327393
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.448 Vali Acc: 0.939 Test Loss: 0.448 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.0685484409332275
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.465 Vali Acc: 0.933 Test Loss: 0.465 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 11063302
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.906656265258789
Epoch: 1, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.462 Vali Acc: 0.572 Test Loss: 1.462 Test Acc: 0.572
Validation loss decreased (inf --> -0.572208).  Saving model ...
Epoch: 2 cost time: 6.693248271942139
Epoch: 2, Steps: 12 | Train Loss: 1.238 Vali Loss: 0.978 Vali Acc: 0.722 Test Loss: 0.978 Test Acc: 0.722
Validation loss decreased (-0.572208 --> -0.722212).  Saving model ...
Epoch: 3 cost time: 7.075564622879028
Epoch: 3, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738882).  Saving model ...
Epoch: 4 cost time: 7.072489261627197
Epoch: 4, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.527 Vali Acc: 0.767 Test Loss: 0.527 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 5 cost time: 6.787059307098389
Epoch: 5, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.415 Vali Acc: 0.800 Test Loss: 0.415 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 7.1126508712768555
Epoch: 6, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
Validation loss decreased (-0.799996 --> -0.822219).  Saving model ...
Epoch: 7 cost time: 6.7106475830078125
Epoch: 7, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
Validation loss decreased (-0.822219 --> -0.844441).  Saving model ...
Epoch: 8 cost time: 6.798761367797852
Epoch: 8, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.339 Vali Acc: 0.828 Test Loss: 0.339 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.564199686050415
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 6.389069557189941
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.431 Vali Acc: 0.822 Test Loss: 0.431 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.6336729526519775
Epoch: 11, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.266 Vali Acc: 0.867 Test Loss: 0.266 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 6.289502382278442
Epoch: 12, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.866664 --> -0.922220).  Saving model ...
Epoch: 13 cost time: 6.676836252212524
Epoch: 13, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.56307053565979
Epoch: 14, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.825055360794067
Epoch: 15, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.190 Vali Acc: 0.917 Test Loss: 0.190 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.768919944763184
Epoch: 16, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 17 cost time: 4.832022190093994
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 18 cost time: 5.5602617263793945
Epoch: 18, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.402 Vali Acc: 0.906 Test Loss: 0.402 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.160197496414185
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.937984228134155
Epoch: 20, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.600781202316284
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.962520599365234
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.300 Vali Acc: 0.939 Test Loss: 0.300 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938886).  Saving model ...
Epoch: 23 cost time: 6.702073097229004
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.438837766647339
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.922 Test Loss: 0.163 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.120505094528198
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.399 Vali Acc: 0.933 Test Loss: 0.399 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.508025169372559
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.933 Test Loss: 0.159 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.865268707275391
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.360927581787109
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.529 Vali Acc: 0.889 Test Loss: 0.529 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.2790679931640625
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.938886 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 6.505889415740967
Epoch: 30, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.287 Vali Acc: 0.906 Test Loss: 0.287 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 37541894
model size : 145.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.940196990966797
Epoch: 1, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.554 Vali Acc: 0.411 Test Loss: 1.554 Test Acc: 0.411
Validation loss decreased (inf --> -0.411096).  Saving model ...
Epoch: 2 cost time: 2.9797892570495605
Epoch: 2, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.106 Vali Acc: 0.622 Test Loss: 1.106 Test Acc: 0.622
Validation loss decreased (-0.411096 --> -0.622211).  Saving model ...
Epoch: 3 cost time: 3.092355489730835
Epoch: 3, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.761 Vali Acc: 0.733 Test Loss: 0.761 Test Acc: 0.733
Validation loss decreased (-0.622211 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 3.221458673477173
Epoch: 4, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.016892194747925
Epoch: 5, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.480 Vali Acc: 0.756 Test Loss: 0.480 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755551).  Saving model ...
Epoch: 6 cost time: 3.3689889907836914
Epoch: 6, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
Validation loss decreased (-0.755551 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.8973560333251953
Epoch: 7, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.348 Vali Acc: 0.817 Test Loss: 0.348 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.249483823776245
Epoch: 8, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 2.922844648361206
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.281 Vali Acc: 0.850 Test Loss: 0.281 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 3.1646013259887695
Epoch: 10, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.277 Vali Acc: 0.883 Test Loss: 0.277 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883331).  Saving model ...
Epoch: 11 cost time: 2.9751555919647217
Epoch: 11, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.911503791809082
Epoch: 12, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2090723514556885
Epoch: 13, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8250246047973633
Epoch: 14, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 3.2136292457580566
Epoch: 15, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.211 Vali Acc: 0.900 Test Loss: 0.211 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 2.9094674587249756
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2347967624664307
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.906989097595215
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.899998 --> -0.938887).  Saving model ...
Epoch: 19 cost time: 2.856220006942749
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1881659030914307
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.348 Vali Acc: 0.928 Test Loss: 0.348 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8314015865325928
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 22 cost time: 3.2150280475616455
Epoch: 22, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.348 Vali Acc: 0.933 Test Loss: 0.348 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9855148792266846
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.389 Vali Acc: 0.917 Test Loss: 0.389 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1344685554504395
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6371827125549316
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.348 Vali Acc: 0.928 Test Loss: 0.348 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.6476500034332275
Epoch: 26, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.426 Vali Acc: 0.928 Test Loss: 0.426 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.627732992172241
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.192 Vali Acc: 0.961 Test Loss: 0.192 Test Acc: 0.961
Validation loss decreased (-0.938887 --> -0.961109).  Saving model ...
Epoch: 28 cost time: 3.42360258102417
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2091012001037598
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.338 Vali Acc: 0.939 Test Loss: 0.338 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2031195163726807
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 11063302
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 19.606741428375244
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.568 Vali Acc: 0.428 Test Loss: 1.568 Test Acc: 0.428
Validation loss decreased (inf --> -0.427762).  Saving model ...
Epoch: 2 cost time: 18.142683744430542
Epoch: 2, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.161 Vali Acc: 0.644 Test Loss: 1.161 Test Acc: 0.644
Validation loss decreased (-0.427762 --> -0.644433).  Saving model ...
Epoch: 3 cost time: 17.28026270866394
Epoch: 3, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.838 Vali Acc: 0.711 Test Loss: 0.838 Test Acc: 0.711
Validation loss decreased (-0.644433 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 17.773208379745483
Epoch: 4, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755549).  Saving model ...
Epoch: 5 cost time: 17.251238584518433
Epoch: 5, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 17.177441358566284
Epoch: 6, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
Validation loss decreased (-0.755550 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 17.36730432510376
Epoch: 7, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 18.27485990524292
Epoch: 8, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.285109281539917
Epoch: 9, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.895525455474854
Epoch: 10, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 17.480634212493896
Epoch: 11, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.95162606239319
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 17.339640855789185
Epoch: 13, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 17.498056411743164
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.426 Vali Acc: 0.856 Test Loss: 0.426 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855551).  Saving model ...
Epoch: 15 cost time: 17.584320545196533
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
Validation loss decreased (-0.855551 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 18.600446701049805
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.450 Vali Acc: 0.833 Test Loss: 0.450 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.39048957824707
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.846346616744995
Epoch: 18, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 17.01715350151062
Epoch: 19, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.391 Vali Acc: 0.894 Test Loss: 0.391 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.58024525642395
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.85858702659607
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905552).  Saving model ...
Epoch: 22 cost time: 16.782713651657104
Epoch: 22, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 17.301156282424927
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
Validation loss decreased (-0.905553 --> -0.938886).  Saving model ...
Epoch: 24 cost time: 17.147764682769775
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 17.12749671936035
Epoch: 25, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 16.248823642730713
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 18.13731813430786
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 18.559922456741333
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 18.716021060943604
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.383 Vali Acc: 0.917 Test Loss: 0.383 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 17.680715084075928
Epoch: 30, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 37518854
model size : 144.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.64726710319519
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.550 Vali Acc: 0.417 Test Loss: 1.550 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 6.853209018707275
Epoch: 2, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.180 Vali Acc: 0.589 Test Loss: 1.180 Test Acc: 0.589
Validation loss decreased (-0.416651 --> -0.588877).  Saving model ...
Epoch: 3 cost time: 6.65383768081665
Epoch: 3, Steps: 12 | Train Loss: 1.068 Vali Loss: 0.859 Vali Acc: 0.711 Test Loss: 0.859 Test Acc: 0.711
Validation loss decreased (-0.588877 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 6.681041955947876
Epoch: 4, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.687 Vali Acc: 0.683 Test Loss: 0.687 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.431359529495239
Epoch: 5, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.590 Vali Acc: 0.739 Test Loss: 0.590 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738883).  Saving model ...
Epoch: 6 cost time: 6.717313051223755
Epoch: 6, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
Validation loss decreased (-0.738883 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 6.791102170944214
Epoch: 7, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.404 Vali Acc: 0.806 Test Loss: 0.404 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 6.609559774398804
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
Validation loss decreased (-0.805552 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 6.27859091758728
Epoch: 9, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.8480613231658936
Epoch: 10, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.305 Vali Acc: 0.833 Test Loss: 0.305 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.493901491165161
Epoch: 11, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.279 Vali Acc: 0.850 Test Loss: 0.279 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 6.350219011306763
Epoch: 12, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.338 Vali Acc: 0.833 Test Loss: 0.338 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.81446385383606
Epoch: 13, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
Validation loss decreased (-0.849997 --> -0.927776).  Saving model ...
Epoch: 14 cost time: 6.547152280807495
Epoch: 14, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.144 Vali Acc: 0.939 Test Loss: 0.144 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 15 cost time: 6.577777862548828
Epoch: 15, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.157 Vali Acc: 0.933 Test Loss: 0.157 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.295346021652222
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.589304208755493
Epoch: 17, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.357 Vali Acc: 0.883 Test Loss: 0.357 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.524768590927124
Epoch: 18, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.5858845710754395
Epoch: 19, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.285761594772339
Epoch: 20, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.202550411224365
Epoch: 21, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.419893503189087
Epoch: 22, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 6.441049098968506
Epoch: 23, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.0896642208099365
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.376 Vali Acc: 0.933 Test Loss: 0.376 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.336181402206421
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.485050439834595
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.717574119567871
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.287736892700195
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.2851104736328125
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.448 Vali Acc: 0.906 Test Loss: 0.448 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.667990684509277
Epoch: 30, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 11039750
model size : 43.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 15.48871636390686
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.568 Vali Acc: 0.428 Test Loss: 1.568 Test Acc: 0.428
Validation loss decreased (inf --> -0.427762).  Saving model ...
Epoch: 2 cost time: 13.797233581542969
Epoch: 2, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.161 Vali Acc: 0.644 Test Loss: 1.161 Test Acc: 0.644
Validation loss decreased (-0.427762 --> -0.644433).  Saving model ...
Epoch: 3 cost time: 13.687589883804321
Epoch: 3, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.838 Vali Acc: 0.711 Test Loss: 0.838 Test Acc: 0.711
Validation loss decreased (-0.644433 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 14.060065269470215
Epoch: 4, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755549).  Saving model ...
Epoch: 5 cost time: 13.395523309707642
Epoch: 5, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 6 cost time: 14.017461776733398
Epoch: 6, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
Validation loss decreased (-0.755550 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 13.34399962425232
Epoch: 7, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.360 Vali Acc: 0.828 Test Loss: 0.360 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 14.044966459274292
Epoch: 8, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.345 Vali Acc: 0.822 Test Loss: 0.345 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.457808017730713
Epoch: 9, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.785187482833862
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.347 Vali Acc: 0.833 Test Loss: 0.347 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 13.521070003509521
Epoch: 11, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.899727821350098
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 13.420892000198364
Epoch: 13, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 13.977582931518555
Epoch: 14, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.428 Vali Acc: 0.856 Test Loss: 0.428 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855551).  Saving model ...
Epoch: 15 cost time: 13.447976350784302
Epoch: 15, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.855551 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 13.9809889793396
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.888609170913696
Epoch: 17, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.498 Vali Acc: 0.844 Test Loss: 0.498 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.134890079498291
Epoch: 18, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.366 Vali Acc: 0.883 Test Loss: 0.366 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 14.138926029205322
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 13.933156728744507
Epoch: 20, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 14.070756912231445
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.861615180969238
Epoch: 22, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905553).  Saving model ...
Epoch: 23 cost time: 14.129464864730835
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 13.822781324386597
Epoch: 24, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.440 Vali Acc: 0.906 Test Loss: 0.440 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 13.611919164657593
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.368 Vali Acc: 0.928 Test Loss: 0.368 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 12.603078365325928
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.622 Vali Acc: 0.872 Test Loss: 0.622 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 13.352737426757812
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 12.72398567199707
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.360 Vali Acc: 0.928 Test Loss: 0.360 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 13.317174434661865
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 12.812949180603027
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.294 Vali Acc: 0.928 Test Loss: 0.294 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 37518854
model size : 144.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.182519912719727
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.550 Vali Acc: 0.417 Test Loss: 1.550 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 4.813563585281372
Epoch: 2, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.180 Vali Acc: 0.589 Test Loss: 1.180 Test Acc: 0.589
Validation loss decreased (-0.416651 --> -0.588877).  Saving model ...
Epoch: 3 cost time: 5.282536745071411
Epoch: 3, Steps: 12 | Train Loss: 1.068 Vali Loss: 0.859 Vali Acc: 0.711 Test Loss: 0.859 Test Acc: 0.711
Validation loss decreased (-0.588877 --> -0.711103).  Saving model ...
Epoch: 4 cost time: 5.226620674133301
Epoch: 4, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.687 Vali Acc: 0.683 Test Loss: 0.687 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.294386386871338
Epoch: 5, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.590 Vali Acc: 0.739 Test Loss: 0.590 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738883).  Saving model ...
Epoch: 6 cost time: 5.342575311660767
Epoch: 6, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
Validation loss decreased (-0.738883 --> -0.788884).  Saving model ...
Epoch: 7 cost time: 5.20080041885376
Epoch: 7, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.404 Vali Acc: 0.806 Test Loss: 0.404 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 4.795846939086914
Epoch: 8, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
Validation loss decreased (-0.805552 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 4.143743276596069
Epoch: 9, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.838218688964844
Epoch: 10, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.306 Vali Acc: 0.833 Test Loss: 0.306 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.370709657669067
Epoch: 11, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 5.14221978187561
Epoch: 12, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.3564581871032715
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
Validation loss decreased (-0.849997 --> -0.905554).  Saving model ...
Epoch: 14 cost time: 4.959625244140625
Epoch: 14, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.163 Vali Acc: 0.922 Test Loss: 0.163 Test Acc: 0.922
Validation loss decreased (-0.905554 --> -0.922221).  Saving model ...
Epoch: 15 cost time: 5.483969211578369
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.297 Vali Acc: 0.872 Test Loss: 0.297 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.020253896713257
Epoch: 16, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.5564045906066895
Epoch: 17, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.142332315444946
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
Validation loss decreased (-0.922221 --> -0.927776).  Saving model ...
Epoch: 19 cost time: 5.5629918575286865
Epoch: 19, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.947237014770508
Epoch: 20, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.559 Vali Acc: 0.794 Test Loss: 0.559 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.417284250259399
Epoch: 21, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.049947023391724
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 5.486272573471069
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (-0.944443 --> -0.961110).  Saving model ...
Epoch: 24 cost time: 5.161773681640625
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.419 Vali Acc: 0.928 Test Loss: 0.419 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.412909984588623
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.128032684326172
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.160720109939575
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.384 Vali Acc: 0.933 Test Loss: 0.384 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.159318923950195
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.057701587677002
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.564 Vali Acc: 0.867 Test Loss: 0.564 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.386396169662476
Epoch: 30, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.961110 --> -0.972221).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9722222222222222
model parameter : 11039750
model size : 43.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.637382984161377
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.573 Vali Acc: 0.428 Test Loss: 1.573 Test Acc: 0.428
Validation loss decreased (inf --> -0.427762).  Saving model ...
Epoch: 2 cost time: 7.245047092437744
Epoch: 2, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.177 Vali Acc: 0.628 Test Loss: 1.177 Test Acc: 0.628
Validation loss decreased (-0.427762 --> -0.627766).  Saving model ...
Epoch: 3 cost time: 6.8310158252716064
Epoch: 3, Steps: 12 | Train Loss: 1.005 Vali Loss: 0.859 Vali Acc: 0.694 Test Loss: 0.859 Test Acc: 0.694
Validation loss decreased (-0.627766 --> -0.694436).  Saving model ...
Epoch: 4 cost time: 7.049407243728638
Epoch: 4, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
Validation loss decreased (-0.694436 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 7.391406536102295
Epoch: 5, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.559 Vali Acc: 0.739 Test Loss: 0.559 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 6 cost time: 6.832207679748535
Epoch: 6, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.460 Vali Acc: 0.794 Test Loss: 0.460 Test Acc: 0.794
Validation loss decreased (-0.738883 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 7.35096549987793
Epoch: 7, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.381 Vali Acc: 0.828 Test Loss: 0.381 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 7.0226452350616455
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.10640025138855
Epoch: 9, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 7.4383978843688965
Epoch: 10, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.341 Vali Acc: 0.828 Test Loss: 0.341 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 6.850942134857178
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.374 Vali Acc: 0.817 Test Loss: 0.374 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.282534837722778
Epoch: 12, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855553).  Saving model ...
Epoch: 13 cost time: 7.034869909286499
Epoch: 13, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.366 Vali Acc: 0.856 Test Loss: 0.366 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.074173212051392
Epoch: 14, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.096962928771973
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.296 Vali Acc: 0.861 Test Loss: 0.296 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 6.7601799964904785
Epoch: 16, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.298660516738892
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866663).  Saving model ...
Epoch: 18 cost time: 6.57219123840332
Epoch: 18, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883331).  Saving model ...
Epoch: 19 cost time: 5.662630081176758
Epoch: 19, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.883331 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 5.863322734832764
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.441770553588867
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 22 cost time: 7.281195163726807
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.884408950805664
Epoch: 23, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.418 Vali Acc: 0.906 Test Loss: 0.418 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.315717458724976
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.9664695262908936
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.3943798542022705
Epoch: 26, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.062279462814331
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.942930221557617
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.455799341201782
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.244908809661865
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 37518854
model size : 144.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.2867560386657715
Epoch: 1, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.557 Vali Acc: 0.417 Test Loss: 1.557 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 3.486963987350464
Epoch: 2, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.202 Vali Acc: 0.567 Test Loss: 1.202 Test Acc: 0.567
Validation loss decreased (-0.416651 --> -0.566655).  Saving model ...
Epoch: 3 cost time: 3.4016146659851074
Epoch: 3, Steps: 12 | Train Loss: 1.069 Vali Loss: 0.889 Vali Acc: 0.694 Test Loss: 0.889 Test Acc: 0.694
Validation loss decreased (-0.566655 --> -0.694436).  Saving model ...
Epoch: 4 cost time: 3.2110331058502197
Epoch: 4, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.719 Vali Acc: 0.667 Test Loss: 0.719 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.040142059326172
Epoch: 5, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 3.4869673252105713
Epoch: 6, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.492 Vali Acc: 0.767 Test Loss: 0.492 Test Acc: 0.767
Validation loss decreased (-0.722216 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 3.536522388458252
Epoch: 7, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.429 Vali Acc: 0.794 Test Loss: 0.429 Test Acc: 0.794
Validation loss decreased (-0.766662 --> -0.794440).  Saving model ...
Epoch: 8 cost time: 3.3785526752471924
Epoch: 8, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.794440 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 3.3918094635009766
Epoch: 9, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1681597232818604
Epoch: 10, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.324 Vali Acc: 0.822 Test Loss: 0.324 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5505428314208984
Epoch: 11, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 3.606523036956787
Epoch: 12, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5728700160980225
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
Validation loss decreased (-0.849997 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 3.4513533115386963
Epoch: 14, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 3.3671586513519287
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6577653884887695
Epoch: 16, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.319 Vali Acc: 0.867 Test Loss: 0.319 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6349685192108154
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.270 Vali Acc: 0.878 Test Loss: 0.270 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.624910593032837
Epoch: 18, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 19 cost time: 3.3076651096343994
Epoch: 19, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.626774787902832
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6597788333892822
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5378661155700684
Epoch: 22, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.527052164077759
Epoch: 23, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.332 Vali Acc: 0.894 Test Loss: 0.332 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.409435272216797
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.105 Vali Acc: 0.961 Test Loss: 0.105 Test Acc: 0.961
Validation loss decreased (-0.938887 --> -0.961110).  Saving model ...
Epoch: 25 cost time: 3.6459429264068604
Epoch: 25, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.661597490310669
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.745206832885742
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5115389823913574
Epoch: 28, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.950 Test Loss: 0.133 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5665504932403564
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.505788803100586
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.956 Test Loss: 0.115 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 11039750
model size : 43.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 12.336533546447754
Epoch: 1, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.650 Vali Acc: 0.383 Test Loss: 1.650 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 10.78106427192688
Epoch: 2, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.287 Vali Acc: 0.683 Test Loss: 1.287 Test Acc: 0.683
Validation loss decreased (-0.383317 --> -0.683320).  Saving model ...
Epoch: 3 cost time: 10.259576082229614
Epoch: 3, Steps: 12 | Train Loss: 1.119 Vali Loss: 0.946 Vali Acc: 0.733 Test Loss: 0.946 Test Acc: 0.733
Validation loss decreased (-0.683320 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 10.726844072341919
Epoch: 4, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.717 Vali Acc: 0.744 Test Loss: 0.717 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 10.47905707359314
Epoch: 5, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.573 Vali Acc: 0.767 Test Loss: 0.573 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 11.025697231292725
Epoch: 6, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.454 Vali Acc: 0.778 Test Loss: 0.454 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 10.357360601425171
Epoch: 7, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 11.074623823165894
Epoch: 8, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 10.718055963516235
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 11.079421758651733
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.605645179748535
Epoch: 11, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.594 Vali Acc: 0.733 Test Loss: 0.594 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.040210008621216
Epoch: 12, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 10.252624750137329
Epoch: 13, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.941667318344116
Epoch: 14, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 10.511679410934448
Epoch: 15, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.8209707736969
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
Validation loss decreased (-0.883331 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 10.535720109939575
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.801772832870483
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.339 Vali Acc: 0.872 Test Loss: 0.339 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.560101985931396
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.244 Vali Acc: 0.906 Test Loss: 0.244 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.70392394065857
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.516970157623291
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 22 cost time: 10.763842105865479
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 23 cost time: 11.001630783081055
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.797467708587646
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.394 Vali Acc: 0.906 Test Loss: 0.394 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.49468183517456
Epoch: 25, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.455134868621826
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.182 Vali Acc: 0.939 Test Loss: 0.182 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 10.657121181488037
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.605 Vali Acc: 0.839 Test Loss: 0.605 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 10.262306928634644
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 10.463485956192017
Epoch: 29, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.387 Vali Acc: 0.878 Test Loss: 0.387 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 10.035974979400635
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 18772486
model size : 72.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.135078191757202
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.655 Vali Acc: 0.367 Test Loss: 1.655 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 4.155369758605957
Epoch: 2, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.335 Vali Acc: 0.544 Test Loss: 1.335 Test Acc: 0.544
Validation loss decreased (-0.366650 --> -0.544431).  Saving model ...
Epoch: 3 cost time: 3.938197135925293
Epoch: 3, Steps: 12 | Train Loss: 1.183 Vali Loss: 0.990 Vali Acc: 0.678 Test Loss: 0.990 Test Acc: 0.678
Validation loss decreased (-0.544431 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 3.3018741607666016
Epoch: 4, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.727 Vali Acc: 0.750 Test Loss: 0.727 Test Acc: 0.750
Validation loss decreased (-0.677768 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 3.279514789581299
Epoch: 5, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799994).  Saving model ...
Epoch: 6 cost time: 4.380741596221924
Epoch: 6, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 4.093143463134766
Epoch: 7, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.380 Vali Acc: 0.867 Test Loss: 0.380 Test Acc: 0.867
Validation loss decreased (-0.816662 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 4.426333427429199
Epoch: 8, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.087624549865723
Epoch: 9, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.304 Vali Acc: 0.844 Test Loss: 0.304 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.433228254318237
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.093851804733276
Epoch: 11, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 4.4034059047698975
Epoch: 12, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.872220 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 4.08043646812439
Epoch: 13, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.208 Vali Acc: 0.889 Test Loss: 0.208 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.064877510070801
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.235 Vali Acc: 0.889 Test Loss: 0.235 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.157870054244995
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9635822772979736
Epoch: 16, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
Validation loss decreased (-0.899997 --> -0.955553).  Saving model ...
Epoch: 17 cost time: 4.33158016204834
Epoch: 17, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.148 Vali Acc: 0.944 Test Loss: 0.148 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.0016562938690186
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.431243658065796
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.1361682415008545
Epoch: 20, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.454973220825195
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.103 Vali Acc: 0.961 Test Loss: 0.103 Test Acc: 0.961
Validation loss decreased (-0.955553 --> -0.961110).  Saving model ...
Epoch: 22 cost time: 3.954805374145508
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.972 Test Loss: 0.197 Test Acc: 0.972
Validation loss decreased (-0.961110 --> -0.972220).  Saving model ...
Epoch: 23 cost time: 4.405482053756714
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.961 Test Loss: 0.093 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.098957777023315
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.972220 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 4.44671893119812
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.086 Vali Acc: 0.961 Test Loss: 0.086 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.081310987472534
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.538160085678101
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.944 Test Loss: 0.143 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.050462245941162
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.227586984634399
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.220373868942261
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9833333333333333
model parameter : 5532678
model size : 22.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.226680040359497
Epoch: 1, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.650 Vali Acc: 0.383 Test Loss: 1.650 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 7.462126970291138
Epoch: 2, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.287 Vali Acc: 0.683 Test Loss: 1.287 Test Acc: 0.683
Validation loss decreased (-0.383317 --> -0.683320).  Saving model ...
Epoch: 3 cost time: 7.747225999832153
Epoch: 3, Steps: 12 | Train Loss: 1.119 Vali Loss: 0.946 Vali Acc: 0.733 Test Loss: 0.946 Test Acc: 0.733
Validation loss decreased (-0.683320 --> -0.733324).  Saving model ...
Epoch: 4 cost time: 8.089269399642944
Epoch: 4, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.717 Vali Acc: 0.744 Test Loss: 0.717 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 7.769098281860352
Epoch: 5, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.573 Vali Acc: 0.767 Test Loss: 0.573 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766661).  Saving model ...
Epoch: 6 cost time: 7.394303321838379
Epoch: 6, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.454 Vali Acc: 0.778 Test Loss: 0.454 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 7 cost time: 7.289753437042236
Epoch: 7, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 7.617321491241455
Epoch: 8, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.368 Vali Acc: 0.822 Test Loss: 0.368 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 7.924595832824707
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 7.407492399215698
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.963134288787842
Epoch: 11, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.594 Vali Acc: 0.733 Test Loss: 0.594 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.081616640090942
Epoch: 12, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 7.298997640609741
Epoch: 13, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.802814245223999
Epoch: 14, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 8.055980443954468
Epoch: 15, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.269 Vali Acc: 0.872 Test Loss: 0.269 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.725873947143555
Epoch: 16, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
Validation loss decreased (-0.883331 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 8.230724334716797
Epoch: 17, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.338696718215942
Epoch: 18, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.19155240058899
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 7.484802007675171
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.001055002212524
Epoch: 21, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.922220 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 8.215752124786377
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.358 Vali Acc: 0.928 Test Loss: 0.358 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.678293704986572
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.267643451690674
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.310 Vali Acc: 0.939 Test Loss: 0.310 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.998960971832275
Epoch: 25, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.912083625793457
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.544161796569824
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.563042640686035
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.405 Vali Acc: 0.939 Test Loss: 0.405 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.69473671913147
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.418588399887085
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.917 Test Loss: 0.454 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 18772486
model size : 72.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.102605104446411
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.655 Vali Acc: 0.367 Test Loss: 1.655 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 3.520387887954712
Epoch: 2, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.335 Vali Acc: 0.544 Test Loss: 1.335 Test Acc: 0.544
Validation loss decreased (-0.366650 --> -0.544431).  Saving model ...
Epoch: 3 cost time: 3.2912697792053223
Epoch: 3, Steps: 12 | Train Loss: 1.183 Vali Loss: 0.990 Vali Acc: 0.678 Test Loss: 0.990 Test Acc: 0.678
Validation loss decreased (-0.544431 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 3.253016710281372
Epoch: 4, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.727 Vali Acc: 0.750 Test Loss: 0.727 Test Acc: 0.750
Validation loss decreased (-0.677768 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 3.607337236404419
Epoch: 5, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799994).  Saving model ...
Epoch: 6 cost time: 3.409846067428589
Epoch: 6, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 3.362419366836548
Epoch: 7, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.380 Vali Acc: 0.867 Test Loss: 0.380 Test Acc: 0.867
Validation loss decreased (-0.816662 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 3.496351718902588
Epoch: 8, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5237081050872803
Epoch: 9, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.156621217727661
Epoch: 10, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7842884063720703
Epoch: 11, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 3.68967342376709
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.872220 --> -0.894442).  Saving model ...
Epoch: 13 cost time: 3.5365734100341797
Epoch: 13, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.208 Vali Acc: 0.894 Test Loss: 0.208 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 3.4597175121307373
Epoch: 14, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6854050159454346
Epoch: 15, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5221540927886963
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.894442 --> -0.955554).  Saving model ...
Epoch: 17 cost time: 3.3473966121673584
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (-0.955554 --> -0.961109).  Saving model ...
Epoch: 18 cost time: 3.7149479389190674
Epoch: 18, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5708861351013184
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6143198013305664
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.631657361984253
Epoch: 21, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.6800174713134766
Epoch: 22, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.5066475868225098
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.961 Test Loss: 0.093 Test Acc: 0.961
Validation loss decreased (-0.961109 --> -0.961110).  Saving model ...
Epoch: 24 cost time: 3.4042060375213623
Epoch: 24, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
Validation loss decreased (-0.961110 --> -0.977777).  Saving model ...
Epoch: 25 cost time: 3.6883528232574463
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.967 Test Loss: 0.083 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3314454555511475
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.6056344509124756
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.742577075958252
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.977777 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 3.639742136001587
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4565930366516113
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9833333333333333
model parameter : 5532678
model size : 22.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.304091930389404
Epoch: 1, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.651 Vali Acc: 0.383 Test Loss: 1.651 Test Acc: 0.383
Validation loss decreased (inf --> -0.383317).  Saving model ...
Epoch: 2 cost time: 4.852986574172974
Epoch: 2, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.293 Vali Acc: 0.678 Test Loss: 1.293 Test Acc: 0.678
Validation loss decreased (-0.383317 --> -0.677765).  Saving model ...
Epoch: 3 cost time: 4.8275933265686035
Epoch: 3, Steps: 12 | Train Loss: 1.120 Vali Loss: 0.955 Vali Acc: 0.722 Test Loss: 0.955 Test Acc: 0.722
Validation loss decreased (-0.677765 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 4.57172155380249
Epoch: 4, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738882).  Saving model ...
Epoch: 5 cost time: 4.920233249664307
Epoch: 5, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.585 Vali Acc: 0.761 Test Loss: 0.585 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 4.694177627563477
Epoch: 6, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.464 Vali Acc: 0.772 Test Loss: 0.464 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772218).  Saving model ...
Epoch: 7 cost time: 4.925081253051758
Epoch: 7, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.397 Vali Acc: 0.806 Test Loss: 0.397 Test Acc: 0.806
Validation loss decreased (-0.772218 --> -0.805552).  Saving model ...
Epoch: 8 cost time: 4.864314556121826
Epoch: 8, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.377 Vali Acc: 0.811 Test Loss: 0.377 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 4.490864515304565
Epoch: 9, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.328 Vali Acc: 0.828 Test Loss: 0.328 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827775).  Saving model ...
Epoch: 10 cost time: 4.900746822357178
Epoch: 10, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.609107255935669
Epoch: 11, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.609 Vali Acc: 0.733 Test Loss: 0.609 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.552392959594727
Epoch: 12, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
Validation loss decreased (-0.827775 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 4.8841471672058105
Epoch: 13, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.4851884841918945
Epoch: 14, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 4.846308946609497
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.786161184310913
Epoch: 16, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.212 Vali Acc: 0.917 Test Loss: 0.212 Test Acc: 0.917
Validation loss decreased (-0.877775 --> -0.916665).  Saving model ...
Epoch: 17 cost time: 4.641406297683716
Epoch: 17, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.348 Vali Acc: 0.883 Test Loss: 0.348 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9497854709625244
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 3.666792631149292
Epoch: 19, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 3.8680155277252197
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.308300495147705
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933330).  Saving model ...
Epoch: 22 cost time: 4.652742624282837
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.399 Vali Acc: 0.939 Test Loss: 0.399 Test Acc: 0.939
Validation loss decreased (-0.933330 --> -0.938885).  Saving model ...
Epoch: 23 cost time: 4.463399648666382
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.306 Vali Acc: 0.939 Test Loss: 0.306 Test Acc: 0.939
Validation loss decreased (-0.938885 --> -0.938886).  Saving model ...
Epoch: 24 cost time: 4.172054767608643
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.466728210449219
Epoch: 25, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.595159292221069
Epoch: 26, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.186054468154907
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.938886 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 4.362121820449829
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.642618656158447
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.440 Vali Acc: 0.906 Test Loss: 0.440 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.339911937713623
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 18772486
model size : 72.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.14272928237915
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.658 Vali Acc: 0.367 Test Loss: 1.658 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 2.555234670639038
Epoch: 2, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.342 Vali Acc: 0.533 Test Loss: 1.342 Test Acc: 0.533
Validation loss decreased (-0.366650 --> -0.533320).  Saving model ...
Epoch: 3 cost time: 2.4607629776000977
Epoch: 3, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.002 Vali Acc: 0.667 Test Loss: 1.002 Test Acc: 0.667
Validation loss decreased (-0.533320 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 2.747777223587036
Epoch: 4, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.743 Vali Acc: 0.739 Test Loss: 0.743 Test Acc: 0.739
Validation loss decreased (-0.666657 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 2.4065117835998535
Epoch: 5, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
Validation loss decreased (-0.738881 --> -0.783327).  Saving model ...
Epoch: 6 cost time: 2.6253621578216553
Epoch: 6, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.471 Vali Acc: 0.794 Test Loss: 0.471 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 2.318822145462036
Epoch: 7, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.396 Vali Acc: 0.856 Test Loss: 0.396 Test Acc: 0.856
Validation loss decreased (-0.794440 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 2.6363086700439453
Epoch: 8, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.428957223892212
Epoch: 9, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6660280227661133
Epoch: 10, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.318 Vali Acc: 0.839 Test Loss: 0.318 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4753334522247314
Epoch: 11, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 12 cost time: 2.573392391204834
Epoch: 12, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 2.5060811042785645
Epoch: 13, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 2.6426851749420166
Epoch: 14, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.257 Vali Acc: 0.883 Test Loss: 0.257 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3049051761627197
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 2.606165647506714
Epoch: 16, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 2.504058361053467
Epoch: 17, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
Validation loss decreased (-0.911108 --> -0.938887).  Saving model ...
Epoch: 18 cost time: 2.670915126800537
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
Validation loss decreased (-0.938887 --> -0.961110).  Saving model ...
Epoch: 19 cost time: 2.4999043941497803
Epoch: 19, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.101 Vali Acc: 0.956 Test Loss: 0.101 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.641071319580078
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0950145721435547
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.140 Vali Acc: 0.956 Test Loss: 0.140 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5142922401428223
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.170241355895996
Epoch: 23, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.967 Test Loss: 0.094 Test Acc: 0.967
Validation loss decreased (-0.961110 --> -0.966666).  Saving model ...
Epoch: 24 cost time: 2.525722026824951
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1891446113586426
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3788862228393555
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9682543277740479
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
Validation loss decreased (-0.966666 --> -0.977776).  Saving model ...
Epoch: 28 cost time: 1.9668967723846436
Epoch: 28, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.430 Vali Acc: 0.906 Test Loss: 0.430 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0179083347320557
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.448707103729248
Epoch: 30, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9777777777777777
model parameter : 5532678
model size : 22.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.316117286682129
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.692 Vali Acc: 0.328 Test Loss: 1.692 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 6.933381795883179
Epoch: 2, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.379 Vali Acc: 0.567 Test Loss: 1.379 Test Acc: 0.567
Validation loss decreased (-0.327761 --> -0.566653).  Saving model ...
Epoch: 3 cost time: 6.505537271499634
Epoch: 3, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
Validation loss decreased (-0.566653 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 6.923637390136719
Epoch: 4, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.776 Vali Acc: 0.694 Test Loss: 0.776 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 6.241361856460571
Epoch: 5, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.609 Vali Acc: 0.728 Test Loss: 0.609 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 6.918753623962402
Epoch: 6, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
Validation loss decreased (-0.727772 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 6.426095962524414
Epoch: 7, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.389 Vali Acc: 0.817 Test Loss: 0.389 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 6.687766790390015
Epoch: 8, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.302 Vali Acc: 0.833 Test Loss: 0.302 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 6.495647668838501
Epoch: 9, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 6.977641582489014
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.283 Vali Acc: 0.850 Test Loss: 0.283 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 6.507998704910278
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.277 Vali Acc: 0.844 Test Loss: 0.277 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.041715145111084
Epoch: 12, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.267 Vali Acc: 0.850 Test Loss: 0.267 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 6.73199462890625
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.281 Vali Acc: 0.817 Test Loss: 0.281 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.044909238815308
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872220).  Saving model ...
Epoch: 15 cost time: 5.249547719955444
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
Validation loss decreased (-0.872220 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 7.103544473648071
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.415 Vali Acc: 0.839 Test Loss: 0.415 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.903451919555664
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.221 Vali Acc: 0.883 Test Loss: 0.221 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.907585382461548
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.213 Vali Acc: 0.889 Test Loss: 0.213 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.943084955215454
Epoch: 19, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 6.876277208328247
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.176 Vali Acc: 0.917 Test Loss: 0.176 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 7.050841569900513
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.6011881828308105
Epoch: 22, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.175 Vali Acc: 0.928 Test Loss: 0.175 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 7.1244940757751465
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.553276538848877
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.086377143859863
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.5900349617004395
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.917 Test Loss: 0.193 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.032376050949097
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.514104843139648
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.048036575317383
Epoch: 29, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 6.551778316497803
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.451 Vali Acc: 0.906 Test Loss: 0.451 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 9399302
model size : 37.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.790842533111572
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.645 Vali Acc: 0.400 Test Loss: 1.645 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 3.2822554111480713
Epoch: 2, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.327 Vali Acc: 0.644 Test Loss: 1.327 Test Acc: 0.644
Validation loss decreased (-0.399984 --> -0.644431).  Saving model ...
Epoch: 3 cost time: 3.2650656700134277
Epoch: 3, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.018 Vali Acc: 0.744 Test Loss: 1.018 Test Acc: 0.744
Validation loss decreased (-0.644431 --> -0.744434).  Saving model ...
Epoch: 4 cost time: 3.048999071121216
Epoch: 4, Steps: 12 | Train Loss: 0.942 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 3.3324167728424072
Epoch: 5, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.616 Vali Acc: 0.778 Test Loss: 0.616 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 3.3136093616485596
Epoch: 6, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.509 Vali Acc: 0.817 Test Loss: 0.509 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 3.2153849601745605
Epoch: 7, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.424 Vali Acc: 0.822 Test Loss: 0.424 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 3.080939292907715
Epoch: 8, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.371 Vali Acc: 0.839 Test Loss: 0.371 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 3.600872755050659
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3814563751220703
Epoch: 10, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 3.4760615825653076
Epoch: 11, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5648248195648193
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5615499019622803
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 3.250382661819458
Epoch: 14, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.255 Vali Acc: 0.867 Test Loss: 0.255 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6977570056915283
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 16 cost time: 3.6773204803466797
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.47778058052063
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 3.3178210258483887
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7515628337860107
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6918888092041016
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933332).  Saving model ...
Epoch: 21 cost time: 3.421205997467041
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.872887372970581
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.678877353668213
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.5527946949005127
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 25 cost time: 3.4416420459747314
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.684062957763672
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
Validation loss decreased (-0.938887 --> -0.961109).  Saving model ...
Epoch: 27 cost time: 3.571547031402588
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6236581802368164
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6936228275299072
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.956 Test Loss: 0.134 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.7369558811187744
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 2779142
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.361562252044678
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.692 Vali Acc: 0.328 Test Loss: 1.692 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 4.781519412994385
Epoch: 2, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.379 Vali Acc: 0.567 Test Loss: 1.379 Test Acc: 0.567
Validation loss decreased (-0.327761 --> -0.566653).  Saving model ...
Epoch: 3 cost time: 5.2250659465789795
Epoch: 3, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.043 Vali Acc: 0.683 Test Loss: 1.043 Test Acc: 0.683
Validation loss decreased (-0.566653 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 4.90341854095459
Epoch: 4, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.776 Vali Acc: 0.694 Test Loss: 0.776 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694437).  Saving model ...
Epoch: 5 cost time: 4.108851909637451
Epoch: 5, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.609 Vali Acc: 0.728 Test Loss: 0.609 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727772).  Saving model ...
Epoch: 6 cost time: 3.8250789642333984
Epoch: 6, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.472 Vali Acc: 0.783 Test Loss: 0.472 Test Acc: 0.783
Validation loss decreased (-0.727772 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 3.554594039916992
Epoch: 7, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.391 Vali Acc: 0.811 Test Loss: 0.391 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 5.068507194519043
Epoch: 8, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.304 Vali Acc: 0.833 Test Loss: 0.304 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 5.0533857345581055
Epoch: 9, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 4.9486377239227295
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.284 Vali Acc: 0.850 Test Loss: 0.284 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 5.153634548187256
Epoch: 11, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.277 Vali Acc: 0.844 Test Loss: 0.277 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.41398811340332
Epoch: 12, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.264 Vali Acc: 0.850 Test Loss: 0.264 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 5.04322624206543
Epoch: 13, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.275 Vali Acc: 0.817 Test Loss: 0.275 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.866292238235474
Epoch: 14, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.247 Vali Acc: 0.872 Test Loss: 0.247 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872220).  Saving model ...
Epoch: 15 cost time: 5.091770887374878
Epoch: 15, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.238 Vali Acc: 0.889 Test Loss: 0.238 Test Acc: 0.889
Validation loss decreased (-0.872220 --> -0.888887).  Saving model ...
Epoch: 16 cost time: 5.388090372085571
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.134887933731079
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.227 Vali Acc: 0.867 Test Loss: 0.227 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.799063205718994
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.215 Vali Acc: 0.889 Test Loss: 0.215 Test Acc: 0.889
Validation loss decreased (-0.888887 --> -0.888887).  Saving model ...
Epoch: 19 cost time: 4.999073266983032
Epoch: 19, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
Validation loss decreased (-0.888887 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 5.5402326583862305
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.917 Test Loss: 0.173 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 21 cost time: 5.526803970336914
Epoch: 21, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.152963638305664
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.188 Vali Acc: 0.911 Test Loss: 0.188 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.01963996887207
Epoch: 23, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.252 Vali Acc: 0.939 Test Loss: 0.252 Test Acc: 0.939
Validation loss decreased (-0.916665 --> -0.938886).  Saving model ...
Epoch: 24 cost time: 5.301083564758301
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.911 Test Loss: 0.194 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.589614152908325
Epoch: 25, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.227160930633545
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.480914115905762
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.849293947219849
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.957620859146118
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 4.7382636070251465
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 9399302
model size : 37.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.826612949371338
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.645 Vali Acc: 0.400 Test Loss: 1.645 Test Acc: 0.400
Validation loss decreased (inf --> -0.399984).  Saving model ...
Epoch: 2 cost time: 1.9721825122833252
Epoch: 2, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.327 Vali Acc: 0.644 Test Loss: 1.327 Test Acc: 0.644
Validation loss decreased (-0.399984 --> -0.644431).  Saving model ...
Epoch: 3 cost time: 1.967411994934082
Epoch: 3, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.018 Vali Acc: 0.744 Test Loss: 1.018 Test Acc: 0.744
Validation loss decreased (-0.644431 --> -0.744434).  Saving model ...
Epoch: 4 cost time: 2.357059955596924
Epoch: 4, Steps: 12 | Train Loss: 0.942 Vali Loss: 0.771 Vali Acc: 0.750 Test Loss: 0.771 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 2.8060250282287598
Epoch: 5, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.616 Vali Acc: 0.778 Test Loss: 0.616 Test Acc: 0.778
Validation loss decreased (-0.749992 --> -0.777772).  Saving model ...
Epoch: 6 cost time: 3.0415048599243164
Epoch: 6, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.509 Vali Acc: 0.817 Test Loss: 0.509 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 2.7842092514038086
Epoch: 7, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.424 Vali Acc: 0.822 Test Loss: 0.424 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 2.6426122188568115
Epoch: 8, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.371 Vali Acc: 0.839 Test Loss: 0.371 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 2.940973997116089
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.86718487739563
Epoch: 10, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.328 Vali Acc: 0.861 Test Loss: 0.328 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 2.8338725566864014
Epoch: 11, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9662251472473145
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.041856050491333
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 2.6597952842712402
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.255 Vali Acc: 0.867 Test Loss: 0.255 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9501073360443115
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 16 cost time: 3.013766050338745
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8286709785461426
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 2.631077289581299
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.988452911376953
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7573959827423096
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933332).  Saving model ...
Epoch: 21 cost time: 2.5892858505249023
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.279 Vali Acc: 0.889 Test Loss: 0.279 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9895052909851074
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9442455768585205
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7639613151550293
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 25 cost time: 2.968153715133667
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.954807758331299
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (-0.938887 --> -0.961109).  Saving model ...
Epoch: 27 cost time: 2.689129114151001
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9215621948242188
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9560799598693848
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
Validation loss decreased (-0.961109 --> -0.961110).  Saving model ...
Epoch: 30 cost time: 2.869021415710449
Epoch: 30, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 2779142
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.734113454818726
Epoch: 1, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.692 Vali Acc: 0.322 Test Loss: 1.692 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 3.0680460929870605
Epoch: 2, Steps: 12 | Train Loss: 1.523 Vali Loss: 1.382 Vali Acc: 0.556 Test Loss: 1.382 Test Acc: 0.556
Validation loss decreased (-0.322205 --> -0.555542).  Saving model ...
Epoch: 3 cost time: 3.0937790870666504
Epoch: 3, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.048 Vali Acc: 0.678 Test Loss: 1.048 Test Acc: 0.678
Validation loss decreased (-0.555542 --> -0.677767).  Saving model ...
Epoch: 4 cost time: 2.7372612953186035
Epoch: 4, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.782 Vali Acc: 0.689 Test Loss: 0.782 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688881).  Saving model ...
Epoch: 5 cost time: 2.98861026763916
Epoch: 5, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716660).  Saving model ...
Epoch: 6 cost time: 3.0883889198303223
Epoch: 6, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.487 Vali Acc: 0.767 Test Loss: 0.487 Test Acc: 0.767
Validation loss decreased (-0.716660 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 2.6389849185943604
Epoch: 7, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.416 Vali Acc: 0.806 Test Loss: 0.416 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 3.149132013320923
Epoch: 8, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.352 Vali Acc: 0.828 Test Loss: 0.352 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 3.065605878829956
Epoch: 9, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.325 Vali Acc: 0.839 Test Loss: 0.325 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 10 cost time: 2.8185458183288574
Epoch: 10, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 3.3369688987731934
Epoch: 11, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.301 Vali Acc: 0.828 Test Loss: 0.301 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3153603076934814
Epoch: 12, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.385 Vali Acc: 0.856 Test Loss: 0.385 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 3.0878212451934814
Epoch: 13, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3269670009613037
Epoch: 14, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.271 Vali Acc: 0.856 Test Loss: 0.271 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 3.348663806915283
Epoch: 15, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
Validation loss decreased (-0.855553 --> -0.905553).  Saving model ...
Epoch: 16 cost time: 3.0316174030303955
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3327929973602295
Epoch: 17, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 18 cost time: 3.3835482597351074
Epoch: 18, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 3.0110392570495605
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3146870136260986
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3909785747528076
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 3.082676649093628
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3623836040496826
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.166 Vali Acc: 0.928 Test Loss: 0.166 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.367173671722412
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.185 Vali Acc: 0.928 Test Loss: 0.185 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.996084690093994
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.9929895401000977
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3011486530303955
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 3.1597020626068115
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9825661182403564
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2789766788482666
Epoch: 30, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.336 Vali Acc: 0.933 Test Loss: 0.336 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 9399302
model size : 37.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9979512691497803
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.651 Vali Acc: 0.394 Test Loss: 1.651 Test Acc: 0.394
Validation loss decreased (inf --> -0.394428).  Saving model ...
Epoch: 2 cost time: 2.026219606399536
Epoch: 2, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.338 Vali Acc: 0.628 Test Loss: 1.338 Test Acc: 0.628
Validation loss decreased (-0.394428 --> -0.627764).  Saving model ...
Epoch: 3 cost time: 2.053511381149292
Epoch: 3, Steps: 12 | Train Loss: 1.208 Vali Loss: 1.035 Vali Acc: 0.733 Test Loss: 1.035 Test Acc: 0.733
Validation loss decreased (-0.627764 --> -0.733323).  Saving model ...
Epoch: 4 cost time: 2.1458094120025635
Epoch: 4, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.789 Vali Acc: 0.750 Test Loss: 0.789 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 2.2457146644592285
Epoch: 5, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.635 Vali Acc: 0.772 Test Loss: 0.635 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772216).  Saving model ...
Epoch: 6 cost time: 2.0272347927093506
Epoch: 6, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.530 Vali Acc: 0.800 Test Loss: 0.530 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 2.074979543685913
Epoch: 7, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.443 Vali Acc: 0.817 Test Loss: 0.443 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816662).  Saving model ...
Epoch: 8 cost time: 1.9289309978485107
Epoch: 8, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.384 Vali Acc: 0.839 Test Loss: 0.384 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 1.9527831077575684
Epoch: 9, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8325095176696777
Epoch: 10, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.339 Vali Acc: 0.861 Test Loss: 0.339 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 1.8846311569213867
Epoch: 11, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9797773361206055
Epoch: 12, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.317 Vali Acc: 0.839 Test Loss: 0.317 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9881935119628906
Epoch: 13, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 1.889228343963623
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.263 Vali Acc: 0.867 Test Loss: 0.263 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.719259262084961
Epoch: 15, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.883331 --> -0.883331).  Saving model ...
Epoch: 16 cost time: 1.9349033832550049
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.986212968826294
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.8543603420257568
Epoch: 18, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.298 Vali Acc: 0.872 Test Loss: 0.298 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.567049503326416
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.034118413925171
Epoch: 20, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933332).  Saving model ...
Epoch: 21 cost time: 1.9691088199615479
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6480262279510498
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8653693199157715
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1895158290863037
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.206580638885498
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 26 cost time: 2.081775188446045
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
Validation loss decreased (-0.938887 --> -0.961109).  Saving model ...
Epoch: 27 cost time: 1.943056583404541
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
Validation loss decreased (-0.961109 --> -0.961110).  Saving model ...
Epoch: 28 cost time: 2.176103353500366
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.300 Vali Acc: 0.928 Test Loss: 0.300 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1414523124694824
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.117231607437134
Epoch: 30, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.462 Vali Acc: 0.883 Test Loss: 0.462 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 2779142
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.114151954650879
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.726 Vali Acc: 0.294 Test Loss: 1.726 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 6.3078391551971436
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.498 Vali Acc: 0.444 Test Loss: 1.498 Test Acc: 0.444
Validation loss decreased (-0.294427 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 6.160700559616089
Epoch: 3, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.235 Vali Acc: 0.567 Test Loss: 1.235 Test Acc: 0.567
Validation loss decreased (-0.444429 --> -0.566654).  Saving model ...
Epoch: 4 cost time: 6.13201904296875
Epoch: 4, Steps: 12 | Train Loss: 1.124 Vali Loss: 0.996 Vali Acc: 0.644 Test Loss: 0.996 Test Acc: 0.644
Validation loss decreased (-0.566654 --> -0.644434).  Saving model ...
Epoch: 5 cost time: 6.152590751647949
Epoch: 5, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.824 Vali Acc: 0.656 Test Loss: 0.824 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655547).  Saving model ...
Epoch: 6 cost time: 6.016978025436401
Epoch: 6, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.705 Vali Acc: 0.689 Test Loss: 0.705 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688882).  Saving model ...
Epoch: 7 cost time: 5.99365496635437
Epoch: 7, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.638 Vali Acc: 0.700 Test Loss: 0.638 Test Acc: 0.700
Validation loss decreased (-0.688882 --> -0.699994).  Saving model ...
Epoch: 8 cost time: 6.032533168792725
Epoch: 8, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.558 Vali Acc: 0.750 Test Loss: 0.558 Test Acc: 0.750
Validation loss decreased (-0.699994 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 6.2124128341674805
Epoch: 9, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.513 Vali Acc: 0.767 Test Loss: 0.513 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 6.3648951053619385
Epoch: 10, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.417 Vali Acc: 0.806 Test Loss: 0.417 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 5.748192310333252
Epoch: 11, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.372 Vali Acc: 0.806 Test Loss: 0.372 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 12 cost time: 5.695997476577759
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 5.81360125541687
Epoch: 13, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.419 Vali Acc: 0.822 Test Loss: 0.419 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.270617485046387
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.870351314544678
Epoch: 15, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.284 Vali Acc: 0.856 Test Loss: 0.284 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855553).  Saving model ...
Epoch: 16 cost time: 5.999141216278076
Epoch: 16, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 17 cost time: 6.047264099121094
Epoch: 17, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.259 Vali Acc: 0.861 Test Loss: 0.259 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.655665397644043
Epoch: 18, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.866664 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 6.501084804534912
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.467766523361206
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.439645290374756
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 6.82529616355896
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.591 Vali Acc: 0.839 Test Loss: 0.591 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.985503911972046
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.7484917640686035
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 6.531479597091675
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.626415729522705
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.728455305099487
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.1182661056518555
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.173814296722412
Epoch: 29, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.445425033569336
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 9387782
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.8406853675842285
Epoch: 1, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.662 Vali Acc: 0.406 Test Loss: 1.662 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 3.2101426124572754
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.458 Vali Acc: 0.578 Test Loss: 1.458 Test Acc: 0.578
Validation loss decreased (-0.405539 --> -0.577763).  Saving model ...
Epoch: 3 cost time: 2.9896185398101807
Epoch: 3, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.226 Vali Acc: 0.728 Test Loss: 1.226 Test Acc: 0.728
Validation loss decreased (-0.577763 --> -0.727766).  Saving model ...
Epoch: 4 cost time: 3.2243452072143555
Epoch: 4, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
Validation loss decreased (-0.727766 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 2.842318534851074
Epoch: 5, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766658).  Saving model ...
Epoch: 6 cost time: 3.1770875453948975
Epoch: 6, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8398406505584717
Epoch: 7, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.594 Vali Acc: 0.772 Test Loss: 0.594 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 3.202371120452881
Epoch: 8, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.527 Vali Acc: 0.806 Test Loss: 0.527 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 2.9415042400360107
Epoch: 9, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2938435077667236
Epoch: 10, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
Validation loss decreased (-0.805550 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 2.8722074031829834
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.415 Vali Acc: 0.822 Test Loss: 0.415 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.325313091278076
Epoch: 12, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 3.1510300636291504
Epoch: 13, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.363 Vali Acc: 0.867 Test Loss: 0.363 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 3.5073490142822266
Epoch: 14, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1879589557647705
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.312 Vali Acc: 0.872 Test Loss: 0.312 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 3.2219011783599854
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.298 Vali Acc: 0.856 Test Loss: 0.298 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.242401599884033
Epoch: 17, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.296 Vali Acc: 0.867 Test Loss: 0.296 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9376978874206543
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.311 Vali Acc: 0.883 Test Loss: 0.311 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 2.6648592948913574
Epoch: 19, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 2.7341082096099854
Epoch: 20, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.393 Vali Acc: 0.844 Test Loss: 0.393 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.717867851257324
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 3.130211591720581
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 3.197678565979004
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.323 Vali Acc: 0.922 Test Loss: 0.323 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 2.94286847114563
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927775).  Saving model ...
Epoch: 25 cost time: 2.928312301635742
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3977832794189453
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0865094661712646
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.541 Vali Acc: 0.889 Test Loss: 0.541 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9445722103118896
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.302 Vali Acc: 0.906 Test Loss: 0.302 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.0650837421417236
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.2779929637908936
Epoch: 30, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2767366
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.426267385482788
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.726 Vali Acc: 0.294 Test Loss: 1.726 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 4.441072463989258
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.498 Vali Acc: 0.444 Test Loss: 1.498 Test Acc: 0.444
Validation loss decreased (-0.294427 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 4.514400959014893
Epoch: 3, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.235 Vali Acc: 0.567 Test Loss: 1.235 Test Acc: 0.567
Validation loss decreased (-0.444429 --> -0.566654).  Saving model ...
Epoch: 4 cost time: 4.412336111068726
Epoch: 4, Steps: 12 | Train Loss: 1.124 Vali Loss: 0.996 Vali Acc: 0.644 Test Loss: 0.996 Test Acc: 0.644
Validation loss decreased (-0.566654 --> -0.644434).  Saving model ...
Epoch: 5 cost time: 3.938086748123169
Epoch: 5, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.824 Vali Acc: 0.656 Test Loss: 0.824 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655547).  Saving model ...
Epoch: 6 cost time: 3.966057062149048
Epoch: 6, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.705 Vali Acc: 0.689 Test Loss: 0.705 Test Acc: 0.689
Validation loss decreased (-0.655547 --> -0.688882).  Saving model ...
Epoch: 7 cost time: 3.9365527629852295
Epoch: 7, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.638 Vali Acc: 0.700 Test Loss: 0.638 Test Acc: 0.700
Validation loss decreased (-0.688882 --> -0.699994).  Saving model ...
Epoch: 8 cost time: 3.9243643283843994
Epoch: 8, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.558 Vali Acc: 0.750 Test Loss: 0.558 Test Acc: 0.750
Validation loss decreased (-0.699994 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 3.9530751705169678
Epoch: 9, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.513 Vali Acc: 0.767 Test Loss: 0.513 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766662).  Saving model ...
Epoch: 10 cost time: 4.026085615158081
Epoch: 10, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 4.028035879135132
Epoch: 11, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 12 cost time: 3.394573211669922
Epoch: 12, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.414 Vali Acc: 0.839 Test Loss: 0.414 Test Acc: 0.839
Validation loss decreased (-0.805552 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 4.087802410125732
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.378 Vali Acc: 0.844 Test Loss: 0.378 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 5.245513200759888
Epoch: 14, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 4.910658597946167
Epoch: 15, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 16 cost time: 5.26343560218811
Epoch: 16, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.302 Vali Acc: 0.861 Test Loss: 0.302 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 4.827402353286743
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 5.260906219482422
Epoch: 18, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.888886 --> -0.938887).  Saving model ...
Epoch: 19 cost time: 4.978945732116699
Epoch: 19, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.252397060394287
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.794762134552002
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.107865810394287
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.688831090927124
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.0984787940979
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.7511982917785645
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.441 Vali Acc: 0.872 Test Loss: 0.441 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.295023679733276
Epoch: 26, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.699230194091797
Epoch: 27, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.124851226806641
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 9387782
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.018038749694824
Epoch: 1, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.662 Vali Acc: 0.406 Test Loss: 1.662 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 2.7907214164733887
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.458 Vali Acc: 0.578 Test Loss: 1.458 Test Acc: 0.578
Validation loss decreased (-0.405539 --> -0.577763).  Saving model ...
Epoch: 3 cost time: 2.6667277812957764
Epoch: 3, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.226 Vali Acc: 0.728 Test Loss: 1.226 Test Acc: 0.728
Validation loss decreased (-0.577763 --> -0.727766).  Saving model ...
Epoch: 4 cost time: 2.4027938842773438
Epoch: 4, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
Validation loss decreased (-0.727766 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 2.4757297039031982
Epoch: 5, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766659).  Saving model ...
Epoch: 6 cost time: 2.680351495742798
Epoch: 6, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4654805660247803
Epoch: 7, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.594 Vali Acc: 0.772 Test Loss: 0.594 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 2.418877363204956
Epoch: 8, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.527 Vali Acc: 0.806 Test Loss: 0.527 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805550).  Saving model ...
Epoch: 9 cost time: 2.7835538387298584
Epoch: 9, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5958595275878906
Epoch: 10, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.455 Vali Acc: 0.828 Test Loss: 0.455 Test Acc: 0.828
Validation loss decreased (-0.805550 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 2.502058506011963
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.415 Vali Acc: 0.817 Test Loss: 0.415 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.802398204803467
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.827773 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.4031434059143066
Epoch: 13, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.367 Vali Acc: 0.867 Test Loss: 0.367 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 14 cost time: 2.7380282878875732
Epoch: 14, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0324723720550537
Epoch: 15, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.318 Vali Acc: 0.867 Test Loss: 0.318 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 2.7615835666656494
Epoch: 16, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.301 Vali Acc: 0.861 Test Loss: 0.301 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0013628005981445
Epoch: 17, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.290 Vali Acc: 0.872 Test Loss: 0.290 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 3.0646138191223145
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 2.7544991970062256
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 3.0243680477142334
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.389 Vali Acc: 0.839 Test Loss: 0.389 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0173749923706055
Epoch: 21, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8729443550109863
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.333 Vali Acc: 0.894 Test Loss: 0.333 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0271759033203125
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.927495241165161
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
Validation loss decreased (-0.894441 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 2.87078857421875
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.421 Vali Acc: 0.906 Test Loss: 0.421 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.055161237716675
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 2.7591114044189453
Epoch: 27, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.801393747329712
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2273671627044678
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 30 cost time: 2.9597456455230713
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2767366
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.934462547302246
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.733 Vali Acc: 0.294 Test Loss: 1.733 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 3.356257915496826
Epoch: 2, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.522 Vali Acc: 0.411 Test Loss: 1.522 Test Acc: 0.411
Validation loss decreased (-0.294427 --> -0.411096).  Saving model ...
Epoch: 3 cost time: 3.258772850036621
Epoch: 3, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.270 Vali Acc: 0.539 Test Loss: 1.270 Test Acc: 0.539
Validation loss decreased (-0.411096 --> -0.538876).  Saving model ...
Epoch: 4 cost time: 3.467796802520752
Epoch: 4, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.033 Vali Acc: 0.617 Test Loss: 1.033 Test Acc: 0.617
Validation loss decreased (-0.538876 --> -0.616656).  Saving model ...
Epoch: 5 cost time: 3.355069875717163
Epoch: 5, Steps: 12 | Train Loss: 0.939 Vali Loss: 0.860 Vali Acc: 0.633 Test Loss: 0.860 Test Acc: 0.633
Validation loss decreased (-0.616656 --> -0.633325).  Saving model ...
Epoch: 6 cost time: 2.951242446899414
Epoch: 6, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.739 Vali Acc: 0.683 Test Loss: 0.739 Test Acc: 0.683
Validation loss decreased (-0.633325 --> -0.683326).  Saving model ...
Epoch: 7 cost time: 3.2211530208587646
Epoch: 7, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.667 Vali Acc: 0.689 Test Loss: 0.667 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688882).  Saving model ...
Epoch: 8 cost time: 2.5142550468444824
Epoch: 8, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.582 Vali Acc: 0.744 Test Loss: 0.582 Test Acc: 0.744
Validation loss decreased (-0.688882 --> -0.744439).  Saving model ...
Epoch: 9 cost time: 2.5413904190063477
Epoch: 9, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.536 Vali Acc: 0.767 Test Loss: 0.536 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 2.2178969383239746
Epoch: 10, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.448 Vali Acc: 0.778 Test Loss: 0.448 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 11 cost time: 2.675701141357422
Epoch: 11, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.451 Vali Acc: 0.761 Test Loss: 0.451 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7261409759521484
Epoch: 12, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.408 Vali Acc: 0.822 Test Loss: 0.408 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 2.5282673835754395
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.447 Vali Acc: 0.822 Test Loss: 0.447 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.932730197906494
Epoch: 14, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.396 Vali Acc: 0.806 Test Loss: 0.396 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4789931774139404
Epoch: 15, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855553).  Saving model ...
Epoch: 16 cost time: 2.729480028152466
Epoch: 16, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.555758237838745
Epoch: 17, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.571038246154785
Epoch: 18, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
Validation loss decreased (-0.861108 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 2.9244024753570557
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5505428314208984
Epoch: 20, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.010770082473755
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 3.0622398853302
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9124464988708496
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.216003894805908
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9466190338134766
Epoch: 25, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 3.0268023014068604
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.994642972946167
Epoch: 27, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.913175106048584
Epoch: 28, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.197463035583496
Epoch: 29, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.8995940685272217
Epoch: 30, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 9387782
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.603839159011841
Epoch: 1, Steps: 12 | Train Loss: 1.782 Vali Loss: 1.662 Vali Acc: 0.406 Test Loss: 1.662 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 2.1508445739746094
Epoch: 2, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.462 Vali Acc: 0.578 Test Loss: 1.462 Test Acc: 0.578
Validation loss decreased (-0.405539 --> -0.577763).  Saving model ...
Epoch: 3 cost time: 1.8610432147979736
Epoch: 3, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.233 Vali Acc: 0.717 Test Loss: 1.233 Test Acc: 0.717
Validation loss decreased (-0.577763 --> -0.716654).  Saving model ...
Epoch: 4 cost time: 2.283346652984619
Epoch: 4, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.024 Vali Acc: 0.744 Test Loss: 1.024 Test Acc: 0.744
Validation loss decreased (-0.716654 --> -0.744434).  Saving model ...
Epoch: 5 cost time: 1.9194133281707764
Epoch: 5, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.831 Vali Acc: 0.756 Test Loss: 0.831 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 2.1749837398529053
Epoch: 6, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.693 Vali Acc: 0.739 Test Loss: 0.693 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9568862915039062
Epoch: 7, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 2.2067368030548096
Epoch: 8, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788883).  Saving model ...
Epoch: 9 cost time: 2.0516128540039062
Epoch: 9, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.499 Vali Acc: 0.772 Test Loss: 0.499 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2041897773742676
Epoch: 10, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.469 Vali Acc: 0.817 Test Loss: 0.469 Test Acc: 0.817
Validation loss decreased (-0.788883 --> -0.816662).  Saving model ...
Epoch: 11 cost time: 1.9788050651550293
Epoch: 11, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.433 Vali Acc: 0.806 Test Loss: 0.433 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.01139497756958
Epoch: 12, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 2.0195162296295166
Epoch: 13, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.388 Vali Acc: 0.856 Test Loss: 0.388 Test Acc: 0.856
Validation loss decreased (-0.833329 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.9683332443237305
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.367 Vali Acc: 0.828 Test Loss: 0.367 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.052577018737793
Epoch: 15, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9335381984710693
Epoch: 16, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.345 Vali Acc: 0.872 Test Loss: 0.345 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 2.144684314727783
Epoch: 17, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0512421131134033
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.341 Vali Acc: 0.883 Test Loss: 0.341 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 1.9966933727264404
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.343 Vali Acc: 0.867 Test Loss: 0.343 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8159573078155518
Epoch: 20, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0068187713623047
Epoch: 21, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.6466867923736572
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.963350534439087
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.336 Vali Acc: 0.928 Test Loss: 0.336 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927774).  Saving model ...
Epoch: 24 cost time: 1.717536211013794
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.342 Vali Acc: 0.917 Test Loss: 0.342 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9549901485443115
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.740884780883789
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.041949987411499
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.86936616897583
Epoch: 28, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.406 Vali Acc: 0.922 Test Loss: 0.406 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.036339521408081
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.428 Vali Acc: 0.872 Test Loss: 0.428 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7749769687652588
Epoch: 30, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.449 Vali Acc: 0.911 Test Loss: 0.449 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2767366
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.978566884994507
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.775 Vali Acc: 0.289 Test Loss: 1.775 Test Acc: 0.289
Validation loss decreased (inf --> -0.288871).  Saving model ...
Epoch: 2 cost time: 4.0452868938446045
Epoch: 2, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.612 Vali Acc: 0.422 Test Loss: 1.612 Test Acc: 0.422
Validation loss decreased (-0.288871 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 5.246900320053101
Epoch: 3, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.385 Vali Acc: 0.578 Test Loss: 1.385 Test Acc: 0.578
Validation loss decreased (-0.422206 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 4.611979961395264
Epoch: 4, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.141 Vali Acc: 0.667 Test Loss: 1.141 Test Acc: 0.667
Validation loss decreased (-0.577764 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 5.006037712097168
Epoch: 5, Steps: 12 | Train Loss: 0.979 Vali Loss: 0.921 Vali Acc: 0.706 Test Loss: 0.921 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705546).  Saving model ...
Epoch: 6 cost time: 5.234427213668823
Epoch: 6, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 4.764459848403931
Epoch: 7, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 4.967692136764526
Epoch: 8, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.541 Vali Acc: 0.761 Test Loss: 0.541 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 5.241299629211426
Epoch: 9, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.467 Vali Acc: 0.794 Test Loss: 0.467 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794440).  Saving model ...
Epoch: 10 cost time: 4.818351745605469
Epoch: 10, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.415 Vali Acc: 0.828 Test Loss: 0.415 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 4.929997205734253
Epoch: 11, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 5.288790464401245
Epoch: 12, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.331 Vali Acc: 0.839 Test Loss: 0.331 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 4.832679271697998
Epoch: 13, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.310 Vali Acc: 0.822 Test Loss: 0.310 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.985097169876099
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.295 Vali Acc: 0.822 Test Loss: 0.295 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.268099308013916
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.311 Vali Acc: 0.828 Test Loss: 0.311 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.807062149047852
Epoch: 16, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.316 Vali Acc: 0.806 Test Loss: 0.316 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.00775408744812
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 5.3062427043914795
Epoch: 18, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.288 Vali Acc: 0.844 Test Loss: 0.288 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.406192064285278
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.270 Vali Acc: 0.844 Test Loss: 0.270 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.253193140029907
Epoch: 20, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.251 Vali Acc: 0.878 Test Loss: 0.251 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 4.8048577308654785
Epoch: 21, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 4.325789213180542
Epoch: 22, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.024365186691284
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.245 Vali Acc: 0.889 Test Loss: 0.245 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.62945556640625
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933332).  Saving model ...
Epoch: 25 cost time: 4.568310976028442
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.504724740982056
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.3648927211761475
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.154 Vali Acc: 0.922 Test Loss: 0.154 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.219965219497681
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.863631963729858
Epoch: 29, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.157 Vali Acc: 0.939 Test Loss: 0.157 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 5.37288236618042
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 4700422
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.592707633972168
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.724 Vali Acc: 0.300 Test Loss: 1.724 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 3.0363197326660156
Epoch: 2, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.558 Vali Acc: 0.467 Test Loss: 1.558 Test Acc: 0.467
Validation loss decreased (-0.299983 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 2.8280129432678223
Epoch: 3, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.355 Vali Acc: 0.544 Test Loss: 1.355 Test Acc: 0.544
Validation loss decreased (-0.466651 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 3.0344762802124023
Epoch: 4, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.123 Vali Acc: 0.667 Test Loss: 1.123 Test Acc: 0.667
Validation loss decreased (-0.544431 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 2.793325185775757
Epoch: 5, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.913 Vali Acc: 0.694 Test Loss: 0.913 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 2.755953311920166
Epoch: 6, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.756 Vali Acc: 0.722 Test Loss: 0.756 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722215).  Saving model ...
Epoch: 7 cost time: 2.4552500247955322
Epoch: 7, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 2.426152467727661
Epoch: 8, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.559 Vali Acc: 0.756 Test Loss: 0.559 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 2.4638137817382812
Epoch: 9, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.497 Vali Acc: 0.794 Test Loss: 0.497 Test Acc: 0.794
Validation loss decreased (-0.755550 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 2.724789619445801
Epoch: 10, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.445 Vali Acc: 0.794 Test Loss: 0.445 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 3.013410806655884
Epoch: 11, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.399 Vali Acc: 0.806 Test Loss: 0.399 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 12 cost time: 2.902963876724243
Epoch: 12, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.805552 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.822758436203003
Epoch: 13, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.017221212387085
Epoch: 14, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 2.824307680130005
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 2.717132568359375
Epoch: 16, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 3.001089334487915
Epoch: 17, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.883330 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 2.9831907749176025
Epoch: 18, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5174665451049805
Epoch: 19, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.331 Vali Acc: 0.872 Test Loss: 0.331 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.471850633621216
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.243 Vali Acc: 0.906 Test Loss: 0.243 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.782430648803711
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.475673198699951
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 23 cost time: 2.3687057495117188
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 2.5446360111236572
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.644028663635254
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.6191015243530273
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.410705089569092
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
Validation loss decreased (-0.949998 --> -0.961109).  Saving model ...
Epoch: 28 cost time: 2.7259058952331543
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5309035778045654
Epoch: 29, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.7116124629974365
Epoch: 30, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 1390086
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.738556385040283
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.775 Vali Acc: 0.289 Test Loss: 1.775 Test Acc: 0.289
Validation loss decreased (inf --> -0.288871).  Saving model ...
Epoch: 2 cost time: 3.888732671737671
Epoch: 2, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.612 Vali Acc: 0.422 Test Loss: 1.612 Test Acc: 0.422
Validation loss decreased (-0.288871 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 3.8876547813415527
Epoch: 3, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.385 Vali Acc: 0.578 Test Loss: 1.385 Test Acc: 0.578
Validation loss decreased (-0.422206 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 3.725534200668335
Epoch: 4, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.141 Vali Acc: 0.667 Test Loss: 1.141 Test Acc: 0.667
Validation loss decreased (-0.577764 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 3.6393449306488037
Epoch: 5, Steps: 12 | Train Loss: 0.979 Vali Loss: 0.921 Vali Acc: 0.706 Test Loss: 0.921 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705546).  Saving model ...
Epoch: 6 cost time: 3.510983943939209
Epoch: 6, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.749 Vali Acc: 0.744 Test Loss: 0.749 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 3.5701677799224854
Epoch: 7, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 3.6793980598449707
Epoch: 8, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.541 Vali Acc: 0.761 Test Loss: 0.541 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 3.5392746925354004
Epoch: 9, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.468 Vali Acc: 0.794 Test Loss: 0.468 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794440).  Saving model ...
Epoch: 10 cost time: 3.7142302989959717
Epoch: 10, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.415 Vali Acc: 0.828 Test Loss: 0.415 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 3.793541193008423
Epoch: 11, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 3.8508148193359375
Epoch: 12, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 3.88429856300354
Epoch: 13, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.311 Vali Acc: 0.822 Test Loss: 0.311 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.1149678230285645
Epoch: 14, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.301 Vali Acc: 0.822 Test Loss: 0.301 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.588517427444458
Epoch: 15, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.334 Vali Acc: 0.817 Test Loss: 0.334 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.458585262298584
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.287 Vali Acc: 0.850 Test Loss: 0.287 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 3.294966697692871
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.286 Vali Acc: 0.856 Test Loss: 0.286 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 18 cost time: 3.53891921043396
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.293 Vali Acc: 0.833 Test Loss: 0.293 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8374855518341064
Epoch: 19, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.278 Vali Acc: 0.833 Test Loss: 0.278 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4430277347564697
Epoch: 20, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.252 Vali Acc: 0.867 Test Loss: 0.252 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 21 cost time: 3.4083776473999023
Epoch: 21, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.297 Vali Acc: 0.878 Test Loss: 0.297 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 3.4752683639526367
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8713347911834717
Epoch: 23, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.245 Vali Acc: 0.878 Test Loss: 0.245 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 3.284166097640991
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 3.2842211723327637
Epoch: 25, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7252347469329834
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.888886 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 4.029293537139893
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.767322063446045
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8118419647216797
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.195205211639404
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.187 Vali Acc: 0.922 Test Loss: 0.187 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 4700422
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.428772687911987
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.724 Vali Acc: 0.300 Test Loss: 1.724 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 2.202458381652832
Epoch: 2, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.558 Vali Acc: 0.467 Test Loss: 1.558 Test Acc: 0.467
Validation loss decreased (-0.299983 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 2.4860332012176514
Epoch: 3, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.355 Vali Acc: 0.544 Test Loss: 1.355 Test Acc: 0.544
Validation loss decreased (-0.466651 --> -0.544431).  Saving model ...
Epoch: 4 cost time: 2.2640023231506348
Epoch: 4, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.123 Vali Acc: 0.667 Test Loss: 1.123 Test Acc: 0.667
Validation loss decreased (-0.544431 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 2.582894802093506
Epoch: 5, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.913 Vali Acc: 0.694 Test Loss: 0.913 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 2.293891191482544
Epoch: 6, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.756 Vali Acc: 0.722 Test Loss: 0.756 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722215).  Saving model ...
Epoch: 7 cost time: 2.481640338897705
Epoch: 7, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 2.3295695781707764
Epoch: 8, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.559 Vali Acc: 0.756 Test Loss: 0.559 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 2.410492181777954
Epoch: 9, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.497 Vali Acc: 0.794 Test Loss: 0.497 Test Acc: 0.794
Validation loss decreased (-0.755550 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 2.2524421215057373
Epoch: 10, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.445 Vali Acc: 0.794 Test Loss: 0.445 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 2.3483240604400635
Epoch: 11, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.399 Vali Acc: 0.806 Test Loss: 0.399 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805552).  Saving model ...
Epoch: 12 cost time: 2.2338500022888184
Epoch: 12, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.805552 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.3950648307800293
Epoch: 13, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.292635679244995
Epoch: 14, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.331 Vali Acc: 0.850 Test Loss: 0.331 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 2.2748889923095703
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 2.2567925453186035
Epoch: 16, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 2.35823392868042
Epoch: 17, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.883330 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 2.244785785675049
Epoch: 18, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.395966053009033
Epoch: 19, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3196663856506348
Epoch: 20, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8322498798370361
Epoch: 21, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8706507682800293
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 1.7962801456451416
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 1.7427706718444824
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8224446773529053
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.225 Vali Acc: 0.939 Test Loss: 0.225 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8551373481750488
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.2464892864227295
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0309393405914307
Epoch: 28, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.899336814880371
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.009739398956299
Epoch: 30, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1390086
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.3131468296051025
Epoch: 1, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.779 Vali Acc: 0.278 Test Loss: 1.779 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 2.3058533668518066
Epoch: 2, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.622 Vali Acc: 0.422 Test Loss: 1.622 Test Acc: 0.422
Validation loss decreased (-0.277760 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 2.3493916988372803
Epoch: 3, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.401 Vali Acc: 0.567 Test Loss: 1.401 Test Acc: 0.567
Validation loss decreased (-0.422206 --> -0.566653).  Saving model ...
Epoch: 4 cost time: 2.3668313026428223
Epoch: 4, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.157 Vali Acc: 0.667 Test Loss: 1.157 Test Acc: 0.667
Validation loss decreased (-0.566653 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 2.638880729675293
Epoch: 5, Steps: 12 | Train Loss: 0.979 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 2.5621025562286377
Epoch: 6, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.765 Vali Acc: 0.744 Test Loss: 0.765 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744437).  Saving model ...
Epoch: 7 cost time: 2.349202871322632
Epoch: 7, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 2.3803582191467285
Epoch: 8, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.555 Vali Acc: 0.756 Test Loss: 0.555 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 2.5754334926605225
Epoch: 9, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.482 Vali Acc: 0.789 Test Loss: 0.482 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 2.6261391639709473
Epoch: 10, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.431 Vali Acc: 0.828 Test Loss: 0.431 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 2.434307098388672
Epoch: 11, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.405 Vali Acc: 0.833 Test Loss: 0.405 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.3539602756500244
Epoch: 12, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 2.4568557739257812
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.355 Vali Acc: 0.833 Test Loss: 0.355 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 2.648470401763916
Epoch: 14, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6231114864349365
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.392 Vali Acc: 0.811 Test Loss: 0.392 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.33013916015625
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.348 Vali Acc: 0.806 Test Loss: 0.348 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3632853031158447
Epoch: 17, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 2.5254251956939697
Epoch: 18, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.311 Vali Acc: 0.844 Test Loss: 0.311 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6806888580322266
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 2.5434155464172363
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.269 Vali Acc: 0.867 Test Loss: 0.269 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.519495964050293
Epoch: 21, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.336 Vali Acc: 0.872 Test Loss: 0.336 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.383430242538452
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 2.5699527263641357
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6275975704193115
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 2.48689866065979
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 2.422215223312378
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3347084522247314
Epoch: 27, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.407 Vali Acc: 0.872 Test Loss: 0.407 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.370823383331299
Epoch: 28, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.331 Vali Acc: 0.883 Test Loss: 0.331 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2773849964141846
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1148810386657715
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 4700422
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2508184909820557
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.725 Vali Acc: 0.294 Test Loss: 1.725 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 1.5105054378509521
Epoch: 2, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.568 Vali Acc: 0.467 Test Loss: 1.568 Test Acc: 0.467
Validation loss decreased (-0.294427 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 1.4972994327545166
Epoch: 3, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.372 Vali Acc: 0.528 Test Loss: 1.372 Test Acc: 0.528
Validation loss decreased (-0.466651 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.4811644554138184
Epoch: 4, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.148 Vali Acc: 0.656 Test Loss: 1.148 Test Acc: 0.656
Validation loss decreased (-0.527764 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 1.9571943283081055
Epoch: 5, Steps: 12 | Train Loss: 0.992 Vali Loss: 0.939 Vali Acc: 0.683 Test Loss: 0.939 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 2.0093131065368652
Epoch: 6, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
Validation loss decreased (-0.683324 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 1.8415217399597168
Epoch: 7, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.91310453414917
Epoch: 8, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.579 Vali Acc: 0.744 Test Loss: 0.579 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.10398268699646
Epoch: 9, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.514 Vali Acc: 0.778 Test Loss: 0.514 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777773).  Saving model ...
Epoch: 10 cost time: 2.130603790283203
Epoch: 10, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.459 Vali Acc: 0.789 Test Loss: 0.459 Test Acc: 0.789
Validation loss decreased (-0.777773 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 1.8482122421264648
Epoch: 11, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 2.0622854232788086
Epoch: 12, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.380 Vali Acc: 0.844 Test Loss: 0.380 Test Acc: 0.844
Validation loss decreased (-0.811107 --> -0.844441).  Saving model ...
Epoch: 13 cost time: 2.1459953784942627
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9226200580596924
Epoch: 14, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.341 Vali Acc: 0.844 Test Loss: 0.341 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 2.0135996341705322
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 2.104978322982788
Epoch: 16, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 2.130598306655884
Epoch: 17, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
Validation loss decreased (-0.877775 --> -0.938886).  Saving model ...
Epoch: 18 cost time: 2.0156290531158447
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0368716716766357
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.10229229927063
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0969631671905518
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0470471382141113
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9021024703979492
Epoch: 23, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 2.2219552993774414
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1102101802825928
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.227 Vali Acc: 0.939 Test Loss: 0.227 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0769662857055664
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.152604341506958
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 2.200291633605957
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9530930519104004
Epoch: 29, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1049108505249023
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 1390086
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.677075147628784
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.757 Vali Acc: 0.211 Test Loss: 1.757 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 4.340954780578613
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.593 Vali Acc: 0.461 Test Loss: 1.593 Test Acc: 0.461
Validation loss decreased (-0.211094 --> -0.461095).  Saving model ...
Epoch: 3 cost time: 3.899336099624634
Epoch: 3, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.397 Vali Acc: 0.672 Test Loss: 1.397 Test Acc: 0.672
Validation loss decreased (-0.461095 --> -0.672208).  Saving model ...
Epoch: 4 cost time: 4.381706953048706
Epoch: 4, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.166 Vali Acc: 0.722 Test Loss: 1.166 Test Acc: 0.722
Validation loss decreased (-0.672208 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 4.132714509963989
Epoch: 5, Steps: 12 | Train Loss: 1.044 Vali Loss: 0.927 Vali Acc: 0.728 Test Loss: 0.927 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727769).  Saving model ...
Epoch: 6 cost time: 4.350191116333008
Epoch: 6, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761104).  Saving model ...
Epoch: 7 cost time: 3.9248666763305664
Epoch: 7, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 3.6047239303588867
Epoch: 8, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.508 Vali Acc: 0.800 Test Loss: 0.508 Test Acc: 0.800
Validation loss decreased (-0.761105 --> -0.799995).  Saving model ...
Epoch: 9 cost time: 4.004672527313232
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.450 Vali Acc: 0.789 Test Loss: 0.450 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7769720554351807
Epoch: 10, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.406 Vali Acc: 0.817 Test Loss: 0.406 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 4.017427206039429
Epoch: 11, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 3.5685341358184814
Epoch: 12, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 4.03321647644043
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 3.621000051498413
Epoch: 14, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 3.8107571601867676
Epoch: 15, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 3.7838714122772217
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 3.9278857707977295
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.315669059753418
Epoch: 18, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9273440837860107
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.308 Vali Acc: 0.883 Test Loss: 0.308 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.32219934463501
Epoch: 20, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 3.9054222106933594
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 4.282296895980835
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 4.056736469268799
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.033592700958252
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.322734832763672
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 4.030690431594849
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.295229434967041
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 3.955484628677368
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.27013635635376
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.373 Vali Acc: 0.917 Test Loss: 0.373 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9753620624542236
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 2356742
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.370945453643799
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.807 Vali Acc: 0.144 Test Loss: 1.807 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 2.9326634407043457
Epoch: 2, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.605 Vali Acc: 0.389 Test Loss: 1.605 Test Acc: 0.389
Validation loss decreased (-0.144426 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 2.901012897491455
Epoch: 3, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.383 Vali Acc: 0.644 Test Loss: 1.383 Test Acc: 0.644
Validation loss decreased (-0.388873 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 2.5950324535369873
Epoch: 4, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.155 Vali Acc: 0.694 Test Loss: 1.155 Test Acc: 0.694
Validation loss decreased (-0.644431 --> -0.694433).  Saving model ...
Epoch: 5 cost time: 2.876371383666992
Epoch: 5, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.939 Vali Acc: 0.744 Test Loss: 0.939 Test Acc: 0.744
Validation loss decreased (-0.694433 --> -0.744435).  Saving model ...
Epoch: 6 cost time: 2.8659865856170654
Epoch: 6, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.774 Vali Acc: 0.767 Test Loss: 0.774 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766659).  Saving model ...
Epoch: 7 cost time: 2.5605599880218506
Epoch: 7, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.650 Vali Acc: 0.772 Test Loss: 0.650 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 2.8730571269989014
Epoch: 8, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 2.887240171432495
Epoch: 9, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.482 Vali Acc: 0.806 Test Loss: 0.482 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 2.233471393585205
Epoch: 10, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.433 Vali Acc: 0.811 Test Loss: 0.433 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.5985984802246094
Epoch: 11, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.392 Vali Acc: 0.822 Test Loss: 0.392 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 2.627277135848999
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.369 Vali Acc: 0.861 Test Loss: 0.369 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 2.4017040729522705
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.627462387084961
Epoch: 14, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.54841947555542
Epoch: 15, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.343235731124878
Epoch: 16, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4595160484313965
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0183868408203125
Epoch: 18, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.972264051437378
Epoch: 19, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.278 Vali Acc: 0.844 Test Loss: 0.278 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9451959133148193
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.262 Vali Acc: 0.839 Test Loss: 0.262 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5100467205047607
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 2.244497299194336
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.244 Vali Acc: 0.850 Test Loss: 0.244 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.57443904876709
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.239 Vali Acc: 0.861 Test Loss: 0.239 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3182663917541504
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5063979625701904
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.232 Vali Acc: 0.894 Test Loss: 0.232 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 2.1720962524414062
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 1.9939515590667725
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9441349506378174
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 1.8833255767822266
Epoch: 29, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.799151659011841
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 701446
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.908812522888184
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.757 Vali Acc: 0.211 Test Loss: 1.757 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 2.8384270668029785
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.593 Vali Acc: 0.461 Test Loss: 1.593 Test Acc: 0.461
Validation loss decreased (-0.211094 --> -0.461095).  Saving model ...
Epoch: 3 cost time: 3.1835684776306152
Epoch: 3, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.396 Vali Acc: 0.672 Test Loss: 1.396 Test Acc: 0.672
Validation loss decreased (-0.461095 --> -0.672208).  Saving model ...
Epoch: 4 cost time: 2.830728054046631
Epoch: 4, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.165 Vali Acc: 0.722 Test Loss: 1.165 Test Acc: 0.722
Validation loss decreased (-0.672208 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 2.9630186557769775
Epoch: 5, Steps: 12 | Train Loss: 1.044 Vali Loss: 0.927 Vali Acc: 0.728 Test Loss: 0.927 Test Acc: 0.728
Validation loss decreased (-0.722211 --> -0.727769).  Saving model ...
Epoch: 6 cost time: 2.894808769226074
Epoch: 6, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.731 Vali Acc: 0.761 Test Loss: 0.731 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761104).  Saving model ...
Epoch: 7 cost time: 2.8209214210510254
Epoch: 7, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.598 Vali Acc: 0.761 Test Loss: 0.598 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 3.135833740234375
Epoch: 8, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.508 Vali Acc: 0.800 Test Loss: 0.508 Test Acc: 0.800
Validation loss decreased (-0.761105 --> -0.799995).  Saving model ...
Epoch: 9 cost time: 2.841973066329956
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.450 Vali Acc: 0.789 Test Loss: 0.450 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.097266912460327
Epoch: 10, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.406 Vali Acc: 0.817 Test Loss: 0.406 Test Acc: 0.817
Validation loss decreased (-0.799995 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 2.7394254207611084
Epoch: 11, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.378 Vali Acc: 0.817 Test Loss: 0.378 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 2.9685685634613037
Epoch: 12, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 3.0457136631011963
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 2.7880308628082275
Epoch: 14, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.308 Vali Acc: 0.872 Test Loss: 0.308 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 3.1316709518432617
Epoch: 15, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 2.8529210090637207
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.265 Vali Acc: 0.906 Test Loss: 0.265 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 3.0494465827941895
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9162464141845703
Epoch: 18, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8645517826080322
Epoch: 19, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0955679416656494
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.8167059421539307
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.321 Vali Acc: 0.922 Test Loss: 0.321 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 3.1761128902435303
Epoch: 22, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.339 Vali Acc: 0.928 Test Loss: 0.339 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 23 cost time: 2.856092929840088
Epoch: 23, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.219 Vali Acc: 0.939 Test Loss: 0.219 Test Acc: 0.939
Validation loss decreased (-0.927774 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 2.951453924179077
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.099135637283325
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.9234671592712402
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.184828758239746
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 2.8234639167785645
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0791165828704834
Epoch: 29, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.955609083175659
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.366 Vali Acc: 0.939 Test Loss: 0.366 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 2356742
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.042479991912842
Epoch: 1, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.807 Vali Acc: 0.144 Test Loss: 1.807 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 2.513899564743042
Epoch: 2, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.605 Vali Acc: 0.389 Test Loss: 1.605 Test Acc: 0.389
Validation loss decreased (-0.144426 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 2.355342149734497
Epoch: 3, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.383 Vali Acc: 0.644 Test Loss: 1.383 Test Acc: 0.644
Validation loss decreased (-0.388873 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 2.3895044326782227
Epoch: 4, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.155 Vali Acc: 0.694 Test Loss: 1.155 Test Acc: 0.694
Validation loss decreased (-0.644431 --> -0.694433).  Saving model ...
Epoch: 5 cost time: 2.3720357418060303
Epoch: 5, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.939 Vali Acc: 0.744 Test Loss: 0.939 Test Acc: 0.744
Validation loss decreased (-0.694433 --> -0.744435).  Saving model ...
Epoch: 6 cost time: 2.2481777667999268
Epoch: 6, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.774 Vali Acc: 0.767 Test Loss: 0.774 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766659).  Saving model ...
Epoch: 7 cost time: 2.6135406494140625
Epoch: 7, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.650 Vali Acc: 0.772 Test Loss: 0.650 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772216).  Saving model ...
Epoch: 8 cost time: 2.3048341274261475
Epoch: 8, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 9 cost time: 2.398033618927002
Epoch: 9, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.482 Vali Acc: 0.806 Test Loss: 0.482 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 2.0370750427246094
Epoch: 10, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.433 Vali Acc: 0.811 Test Loss: 0.433 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.0553314685821533
Epoch: 11, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.392 Vali Acc: 0.822 Test Loss: 0.392 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 2.037816286087036
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.369 Vali Acc: 0.861 Test Loss: 0.369 Test Acc: 0.861
Validation loss decreased (-0.822218 --> -0.861107).  Saving model ...
Epoch: 13 cost time: 2.6601150035858154
Epoch: 13, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.541710615158081
Epoch: 14, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.328 Vali Acc: 0.839 Test Loss: 0.328 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5618865489959717
Epoch: 15, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5977718830108643
Epoch: 16, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.294 Vali Acc: 0.844 Test Loss: 0.294 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4999985694885254
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6601521968841553
Epoch: 18, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.298 Vali Acc: 0.844 Test Loss: 0.298 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4743356704711914
Epoch: 19, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.279 Vali Acc: 0.844 Test Loss: 0.279 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3960378170013428
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.262 Vali Acc: 0.833 Test Loss: 0.262 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.723027229309082
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 2.5070483684539795
Epoch: 22, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.247 Vali Acc: 0.850 Test Loss: 0.247 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.737391471862793
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.243 Vali Acc: 0.856 Test Loss: 0.243 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.287620782852173
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.268 Vali Acc: 0.878 Test Loss: 0.268 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 2.381542682647705
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.236 Vali Acc: 0.894 Test Loss: 0.236 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 26 cost time: 2.51666259765625
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.330697774887085
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.541548728942871
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 2.379716157913208
Epoch: 29, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2633957862854004
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 701446
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8623592853546143
Epoch: 1, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.757 Vali Acc: 0.211 Test Loss: 1.757 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.8857758045196533
Epoch: 2, Steps: 12 | Train Loss: 1.698 Vali Loss: 1.594 Vali Acc: 0.461 Test Loss: 1.594 Test Acc: 0.461
Validation loss decreased (-0.211094 --> -0.461095).  Saving model ...
Epoch: 3 cost time: 2.261296510696411
Epoch: 3, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.398 Vali Acc: 0.672 Test Loss: 1.398 Test Acc: 0.672
Validation loss decreased (-0.461095 --> -0.672208).  Saving model ...
Epoch: 4 cost time: 2.182008743286133
Epoch: 4, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.168 Vali Acc: 0.722 Test Loss: 1.168 Test Acc: 0.722
Validation loss decreased (-0.672208 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 1.9392197132110596
Epoch: 5, Steps: 12 | Train Loss: 1.044 Vali Loss: 0.931 Vali Acc: 0.722 Test Loss: 0.931 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 2.228236198425293
Epoch: 6, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
Validation loss decreased (-0.722213 --> -0.761104).  Saving model ...
Epoch: 7 cost time: 2.201185464859009
Epoch: 7, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.03889799118042
Epoch: 8, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.515 Vali Acc: 0.794 Test Loss: 0.515 Test Acc: 0.794
Validation loss decreased (-0.761104 --> -0.794439).  Saving model ...
Epoch: 9 cost time: 2.239407539367676
Epoch: 9, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.457 Vali Acc: 0.783 Test Loss: 0.457 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1408944129943848
Epoch: 10, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.0918610095977783
Epoch: 11, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.383 Vali Acc: 0.811 Test Loss: 0.383 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 2.0615832805633545
Epoch: 12, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.351 Vali Acc: 0.833 Test Loss: 0.351 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 2.161719560623169
Epoch: 13, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 2.2363858222961426
Epoch: 14, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.313 Vali Acc: 0.867 Test Loss: 0.313 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 2.4563541412353516
Epoch: 15, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 2.1894311904907227
Epoch: 16, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.1434991359710693
Epoch: 17, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.305 Vali Acc: 0.878 Test Loss: 0.305 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3978841304779053
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.275 Vali Acc: 0.894 Test Loss: 0.275 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 2.2697055339813232
Epoch: 19, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.16409969329834
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4269468784332275
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 2.2788894176483154
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 2.3137028217315674
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927776).  Saving model ...
Epoch: 24 cost time: 2.507016181945801
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938886).  Saving model ...
Epoch: 25 cost time: 2.1558821201324463
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4890685081481934
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4310357570648193
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 28 cost time: 2.1701858043670654
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.928 Test Loss: 0.265 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.388042449951172
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.338 Vali Acc: 0.928 Test Loss: 0.338 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3886165618896484
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.939 Test Loss: 0.362 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2356742
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4821670055389404
Epoch: 1, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.811 Vali Acc: 0.139 Test Loss: 1.811 Test Acc: 0.139
Validation loss decreased (inf --> -0.138871).  Saving model ...
Epoch: 2 cost time: 2.186001777648926
Epoch: 2, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.616 Vali Acc: 0.389 Test Loss: 1.616 Test Acc: 0.389
Validation loss decreased (-0.138871 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 2.090177536010742
Epoch: 3, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.403 Vali Acc: 0.628 Test Loss: 1.403 Test Acc: 0.628
Validation loss decreased (-0.388873 --> -0.627764).  Saving model ...
Epoch: 4 cost time: 1.816981554031372
Epoch: 4, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.179 Vali Acc: 0.667 Test Loss: 1.179 Test Acc: 0.667
Validation loss decreased (-0.627764 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 2.114732027053833
Epoch: 5, Steps: 12 | Train Loss: 1.050 Vali Loss: 0.965 Vali Acc: 0.722 Test Loss: 0.965 Test Acc: 0.722
Validation loss decreased (-0.666655 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 2.0929975509643555
Epoch: 6, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 1.9153861999511719
Epoch: 7, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.677 Vali Acc: 0.756 Test Loss: 0.677 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755549).  Saving model ...
Epoch: 8 cost time: 1.887765645980835
Epoch: 8, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.584 Vali Acc: 0.767 Test Loss: 0.584 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.6871097087860107
Epoch: 9, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.6239583492279053
Epoch: 10, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.456 Vali Acc: 0.794 Test Loss: 0.456 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 1.701930284500122
Epoch: 11, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.415 Vali Acc: 0.817 Test Loss: 0.415 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 12 cost time: 1.688094139099121
Epoch: 12, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.816663 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 2.0293240547180176
Epoch: 13, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8416132926940918
Epoch: 14, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0289361476898193
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8109006881713867
Epoch: 16, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.311 Vali Acc: 0.833 Test Loss: 0.311 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.006228446960449
Epoch: 17, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.8483166694641113
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.314 Vali Acc: 0.839 Test Loss: 0.314 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0356009006500244
Epoch: 19, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.297 Vali Acc: 0.833 Test Loss: 0.297 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8332858085632324
Epoch: 20, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.280 Vali Acc: 0.822 Test Loss: 0.280 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8849477767944336
Epoch: 21, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 1.7097575664520264
Epoch: 22, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.263 Vali Acc: 0.844 Test Loss: 0.263 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8648560047149658
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.262 Vali Acc: 0.850 Test Loss: 0.262 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.771057367324829
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8295679092407227
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 1.796365737915039
Epoch: 26, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 1.8299965858459473
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8542895317077637
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 29 cost time: 1.8154897689819336
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9120194911956787
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 701446
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.906260967254639
Epoch: 1, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.770 Vali Acc: 0.161 Test Loss: 1.770 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 3.8885059356689453
Epoch: 2, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.667 Vali Acc: 0.289 Test Loss: 1.667 Test Acc: 0.289
Validation loss decreased (-0.161093 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 3.742166042327881
Epoch: 3, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.539 Vali Acc: 0.400 Test Loss: 1.539 Test Acc: 0.400
Validation loss decreased (-0.288872 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 3.707334041595459
Epoch: 4, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.391 Vali Acc: 0.539 Test Loss: 1.391 Test Acc: 0.539
Validation loss decreased (-0.399985 --> -0.538875).  Saving model ...
Epoch: 5 cost time: 3.9791972637176514
Epoch: 5, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.233 Vali Acc: 0.639 Test Loss: 1.233 Test Acc: 0.639
Validation loss decreased (-0.538875 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 4.092564344406128
Epoch: 6, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.079 Vali Acc: 0.672 Test Loss: 1.079 Test Acc: 0.672
Validation loss decreased (-0.638877 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 4.024065017700195
Epoch: 7, Steps: 12 | Train Loss: 0.997 Vali Loss: 0.942 Vali Acc: 0.711 Test Loss: 0.942 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711102).  Saving model ...
Epoch: 8 cost time: 3.8602476119995117
Epoch: 8, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.835 Vali Acc: 0.733 Test Loss: 0.835 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 3.7557716369628906
Epoch: 9, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772215).  Saving model ...
Epoch: 10 cost time: 3.7269389629364014
Epoch: 10, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.689 Vali Acc: 0.794 Test Loss: 0.689 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794438).  Saving model ...
Epoch: 11 cost time: 4.025568246841431
Epoch: 11, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.628 Vali Acc: 0.778 Test Loss: 0.628 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.185656547546387
Epoch: 12, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.579 Vali Acc: 0.800 Test Loss: 0.579 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 3.803164005279541
Epoch: 13, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.529 Vali Acc: 0.778 Test Loss: 0.529 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.675837993621826
Epoch: 14, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.512 Vali Acc: 0.800 Test Loss: 0.512 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 3.5130770206451416
Epoch: 15, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.467 Vali Acc: 0.828 Test Loss: 0.467 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 16 cost time: 3.4515888690948486
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827773).  Saving model ...
Epoch: 17 cost time: 3.749253749847412
Epoch: 17, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.401 Vali Acc: 0.839 Test Loss: 0.401 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 3.923480272293091
Epoch: 18, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.377 Vali Acc: 0.844 Test Loss: 0.377 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 3.7541017532348633
Epoch: 19, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.353 Vali Acc: 0.861 Test Loss: 0.353 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 3.6033835411071777
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.557420015335083
Epoch: 21, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4804742336273193
Epoch: 22, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.311 Vali Acc: 0.856 Test Loss: 0.311 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7545652389526367
Epoch: 23, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 3.3917696475982666
Epoch: 24, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1947436332702637
Epoch: 25, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1215174198150635
Epoch: 26, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.024728536605835
Epoch: 27, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 2.9298880100250244
Epoch: 28, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.8625879287719727
Epoch: 29, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.325372219085693
Epoch: 30, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.236 Vali Acc: 0.894 Test Loss: 0.236 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2350982
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6740148067474365
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.780 Vali Acc: 0.261 Test Loss: 1.780 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 2.594365119934082
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.696 Vali Acc: 0.300 Test Loss: 1.696 Test Acc: 0.300
Validation loss decreased (-0.261093 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.942790985107422
Epoch: 3, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.581 Vali Acc: 0.406 Test Loss: 1.581 Test Acc: 0.406
Validation loss decreased (-0.299983 --> -0.405540).  Saving model ...
Epoch: 4 cost time: 2.561829090118408
Epoch: 4, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.453 Vali Acc: 0.544 Test Loss: 1.453 Test Acc: 0.544
Validation loss decreased (-0.405540 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 2.72066068649292
Epoch: 5, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.314 Vali Acc: 0.611 Test Loss: 1.314 Test Acc: 0.611
Validation loss decreased (-0.544430 --> -0.611098).  Saving model ...
Epoch: 6 cost time: 2.557065725326538
Epoch: 6, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.163 Vali Acc: 0.656 Test Loss: 1.163 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 2.719949245452881
Epoch: 7, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.010 Vali Acc: 0.689 Test Loss: 1.010 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688879).  Saving model ...
Epoch: 8 cost time: 2.799121141433716
Epoch: 8, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.895 Vali Acc: 0.717 Test Loss: 0.895 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716658).  Saving model ...
Epoch: 9 cost time: 2.628593683242798
Epoch: 9, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.812 Vali Acc: 0.711 Test Loss: 0.812 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8401637077331543
Epoch: 10, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.752 Vali Acc: 0.733 Test Loss: 0.752 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733326).  Saving model ...
Epoch: 11 cost time: 2.5401360988616943
Epoch: 11, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.686 Vali Acc: 0.728 Test Loss: 0.686 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8740944862365723
Epoch: 12, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.636 Vali Acc: 0.739 Test Loss: 0.636 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738883).  Saving model ...
Epoch: 13 cost time: 2.642261028289795
Epoch: 13, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.597 Vali Acc: 0.767 Test Loss: 0.597 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766661).  Saving model ...
Epoch: 14 cost time: 2.8334851264953613
Epoch: 14, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.548 Vali Acc: 0.761 Test Loss: 0.548 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5998423099517822
Epoch: 15, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.499 Vali Acc: 0.817 Test Loss: 0.499 Test Acc: 0.817
Validation loss decreased (-0.766661 --> -0.816662).  Saving model ...
Epoch: 16 cost time: 2.7518997192382812
Epoch: 16, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.437 Vali Acc: 0.811 Test Loss: 0.437 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6184539794921875
Epoch: 17, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6477909088134766
Epoch: 18, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.379 Vali Acc: 0.828 Test Loss: 0.379 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 2.8986780643463135
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 2.5708506107330322
Epoch: 20, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.382 Vali Acc: 0.833 Test Loss: 0.382 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8826286792755127
Epoch: 21, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 2.553271770477295
Epoch: 22, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.83026123046875
Epoch: 23, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6129865646362305
Epoch: 24, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.83610200881958
Epoch: 25, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.371 Vali Acc: 0.828 Test Loss: 0.371 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.7267777919769287
Epoch: 26, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.6596851348876953
Epoch: 27, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.993828296661377
Epoch: 28, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.6141512393951416
Epoch: 29, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.872201681137085
Epoch: 30, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 695558
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.954255104064941
Epoch: 1, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.770 Vali Acc: 0.161 Test Loss: 1.770 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 3.113612413406372
Epoch: 2, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.667 Vali Acc: 0.289 Test Loss: 1.667 Test Acc: 0.289
Validation loss decreased (-0.161093 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 3.403532028198242
Epoch: 3, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.539 Vali Acc: 0.400 Test Loss: 1.539 Test Acc: 0.400
Validation loss decreased (-0.288872 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 3.081495523452759
Epoch: 4, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.391 Vali Acc: 0.539 Test Loss: 1.391 Test Acc: 0.539
Validation loss decreased (-0.399985 --> -0.538875).  Saving model ...
Epoch: 5 cost time: 3.20880389213562
Epoch: 5, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.233 Vali Acc: 0.639 Test Loss: 1.233 Test Acc: 0.639
Validation loss decreased (-0.538875 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 3.197964906692505
Epoch: 6, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.079 Vali Acc: 0.672 Test Loss: 1.079 Test Acc: 0.672
Validation loss decreased (-0.638877 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 3.1640403270721436
Epoch: 7, Steps: 12 | Train Loss: 0.997 Vali Loss: 0.942 Vali Acc: 0.711 Test Loss: 0.942 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711102).  Saving model ...
Epoch: 8 cost time: 3.3585147857666016
Epoch: 8, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.835 Vali Acc: 0.733 Test Loss: 0.835 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733325).  Saving model ...
Epoch: 9 cost time: 3.1439268589019775
Epoch: 9, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772215).  Saving model ...
Epoch: 10 cost time: 3.3177011013031006
Epoch: 10, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.689 Vali Acc: 0.794 Test Loss: 0.689 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794438).  Saving model ...
Epoch: 11 cost time: 3.2384607791900635
Epoch: 11, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.628 Vali Acc: 0.778 Test Loss: 0.628 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.13435959815979
Epoch: 12, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.579 Vali Acc: 0.800 Test Loss: 0.579 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 2.9764232635498047
Epoch: 13, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.529 Vali Acc: 0.778 Test Loss: 0.529 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.723365068435669
Epoch: 14, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.512 Vali Acc: 0.800 Test Loss: 0.512 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 2.7215301990509033
Epoch: 15, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.467 Vali Acc: 0.828 Test Loss: 0.467 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 16 cost time: 3.2685887813568115
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827773).  Saving model ...
Epoch: 17 cost time: 3.2836267948150635
Epoch: 17, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.401 Vali Acc: 0.839 Test Loss: 0.401 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 3.044253349304199
Epoch: 18, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.377 Vali Acc: 0.844 Test Loss: 0.377 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 2.9250388145446777
Epoch: 19, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 2.9138193130493164
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.678715944290161
Epoch: 21, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.330 Vali Acc: 0.839 Test Loss: 0.330 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8353657722473145
Epoch: 22, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 2.8220512866973877
Epoch: 23, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.322 Vali Acc: 0.872 Test Loss: 0.322 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 2.954437494277954
Epoch: 24, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.303 Vali Acc: 0.844 Test Loss: 0.303 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9354734420776367
Epoch: 25, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7218666076660156
Epoch: 26, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.277 Vali Acc: 0.856 Test Loss: 0.277 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.6469268798828125
Epoch: 27, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 28 cost time: 2.669623613357544
Epoch: 28, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5269734859466553
Epoch: 29, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.254 Vali Acc: 0.861 Test Loss: 0.254 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.7102794647216797
Epoch: 30, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 2350982
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7232460975646973
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.780 Vali Acc: 0.261 Test Loss: 1.780 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 2.1710476875305176
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.696 Vali Acc: 0.300 Test Loss: 1.696 Test Acc: 0.300
Validation loss decreased (-0.261093 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.1933977603912354
Epoch: 3, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.580 Vali Acc: 0.406 Test Loss: 1.580 Test Acc: 0.406
Validation loss decreased (-0.299983 --> -0.405540).  Saving model ...
Epoch: 4 cost time: 2.129776954650879
Epoch: 4, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.452 Vali Acc: 0.544 Test Loss: 1.452 Test Acc: 0.544
Validation loss decreased (-0.405540 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 1.9030022621154785
Epoch: 5, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.313 Vali Acc: 0.611 Test Loss: 1.313 Test Acc: 0.611
Validation loss decreased (-0.544430 --> -0.611098).  Saving model ...
Epoch: 6 cost time: 2.236285448074341
Epoch: 6, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.162 Vali Acc: 0.656 Test Loss: 1.162 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 2.439324378967285
Epoch: 7, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.009 Vali Acc: 0.689 Test Loss: 1.009 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688879).  Saving model ...
Epoch: 8 cost time: 2.338524580001831
Epoch: 8, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.893 Vali Acc: 0.717 Test Loss: 0.893 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716658).  Saving model ...
Epoch: 9 cost time: 2.1837542057037354
Epoch: 9, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.810 Vali Acc: 0.711 Test Loss: 0.810 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.171171188354492
Epoch: 10, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.750 Vali Acc: 0.733 Test Loss: 0.750 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733326).  Saving model ...
Epoch: 11 cost time: 2.2683002948760986
Epoch: 11, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.684 Vali Acc: 0.728 Test Loss: 0.684 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6131765842437744
Epoch: 12, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.636 Vali Acc: 0.744 Test Loss: 0.636 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 2.293956995010376
Epoch: 13, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.596 Vali Acc: 0.767 Test Loss: 0.596 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 14 cost time: 2.2637743949890137
Epoch: 14, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.550 Vali Acc: 0.750 Test Loss: 0.550 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2117466926574707
Epoch: 15, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.516 Vali Acc: 0.800 Test Loss: 0.516 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 2.3635671138763428
Epoch: 16, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.458 Vali Acc: 0.794 Test Loss: 0.458 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.495405435562134
Epoch: 17, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.395948648452759
Epoch: 18, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 2.2212798595428467
Epoch: 19, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 2.0802066326141357
Epoch: 20, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1162192821502686
Epoch: 21, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.386 Vali Acc: 0.844 Test Loss: 0.386 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 22 cost time: 2.097107410430908
Epoch: 22, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5899441242218018
Epoch: 23, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.367 Vali Acc: 0.856 Test Loss: 0.367 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 24 cost time: 2.454819679260254
Epoch: 24, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.403245449066162
Epoch: 25, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.409 Vali Acc: 0.811 Test Loss: 0.409 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.680924654006958
Epoch: 26, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.53124737739563
Epoch: 27, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6615891456604004
Epoch: 28, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.382 Vali Acc: 0.817 Test Loss: 0.382 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.400777578353882
Epoch: 29, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.6500606536865234
Epoch: 30, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.397 Vali Acc: 0.828 Test Loss: 0.397 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 695558
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.943789005279541
Epoch: 1, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.769 Vali Acc: 0.156 Test Loss: 1.769 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 2.557793617248535
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.671 Vali Acc: 0.283 Test Loss: 1.671 Test Acc: 0.283
Validation loss decreased (-0.155538 --> -0.283317).  Saving model ...
Epoch: 3 cost time: 2.3920652866363525
Epoch: 3, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.550 Vali Acc: 0.394 Test Loss: 1.550 Test Acc: 0.394
Validation loss decreased (-0.283317 --> -0.394429).  Saving model ...
Epoch: 4 cost time: 2.28314471244812
Epoch: 4, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.410 Vali Acc: 0.528 Test Loss: 1.410 Test Acc: 0.528
Validation loss decreased (-0.394429 --> -0.527764).  Saving model ...
Epoch: 5 cost time: 2.5167043209075928
Epoch: 5, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.258 Vali Acc: 0.628 Test Loss: 1.258 Test Acc: 0.628
Validation loss decreased (-0.527764 --> -0.627765).  Saving model ...
Epoch: 6 cost time: 2.323265314102173
Epoch: 6, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.107 Vali Acc: 0.656 Test Loss: 1.107 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 2.580782651901245
Epoch: 7, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.969 Vali Acc: 0.706 Test Loss: 0.969 Test Acc: 0.706
Validation loss decreased (-0.655544 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 2.346663475036621
Epoch: 8, Steps: 12 | Train Loss: 0.888 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722214).  Saving model ...
Epoch: 9 cost time: 2.25944447517395
Epoch: 9, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
Validation loss decreased (-0.722214 --> -0.755548).  Saving model ...
Epoch: 10 cost time: 2.4464011192321777
Epoch: 10, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.711 Vali Acc: 0.772 Test Loss: 0.711 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 2.3681631088256836
Epoch: 11, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.563068151473999
Epoch: 12, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783327).  Saving model ...
Epoch: 13 cost time: 2.4552738666534424
Epoch: 13, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.550 Vali Acc: 0.772 Test Loss: 0.550 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.507563829421997
Epoch: 14, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 2.515920877456665
Epoch: 15, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.491 Vali Acc: 0.822 Test Loss: 0.491 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822217).  Saving model ...
Epoch: 16 cost time: 2.405954122543335
Epoch: 16, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.448 Vali Acc: 0.811 Test Loss: 0.448 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.560593843460083
Epoch: 17, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 2.312680244445801
Epoch: 18, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.395 Vali Acc: 0.844 Test Loss: 0.395 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 19 cost time: 2.6784896850585938
Epoch: 19, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 2.366105794906616
Epoch: 20, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.273743152618408
Epoch: 21, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.344 Vali Acc: 0.833 Test Loss: 0.344 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6130332946777344
Epoch: 22, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 23 cost time: 2.2028307914733887
Epoch: 23, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5533547401428223
Epoch: 24, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4192628860473633
Epoch: 25, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.340 Vali Acc: 0.856 Test Loss: 0.340 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1989779472351074
Epoch: 26, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.291 Vali Acc: 0.844 Test Loss: 0.291 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.748051881790161
Epoch: 27, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 28 cost time: 2.28721022605896
Epoch: 28, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.592481851577759
Epoch: 29, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4516093730926514
Epoch: 30, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2350982
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.031484603881836
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.782 Vali Acc: 0.261 Test Loss: 1.782 Test Acc: 0.261
Validation loss decreased (inf --> -0.261093).  Saving model ...
Epoch: 2 cost time: 2.0825319290161133
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.699 Vali Acc: 0.294 Test Loss: 1.699 Test Acc: 0.294
Validation loss decreased (-0.261093 --> -0.294427).  Saving model ...
Epoch: 3 cost time: 1.9226701259613037
Epoch: 3, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.584 Vali Acc: 0.406 Test Loss: 1.584 Test Acc: 0.406
Validation loss decreased (-0.294427 --> -0.405540).  Saving model ...
Epoch: 4 cost time: 2.053659677505493
Epoch: 4, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.456 Vali Acc: 0.544 Test Loss: 1.456 Test Acc: 0.544
Validation loss decreased (-0.405540 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 1.7222423553466797
Epoch: 5, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.319 Vali Acc: 0.611 Test Loss: 1.319 Test Acc: 0.611
Validation loss decreased (-0.544430 --> -0.611098).  Saving model ...
Epoch: 6 cost time: 1.7344653606414795
Epoch: 6, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.170 Vali Acc: 0.656 Test Loss: 1.170 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 2.0019819736480713
Epoch: 7, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.019 Vali Acc: 0.689 Test Loss: 1.019 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688879).  Saving model ...
Epoch: 8 cost time: 1.879995584487915
Epoch: 8, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.905 Vali Acc: 0.711 Test Loss: 0.905 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 1.873593807220459
Epoch: 9, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.823 Vali Acc: 0.700 Test Loss: 0.823 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9826829433441162
Epoch: 10, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 1.6967356204986572
Epoch: 11, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.705 Vali Acc: 0.722 Test Loss: 0.705 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722215).  Saving model ...
Epoch: 12 cost time: 1.9970693588256836
Epoch: 12, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.662 Vali Acc: 0.733 Test Loss: 0.662 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733327).  Saving model ...
Epoch: 13 cost time: 1.7081928253173828
Epoch: 13, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.626 Vali Acc: 0.744 Test Loss: 0.626 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 1.8950495719909668
Epoch: 14, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.591 Vali Acc: 0.744 Test Loss: 0.591 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744439).  Saving model ...
Epoch: 15 cost time: 1.964728832244873
Epoch: 15, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.560 Vali Acc: 0.772 Test Loss: 0.560 Test Acc: 0.772
Validation loss decreased (-0.744439 --> -0.772217).  Saving model ...
Epoch: 16 cost time: 1.862086534500122
Epoch: 16, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.525 Vali Acc: 0.772 Test Loss: 0.525 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 17 cost time: 1.641028642654419
Epoch: 17, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.503 Vali Acc: 0.772 Test Loss: 0.503 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 18 cost time: 1.9781405925750732
Epoch: 18, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.470 Vali Acc: 0.789 Test Loss: 0.470 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 19 cost time: 1.7989022731781006
Epoch: 19, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.443 Vali Acc: 0.806 Test Loss: 0.443 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 20 cost time: 1.9313771724700928
Epoch: 20, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.430 Vali Acc: 0.800 Test Loss: 0.430 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0514416694641113
Epoch: 21, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.405 Vali Acc: 0.817 Test Loss: 0.405 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 22 cost time: 1.763920545578003
Epoch: 22, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 23 cost time: 2.0446600914001465
Epoch: 23, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.375 Vali Acc: 0.828 Test Loss: 0.375 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 1.7576515674591064
Epoch: 24, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.364 Vali Acc: 0.844 Test Loss: 0.364 Test Acc: 0.844
Validation loss decreased (-0.827774 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.8346352577209473
Epoch: 25, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.056417465209961
Epoch: 26, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 1.8357713222503662
Epoch: 27, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 28 cost time: 1.6567528247833252
Epoch: 28, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.357 Vali Acc: 0.844 Test Loss: 0.357 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.207348108291626
Epoch: 29, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 1.9094104766845703
Epoch: 30, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.304 Vali Acc: 0.878 Test Loss: 0.304 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 695558
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1808764934539795
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.791 Vali Acc: 0.178 Test Loss: 1.791 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 3.0834031105041504
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.690 Vali Acc: 0.244 Test Loss: 1.690 Test Acc: 0.244
Validation loss decreased (-0.177760 --> -0.244428).  Saving model ...
Epoch: 3 cost time: 3.0466511249542236
Epoch: 3, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.566 Vali Acc: 0.422 Test Loss: 1.566 Test Acc: 0.422
Validation loss decreased (-0.244428 --> -0.422207).  Saving model ...
Epoch: 4 cost time: 3.519439935684204
Epoch: 4, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.427 Vali Acc: 0.589 Test Loss: 1.427 Test Acc: 0.589
Validation loss decreased (-0.422207 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 3.7348968982696533
Epoch: 5, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.281 Vali Acc: 0.644 Test Loss: 1.281 Test Acc: 0.644
Validation loss decreased (-0.588875 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 3.7322986125946045
Epoch: 6, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.123 Vali Acc: 0.678 Test Loss: 1.123 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 3.4394097328186035
Epoch: 7, Steps: 12 | Train Loss: 1.055 Vali Loss: 0.991 Vali Acc: 0.706 Test Loss: 0.991 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 3.4048495292663574
Epoch: 8, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.881 Vali Acc: 0.694 Test Loss: 0.881 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2820942401885986
Epoch: 9, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.798 Vali Acc: 0.700 Test Loss: 0.798 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5545713901519775
Epoch: 10, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 3.7414305210113525
Epoch: 11, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.677 Vali Acc: 0.744 Test Loss: 0.677 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 3.557217597961426
Epoch: 12, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.622 Vali Acc: 0.744 Test Loss: 0.622 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 3.414926290512085
Epoch: 13, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.576 Vali Acc: 0.778 Test Loss: 0.576 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 14 cost time: 3.2980895042419434
Epoch: 14, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 3.33259654045105
Epoch: 15, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.478 Vali Acc: 0.789 Test Loss: 0.478 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 16 cost time: 3.656503677368164
Epoch: 16, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.436 Vali Acc: 0.783 Test Loss: 0.436 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7416484355926514
Epoch: 17, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.403 Vali Acc: 0.794 Test Loss: 0.403 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 18 cost time: 3.6463184356689453
Epoch: 18, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 19 cost time: 3.6218934059143066
Epoch: 19, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.368 Vali Acc: 0.794 Test Loss: 0.368 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.448974132537842
Epoch: 20, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.352 Vali Acc: 0.806 Test Loss: 0.352 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4143550395965576
Epoch: 21, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.348 Vali Acc: 0.817 Test Loss: 0.348 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4962658882141113
Epoch: 22, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 23 cost time: 3.65740966796875
Epoch: 23, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.328 Vali Acc: 0.811 Test Loss: 0.328 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.7147607803344727
Epoch: 24, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.5416572093963623
Epoch: 25, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.3601977825164795
Epoch: 26, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.305 Vali Acc: 0.844 Test Loss: 0.305 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 3.4135055541992188
Epoch: 27, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.348 Vali Acc: 0.794 Test Loss: 0.348 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.528886556625366
Epoch: 28, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 3.6433398723602295
Epoch: 29, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.296 Vali Acc: 0.822 Test Loss: 0.296 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3835971355438232
Epoch: 30, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.297 Vali Acc: 0.833 Test Loss: 0.297 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 1178758
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.60260272026062
Epoch: 1, Steps: 12 | Train Loss: 1.947 Vali Loss: 1.863 Vali Acc: 0.228 Test Loss: 1.863 Test Acc: 0.228
Validation loss decreased (inf --> -0.227759).  Saving model ...
Epoch: 2 cost time: 2.4922187328338623
Epoch: 2, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.775 Vali Acc: 0.228 Test Loss: 1.775 Test Acc: 0.228
Validation loss decreased (-0.227759 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 2.7811193466186523
Epoch: 3, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.667 Vali Acc: 0.289 Test Loss: 1.667 Test Acc: 0.289
Validation loss decreased (-0.227760 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 2.5272254943847656
Epoch: 4, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.541 Vali Acc: 0.400 Test Loss: 1.541 Test Acc: 0.400
Validation loss decreased (-0.288872 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 2.6979899406433105
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.400 Vali Acc: 0.567 Test Loss: 1.400 Test Acc: 0.567
Validation loss decreased (-0.399985 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 2.497349739074707
Epoch: 6, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.242 Vali Acc: 0.644 Test Loss: 1.242 Test Acc: 0.644
Validation loss decreased (-0.566653 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 2.536813497543335
Epoch: 7, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 2.6032211780548096
Epoch: 8, Steps: 12 | Train Loss: 1.021 Vali Loss: 0.946 Vali Acc: 0.689 Test Loss: 0.946 Test Acc: 0.689
Validation loss decreased (-0.649989 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 2.508944034576416
Epoch: 9, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.845 Vali Acc: 0.694 Test Loss: 0.845 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 2.7392592430114746
Epoch: 10, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.773 Vali Acc: 0.711 Test Loss: 0.773 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 2.4961657524108887
Epoch: 11, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.718 Vali Acc: 0.733 Test Loss: 0.718 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 2.7517147064208984
Epoch: 12, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.672 Vali Acc: 0.728 Test Loss: 0.672 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4790306091308594
Epoch: 13, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 2.7331504821777344
Epoch: 14, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5207736492156982
Epoch: 15, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783328).  Saving model ...
Epoch: 16 cost time: 2.7420461177825928
Epoch: 16, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.517 Vali Acc: 0.806 Test Loss: 0.517 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805550).  Saving model ...
Epoch: 17 cost time: 2.351898193359375
Epoch: 17, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.484 Vali Acc: 0.772 Test Loss: 0.484 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.440840721130371
Epoch: 18, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.459 Vali Acc: 0.811 Test Loss: 0.459 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 2.296492099761963
Epoch: 19, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.444 Vali Acc: 0.811 Test Loss: 0.444 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 20 cost time: 2.2869784832000732
Epoch: 20, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.420 Vali Acc: 0.811 Test Loss: 0.420 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 21 cost time: 2.531790018081665
Epoch: 21, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.394 Vali Acc: 0.817 Test Loss: 0.394 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 22 cost time: 2.3908305168151855
Epoch: 22, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 23 cost time: 2.560354709625244
Epoch: 23, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 24 cost time: 2.2836625576019287
Epoch: 24, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 2.536802291870117
Epoch: 25, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 2.197767734527588
Epoch: 26, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.539134979248047
Epoch: 27, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2480337619781494
Epoch: 28, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 2.3796660900115967
Epoch: 29, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.316 Vali Acc: 0.822 Test Loss: 0.316 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.320655584335327
Epoch: 30, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.310 Vali Acc: 0.833 Test Loss: 0.310 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 350982
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.30622124671936
Epoch: 1, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.791 Vali Acc: 0.178 Test Loss: 1.791 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 2.620927333831787
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.690 Vali Acc: 0.244 Test Loss: 1.690 Test Acc: 0.244
Validation loss decreased (-0.177760 --> -0.244428).  Saving model ...
Epoch: 3 cost time: 2.3587913513183594
Epoch: 3, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.566 Vali Acc: 0.422 Test Loss: 1.566 Test Acc: 0.422
Validation loss decreased (-0.244428 --> -0.422207).  Saving model ...
Epoch: 4 cost time: 2.7474353313446045
Epoch: 4, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.427 Vali Acc: 0.589 Test Loss: 1.427 Test Acc: 0.589
Validation loss decreased (-0.422207 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 3.0298209190368652
Epoch: 5, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.281 Vali Acc: 0.644 Test Loss: 1.281 Test Acc: 0.644
Validation loss decreased (-0.588875 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 2.788632392883301
Epoch: 6, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.123 Vali Acc: 0.678 Test Loss: 1.123 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677767).  Saving model ...
Epoch: 7 cost time: 2.976175308227539
Epoch: 7, Steps: 12 | Train Loss: 1.055 Vali Loss: 0.991 Vali Acc: 0.706 Test Loss: 0.991 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705546).  Saving model ...
Epoch: 8 cost time: 2.818115472793579
Epoch: 8, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.881 Vali Acc: 0.694 Test Loss: 0.881 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.698835611343384
Epoch: 9, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.798 Vali Acc: 0.700 Test Loss: 0.798 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.023275375366211
Epoch: 10, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738882).  Saving model ...
Epoch: 11 cost time: 2.736276388168335
Epoch: 11, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.677 Vali Acc: 0.744 Test Loss: 0.677 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 3.0815560817718506
Epoch: 12, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.622 Vali Acc: 0.744 Test Loss: 0.622 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 2.781033754348755
Epoch: 13, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.576 Vali Acc: 0.778 Test Loss: 0.576 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 14 cost time: 2.900749683380127
Epoch: 14, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 15 cost time: 2.821044683456421
Epoch: 15, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.478 Vali Acc: 0.789 Test Loss: 0.478 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 16 cost time: 2.7982683181762695
Epoch: 16, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.436 Vali Acc: 0.783 Test Loss: 0.436 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.160134792327881
Epoch: 17, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.403 Vali Acc: 0.794 Test Loss: 0.403 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 18 cost time: 2.789623975753784
Epoch: 18, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.794440 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 3.1953988075256348
Epoch: 19, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.371 Vali Acc: 0.789 Test Loss: 0.371 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.764204740524292
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.358 Vali Acc: 0.800 Test Loss: 0.358 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8400497436523438
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.355 Vali Acc: 0.817 Test Loss: 0.355 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.675562858581543
Epoch: 22, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.348 Vali Acc: 0.833 Test Loss: 0.348 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 23 cost time: 2.496622085571289
Epoch: 23, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.341 Vali Acc: 0.811 Test Loss: 0.341 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5375654697418213
Epoch: 24, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.321 Vali Acc: 0.822 Test Loss: 0.321 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.550900459289551
Epoch: 25, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 26 cost time: 2.8213679790496826
Epoch: 26, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.325 Vali Acc: 0.833 Test Loss: 0.325 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8048861026763916
Epoch: 27, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.321 Vali Acc: 0.811 Test Loss: 0.321 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.887634038925171
Epoch: 28, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.301 Vali Acc: 0.822 Test Loss: 0.301 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.0462899208068848
Epoch: 29, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.287 Vali Acc: 0.833 Test Loss: 0.287 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9920835494995117
Epoch: 30, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.311 Vali Acc: 0.833 Test Loss: 0.311 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 1178758
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9325966835021973
Epoch: 1, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.863 Vali Acc: 0.228 Test Loss: 1.863 Test Acc: 0.228
Validation loss decreased (inf --> -0.227759).  Saving model ...
Epoch: 2 cost time: 2.1891794204711914
Epoch: 2, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.775 Vali Acc: 0.228 Test Loss: 1.775 Test Acc: 0.228
Validation loss decreased (-0.227759 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 2.4378750324249268
Epoch: 3, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.667 Vali Acc: 0.289 Test Loss: 1.667 Test Acc: 0.289
Validation loss decreased (-0.227760 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 2.1926069259643555
Epoch: 4, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.541 Vali Acc: 0.400 Test Loss: 1.541 Test Acc: 0.400
Validation loss decreased (-0.288872 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 2.1264965534210205
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.400 Vali Acc: 0.567 Test Loss: 1.400 Test Acc: 0.567
Validation loss decreased (-0.399985 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 2.318072557449341
Epoch: 6, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.241 Vali Acc: 0.644 Test Loss: 1.241 Test Acc: 0.644
Validation loss decreased (-0.566653 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 2.4850621223449707
Epoch: 7, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.080 Vali Acc: 0.650 Test Loss: 1.080 Test Acc: 0.650
Validation loss decreased (-0.644432 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 2.2224292755126953
Epoch: 8, Steps: 12 | Train Loss: 1.021 Vali Loss: 0.946 Vali Acc: 0.689 Test Loss: 0.946 Test Acc: 0.689
Validation loss decreased (-0.649989 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 2.2470405101776123
Epoch: 9, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.845 Vali Acc: 0.694 Test Loss: 0.845 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 2.4788286685943604
Epoch: 10, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.773 Vali Acc: 0.711 Test Loss: 0.773 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 2.29191255569458
Epoch: 11, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.718 Vali Acc: 0.733 Test Loss: 0.718 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 1.9737462997436523
Epoch: 12, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.672 Vali Acc: 0.728 Test Loss: 0.672 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.312293767929077
Epoch: 13, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.629 Vali Acc: 0.756 Test Loss: 0.629 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 2.558495044708252
Epoch: 14, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.348253011703491
Epoch: 15, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783328).  Saving model ...
Epoch: 16 cost time: 2.2291922569274902
Epoch: 16, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.517 Vali Acc: 0.806 Test Loss: 0.517 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805550).  Saving model ...
Epoch: 17 cost time: 2.256042718887329
Epoch: 17, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.484 Vali Acc: 0.772 Test Loss: 0.484 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4926517009735107
Epoch: 18, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.459 Vali Acc: 0.811 Test Loss: 0.459 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811107).  Saving model ...
Epoch: 19 cost time: 2.42964506149292
Epoch: 19, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.445 Vali Acc: 0.817 Test Loss: 0.445 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 2.256643295288086
Epoch: 20, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.420 Vali Acc: 0.817 Test Loss: 0.420 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 21 cost time: 2.292224645614624
Epoch: 21, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 22 cost time: 2.145446538925171
Epoch: 22, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 23 cost time: 2.077810525894165
Epoch: 23, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 24 cost time: 2.074476480484009
Epoch: 24, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.335 Vali Acc: 0.844 Test Loss: 0.335 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 2.1205148696899414
Epoch: 25, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 2.253281593322754
Epoch: 26, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.583361864089966
Epoch: 27, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.316 Vali Acc: 0.839 Test Loss: 0.316 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2013120651245117
Epoch: 28, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 2.1328823566436768
Epoch: 29, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.314 Vali Acc: 0.833 Test Loss: 0.314 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3907933235168457
Epoch: 30, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.306 Vali Acc: 0.839 Test Loss: 0.306 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 350982
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5751330852508545
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.797 Vali Acc: 0.178 Test Loss: 1.797 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 1.99591064453125
Epoch: 2, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.703 Vali Acc: 0.233 Test Loss: 1.703 Test Acc: 0.233
Validation loss decreased (-0.177760 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 1.8020234107971191
Epoch: 3, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.586 Vali Acc: 0.406 Test Loss: 1.586 Test Acc: 0.406
Validation loss decreased (-0.233316 --> -0.405540).  Saving model ...
Epoch: 4 cost time: 1.8985788822174072
Epoch: 4, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.457 Vali Acc: 0.561 Test Loss: 1.457 Test Acc: 0.561
Validation loss decreased (-0.405540 --> -0.561097).  Saving model ...
Epoch: 5 cost time: 1.8916456699371338
Epoch: 5, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.319 Vali Acc: 0.633 Test Loss: 1.319 Test Acc: 0.633
Validation loss decreased (-0.561097 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 1.9956340789794922
Epoch: 6, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.164 Vali Acc: 0.667 Test Loss: 1.164 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 1.7171800136566162
Epoch: 7, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.030 Vali Acc: 0.683 Test Loss: 1.030 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 1.8078887462615967
Epoch: 8, Steps: 12 | Train Loss: 0.968 Vali Loss: 0.916 Vali Acc: 0.683 Test Loss: 0.916 Test Acc: 0.683
Validation loss decreased (-0.683323 --> -0.683324).  Saving model ...
Epoch: 9 cost time: 1.835355520248413
Epoch: 9, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.829 Vali Acc: 0.672 Test Loss: 0.829 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7480823993682861
Epoch: 10, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
Validation loss decreased (-0.683324 --> -0.727770).  Saving model ...
Epoch: 11 cost time: 2.0247950553894043
Epoch: 11, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.707 Vali Acc: 0.744 Test Loss: 0.707 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 1.8335587978363037
Epoch: 12, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.643 Vali Acc: 0.744 Test Loss: 0.643 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 2.066556930541992
Epoch: 13, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.596 Vali Acc: 0.761 Test Loss: 0.596 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 14 cost time: 1.7991821765899658
Epoch: 14, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783328).  Saving model ...
Epoch: 15 cost time: 1.8993043899536133
Epoch: 15, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.498 Vali Acc: 0.778 Test Loss: 0.498 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0316123962402344
Epoch: 16, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.456 Vali Acc: 0.767 Test Loss: 0.456 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.143078327178955
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.423 Vali Acc: 0.783 Test Loss: 0.423 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 18 cost time: 1.8893811702728271
Epoch: 18, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.403 Vali Acc: 0.817 Test Loss: 0.403 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 19 cost time: 2.039583444595337
Epoch: 19, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.396 Vali Acc: 0.783 Test Loss: 0.396 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.385587215423584
Epoch: 20, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.382 Vali Acc: 0.806 Test Loss: 0.382 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5289745330810547
Epoch: 21, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.371 Vali Acc: 0.794 Test Loss: 0.371 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4459805488586426
Epoch: 22, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822219).  Saving model ...
Epoch: 23 cost time: 1.453676700592041
Epoch: 23, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.364 Vali Acc: 0.789 Test Loss: 0.364 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0284414291381836
Epoch: 24, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.354 Vali Acc: 0.800 Test Loss: 0.354 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9447953701019287
Epoch: 25, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.349 Vali Acc: 0.817 Test Loss: 0.349 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.067681312561035
Epoch: 26, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.325 Vali Acc: 0.794 Test Loss: 0.325 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.086728811264038
Epoch: 27, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.330 Vali Acc: 0.822 Test Loss: 0.330 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 28 cost time: 2.283018112182617
Epoch: 28, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.333 Vali Acc: 0.822 Test Loss: 0.333 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9875049591064453
Epoch: 29, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.314 Vali Acc: 0.817 Test Loss: 0.314 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.214160203933716
Epoch: 30, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.328 Vali Acc: 0.833 Test Loss: 0.328 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 1178758
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5200772285461426
Epoch: 1, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.868 Vali Acc: 0.228 Test Loss: 1.868 Test Acc: 0.228
Validation loss decreased (inf --> -0.227759).  Saving model ...
Epoch: 2 cost time: 1.698124647140503
Epoch: 2, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.785 Vali Acc: 0.228 Test Loss: 1.785 Test Acc: 0.228
Validation loss decreased (-0.227759 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 1.923818826675415
Epoch: 3, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.681 Vali Acc: 0.272 Test Loss: 1.681 Test Acc: 0.272
Validation loss decreased (-0.227760 --> -0.272205).  Saving model ...
Epoch: 4 cost time: 1.61899733543396
Epoch: 4, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.558 Vali Acc: 0.400 Test Loss: 1.558 Test Acc: 0.400
Validation loss decreased (-0.272205 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.9165022373199463
Epoch: 5, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.418 Vali Acc: 0.561 Test Loss: 1.418 Test Acc: 0.561
Validation loss decreased (-0.399984 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 1.66926908493042
Epoch: 6, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.260 Vali Acc: 0.622 Test Loss: 1.260 Test Acc: 0.622
Validation loss decreased (-0.561097 --> -0.622210).  Saving model ...
Epoch: 7 cost time: 1.8650870323181152
Epoch: 7, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.098 Vali Acc: 0.644 Test Loss: 1.098 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644433).  Saving model ...
Epoch: 8 cost time: 1.6457984447479248
Epoch: 8, Steps: 12 | Train Loss: 1.020 Vali Loss: 0.963 Vali Acc: 0.678 Test Loss: 0.963 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 1.914642333984375
Epoch: 9, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.864 Vali Acc: 0.678 Test Loss: 0.864 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677769).  Saving model ...
Epoch: 10 cost time: 1.667654275894165
Epoch: 10, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.793 Vali Acc: 0.700 Test Loss: 0.793 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 11 cost time: 1.944793701171875
Epoch: 11, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.738 Vali Acc: 0.722 Test Loss: 0.738 Test Acc: 0.722
Validation loss decreased (-0.699992 --> -0.722215).  Saving model ...
Epoch: 12 cost time: 1.59049654006958
Epoch: 12, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.692 Vali Acc: 0.733 Test Loss: 0.692 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733326).  Saving model ...
Epoch: 13 cost time: 1.8845527172088623
Epoch: 13, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.648 Vali Acc: 0.744 Test Loss: 0.648 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 1.6701319217681885
Epoch: 14, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.609 Vali Acc: 0.739 Test Loss: 0.609 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6783437728881836
Epoch: 15, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.570 Vali Acc: 0.778 Test Loss: 0.570 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 16 cost time: 1.527069091796875
Epoch: 16, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799995).  Saving model ...
Epoch: 17 cost time: 1.555983543395996
Epoch: 17, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.504 Vali Acc: 0.761 Test Loss: 0.504 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5853767395019531
Epoch: 18, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.478 Vali Acc: 0.806 Test Loss: 0.478 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 19 cost time: 1.6922667026519775
Epoch: 19, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.464 Vali Acc: 0.817 Test Loss: 0.464 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 1.8055920600891113
Epoch: 20, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.438 Vali Acc: 0.811 Test Loss: 0.438 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9235079288482666
Epoch: 21, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.412 Vali Acc: 0.817 Test Loss: 0.412 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 22 cost time: 1.7185044288635254
Epoch: 22, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 23 cost time: 1.834334135055542
Epoch: 23, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.394 Vali Acc: 0.833 Test Loss: 0.394 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 1.8058931827545166
Epoch: 24, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6004126071929932
Epoch: 25, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.379 Vali Acc: 0.817 Test Loss: 0.379 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6871793270111084
Epoch: 26, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.789945363998413
Epoch: 27, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 1.6316592693328857
Epoch: 28, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.348 Vali Acc: 0.817 Test Loss: 0.348 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.591392993927002
Epoch: 29, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8148517608642578
Epoch: 30, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.346 Vali Acc: 0.817 Test Loss: 0.346 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 350982
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.782839775085449
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.868 Vali Acc: 0.139 Test Loss: 1.868 Test Acc: 0.139
Validation loss decreased (inf --> -0.138870).  Saving model ...
Epoch: 2 cost time: 2.9926717281341553
Epoch: 2, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.785 Vali Acc: 0.156 Test Loss: 1.785 Test Acc: 0.156
Validation loss decreased (-0.138870 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 2.934708595275879
Epoch: 3, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.680 Vali Acc: 0.289 Test Loss: 1.680 Test Acc: 0.289
Validation loss decreased (-0.155538 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 2.929922342300415
Epoch: 4, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
Validation loss decreased (-0.288872 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 2.6511027812957764
Epoch: 5, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.433 Vali Acc: 0.589 Test Loss: 1.433 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 2.8655645847320557
Epoch: 6, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.285 Vali Acc: 0.628 Test Loss: 1.285 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 2.6469838619232178
Epoch: 7, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 2.671663999557495
Epoch: 8, Steps: 12 | Train Loss: 0.990 Vali Loss: 0.991 Vali Acc: 0.683 Test Loss: 0.991 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683323).  Saving model ...
Epoch: 9 cost time: 2.679849624633789
Epoch: 9, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.872 Vali Acc: 0.694 Test Loss: 0.872 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 2.773698329925537
Epoch: 10, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.784 Vali Acc: 0.689 Test Loss: 0.784 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7324602603912354
Epoch: 11, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.714 Vali Acc: 0.733 Test Loss: 0.714 Test Acc: 0.733
Validation loss decreased (-0.694436 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 2.8263065814971924
Epoch: 12, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.655 Vali Acc: 0.744 Test Loss: 0.655 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 2.8611648082733154
Epoch: 13, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.609 Vali Acc: 0.744 Test Loss: 0.609 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 2.3806064128875732
Epoch: 14, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.565 Vali Acc: 0.767 Test Loss: 0.565 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 15 cost time: 2.4013500213623047
Epoch: 15, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.526 Vali Acc: 0.794 Test Loss: 0.526 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 16 cost time: 2.4530282020568848
Epoch: 16, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.489 Vali Acc: 0.778 Test Loss: 0.489 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.521998882293701
Epoch: 17, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.466 Vali Acc: 0.783 Test Loss: 0.466 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.824937343597412
Epoch: 18, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.438 Vali Acc: 0.839 Test Loss: 0.438 Test Acc: 0.839
Validation loss decreased (-0.794439 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 2.8398895263671875
Epoch: 19, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.416 Vali Acc: 0.794 Test Loss: 0.416 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.656088352203369
Epoch: 20, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.400 Vali Acc: 0.800 Test Loss: 0.400 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0782642364501953
Epoch: 21, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.611290454864502
Epoch: 22, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.385 Vali Acc: 0.794 Test Loss: 0.385 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8492674827575684
Epoch: 23, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 24 cost time: 3.044213056564331
Epoch: 24, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6324806213378906
Epoch: 25, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.942699909210205
Epoch: 26, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.364 Vali Acc: 0.828 Test Loss: 0.364 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7487642765045166
Epoch: 27, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 28 cost time: 2.6496806144714355
Epoch: 28, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0460851192474365
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.950453519821167
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 592646
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.842334270477295
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.762 Vali Acc: 0.228 Test Loss: 1.762 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 2.1609392166137695
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.688 Vali Acc: 0.300 Test Loss: 1.688 Test Acc: 0.300
Validation loss decreased (-0.227760 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.3975982666015625
Epoch: 3, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.594 Vali Acc: 0.333 Test Loss: 1.594 Test Acc: 0.333
Validation loss decreased (-0.299983 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 2.4028267860412598
Epoch: 4, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.488 Vali Acc: 0.506 Test Loss: 1.488 Test Acc: 0.506
Validation loss decreased (-0.333317 --> -0.505541).  Saving model ...
Epoch: 5 cost time: 2.6409215927124023
Epoch: 5, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.368 Vali Acc: 0.572 Test Loss: 1.368 Test Acc: 0.572
Validation loss decreased (-0.505541 --> -0.572209).  Saving model ...
Epoch: 6 cost time: 2.3157012462615967
Epoch: 6, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.243 Vali Acc: 0.622 Test Loss: 1.243 Test Acc: 0.622
Validation loss decreased (-0.572209 --> -0.622210).  Saving model ...
Epoch: 7 cost time: 2.5733320713043213
Epoch: 7, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.117 Vali Acc: 0.656 Test Loss: 1.117 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655544).  Saving model ...
Epoch: 8 cost time: 2.4471640586853027
Epoch: 8, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.999 Vali Acc: 0.672 Test Loss: 0.999 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672212).  Saving model ...
Epoch: 9 cost time: 2.5492568016052246
Epoch: 9, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.894 Vali Acc: 0.700 Test Loss: 0.894 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 2.4131929874420166
Epoch: 10, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.813 Vali Acc: 0.722 Test Loss: 0.813 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 2.478022813796997
Epoch: 11, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.742 Vali Acc: 0.706 Test Loss: 0.742 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7284185886383057
Epoch: 12, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 13 cost time: 2.4666271209716797
Epoch: 13, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
Validation loss decreased (-0.722215 --> -0.761105).  Saving model ...
Epoch: 14 cost time: 2.729268789291382
Epoch: 14, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4615135192871094
Epoch: 15, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.545 Vali Acc: 0.767 Test Loss: 0.545 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 16 cost time: 2.468080997467041
Epoch: 16, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.507 Vali Acc: 0.767 Test Loss: 0.507 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766662).  Saving model ...
Epoch: 17 cost time: 2.7095417976379395
Epoch: 17, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.480 Vali Acc: 0.811 Test Loss: 0.480 Test Acc: 0.811
Validation loss decreased (-0.766662 --> -0.811106).  Saving model ...
Epoch: 18 cost time: 2.4860565662384033
Epoch: 18, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.450 Vali Acc: 0.778 Test Loss: 0.450 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.330944299697876
Epoch: 19, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.430 Vali Acc: 0.800 Test Loss: 0.430 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.228167772293091
Epoch: 20, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.408 Vali Acc: 0.794 Test Loss: 0.408 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.248967409133911
Epoch: 21, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 2.3132855892181396
Epoch: 22, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.384 Vali Acc: 0.794 Test Loss: 0.384 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.434905529022217
Epoch: 23, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.366 Vali Acc: 0.811 Test Loss: 0.366 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4670016765594482
Epoch: 24, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.361 Vali Acc: 0.822 Test Loss: 0.361 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 25 cost time: 2.659222364425659
Epoch: 25, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6906111240386963
Epoch: 26, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.340 Vali Acc: 0.811 Test Loss: 0.340 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.388695240020752
Epoch: 27, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 2.363243818283081
Epoch: 28, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.325 Vali Acc: 0.817 Test Loss: 0.325 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.436438798904419
Epoch: 29, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 2.519732713699341
Epoch: 30, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 178694
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.553189754486084
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.868 Vali Acc: 0.139 Test Loss: 1.868 Test Acc: 0.139
Validation loss decreased (inf --> -0.138870).  Saving model ...
Epoch: 2 cost time: 2.633718490600586
Epoch: 2, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.785 Vali Acc: 0.156 Test Loss: 1.785 Test Acc: 0.156
Validation loss decreased (-0.138870 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 2.3655402660369873
Epoch: 3, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.680 Vali Acc: 0.289 Test Loss: 1.680 Test Acc: 0.289
Validation loss decreased (-0.155538 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 2.3710274696350098
Epoch: 4, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
Validation loss decreased (-0.288872 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 2.4982120990753174
Epoch: 5, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.433 Vali Acc: 0.589 Test Loss: 1.433 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 2.646231174468994
Epoch: 6, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.285 Vali Acc: 0.628 Test Loss: 1.285 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 2.3898372650146484
Epoch: 7, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 2.277212142944336
Epoch: 8, Steps: 12 | Train Loss: 0.990 Vali Loss: 0.991 Vali Acc: 0.683 Test Loss: 0.991 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683323).  Saving model ...
Epoch: 9 cost time: 2.4006264209747314
Epoch: 9, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.872 Vali Acc: 0.694 Test Loss: 0.872 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 2.581199884414673
Epoch: 10, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.783 Vali Acc: 0.689 Test Loss: 0.783 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.421832799911499
Epoch: 11, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.714 Vali Acc: 0.733 Test Loss: 0.714 Test Acc: 0.733
Validation loss decreased (-0.694436 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 2.243717670440674
Epoch: 12, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.655 Vali Acc: 0.744 Test Loss: 0.655 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 13 cost time: 2.323819875717163
Epoch: 13, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.609 Vali Acc: 0.744 Test Loss: 0.609 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 2.4820361137390137
Epoch: 14, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 15 cost time: 2.512615442276001
Epoch: 15, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.524 Vali Acc: 0.794 Test Loss: 0.524 Test Acc: 0.794
Validation loss decreased (-0.761105 --> -0.794439).  Saving model ...
Epoch: 16 cost time: 2.3312578201293945
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.487 Vali Acc: 0.778 Test Loss: 0.487 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.300358772277832
Epoch: 17, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3475356101989746
Epoch: 18, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.436 Vali Acc: 0.839 Test Loss: 0.436 Test Acc: 0.839
Validation loss decreased (-0.794439 --> -0.838885).  Saving model ...
Epoch: 19 cost time: 2.5958123207092285
Epoch: 19, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.414 Vali Acc: 0.783 Test Loss: 0.414 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.170851945877075
Epoch: 20, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.399 Vali Acc: 0.806 Test Loss: 0.399 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0978589057922363
Epoch: 21, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.384 Vali Acc: 0.828 Test Loss: 0.384 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.159579277038574
Epoch: 22, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.416991710662842
Epoch: 23, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.380 Vali Acc: 0.822 Test Loss: 0.380 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7793474197387695
Epoch: 24, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0162668228149414
Epoch: 25, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.360 Vali Acc: 0.817 Test Loss: 0.360 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.124011516571045
Epoch: 26, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.349 Vali Acc: 0.828 Test Loss: 0.349 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.0784151554107666
Epoch: 27, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.337 Vali Acc: 0.833 Test Loss: 0.337 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.0170183181762695
Epoch: 28, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 2.1977179050445557
Epoch: 29, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.384 Vali Acc: 0.844 Test Loss: 0.384 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5281624794006348
Epoch: 30, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.337 Vali Acc: 0.861 Test Loss: 0.337 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 592646
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5634946823120117
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.762 Vali Acc: 0.228 Test Loss: 1.762 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 1.9645538330078125
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.688 Vali Acc: 0.300 Test Loss: 1.688 Test Acc: 0.300
Validation loss decreased (-0.227760 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.008450508117676
Epoch: 3, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.594 Vali Acc: 0.333 Test Loss: 1.594 Test Acc: 0.333
Validation loss decreased (-0.299983 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 2.0678489208221436
Epoch: 4, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.488 Vali Acc: 0.506 Test Loss: 1.488 Test Acc: 0.506
Validation loss decreased (-0.333317 --> -0.505541).  Saving model ...
Epoch: 5 cost time: 2.263427972793579
Epoch: 5, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.368 Vali Acc: 0.572 Test Loss: 1.368 Test Acc: 0.572
Validation loss decreased (-0.505541 --> -0.572209).  Saving model ...
Epoch: 6 cost time: 2.0877552032470703
Epoch: 6, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.243 Vali Acc: 0.622 Test Loss: 1.243 Test Acc: 0.622
Validation loss decreased (-0.572209 --> -0.622210).  Saving model ...
Epoch: 7 cost time: 1.6531777381896973
Epoch: 7, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.117 Vali Acc: 0.656 Test Loss: 1.117 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655544).  Saving model ...
Epoch: 8 cost time: 2.3545329570770264
Epoch: 8, Steps: 12 | Train Loss: 1.004 Vali Loss: 0.999 Vali Acc: 0.672 Test Loss: 0.999 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672212).  Saving model ...
Epoch: 9 cost time: 2.08060884475708
Epoch: 9, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.894 Vali Acc: 0.700 Test Loss: 0.894 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 2.065619945526123
Epoch: 10, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.813 Vali Acc: 0.722 Test Loss: 0.813 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 2.3777952194213867
Epoch: 11, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.742 Vali Acc: 0.706 Test Loss: 0.742 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1813652515411377
Epoch: 12, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 13 cost time: 2.1689140796661377
Epoch: 13, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
Validation loss decreased (-0.722215 --> -0.761105).  Saving model ...
Epoch: 14 cost time: 2.355741262435913
Epoch: 14, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1177287101745605
Epoch: 15, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.545 Vali Acc: 0.767 Test Loss: 0.545 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 16 cost time: 2.2862119674682617
Epoch: 16, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.507 Vali Acc: 0.767 Test Loss: 0.507 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766662).  Saving model ...
Epoch: 17 cost time: 2.1153407096862793
Epoch: 17, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.480 Vali Acc: 0.811 Test Loss: 0.480 Test Acc: 0.811
Validation loss decreased (-0.766662 --> -0.811106).  Saving model ...
Epoch: 18 cost time: 1.9926095008850098
Epoch: 18, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.450 Vali Acc: 0.778 Test Loss: 0.450 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.415529727935791
Epoch: 19, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.430 Vali Acc: 0.800 Test Loss: 0.430 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.186338186264038
Epoch: 20, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.407 Vali Acc: 0.794 Test Loss: 0.407 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1357297897338867
Epoch: 21, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.400 Vali Acc: 0.822 Test Loss: 0.400 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 2.370292901992798
Epoch: 22, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.384 Vali Acc: 0.794 Test Loss: 0.384 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.190068483352661
Epoch: 23, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.366 Vali Acc: 0.811 Test Loss: 0.366 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.174046516418457
Epoch: 24, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.361 Vali Acc: 0.822 Test Loss: 0.361 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 25 cost time: 2.3176543712615967
Epoch: 25, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.307424783706665
Epoch: 26, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.340 Vali Acc: 0.811 Test Loss: 0.340 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9327819347381592
Epoch: 27, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.334 Vali Acc: 0.833 Test Loss: 0.334 Test Acc: 0.833
Validation loss decreased (-0.822219 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 2.0397613048553467
Epoch: 28, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.325 Vali Acc: 0.817 Test Loss: 0.325 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9071142673492432
Epoch: 29, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 2.025289535522461
Epoch: 30, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 178694
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3724141120910645
Epoch: 1, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.869 Vali Acc: 0.139 Test Loss: 1.869 Test Acc: 0.139
Validation loss decreased (inf --> -0.138870).  Saving model ...
Epoch: 2 cost time: 1.9755525588989258
Epoch: 2, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.785 Vali Acc: 0.156 Test Loss: 1.785 Test Acc: 0.156
Validation loss decreased (-0.138870 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 1.8432025909423828
Epoch: 3, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.680 Vali Acc: 0.289 Test Loss: 1.680 Test Acc: 0.289
Validation loss decreased (-0.155538 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 1.7798595428466797
Epoch: 4, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
Validation loss decreased (-0.288872 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 1.907700777053833
Epoch: 5, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.433 Vali Acc: 0.589 Test Loss: 1.433 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 2.020366907119751
Epoch: 6, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.285 Vali Acc: 0.622 Test Loss: 1.285 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 1.776829719543457
Epoch: 7, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.135 Vali Acc: 0.661 Test Loss: 1.135 Test Acc: 0.661
Validation loss decreased (-0.622209 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 1.8926773071289062
Epoch: 8, Steps: 12 | Train Loss: 0.990 Vali Loss: 0.992 Vali Acc: 0.678 Test Loss: 0.992 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 1.922950029373169
Epoch: 9, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.872 Vali Acc: 0.694 Test Loss: 0.872 Test Acc: 0.694
Validation loss decreased (-0.677768 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 1.7832114696502686
Epoch: 10, Steps: 12 | Train Loss: 0.772 Vali Loss: 0.784 Vali Acc: 0.689 Test Loss: 0.784 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8742117881774902
Epoch: 11, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
Validation loss decreased (-0.694436 --> -0.738882).  Saving model ...
Epoch: 12 cost time: 2.03786563873291
Epoch: 12, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.654 Vali Acc: 0.739 Test Loss: 0.654 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 1.8653590679168701
Epoch: 13, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.608 Vali Acc: 0.744 Test Loss: 0.608 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 14 cost time: 1.8067231178283691
Epoch: 14, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.563 Vali Acc: 0.761 Test Loss: 0.563 Test Acc: 0.761
Validation loss decreased (-0.744438 --> -0.761105).  Saving model ...
Epoch: 15 cost time: 1.9676597118377686
Epoch: 15, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788884).  Saving model ...
Epoch: 16 cost time: 1.8218860626220703
Epoch: 16, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.485 Vali Acc: 0.778 Test Loss: 0.485 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.577777624130249
Epoch: 17, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.461 Vali Acc: 0.789 Test Loss: 0.461 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 18 cost time: 1.9379315376281738
Epoch: 18, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.435 Vali Acc: 0.828 Test Loss: 0.435 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827773).  Saving model ...
Epoch: 19 cost time: 1.6985251903533936
Epoch: 19, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.413 Vali Acc: 0.789 Test Loss: 0.413 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.766176700592041
Epoch: 20, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.397 Vali Acc: 0.794 Test Loss: 0.397 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.942591667175293
Epoch: 21, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833330).  Saving model ...
Epoch: 22 cost time: 1.7475032806396484
Epoch: 22, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.382 Vali Acc: 0.789 Test Loss: 0.382 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.794102668762207
Epoch: 23, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.369 Vali Acc: 0.806 Test Loss: 0.369 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9884004592895508
Epoch: 24, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.343 Vali Acc: 0.828 Test Loss: 0.343 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7640130519866943
Epoch: 25, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7005174160003662
Epoch: 26, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.351 Vali Acc: 0.800 Test Loss: 0.351 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9032783508300781
Epoch: 27, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 1.8306665420532227
Epoch: 28, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.315 Vali Acc: 0.867 Test Loss: 0.315 Test Acc: 0.867
Validation loss decreased (-0.833330 --> -0.866664).  Saving model ...
Epoch: 29 cost time: 1.6976449489593506
Epoch: 29, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.323 Vali Acc: 0.822 Test Loss: 0.323 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.888742208480835
Epoch: 30, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.321 Vali Acc: 0.833 Test Loss: 0.321 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 592646
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8893468379974365
Epoch: 1, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.762 Vali Acc: 0.228 Test Loss: 1.762 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 1.3253138065338135
Epoch: 2, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.689 Vali Acc: 0.300 Test Loss: 1.689 Test Acc: 0.300
Validation loss decreased (-0.227760 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.6337037086486816
Epoch: 3, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.597 Vali Acc: 0.333 Test Loss: 1.597 Test Acc: 0.333
Validation loss decreased (-0.299983 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 1.4848566055297852
Epoch: 4, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.492 Vali Acc: 0.506 Test Loss: 1.492 Test Acc: 0.506
Validation loss decreased (-0.333317 --> -0.505541).  Saving model ...
Epoch: 5 cost time: 1.4592881202697754
Epoch: 5, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.374 Vali Acc: 0.556 Test Loss: 1.374 Test Acc: 0.556
Validation loss decreased (-0.505541 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 1.6127276420593262
Epoch: 6, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.251 Vali Acc: 0.611 Test Loss: 1.251 Test Acc: 0.611
Validation loss decreased (-0.555542 --> -0.611099).  Saving model ...
Epoch: 7 cost time: 1.6255695819854736
Epoch: 7, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
Validation loss decreased (-0.611099 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 1.5022492408752441
Epoch: 8, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.012 Vali Acc: 0.661 Test Loss: 1.012 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661101).  Saving model ...
Epoch: 9 cost time: 1.3880693912506104
Epoch: 9, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.908 Vali Acc: 0.683 Test Loss: 0.908 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 1.4562647342681885
Epoch: 10, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.830 Vali Acc: 0.711 Test Loss: 0.830 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 1.590611219406128
Epoch: 11, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.760 Vali Acc: 0.694 Test Loss: 0.760 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.566577672958374
Epoch: 12, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.701 Vali Acc: 0.717 Test Loss: 0.701 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716660).  Saving model ...
Epoch: 13 cost time: 1.4156708717346191
Epoch: 13, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.716660 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 1.7050397396087646
Epoch: 14, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.601 Vali Acc: 0.739 Test Loss: 0.601 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4518110752105713
Epoch: 15, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755550).  Saving model ...
Epoch: 16 cost time: 1.5481863021850586
Epoch: 16, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.529 Vali Acc: 0.756 Test Loss: 0.529 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755550).  Saving model ...
Epoch: 17 cost time: 1.688739538192749
Epoch: 17, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.501 Vali Acc: 0.800 Test Loss: 0.501 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 1.4852759838104248
Epoch: 18, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.470 Vali Acc: 0.772 Test Loss: 0.470 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.32377028465271
Epoch: 19, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.449 Vali Acc: 0.800 Test Loss: 0.449 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 20 cost time: 1.7482962608337402
Epoch: 20, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.426 Vali Acc: 0.789 Test Loss: 0.426 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.624800443649292
Epoch: 21, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816662).  Saving model ...
Epoch: 22 cost time: 1.703298807144165
Epoch: 22, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.400 Vali Acc: 0.794 Test Loss: 0.400 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.854503870010376
Epoch: 23, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.381 Vali Acc: 0.811 Test Loss: 0.381 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7387456893920898
Epoch: 24, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.6335594654083252
Epoch: 25, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8676087856292725
Epoch: 26, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.351 Vali Acc: 0.817 Test Loss: 0.351 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6971158981323242
Epoch: 27, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 1.6316614151000977
Epoch: 28, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.335 Vali Acc: 0.833 Test Loss: 0.335 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 29 cost time: 1.8677568435668945
Epoch: 29, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.325 Vali Acc: 0.844 Test Loss: 0.325 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 30 cost time: 1.5984597206115723
Epoch: 30, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.329 Vali Acc: 0.833 Test Loss: 0.329 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 178694
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.9181108474731445
Epoch: 1, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.888 Vali Acc: 0.194 Test Loss: 1.888 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 3.028618335723877
Epoch: 2, Steps: 12 | Train Loss: 1.836 Vali Loss: 1.817 Vali Acc: 0.211 Test Loss: 1.817 Test Acc: 0.211
Validation loss decreased (-0.194426 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 3.1102380752563477
Epoch: 3, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.723 Vali Acc: 0.283 Test Loss: 1.723 Test Acc: 0.283
Validation loss decreased (-0.211093 --> -0.283316).  Saving model ...
Epoch: 4 cost time: 3.214825391769409
Epoch: 4, Steps: 12 | Train Loss: 1.681 Vali Loss: 1.608 Vali Acc: 0.356 Test Loss: 1.608 Test Acc: 0.356
Validation loss decreased (-0.283316 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 3.426274299621582
Epoch: 5, Steps: 12 | Train Loss: 1.575 Vali Loss: 1.474 Vali Acc: 0.411 Test Loss: 1.474 Test Acc: 0.411
Validation loss decreased (-0.355539 --> -0.411096).  Saving model ...
Epoch: 6 cost time: 3.5042457580566406
Epoch: 6, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.325 Vali Acc: 0.483 Test Loss: 1.325 Test Acc: 0.483
Validation loss decreased (-0.411096 --> -0.483320).  Saving model ...
Epoch: 7 cost time: 3.2185115814208984
Epoch: 7, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.178 Vali Acc: 0.567 Test Loss: 1.178 Test Acc: 0.567
Validation loss decreased (-0.483320 --> -0.566655).  Saving model ...
Epoch: 8 cost time: 3.260612726211548
Epoch: 8, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.044 Vali Acc: 0.628 Test Loss: 1.044 Test Acc: 0.628
Validation loss decreased (-0.566655 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 3.4079885482788086
Epoch: 9, Steps: 12 | Train Loss: 0.972 Vali Loss: 0.940 Vali Acc: 0.656 Test Loss: 0.940 Test Acc: 0.656
Validation loss decreased (-0.627767 --> -0.655546).  Saving model ...
Epoch: 10 cost time: 3.4145586490631104
Epoch: 10, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.855 Vali Acc: 0.650 Test Loss: 0.855 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2807414531707764
Epoch: 11, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.805 Vali Acc: 0.644 Test Loss: 0.805 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2716939449310303
Epoch: 12, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.759 Vali Acc: 0.667 Test Loss: 0.759 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666659).  Saving model ...
Epoch: 13 cost time: 3.4639010429382324
Epoch: 13, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.741 Vali Acc: 0.650 Test Loss: 0.741 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4542858600616455
Epoch: 14, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.719 Vali Acc: 0.661 Test Loss: 0.719 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.321136474609375
Epoch: 15, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.685 Vali Acc: 0.672 Test Loss: 0.685 Test Acc: 0.672
Validation loss decreased (-0.666659 --> -0.672215).  Saving model ...
Epoch: 16 cost time: 3.290531635284424
Epoch: 16, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.710 Vali Acc: 0.678 Test Loss: 0.710 Test Acc: 0.678
Validation loss decreased (-0.672215 --> -0.677771).  Saving model ...
Epoch: 17 cost time: 3.4789185523986816
Epoch: 17, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.664 Vali Acc: 0.706 Test Loss: 0.664 Test Acc: 0.706
Validation loss decreased (-0.677771 --> -0.705549).  Saving model ...
Epoch: 18 cost time: 3.385359525680542
Epoch: 18, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
Validation loss decreased (-0.705549 --> -0.722216).  Saving model ...
Epoch: 19 cost time: 3.427438974380493
Epoch: 19, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.604 Vali Acc: 0.728 Test Loss: 0.604 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 20 cost time: 3.463999032974243
Epoch: 20, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.727772 --> -0.783328).  Saving model ...
Epoch: 21 cost time: 3.550938606262207
Epoch: 21, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 3.186969757080078
Epoch: 22, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.511 Vali Acc: 0.756 Test Loss: 0.511 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.156874656677246
Epoch: 23, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.488 Vali Acc: 0.789 Test Loss: 0.488 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1443402767181396
Epoch: 24, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.544 Vali Acc: 0.750 Test Loss: 0.544 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.899346113204956
Epoch: 25, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.553 Vali Acc: 0.744 Test Loss: 0.553 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.600532293319702
Epoch: 26, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.529897928237915
Epoch: 27, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.455 Vali Acc: 0.811 Test Loss: 0.455 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811107).  Saving model ...
Epoch: 28 cost time: 3.9047024250030518
Epoch: 28, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.489 Vali Acc: 0.767 Test Loss: 0.489 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4343924522399902
Epoch: 29, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.529 Vali Acc: 0.750 Test Loss: 0.529 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.665658473968506
Epoch: 30, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.450 Vali Acc: 0.778 Test Loss: 0.450 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 1176262
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.055543422698975
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.820 Vali Acc: 0.172 Test Loss: 1.820 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 2.6190643310546875
Epoch: 2, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.776 Vali Acc: 0.217 Test Loss: 1.776 Test Acc: 0.217
Validation loss decreased (-0.172204 --> -0.216649).  Saving model ...
Epoch: 3 cost time: 2.8151462078094482
Epoch: 3, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.723 Vali Acc: 0.300 Test Loss: 1.723 Test Acc: 0.300
Validation loss decreased (-0.216649 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 2.6082844734191895
Epoch: 4, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.669 Vali Acc: 0.328 Test Loss: 1.669 Test Acc: 0.328
Validation loss decreased (-0.299983 --> -0.327761).  Saving model ...
Epoch: 5 cost time: 2.36777925491333
Epoch: 5, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.603 Vali Acc: 0.400 Test Loss: 1.603 Test Acc: 0.400
Validation loss decreased (-0.327761 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 2.340569496154785
Epoch: 6, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.531 Vali Acc: 0.456 Test Loss: 1.531 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 2.483161449432373
Epoch: 7, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.448 Vali Acc: 0.528 Test Loss: 1.448 Test Acc: 0.528
Validation loss decreased (-0.455540 --> -0.527763).  Saving model ...
Epoch: 8 cost time: 2.5698728561401367
Epoch: 8, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.361 Vali Acc: 0.572 Test Loss: 1.361 Test Acc: 0.572
Validation loss decreased (-0.527763 --> -0.572209).  Saving model ...
Epoch: 9 cost time: 2.401336431503296
Epoch: 9, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.282 Vali Acc: 0.617 Test Loss: 1.282 Test Acc: 0.617
Validation loss decreased (-0.572209 --> -0.616654).  Saving model ...
Epoch: 10 cost time: 2.743924617767334
Epoch: 10, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.206 Vali Acc: 0.578 Test Loss: 1.206 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4302892684936523
Epoch: 11, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.140 Vali Acc: 0.583 Test Loss: 1.140 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.660480499267578
Epoch: 12, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.346222162246704
Epoch: 13, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.034 Vali Acc: 0.594 Test Loss: 1.034 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6503307819366455
Epoch: 14, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3274199962615967
Epoch: 15, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.943 Vali Acc: 0.611 Test Loss: 0.943 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.600783348083496
Epoch: 16, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.908 Vali Acc: 0.628 Test Loss: 0.908 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627769).  Saving model ...
Epoch: 17 cost time: 2.357525587081909
Epoch: 17, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.868 Vali Acc: 0.667 Test Loss: 0.868 Test Acc: 0.667
Validation loss decreased (-0.627769 --> -0.666658).  Saving model ...
Epoch: 18 cost time: 2.668509006500244
Epoch: 18, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.829 Vali Acc: 0.672 Test Loss: 0.829 Test Acc: 0.672
Validation loss decreased (-0.666658 --> -0.672214).  Saving model ...
Epoch: 19 cost time: 2.327387809753418
Epoch: 19, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.789 Vali Acc: 0.672 Test Loss: 0.789 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672214).  Saving model ...
Epoch: 20 cost time: 2.7313973903656006
Epoch: 20, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.752 Vali Acc: 0.689 Test Loss: 0.752 Test Acc: 0.689
Validation loss decreased (-0.672214 --> -0.688881).  Saving model ...
Epoch: 21 cost time: 2.0627901554107666
Epoch: 21, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
Validation loss decreased (-0.688881 --> -0.711104).  Saving model ...
Epoch: 22 cost time: 3.0614964962005615
Epoch: 22, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.649 Vali Acc: 0.733 Test Loss: 0.649 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733327).  Saving model ...
Epoch: 23 cost time: 2.694814443588257
Epoch: 23, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.607 Vali Acc: 0.744 Test Loss: 0.607 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744438).  Saving model ...
Epoch: 24 cost time: 2.9630649089813232
Epoch: 24, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.569 Vali Acc: 0.756 Test Loss: 0.569 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 25 cost time: 2.6595101356506348
Epoch: 25, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.521 Vali Acc: 0.794 Test Loss: 0.521 Test Acc: 0.794
Validation loss decreased (-0.755550 --> -0.794439).  Saving model ...
Epoch: 26 cost time: 2.6926791667938232
Epoch: 26, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.481 Vali Acc: 0.794 Test Loss: 0.481 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794440).  Saving model ...
Epoch: 27 cost time: 2.772867202758789
Epoch: 27, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.451 Vali Acc: 0.811 Test Loss: 0.451 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 28 cost time: 2.595999240875244
Epoch: 28, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.431 Vali Acc: 0.806 Test Loss: 0.431 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7567203044891357
Epoch: 29, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.410 Vali Acc: 0.828 Test Loss: 0.410 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 30 cost time: 2.624072790145874
Epoch: 30, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.399 Vali Acc: 0.822 Test Loss: 0.399 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 348294
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.071052074432373
Epoch: 1, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.889 Vali Acc: 0.189 Test Loss: 1.889 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 2.739377737045288
Epoch: 2, Steps: 12 | Train Loss: 1.837 Vali Loss: 1.823 Vali Acc: 0.206 Test Loss: 1.823 Test Acc: 0.206
Validation loss decreased (-0.188870 --> -0.205537).  Saving model ...
Epoch: 3 cost time: 3.1629955768585205
Epoch: 3, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.735 Vali Acc: 0.244 Test Loss: 1.735 Test Acc: 0.244
Validation loss decreased (-0.205537 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 2.7615277767181396
Epoch: 4, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.633 Vali Acc: 0.333 Test Loss: 1.633 Test Acc: 0.333
Validation loss decreased (-0.244427 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 3.150923728942871
Epoch: 5, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.516 Vali Acc: 0.400 Test Loss: 1.516 Test Acc: 0.400
Validation loss decreased (-0.333317 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 2.797226667404175
Epoch: 6, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.373 Vali Acc: 0.472 Test Loss: 1.373 Test Acc: 0.472
Validation loss decreased (-0.399985 --> -0.472208).  Saving model ...
Epoch: 7 cost time: 3.033627510070801
Epoch: 7, Steps: 12 | Train Loss: 1.278 Vali Loss: 1.205 Vali Acc: 0.572 Test Loss: 1.205 Test Acc: 0.572
Validation loss decreased (-0.472208 --> -0.572210).  Saving model ...
Epoch: 8 cost time: 2.832122325897217
Epoch: 8, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.070 Vali Acc: 0.606 Test Loss: 1.070 Test Acc: 0.606
Validation loss decreased (-0.572210 --> -0.605545).  Saving model ...
Epoch: 9 cost time: 2.9013314247131348
Epoch: 9, Steps: 12 | Train Loss: 1.014 Vali Loss: 0.963 Vali Acc: 0.650 Test Loss: 0.963 Test Acc: 0.650
Validation loss decreased (-0.605545 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 2.457817554473877
Epoch: 10, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.870 Vali Acc: 0.656 Test Loss: 0.870 Test Acc: 0.656
Validation loss decreased (-0.649990 --> -0.655547).  Saving model ...
Epoch: 11 cost time: 2.3906872272491455
Epoch: 11, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.813 Vali Acc: 0.644 Test Loss: 0.813 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.572218418121338
Epoch: 12, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.751 Vali Acc: 0.678 Test Loss: 0.751 Test Acc: 0.678
Validation loss decreased (-0.655547 --> -0.677770).  Saving model ...
Epoch: 13 cost time: 2.6382389068603516
Epoch: 13, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.730 Vali Acc: 0.689 Test Loss: 0.730 Test Acc: 0.689
Validation loss decreased (-0.677770 --> -0.688882).  Saving model ...
Epoch: 14 cost time: 2.9568910598754883
Epoch: 14, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.704 Vali Acc: 0.672 Test Loss: 0.704 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0764925479888916
Epoch: 15, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.669 Vali Acc: 0.694 Test Loss: 0.669 Test Acc: 0.694
Validation loss decreased (-0.688882 --> -0.694438).  Saving model ...
Epoch: 16 cost time: 2.867628812789917
Epoch: 16, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.675 Vali Acc: 0.672 Test Loss: 0.675 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6294281482696533
Epoch: 17, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.653 Vali Acc: 0.711 Test Loss: 0.653 Test Acc: 0.711
Validation loss decreased (-0.694438 --> -0.711105).  Saving model ...
Epoch: 18 cost time: 2.715240716934204
Epoch: 18, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.601 Vali Acc: 0.733 Test Loss: 0.601 Test Acc: 0.733
Validation loss decreased (-0.711105 --> -0.733327).  Saving model ...
Epoch: 19 cost time: 2.8248865604400635
Epoch: 19, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.570 Vali Acc: 0.744 Test Loss: 0.570 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 20 cost time: 3.0714309215545654
Epoch: 20, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.519 Vali Acc: 0.767 Test Loss: 0.519 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766661).  Saving model ...
Epoch: 21 cost time: 2.960573196411133
Epoch: 21, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.530 Vali Acc: 0.800 Test Loss: 0.530 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 22 cost time: 2.8105950355529785
Epoch: 22, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.478 Vali Acc: 0.778 Test Loss: 0.478 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.751922130584717
Epoch: 23, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.458 Vali Acc: 0.783 Test Loss: 0.458 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6767489910125732
Epoch: 24, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.508 Vali Acc: 0.772 Test Loss: 0.508 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.862422466278076
Epoch: 25, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.507 Vali Acc: 0.767 Test Loss: 0.507 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0618581771850586
Epoch: 26, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.464 Vali Acc: 0.800 Test Loss: 0.464 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 27 cost time: 2.5294713973999023
Epoch: 27, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.421 Vali Acc: 0.811 Test Loss: 0.421 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 28 cost time: 2.5226776599884033
Epoch: 28, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.456 Vali Acc: 0.772 Test Loss: 0.456 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.6455557346343994
Epoch: 29, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.429 Vali Acc: 0.783 Test Loss: 0.429 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.774611473083496
Epoch: 30, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.442 Vali Acc: 0.794 Test Loss: 0.442 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 1176262
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.337569713592529
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.820 Vali Acc: 0.172 Test Loss: 1.820 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 2.23909068107605
Epoch: 2, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.776 Vali Acc: 0.217 Test Loss: 1.776 Test Acc: 0.217
Validation loss decreased (-0.172204 --> -0.216649).  Saving model ...
Epoch: 3 cost time: 2.214909315109253
Epoch: 3, Steps: 12 | Train Loss: 1.804 Vali Loss: 1.723 Vali Acc: 0.300 Test Loss: 1.723 Test Acc: 0.300
Validation loss decreased (-0.216649 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 2.3499207496643066
Epoch: 4, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.669 Vali Acc: 0.328 Test Loss: 1.669 Test Acc: 0.328
Validation loss decreased (-0.299983 --> -0.327761).  Saving model ...
Epoch: 5 cost time: 2.4185125827789307
Epoch: 5, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.603 Vali Acc: 0.400 Test Loss: 1.603 Test Acc: 0.400
Validation loss decreased (-0.327761 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 2.2573423385620117
Epoch: 6, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.531 Vali Acc: 0.456 Test Loss: 1.531 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 2.288219690322876
Epoch: 7, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.448 Vali Acc: 0.528 Test Loss: 1.448 Test Acc: 0.528
Validation loss decreased (-0.455540 --> -0.527763).  Saving model ...
Epoch: 8 cost time: 2.375316858291626
Epoch: 8, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.361 Vali Acc: 0.572 Test Loss: 1.361 Test Acc: 0.572
Validation loss decreased (-0.527763 --> -0.572209).  Saving model ...
Epoch: 9 cost time: 2.565073013305664
Epoch: 9, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.282 Vali Acc: 0.617 Test Loss: 1.282 Test Acc: 0.617
Validation loss decreased (-0.572209 --> -0.616654).  Saving model ...
Epoch: 10 cost time: 2.0984320640563965
Epoch: 10, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.206 Vali Acc: 0.583 Test Loss: 1.206 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9405946731567383
Epoch: 11, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.140 Vali Acc: 0.583 Test Loss: 1.140 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.038304567337036
Epoch: 12, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3539791107177734
Epoch: 13, Steps: 12 | Train Loss: 0.997 Vali Loss: 1.033 Vali Acc: 0.594 Test Loss: 1.033 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0302836894989014
Epoch: 14, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0284109115600586
Epoch: 15, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.943 Vali Acc: 0.611 Test Loss: 0.943 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1954243183135986
Epoch: 16, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.909 Vali Acc: 0.622 Test Loss: 0.909 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622213).  Saving model ...
Epoch: 17 cost time: 1.9589550495147705
Epoch: 17, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.869 Vali Acc: 0.667 Test Loss: 0.869 Test Acc: 0.667
Validation loss decreased (-0.622213 --> -0.666658).  Saving model ...
Epoch: 18 cost time: 1.5728070735931396
Epoch: 18, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.830 Vali Acc: 0.672 Test Loss: 0.830 Test Acc: 0.672
Validation loss decreased (-0.666658 --> -0.672214).  Saving model ...
Epoch: 19 cost time: 1.8832929134368896
Epoch: 19, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.792 Vali Acc: 0.672 Test Loss: 0.792 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672214).  Saving model ...
Epoch: 20 cost time: 1.8896887302398682
Epoch: 20, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.755 Vali Acc: 0.683 Test Loss: 0.755 Test Acc: 0.683
Validation loss decreased (-0.672214 --> -0.683326).  Saving model ...
Epoch: 21 cost time: 1.8135974407196045
Epoch: 21, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
Validation loss decreased (-0.683326 --> -0.716660).  Saving model ...
Epoch: 22 cost time: 2.0866551399230957
Epoch: 22, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.655 Vali Acc: 0.728 Test Loss: 0.655 Test Acc: 0.728
Validation loss decreased (-0.716660 --> -0.727771).  Saving model ...
Epoch: 23 cost time: 2.2898824214935303
Epoch: 23, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755549).  Saving model ...
Epoch: 24 cost time: 1.9959900379180908
Epoch: 24, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.575 Vali Acc: 0.750 Test Loss: 0.575 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.434316396713257
Epoch: 25, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788884).  Saving model ...
Epoch: 26 cost time: 1.7773864269256592
Epoch: 26, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.489 Vali Acc: 0.794 Test Loss: 0.489 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794440).  Saving model ...
Epoch: 27 cost time: 2.013127088546753
Epoch: 27, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.458 Vali Acc: 0.811 Test Loss: 0.458 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 28 cost time: 2.605381965637207
Epoch: 28, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2851943969726562
Epoch: 29, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.418 Vali Acc: 0.817 Test Loss: 0.418 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 30 cost time: 2.6553046703338623
Epoch: 30, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.409 Vali Acc: 0.817 Test Loss: 0.409 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 348294
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.135303974151611
Epoch: 1, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.891 Vali Acc: 0.189 Test Loss: 1.891 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 2.122171640396118
Epoch: 2, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.830 Vali Acc: 0.200 Test Loss: 1.830 Test Acc: 0.200
Validation loss decreased (-0.188870 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 2.2436773777008057
Epoch: 3, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.749 Vali Acc: 0.228 Test Loss: 1.749 Test Acc: 0.228
Validation loss decreased (-0.199982 --> -0.227760).  Saving model ...
Epoch: 4 cost time: 2.0842745304107666
Epoch: 4, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.657 Vali Acc: 0.289 Test Loss: 1.657 Test Acc: 0.289
Validation loss decreased (-0.227760 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 2.168980598449707
Epoch: 5, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.555 Vali Acc: 0.389 Test Loss: 1.555 Test Acc: 0.389
Validation loss decreased (-0.288872 --> -0.388873).  Saving model ...
Epoch: 6 cost time: 2.132105588912964
Epoch: 6, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.443 Vali Acc: 0.428 Test Loss: 1.443 Test Acc: 0.428
Validation loss decreased (-0.388873 --> -0.427763).  Saving model ...
Epoch: 7 cost time: 2.2329516410827637
Epoch: 7, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.326 Vali Acc: 0.511 Test Loss: 1.326 Test Acc: 0.511
Validation loss decreased (-0.427763 --> -0.511098).  Saving model ...
Epoch: 8 cost time: 2.303657054901123
Epoch: 8, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.216 Vali Acc: 0.606 Test Loss: 1.216 Test Acc: 0.606
Validation loss decreased (-0.511098 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 2.1306447982788086
Epoch: 9, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.122 Vali Acc: 0.617 Test Loss: 1.122 Test Acc: 0.617
Validation loss decreased (-0.605543 --> -0.616655).  Saving model ...
Epoch: 10 cost time: 2.3677141666412354
Epoch: 10, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.047 Vali Acc: 0.639 Test Loss: 1.047 Test Acc: 0.639
Validation loss decreased (-0.616655 --> -0.638878).  Saving model ...
Epoch: 11 cost time: 2.2204768657684326
Epoch: 11, Steps: 12 | Train Loss: 0.994 Vali Loss: 0.977 Vali Acc: 0.644 Test Loss: 0.977 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644435).  Saving model ...
Epoch: 12 cost time: 2.3511545658111572
Epoch: 12, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.924 Vali Acc: 0.644 Test Loss: 0.924 Test Acc: 0.644
Validation loss decreased (-0.644435 --> -0.644435).  Saving model ...
Epoch: 13 cost time: 2.120981454849243
Epoch: 13, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.879 Vali Acc: 0.672 Test Loss: 0.879 Test Acc: 0.672
Validation loss decreased (-0.644435 --> -0.672213).  Saving model ...
Epoch: 14 cost time: 2.3647804260253906
Epoch: 14, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.839 Vali Acc: 0.683 Test Loss: 0.839 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683325).  Saving model ...
Epoch: 15 cost time: 2.021892547607422
Epoch: 15, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.806 Vali Acc: 0.694 Test Loss: 0.806 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694436).  Saving model ...
Epoch: 16 cost time: 2.3282294273376465
Epoch: 16, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.773 Vali Acc: 0.694 Test Loss: 0.773 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694437).  Saving model ...
Epoch: 17 cost time: 2.0358970165252686
Epoch: 17, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716659).  Saving model ...
Epoch: 18 cost time: 2.3707785606384277
Epoch: 18, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.729 Vali Acc: 0.711 Test Loss: 0.729 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.051875352859497
Epoch: 19, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.711 Vali Acc: 0.711 Test Loss: 0.711 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.354649066925049
Epoch: 20, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.694 Vali Acc: 0.706 Test Loss: 0.694 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.102153778076172
Epoch: 21, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.716659 --> -0.716660).  Saving model ...
Epoch: 22 cost time: 2.349459171295166
Epoch: 22, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.652 Vali Acc: 0.733 Test Loss: 0.652 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 23 cost time: 2.1121866703033447
Epoch: 23, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.628 Vali Acc: 0.728 Test Loss: 0.628 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3904075622558594
Epoch: 24, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.615 Vali Acc: 0.750 Test Loss: 0.615 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 2.235609769821167
Epoch: 25, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.578 Vali Acc: 0.756 Test Loss: 0.578 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 26 cost time: 2.3606388568878174
Epoch: 26, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.562 Vali Acc: 0.761 Test Loss: 0.562 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761105).  Saving model ...
Epoch: 27 cost time: 2.1383554935455322
Epoch: 27, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.581 Vali Acc: 0.744 Test Loss: 0.581 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3005361557006836
Epoch: 28, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.519 Vali Acc: 0.778 Test Loss: 0.519 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777773).  Saving model ...
Epoch: 29 cost time: 2.0944066047668457
Epoch: 29, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783328).  Saving model ...
Epoch: 30 cost time: 2.247854471206665
Epoch: 30, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.473 Vali Acc: 0.800 Test Loss: 0.473 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 1176262
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.013824701309204
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.823 Vali Acc: 0.172 Test Loss: 1.823 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.9115588665008545
Epoch: 2, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.782 Vali Acc: 0.200 Test Loss: 1.782 Test Acc: 0.200
Validation loss decreased (-0.172204 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 2.0753989219665527
Epoch: 3, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.733 Vali Acc: 0.283 Test Loss: 1.733 Test Acc: 0.283
Validation loss decreased (-0.199982 --> -0.283316).  Saving model ...
Epoch: 4 cost time: 1.9705939292907715
Epoch: 4, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.682 Vali Acc: 0.311 Test Loss: 1.682 Test Acc: 0.311
Validation loss decreased (-0.283316 --> -0.311094).  Saving model ...
Epoch: 5 cost time: 1.7139182090759277
Epoch: 5, Steps: 12 | Train Loss: 1.682 Vali Loss: 1.620 Vali Acc: 0.378 Test Loss: 1.620 Test Acc: 0.378
Validation loss decreased (-0.311094 --> -0.377762).  Saving model ...
Epoch: 6 cost time: 1.6696052551269531
Epoch: 6, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.550 Vali Acc: 0.461 Test Loss: 1.550 Test Acc: 0.461
Validation loss decreased (-0.377762 --> -0.461096).  Saving model ...
Epoch: 7 cost time: 1.6019818782806396
Epoch: 7, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.472 Vali Acc: 0.517 Test Loss: 1.472 Test Acc: 0.517
Validation loss decreased (-0.461096 --> -0.516652).  Saving model ...
Epoch: 8 cost time: 1.6016905307769775
Epoch: 8, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.387 Vali Acc: 0.567 Test Loss: 1.387 Test Acc: 0.567
Validation loss decreased (-0.516652 --> -0.566653).  Saving model ...
Epoch: 9 cost time: 1.6247074604034424
Epoch: 9, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.310 Vali Acc: 0.600 Test Loss: 1.310 Test Acc: 0.600
Validation loss decreased (-0.566653 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 1.6790509223937988
Epoch: 10, Steps: 12 | Train Loss: 1.237 Vali Loss: 1.234 Vali Acc: 0.567 Test Loss: 1.234 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9639534950256348
Epoch: 11, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.168 Vali Acc: 0.572 Test Loss: 1.168 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7478375434875488
Epoch: 12, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.109 Vali Acc: 0.578 Test Loss: 1.109 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7968204021453857
Epoch: 13, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.061 Vali Acc: 0.583 Test Loss: 1.061 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9179987907409668
Epoch: 14, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.017 Vali Acc: 0.578 Test Loss: 1.017 Test Acc: 0.578
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7036638259887695
Epoch: 15, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 1.7222926616668701
Epoch: 16, Steps: 12 | Train Loss: 0.896 Vali Loss: 0.944 Vali Acc: 0.594 Test Loss: 0.944 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9005229473114014
Epoch: 17, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.909 Vali Acc: 0.617 Test Loss: 0.909 Test Acc: 0.617
Validation loss decreased (-0.599990 --> -0.616658).  Saving model ...
Epoch: 18 cost time: 1.7273833751678467
Epoch: 18, Steps: 12 | Train Loss: 0.795 Vali Loss: 0.873 Vali Acc: 0.633 Test Loss: 0.873 Test Acc: 0.633
Validation loss decreased (-0.616658 --> -0.633325).  Saving model ...
Epoch: 19 cost time: 1.8038194179534912
Epoch: 19, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.839 Vali Acc: 0.656 Test Loss: 0.839 Test Acc: 0.656
Validation loss decreased (-0.633325 --> -0.655547).  Saving model ...
Epoch: 20 cost time: 1.8841314315795898
Epoch: 20, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.809 Vali Acc: 0.639 Test Loss: 0.809 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7384579181671143
Epoch: 21, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.756 Vali Acc: 0.700 Test Loss: 0.756 Test Acc: 0.700
Validation loss decreased (-0.655547 --> -0.699992).  Saving model ...
Epoch: 22 cost time: 1.7703628540039062
Epoch: 22, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.700 Vali Acc: 0.694 Test Loss: 0.700 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8652544021606445
Epoch: 23, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.654 Vali Acc: 0.733 Test Loss: 0.654 Test Acc: 0.733
Validation loss decreased (-0.699992 --> -0.733327).  Saving model ...
Epoch: 24 cost time: 1.6936874389648438
Epoch: 24, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.620 Vali Acc: 0.739 Test Loss: 0.620 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 25 cost time: 1.800156831741333
Epoch: 25, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755550).  Saving model ...
Epoch: 26 cost time: 1.8175079822540283
Epoch: 26, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 27 cost time: 1.4533236026763916
Epoch: 27, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.495 Vali Acc: 0.794 Test Loss: 0.495 Test Acc: 0.794
Validation loss decreased (-0.761106 --> -0.794439).  Saving model ...
Epoch: 28 cost time: 1.6493327617645264
Epoch: 28, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.483 Vali Acc: 0.794 Test Loss: 0.483 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794440).  Saving model ...
Epoch: 29 cost time: 1.8183119297027588
Epoch: 29, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.451 Vali Acc: 0.811 Test Loss: 0.451 Test Acc: 0.811
Validation loss decreased (-0.794440 --> -0.811107).  Saving model ...
Epoch: 30 cost time: 1.5459375381469727
Epoch: 30, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.439 Vali Acc: 0.806 Test Loss: 0.439 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 348294
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.643569707870483
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.829 Vali Acc: 0.117 Test Loss: 1.829 Test Acc: 0.117
Validation loss decreased (inf --> -0.116648).  Saving model ...
Epoch: 2 cost time: 3.010941743850708
Epoch: 2, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.785 Vali Acc: 0.156 Test Loss: 1.785 Test Acc: 0.156
Validation loss decreased (-0.116648 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 2.9881205558776855
Epoch: 3, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.726 Vali Acc: 0.244 Test Loss: 1.726 Test Acc: 0.244
Validation loss decreased (-0.155538 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 2.9128806591033936
Epoch: 4, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.654 Vali Acc: 0.322 Test Loss: 1.654 Test Acc: 0.322
Validation loss decreased (-0.244427 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 2.941833019256592
Epoch: 5, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.571 Vali Acc: 0.394 Test Loss: 1.571 Test Acc: 0.394
Validation loss decreased (-0.322206 --> -0.394429).  Saving model ...
Epoch: 6 cost time: 2.9217052459716797
Epoch: 6, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.476 Vali Acc: 0.472 Test Loss: 1.476 Test Acc: 0.472
Validation loss decreased (-0.394429 --> -0.472207).  Saving model ...
Epoch: 7 cost time: 2.8276333808898926
Epoch: 7, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.370 Vali Acc: 0.522 Test Loss: 1.370 Test Acc: 0.522
Validation loss decreased (-0.472207 --> -0.522209).  Saving model ...
Epoch: 8 cost time: 3.0583078861236572
Epoch: 8, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.269 Vali Acc: 0.561 Test Loss: 1.269 Test Acc: 0.561
Validation loss decreased (-0.522209 --> -0.561098).  Saving model ...
Epoch: 9 cost time: 2.7143337726593018
Epoch: 9, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.168 Vali Acc: 0.606 Test Loss: 1.168 Test Acc: 0.606
Validation loss decreased (-0.561098 --> -0.605544).  Saving model ...
Epoch: 10 cost time: 3.1590218544006348
Epoch: 10, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.043 Vali Acc: 0.667 Test Loss: 1.043 Test Acc: 0.667
Validation loss decreased (-0.605544 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 3.251600980758667
Epoch: 11, Steps: 12 | Train Loss: 0.988 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
Validation loss decreased (-0.666656 --> -0.716658).  Saving model ...
Epoch: 12 cost time: 3.0787606239318848
Epoch: 12, Steps: 12 | Train Loss: 0.896 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.716658 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 3.1774508953094482
Epoch: 13, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.716 Vali Acc: 0.806 Test Loss: 0.716 Test Acc: 0.806
Validation loss decreased (-0.749992 --> -0.805548).  Saving model ...
Epoch: 14 cost time: 3.0226798057556152
Epoch: 14, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.641 Vali Acc: 0.794 Test Loss: 0.641 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9159152507781982
Epoch: 15, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.584 Vali Acc: 0.800 Test Loss: 0.584 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.05763578414917
Epoch: 16, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.533 Vali Acc: 0.794 Test Loss: 0.533 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2077832221984863
Epoch: 17, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.496 Vali Acc: 0.811 Test Loss: 0.496 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811106).  Saving model ...
Epoch: 18 cost time: 3.218714475631714
Epoch: 18, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.467 Vali Acc: 0.817 Test Loss: 0.467 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816662).  Saving model ...
Epoch: 19 cost time: 3.2385268211364746
Epoch: 19, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.437 Vali Acc: 0.811 Test Loss: 0.437 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2634689807891846
Epoch: 20, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.238703489303589
Epoch: 21, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.398 Vali Acc: 0.811 Test Loss: 0.398 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.249823808670044
Epoch: 22, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.405 Vali Acc: 0.817 Test Loss: 0.405 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 23 cost time: 3.2699923515319824
Epoch: 23, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.420 Vali Acc: 0.794 Test Loss: 0.420 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.245591402053833
Epoch: 24, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2377564907073975
Epoch: 25, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.422 Vali Acc: 0.811 Test Loss: 0.422 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.3071372509002686
Epoch: 26, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.406 Vali Acc: 0.783 Test Loss: 0.406 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.4053268432617188
Epoch: 27, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.390 Vali Acc: 0.811 Test Loss: 0.390 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.342660427093506
Epoch: 28, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.378 Vali Acc: 0.811 Test Loss: 0.378 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.4254627227783203
Epoch: 29, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.364 Vali Acc: 0.817 Test Loss: 0.364 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 30 cost time: 3.520758628845215
Epoch: 30, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.358 Vali Acc: 0.806 Test Loss: 0.358 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 589766
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.591947317123413
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.899 Vali Acc: 0.144 Test Loss: 1.899 Test Acc: 0.144
Validation loss decreased (inf --> -0.144425).  Saving model ...
Epoch: 2 cost time: 2.9041130542755127
Epoch: 2, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.835 Vali Acc: 0.178 Test Loss: 1.835 Test Acc: 0.178
Validation loss decreased (-0.144425 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 2.6365513801574707
Epoch: 3, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
Validation loss decreased (-0.177759 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 2.5929481983184814
Epoch: 4, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.656 Vali Acc: 0.322 Test Loss: 1.656 Test Acc: 0.322
Validation loss decreased (-0.199982 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 2.4934823513031006
Epoch: 5, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.552 Vali Acc: 0.439 Test Loss: 1.552 Test Acc: 0.439
Validation loss decreased (-0.322206 --> -0.438873).  Saving model ...
Epoch: 6 cost time: 2.4937362670898438
Epoch: 6, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.443 Vali Acc: 0.506 Test Loss: 1.443 Test Acc: 0.506
Validation loss decreased (-0.438873 --> -0.505541).  Saving model ...
Epoch: 7 cost time: 2.6824119091033936
Epoch: 7, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.340 Vali Acc: 0.533 Test Loss: 1.340 Test Acc: 0.533
Validation loss decreased (-0.505541 --> -0.533320).  Saving model ...
Epoch: 8 cost time: 2.6765670776367188
Epoch: 8, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.243 Vali Acc: 0.567 Test Loss: 1.243 Test Acc: 0.567
Validation loss decreased (-0.533320 --> -0.566654).  Saving model ...
Epoch: 9 cost time: 2.7440345287323
Epoch: 9, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.157 Vali Acc: 0.594 Test Loss: 1.157 Test Acc: 0.594
Validation loss decreased (-0.566654 --> -0.594433).  Saving model ...
Epoch: 10 cost time: 2.501426935195923
Epoch: 10, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.084 Vali Acc: 0.611 Test Loss: 1.084 Test Acc: 0.611
Validation loss decreased (-0.594433 --> -0.611100).  Saving model ...
Epoch: 11 cost time: 2.4696788787841797
Epoch: 11, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.020 Vali Acc: 0.606 Test Loss: 1.020 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4087135791778564
Epoch: 12, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.961 Vali Acc: 0.639 Test Loss: 0.961 Test Acc: 0.639
Validation loss decreased (-0.611100 --> -0.638879).  Saving model ...
Epoch: 13 cost time: 2.245391845703125
Epoch: 13, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.909 Vali Acc: 0.661 Test Loss: 0.909 Test Acc: 0.661
Validation loss decreased (-0.638879 --> -0.661102).  Saving model ...
Epoch: 14 cost time: 2.3172662258148193
Epoch: 14, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.860 Vali Acc: 0.656 Test Loss: 0.860 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2394773960113525
Epoch: 15, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.821 Vali Acc: 0.639 Test Loss: 0.821 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.261070489883423
Epoch: 16, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.787 Vali Acc: 0.644 Test Loss: 0.787 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3030612468719482
Epoch: 17, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.757 Vali Acc: 0.661 Test Loss: 0.757 Test Acc: 0.661
Validation loss decreased (-0.661102 --> -0.661104).  Saving model ...
Epoch: 18 cost time: 2.440842390060425
Epoch: 18, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.735 Vali Acc: 0.672 Test Loss: 0.735 Test Acc: 0.672
Validation loss decreased (-0.661104 --> -0.672215).  Saving model ...
Epoch: 19 cost time: 2.360888719558716
Epoch: 19, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.707 Vali Acc: 0.667 Test Loss: 0.707 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.350029945373535
Epoch: 20, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.665 Vali Acc: 0.689 Test Loss: 0.665 Test Acc: 0.689
Validation loss decreased (-0.672215 --> -0.688882).  Saving model ...
Epoch: 21 cost time: 2.4308202266693115
Epoch: 21, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.591 Vali Acc: 0.733 Test Loss: 0.591 Test Acc: 0.733
Validation loss decreased (-0.688882 --> -0.733327).  Saving model ...
Epoch: 22 cost time: 2.446181297302246
Epoch: 22, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.516 Vali Acc: 0.772 Test Loss: 0.516 Test Acc: 0.772
Validation loss decreased (-0.733327 --> -0.772217).  Saving model ...
Epoch: 23 cost time: 2.427675485610962
Epoch: 23, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.497 Vali Acc: 0.761 Test Loss: 0.497 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5047388076782227
Epoch: 24, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.461 Vali Acc: 0.783 Test Loss: 0.461 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 25 cost time: 2.4437990188598633
Epoch: 25, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.438 Vali Acc: 0.794 Test Loss: 0.438 Test Acc: 0.794
Validation loss decreased (-0.783329 --> -0.794440).  Saving model ...
Epoch: 26 cost time: 2.412925958633423
Epoch: 26, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.449 Vali Acc: 0.783 Test Loss: 0.449 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2577743530273438
Epoch: 27, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.447 Vali Acc: 0.772 Test Loss: 0.447 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1395440101623535
Epoch: 28, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.406 Vali Acc: 0.794 Test Loss: 0.406 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 29 cost time: 2.2634525299072266
Epoch: 29, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 30 cost time: 2.197772264480591
Epoch: 30, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.416 Vali Acc: 0.783 Test Loss: 0.416 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 175750
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.076028347015381
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.829 Vali Acc: 0.117 Test Loss: 1.829 Test Acc: 0.117
Validation loss decreased (inf --> -0.116648).  Saving model ...
Epoch: 2 cost time: 2.096799612045288
Epoch: 2, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.785 Vali Acc: 0.156 Test Loss: 1.785 Test Acc: 0.156
Validation loss decreased (-0.116648 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 2.123748779296875
Epoch: 3, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.726 Vali Acc: 0.244 Test Loss: 1.726 Test Acc: 0.244
Validation loss decreased (-0.155538 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 2.064761161804199
Epoch: 4, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.655 Vali Acc: 0.317 Test Loss: 1.655 Test Acc: 0.317
Validation loss decreased (-0.244427 --> -0.316650).  Saving model ...
Epoch: 5 cost time: 2.1930148601531982
Epoch: 5, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.573 Vali Acc: 0.394 Test Loss: 1.573 Test Acc: 0.394
Validation loss decreased (-0.316650 --> -0.394429).  Saving model ...
Epoch: 6 cost time: 2.2974541187286377
Epoch: 6, Steps: 12 | Train Loss: 1.498 Vali Loss: 1.477 Vali Acc: 0.472 Test Loss: 1.477 Test Acc: 0.472
Validation loss decreased (-0.394429 --> -0.472207).  Saving model ...
Epoch: 7 cost time: 2.4203717708587646
Epoch: 7, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.366 Vali Acc: 0.522 Test Loss: 1.366 Test Acc: 0.522
Validation loss decreased (-0.472207 --> -0.522209).  Saving model ...
Epoch: 8 cost time: 2.4825267791748047
Epoch: 8, Steps: 12 | Train Loss: 1.305 Vali Loss: 1.260 Vali Acc: 0.561 Test Loss: 1.260 Test Acc: 0.561
Validation loss decreased (-0.522209 --> -0.561099).  Saving model ...
Epoch: 9 cost time: 2.828514575958252
Epoch: 9, Steps: 12 | Train Loss: 1.220 Vali Loss: 1.158 Vali Acc: 0.611 Test Loss: 1.158 Test Acc: 0.611
Validation loss decreased (-0.561099 --> -0.611100).  Saving model ...
Epoch: 10 cost time: 2.6749839782714844
Epoch: 10, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.024 Vali Acc: 0.683 Test Loss: 1.024 Test Acc: 0.683
Validation loss decreased (-0.611100 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 2.6257779598236084
Epoch: 11, Steps: 12 | Train Loss: 0.983 Vali Loss: 0.893 Vali Acc: 0.733 Test Loss: 0.893 Test Acc: 0.733
Validation loss decreased (-0.683323 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 2.6565332412719727
Epoch: 12, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.793 Vali Acc: 0.761 Test Loss: 0.793 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 2.607933759689331
Epoch: 13, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.723 Vali Acc: 0.772 Test Loss: 0.723 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 2.4994704723358154
Epoch: 14, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 2.431689739227295
Epoch: 15, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 2.4121084213256836
Epoch: 16, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.415604591369629
Epoch: 17, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.03195858001709
Epoch: 18, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.491 Vali Acc: 0.800 Test Loss: 0.491 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 19 cost time: 2.6949687004089355
Epoch: 19, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.481 Vali Acc: 0.783 Test Loss: 0.481 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.677868604660034
Epoch: 20, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.453 Vali Acc: 0.783 Test Loss: 0.453 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9487335681915283
Epoch: 21, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.433 Vali Acc: 0.789 Test Loss: 0.433 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.681802272796631
Epoch: 22, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.439 Vali Acc: 0.794 Test Loss: 0.439 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.765357494354248
Epoch: 23, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.425 Vali Acc: 0.783 Test Loss: 0.425 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.8732123374938965
Epoch: 24, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.409 Vali Acc: 0.806 Test Loss: 0.409 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 25 cost time: 2.638989210128784
Epoch: 25, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.435 Vali Acc: 0.783 Test Loss: 0.435 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9363598823547363
Epoch: 26, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.422 Vali Acc: 0.778 Test Loss: 0.422 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0054731369018555
Epoch: 27, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.441 Vali Acc: 0.794 Test Loss: 0.441 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7002642154693604
Epoch: 28, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.424 Vali Acc: 0.767 Test Loss: 0.424 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9714226722717285
Epoch: 29, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.390 Vali Acc: 0.794 Test Loss: 0.390 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8548450469970703
Epoch: 30, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.378 Vali Acc: 0.794 Test Loss: 0.378 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 589766
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6583850383758545
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.899 Vali Acc: 0.144 Test Loss: 1.899 Test Acc: 0.144
Validation loss decreased (inf --> -0.144425).  Saving model ...
Epoch: 2 cost time: 2.381443977355957
Epoch: 2, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.835 Vali Acc: 0.178 Test Loss: 1.835 Test Acc: 0.178
Validation loss decreased (-0.144425 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 2.373311758041382
Epoch: 3, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
Validation loss decreased (-0.177759 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 2.311840295791626
Epoch: 4, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.656 Vali Acc: 0.322 Test Loss: 1.656 Test Acc: 0.322
Validation loss decreased (-0.199982 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 2.3329663276672363
Epoch: 5, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.552 Vali Acc: 0.439 Test Loss: 1.552 Test Acc: 0.439
Validation loss decreased (-0.322206 --> -0.438873).  Saving model ...
Epoch: 6 cost time: 2.562979221343994
Epoch: 6, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.444 Vali Acc: 0.506 Test Loss: 1.444 Test Acc: 0.506
Validation loss decreased (-0.438873 --> -0.505541).  Saving model ...
Epoch: 7 cost time: 2.3134589195251465
Epoch: 7, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.340 Vali Acc: 0.533 Test Loss: 1.340 Test Acc: 0.533
Validation loss decreased (-0.505541 --> -0.533320).  Saving model ...
Epoch: 8 cost time: 2.601404905319214
Epoch: 8, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.244 Vali Acc: 0.567 Test Loss: 1.244 Test Acc: 0.567
Validation loss decreased (-0.533320 --> -0.566654).  Saving model ...
Epoch: 9 cost time: 2.226407527923584
Epoch: 9, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.158 Vali Acc: 0.594 Test Loss: 1.158 Test Acc: 0.594
Validation loss decreased (-0.566654 --> -0.594433).  Saving model ...
Epoch: 10 cost time: 2.343745708465576
Epoch: 10, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.594433 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 2.407132625579834
Epoch: 11, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.021 Vali Acc: 0.611 Test Loss: 1.021 Test Acc: 0.611
Validation loss decreased (-0.599989 --> -0.611101).  Saving model ...
Epoch: 12 cost time: 2.261934518814087
Epoch: 12, Steps: 12 | Train Loss: 0.918 Vali Loss: 0.962 Vali Acc: 0.644 Test Loss: 0.962 Test Acc: 0.644
Validation loss decreased (-0.611101 --> -0.644435).  Saving model ...
Epoch: 13 cost time: 2.5278449058532715
Epoch: 13, Steps: 12 | Train Loss: 0.863 Vali Loss: 0.912 Vali Acc: 0.650 Test Loss: 0.912 Test Acc: 0.650
Validation loss decreased (-0.644435 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 2.1558802127838135
Epoch: 14, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.864 Vali Acc: 0.650 Test Loss: 0.864 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 15 cost time: 2.5585012435913086
Epoch: 15, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.826 Vali Acc: 0.639 Test Loss: 0.826 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.270240306854248
Epoch: 16, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.794 Vali Acc: 0.644 Test Loss: 0.794 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2876856327056885
Epoch: 17, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.764 Vali Acc: 0.661 Test Loss: 0.764 Test Acc: 0.661
Validation loss decreased (-0.649991 --> -0.661103).  Saving model ...
Epoch: 18 cost time: 2.218766212463379
Epoch: 18, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.742 Vali Acc: 0.661 Test Loss: 0.742 Test Acc: 0.661
Validation loss decreased (-0.661103 --> -0.661104).  Saving model ...
Epoch: 19 cost time: 2.29451060295105
Epoch: 19, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.719 Vali Acc: 0.656 Test Loss: 0.719 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.488337755203247
Epoch: 20, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.694 Vali Acc: 0.694 Test Loss: 0.694 Test Acc: 0.694
Validation loss decreased (-0.661104 --> -0.694438).  Saving model ...
Epoch: 21 cost time: 2.169156074523926
Epoch: 21, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.660 Vali Acc: 0.711 Test Loss: 0.660 Test Acc: 0.711
Validation loss decreased (-0.694438 --> -0.711105).  Saving model ...
Epoch: 22 cost time: 2.6617369651794434
Epoch: 22, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.606 Vali Acc: 0.733 Test Loss: 0.606 Test Acc: 0.733
Validation loss decreased (-0.711105 --> -0.733327).  Saving model ...
Epoch: 23 cost time: 2.2591347694396973
Epoch: 23, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.733327 --> -0.783328).  Saving model ...
Epoch: 24 cost time: 2.2611117362976074
Epoch: 24, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.464 Vali Acc: 0.794 Test Loss: 0.464 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 25 cost time: 2.3370068073272705
Epoch: 25, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.466 Vali Acc: 0.778 Test Loss: 0.466 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2643234729766846
Epoch: 26, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.466 Vali Acc: 0.772 Test Loss: 0.466 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4440672397613525
Epoch: 27, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.428 Vali Acc: 0.778 Test Loss: 0.428 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.174015522003174
Epoch: 28, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.429 Vali Acc: 0.789 Test Loss: 0.429 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.506934881210327
Epoch: 29, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.476 Vali Acc: 0.772 Test Loss: 0.476 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2852418422698975
Epoch: 30, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.426 Vali Acc: 0.789 Test Loss: 0.426 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 175750
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4776225090026855
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.830 Vali Acc: 0.117 Test Loss: 1.830 Test Acc: 0.117
Validation loss decreased (inf --> -0.116648).  Saving model ...
Epoch: 2 cost time: 1.7467286586761475
Epoch: 2, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.786 Vali Acc: 0.156 Test Loss: 1.786 Test Acc: 0.156
Validation loss decreased (-0.116648 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 1.557863712310791
Epoch: 3, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.727 Vali Acc: 0.244 Test Loss: 1.727 Test Acc: 0.244
Validation loss decreased (-0.155538 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 1.5376479625701904
Epoch: 4, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.656 Vali Acc: 0.317 Test Loss: 1.656 Test Acc: 0.317
Validation loss decreased (-0.244427 --> -0.316650).  Saving model ...
Epoch: 5 cost time: 1.5905346870422363
Epoch: 5, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.575 Vali Acc: 0.400 Test Loss: 1.575 Test Acc: 0.400
Validation loss decreased (-0.316650 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 1.5704281330108643
Epoch: 6, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.482 Vali Acc: 0.456 Test Loss: 1.482 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455541).  Saving model ...
Epoch: 7 cost time: 1.5421106815338135
Epoch: 7, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.378 Vali Acc: 0.511 Test Loss: 1.378 Test Acc: 0.511
Validation loss decreased (-0.455541 --> -0.511097).  Saving model ...
Epoch: 8 cost time: 1.734518051147461
Epoch: 8, Steps: 12 | Train Loss: 1.322 Vali Loss: 1.282 Vali Acc: 0.528 Test Loss: 1.282 Test Acc: 0.528
Validation loss decreased (-0.511097 --> -0.527765).  Saving model ...
Epoch: 9 cost time: 1.641692876815796
Epoch: 9, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.194 Vali Acc: 0.567 Test Loss: 1.194 Test Acc: 0.567
Validation loss decreased (-0.527765 --> -0.566655).  Saving model ...
Epoch: 10 cost time: 1.8946747779846191
Epoch: 10, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.111 Vali Acc: 0.617 Test Loss: 1.111 Test Acc: 0.617
Validation loss decreased (-0.566655 --> -0.616656).  Saving model ...
Epoch: 11 cost time: 1.7218348979949951
Epoch: 11, Steps: 12 | Train Loss: 1.059 Vali Loss: 1.039 Vali Acc: 0.639 Test Loss: 1.039 Test Acc: 0.639
Validation loss decreased (-0.616656 --> -0.638878).  Saving model ...
Epoch: 12 cost time: 1.7568919658660889
Epoch: 12, Steps: 12 | Train Loss: 0.974 Vali Loss: 0.973 Vali Acc: 0.661 Test Loss: 0.973 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661101).  Saving model ...
Epoch: 13 cost time: 2.0401723384857178
Epoch: 13, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.910 Vali Acc: 0.689 Test Loss: 0.910 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688880).  Saving model ...
Epoch: 14 cost time: 1.7507596015930176
Epoch: 14, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.856 Vali Acc: 0.711 Test Loss: 0.856 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711103).  Saving model ...
Epoch: 15 cost time: 1.7616074085235596
Epoch: 15, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.803 Vali Acc: 0.711 Test Loss: 0.803 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 16 cost time: 2.0071730613708496
Epoch: 16, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.755 Vali Acc: 0.711 Test Loss: 0.755 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711104).  Saving model ...
Epoch: 17 cost time: 1.963346242904663
Epoch: 17, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
Validation loss decreased (-0.711104 --> -0.716660).  Saving model ...
Epoch: 18 cost time: 1.908073902130127
Epoch: 18, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.665 Vali Acc: 0.744 Test Loss: 0.665 Test Acc: 0.744
Validation loss decreased (-0.716660 --> -0.744438).  Saving model ...
Epoch: 19 cost time: 2.1415703296661377
Epoch: 19, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9041683673858643
Epoch: 20, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.596 Vali Acc: 0.739 Test Loss: 0.596 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9243202209472656
Epoch: 21, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.568 Vali Acc: 0.750 Test Loss: 0.568 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 2.0950562953948975
Epoch: 22, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 23 cost time: 2.0102498531341553
Epoch: 23, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.530 Vali Acc: 0.750 Test Loss: 0.530 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.023798942565918
Epoch: 24, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.501 Vali Acc: 0.761 Test Loss: 0.501 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 25 cost time: 2.182565927505493
Epoch: 25, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8572187423706055
Epoch: 26, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.510 Vali Acc: 0.739 Test Loss: 0.510 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0054235458374023
Epoch: 27, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.485 Vali Acc: 0.750 Test Loss: 0.485 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.164532423019409
Epoch: 28, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.454 Vali Acc: 0.800 Test Loss: 0.454 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799995).  Saving model ...
Epoch: 29 cost time: 2.0449912548065186
Epoch: 29, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.466 Vali Acc: 0.772 Test Loss: 0.466 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9675266742706299
Epoch: 30, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.490 Vali Acc: 0.767 Test Loss: 0.490 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 589766
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6465916633605957
Epoch: 1, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.898 Vali Acc: 0.144 Test Loss: 1.898 Test Acc: 0.144
Validation loss decreased (inf --> -0.144425).  Saving model ...
Epoch: 2 cost time: 1.7438585758209229
Epoch: 2, Steps: 12 | Train Loss: 1.834 Vali Loss: 1.835 Vali Acc: 0.178 Test Loss: 1.835 Test Acc: 0.178
Validation loss decreased (-0.144425 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 1.8145043849945068
Epoch: 3, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
Validation loss decreased (-0.177759 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.913315773010254
Epoch: 4, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.656 Vali Acc: 0.322 Test Loss: 1.656 Test Acc: 0.322
Validation loss decreased (-0.199982 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 1.7886536121368408
Epoch: 5, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.552 Vali Acc: 0.444 Test Loss: 1.552 Test Acc: 0.444
Validation loss decreased (-0.322206 --> -0.444429).  Saving model ...
Epoch: 6 cost time: 1.7949953079223633
Epoch: 6, Steps: 12 | Train Loss: 1.473 Vali Loss: 1.443 Vali Acc: 0.506 Test Loss: 1.443 Test Acc: 0.506
Validation loss decreased (-0.444429 --> -0.505541).  Saving model ...
Epoch: 7 cost time: 1.993283987045288
Epoch: 7, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.340 Vali Acc: 0.528 Test Loss: 1.340 Test Acc: 0.528
Validation loss decreased (-0.505541 --> -0.527764).  Saving model ...
Epoch: 8 cost time: 1.7771739959716797
Epoch: 8, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.244 Vali Acc: 0.567 Test Loss: 1.244 Test Acc: 0.567
Validation loss decreased (-0.527764 --> -0.566654).  Saving model ...
Epoch: 9 cost time: 1.721944808959961
Epoch: 9, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.158 Vali Acc: 0.594 Test Loss: 1.158 Test Acc: 0.594
Validation loss decreased (-0.566654 --> -0.594433).  Saving model ...
Epoch: 10 cost time: 1.94464111328125
Epoch: 10, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.594433 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.810331106185913
Epoch: 11, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.021 Vali Acc: 0.617 Test Loss: 1.021 Test Acc: 0.617
Validation loss decreased (-0.599989 --> -0.616656).  Saving model ...
Epoch: 12 cost time: 1.7766883373260498
Epoch: 12, Steps: 12 | Train Loss: 0.918 Vali Loss: 0.962 Vali Acc: 0.644 Test Loss: 0.962 Test Acc: 0.644
Validation loss decreased (-0.616656 --> -0.644435).  Saving model ...
Epoch: 13 cost time: 1.9248480796813965
Epoch: 13, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.911 Vali Acc: 0.650 Test Loss: 0.911 Test Acc: 0.650
Validation loss decreased (-0.644435 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 1.6962270736694336
Epoch: 14, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.864 Vali Acc: 0.650 Test Loss: 0.864 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 15 cost time: 1.7069995403289795
Epoch: 15, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.827 Vali Acc: 0.639 Test Loss: 0.827 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6187875270843506
Epoch: 16, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.794 Vali Acc: 0.644 Test Loss: 0.794 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6646728515625
Epoch: 17, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.764 Vali Acc: 0.672 Test Loss: 0.764 Test Acc: 0.672
Validation loss decreased (-0.649991 --> -0.672215).  Saving model ...
Epoch: 18 cost time: 1.6432313919067383
Epoch: 18, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.743 Vali Acc: 0.661 Test Loss: 0.743 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.830211877822876
Epoch: 19, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.719 Vali Acc: 0.661 Test Loss: 0.719 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8275158405303955
Epoch: 20, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.694 Vali Acc: 0.700 Test Loss: 0.694 Test Acc: 0.700
Validation loss decreased (-0.672215 --> -0.699993).  Saving model ...
Epoch: 21 cost time: 2.0770931243896484
Epoch: 21, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.673 Vali Acc: 0.678 Test Loss: 0.673 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7759599685668945
Epoch: 22, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.646 Vali Acc: 0.706 Test Loss: 0.646 Test Acc: 0.706
Validation loss decreased (-0.699993 --> -0.705549).  Saving model ...
Epoch: 23 cost time: 2.0202112197875977
Epoch: 23, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.610 Vali Acc: 0.739 Test Loss: 0.610 Test Acc: 0.739
Validation loss decreased (-0.705549 --> -0.738883).  Saving model ...
Epoch: 24 cost time: 1.780935287475586
Epoch: 24, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.581 Vali Acc: 0.733 Test Loss: 0.581 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9779260158538818
Epoch: 25, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.559 Vali Acc: 0.739 Test Loss: 0.559 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738883).  Saving model ...
Epoch: 26 cost time: 1.8046247959136963
Epoch: 26, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.540 Vali Acc: 0.744 Test Loss: 0.540 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744439).  Saving model ...
Epoch: 27 cost time: 1.8439443111419678
Epoch: 27, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.507 Vali Acc: 0.739 Test Loss: 0.507 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7729272842407227
Epoch: 28, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.507 Vali Acc: 0.750 Test Loss: 0.507 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 29 cost time: 1.7708303928375244
Epoch: 29, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.484 Vali Acc: 0.756 Test Loss: 0.484 Test Acc: 0.756
Validation loss decreased (-0.749995 --> -0.755551).  Saving model ...
Epoch: 30 cost time: 1.9219655990600586
Epoch: 30, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.466 Vali Acc: 0.772 Test Loss: 0.466 Test Acc: 0.772
Validation loss decreased (-0.755551 --> -0.772218).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 175750
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.023412704467773
Epoch: 1, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.853 Vali Acc: 0.150 Test Loss: 1.853 Test Acc: 0.150
Validation loss decreased (inf --> -0.149981).  Saving model ...
Epoch: 2 cost time: 3.25773549079895
Epoch: 2, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.809 Vali Acc: 0.206 Test Loss: 1.809 Test Acc: 0.206
Validation loss decreased (-0.149981 --> -0.205537).  Saving model ...
Epoch: 3 cost time: 3.2320024967193604
Epoch: 3, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.753 Vali Acc: 0.228 Test Loss: 1.753 Test Acc: 0.228
Validation loss decreased (-0.205537 --> -0.227760).  Saving model ...
Epoch: 4 cost time: 3.0248966217041016
Epoch: 4, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.686 Vali Acc: 0.256 Test Loss: 1.686 Test Acc: 0.256
Validation loss decreased (-0.227760 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 2.8793375492095947
Epoch: 5, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.616 Vali Acc: 0.322 Test Loss: 1.616 Test Acc: 0.322
Validation loss decreased (-0.255539 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 2.989938974380493
Epoch: 6, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.538 Vali Acc: 0.411 Test Loss: 1.538 Test Acc: 0.411
Validation loss decreased (-0.322206 --> -0.411096).  Saving model ...
Epoch: 7 cost time: 3.219961643218994
Epoch: 7, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.450 Vali Acc: 0.472 Test Loss: 1.450 Test Acc: 0.472
Validation loss decreased (-0.411096 --> -0.472208).  Saving model ...
Epoch: 8 cost time: 3.2001402378082275
Epoch: 8, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.353 Vali Acc: 0.528 Test Loss: 1.353 Test Acc: 0.528
Validation loss decreased (-0.472208 --> -0.527764).  Saving model ...
Epoch: 9 cost time: 2.879952907562256
Epoch: 9, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.260 Vali Acc: 0.556 Test Loss: 1.260 Test Acc: 0.556
Validation loss decreased (-0.527764 --> -0.555543).  Saving model ...
Epoch: 10 cost time: 2.942441701889038
Epoch: 10, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.164 Vali Acc: 0.589 Test Loss: 1.164 Test Acc: 0.589
Validation loss decreased (-0.555543 --> -0.588877).  Saving model ...
Epoch: 11 cost time: 3.0399386882781982
Epoch: 11, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.082 Vali Acc: 0.622 Test Loss: 1.082 Test Acc: 0.622
Validation loss decreased (-0.588877 --> -0.622211).  Saving model ...
Epoch: 12 cost time: 3.3091351985931396
Epoch: 12, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.008 Vali Acc: 0.611 Test Loss: 1.008 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.011932611465454
Epoch: 13, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.941 Vali Acc: 0.650 Test Loss: 0.941 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 2.7335333824157715
Epoch: 14, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.883 Vali Acc: 0.656 Test Loss: 0.883 Test Acc: 0.656
Validation loss decreased (-0.649991 --> -0.655547).  Saving model ...
Epoch: 15 cost time: 2.677992105484009
Epoch: 15, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.833 Vali Acc: 0.661 Test Loss: 0.833 Test Acc: 0.661
Validation loss decreased (-0.655547 --> -0.661103).  Saving model ...
Epoch: 16 cost time: 2.888986587524414
Epoch: 16, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.780 Vali Acc: 0.672 Test Loss: 0.780 Test Acc: 0.672
Validation loss decreased (-0.661103 --> -0.672214).  Saving model ...
Epoch: 17 cost time: 3.1132423877716064
Epoch: 17, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.738 Vali Acc: 0.689 Test Loss: 0.738 Test Acc: 0.689
Validation loss decreased (-0.672214 --> -0.688882).  Saving model ...
Epoch: 18 cost time: 2.8070125579833984
Epoch: 18, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.709 Vali Acc: 0.683 Test Loss: 0.709 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.639286994934082
Epoch: 19, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.673 Vali Acc: 0.700 Test Loss: 0.673 Test Acc: 0.700
Validation loss decreased (-0.688882 --> -0.699993).  Saving model ...
Epoch: 20 cost time: 2.372586250305176
Epoch: 20, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.653 Vali Acc: 0.733 Test Loss: 0.653 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733327).  Saving model ...
Epoch: 21 cost time: 2.9170491695404053
Epoch: 21, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.626 Vali Acc: 0.728 Test Loss: 0.626 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.954561471939087
Epoch: 22, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6090104579925537
Epoch: 23, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.587 Vali Acc: 0.733 Test Loss: 0.587 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 24 cost time: 2.732572078704834
Epoch: 24, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.568 Vali Acc: 0.744 Test Loss: 0.568 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 25 cost time: 2.821824550628662
Epoch: 25, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.551 Vali Acc: 0.739 Test Loss: 0.551 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.910172939300537
Epoch: 26, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.548 Vali Acc: 0.739 Test Loss: 0.548 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.925556182861328
Epoch: 27, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.536 Vali Acc: 0.744 Test Loss: 0.536 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744439).  Saving model ...
Epoch: 28 cost time: 2.9860334396362305
Epoch: 28, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.515 Vali Acc: 0.722 Test Loss: 0.515 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7605230808258057
Epoch: 29, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.501 Vali Acc: 0.756 Test Loss: 0.501 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755551).  Saving model ...
Epoch: 30 cost time: 2.787102699279785
Epoch: 30, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.517 Vali Acc: 0.750 Test Loss: 0.517 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 296518
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.364185810089111
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.834 Vali Acc: 0.150 Test Loss: 1.834 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 2.4557735919952393
Epoch: 2, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.785 Vali Acc: 0.172 Test Loss: 1.785 Test Acc: 0.172
Validation loss decreased (-0.149982 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 2.4602248668670654
Epoch: 3, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.720 Vali Acc: 0.183 Test Loss: 1.720 Test Acc: 0.183
Validation loss decreased (-0.172204 --> -0.183316).  Saving model ...
Epoch: 4 cost time: 2.4843297004699707
Epoch: 4, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.643 Vali Acc: 0.222 Test Loss: 1.643 Test Acc: 0.222
Validation loss decreased (-0.183316 --> -0.222206).  Saving model ...
Epoch: 5 cost time: 2.593158721923828
Epoch: 5, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.560 Vali Acc: 0.322 Test Loss: 1.560 Test Acc: 0.322
Validation loss decreased (-0.222206 --> -0.322207).  Saving model ...
Epoch: 6 cost time: 2.6136484146118164
Epoch: 6, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.470 Vali Acc: 0.494 Test Loss: 1.470 Test Acc: 0.494
Validation loss decreased (-0.322207 --> -0.494430).  Saving model ...
Epoch: 7 cost time: 2.6093733310699463
Epoch: 7, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.377 Vali Acc: 0.572 Test Loss: 1.377 Test Acc: 0.572
Validation loss decreased (-0.494430 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 2.600010871887207
Epoch: 8, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.282 Vali Acc: 0.606 Test Loss: 1.282 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 2.6081414222717285
Epoch: 9, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.187 Vali Acc: 0.656 Test Loss: 1.187 Test Acc: 0.656
Validation loss decreased (-0.605543 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 2.617302179336548
Epoch: 10, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.103 Vali Acc: 0.661 Test Loss: 1.103 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 11 cost time: 2.5937676429748535
Epoch: 11, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.018 Vali Acc: 0.700 Test Loss: 1.018 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 2.5093789100646973
Epoch: 12, Steps: 12 | Train Loss: 0.955 Vali Loss: 0.943 Vali Acc: 0.717 Test Loss: 0.943 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 2.4676456451416016
Epoch: 13, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.883 Vali Acc: 0.722 Test Loss: 0.883 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 2.4843297004699707
Epoch: 14, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 2.4226737022399902
Epoch: 15, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.781 Vali Acc: 0.733 Test Loss: 0.781 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 2.447681427001953
Epoch: 16, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.746 Vali Acc: 0.722 Test Loss: 0.746 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.418335437774658
Epoch: 17, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.710 Vali Acc: 0.722 Test Loss: 0.710 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3257102966308594
Epoch: 18, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.679 Vali Acc: 0.761 Test Loss: 0.679 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761104).  Saving model ...
Epoch: 19 cost time: 2.3161168098449707
Epoch: 19, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.651 Vali Acc: 0.778 Test Loss: 0.651 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 2.3423073291778564
Epoch: 20, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.323345422744751
Epoch: 21, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.229315757751465
Epoch: 22, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.396467447280884
Epoch: 23, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.567 Vali Acc: 0.750 Test Loss: 0.567 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.406775712966919
Epoch: 24, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.548 Vali Acc: 0.767 Test Loss: 0.548 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.413054943084717
Epoch: 25, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788883).  Saving model ...
Epoch: 26 cost time: 2.276777982711792
Epoch: 26, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.539 Vali Acc: 0.772 Test Loss: 0.539 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0796563625335693
Epoch: 27, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.532 Vali Acc: 0.756 Test Loss: 0.532 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.091388702392578
Epoch: 28, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.534 Vali Acc: 0.750 Test Loss: 0.534 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.131500482559204
Epoch: 29, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.534 Vali Acc: 0.767 Test Loss: 0.534 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2728450298309326
Epoch: 30, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.531 Vali Acc: 0.767 Test Loss: 0.531 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 89478
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.291623830795288
Epoch: 1, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.853 Vali Acc: 0.150 Test Loss: 1.853 Test Acc: 0.150
Validation loss decreased (inf --> -0.149981).  Saving model ...
Epoch: 2 cost time: 2.3490443229675293
Epoch: 2, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.809 Vali Acc: 0.206 Test Loss: 1.809 Test Acc: 0.206
Validation loss decreased (-0.149981 --> -0.205537).  Saving model ...
Epoch: 3 cost time: 2.422842264175415
Epoch: 3, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.753 Vali Acc: 0.228 Test Loss: 1.753 Test Acc: 0.228
Validation loss decreased (-0.205537 --> -0.227760).  Saving model ...
Epoch: 4 cost time: 2.3552298545837402
Epoch: 4, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.686 Vali Acc: 0.256 Test Loss: 1.686 Test Acc: 0.256
Validation loss decreased (-0.227760 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 2.3242971897125244
Epoch: 5, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.616 Vali Acc: 0.322 Test Loss: 1.616 Test Acc: 0.322
Validation loss decreased (-0.255539 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 2.3222475051879883
Epoch: 6, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.538 Vali Acc: 0.411 Test Loss: 1.538 Test Acc: 0.411
Validation loss decreased (-0.322206 --> -0.411096).  Saving model ...
Epoch: 7 cost time: 2.420562505722046
Epoch: 7, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.450 Vali Acc: 0.472 Test Loss: 1.450 Test Acc: 0.472
Validation loss decreased (-0.411096 --> -0.472208).  Saving model ...
Epoch: 8 cost time: 2.5645503997802734
Epoch: 8, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.353 Vali Acc: 0.528 Test Loss: 1.353 Test Acc: 0.528
Validation loss decreased (-0.472208 --> -0.527764).  Saving model ...
Epoch: 9 cost time: 2.532616376876831
Epoch: 9, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.260 Vali Acc: 0.556 Test Loss: 1.260 Test Acc: 0.556
Validation loss decreased (-0.527764 --> -0.555543).  Saving model ...
Epoch: 10 cost time: 2.3870127201080322
Epoch: 10, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.164 Vali Acc: 0.589 Test Loss: 1.164 Test Acc: 0.589
Validation loss decreased (-0.555543 --> -0.588877).  Saving model ...
Epoch: 11 cost time: 2.3158535957336426
Epoch: 11, Steps: 12 | Train Loss: 1.056 Vali Loss: 1.081 Vali Acc: 0.622 Test Loss: 1.081 Test Acc: 0.622
Validation loss decreased (-0.588877 --> -0.622211).  Saving model ...
Epoch: 12 cost time: 2.376168727874756
Epoch: 12, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.007 Vali Acc: 0.611 Test Loss: 1.007 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.412036180496216
Epoch: 13, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.941 Vali Acc: 0.650 Test Loss: 0.941 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649991).  Saving model ...
Epoch: 14 cost time: 2.2872912883758545
Epoch: 14, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.882 Vali Acc: 0.661 Test Loss: 0.882 Test Acc: 0.661
Validation loss decreased (-0.649991 --> -0.661102).  Saving model ...
Epoch: 15 cost time: 2.3058786392211914
Epoch: 15, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.832 Vali Acc: 0.661 Test Loss: 0.832 Test Acc: 0.661
Validation loss decreased (-0.661102 --> -0.661103).  Saving model ...
Epoch: 16 cost time: 2.331176280975342
Epoch: 16, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.780 Vali Acc: 0.672 Test Loss: 0.780 Test Acc: 0.672
Validation loss decreased (-0.661103 --> -0.672214).  Saving model ...
Epoch: 17 cost time: 2.2992665767669678
Epoch: 17, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.738 Vali Acc: 0.689 Test Loss: 0.738 Test Acc: 0.689
Validation loss decreased (-0.672214 --> -0.688882).  Saving model ...
Epoch: 18 cost time: 2.2309069633483887
Epoch: 18, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.708 Vali Acc: 0.689 Test Loss: 0.708 Test Acc: 0.689
Validation loss decreased (-0.688882 --> -0.688882).  Saving model ...
Epoch: 19 cost time: 2.139755964279175
Epoch: 19, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.672 Vali Acc: 0.700 Test Loss: 0.672 Test Acc: 0.700
Validation loss decreased (-0.688882 --> -0.699993).  Saving model ...
Epoch: 20 cost time: 2.1914467811584473
Epoch: 20, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.652 Vali Acc: 0.728 Test Loss: 0.652 Test Acc: 0.728
Validation loss decreased (-0.699993 --> -0.727771).  Saving model ...
Epoch: 21 cost time: 2.239776611328125
Epoch: 21, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.625 Vali Acc: 0.728 Test Loss: 0.625 Test Acc: 0.728
Validation loss decreased (-0.727771 --> -0.727772).  Saving model ...
Epoch: 22 cost time: 2.247286796569824
Epoch: 22, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.601 Vali Acc: 0.728 Test Loss: 0.601 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727772).  Saving model ...
Epoch: 23 cost time: 2.4586522579193115
Epoch: 23, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.586 Vali Acc: 0.728 Test Loss: 0.586 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727772).  Saving model ...
Epoch: 24 cost time: 2.3415262699127197
Epoch: 24, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.566 Vali Acc: 0.744 Test Loss: 0.566 Test Acc: 0.744
Validation loss decreased (-0.727772 --> -0.744439).  Saving model ...
Epoch: 25 cost time: 2.128138303756714
Epoch: 25, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.550 Vali Acc: 0.739 Test Loss: 0.550 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2870607376098633
Epoch: 26, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.546 Vali Acc: 0.744 Test Loss: 0.546 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744439).  Saving model ...
Epoch: 27 cost time: 2.4232263565063477
Epoch: 27, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.534 Vali Acc: 0.744 Test Loss: 0.534 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744439).  Saving model ...
Epoch: 28 cost time: 2.374999761581421
Epoch: 28, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.515 Vali Acc: 0.728 Test Loss: 0.515 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1914947032928467
Epoch: 29, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.506 Vali Acc: 0.756 Test Loss: 0.506 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755550).  Saving model ...
Epoch: 30 cost time: 2.305269956588745
Epoch: 30, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.517 Vali Acc: 0.756 Test Loss: 0.517 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 296518
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9253194332122803
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.834 Vali Acc: 0.150 Test Loss: 1.834 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 2.102027177810669
Epoch: 2, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.785 Vali Acc: 0.172 Test Loss: 1.785 Test Acc: 0.172
Validation loss decreased (-0.149982 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 2.095881462097168
Epoch: 3, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.720 Vali Acc: 0.183 Test Loss: 1.720 Test Acc: 0.183
Validation loss decreased (-0.172204 --> -0.183316).  Saving model ...
Epoch: 4 cost time: 2.0791103839874268
Epoch: 4, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.643 Vali Acc: 0.222 Test Loss: 1.643 Test Acc: 0.222
Validation loss decreased (-0.183316 --> -0.222206).  Saving model ...
Epoch: 5 cost time: 2.0331013202667236
Epoch: 5, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.560 Vali Acc: 0.322 Test Loss: 1.560 Test Acc: 0.322
Validation loss decreased (-0.222206 --> -0.322207).  Saving model ...
Epoch: 6 cost time: 2.2625718116760254
Epoch: 6, Steps: 12 | Train Loss: 1.491 Vali Loss: 1.470 Vali Acc: 0.494 Test Loss: 1.470 Test Acc: 0.494
Validation loss decreased (-0.322207 --> -0.494430).  Saving model ...
Epoch: 7 cost time: 2.085256338119507
Epoch: 7, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.377 Vali Acc: 0.572 Test Loss: 1.377 Test Acc: 0.572
Validation loss decreased (-0.494430 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 2.0918126106262207
Epoch: 8, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.282 Vali Acc: 0.606 Test Loss: 1.282 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605543).  Saving model ...
Epoch: 9 cost time: 2.1880788803100586
Epoch: 9, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.187 Vali Acc: 0.656 Test Loss: 1.187 Test Acc: 0.656
Validation loss decreased (-0.605543 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 2.0900673866271973
Epoch: 10, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.103 Vali Acc: 0.661 Test Loss: 1.103 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 11 cost time: 2.0830435752868652
Epoch: 11, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 2.1589853763580322
Epoch: 12, Steps: 12 | Train Loss: 0.955 Vali Loss: 0.943 Vali Acc: 0.717 Test Loss: 0.943 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 2.107297658920288
Epoch: 13, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.883 Vali Acc: 0.722 Test Loss: 0.883 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 2.067035675048828
Epoch: 14, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 2.076249837875366
Epoch: 15, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.781 Vali Acc: 0.733 Test Loss: 0.781 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 2.0618810653686523
Epoch: 16, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.746 Vali Acc: 0.722 Test Loss: 0.746 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0617289543151855
Epoch: 17, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.710 Vali Acc: 0.722 Test Loss: 0.710 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1039557456970215
Epoch: 18, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.679 Vali Acc: 0.761 Test Loss: 0.679 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761104).  Saving model ...
Epoch: 19 cost time: 2.0621612071990967
Epoch: 19, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.651 Vali Acc: 0.778 Test Loss: 0.651 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 2.09363055229187
Epoch: 20, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0575644969940186
Epoch: 21, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1075894832611084
Epoch: 22, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0654311180114746
Epoch: 23, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.567 Vali Acc: 0.756 Test Loss: 0.567 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.021134853363037
Epoch: 24, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.549 Vali Acc: 0.767 Test Loss: 0.549 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.129966974258423
Epoch: 25, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788883).  Saving model ...
Epoch: 26 cost time: 2.1579325199127197
Epoch: 26, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.540 Vali Acc: 0.772 Test Loss: 0.540 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.034255027770996
Epoch: 27, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.080951690673828
Epoch: 28, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.535 Vali Acc: 0.750 Test Loss: 0.535 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0217761993408203
Epoch: 29, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.535 Vali Acc: 0.767 Test Loss: 0.535 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0737905502319336
Epoch: 30, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.531 Vali Acc: 0.767 Test Loss: 0.531 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 89478
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.560410499572754
Epoch: 1, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.854 Vali Acc: 0.156 Test Loss: 1.854 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 2.1093590259552
Epoch: 2, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.810 Vali Acc: 0.206 Test Loss: 1.810 Test Acc: 0.206
Validation loss decreased (-0.155537 --> -0.205537).  Saving model ...
Epoch: 3 cost time: 1.9646949768066406
Epoch: 3, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.754 Vali Acc: 0.222 Test Loss: 1.754 Test Acc: 0.222
Validation loss decreased (-0.205537 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 2.1529572010040283
Epoch: 4, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.688 Vali Acc: 0.261 Test Loss: 1.688 Test Acc: 0.261
Validation loss decreased (-0.222205 --> -0.261094).  Saving model ...
Epoch: 5 cost time: 1.8563873767852783
Epoch: 5, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.619 Vali Acc: 0.322 Test Loss: 1.619 Test Acc: 0.322
Validation loss decreased (-0.261094 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 1.9339807033538818
Epoch: 6, Steps: 12 | Train Loss: 1.564 Vali Loss: 1.542 Vali Acc: 0.394 Test Loss: 1.542 Test Acc: 0.394
Validation loss decreased (-0.322206 --> -0.394429).  Saving model ...
Epoch: 7 cost time: 1.9538028240203857
Epoch: 7, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.456 Vali Acc: 0.439 Test Loss: 1.456 Test Acc: 0.439
Validation loss decreased (-0.394429 --> -0.438874).  Saving model ...
Epoch: 8 cost time: 1.9521615505218506
Epoch: 8, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.360 Vali Acc: 0.517 Test Loss: 1.360 Test Acc: 0.517
Validation loss decreased (-0.438874 --> -0.516653).  Saving model ...
Epoch: 9 cost time: 2.059143543243408
Epoch: 9, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.267 Vali Acc: 0.544 Test Loss: 1.267 Test Acc: 0.544
Validation loss decreased (-0.516653 --> -0.544432).  Saving model ...
Epoch: 10 cost time: 1.9127554893493652
Epoch: 10, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.172 Vali Acc: 0.589 Test Loss: 1.172 Test Acc: 0.589
Validation loss decreased (-0.544432 --> -0.588877).  Saving model ...
Epoch: 11 cost time: 2.113502025604248
Epoch: 11, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.088 Vali Acc: 0.622 Test Loss: 1.088 Test Acc: 0.622
Validation loss decreased (-0.588877 --> -0.622211).  Saving model ...
Epoch: 12 cost time: 1.890751838684082
Epoch: 12, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.012 Vali Acc: 0.611 Test Loss: 1.012 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.106321096420288
Epoch: 13, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.942 Vali Acc: 0.628 Test Loss: 0.942 Test Acc: 0.628
Validation loss decreased (-0.622211 --> -0.627768).  Saving model ...
Epoch: 14 cost time: 1.8606343269348145
Epoch: 14, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.881 Vali Acc: 0.661 Test Loss: 0.881 Test Acc: 0.661
Validation loss decreased (-0.627768 --> -0.661102).  Saving model ...
Epoch: 15 cost time: 1.848679780960083
Epoch: 15, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.829 Vali Acc: 0.672 Test Loss: 0.829 Test Acc: 0.672
Validation loss decreased (-0.661102 --> -0.672214).  Saving model ...
Epoch: 16 cost time: 2.1370179653167725
Epoch: 16, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.783 Vali Acc: 0.672 Test Loss: 0.783 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672214).  Saving model ...
Epoch: 17 cost time: 1.856152057647705
Epoch: 17, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.738 Vali Acc: 0.706 Test Loss: 0.738 Test Acc: 0.706
Validation loss decreased (-0.672214 --> -0.705548).  Saving model ...
Epoch: 18 cost time: 2.182286500930786
Epoch: 18, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.708 Vali Acc: 0.706 Test Loss: 0.708 Test Acc: 0.706
Validation loss decreased (-0.705548 --> -0.705548).  Saving model ...
Epoch: 19 cost time: 1.8315694332122803
Epoch: 19, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.683 Vali Acc: 0.722 Test Loss: 0.683 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722215).  Saving model ...
Epoch: 20 cost time: 2.0632734298706055
Epoch: 20, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.939915418624878
Epoch: 21, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.628 Vali Acc: 0.744 Test Loss: 0.628 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 22 cost time: 1.9184226989746094
Epoch: 22, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.605 Vali Acc: 0.739 Test Loss: 0.605 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.713862657546997
Epoch: 23, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.591 Vali Acc: 0.744 Test Loss: 0.591 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744439).  Saving model ...
Epoch: 24 cost time: 1.6740028858184814
Epoch: 24, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.574 Vali Acc: 0.739 Test Loss: 0.574 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.92966890335083
Epoch: 25, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.557 Vali Acc: 0.761 Test Loss: 0.557 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 26 cost time: 1.7132580280303955
Epoch: 26, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.544 Vali Acc: 0.767 Test Loss: 0.544 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766661).  Saving model ...
Epoch: 27 cost time: 1.8993704319000244
Epoch: 27, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.531 Vali Acc: 0.767 Test Loss: 0.531 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 28 cost time: 1.6994807720184326
Epoch: 28, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.518 Vali Acc: 0.756 Test Loss: 0.518 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9476780891418457
Epoch: 29, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.508 Vali Acc: 0.761 Test Loss: 0.508 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8662447929382324
Epoch: 30, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.507 Vali Acc: 0.761 Test Loss: 0.507 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 296518
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.63598895072937
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.836 Vali Acc: 0.150 Test Loss: 1.836 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 1.5594451427459717
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.788 Vali Acc: 0.178 Test Loss: 1.788 Test Acc: 0.178
Validation loss decreased (-0.149982 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.8455924987792969
Epoch: 3, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.724 Vali Acc: 0.183 Test Loss: 1.724 Test Acc: 0.183
Validation loss decreased (-0.177760 --> -0.183316).  Saving model ...
Epoch: 4 cost time: 1.6884582042694092
Epoch: 4, Steps: 12 | Train Loss: 1.624 Vali Loss: 1.649 Vali Acc: 0.222 Test Loss: 1.649 Test Acc: 0.222
Validation loss decreased (-0.183316 --> -0.222206).  Saving model ...
Epoch: 5 cost time: 1.7830071449279785
Epoch: 5, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.568 Vali Acc: 0.306 Test Loss: 1.568 Test Acc: 0.306
Validation loss decreased (-0.222206 --> -0.305540).  Saving model ...
Epoch: 6 cost time: 1.6949856281280518
Epoch: 6, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.480 Vali Acc: 0.494 Test Loss: 1.480 Test Acc: 0.494
Validation loss decreased (-0.305540 --> -0.494430).  Saving model ...
Epoch: 7 cost time: 1.5727314949035645
Epoch: 7, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.388 Vali Acc: 0.583 Test Loss: 1.388 Test Acc: 0.583
Validation loss decreased (-0.494430 --> -0.583319).  Saving model ...
Epoch: 8 cost time: 1.6287281513214111
Epoch: 8, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.293 Vali Acc: 0.617 Test Loss: 1.293 Test Acc: 0.617
Validation loss decreased (-0.583319 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 1.2895171642303467
Epoch: 9, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.196 Vali Acc: 0.656 Test Loss: 1.196 Test Acc: 0.656
Validation loss decreased (-0.616654 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 1.8362836837768555
Epoch: 10, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.112 Vali Acc: 0.672 Test Loss: 1.112 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 1.818065881729126
Epoch: 11, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.6060094833374023
Epoch: 12, Steps: 12 | Train Loss: 0.958 Vali Loss: 0.948 Vali Acc: 0.722 Test Loss: 0.948 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.696579933166504
Epoch: 13, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 1.6314778327941895
Epoch: 14, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.827 Vali Acc: 0.733 Test Loss: 0.827 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 1.6708965301513672
Epoch: 15, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.778 Vali Acc: 0.733 Test Loss: 0.778 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 1.669769048690796
Epoch: 16, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738881).  Saving model ...
Epoch: 17 cost time: 1.7872917652130127
Epoch: 17, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.702 Vali Acc: 0.744 Test Loss: 0.702 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 18 cost time: 1.7082953453063965
Epoch: 18, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 19 cost time: 1.7211449146270752
Epoch: 19, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 20 cost time: 1.8487768173217773
Epoch: 20, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.603 Vali Acc: 0.750 Test Loss: 0.603 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7476813793182373
Epoch: 21, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.575 Vali Acc: 0.756 Test Loss: 0.575 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6527259349822998
Epoch: 22, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.544 Vali Acc: 0.772 Test Loss: 0.544 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 23 cost time: 1.8729887008666992
Epoch: 23, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.519 Vali Acc: 0.761 Test Loss: 0.519 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7351245880126953
Epoch: 24, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.498 Vali Acc: 0.772 Test Loss: 0.498 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 25 cost time: 1.7342207431793213
Epoch: 25, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.480 Vali Acc: 0.778 Test Loss: 0.480 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 26 cost time: 1.8909797668457031
Epoch: 26, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
Validation loss decreased (-0.777773 --> -0.799995).  Saving model ...
Epoch: 27 cost time: 1.7665603160858154
Epoch: 27, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.456 Vali Acc: 0.800 Test Loss: 0.456 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 28 cost time: 1.7191240787506104
Epoch: 28, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.446 Vali Acc: 0.794 Test Loss: 0.446 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8556761741638184
Epoch: 29, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.438 Vali Acc: 0.789 Test Loss: 0.438 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7425477504730225
Epoch: 30, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.427 Vali Acc: 0.783 Test Loss: 0.427 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 89478
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 18.61888861656189
Epoch: 1, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.459 Vali Acc: 0.506 Test Loss: 1.459 Test Acc: 0.506
Validation loss decreased (inf --> -0.505541).  Saving model ...
Epoch: 2 cost time: 17.192514181137085
Epoch: 2, Steps: 12 | Train Loss: 1.220 Vali Loss: 0.956 Vali Acc: 0.722 Test Loss: 0.956 Test Acc: 0.722
Validation loss decreased (-0.505541 --> -0.722213).  Saving model ...
Epoch: 3 cost time: 17.131842613220215
Epoch: 3, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.623 Vali Acc: 0.778 Test Loss: 0.623 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777772).  Saving model ...
Epoch: 4 cost time: 16.5691077709198
Epoch: 4, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.467 Vali Acc: 0.794 Test Loss: 0.467 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 17.03991174697876
Epoch: 5, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 17.411551237106323
Epoch: 6, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.346 Vali Acc: 0.828 Test Loss: 0.346 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 17.633378505706787
Epoch: 7, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.357 Vali Acc: 0.833 Test Loss: 0.357 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 17.56991195678711
Epoch: 8, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 16.193599939346313
Epoch: 9, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
Validation loss decreased (-0.838886 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 15.937682628631592
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.26946759223938
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.26380753517151
Epoch: 12, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.345 Vali Acc: 0.883 Test Loss: 0.345 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 15.751474857330322
Epoch: 13, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.365 Vali Acc: 0.856 Test Loss: 0.365 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.786624908447266
Epoch: 14, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 16.927529096603394
Epoch: 15, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.261 Vali Acc: 0.867 Test Loss: 0.261 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.079132080078125
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
Validation loss decreased (-0.883331 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 16.66613268852234
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 16.649503707885742
Epoch: 18, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.202 Vali Acc: 0.900 Test Loss: 0.202 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.101208925247192
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 16.92214560508728
Epoch: 20, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.352 Vali Acc: 0.878 Test Loss: 0.352 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 16.451139450073242
Epoch: 21, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.314 Vali Acc: 0.917 Test Loss: 0.314 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 22 cost time: 16.49051070213318
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 16.621084451675415
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 16.37953758239746
Epoch: 24, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 16.616559982299805
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
Validation loss decreased (-0.927776 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 15.255735158920288
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 14.672142744064331
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.462 Vali Acc: 0.894 Test Loss: 0.462 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 13.736609935760498
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 15.189180612564087
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.123 Vali Acc: 0.956 Test Loss: 0.123 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 15.821161985397339
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 56285958
model size : 217.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.14823579788208
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.509 Vali Acc: 0.439 Test Loss: 1.509 Test Acc: 0.439
Validation loss decreased (inf --> -0.438874).  Saving model ...
Epoch: 2 cost time: 5.497169494628906
Epoch: 2, Steps: 12 | Train Loss: 1.260 Vali Loss: 0.955 Vali Acc: 0.756 Test Loss: 0.955 Test Acc: 0.756
Validation loss decreased (-0.438874 --> -0.755546).  Saving model ...
Epoch: 3 cost time: 5.509380102157593
Epoch: 3, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.615 Vali Acc: 0.761 Test Loss: 0.615 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761105).  Saving model ...
Epoch: 4 cost time: 5.547913551330566
Epoch: 4, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.457 Vali Acc: 0.767 Test Loss: 0.457 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 5.564607858657837
Epoch: 5, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.401 Vali Acc: 0.800 Test Loss: 0.401 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 5.444930791854858
Epoch: 6, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 5.469015121459961
Epoch: 7, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.548792839050293
Epoch: 8, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.548357248306274
Epoch: 9, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.392784833908081
Epoch: 10, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.388 Vali Acc: 0.861 Test Loss: 0.388 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 5.292649984359741
Epoch: 11, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.702 Vali Acc: 0.817 Test Loss: 0.702 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.387001991271973
Epoch: 12, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.235 Vali Acc: 0.878 Test Loss: 0.235 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 6.4070518016815186
Epoch: 13, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
Validation loss decreased (-0.877775 --> -0.938887).  Saving model ...
Epoch: 14 cost time: 6.247808933258057
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.229780435562134
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.922 Test Loss: 0.157 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.32391357421875
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.109 Vali Acc: 0.944 Test Loss: 0.109 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 5.951099634170532
Epoch: 17, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 5.831512451171875
Epoch: 18, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.763818979263306
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.151 Vali Acc: 0.933 Test Loss: 0.151 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.758997917175293
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.501 Vali Acc: 0.922 Test Loss: 0.501 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.750197172164917
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.729907035827637
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.667561054229736
Epoch: 23, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.721660852432251
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.692599296569824
Epoch: 25, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.610240459442139
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.439860820770264
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
Validation loss decreased (-0.955554 --> -0.961110).  Saving model ...
Epoch: 28 cost time: 5.830794095993042
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.922 Test Loss: 0.345 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.722134590148926
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.781537771224976
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.124 Vali Acc: 0.961 Test Loss: 0.124 Test Acc: 0.961
Validation loss decreased (-0.961110 --> -0.961110).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 16568838
model size : 65.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 14.051527500152588
Epoch: 1, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.459 Vali Acc: 0.506 Test Loss: 1.459 Test Acc: 0.506
Validation loss decreased (inf --> -0.505541).  Saving model ...
Epoch: 2 cost time: 12.597989320755005
Epoch: 2, Steps: 12 | Train Loss: 1.220 Vali Loss: 0.956 Vali Acc: 0.722 Test Loss: 0.956 Test Acc: 0.722
Validation loss decreased (-0.505541 --> -0.722213).  Saving model ...
Epoch: 3 cost time: 11.721280097961426
Epoch: 3, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.623 Vali Acc: 0.778 Test Loss: 0.623 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777772).  Saving model ...
Epoch: 4 cost time: 13.01849365234375
Epoch: 4, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.467 Vali Acc: 0.794 Test Loss: 0.467 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 5 cost time: 11.177451133728027
Epoch: 5, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 12.870574474334717
Epoch: 6, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.347 Vali Acc: 0.828 Test Loss: 0.347 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 13.093246221542358
Epoch: 7, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.358 Vali Acc: 0.833 Test Loss: 0.358 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 8 cost time: 13.164534568786621
Epoch: 8, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.309 Vali Acc: 0.839 Test Loss: 0.309 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 9 cost time: 13.02510404586792
Epoch: 9, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.838886 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 12.936960935592651
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.94506573677063
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.220335245132446
Epoch: 12, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 13.450050115585327
Epoch: 13, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.387 Vali Acc: 0.856 Test Loss: 0.387 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.294205904006958
Epoch: 14, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.28701376914978
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.260 Vali Acc: 0.867 Test Loss: 0.260 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.68422818183899
Epoch: 16, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 11.472154140472412
Epoch: 17, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.137298583984375
Epoch: 18, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.240 Vali Acc: 0.867 Test Loss: 0.240 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.03410005569458
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.328 Vali Acc: 0.917 Test Loss: 0.328 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916663).  Saving model ...
Epoch: 20 cost time: 13.30300784111023
Epoch: 20, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.436 Vali Acc: 0.878 Test Loss: 0.436 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.923991918563843
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.916663 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 13.239094734191895
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.362 Vali Acc: 0.861 Test Loss: 0.362 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.971232652664185
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.896421194076538
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 11.921038150787354
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 12.074454069137573
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.459 Vali Acc: 0.894 Test Loss: 0.459 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.441169738769531
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 12.808754444122314
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.330 Vali Acc: 0.939 Test Loss: 0.330 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 13.856414079666138
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 13.607620239257812
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.961 Test Loss: 0.088 Test Acc: 0.961
Validation loss decreased (-0.949998 --> -0.961110).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 56285958
model size : 217.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.299609899520874
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.509 Vali Acc: 0.439 Test Loss: 1.509 Test Acc: 0.439
Validation loss decreased (inf --> -0.438874).  Saving model ...
Epoch: 2 cost time: 4.369673013687134
Epoch: 2, Steps: 12 | Train Loss: 1.260 Vali Loss: 0.955 Vali Acc: 0.756 Test Loss: 0.955 Test Acc: 0.756
Validation loss decreased (-0.438874 --> -0.755546).  Saving model ...
Epoch: 3 cost time: 4.5313074588775635
Epoch: 3, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.615 Vali Acc: 0.761 Test Loss: 0.615 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761105).  Saving model ...
Epoch: 4 cost time: 4.530061721801758
Epoch: 4, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.457 Vali Acc: 0.767 Test Loss: 0.457 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 4.349288463592529
Epoch: 5, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.401 Vali Acc: 0.800 Test Loss: 0.401 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 4.596726655960083
Epoch: 6, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.318 Vali Acc: 0.844 Test Loss: 0.318 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 4.471047401428223
Epoch: 7, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.291 Vali Acc: 0.839 Test Loss: 0.291 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.24500298500061
Epoch: 8, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.52607274055481
Epoch: 9, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.705259084701538
Epoch: 10, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.389 Vali Acc: 0.861 Test Loss: 0.389 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 4.363415956497192
Epoch: 11, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.702 Vali Acc: 0.811 Test Loss: 0.702 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.41168737411499
Epoch: 12, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.236 Vali Acc: 0.878 Test Loss: 0.236 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 4.495285987854004
Epoch: 13, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.223 Vali Acc: 0.939 Test Loss: 0.223 Test Acc: 0.939
Validation loss decreased (-0.877775 --> -0.938887).  Saving model ...
Epoch: 14 cost time: 4.394061326980591
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.333448171615601
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.922 Test Loss: 0.157 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.356215953826904
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.110 Vali Acc: 0.944 Test Loss: 0.110 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 4.280109882354736
Epoch: 17, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 4.1142706871032715
Epoch: 18, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.1954286098480225
Epoch: 19, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.158 Vali Acc: 0.933 Test Loss: 0.158 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.372298240661621
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.495 Vali Acc: 0.917 Test Loss: 0.495 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.228680372238159
Epoch: 21, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.119242906570435
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.0046210289001465
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.9727275371551514
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.879453182220459
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.363982200622559
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 4.280198574066162
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.140962839126587
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.955554 --> -0.972221).  Saving model ...
Epoch: 29 cost time: 4.220496416091919
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.404149532318115
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9722222222222222
model parameter : 16568838
model size : 65.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.500277757644653
Epoch: 1, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
Validation loss decreased (inf --> -0.499985).  Saving model ...
Epoch: 2 cost time: 6.593876600265503
Epoch: 2, Steps: 12 | Train Loss: 1.220 Vali Loss: 0.973 Vali Acc: 0.711 Test Loss: 0.973 Test Acc: 0.711
Validation loss decreased (-0.499985 --> -0.711101).  Saving model ...
Epoch: 3 cost time: 6.369191646575928
Epoch: 3, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.647 Vali Acc: 0.767 Test Loss: 0.647 Test Acc: 0.767
Validation loss decreased (-0.711101 --> -0.766660).  Saving model ...
Epoch: 4 cost time: 6.260560989379883
Epoch: 4, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.495 Vali Acc: 0.778 Test Loss: 0.495 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 6.225398063659668
Epoch: 5, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.431 Vali Acc: 0.783 Test Loss: 0.431 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 6.158531665802002
Epoch: 6, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 7 cost time: 6.708025932312012
Epoch: 7, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.377 Vali Acc: 0.822 Test Loss: 0.377 Test Acc: 0.822
Validation loss decreased (-0.816663 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 6.752864360809326
Epoch: 8, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.323 Vali Acc: 0.833 Test Loss: 0.323 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 6.63057279586792
Epoch: 9, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.301 Vali Acc: 0.872 Test Loss: 0.301 Test Acc: 0.872
Validation loss decreased (-0.833330 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 6.193310976028442
Epoch: 10, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.376 Vali Acc: 0.856 Test Loss: 0.376 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.773393869400024
Epoch: 11, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.498507261276245
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888885).  Saving model ...
Epoch: 13 cost time: 6.556180477142334
Epoch: 13, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.991429805755615
Epoch: 14, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.474262475967407
Epoch: 15, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.360 Vali Acc: 0.872 Test Loss: 0.360 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.320373058319092
Epoch: 16, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
Validation loss decreased (-0.888885 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 6.446784257888794
Epoch: 17, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.613 Vali Acc: 0.861 Test Loss: 0.613 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.382262945175171
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.489854574203491
Epoch: 19, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.520077466964722
Epoch: 20, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.520127773284912
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.605394124984741
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.540017604827881
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.407 Vali Acc: 0.928 Test Loss: 0.407 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927774).  Saving model ...
Epoch: 24 cost time: 6.613871097564697
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.689544439315796
Epoch: 25, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.397833585739136
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.863150596618652
Epoch: 27, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
Validation loss decreased (-0.927774 --> -0.927775).  Saving model ...
Epoch: 28 cost time: 5.6802449226379395
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 5.4894819259643555
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 5.462437868118286
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.423 Vali Acc: 0.894 Test Loss: 0.423 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 56285958
model size : 217.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.577929258346558
Epoch: 1, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.522 Vali Acc: 0.422 Test Loss: 1.522 Test Acc: 0.422
Validation loss decreased (inf --> -0.422207).  Saving model ...
Epoch: 2 cost time: 2.8121066093444824
Epoch: 2, Steps: 12 | Train Loss: 1.260 Vali Loss: 0.984 Vali Acc: 0.739 Test Loss: 0.984 Test Acc: 0.739
Validation loss decreased (-0.422207 --> -0.738879).  Saving model ...
Epoch: 3 cost time: 2.7337610721588135
Epoch: 3, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
Validation loss decreased (-0.738879 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 2.7977852821350098
Epoch: 4, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.479 Vali Acc: 0.756 Test Loss: 0.479 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755551).  Saving model ...
Epoch: 5 cost time: 3.083743095397949
Epoch: 5, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.416 Vali Acc: 0.789 Test Loss: 0.416 Test Acc: 0.789
Validation loss decreased (-0.755551 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 2.883638858795166
Epoch: 6, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.331 Vali Acc: 0.844 Test Loss: 0.331 Test Acc: 0.844
Validation loss decreased (-0.788885 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.7099714279174805
Epoch: 7, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.301 Vali Acc: 0.839 Test Loss: 0.301 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.856119394302368
Epoch: 8, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8717875480651855
Epoch: 9, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6707630157470703
Epoch: 10, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.403 Vali Acc: 0.856 Test Loss: 0.403 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.8084423542022705
Epoch: 11, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.710 Vali Acc: 0.811 Test Loss: 0.710 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9612858295440674
Epoch: 12, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.236 Vali Acc: 0.878 Test Loss: 0.236 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.6834709644317627
Epoch: 13, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.230 Vali Acc: 0.939 Test Loss: 0.230 Test Acc: 0.939
Validation loss decreased (-0.877775 --> -0.938887).  Saving model ...
Epoch: 14 cost time: 2.628833532333374
Epoch: 14, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.957181692123413
Epoch: 15, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.169 Vali Acc: 0.917 Test Loss: 0.169 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.678382396697998
Epoch: 16, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 2.6159541606903076
Epoch: 17, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 2.928544521331787
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5031187534332275
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.336 Vali Acc: 0.933 Test Loss: 0.336 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.42303466796875
Epoch: 20, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.452 Vali Acc: 0.917 Test Loss: 0.452 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.644533395767212
Epoch: 21, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.696779251098633
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3050925731658936
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.343 Vali Acc: 0.939 Test Loss: 0.343 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.532917022705078
Epoch: 24, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.7040090560913086
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.411 Vali Acc: 0.928 Test Loss: 0.411 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3436639308929443
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.531553268432617
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.944 Test Loss: 0.150 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 16568838
model size : 65.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 11.032996892929077
Epoch: 1, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.673 Vali Acc: 0.328 Test Loss: 1.673 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 9.620946884155273
Epoch: 2, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.133 Vali Acc: 0.667 Test Loss: 1.133 Test Acc: 0.667
Validation loss decreased (-0.327761 --> -0.666655).  Saving model ...
Epoch: 3 cost time: 9.523799896240234
Epoch: 3, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.666 Vali Acc: 0.733 Test Loss: 0.666 Test Acc: 0.733
Validation loss decreased (-0.666655 --> -0.733327).  Saving model ...
Epoch: 4 cost time: 9.328492403030396
Epoch: 4, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.505 Vali Acc: 0.767 Test Loss: 0.505 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 8.753237009048462
Epoch: 5, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 8.296287059783936
Epoch: 6, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 8.995091199874878
Epoch: 7, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855553).  Saving model ...
Epoch: 8 cost time: 8.040963172912598
Epoch: 8, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 7.826280832290649
Epoch: 9, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 10 cost time: 7.402056932449341
Epoch: 10, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.332 Vali Acc: 0.872 Test Loss: 0.332 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.803332805633545
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.883331 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 8.576754093170166
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.042222499847412
Epoch: 13, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 8.685452461242676
Epoch: 14, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.146 Vali Acc: 0.944 Test Loss: 0.146 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 8.354884147644043
Epoch: 15, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.944 Test Loss: 0.110 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 8.146930456161499
Epoch: 16, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.964442253112793
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.676764249801636
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.945236921310425
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.478997230529785
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.354 Vali Acc: 0.928 Test Loss: 0.354 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.617242097854614
Epoch: 21, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.807201623916626
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949999).  Saving model ...
Epoch: 23 cost time: 9.181434392929077
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.02974796295166
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.418 Vali Acc: 0.917 Test Loss: 0.418 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.092507600784302
Epoch: 25, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.084 Vali Acc: 0.961 Test Loss: 0.084 Test Acc: 0.961
Validation loss decreased (-0.949999 --> -0.961110).  Saving model ...
Epoch: 26 cost time: 9.113766193389893
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 9.493738651275635
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.342 Vali Acc: 0.933 Test Loss: 0.342 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 9.324478387832642
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 9.364738941192627
Epoch: 29, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.397 Vali Acc: 0.917 Test Loss: 0.397 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 9.150370359420776
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.961 Test Loss: 0.224 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 28168710
model size : 109.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.987605810165405
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.491 Vali Acc: 0.539 Test Loss: 1.491 Test Acc: 0.539
Validation loss decreased (inf --> -0.538874).  Saving model ...
Epoch: 2 cost time: 3.271256923675537
Epoch: 2, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.019 Vali Acc: 0.739 Test Loss: 1.019 Test Acc: 0.739
Validation loss decreased (-0.538874 --> -0.738879).  Saving model ...
Epoch: 3 cost time: 3.269028902053833
Epoch: 3, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 3.2626450061798096
Epoch: 4, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 3.604689121246338
Epoch: 5, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.415 Vali Acc: 0.817 Test Loss: 0.415 Test Acc: 0.817
Validation loss decreased (-0.755550 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 3.3288381099700928
Epoch: 6, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 3.2440273761749268
Epoch: 7, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 3.3934133052825928
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.386937379837036
Epoch: 9, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.534884214401245
Epoch: 10, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.260 Vali Acc: 0.861 Test Loss: 0.260 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861109).  Saving model ...
Epoch: 11 cost time: 3.458008289337158
Epoch: 11, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.861109 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 3.258218288421631
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888887).  Saving model ...
Epoch: 13 cost time: 3.201669454574585
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
Validation loss decreased (-0.888887 --> -0.905554).  Saving model ...
Epoch: 14 cost time: 3.384777069091797
Epoch: 14, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.488 Vali Acc: 0.872 Test Loss: 0.488 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4313178062438965
Epoch: 15, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.372 Vali Acc: 0.872 Test Loss: 0.372 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.373783588409424
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.1961669921875
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.246278762817383
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2903289794921875
Epoch: 19, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.4680607318878174
Epoch: 20, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.307 Vali Acc: 0.917 Test Loss: 0.307 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 3.0006377696990967
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0102574825286865
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 2.776803493499756
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 2.7976913452148438
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.428 Vali Acc: 0.911 Test Loss: 0.428 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9206273555755615
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.890141010284424
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.797 Vali Acc: 0.867 Test Loss: 0.797 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.970477819442749
Epoch: 27, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.350 Vali Acc: 0.917 Test Loss: 0.350 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4491028785705566
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.484483242034912
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.3978681564331055
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 8309766
model size : 34.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.210739850997925
Epoch: 1, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.673 Vali Acc: 0.328 Test Loss: 1.673 Test Acc: 0.328
Validation loss decreased (inf --> -0.327761).  Saving model ...
Epoch: 2 cost time: 5.86558723449707
Epoch: 2, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.133 Vali Acc: 0.667 Test Loss: 1.133 Test Acc: 0.667
Validation loss decreased (-0.327761 --> -0.666655).  Saving model ...
Epoch: 3 cost time: 6.811707258224487
Epoch: 3, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.666 Vali Acc: 0.733 Test Loss: 0.666 Test Acc: 0.733
Validation loss decreased (-0.666655 --> -0.733327).  Saving model ...
Epoch: 4 cost time: 6.8768932819366455
Epoch: 4, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.505 Vali Acc: 0.767 Test Loss: 0.505 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766662).  Saving model ...
Epoch: 5 cost time: 6.866919994354248
Epoch: 5, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.405 Vali Acc: 0.800 Test Loss: 0.405 Test Acc: 0.800
Validation loss decreased (-0.766662 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 6.957416534423828
Epoch: 6, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.354 Vali Acc: 0.839 Test Loss: 0.354 Test Acc: 0.839
Validation loss decreased (-0.799996 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 6.274523735046387
Epoch: 7, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.282 Vali Acc: 0.856 Test Loss: 0.282 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855553).  Saving model ...
Epoch: 8 cost time: 6.121912717819214
Epoch: 8, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.292 Vali Acc: 0.872 Test Loss: 0.292 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 5.998213291168213
Epoch: 9, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.237 Vali Acc: 0.883 Test Loss: 0.237 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 10 cost time: 5.908411502838135
Epoch: 10, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.332 Vali Acc: 0.872 Test Loss: 0.332 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.154814720153809
Epoch: 11, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.883331 --> -0.916664).  Saving model ...
Epoch: 12 cost time: 6.832214832305908
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.726191520690918
Epoch: 13, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 6.82657790184021
Epoch: 14, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.146 Vali Acc: 0.944 Test Loss: 0.146 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 6.84409499168396
Epoch: 15, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.950 Test Loss: 0.109 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949999).  Saving model ...
Epoch: 16 cost time: 6.807245492935181
Epoch: 16, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.4393229484558105
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.2174389362335205
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.545000314712524
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.242 Vali Acc: 0.928 Test Loss: 0.242 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.29973578453064
Epoch: 20, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.335 Vali Acc: 0.928 Test Loss: 0.335 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.302240610122681
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.419974088668823
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.570258378982544
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.474576473236084
Epoch: 24, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.535 Vali Acc: 0.928 Test Loss: 0.535 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.529345273971558
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 28168710
model size : 109.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.512164115905762
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.491 Vali Acc: 0.539 Test Loss: 1.491 Test Acc: 0.539
Validation loss decreased (inf --> -0.538874).  Saving model ...
Epoch: 2 cost time: 2.8149662017822266
Epoch: 2, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.019 Vali Acc: 0.739 Test Loss: 1.019 Test Acc: 0.739
Validation loss decreased (-0.538874 --> -0.738879).  Saving model ...
Epoch: 3 cost time: 2.7005062103271484
Epoch: 3, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.688 Vali Acc: 0.744 Test Loss: 0.688 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 2.752068281173706
Epoch: 4, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 2.7452828884124756
Epoch: 5, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.415 Vali Acc: 0.817 Test Loss: 0.415 Test Acc: 0.817
Validation loss decreased (-0.755550 --> -0.816663).  Saving model ...
Epoch: 6 cost time: 2.820683479309082
Epoch: 6, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 7 cost time: 2.8752729892730713
Epoch: 7, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 8 cost time: 2.755173444747925
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5692696571350098
Epoch: 9, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.616729259490967
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.260 Vali Acc: 0.861 Test Loss: 0.260 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861109).  Saving model ...
Epoch: 11 cost time: 2.6685867309570312
Epoch: 11, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
Validation loss decreased (-0.861109 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 3.0990171432495117
Epoch: 12, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.239 Vali Acc: 0.889 Test Loss: 0.239 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 2.959407329559326
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.204 Vali Acc: 0.906 Test Loss: 0.204 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905554).  Saving model ...
Epoch: 14 cost time: 2.8636884689331055
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5372025966644287
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.376 Vali Acc: 0.872 Test Loss: 0.376 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9670863151550293
Epoch: 16, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7104218006134033
Epoch: 17, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.91959285736084
Epoch: 18, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.408 Vali Acc: 0.906 Test Loss: 0.408 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.857891321182251
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.375 Vali Acc: 0.872 Test Loss: 0.375 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6409058570861816
Epoch: 20, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
Validation loss decreased (-0.905554 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.5737273693084717
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5588598251342773
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 2.5143890380859375
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.917 Test Loss: 0.320 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8434627056121826
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.362 Vali Acc: 0.928 Test Loss: 0.362 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 25 cost time: 2.7684245109558105
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.927774 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 3.164768934249878
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.084768056869507
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9033544063568115
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.842686653137207
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0780131816864014
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.329 Vali Acc: 0.917 Test Loss: 0.329 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 8309766
model size : 34.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.731582880020142
Epoch: 1, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.678 Vali Acc: 0.322 Test Loss: 1.678 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 4.118963003158569
Epoch: 2, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.152 Vali Acc: 0.661 Test Loss: 1.152 Test Acc: 0.661
Validation loss decreased (-0.322205 --> -0.661100).  Saving model ...
Epoch: 3 cost time: 3.9946541786193848
Epoch: 3, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.692 Vali Acc: 0.717 Test Loss: 0.692 Test Acc: 0.717
Validation loss decreased (-0.661100 --> -0.716660).  Saving model ...
Epoch: 4 cost time: 4.168196439743042
Epoch: 4, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
Validation loss decreased (-0.716660 --> -0.755550).  Saving model ...
Epoch: 5 cost time: 4.3575119972229
Epoch: 5, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.415 Vali Acc: 0.789 Test Loss: 0.415 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788885).  Saving model ...
Epoch: 6 cost time: 4.272373914718628
Epoch: 6, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
Validation loss decreased (-0.788885 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 4.046282052993774
Epoch: 7, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.293 Vali Acc: 0.844 Test Loss: 0.293 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844442).  Saving model ...
Epoch: 8 cost time: 4.04672908782959
Epoch: 8, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.303 Vali Acc: 0.867 Test Loss: 0.303 Test Acc: 0.867
Validation loss decreased (-0.844442 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 3.580063581466675
Epoch: 9, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.246 Vali Acc: 0.878 Test Loss: 0.246 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 10 cost time: 3.87439227104187
Epoch: 10, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4533615112304688
Epoch: 11, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888885).  Saving model ...
Epoch: 12 cost time: 3.070225715637207
Epoch: 12, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911108).  Saving model ...
Epoch: 13 cost time: 3.1901838779449463
Epoch: 13, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 14 cost time: 3.2055768966674805
Epoch: 14, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.949045419692993
Epoch: 15, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.087143421173096
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9530234336853027
Epoch: 17, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8398473262786865
Epoch: 18, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 4.043291091918945
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.982126474380493
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.939 Test Loss: 0.138 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938888).  Saving model ...
Epoch: 21 cost time: 3.9704747200012207
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.371 Vali Acc: 0.883 Test Loss: 0.371 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.050555467605591
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.023857116699219
Epoch: 23, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.9777960777282715
Epoch: 24, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.461 Vali Acc: 0.922 Test Loss: 0.461 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8315951824188232
Epoch: 25, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.025404453277588
Epoch: 26, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.823 Vali Acc: 0.822 Test Loss: 0.823 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.050399541854858
Epoch: 27, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.222 Vali Acc: 0.900 Test Loss: 0.222 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.9130611419677734
Epoch: 28, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.806943416595459
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
Validation loss decreased (-0.938888 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 3.5924346446990967
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.944441 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 28168710
model size : 109.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8581085205078125
Epoch: 1, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.494 Vali Acc: 0.539 Test Loss: 1.494 Test Acc: 0.539
Validation loss decreased (inf --> -0.538874).  Saving model ...
Epoch: 2 cost time: 1.9115865230560303
Epoch: 2, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.029 Vali Acc: 0.728 Test Loss: 1.029 Test Acc: 0.728
Validation loss decreased (-0.538874 --> -0.727767).  Saving model ...
Epoch: 3 cost time: 1.7977731227874756
Epoch: 3, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.704 Vali Acc: 0.733 Test Loss: 0.704 Test Acc: 0.733
Validation loss decreased (-0.727767 --> -0.733326).  Saving model ...
Epoch: 4 cost time: 1.9039294719696045
Epoch: 4, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.546 Vali Acc: 0.744 Test Loss: 0.546 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744439).  Saving model ...
Epoch: 5 cost time: 1.9749066829681396
Epoch: 5, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.436 Vali Acc: 0.800 Test Loss: 0.436 Test Acc: 0.800
Validation loss decreased (-0.744439 --> -0.799996).  Saving model ...
Epoch: 6 cost time: 2.056432008743286
Epoch: 6, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.799996 --> -0.833330).  Saving model ...
Epoch: 7 cost time: 1.9365668296813965
Epoch: 7, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 1.974029779434204
Epoch: 8, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.958829402923584
Epoch: 9, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.457 Vali Acc: 0.822 Test Loss: 0.457 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9761533737182617
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.272 Vali Acc: 0.856 Test Loss: 0.272 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 2.1431548595428467
Epoch: 11, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 2.046644926071167
Epoch: 12, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.250 Vali Acc: 0.883 Test Loss: 0.250 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 2.145883560180664
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.216 Vali Acc: 0.906 Test Loss: 0.216 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 2.3794703483581543
Epoch: 14, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0754144191741943
Epoch: 15, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.973524570465088
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2775139808654785
Epoch: 17, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0783562660217285
Epoch: 18, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.985149621963501
Epoch: 19, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.079953670501709
Epoch: 20, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.300 Vali Acc: 0.911 Test Loss: 0.300 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 2.289793014526367
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 2.0436387062072754
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.331 Vali Acc: 0.928 Test Loss: 0.331 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 23 cost time: 2.0667178630828857
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.382 Vali Acc: 0.922 Test Loss: 0.382 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2418594360351562
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2492613792419434
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9190335273742676
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8871369361877441
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.374 Vali Acc: 0.928 Test Loss: 0.374 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0805583000183105
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
Validation loss decreased (-0.927774 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 1.9183928966522217
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7184717655181885
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 8309766
model size : 34.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 10.667664051055908
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.653 Vali Acc: 0.283 Test Loss: 1.653 Test Acc: 0.283
Validation loss decreased (inf --> -0.283317).  Saving model ...
Epoch: 2 cost time: 10.357011556625366
Epoch: 2, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.274 Vali Acc: 0.694 Test Loss: 1.274 Test Acc: 0.694
Validation loss decreased (-0.283317 --> -0.694432).  Saving model ...
Epoch: 3 cost time: 9.906463384628296
Epoch: 3, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.877 Vali Acc: 0.744 Test Loss: 0.877 Test Acc: 0.744
Validation loss decreased (-0.694432 --> -0.744436).  Saving model ...
Epoch: 4 cost time: 9.870391130447388
Epoch: 4, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.631 Vali Acc: 0.772 Test Loss: 0.631 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 10.205398797988892
Epoch: 5, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 10.128273010253906
Epoch: 6, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.434 Vali Acc: 0.817 Test Loss: 0.434 Test Acc: 0.817
Validation loss decreased (-0.783328 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 9.0294930934906
Epoch: 7, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.390 Vali Acc: 0.811 Test Loss: 0.390 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.050363063812256
Epoch: 8, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 8.41996693611145
Epoch: 9, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.305150508880615
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 7.83911657333374
Epoch: 11, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.259 Vali Acc: 0.872 Test Loss: 0.259 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 9.261686086654663
Epoch: 12, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.219 Vali Acc: 0.906 Test Loss: 0.219 Test Acc: 0.906
Validation loss decreased (-0.872220 --> -0.905553).  Saving model ...
Epoch: 13 cost time: 9.152998685836792
Epoch: 13, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 14 cost time: 9.811657428741455
Epoch: 14, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.205 Vali Acc: 0.900 Test Loss: 0.205 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.76654601097107
Epoch: 15, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.230 Vali Acc: 0.900 Test Loss: 0.230 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.708447933197021
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.228 Vali Acc: 0.889 Test Loss: 0.228 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.653076887130737
Epoch: 17, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.562240600585938
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 8.45601201057434
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.232 Vali Acc: 0.917 Test Loss: 0.232 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.675917387008667
Epoch: 20, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.772279977798462
Epoch: 21, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.873639106750488
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 9.816123962402344
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 10.180684089660645
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.950 Test Loss: 0.104 Test Acc: 0.950
Validation loss decreased (-0.944441 --> -0.949999).  Saving model ...
Epoch: 25 cost time: 10.192889213562012
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
Validation loss decreased (-0.949999 --> -0.972221).  Saving model ...
Epoch: 26 cost time: 9.945930480957031
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.961 Test Loss: 0.100 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 9.973397493362427
Epoch: 27, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.961 Test Loss: 0.092 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 9.625019311904907
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.398993730545044
Epoch: 29, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.650212049484253
Epoch: 30, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9722222222222222
model parameter : 28145286
model size : 108.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.208886384963989
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.625 Vali Acc: 0.372 Test Loss: 1.625 Test Acc: 0.372
Validation loss decreased (inf --> -0.372206).  Saving model ...
Epoch: 2 cost time: 3.4531588554382324
Epoch: 2, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.250 Vali Acc: 0.633 Test Loss: 1.250 Test Acc: 0.633
Validation loss decreased (-0.372206 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 3.433763265609741
Epoch: 3, Steps: 12 | Train Loss: 1.086 Vali Loss: 0.888 Vali Acc: 0.767 Test Loss: 0.888 Test Acc: 0.767
Validation loss decreased (-0.633321 --> -0.766658).  Saving model ...
Epoch: 4 cost time: 3.5334904193878174
Epoch: 4, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.636420726776123
Epoch: 5, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 3.5615718364715576
Epoch: 6, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 3.555535078048706
Epoch: 7, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.431 Vali Acc: 0.794 Test Loss: 0.431 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6197683811187744
Epoch: 8, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 3.583333730697632
Epoch: 9, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5514490604400635
Epoch: 10, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.351 Vali Acc: 0.811 Test Loss: 0.351 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.752502202987671
Epoch: 11, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5582523345947266
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855553).  Saving model ...
Epoch: 13 cost time: 3.8472678661346436
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.864628314971924
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.855553 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 3.821960210800171
Epoch: 15, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4229540824890137
Epoch: 16, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.334256410598755
Epoch: 17, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.218 Vali Acc: 0.894 Test Loss: 0.218 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 3.3736886978149414
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 3.3071484565734863
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.391 Vali Acc: 0.872 Test Loss: 0.391 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.272390127182007
Epoch: 20, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1719954013824463
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.956 Test Loss: 0.127 Test Acc: 0.956
Validation loss decreased (-0.922220 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 3.1376795768737793
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.422 Vali Acc: 0.889 Test Loss: 0.422 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6712114810943604
Epoch: 23, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.135605573654175
Epoch: 24, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.927837133407593
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.982361316680908
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.204 Vali Acc: 0.911 Test Loss: 0.204 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.95937180519104
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.907511472702026
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.9148383140563965
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.237 Vali Acc: 0.939 Test Loss: 0.237 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.9825499057769775
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 8285958
model size : 32.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 11.699965953826904
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.653 Vali Acc: 0.283 Test Loss: 1.653 Test Acc: 0.283
Validation loss decreased (inf --> -0.283317).  Saving model ...
Epoch: 2 cost time: 9.482993841171265
Epoch: 2, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.274 Vali Acc: 0.694 Test Loss: 1.274 Test Acc: 0.694
Validation loss decreased (-0.283317 --> -0.694432).  Saving model ...
Epoch: 3 cost time: 9.937081813812256
Epoch: 3, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
Validation loss decreased (-0.694432 --> -0.744436).  Saving model ...
Epoch: 4 cost time: 10.00547981262207
Epoch: 4, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.631 Vali Acc: 0.772 Test Loss: 0.631 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 8.613696575164795
Epoch: 5, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 8.625422239303589
Epoch: 6, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.434 Vali Acc: 0.817 Test Loss: 0.434 Test Acc: 0.817
Validation loss decreased (-0.783328 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 8.662385940551758
Epoch: 7, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.390 Vali Acc: 0.811 Test Loss: 0.390 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.136270523071289
Epoch: 8, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 9.149715185165405
Epoch: 9, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.393 Vali Acc: 0.794 Test Loss: 0.393 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.44555139541626
Epoch: 10, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 11 cost time: 9.263339042663574
Epoch: 11, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.260 Vali Acc: 0.872 Test Loss: 0.260 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 9.672229051589966
Epoch: 12, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
Validation loss decreased (-0.872220 --> -0.899998).  Saving model ...
Epoch: 13 cost time: 9.5548677444458
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.191 Vali Acc: 0.906 Test Loss: 0.191 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905554).  Saving model ...
Epoch: 14 cost time: 9.253082513809204
Epoch: 14, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.195 Vali Acc: 0.900 Test Loss: 0.195 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.739000082015991
Epoch: 15, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.70615291595459
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.28420352935791
Epoch: 17, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.905554 --> -0.911109).  Saving model ...
Epoch: 18 cost time: 9.616075992584229
Epoch: 18, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.286 Vali Acc: 0.939 Test Loss: 0.286 Test Acc: 0.939
Validation loss decreased (-0.911109 --> -0.938886).  Saving model ...
Epoch: 19 cost time: 8.81227445602417
Epoch: 19, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.410905599594116
Epoch: 20, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.881230354309082
Epoch: 21, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.689478397369385
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.21431303024292
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.938886 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 9.617505073547363
Epoch: 24, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.956 Test Loss: 0.124 Test Acc: 0.956
Validation loss decreased (-0.949997 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 9.542507410049438
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.956 Test Loss: 0.129 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.161941289901733
Epoch: 26, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.642147541046143
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.939 Test Loss: 0.137 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.761842489242554
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.319 Vali Acc: 0.956 Test Loss: 0.319 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.551330089569092
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.07713794708252
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.432 Vali Acc: 0.894 Test Loss: 0.432 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 28145286
model size : 108.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.8620381355285645
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.625 Vali Acc: 0.372 Test Loss: 1.625 Test Acc: 0.372
Validation loss decreased (inf --> -0.372206).  Saving model ...
Epoch: 2 cost time: 3.870299816131592
Epoch: 2, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.250 Vali Acc: 0.633 Test Loss: 1.250 Test Acc: 0.633
Validation loss decreased (-0.372206 --> -0.633321).  Saving model ...
Epoch: 3 cost time: 3.702646493911743
Epoch: 3, Steps: 12 | Train Loss: 1.086 Vali Loss: 0.888 Vali Acc: 0.767 Test Loss: 0.888 Test Acc: 0.767
Validation loss decreased (-0.633321 --> -0.766658).  Saving model ...
Epoch: 4 cost time: 3.8457162380218506
Epoch: 4, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7850894927978516
Epoch: 5, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
Validation loss decreased (-0.766658 --> -0.799995).  Saving model ...
Epoch: 6 cost time: 3.8431217670440674
Epoch: 6, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 7 cost time: 3.876628875732422
Epoch: 7, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.431 Vali Acc: 0.794 Test Loss: 0.431 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.769470691680908
Epoch: 8, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 3.752499580383301
Epoch: 9, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8252665996551514
Epoch: 10, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.351 Vali Acc: 0.811 Test Loss: 0.351 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.220726490020752
Epoch: 11, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.374 Vali Acc: 0.822 Test Loss: 0.374 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.212352752685547
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.304 Vali Acc: 0.856 Test Loss: 0.304 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855553).  Saving model ...
Epoch: 13 cost time: 4.215142726898193
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.398 Vali Acc: 0.828 Test Loss: 0.398 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.142856121063232
Epoch: 14, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.293 Vali Acc: 0.883 Test Loss: 0.293 Test Acc: 0.883
Validation loss decreased (-0.855553 --> -0.883330).  Saving model ...
Epoch: 15 cost time: 4.15303373336792
Epoch: 15, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.280565023422241
Epoch: 16, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.324 Vali Acc: 0.861 Test Loss: 0.324 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.283019304275513
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.217 Vali Acc: 0.894 Test Loss: 0.217 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 4.260287523269653
Epoch: 18, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 4.200305700302124
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.385 Vali Acc: 0.883 Test Loss: 0.385 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.115077972412109
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 4.110585927963257
Epoch: 21, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
Validation loss decreased (-0.927776 --> -0.961110).  Saving model ...
Epoch: 22 cost time: 4.256458044052124
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.259545803070068
Epoch: 23, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.16642427444458
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.333 Vali Acc: 0.878 Test Loss: 0.333 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.201654434204102
Epoch: 25, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.1158928871154785
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.1348347663879395
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.132554531097412
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.120344877243042
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.840972661972046
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 8285958
model size : 32.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.703227519989014
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.657 Vali Acc: 0.278 Test Loss: 1.657 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 4.998507261276245
Epoch: 2, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.288 Vali Acc: 0.689 Test Loss: 1.288 Test Acc: 0.689
Validation loss decreased (-0.277761 --> -0.688876).  Saving model ...
Epoch: 3 cost time: 4.99583101272583
Epoch: 3, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.897 Vali Acc: 0.728 Test Loss: 0.897 Test Acc: 0.728
Validation loss decreased (-0.688876 --> -0.727769).  Saving model ...
Epoch: 4 cost time: 4.992605924606323
Epoch: 4, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.653 Vali Acc: 0.756 Test Loss: 0.653 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755549).  Saving model ...
Epoch: 5 cost time: 5.3838396072387695
Epoch: 5, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.524 Vali Acc: 0.772 Test Loss: 0.524 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 6 cost time: 5.188148021697998
Epoch: 6, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.455 Vali Acc: 0.806 Test Loss: 0.455 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 5.6374876499176025
Epoch: 7, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.409 Vali Acc: 0.800 Test Loss: 0.409 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.548264980316162
Epoch: 8, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.361 Vali Acc: 0.828 Test Loss: 0.361 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 5.589918851852417
Epoch: 9, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.479131698608398
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.319 Vali Acc: 0.850 Test Loss: 0.319 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 5.247726678848267
Epoch: 11, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 12 cost time: 5.498904466629028
Epoch: 12, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.257 Vali Acc: 0.867 Test Loss: 0.257 Test Acc: 0.867
Validation loss decreased (-0.866664 --> -0.866664).  Saving model ...
Epoch: 13 cost time: 5.615693807601929
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
Validation loss decreased (-0.866664 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 5.622883081436157
Epoch: 14, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.228 Vali Acc: 0.894 Test Loss: 0.228 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 5.248048305511475
Epoch: 15, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 5.2938361167907715
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.350 Vali Acc: 0.883 Test Loss: 0.350 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.593429088592529
Epoch: 17, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.535874366760254
Epoch: 18, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.299 Vali Acc: 0.911 Test Loss: 0.299 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.617779731750488
Epoch: 19, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.169 Vali Acc: 0.928 Test Loss: 0.169 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927776).  Saving model ...
Epoch: 20 cost time: 5.425294637680054
Epoch: 20, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.191 Vali Acc: 0.911 Test Loss: 0.191 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.731672525405884
Epoch: 21, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.066663026809692
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.928 Test Loss: 0.149 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 5.022476673126221
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.8580322265625
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.956 Test Loss: 0.113 Test Acc: 0.956
Validation loss decreased (-0.927776 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 4.5716845989227295
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.955554 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 4.064659833908081
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.950 Test Loss: 0.133 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.107868194580078
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.021809339523315
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.094910144805908
Epoch: 29, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.456 Vali Acc: 0.883 Test Loss: 0.456 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.246130466461182
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.116 Vali Acc: 0.944 Test Loss: 0.116 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9833333333333333
model parameter : 28145286
model size : 108.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.534380912780762
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.636 Vali Acc: 0.361 Test Loss: 1.636 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 2.3725626468658447
Epoch: 2, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.275 Vali Acc: 0.622 Test Loss: 1.275 Test Acc: 0.622
Validation loss decreased (-0.361095 --> -0.622209).  Saving model ...
Epoch: 3 cost time: 2.657273054122925
Epoch: 3, Steps: 12 | Train Loss: 1.088 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
Validation loss decreased (-0.622209 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 2.693601131439209
Epoch: 4, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.697 Vali Acc: 0.739 Test Loss: 0.697 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5794155597686768
Epoch: 5, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.783328).  Saving model ...
Epoch: 6 cost time: 2.4390547275543213
Epoch: 6, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.470 Vali Acc: 0.811 Test Loss: 0.470 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811106).  Saving model ...
Epoch: 7 cost time: 2.6696937084198
Epoch: 7, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.449 Vali Acc: 0.783 Test Loss: 0.449 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.627979040145874
Epoch: 8, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.372 Vali Acc: 0.839 Test Loss: 0.372 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 9 cost time: 2.389390230178833
Epoch: 9, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.358 Vali Acc: 0.822 Test Loss: 0.358 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.125446319580078
Epoch: 10, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.369 Vali Acc: 0.789 Test Loss: 0.369 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6772496700286865
Epoch: 11, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.385 Vali Acc: 0.811 Test Loss: 0.385 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7096595764160156
Epoch: 12, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.418850898742676
Epoch: 13, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7334699630737305
Epoch: 14, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 2.754373788833618
Epoch: 15, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.416 Vali Acc: 0.844 Test Loss: 0.416 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5309343338012695
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 2.6792798042297363
Epoch: 17, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.888886 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 2.4520058631896973
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4421374797821045
Epoch: 19, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.373 Vali Acc: 0.883 Test Loss: 0.373 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0877583026885986
Epoch: 20, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1858103275299072
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 2.5203073024749756
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.372 Vali Acc: 0.911 Test Loss: 0.372 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.282557249069214
Epoch: 23, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3477485179901123
Epoch: 24, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.393 Vali Acc: 0.867 Test Loss: 0.393 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.476895570755005
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.203 Vali Acc: 0.928 Test Loss: 0.203 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.455981492996216
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.906 Test Loss: 0.222 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.108156204223633
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.318 Vali Acc: 0.928 Test Loss: 0.318 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1329007148742676
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4492170810699463
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.61318039894104
Epoch: 30, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 8285958
model size : 32.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.101156949996948
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.738 Vali Acc: 0.228 Test Loss: 1.738 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 7.749972105026245
Epoch: 2, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.417 Vali Acc: 0.550 Test Loss: 1.417 Test Acc: 0.550
Validation loss decreased (-0.227760 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 7.19836688041687
Epoch: 3, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.060 Vali Acc: 0.733 Test Loss: 1.060 Test Acc: 0.733
Validation loss decreased (-0.549986 --> -0.733323).  Saving model ...
Epoch: 4 cost time: 7.308159351348877
Epoch: 4, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 7.455823183059692
Epoch: 5, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.572 Vali Acc: 0.761 Test Loss: 0.572 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 7.116085767745972
Epoch: 6, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.456 Vali Acc: 0.806 Test Loss: 0.456 Test Acc: 0.806
Validation loss decreased (-0.761105 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 6.944485187530518
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 7.41665506362915
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.842807292938232
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.326 Vali Acc: 0.844 Test Loss: 0.326 Test Acc: 0.844
Validation loss decreased (-0.816663 --> -0.844441).  Saving model ...
Epoch: 10 cost time: 6.36274790763855
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 7.071402549743652
Epoch: 11, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.242 Vali Acc: 0.872 Test Loss: 0.242 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 6.314634323120117
Epoch: 12, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.229 Vali Acc: 0.883 Test Loss: 0.229 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 6.656442642211914
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.252 Vali Acc: 0.872 Test Loss: 0.252 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.934917211532593
Epoch: 14, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.460319995880127
Epoch: 15, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.691527843475342
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 6.580241680145264
Epoch: 17, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 8.01377010345459
Epoch: 18, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 19 cost time: 7.846804618835449
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.660431385040283
Epoch: 20, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.507 Vali Acc: 0.856 Test Loss: 0.507 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.969259023666382
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.58881950378418
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 23 cost time: 7.502309083938599
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.965694189071655
Epoch: 24, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.516132831573486
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.350 Vali Acc: 0.928 Test Loss: 0.350 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.416873216629028
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 27 cost time: 7.060994863510132
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.402 Vali Acc: 0.906 Test Loss: 0.402 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.74023175239563
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.989887237548828
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 7.064903497695923
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 14085510
model size : 54.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.542720079421997
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.735 Vali Acc: 0.211 Test Loss: 1.735 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 3.387301206588745
Epoch: 2, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.401 Vali Acc: 0.567 Test Loss: 1.401 Test Acc: 0.567
Validation loss decreased (-0.211094 --> -0.566653).  Saving model ...
Epoch: 3 cost time: 3.3600494861602783
Epoch: 3, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.080 Vali Acc: 0.706 Test Loss: 1.080 Test Acc: 0.706
Validation loss decreased (-0.566653 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 3.260185718536377
Epoch: 4, Steps: 12 | Train Loss: 0.936 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 3.292468547821045
Epoch: 5, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.670 Vali Acc: 0.744 Test Loss: 0.670 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 3.4192469120025635
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.552 Vali Acc: 0.767 Test Loss: 0.552 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 3.412933349609375
Epoch: 7, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.485 Vali Acc: 0.800 Test Loss: 0.485 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 3.3403801918029785
Epoch: 8, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3754050731658936
Epoch: 9, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 3.1067144870758057
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 3.0317978858947754
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.328 Vali Acc: 0.828 Test Loss: 0.328 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.377472162246704
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4155595302581787
Epoch: 13, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 3.4031450748443604
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 3.3499040603637695
Epoch: 15, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.264 Vali Acc: 0.867 Test Loss: 0.264 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 3.289431095123291
Epoch: 16, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 3.389329671859741
Epoch: 17, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 3.444805145263672
Epoch: 18, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4377267360687256
Epoch: 19, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.451 Vali Acc: 0.839 Test Loss: 0.451 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4436092376708984
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.357891321182251
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.174 Vali Acc: 0.911 Test Loss: 0.174 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 3.2332563400268555
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.188 Vali Acc: 0.900 Test Loss: 0.188 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.583475112915039
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.192 Vali Acc: 0.906 Test Loss: 0.192 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1174910068511963
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1062569618225098
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.289 Vali Acc: 0.906 Test Loss: 0.289 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.1243913173675537
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 27 cost time: 3.0703649520874023
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927775).  Saving model ...
Epoch: 28 cost time: 3.0594899654388428
Epoch: 28, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0953783988952637
Epoch: 29, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1250743865966797
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.435 Vali Acc: 0.906 Test Loss: 0.435 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 4155654
model size : 17.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.418821811676025
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.738 Vali Acc: 0.228 Test Loss: 1.738 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 5.962689161300659
Epoch: 2, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.417 Vali Acc: 0.550 Test Loss: 1.417 Test Acc: 0.550
Validation loss decreased (-0.227760 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 6.055613994598389
Epoch: 3, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.060 Vali Acc: 0.733 Test Loss: 1.060 Test Acc: 0.733
Validation loss decreased (-0.549986 --> -0.733323).  Saving model ...
Epoch: 4 cost time: 5.9381914138793945
Epoch: 4, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.758 Vali Acc: 0.756 Test Loss: 0.758 Test Acc: 0.756
Validation loss decreased (-0.733323 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 5.614153623580933
Epoch: 5, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.572 Vali Acc: 0.761 Test Loss: 0.572 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761105).  Saving model ...
Epoch: 6 cost time: 5.854145526885986
Epoch: 6, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.456 Vali Acc: 0.806 Test Loss: 0.456 Test Acc: 0.806
Validation loss decreased (-0.761105 --> -0.805551).  Saving model ...
Epoch: 7 cost time: 5.895117282867432
Epoch: 7, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816663).  Saving model ...
Epoch: 8 cost time: 5.59286093711853
Epoch: 8, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.422 Vali Acc: 0.806 Test Loss: 0.422 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.616881847381592
Epoch: 9, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 10 cost time: 5.891995906829834
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.272 Vali Acc: 0.861 Test Loss: 0.272 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 5.812844753265381
Epoch: 11, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.241 Vali Acc: 0.872 Test Loss: 0.241 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 5.8828935623168945
Epoch: 12, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.229 Vali Acc: 0.878 Test Loss: 0.229 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 5.978115797042847
Epoch: 13, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.957196235656738
Epoch: 14, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883331).  Saving model ...
Epoch: 15 cost time: 5.071044921875
Epoch: 15, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.287 Vali Acc: 0.872 Test Loss: 0.287 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.439133882522583
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 17 cost time: 5.528590679168701
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.326853036880493
Epoch: 18, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 5.205031871795654
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.46503472328186
Epoch: 20, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.813746929168701
Epoch: 21, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.247 Vali Acc: 0.906 Test Loss: 0.247 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 5.730511426925659
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 6.030462741851807
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.022646903991699
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.858425855636597
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.674559116363525
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.420 Vali Acc: 0.894 Test Loss: 0.420 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.046352863311768
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.304 Vali Acc: 0.939 Test Loss: 0.304 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938886).  Saving model ...
Epoch: 28 cost time: 6.025447130203247
Epoch: 28, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.741847515106201
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.016080141067505
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 14085510
model size : 54.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.340106248855591
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.735 Vali Acc: 0.211 Test Loss: 1.735 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 2.750981092453003
Epoch: 2, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.401 Vali Acc: 0.567 Test Loss: 1.401 Test Acc: 0.567
Validation loss decreased (-0.211094 --> -0.566653).  Saving model ...
Epoch: 3 cost time: 2.5657660961151123
Epoch: 3, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.080 Vali Acc: 0.706 Test Loss: 1.080 Test Acc: 0.706
Validation loss decreased (-0.566653 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 2.80090594291687
Epoch: 4, Steps: 12 | Train Loss: 0.936 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 2.74269437789917
Epoch: 5, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.670 Vali Acc: 0.744 Test Loss: 0.670 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 2.5129780769348145
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.552 Vali Acc: 0.767 Test Loss: 0.552 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 7 cost time: 2.491328001022339
Epoch: 7, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.484 Vali Acc: 0.800 Test Loss: 0.484 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 2.1717066764831543
Epoch: 8, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.417 Vali Acc: 0.794 Test Loss: 0.417 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.481635570526123
Epoch: 9, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.376 Vali Acc: 0.822 Test Loss: 0.376 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 2.523526430130005
Epoch: 10, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.346 Vali Acc: 0.839 Test Loss: 0.346 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 2.4769883155822754
Epoch: 11, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.329 Vali Acc: 0.828 Test Loss: 0.329 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.519766092300415
Epoch: 12, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.366 Vali Acc: 0.822 Test Loss: 0.366 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.500811815261841
Epoch: 13, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.296 Vali Acc: 0.844 Test Loss: 0.296 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 2.4559061527252197
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.289 Vali Acc: 0.856 Test Loss: 0.289 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 1.7808701992034912
Epoch: 15, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.265 Vali Acc: 0.867 Test Loss: 0.265 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 2.627845048904419
Epoch: 16, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 17 cost time: 2.1332948207855225
Epoch: 17, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 2.123408079147339
Epoch: 18, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1232001781463623
Epoch: 19, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.455 Vali Acc: 0.839 Test Loss: 0.455 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2375450134277344
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.323 Vali Acc: 0.872 Test Loss: 0.323 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.725527286529541
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 22 cost time: 2.5617454051971436
Epoch: 22, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.190 Vali Acc: 0.894 Test Loss: 0.190 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4352548122406006
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.186 Vali Acc: 0.917 Test Loss: 0.186 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7741408348083496
Epoch: 24, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6561410427093506
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.30959415435791
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 2.7630860805511475
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5812079906463623
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.29001522064209
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.363 Vali Acc: 0.917 Test Loss: 0.363 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.7668256759643555
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.385 Vali Acc: 0.917 Test Loss: 0.385 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 4155654
model size : 17.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.239492654800415
Epoch: 1, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.739 Vali Acc: 0.228 Test Loss: 1.739 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 3.429630756378174
Epoch: 2, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.423 Vali Acc: 0.544 Test Loss: 1.423 Test Acc: 0.544
Validation loss decreased (-0.227760 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 3.591456413269043
Epoch: 3, Steps: 12 | Train Loss: 1.239 Vali Loss: 1.072 Vali Acc: 0.722 Test Loss: 1.072 Test Acc: 0.722
Validation loss decreased (-0.544430 --> -0.722212).  Saving model ...
Epoch: 4 cost time: 3.288605213165283
Epoch: 4, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.773 Vali Acc: 0.744 Test Loss: 0.773 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 3.591841220855713
Epoch: 5, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 3.394742727279663
Epoch: 6, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.475 Vali Acc: 0.794 Test Loss: 0.475 Test Acc: 0.794
Validation loss decreased (-0.749994 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 3.3786792755126953
Epoch: 7, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.410 Vali Acc: 0.806 Test Loss: 0.410 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 3.276642322540283
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.437 Vali Acc: 0.806 Test Loss: 0.437 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.067416191101074
Epoch: 9, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.350 Vali Acc: 0.839 Test Loss: 0.350 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 3.256344795227051
Epoch: 10, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.306 Vali Acc: 0.856 Test Loss: 0.306 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 2.978424072265625
Epoch: 11, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.259 Vali Acc: 0.872 Test Loss: 0.259 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872220).  Saving model ...
Epoch: 12 cost time: 3.2187540531158447
Epoch: 12, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.252 Vali Acc: 0.872 Test Loss: 0.252 Test Acc: 0.872
Validation loss decreased (-0.872220 --> -0.872220).  Saving model ...
Epoch: 13 cost time: 3.0039055347442627
Epoch: 13, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 14 cost time: 2.8249077796936035
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.883331 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 3.278245210647583
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.345 Vali Acc: 0.872 Test Loss: 0.345 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.914731502532959
Epoch: 16, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 3.5870471000671387
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 3.301711082458496
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5887632369995117
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 3.4988274574279785
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.220 Vali Acc: 0.917 Test Loss: 0.220 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.303067445755005
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5508806705474854
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2465598583221436
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.6033966541290283
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.238 Vali Acc: 0.917 Test Loss: 0.238 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3535919189453125
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.2237324714660645
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.544924020767212
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.2449519634246826
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.933 Test Loss: 0.148 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5557377338409424
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949999).  Saving model ...
Epoch: 30 cost time: 3.371222972869873
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 14085510
model size : 54.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.811852216720581
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.736 Vali Acc: 0.211 Test Loss: 1.736 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 2.0455777645111084
Epoch: 2, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.403 Vali Acc: 0.567 Test Loss: 1.403 Test Acc: 0.567
Validation loss decreased (-0.211094 --> -0.566653).  Saving model ...
Epoch: 3 cost time: 2.0394203662872314
Epoch: 3, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.566653 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 1.8072290420532227
Epoch: 4, Steps: 12 | Train Loss: 0.937 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727769).  Saving model ...
Epoch: 5 cost time: 2.112614631652832
Epoch: 5, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.685 Vali Acc: 0.733 Test Loss: 0.685 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733326).  Saving model ...
Epoch: 6 cost time: 2.1442503929138184
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.9829189777374268
Epoch: 7, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.788884).  Saving model ...
Epoch: 8 cost time: 1.6142830848693848
Epoch: 8, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.432 Vali Acc: 0.789 Test Loss: 0.432 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788885).  Saving model ...
Epoch: 9 cost time: 1.5946083068847656
Epoch: 9, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.391 Vali Acc: 0.817 Test Loss: 0.391 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 1.3606986999511719
Epoch: 10, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 1.3546574115753174
Epoch: 11, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.344 Vali Acc: 0.822 Test Loss: 0.344 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3581020832061768
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.379 Vali Acc: 0.822 Test Loss: 0.379 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.341742992401123
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.312 Vali Acc: 0.844 Test Loss: 0.312 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 1.3861358165740967
Epoch: 14, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.301 Vali Acc: 0.856 Test Loss: 0.301 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 1.8564732074737549
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
Validation loss decreased (-0.855553 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 1.9122881889343262
Epoch: 16, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.9616737365722656
Epoch: 17, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 1.8824646472930908
Epoch: 18, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.424 Vali Acc: 0.867 Test Loss: 0.424 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.816453456878662
Epoch: 19, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.911665678024292
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9141709804534912
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 2.155813694000244
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.180 Vali Acc: 0.911 Test Loss: 0.180 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 2.087606191635132
Epoch: 23, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0481598377227783
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.587284803390503
Epoch: 25, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.187159299850464
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
Validation loss decreased (-0.911109 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 2.207606315612793
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.353 Vali Acc: 0.928 Test Loss: 0.353 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0929198265075684
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1127536296844482
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.039069175720215
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.325 Vali Acc: 0.939 Test Loss: 0.325 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 4155654
model size : 17.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.057065010070801
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.601 Vali Acc: 0.417 Test Loss: 1.601 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 5.428715229034424
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.340 Vali Acc: 0.578 Test Loss: 1.340 Test Acc: 0.578
Validation loss decreased (-0.416651 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 5.426642656326294
Epoch: 3, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.577764 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 5.020096302032471
Epoch: 4, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 5.560154438018799
Epoch: 5, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 5.209827184677124
Epoch: 6, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.511 Vali Acc: 0.739 Test Loss: 0.511 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.453416109085083
Epoch: 7, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.426 Vali Acc: 0.789 Test Loss: 0.426 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788885).  Saving model ...
Epoch: 8 cost time: 5.42169713973999
Epoch: 8, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 5.072566986083984
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.354 Vali Acc: 0.811 Test Loss: 0.354 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.917454481124878
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.323 Vali Acc: 0.839 Test Loss: 0.323 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 11 cost time: 4.5316407680511475
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.857607126235962
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.633328914642334
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.290 Vali Acc: 0.850 Test Loss: 0.290 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 3.583246946334839
Epoch: 14, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.252 Vali Acc: 0.839 Test Loss: 0.252 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.833423137664795
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.234 Vali Acc: 0.872 Test Loss: 0.234 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872220).  Saving model ...
Epoch: 16 cost time: 4.464429616928101
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.931764364242554
Epoch: 17, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.256 Vali Acc: 0.861 Test Loss: 0.256 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.767292261123657
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.212 Vali Acc: 0.883 Test Loss: 0.212 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 19 cost time: 3.5833663940429688
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
Validation loss decreased (-0.883331 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 4.31062126159668
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.442 Vali Acc: 0.872 Test Loss: 0.442 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.171951055526733
Epoch: 21, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.267 Vali Acc: 0.878 Test Loss: 0.267 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.126977443695068
Epoch: 22, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.570869445800781
Epoch: 23, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.315392255783081
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.251 Vali Acc: 0.883 Test Loss: 0.251 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.531794309616089
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.889 Test Loss: 0.225 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.340432167053223
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.59636926651001
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.154 Vali Acc: 0.922 Test Loss: 0.154 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922221).  Saving model ...
Epoch: 28 cost time: 5.622842788696289
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.295381784439087
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.928 Test Loss: 0.167 Test Acc: 0.928
Validation loss decreased (-0.922221 --> -0.927776).  Saving model ...
Epoch: 30 cost time: 5.6303815841674805
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 7055622
model size : 28.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.776074409484863
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.643 Vali Acc: 0.411 Test Loss: 1.643 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 2.8408617973327637
Epoch: 2, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.383 Vali Acc: 0.578 Test Loss: 1.383 Test Acc: 0.578
Validation loss decreased (-0.411095 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 2.8758630752563477
Epoch: 3, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
Validation loss decreased (-0.577764 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 2.9656481742858887
Epoch: 4, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.880 Vali Acc: 0.689 Test Loss: 0.880 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.984173536300659
Epoch: 5, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716659).  Saving model ...
Epoch: 6 cost time: 2.91159725189209
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 2.861823081970215
Epoch: 7, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.505 Vali Acc: 0.778 Test Loss: 0.505 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 2.961386203765869
Epoch: 8, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.437 Vali Acc: 0.794 Test Loss: 0.437 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 2.9556381702423096
Epoch: 9, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.402 Vali Acc: 0.817 Test Loss: 0.402 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 2.7898006439208984
Epoch: 10, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.354 Vali Acc: 0.833 Test Loss: 0.354 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 2.8450796604156494
Epoch: 11, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 2.9158825874328613
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.320 Vali Acc: 0.817 Test Loss: 0.320 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9653375148773193
Epoch: 13, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 14 cost time: 2.8288891315460205
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.8383591175079346
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9507367610931396
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 2.936312198638916
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.883330 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 2.8590893745422363
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 2.5923829078674316
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6685640811920166
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 21 cost time: 2.6979923248291016
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 2.5296053886413574
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 2.519740581512451
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.167 Vali Acc: 0.939 Test Loss: 0.167 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9080495834350586
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.059067726135254
Epoch: 25, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9737792015075684
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9808480739593506
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.035338878631592
Epoch: 28, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.667006731033325
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.450 Vali Acc: 0.917 Test Loss: 0.450 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.4557366371154785
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 2090502
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.646979093551636
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.601 Vali Acc: 0.417 Test Loss: 1.601 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 4.1131086349487305
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.340 Vali Acc: 0.578 Test Loss: 1.340 Test Acc: 0.578
Validation loss decreased (-0.416651 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 3.7695889472961426
Epoch: 3, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.577764 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 4.066183090209961
Epoch: 4, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.791 Vali Acc: 0.750 Test Loss: 0.791 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749992).  Saving model ...
Epoch: 5 cost time: 3.927276134490967
Epoch: 5, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.612 Vali Acc: 0.756 Test Loss: 0.612 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755549).  Saving model ...
Epoch: 6 cost time: 3.8575246334075928
Epoch: 6, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.511 Vali Acc: 0.739 Test Loss: 0.511 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.212350130081177
Epoch: 7, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.426 Vali Acc: 0.789 Test Loss: 0.426 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788885).  Saving model ...
Epoch: 8 cost time: 3.858560085296631
Epoch: 8, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.370 Vali Acc: 0.817 Test Loss: 0.370 Test Acc: 0.817
Validation loss decreased (-0.788885 --> -0.816663).  Saving model ...
Epoch: 9 cost time: 3.854310989379883
Epoch: 9, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.354 Vali Acc: 0.811 Test Loss: 0.354 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.22543478012085
Epoch: 10, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.324 Vali Acc: 0.839 Test Loss: 0.324 Test Acc: 0.839
Validation loss decreased (-0.816663 --> -0.838886).  Saving model ...
Epoch: 11 cost time: 3.871661901473999
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.326 Vali Acc: 0.833 Test Loss: 0.326 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.069330930709839
Epoch: 12, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.308 Vali Acc: 0.833 Test Loss: 0.308 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9741528034210205
Epoch: 13, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.292 Vali Acc: 0.850 Test Loss: 0.292 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 3.8669466972351074
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.254 Vali Acc: 0.839 Test Loss: 0.254 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.317555904388428
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.235 Vali Acc: 0.867 Test Loss: 0.235 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 3.9701895713806152
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8152644634246826
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.253 Vali Acc: 0.867 Test Loss: 0.253 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.244391679763794
Epoch: 18, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.211 Vali Acc: 0.889 Test Loss: 0.211 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888887).  Saving model ...
Epoch: 19 cost time: 3.88206148147583
Epoch: 19, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
Validation loss decreased (-0.888887 --> -0.905552).  Saving model ...
Epoch: 20 cost time: 3.9343936443328857
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.414 Vali Acc: 0.856 Test Loss: 0.414 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.338008880615234
Epoch: 21, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.014729976654053
Epoch: 22, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.246 Vali Acc: 0.878 Test Loss: 0.246 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.085730791091919
Epoch: 23, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.255 Vali Acc: 0.883 Test Loss: 0.255 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.129255056381226
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.220 Vali Acc: 0.894 Test Loss: 0.220 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.901599645614624
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.208 Vali Acc: 0.889 Test Loss: 0.208 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.225401878356934
Epoch: 26, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.505 Vali Acc: 0.872 Test Loss: 0.505 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.5845224857330322
Epoch: 27, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.156 Vali Acc: 0.917 Test Loss: 0.156 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916665).  Saving model ...
Epoch: 28 cost time: 3.5486655235290527
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4564695358276367
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.922 Test Loss: 0.159 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922221).  Saving model ...
Epoch: 30 cost time: 2.951554775238037
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 7055622
model size : 28.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.213819265365601
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.643 Vali Acc: 0.411 Test Loss: 1.643 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 2.2320759296417236
Epoch: 2, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.383 Vali Acc: 0.578 Test Loss: 1.383 Test Acc: 0.578
Validation loss decreased (-0.411095 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 2.0520434379577637
Epoch: 3, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
Validation loss decreased (-0.577764 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 2.0823068618774414
Epoch: 4, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.880 Vali Acc: 0.689 Test Loss: 0.880 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6611933708190918
Epoch: 5, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716659).  Saving model ...
Epoch: 6 cost time: 2.4731316566467285
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 2.4376132488250732
Epoch: 7, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.505 Vali Acc: 0.778 Test Loss: 0.505 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 2.4522764682769775
Epoch: 8, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.437 Vali Acc: 0.794 Test Loss: 0.437 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 9 cost time: 2.3690576553344727
Epoch: 9, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.402 Vali Acc: 0.817 Test Loss: 0.402 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 2.3384358882904053
Epoch: 10, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.354 Vali Acc: 0.833 Test Loss: 0.354 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 2.4224987030029297
Epoch: 11, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 12 cost time: 2.418111801147461
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.320 Vali Acc: 0.817 Test Loss: 0.320 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3929784297943115
Epoch: 13, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.297 Vali Acc: 0.856 Test Loss: 0.297 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855553).  Saving model ...
Epoch: 14 cost time: 2.375361919403076
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.289 Vali Acc: 0.878 Test Loss: 0.289 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.196385622024536
Epoch: 15, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2003743648529053
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 2.356595993041992
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.883330 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 2.418302297592163
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 2.4551360607147217
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.314326524734497
Epoch: 20, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 21 cost time: 2.088528633117676
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.846195936203003
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 2.43731427192688
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.168 Vali Acc: 0.939 Test Loss: 0.168 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.396411418914795
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4521474838256836
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.3697731494903564
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.400836706161499
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1665728092193604
Epoch: 28, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.454676389694214
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.454 Vali Acc: 0.917 Test Loss: 0.454 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.470059871673584
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 2090502
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.119926452636719
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.602 Vali Acc: 0.417 Test Loss: 1.602 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 2.7165842056274414
Epoch: 2, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.344 Vali Acc: 0.578 Test Loss: 1.344 Test Acc: 0.578
Validation loss decreased (-0.416651 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 2.7331337928771973
Epoch: 3, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.057 Vali Acc: 0.689 Test Loss: 1.057 Test Acc: 0.689
Validation loss decreased (-0.577764 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 2.7405624389648438
Epoch: 4, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.804 Vali Acc: 0.739 Test Loss: 0.804 Test Acc: 0.739
Validation loss decreased (-0.688878 --> -0.738881).  Saving model ...
Epoch: 5 cost time: 2.680145740509033
Epoch: 5, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.632 Vali Acc: 0.744 Test Loss: 0.632 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 2.717350482940674
Epoch: 6, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.533 Vali Acc: 0.733 Test Loss: 0.533 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7488481998443604
Epoch: 7, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.446 Vali Acc: 0.778 Test Loss: 0.446 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 2.715613603591919
Epoch: 8, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.386 Vali Acc: 0.811 Test Loss: 0.386 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 9 cost time: 2.7466318607330322
Epoch: 9, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.367 Vali Acc: 0.811 Test Loss: 0.367 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 10 cost time: 2.700310468673706
Epoch: 10, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.336 Vali Acc: 0.833 Test Loss: 0.336 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 2.610699415206909
Epoch: 11, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4400343894958496
Epoch: 12, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.319 Vali Acc: 0.828 Test Loss: 0.319 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.618159532546997
Epoch: 13, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 2.695237636566162
Epoch: 14, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.272 Vali Acc: 0.839 Test Loss: 0.272 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.698542356491089
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.255 Vali Acc: 0.872 Test Loss: 0.255 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872220).  Saving model ...
Epoch: 16 cost time: 2.3801310062408447
Epoch: 16, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.278 Vali Acc: 0.861 Test Loss: 0.278 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.362393379211426
Epoch: 17, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 2.48425555229187
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.221 Vali Acc: 0.894 Test Loss: 0.221 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 2.3879141807556152
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
Validation loss decreased (-0.894442 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 2.4966189861297607
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.439 Vali Acc: 0.861 Test Loss: 0.439 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.370500087738037
Epoch: 21, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3699796199798584
Epoch: 22, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.190 Vali Acc: 0.911 Test Loss: 0.190 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.426123857498169
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.313 Vali Acc: 0.872 Test Loss: 0.313 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.463163137435913
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4115045070648193
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.171 Vali Acc: 0.928 Test Loss: 0.171 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.37790584564209
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3382725715637207
Epoch: 27, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 28 cost time: 2.311758518218994
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4267895221710205
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.917 Test Loss: 0.201 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.648639678955078
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 7055622
model size : 28.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7214505672454834
Epoch: 1, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.644 Vali Acc: 0.406 Test Loss: 1.644 Test Acc: 0.406
Validation loss decreased (inf --> -0.405539).  Saving model ...
Epoch: 2 cost time: 1.8433194160461426
Epoch: 2, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.386 Vali Acc: 0.578 Test Loss: 1.386 Test Acc: 0.578
Validation loss decreased (-0.405539 --> -0.577764).  Saving model ...
Epoch: 3 cost time: 1.837402105331421
Epoch: 3, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.114 Vali Acc: 0.700 Test Loss: 1.114 Test Acc: 0.700
Validation loss decreased (-0.577764 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 1.8346214294433594
Epoch: 4, Steps: 12 | Train Loss: 0.961 Vali Loss: 0.889 Vali Acc: 0.683 Test Loss: 0.889 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7581605911254883
Epoch: 5, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.729 Vali Acc: 0.706 Test Loss: 0.729 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705548).  Saving model ...
Epoch: 6 cost time: 1.7335538864135742
Epoch: 6, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.621 Vali Acc: 0.739 Test Loss: 0.621 Test Acc: 0.739
Validation loss decreased (-0.705548 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.4995286464691162
Epoch: 7, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.521 Vali Acc: 0.767 Test Loss: 0.521 Test Acc: 0.767
Validation loss decreased (-0.738883 --> -0.766661).  Saving model ...
Epoch: 8 cost time: 1.8175697326660156
Epoch: 8, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.454 Vali Acc: 0.778 Test Loss: 0.454 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 1.7910857200622559
Epoch: 9, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 10 cost time: 1.7734375
Epoch: 10, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 1.814664363861084
Epoch: 11, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.7655155658721924
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.332 Vali Acc: 0.817 Test Loss: 0.332 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7733516693115234
Epoch: 13, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 1.8134665489196777
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.846111536026001
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8084168434143066
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 1.9056143760681152
Epoch: 17, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.883330 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 1.4835307598114014
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 1.6200006008148193
Epoch: 19, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.275 Vali Acc: 0.917 Test Loss: 0.275 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7806205749511719
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.939 Test Loss: 0.225 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 21 cost time: 1.8742659091949463
Epoch: 21, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 1.8052048683166504
Epoch: 22, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8063435554504395
Epoch: 23, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.928 Test Loss: 0.170 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8844213485717773
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 1.7508597373962402
Epoch: 25, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 1.7017700672149658
Epoch: 26, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.57248854637146
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8475568294525146
Epoch: 28, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7983019351959229
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.300 Vali Acc: 0.939 Test Loss: 0.300 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8396046161651611
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 2090502
model size : 9.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.108112335205078
Epoch: 1, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.708 Vali Acc: 0.317 Test Loss: 1.708 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 5.342450380325317
Epoch: 2, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.518 Vali Acc: 0.506 Test Loss: 1.518 Test Acc: 0.506
Validation loss decreased (-0.316650 --> -0.505540).  Saving model ...
Epoch: 3 cost time: 5.129714488983154
Epoch: 3, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.281 Vali Acc: 0.672 Test Loss: 1.281 Test Acc: 0.672
Validation loss decreased (-0.505540 --> -0.672209).  Saving model ...
Epoch: 4 cost time: 5.067987442016602
Epoch: 4, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.026 Vali Acc: 0.711 Test Loss: 1.026 Test Acc: 0.711
Validation loss decreased (-0.672209 --> -0.711101).  Saving model ...
Epoch: 5 cost time: 5.351498126983643
Epoch: 5, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.817 Vali Acc: 0.761 Test Loss: 0.817 Test Acc: 0.761
Validation loss decreased (-0.711101 --> -0.761103).  Saving model ...
Epoch: 6 cost time: 5.176381826400757
Epoch: 6, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.952481031417847
Epoch: 7, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 4.892440319061279
Epoch: 8, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 4.804561614990234
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 4.6106507778167725
Epoch: 10, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 4.884663105010986
Epoch: 11, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.774997234344482
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.353 Vali Acc: 0.817 Test Loss: 0.353 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.6680357456207275
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.324 Vali Acc: 0.828 Test Loss: 0.324 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.056053400039673
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.301 Vali Acc: 0.844 Test Loss: 0.301 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 3.2176907062530518
Epoch: 15, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.342 Vali Acc: 0.817 Test Loss: 0.342 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4284417629241943
Epoch: 16, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.207287073135376
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.9935221672058105
Epoch: 18, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.299 Vali Acc: 0.856 Test Loss: 0.299 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 19 cost time: 4.753430366516113
Epoch: 19, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 5.03532862663269
Epoch: 20, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.258 Vali Acc: 0.917 Test Loss: 0.258 Test Acc: 0.917
Validation loss decreased (-0.861108 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 5.230689287185669
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.7835915088653564
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.065223693847656
Epoch: 23, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.207 Vali Acc: 0.928 Test Loss: 0.207 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 24 cost time: 5.190489053726196
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.346 Vali Acc: 0.917 Test Loss: 0.346 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.718965530395508
Epoch: 25, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.173 Vali Acc: 0.939 Test Loss: 0.173 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 26 cost time: 4.906086206436157
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.246379852294922
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.807636737823486
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.922905445098877
Epoch: 29, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 5.350325584411621
Epoch: 30, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 7043910
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.75930643081665
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.683 Vali Acc: 0.361 Test Loss: 1.683 Test Acc: 0.361
Validation loss decreased (inf --> -0.361094).  Saving model ...
Epoch: 2 cost time: 2.793513298034668
Epoch: 2, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.488 Vali Acc: 0.533 Test Loss: 1.488 Test Acc: 0.533
Validation loss decreased (-0.361094 --> -0.533318).  Saving model ...
Epoch: 3 cost time: 2.5872974395751953
Epoch: 3, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.277 Vali Acc: 0.639 Test Loss: 1.277 Test Acc: 0.639
Validation loss decreased (-0.533318 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 2.833517074584961
Epoch: 4, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
Validation loss decreased (-0.638876 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 2.6336984634399414
Epoch: 5, Steps: 12 | Train Loss: 0.993 Vali Loss: 0.895 Vali Acc: 0.689 Test Loss: 0.895 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6759421825408936
Epoch: 6, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 2.805375814437866
Epoch: 7, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.649 Vali Acc: 0.744 Test Loss: 0.649 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 2.69183611869812
Epoch: 8, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.573 Vali Acc: 0.778 Test Loss: 0.573 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 2.82399845123291
Epoch: 9, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.504 Vali Acc: 0.817 Test Loss: 0.504 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 2.563420295715332
Epoch: 10, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.425 Vali Acc: 0.811 Test Loss: 0.425 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8297834396362305
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
Validation loss decreased (-0.816662 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.6935064792633057
Epoch: 12, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.339 Vali Acc: 0.856 Test Loss: 0.339 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.4959373474121094
Epoch: 13, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.328 Vali Acc: 0.828 Test Loss: 0.328 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6081619262695312
Epoch: 14, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 2.245420217514038
Epoch: 15, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 2.566272258758545
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 2.377640724182129
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3030240535736084
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 19 cost time: 2.5731728076934814
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
Validation loss decreased (-0.883331 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 2.2576653957366943
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
Validation loss decreased (-0.888886 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 2.6187376976013184
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.927776 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 2.3944590091705322
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 23 cost time: 2.487232208251953
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.173 Vali Acc: 0.922 Test Loss: 0.173 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.693009376525879
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.142 Vali Acc: 0.983 Test Loss: 0.142 Test Acc: 0.983
Validation loss decreased (-0.949999 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 2.52811861038208
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.694812059402466
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.204211950302124
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.91636061668396
Epoch: 28, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.582298517227173
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.47868275642395
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9833333333333333
model parameter : 2078598
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.44221305847168
Epoch: 1, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.708 Vali Acc: 0.317 Test Loss: 1.708 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 4.1366517543792725
Epoch: 2, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.518 Vali Acc: 0.506 Test Loss: 1.518 Test Acc: 0.506
Validation loss decreased (-0.316650 --> -0.505540).  Saving model ...
Epoch: 3 cost time: 3.956749439239502
Epoch: 3, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.280 Vali Acc: 0.672 Test Loss: 1.280 Test Acc: 0.672
Validation loss decreased (-0.505540 --> -0.672209).  Saving model ...
Epoch: 4 cost time: 3.8657619953155518
Epoch: 4, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.026 Vali Acc: 0.711 Test Loss: 1.026 Test Acc: 0.711
Validation loss decreased (-0.672209 --> -0.711101).  Saving model ...
Epoch: 5 cost time: 4.191580772399902
Epoch: 5, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.817 Vali Acc: 0.761 Test Loss: 0.817 Test Acc: 0.761
Validation loss decreased (-0.711101 --> -0.761103).  Saving model ...
Epoch: 6 cost time: 4.080686569213867
Epoch: 6, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.663 Vali Acc: 0.756 Test Loss: 0.663 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5874948501586914
Epoch: 7, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.555 Vali Acc: 0.761 Test Loss: 0.555 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 4.090286731719971
Epoch: 8, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 3.9602181911468506
Epoch: 9, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.428 Vali Acc: 0.828 Test Loss: 0.428 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 3.5243988037109375
Epoch: 10, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 4.172533273696899
Epoch: 11, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9723055362701416
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.352 Vali Acc: 0.817 Test Loss: 0.352 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9489810466766357
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.109353542327881
Epoch: 14, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 4.146867990493774
Epoch: 15, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9358975887298584
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.231253147125244
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.196691274642944
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855553).  Saving model ...
Epoch: 19 cost time: 3.8175864219665527
Epoch: 19, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.285 Vali Acc: 0.872 Test Loss: 0.285 Test Acc: 0.872
Validation loss decreased (-0.855553 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 4.143968105316162
Epoch: 20, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
Validation loss decreased (-0.872219 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 4.261579513549805
Epoch: 21, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.791426420211792
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.0639190673828125
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 4.042088985443115
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.528280019760132
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.172 Vali Acc: 0.939 Test Loss: 0.172 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 26 cost time: 3.6393003463745117
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.8731932640075684
Epoch: 27, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.679684638977051
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.343 Vali Acc: 0.911 Test Loss: 0.343 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6115453243255615
Epoch: 29, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.8203415870666504
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 7043910
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.122757196426392
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.683 Vali Acc: 0.361 Test Loss: 1.683 Test Acc: 0.361
Validation loss decreased (inf --> -0.361094).  Saving model ...
Epoch: 2 cost time: 2.0455219745635986
Epoch: 2, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.489 Vali Acc: 0.533 Test Loss: 1.489 Test Acc: 0.533
Validation loss decreased (-0.361094 --> -0.533318).  Saving model ...
Epoch: 3 cost time: 2.026590585708618
Epoch: 3, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.277 Vali Acc: 0.639 Test Loss: 1.277 Test Acc: 0.639
Validation loss decreased (-0.533318 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 2.1103925704956055
Epoch: 4, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
Validation loss decreased (-0.638876 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 2.5051205158233643
Epoch: 5, Steps: 12 | Train Loss: 0.993 Vali Loss: 0.895 Vali Acc: 0.689 Test Loss: 0.895 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4514434337615967
Epoch: 6, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711104).  Saving model ...
Epoch: 7 cost time: 2.4264543056488037
Epoch: 7, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.649 Vali Acc: 0.744 Test Loss: 0.649 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 8 cost time: 2.4061219692230225
Epoch: 8, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.574 Vali Acc: 0.778 Test Loss: 0.574 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 2.4882030487060547
Epoch: 9, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.505 Vali Acc: 0.817 Test Loss: 0.505 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 2.4639859199523926
Epoch: 10, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.427 Vali Acc: 0.811 Test Loss: 0.427 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.368882417678833
Epoch: 11, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.816662 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.3681163787841797
Epoch: 12, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 2.476621150970459
Epoch: 13, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.332 Vali Acc: 0.828 Test Loss: 0.332 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.476226806640625
Epoch: 14, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.316 Vali Acc: 0.861 Test Loss: 0.316 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 2.4646048545837402
Epoch: 15, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.312 Vali Acc: 0.867 Test Loss: 0.312 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 16 cost time: 2.238337516784668
Epoch: 16, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 2.415966033935547
Epoch: 17, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4631049633026123
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.581064462661743
Epoch: 19, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.343 Vali Acc: 0.883 Test Loss: 0.343 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.399653673171997
Epoch: 20, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 2.3107283115386963
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 2.6287436485290527
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.563339948654175
Epoch: 23, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.478884696960449
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 2.2973198890686035
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.572469711303711
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4897782802581787
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.538496971130371
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.102508783340454
Epoch: 29, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.5758540630340576
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 2078598
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.754645586013794
Epoch: 1, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.709 Vali Acc: 0.317 Test Loss: 1.709 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 2.678640842437744
Epoch: 2, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.520 Vali Acc: 0.500 Test Loss: 1.520 Test Acc: 0.500
Validation loss decreased (-0.316650 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 2.536839485168457
Epoch: 3, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.283 Vali Acc: 0.667 Test Loss: 1.283 Test Acc: 0.667
Validation loss decreased (-0.499985 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 2.506293535232544
Epoch: 4, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.030 Vali Acc: 0.711 Test Loss: 1.030 Test Acc: 0.711
Validation loss decreased (-0.666654 --> -0.711101).  Saving model ...
Epoch: 5 cost time: 2.690136671066284
Epoch: 5, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.821 Vali Acc: 0.756 Test Loss: 0.821 Test Acc: 0.756
Validation loss decreased (-0.711101 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 2.705453395843506
Epoch: 6, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.667 Vali Acc: 0.750 Test Loss: 0.667 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6685335636138916
Epoch: 7, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.559 Vali Acc: 0.756 Test Loss: 0.559 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755550).  Saving model ...
Epoch: 8 cost time: 2.3751461505889893
Epoch: 8, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 2.5928103923797607
Epoch: 9, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 2.7449052333831787
Epoch: 10, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 2.7361316680908203
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.381 Vali Acc: 0.822 Test Loss: 0.381 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2873308658599854
Epoch: 12, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.368 Vali Acc: 0.811 Test Loss: 0.368 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.005359411239624
Epoch: 13, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9881973266601562
Epoch: 14, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.345 Vali Acc: 0.828 Test Loss: 0.345 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8680713176727295
Epoch: 15, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8271474838256836
Epoch: 16, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.394 Vali Acc: 0.822 Test Loss: 0.394 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8133444786071777
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 1.8404550552368164
Epoch: 18, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 19 cost time: 2.452942132949829
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
Validation loss decreased (-0.861108 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 2.2369697093963623
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.441646099090576
Epoch: 21, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 2.1893818378448486
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 23 cost time: 2.4200916290283203
Epoch: 23, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 2.0965933799743652
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.405777931213379
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 2.3514182567596436
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 2.7028865814208984
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3567893505096436
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.633665084838867
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 2.453815460205078
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.233 Vali Acc: 0.939 Test Loss: 0.233 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 7043910
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4964849948883057
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.684 Vali Acc: 0.356 Test Loss: 1.684 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 1.7434172630310059
Epoch: 2, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.493 Vali Acc: 0.522 Test Loss: 1.493 Test Acc: 0.522
Validation loss decreased (-0.355539 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 1.9199323654174805
Epoch: 3, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.287 Vali Acc: 0.622 Test Loss: 1.287 Test Acc: 0.622
Validation loss decreased (-0.522207 --> -0.622209).  Saving model ...
Epoch: 4 cost time: 1.7272610664367676
Epoch: 4, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.090 Vali Acc: 0.689 Test Loss: 1.090 Test Acc: 0.689
Validation loss decreased (-0.622209 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 1.5109729766845703
Epoch: 5, Steps: 12 | Train Loss: 0.998 Vali Loss: 0.914 Vali Acc: 0.672 Test Loss: 0.914 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.901899814605713
Epoch: 6, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.771 Vali Acc: 0.694 Test Loss: 0.771 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694437).  Saving model ...
Epoch: 7 cost time: 1.6331932544708252
Epoch: 7, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.674 Vali Acc: 0.728 Test Loss: 0.674 Test Acc: 0.728
Validation loss decreased (-0.694437 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 1.857050895690918
Epoch: 8, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.601 Vali Acc: 0.767 Test Loss: 0.601 Test Acc: 0.767
Validation loss decreased (-0.727771 --> -0.766661).  Saving model ...
Epoch: 9 cost time: 1.8477234840393066
Epoch: 9, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.535 Vali Acc: 0.806 Test Loss: 0.535 Test Acc: 0.806
Validation loss decreased (-0.766661 --> -0.805550).  Saving model ...
Epoch: 10 cost time: 1.8182153701782227
Epoch: 10, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.482 Vali Acc: 0.794 Test Loss: 0.482 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.858264684677124
Epoch: 11, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.443 Vali Acc: 0.828 Test Loss: 0.443 Test Acc: 0.828
Validation loss decreased (-0.805550 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 1.749211311340332
Epoch: 12, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 1.823317289352417
Epoch: 13, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.910452127456665
Epoch: 14, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 1.654658317565918
Epoch: 15, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.348 Vali Acc: 0.844 Test Loss: 0.348 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8976612091064453
Epoch: 16, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.319 Vali Acc: 0.878 Test Loss: 0.319 Test Acc: 0.878
Validation loss decreased (-0.849996 --> -0.877775).  Saving model ...
Epoch: 17 cost time: 1.7249236106872559
Epoch: 17, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.284 Vali Acc: 0.872 Test Loss: 0.284 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7107627391815186
Epoch: 18, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 19 cost time: 1.8572008609771729
Epoch: 19, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.807417869567871
Epoch: 20, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.899997 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 1.9366772174835205
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 1.8766322135925293
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 1.7351176738739014
Epoch: 23, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.193 Vali Acc: 0.906 Test Loss: 0.193 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8780827522277832
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
Validation loss decreased (-0.944443 --> -0.961110).  Saving model ...
Epoch: 25 cost time: 1.7176260948181152
Epoch: 25, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.657869577407837
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8375988006591797
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5440330505371094
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.961110 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 1.8644201755523682
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7234158515930176
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9666666666666667
model parameter : 2078598
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.004969358444214
Epoch: 1, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.688 Vali Acc: 0.300 Test Loss: 1.688 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 3.671398162841797
Epoch: 2, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.513 Vali Acc: 0.522 Test Loss: 1.513 Test Acc: 0.522
Validation loss decreased (-0.299983 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 3.532611131668091
Epoch: 3, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.301 Vali Acc: 0.700 Test Loss: 1.301 Test Acc: 0.700
Validation loss decreased (-0.522207 --> -0.699987).  Saving model ...
Epoch: 4 cost time: 3.7611377239227295
Epoch: 4, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.082 Vali Acc: 0.694 Test Loss: 1.082 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.933595895767212
Epoch: 5, Steps: 12 | Train Loss: 0.988 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 2.8210041522979736
Epoch: 6, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.757 Vali Acc: 0.739 Test Loss: 0.757 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 2.774510383605957
Epoch: 7, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 3.162020444869995
Epoch: 8, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.554 Vali Acc: 0.761 Test Loss: 0.554 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 3.6197433471679688
Epoch: 9, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 3.5540976524353027
Epoch: 10, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
Validation loss decreased (-0.783328 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 3.612769603729248
Epoch: 11, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.384 Vali Acc: 0.833 Test Loss: 0.384 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 3.334423542022705
Epoch: 12, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 3.583951234817505
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.298 Vali Acc: 0.817 Test Loss: 0.298 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6285924911499023
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.299 Vali Acc: 0.839 Test Loss: 0.299 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 15 cost time: 4.022562265396118
Epoch: 15, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.293 Vali Acc: 0.822 Test Loss: 0.293 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.459954023361206
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.281 Vali Acc: 0.817 Test Loss: 0.281 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.15096640586853
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.285 Vali Acc: 0.833 Test Loss: 0.285 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5953404903411865
Epoch: 18, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.281 Vali Acc: 0.839 Test Loss: 0.281 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 19 cost time: 4.170277833938599
Epoch: 19, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.287 Vali Acc: 0.833 Test Loss: 0.287 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8196258544921875
Epoch: 20, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.283 Vali Acc: 0.844 Test Loss: 0.283 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844442).  Saving model ...
Epoch: 21 cost time: 4.161590099334717
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.269 Vali Acc: 0.828 Test Loss: 0.269 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8965044021606445
Epoch: 22, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.287 Vali Acc: 0.861 Test Loss: 0.287 Test Acc: 0.861
Validation loss decreased (-0.844442 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 4.052421569824219
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.324 Vali Acc: 0.850 Test Loss: 0.324 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.602663993835449
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.231 Vali Acc: 0.883 Test Loss: 0.231 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 25 cost time: 4.195546388626099
Epoch: 25, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.253 Vali Acc: 0.872 Test Loss: 0.253 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8665874004364014
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.266 Vali Acc: 0.894 Test Loss: 0.266 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 4.192220449447632
Epoch: 27, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.260 Vali Acc: 0.889 Test Loss: 0.260 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8389837741851807
Epoch: 28, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.220 Vali Acc: 0.900 Test Loss: 0.220 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 29 cost time: 4.0326056480407715
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.339 Vali Acc: 0.883 Test Loss: 0.339 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5553431510925293
Epoch: 30, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.368 Vali Acc: 0.889 Test Loss: 0.368 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3528390
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.73522162437439
Epoch: 1, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.796 Vali Acc: 0.194 Test Loss: 1.796 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 2.2147116661071777
Epoch: 2, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.618 Vali Acc: 0.361 Test Loss: 1.618 Test Acc: 0.361
Validation loss decreased (-0.194426 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 2.459404706954956
Epoch: 3, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.417 Vali Acc: 0.589 Test Loss: 1.417 Test Acc: 0.589
Validation loss decreased (-0.361095 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 2.5190279483795166
Epoch: 4, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.205 Vali Acc: 0.639 Test Loss: 1.205 Test Acc: 0.639
Validation loss decreased (-0.588875 --> -0.638877).  Saving model ...
Epoch: 5 cost time: 2.229912519454956
Epoch: 5, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.015 Vali Acc: 0.678 Test Loss: 1.015 Test Acc: 0.678
Validation loss decreased (-0.638877 --> -0.677768).  Saving model ...
Epoch: 6 cost time: 2.481668472290039
Epoch: 6, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.858 Vali Acc: 0.689 Test Loss: 0.858 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 2.439730167388916
Epoch: 7, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.743 Vali Acc: 0.722 Test Loss: 0.743 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 2.1231021881103516
Epoch: 8, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.646 Vali Acc: 0.744 Test Loss: 0.646 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 2.4528191089630127
Epoch: 9, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.554 Vali Acc: 0.767 Test Loss: 0.554 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 2.4474213123321533
Epoch: 10, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.497 Vali Acc: 0.794 Test Loss: 0.497 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 2.2906227111816406
Epoch: 11, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.451 Vali Acc: 0.817 Test Loss: 0.451 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 2.4634406566619873
Epoch: 12, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.417 Vali Acc: 0.828 Test Loss: 0.417 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 2.371084690093994
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.389 Vali Acc: 0.828 Test Loss: 0.389 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 2.2575366497039795
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 2.2985477447509766
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.061124324798584
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 2.1670546531677246
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 2.2723543643951416
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.070711135864258
Epoch: 19, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9320833683013916
Epoch: 20, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3425562381744385
Epoch: 21, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894441).  Saving model ...
Epoch: 22 cost time: 2.192383050918579
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.286 Vali Acc: 0.894 Test Loss: 0.286 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 2.0645358562469482
Epoch: 23, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.259352684020996
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 2.142082452774048
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7786424160003662
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.351 Vali Acc: 0.872 Test Loss: 0.351 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6639962196350098
Epoch: 27, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.249 Vali Acc: 0.883 Test Loss: 0.249 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6446874141693115
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.211 Vali Acc: 0.917 Test Loss: 0.211 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 29 cost time: 1.8709216117858887
Epoch: 29, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8330426216125488
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.421 Vali Acc: 0.878 Test Loss: 0.421 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1045638
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.547433137893677
Epoch: 1, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.688 Vali Acc: 0.300 Test Loss: 1.688 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 2.8514575958251953
Epoch: 2, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.513 Vali Acc: 0.522 Test Loss: 1.513 Test Acc: 0.522
Validation loss decreased (-0.299983 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 3.0685722827911377
Epoch: 3, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.301 Vali Acc: 0.700 Test Loss: 1.301 Test Acc: 0.700
Validation loss decreased (-0.522207 --> -0.699987).  Saving model ...
Epoch: 4 cost time: 3.2636148929595947
Epoch: 4, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.082 Vali Acc: 0.694 Test Loss: 1.082 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.929163932800293
Epoch: 5, Steps: 12 | Train Loss: 0.988 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 2.8577096462249756
Epoch: 6, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.757 Vali Acc: 0.739 Test Loss: 0.757 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 3.0931460857391357
Epoch: 7, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761105).  Saving model ...
Epoch: 8 cost time: 3.29361891746521
Epoch: 8, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.554 Vali Acc: 0.761 Test Loss: 0.554 Test Acc: 0.761
Validation loss decreased (-0.761105 --> -0.761106).  Saving model ...
Epoch: 9 cost time: 2.9024949073791504
Epoch: 9, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783328).  Saving model ...
Epoch: 10 cost time: 2.9306259155273438
Epoch: 10, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.424 Vali Acc: 0.828 Test Loss: 0.424 Test Acc: 0.828
Validation loss decreased (-0.783328 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 3.0875346660614014
Epoch: 11, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.384 Vali Acc: 0.833 Test Loss: 0.384 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 3.276136875152588
Epoch: 12, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.327 Vali Acc: 0.833 Test Loss: 0.327 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 3.080955982208252
Epoch: 13, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.299 Vali Acc: 0.822 Test Loss: 0.299 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9658288955688477
Epoch: 14, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 3.030940532684326
Epoch: 15, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.289 Vali Acc: 0.822 Test Loss: 0.289 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.305257797241211
Epoch: 16, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.283 Vali Acc: 0.817 Test Loss: 0.283 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.093076229095459
Epoch: 17, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.286 Vali Acc: 0.828 Test Loss: 0.286 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.839247703552246
Epoch: 18, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.281 Vali Acc: 0.828 Test Loss: 0.281 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.054147958755493
Epoch: 19, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.286 Vali Acc: 0.833 Test Loss: 0.286 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.304858922958374
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.283 Vali Acc: 0.856 Test Loss: 0.283 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 21 cost time: 3.045637369155884
Epoch: 21, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.270 Vali Acc: 0.817 Test Loss: 0.270 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.830734968185425
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.274 Vali Acc: 0.861 Test Loss: 0.274 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 2.881533145904541
Epoch: 23, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2279789447784424
Epoch: 24, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.229 Vali Acc: 0.894 Test Loss: 0.229 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 3.2572836875915527
Epoch: 25, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.236 Vali Acc: 0.872 Test Loss: 0.236 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8957574367523193
Epoch: 26, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.260 Vali Acc: 0.872 Test Loss: 0.260 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9099409580230713
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7682082653045654
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.292 Vali Acc: 0.878 Test Loss: 0.292 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6401255130767822
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.28559947013855
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.400 Vali Acc: 0.861 Test Loss: 0.400 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 3528390
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.002716302871704
Epoch: 1, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.796 Vali Acc: 0.194 Test Loss: 1.796 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 2.072436809539795
Epoch: 2, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.618 Vali Acc: 0.361 Test Loss: 1.618 Test Acc: 0.361
Validation loss decreased (-0.194426 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 2.071593999862671
Epoch: 3, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.417 Vali Acc: 0.589 Test Loss: 1.417 Test Acc: 0.589
Validation loss decreased (-0.361095 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 2.0293588638305664
Epoch: 4, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.205 Vali Acc: 0.639 Test Loss: 1.205 Test Acc: 0.639
Validation loss decreased (-0.588875 --> -0.638877).  Saving model ...
Epoch: 5 cost time: 2.061357021331787
Epoch: 5, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.015 Vali Acc: 0.678 Test Loss: 1.015 Test Acc: 0.678
Validation loss decreased (-0.638877 --> -0.677768).  Saving model ...
Epoch: 6 cost time: 2.083778142929077
Epoch: 6, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.858 Vali Acc: 0.689 Test Loss: 0.858 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 2.2685413360595703
Epoch: 7, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.743 Vali Acc: 0.722 Test Loss: 0.743 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 2.2132208347320557
Epoch: 8, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.646 Vali Acc: 0.744 Test Loss: 0.646 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 2.2665927410125732
Epoch: 9, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.554 Vali Acc: 0.767 Test Loss: 0.554 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 2.188793420791626
Epoch: 10, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.497 Vali Acc: 0.794 Test Loss: 0.497 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 2.164003372192383
Epoch: 11, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.451 Vali Acc: 0.817 Test Loss: 0.451 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 2.007871150970459
Epoch: 12, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.417 Vali Acc: 0.828 Test Loss: 0.417 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 13 cost time: 2.2530312538146973
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.389 Vali Acc: 0.828 Test Loss: 0.389 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 2.1967108249664307
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.366 Vali Acc: 0.833 Test Loss: 0.366 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 2.2596375942230225
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1759326457977295
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.336 Vali Acc: 0.844 Test Loss: 0.336 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 1.961850643157959
Epoch: 17, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.835400104522705
Epoch: 18, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.316 Vali Acc: 0.850 Test Loss: 0.316 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2353732585906982
Epoch: 19, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2347872257232666
Epoch: 20, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.294 Vali Acc: 0.856 Test Loss: 0.294 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3127729892730713
Epoch: 21, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
Validation loss decreased (-0.861108 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 2.2317099571228027
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1145238876342773
Epoch: 23, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.258 Vali Acc: 0.872 Test Loss: 0.258 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.266417980194092
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 2.386019229888916
Epoch: 25, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3182570934295654
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.30602765083313
Epoch: 27, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.364532709121704
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.209 Vali Acc: 0.928 Test Loss: 0.209 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927776).  Saving model ...
Epoch: 29 cost time: 2.294283390045166
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2826364040374756
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.425 Vali Acc: 0.867 Test Loss: 0.425 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 1045638
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.149374723434448
Epoch: 1, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.689 Vali Acc: 0.300 Test Loss: 1.689 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 2.3763835430145264
Epoch: 2, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.513 Vali Acc: 0.522 Test Loss: 1.513 Test Acc: 0.522
Validation loss decreased (-0.299983 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 2.360332489013672
Epoch: 3, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.302 Vali Acc: 0.700 Test Loss: 1.302 Test Acc: 0.700
Validation loss decreased (-0.522207 --> -0.699987).  Saving model ...
Epoch: 4 cost time: 2.3540468215942383
Epoch: 4, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.083 Vali Acc: 0.694 Test Loss: 1.083 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4060208797454834
Epoch: 5, Steps: 12 | Train Loss: 0.988 Vali Loss: 0.898 Vali Acc: 0.711 Test Loss: 0.898 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 2.4361395835876465
Epoch: 6, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.759 Vali Acc: 0.739 Test Loss: 0.759 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 2.438821315765381
Epoch: 7, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.650 Vali Acc: 0.767 Test Loss: 0.650 Test Acc: 0.767
Validation loss decreased (-0.738881 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 2.5553207397460938
Epoch: 8, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.558 Vali Acc: 0.761 Test Loss: 0.558 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3375260829925537
Epoch: 9, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.491 Vali Acc: 0.778 Test Loss: 0.491 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777773).  Saving model ...
Epoch: 10 cost time: 2.367173433303833
Epoch: 10, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.432 Vali Acc: 0.822 Test Loss: 0.432 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 11 cost time: 2.5259671211242676
Epoch: 11, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.4136319160461426
Epoch: 12, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.370 Vali Acc: 0.806 Test Loss: 0.370 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5743443965911865
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.347 Vali Acc: 0.811 Test Loss: 0.347 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.38250470161438
Epoch: 14, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.335 Vali Acc: 0.811 Test Loss: 0.335 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3077518939971924
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.315 Vali Acc: 0.828 Test Loss: 0.315 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.285814046859741
Epoch: 16, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.316 Vali Acc: 0.822 Test Loss: 0.316 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2344980239868164
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.312 Vali Acc: 0.806 Test Loss: 0.312 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1974599361419678
Epoch: 18, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 2.3258655071258545
Epoch: 19, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.296 Vali Acc: 0.828 Test Loss: 0.296 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1925547122955322
Epoch: 20, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1210923194885254
Epoch: 21, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.267 Vali Acc: 0.861 Test Loss: 0.267 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 2.16091251373291
Epoch: 22, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0696065425872803
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.327 Vali Acc: 0.850 Test Loss: 0.327 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.183706283569336
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
Validation loss decreased (-0.861108 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 2.2243666648864746
Epoch: 25, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1786632537841797
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.241 Vali Acc: 0.878 Test Loss: 0.241 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1255083084106445
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8589789867401123
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.766986608505249
Epoch: 29, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.426 Vali Acc: 0.872 Test Loss: 0.426 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.19728946685791
Epoch: 30, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3528390
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5658960342407227
Epoch: 1, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.796 Vali Acc: 0.194 Test Loss: 1.796 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 1.5957562923431396
Epoch: 2, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.618 Vali Acc: 0.361 Test Loss: 1.618 Test Acc: 0.361
Validation loss decreased (-0.194426 --> -0.361095).  Saving model ...
Epoch: 3 cost time: 1.749540090560913
Epoch: 3, Steps: 12 | Train Loss: 1.541 Vali Loss: 1.417 Vali Acc: 0.583 Test Loss: 1.417 Test Acc: 0.583
Validation loss decreased (-0.361095 --> -0.583319).  Saving model ...
Epoch: 4 cost time: 1.790846347808838
Epoch: 4, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.205 Vali Acc: 0.639 Test Loss: 1.205 Test Acc: 0.639
Validation loss decreased (-0.583319 --> -0.638877).  Saving model ...
Epoch: 5 cost time: 1.8119235038757324
Epoch: 5, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.016 Vali Acc: 0.678 Test Loss: 1.016 Test Acc: 0.678
Validation loss decreased (-0.638877 --> -0.677768).  Saving model ...
Epoch: 6 cost time: 1.7932114601135254
Epoch: 6, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.860 Vali Acc: 0.689 Test Loss: 0.860 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 1.8249237537384033
Epoch: 7, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.745 Vali Acc: 0.722 Test Loss: 0.745 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 1.8111732006072998
Epoch: 8, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.648 Vali Acc: 0.744 Test Loss: 0.648 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 1.773310661315918
Epoch: 9, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.556 Vali Acc: 0.767 Test Loss: 0.556 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 1.7440464496612549
Epoch: 10, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 1.612914800643921
Epoch: 11, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.453 Vali Acc: 0.811 Test Loss: 0.453 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 1.8244593143463135
Epoch: 12, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.420 Vali Acc: 0.822 Test Loss: 0.420 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.7910523414611816
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 1.8388912677764893
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8366944789886475
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.355 Vali Acc: 0.822 Test Loss: 0.355 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7026660442352295
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 1.6581406593322754
Epoch: 17, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 1.7200725078582764
Epoch: 18, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8347525596618652
Epoch: 19, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.313 Vali Acc: 0.844 Test Loss: 0.313 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.833348035812378
Epoch: 20, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7861199378967285
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 1.9118051528930664
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.298 Vali Acc: 0.883 Test Loss: 0.298 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 1.816349983215332
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.270 Vali Acc: 0.872 Test Loss: 0.270 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7104413509368896
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 1.5765697956085205
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.303 Vali Acc: 0.872 Test Loss: 0.303 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7599208354949951
Epoch: 26, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.399 Vali Acc: 0.856 Test Loss: 0.399 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8078093528747559
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.7701101303100586
Epoch: 28, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8258206844329834
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.316 Vali Acc: 0.872 Test Loss: 0.316 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.853165626525879
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1045638
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.8492958545684814
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.728 Vali Acc: 0.256 Test Loss: 1.728 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 3.417975902557373
Epoch: 2, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.589 Vali Acc: 0.406 Test Loss: 1.589 Test Acc: 0.406
Validation loss decreased (-0.255538 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 3.461674690246582
Epoch: 3, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.428 Vali Acc: 0.578 Test Loss: 1.428 Test Acc: 0.578
Validation loss decreased (-0.405540 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 3.4019968509674072
Epoch: 4, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
Validation loss decreased (-0.577763 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 3.3503293991088867
Epoch: 5, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.055 Vali Acc: 0.706 Test Loss: 1.055 Test Acc: 0.706
Validation loss decreased (-0.649988 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 3.145637273788452
Epoch: 6, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.884 Vali Acc: 0.739 Test Loss: 0.884 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 3.421340227127075
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.745 Vali Acc: 0.739 Test Loss: 0.745 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 3.5090153217315674
Epoch: 8, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.652 Vali Acc: 0.744 Test Loss: 0.652 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 3.5332911014556885
Epoch: 9, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 3.234971284866333
Epoch: 10, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 2.9173834323883057
Epoch: 11, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.477 Vali Acc: 0.794 Test Loss: 0.477 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1571686267852783
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 3.2581140995025635
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.433 Vali Acc: 0.817 Test Loss: 0.433 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2360289096832275
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.410 Vali Acc: 0.839 Test Loss: 0.410 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.954988956451416
Epoch: 15, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.965766429901123
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1584784984588623
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.353 Vali Acc: 0.883 Test Loss: 0.353 Test Acc: 0.883
Validation loss decreased (-0.849995 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 3.225353479385376
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.309 Vali Acc: 0.878 Test Loss: 0.309 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.205667018890381
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.329 Vali Acc: 0.872 Test Loss: 0.329 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8969805240631104
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2870028018951416
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 3.2506988048553467
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.310 Vali Acc: 0.894 Test Loss: 0.310 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 3.2250659465789795
Epoch: 23, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 3.1323587894439697
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3637876510620117
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.282 Vali Acc: 0.911 Test Loss: 0.282 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 3.484722852706909
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4517719745635986
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4818551540374756
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.4108407497406006
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 3.3052563667297363
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1770630
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.228565216064453
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.800 Vali Acc: 0.272 Test Loss: 1.800 Test Acc: 0.272
Validation loss decreased (inf --> -0.272204).  Saving model ...
Epoch: 2 cost time: 2.250962972640991
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.643 Vali Acc: 0.372 Test Loss: 1.643 Test Acc: 0.372
Validation loss decreased (-0.272204 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 2.313497304916382
Epoch: 3, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.457 Vali Acc: 0.489 Test Loss: 1.457 Test Acc: 0.489
Validation loss decreased (-0.372206 --> -0.488874).  Saving model ...
Epoch: 4 cost time: 2.3659021854400635
Epoch: 4, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.258 Vali Acc: 0.656 Test Loss: 1.258 Test Acc: 0.656
Validation loss decreased (-0.488874 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 2.344392776489258
Epoch: 5, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.066 Vali Acc: 0.672 Test Loss: 1.066 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 2.365513563156128
Epoch: 6, Steps: 12 | Train Loss: 0.931 Vali Loss: 0.889 Vali Acc: 0.683 Test Loss: 0.889 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 7 cost time: 2.3799948692321777
Epoch: 7, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.753 Vali Acc: 0.678 Test Loss: 0.753 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2882845401763916
Epoch: 8, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.668 Vali Acc: 0.706 Test Loss: 0.668 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705549).  Saving model ...
Epoch: 9 cost time: 2.2809972763061523
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.603 Vali Acc: 0.706 Test Loss: 0.603 Test Acc: 0.706
Validation loss decreased (-0.705549 --> -0.705550).  Saving model ...
Epoch: 10 cost time: 2.356111764907837
Epoch: 10, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.554 Vali Acc: 0.744 Test Loss: 0.554 Test Acc: 0.744
Validation loss decreased (-0.705550 --> -0.744439).  Saving model ...
Epoch: 11 cost time: 2.448455333709717
Epoch: 11, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 12 cost time: 2.3752689361572266
Epoch: 12, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.462 Vali Acc: 0.806 Test Loss: 0.462 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 2.3547823429107666
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.435 Vali Acc: 0.822 Test Loss: 0.435 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 2.310039758682251
Epoch: 14, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 2.276621103286743
Epoch: 15, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 2.384488821029663
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 2.376880168914795
Epoch: 17, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 2.377901554107666
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3755998611450195
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 2.269373893737793
Epoch: 20, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 2.1573610305786133
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.158592939376831
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 2.400885581970215
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.899997 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 2.389585256576538
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 2.4055540561676025
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 2.306065320968628
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.245 Vali Acc: 0.894 Test Loss: 0.245 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1251468658447266
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.295351982116699
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4381935596466064
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4544246196746826
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 529158
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.274681806564331
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.728 Vali Acc: 0.256 Test Loss: 1.728 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 2.317906618118286
Epoch: 2, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.589 Vali Acc: 0.406 Test Loss: 1.589 Test Acc: 0.406
Validation loss decreased (-0.255538 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 1.8973078727722168
Epoch: 3, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.428 Vali Acc: 0.578 Test Loss: 1.428 Test Acc: 0.578
Validation loss decreased (-0.405540 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 1.9851603507995605
Epoch: 4, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
Validation loss decreased (-0.577763 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 1.8308215141296387
Epoch: 5, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.055 Vali Acc: 0.706 Test Loss: 1.055 Test Acc: 0.706
Validation loss decreased (-0.649988 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 1.8342716693878174
Epoch: 6, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.884 Vali Acc: 0.739 Test Loss: 0.884 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 2.408050537109375
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.745 Vali Acc: 0.739 Test Loss: 0.745 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 2.299727201461792
Epoch: 8, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.652 Vali Acc: 0.744 Test Loss: 0.652 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 2.1654269695281982
Epoch: 9, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.586 Vali Acc: 0.756 Test Loss: 0.586 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 2.315261125564575
Epoch: 10, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
Validation loss decreased (-0.755550 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 2.1993906497955322
Epoch: 11, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.476 Vali Acc: 0.794 Test Loss: 0.476 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2506422996520996
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
Validation loss decreased (-0.799995 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 2.5787835121154785
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.432 Vali Acc: 0.817 Test Loss: 0.432 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.448651075363159
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.410 Vali Acc: 0.839 Test Loss: 0.410 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.343595027923584
Epoch: 15, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.378 Vali Acc: 0.839 Test Loss: 0.378 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5656542778015137
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4087815284729004
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.352 Vali Acc: 0.883 Test Loss: 0.352 Test Acc: 0.883
Validation loss decreased (-0.849995 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 2.2252180576324463
Epoch: 18, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.308 Vali Acc: 0.878 Test Loss: 0.308 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5117428302764893
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.328 Vali Acc: 0.872 Test Loss: 0.328 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.463454008102417
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.342 Vali Acc: 0.861 Test Loss: 0.342 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.262641668319702
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 22 cost time: 2.557860851287842
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894441).  Saving model ...
Epoch: 23 cost time: 2.3847928047180176
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 2.3228342533111572
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5329091548919678
Epoch: 25, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 2.3977105617523193
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.209629774093628
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 28 cost time: 2.5946857929229736
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.258 Vali Acc: 0.911 Test Loss: 0.258 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4724698066711426
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1424734592437744
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 1770630
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8800089359283447
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.800 Vali Acc: 0.272 Test Loss: 1.800 Test Acc: 0.272
Validation loss decreased (inf --> -0.272204).  Saving model ...
Epoch: 2 cost time: 2.1294400691986084
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.643 Vali Acc: 0.372 Test Loss: 1.643 Test Acc: 0.372
Validation loss decreased (-0.272204 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 1.8120481967926025
Epoch: 3, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.457 Vali Acc: 0.489 Test Loss: 1.457 Test Acc: 0.489
Validation loss decreased (-0.372206 --> -0.488874).  Saving model ...
Epoch: 4 cost time: 2.0687472820281982
Epoch: 4, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.258 Vali Acc: 0.656 Test Loss: 1.258 Test Acc: 0.656
Validation loss decreased (-0.488874 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 2.133542537689209
Epoch: 5, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.066 Vali Acc: 0.672 Test Loss: 1.066 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 2.03936767578125
Epoch: 6, Steps: 12 | Train Loss: 0.931 Vali Loss: 0.890 Vali Acc: 0.683 Test Loss: 0.890 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 7 cost time: 1.8737106323242188
Epoch: 7, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.754 Vali Acc: 0.678 Test Loss: 0.754 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0926272869110107
Epoch: 8, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.668 Vali Acc: 0.706 Test Loss: 0.668 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705549).  Saving model ...
Epoch: 9 cost time: 1.9196209907531738
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.603 Vali Acc: 0.706 Test Loss: 0.603 Test Acc: 0.706
Validation loss decreased (-0.705549 --> -0.705550).  Saving model ...
Epoch: 10 cost time: 1.9794399738311768
Epoch: 10, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.554 Vali Acc: 0.744 Test Loss: 0.554 Test Acc: 0.744
Validation loss decreased (-0.705550 --> -0.744439).  Saving model ...
Epoch: 11 cost time: 2.1178579330444336
Epoch: 11, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.514 Vali Acc: 0.750 Test Loss: 0.514 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 12 cost time: 1.9683294296264648
Epoch: 12, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.462 Vali Acc: 0.806 Test Loss: 0.462 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 1.9844236373901367
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.435 Vali Acc: 0.822 Test Loss: 0.435 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 2.1532962322235107
Epoch: 14, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.395 Vali Acc: 0.822 Test Loss: 0.395 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 2.177812099456787
Epoch: 15, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.371 Vali Acc: 0.833 Test Loss: 0.371 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 1.828939437866211
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.351 Vali Acc: 0.861 Test Loss: 0.351 Test Acc: 0.861
Validation loss decreased (-0.833330 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 1.9573378562927246
Epoch: 17, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.334 Vali Acc: 0.861 Test Loss: 0.334 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 2.0948026180267334
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.090101480484009
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.296 Vali Acc: 0.872 Test Loss: 0.296 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.8253705501556396
Epoch: 20, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 2.1175436973571777
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.281 Vali Acc: 0.861 Test Loss: 0.281 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6531071662902832
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.258 Vali Acc: 0.900 Test Loss: 0.258 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.8641881942749023
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.899997 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 1.975926399230957
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 1.9522957801818848
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 1.554936170578003
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.247 Vali Acc: 0.894 Test Loss: 0.247 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8425648212432861
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0572760105133057
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8178775310516357
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7177512645721436
Epoch: 30, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 529158
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6126222610473633
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.728 Vali Acc: 0.256 Test Loss: 1.728 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 1.8718390464782715
Epoch: 2, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.589 Vali Acc: 0.406 Test Loss: 1.589 Test Acc: 0.406
Validation loss decreased (-0.255538 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 1.7451598644256592
Epoch: 3, Steps: 12 | Train Loss: 1.509 Vali Loss: 1.428 Vali Acc: 0.578 Test Loss: 1.428 Test Acc: 0.578
Validation loss decreased (-0.405540 --> -0.577763).  Saving model ...
Epoch: 4 cost time: 1.291825294494629
Epoch: 4, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
Validation loss decreased (-0.577763 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 2.0386805534362793
Epoch: 5, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.056 Vali Acc: 0.706 Test Loss: 1.056 Test Acc: 0.706
Validation loss decreased (-0.649988 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 1.7939536571502686
Epoch: 6, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.885 Vali Acc: 0.739 Test Loss: 0.885 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 1.8297243118286133
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.747 Vali Acc: 0.739 Test Loss: 0.747 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 2.0253937244415283
Epoch: 8, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.655 Vali Acc: 0.744 Test Loss: 0.655 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 1.9984819889068604
Epoch: 9, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.591 Vali Acc: 0.756 Test Loss: 0.591 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 1.8678638935089111
Epoch: 10, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.540 Vali Acc: 0.794 Test Loss: 0.540 Test Acc: 0.794
Validation loss decreased (-0.755550 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 1.9444265365600586
Epoch: 11, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0171422958374023
Epoch: 12, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
Validation loss decreased (-0.794439 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 2.0192623138427734
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.444 Vali Acc: 0.806 Test Loss: 0.444 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.76985502243042
Epoch: 14, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.423 Vali Acc: 0.828 Test Loss: 0.423 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8032829761505127
Epoch: 15, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.074258804321289
Epoch: 16, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8083858489990234
Epoch: 17, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
Validation loss decreased (-0.844440 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.9054126739501953
Epoch: 18, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.340 Vali Acc: 0.861 Test Loss: 0.340 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0186986923217773
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9989550113677979
Epoch: 20, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.397 Vali Acc: 0.856 Test Loss: 0.397 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9160852432250977
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.910888671875
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 2.0447726249694824
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 24 cost time: 1.9931292533874512
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.352 Vali Acc: 0.889 Test Loss: 0.352 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 25 cost time: 1.7324738502502441
Epoch: 25, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905552).  Saving model ...
Epoch: 26 cost time: 1.8140974044799805
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.133906364440918
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.291 Vali Acc: 0.906 Test Loss: 0.291 Test Acc: 0.906
Validation loss decreased (-0.905552 --> -0.905553).  Saving model ...
Epoch: 28 cost time: 1.746814250946045
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 1.8245930671691895
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9384572505950928
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1770630
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0055956840515137
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.798 Vali Acc: 0.272 Test Loss: 1.798 Test Acc: 0.272
Validation loss decreased (inf --> -0.272204).  Saving model ...
Epoch: 2 cost time: 1.716372013092041
Epoch: 2, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.645 Vali Acc: 0.372 Test Loss: 1.645 Test Acc: 0.372
Validation loss decreased (-0.272204 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 1.8367040157318115
Epoch: 3, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.463 Vali Acc: 0.483 Test Loss: 1.463 Test Acc: 0.483
Validation loss decreased (-0.372206 --> -0.483319).  Saving model ...
Epoch: 4 cost time: 1.8101906776428223
Epoch: 4, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.267 Vali Acc: 0.650 Test Loss: 1.267 Test Acc: 0.650
Validation loss decreased (-0.483319 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 1.8188261985778809
Epoch: 5, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.078 Vali Acc: 0.667 Test Loss: 1.078 Test Acc: 0.667
Validation loss decreased (-0.649987 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 1.7905793190002441
Epoch: 6, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.902 Vali Acc: 0.672 Test Loss: 0.902 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672213).  Saving model ...
Epoch: 7 cost time: 1.7274730205535889
Epoch: 7, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.770 Vali Acc: 0.667 Test Loss: 0.770 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8155982494354248
Epoch: 8, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.688 Vali Acc: 0.689 Test Loss: 0.688 Test Acc: 0.689
Validation loss decreased (-0.672213 --> -0.688882).  Saving model ...
Epoch: 9 cost time: 1.7695026397705078
Epoch: 9, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.623 Vali Acc: 0.694 Test Loss: 0.623 Test Acc: 0.694
Validation loss decreased (-0.688882 --> -0.694438).  Saving model ...
Epoch: 10 cost time: 1.8254704475402832
Epoch: 10, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.574 Vali Acc: 0.733 Test Loss: 0.574 Test Acc: 0.733
Validation loss decreased (-0.694438 --> -0.733328).  Saving model ...
Epoch: 11 cost time: 1.791968822479248
Epoch: 11, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.529 Vali Acc: 0.739 Test Loss: 0.529 Test Acc: 0.739
Validation loss decreased (-0.733328 --> -0.738884).  Saving model ...
Epoch: 12 cost time: 1.654202938079834
Epoch: 12, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.478 Vali Acc: 0.794 Test Loss: 0.478 Test Acc: 0.794
Validation loss decreased (-0.738884 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 1.7990591526031494
Epoch: 13, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.449 Vali Acc: 0.822 Test Loss: 0.449 Test Acc: 0.822
Validation loss decreased (-0.794440 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 1.808107852935791
Epoch: 14, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.409 Vali Acc: 0.817 Test Loss: 0.409 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7799577713012695
Epoch: 15, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.384 Vali Acc: 0.833 Test Loss: 0.384 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.7944269180297852
Epoch: 16, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.363 Vali Acc: 0.861 Test Loss: 0.363 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 1.7689094543457031
Epoch: 17, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.346 Vali Acc: 0.861 Test Loss: 0.346 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.7327806949615479
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.320 Vali Acc: 0.856 Test Loss: 0.320 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7650339603424072
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 20 cost time: 1.4590840339660645
Epoch: 20, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.283 Vali Acc: 0.883 Test Loss: 0.283 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 21 cost time: 1.7114837169647217
Epoch: 21, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.290 Vali Acc: 0.861 Test Loss: 0.290 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6659276485443115
Epoch: 22, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.5892648696899414
Epoch: 23, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.899997 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 1.5714197158813477
Epoch: 24, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6461617946624756
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.933331 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 1.267106294631958
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6466012001037598
Epoch: 27, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6638882160186768
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.661226749420166
Epoch: 29, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.183 Vali Acc: 0.939 Test Loss: 0.183 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5923688411712646
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 529158
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.864553689956665
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.793 Vali Acc: 0.189 Test Loss: 1.793 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 2.9470152854919434
Epoch: 2, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.712 Vali Acc: 0.311 Test Loss: 1.712 Test Acc: 0.311
Validation loss decreased (-0.188871 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 2.948077440261841
Epoch: 3, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.610 Vali Acc: 0.417 Test Loss: 1.610 Test Acc: 0.417
Validation loss decreased (-0.311094 --> -0.416651).  Saving model ...
Epoch: 4 cost time: 3.328878164291382
Epoch: 4, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.492 Vali Acc: 0.556 Test Loss: 1.492 Test Acc: 0.556
Validation loss decreased (-0.416651 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 3.296663522720337
Epoch: 5, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.351 Vali Acc: 0.650 Test Loss: 1.351 Test Acc: 0.650
Validation loss decreased (-0.555541 --> -0.649986).  Saving model ...
Epoch: 6 cost time: 3.2191240787506104
Epoch: 6, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.196 Vali Acc: 0.661 Test Loss: 1.196 Test Acc: 0.661
Validation loss decreased (-0.649986 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 3.225267171859741
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.042 Vali Acc: 0.694 Test Loss: 1.042 Test Acc: 0.694
Validation loss decreased (-0.661099 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 3.315783739089966
Epoch: 8, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.914 Vali Acc: 0.694 Test Loss: 0.914 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 9 cost time: 3.3047165870666504
Epoch: 9, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.811 Vali Acc: 0.711 Test Loss: 0.811 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 3.217540979385376
Epoch: 10, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.742 Vali Acc: 0.700 Test Loss: 0.742 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.189091205596924
Epoch: 11, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 3.3478667736053467
Epoch: 12, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.634 Vali Acc: 0.772 Test Loss: 0.634 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 3.3214268684387207
Epoch: 13, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.595 Vali Acc: 0.767 Test Loss: 0.595 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2224457263946533
Epoch: 14, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.539 Vali Acc: 0.778 Test Loss: 0.539 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 3.1608457565307617
Epoch: 15, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.466 Vali Acc: 0.806 Test Loss: 0.466 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 3.1809239387512207
Epoch: 16, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.423 Vali Acc: 0.828 Test Loss: 0.423 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 3.3010611534118652
Epoch: 17, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.392 Vali Acc: 0.817 Test Loss: 0.392 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1758947372436523
Epoch: 18, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 3.127764940261841
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.377 Vali Acc: 0.806 Test Loss: 0.377 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2141172885894775
Epoch: 20, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.367 Vali Acc: 0.844 Test Loss: 0.367 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.271374225616455
Epoch: 21, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.325 Vali Acc: 0.878 Test Loss: 0.325 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 22 cost time: 3.184542417526245
Epoch: 22, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0024542808532715
Epoch: 23, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2073872089385986
Epoch: 24, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.271 Vali Acc: 0.889 Test Loss: 0.271 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 3.2701785564422607
Epoch: 25, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 3.2031736373901367
Epoch: 26, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.271 Vali Acc: 0.917 Test Loss: 0.271 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 2.9236690998077393
Epoch: 27, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2501730918884277
Epoch: 28, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.211 Vali Acc: 0.894 Test Loss: 0.211 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1596994400024414
Epoch: 29, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 30 cost time: 3.1693828105926514
Epoch: 30, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.353 Vali Acc: 0.856 Test Loss: 0.353 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 1764774
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.2069597244262695
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.742 Vali Acc: 0.228 Test Loss: 1.742 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 2.325918674468994
Epoch: 2, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.639 Vali Acc: 0.417 Test Loss: 1.639 Test Acc: 0.417
Validation loss decreased (-0.227760 --> -0.416650).  Saving model ...
Epoch: 3 cost time: 2.08556866645813
Epoch: 3, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.514 Vali Acc: 0.517 Test Loss: 1.514 Test Acc: 0.517
Validation loss decreased (-0.416650 --> -0.516652).  Saving model ...
Epoch: 4 cost time: 1.8813905715942383
Epoch: 4, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.379 Vali Acc: 0.583 Test Loss: 1.379 Test Acc: 0.583
Validation loss decreased (-0.516652 --> -0.583320).  Saving model ...
Epoch: 5 cost time: 2.2773096561431885
Epoch: 5, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.241 Vali Acc: 0.639 Test Loss: 1.241 Test Acc: 0.639
Validation loss decreased (-0.583320 --> -0.638876).  Saving model ...
Epoch: 6 cost time: 2.351734161376953
Epoch: 6, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.638876 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 2.34316086769104
Epoch: 7, Steps: 12 | Train Loss: 1.034 Vali Loss: 0.972 Vali Acc: 0.667 Test Loss: 0.972 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 1.9422266483306885
Epoch: 8, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.861 Vali Acc: 0.706 Test Loss: 0.861 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705547).  Saving model ...
Epoch: 9 cost time: 1.7111222743988037
Epoch: 9, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.773 Vali Acc: 0.728 Test Loss: 0.773 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 10 cost time: 2.1907265186309814
Epoch: 10, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1766858100891113
Epoch: 11, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.649 Vali Acc: 0.778 Test Loss: 0.649 Test Acc: 0.778
Validation loss decreased (-0.727770 --> -0.777771).  Saving model ...
Epoch: 12 cost time: 2.1468677520751953
Epoch: 12, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.594 Vali Acc: 0.728 Test Loss: 0.594 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9074387550354004
Epoch: 13, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783328).  Saving model ...
Epoch: 14 cost time: 2.1318719387054443
Epoch: 14, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.506 Vali Acc: 0.778 Test Loss: 0.506 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.156529188156128
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.485 Vali Acc: 0.794 Test Loss: 0.485 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 2.2716095447540283
Epoch: 16, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.465 Vali Acc: 0.839 Test Loss: 0.465 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838884).  Saving model ...
Epoch: 17 cost time: 2.1408939361572266
Epoch: 17, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.438 Vali Acc: 0.844 Test Loss: 0.438 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 18 cost time: 2.173095464706421
Epoch: 18, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.413 Vali Acc: 0.817 Test Loss: 0.413 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2332069873809814
Epoch: 19, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 2.217787742614746
Epoch: 20, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2382452487945557
Epoch: 21, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.366 Vali Acc: 0.867 Test Loss: 0.366 Test Acc: 0.867
Validation loss decreased (-0.849996 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 2.349256992340088
Epoch: 22, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3309237957000732
Epoch: 23, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4240148067474365
Epoch: 24, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.405259847640991
Epoch: 25, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.328 Vali Acc: 0.867 Test Loss: 0.328 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 26 cost time: 2.392427444458008
Epoch: 26, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 27 cost time: 2.3140902519226074
Epoch: 27, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 2.1816675662994385
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.393036365509033
Epoch: 29, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 30 cost time: 2.410533905029297
Epoch: 30, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 523206
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.703463554382324
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.793 Vali Acc: 0.189 Test Loss: 1.793 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 2.7851994037628174
Epoch: 2, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.712 Vali Acc: 0.311 Test Loss: 1.712 Test Acc: 0.311
Validation loss decreased (-0.188871 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 2.704313039779663
Epoch: 3, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.610 Vali Acc: 0.417 Test Loss: 1.610 Test Acc: 0.417
Validation loss decreased (-0.311094 --> -0.416651).  Saving model ...
Epoch: 4 cost time: 2.5997719764709473
Epoch: 4, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.492 Vali Acc: 0.556 Test Loss: 1.492 Test Acc: 0.556
Validation loss decreased (-0.416651 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 2.7669615745544434
Epoch: 5, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.351 Vali Acc: 0.650 Test Loss: 1.351 Test Acc: 0.650
Validation loss decreased (-0.555541 --> -0.649986).  Saving model ...
Epoch: 6 cost time: 2.7770769596099854
Epoch: 6, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.196 Vali Acc: 0.661 Test Loss: 1.196 Test Acc: 0.661
Validation loss decreased (-0.649986 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 2.7454488277435303
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.042 Vali Acc: 0.694 Test Loss: 1.042 Test Acc: 0.694
Validation loss decreased (-0.661099 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 2.664816379547119
Epoch: 8, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.914 Vali Acc: 0.694 Test Loss: 0.914 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 9 cost time: 2.6930758953094482
Epoch: 9, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.811 Vali Acc: 0.711 Test Loss: 0.811 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 2.7579801082611084
Epoch: 10, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.742 Vali Acc: 0.700 Test Loss: 0.742 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8182997703552246
Epoch: 11, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 2.7494595050811768
Epoch: 12, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.634 Vali Acc: 0.772 Test Loss: 0.634 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 2.6003684997558594
Epoch: 13, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.595 Vali Acc: 0.767 Test Loss: 0.595 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.631612539291382
Epoch: 14, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.540 Vali Acc: 0.778 Test Loss: 0.540 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 2.7675654888153076
Epoch: 15, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.470 Vali Acc: 0.806 Test Loss: 0.470 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805551).  Saving model ...
Epoch: 16 cost time: 2.7735471725463867
Epoch: 16, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 2.6246252059936523
Epoch: 17, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.395 Vali Acc: 0.817 Test Loss: 0.395 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6770427227020264
Epoch: 18, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 2.752351999282837
Epoch: 19, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.369 Vali Acc: 0.817 Test Loss: 0.369 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.861501693725586
Epoch: 20, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.386 Vali Acc: 0.856 Test Loss: 0.386 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 2.7411460876464844
Epoch: 21, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.329 Vali Acc: 0.878 Test Loss: 0.329 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 22 cost time: 2.44484281539917
Epoch: 22, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.783900260925293
Epoch: 23, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.769505739212036
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.277 Vali Acc: 0.872 Test Loss: 0.277 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7621729373931885
Epoch: 25, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
Validation loss decreased (-0.877774 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 2.6468677520751953
Epoch: 26, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6565613746643066
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8086392879486084
Epoch: 28, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 29 cost time: 2.7602124214172363
Epoch: 29, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5176103115081787
Epoch: 30, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1764774
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0034520626068115
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.742 Vali Acc: 0.228 Test Loss: 1.742 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 1.4960119724273682
Epoch: 2, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.639 Vali Acc: 0.417 Test Loss: 1.639 Test Acc: 0.417
Validation loss decreased (-0.227760 --> -0.416650).  Saving model ...
Epoch: 3 cost time: 1.5156159400939941
Epoch: 3, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.514 Vali Acc: 0.517 Test Loss: 1.514 Test Acc: 0.517
Validation loss decreased (-0.416650 --> -0.516652).  Saving model ...
Epoch: 4 cost time: 1.5305492877960205
Epoch: 4, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.379 Vali Acc: 0.583 Test Loss: 1.379 Test Acc: 0.583
Validation loss decreased (-0.516652 --> -0.583320).  Saving model ...
Epoch: 5 cost time: 1.932922124862671
Epoch: 5, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.241 Vali Acc: 0.639 Test Loss: 1.241 Test Acc: 0.639
Validation loss decreased (-0.583320 --> -0.638876).  Saving model ...
Epoch: 6 cost time: 1.948627233505249
Epoch: 6, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.638876 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 2.037447452545166
Epoch: 7, Steps: 12 | Train Loss: 1.034 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 1.9634363651275635
Epoch: 8, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.860 Vali Acc: 0.706 Test Loss: 0.860 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705547).  Saving model ...
Epoch: 9 cost time: 1.859330415725708
Epoch: 9, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.773 Vali Acc: 0.728 Test Loss: 0.773 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 10 cost time: 2.0300707817077637
Epoch: 10, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1006534099578857
Epoch: 11, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.648 Vali Acc: 0.778 Test Loss: 0.648 Test Acc: 0.778
Validation loss decreased (-0.727770 --> -0.777771).  Saving model ...
Epoch: 12 cost time: 2.1888434886932373
Epoch: 12, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.593 Vali Acc: 0.728 Test Loss: 0.593 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1765129566192627
Epoch: 13, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783328).  Saving model ...
Epoch: 14 cost time: 2.080904960632324
Epoch: 14, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.506 Vali Acc: 0.778 Test Loss: 0.506 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2240684032440186
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.482 Vali Acc: 0.794 Test Loss: 0.482 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794440).  Saving model ...
Epoch: 16 cost time: 2.169520854949951
Epoch: 16, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.464 Vali Acc: 0.839 Test Loss: 0.464 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838884).  Saving model ...
Epoch: 17 cost time: 2.0982778072357178
Epoch: 17, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.435 Vali Acc: 0.839 Test Loss: 0.435 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 2.1651968955993652
Epoch: 18, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.413 Vali Acc: 0.811 Test Loss: 0.413 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0638678073883057
Epoch: 19, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 2.250603437423706
Epoch: 20, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.200230121612549
Epoch: 21, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.366 Vali Acc: 0.861 Test Loss: 0.366 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 22 cost time: 2.0968739986419678
Epoch: 22, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.344 Vali Acc: 0.844 Test Loss: 0.344 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.206249475479126
Epoch: 23, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.334 Vali Acc: 0.856 Test Loss: 0.334 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0091378688812256
Epoch: 24, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.179705858230591
Epoch: 25, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.330 Vali Acc: 0.861 Test Loss: 0.330 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 26 cost time: 2.0624678134918213
Epoch: 26, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.319 Vali Acc: 0.872 Test Loss: 0.319 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 27 cost time: 1.9572978019714355
Epoch: 27, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 28 cost time: 2.238132953643799
Epoch: 28, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.376 Vali Acc: 0.833 Test Loss: 0.376 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9714596271514893
Epoch: 29, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.281 Vali Acc: 0.894 Test Loss: 0.281 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 30 cost time: 2.256105661392212
Epoch: 30, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 523206
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4974770545959473
Epoch: 1, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.793 Vali Acc: 0.189 Test Loss: 1.793 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 1.8660814762115479
Epoch: 2, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.712 Vali Acc: 0.311 Test Loss: 1.712 Test Acc: 0.311
Validation loss decreased (-0.188871 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 2.028775930404663
Epoch: 3, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.611 Vali Acc: 0.411 Test Loss: 1.611 Test Acc: 0.411
Validation loss decreased (-0.311094 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 1.9644293785095215
Epoch: 4, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.492 Vali Acc: 0.556 Test Loss: 1.492 Test Acc: 0.556
Validation loss decreased (-0.411095 --> -0.555541).  Saving model ...
Epoch: 5 cost time: 1.9599082469940186
Epoch: 5, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.351 Vali Acc: 0.650 Test Loss: 1.351 Test Acc: 0.650
Validation loss decreased (-0.555541 --> -0.649986).  Saving model ...
Epoch: 6 cost time: 2.0865845680236816
Epoch: 6, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.196 Vali Acc: 0.661 Test Loss: 1.196 Test Acc: 0.661
Validation loss decreased (-0.649986 --> -0.661099).  Saving model ...
Epoch: 7 cost time: 1.8038954734802246
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.042 Vali Acc: 0.694 Test Loss: 1.042 Test Acc: 0.694
Validation loss decreased (-0.661099 --> -0.694434).  Saving model ...
Epoch: 8 cost time: 2.066333532333374
Epoch: 8, Steps: 12 | Train Loss: 0.905 Vali Loss: 0.914 Vali Acc: 0.694 Test Loss: 0.914 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 9 cost time: 2.0450336933135986
Epoch: 9, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.811 Vali Acc: 0.711 Test Loss: 0.811 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711103).  Saving model ...
Epoch: 10 cost time: 2.0169644355773926
Epoch: 10, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.742 Vali Acc: 0.706 Test Loss: 0.742 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.088467597961426
Epoch: 11, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.689 Vali Acc: 0.744 Test Loss: 0.689 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744438).  Saving model ...
Epoch: 12 cost time: 1.8355157375335693
Epoch: 12, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.638 Vali Acc: 0.767 Test Loss: 0.638 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 1.9193472862243652
Epoch: 13, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.604 Vali Acc: 0.756 Test Loss: 0.604 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1045594215393066
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.556 Vali Acc: 0.772 Test Loss: 0.556 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772217).  Saving model ...
Epoch: 15 cost time: 2.0277295112609863
Epoch: 15, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.517 Vali Acc: 0.778 Test Loss: 0.517 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 16 cost time: 1.7750215530395508
Epoch: 16, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.494 Vali Acc: 0.806 Test Loss: 0.494 Test Acc: 0.806
Validation loss decreased (-0.777773 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 2.078160285949707
Epoch: 17, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0322775840759277
Epoch: 18, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.431 Vali Acc: 0.789 Test Loss: 0.431 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0848140716552734
Epoch: 19, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.430 Vali Acc: 0.828 Test Loss: 0.430 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 20 cost time: 2.096111536026001
Epoch: 20, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827774).  Saving model ...
Epoch: 21 cost time: 1.9693872928619385
Epoch: 21, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.402 Vali Acc: 0.817 Test Loss: 0.402 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1758487224578857
Epoch: 22, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.681480884552002
Epoch: 23, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.353 Vali Acc: 0.833 Test Loss: 0.353 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6669673919677734
Epoch: 24, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872219).  Saving model ...
Epoch: 25 cost time: 1.9121947288513184
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.289 Vali Acc: 0.883 Test Loss: 0.289 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 26 cost time: 1.8315470218658447
Epoch: 26, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8719110488891602
Epoch: 27, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.280 Vali Acc: 0.883 Test Loss: 0.280 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 28 cost time: 1.917987585067749
Epoch: 28, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.883331 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 1.8741340637207031
Epoch: 29, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9184837341308594
Epoch: 30, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 1764774
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1813437938690186
Epoch: 1, Steps: 12 | Train Loss: 1.809 Vali Loss: 1.747 Vali Acc: 0.228 Test Loss: 1.747 Test Acc: 0.228
Validation loss decreased (inf --> -0.227760).  Saving model ...
Epoch: 2 cost time: 1.5558195114135742
Epoch: 2, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.648 Vali Acc: 0.411 Test Loss: 1.648 Test Acc: 0.411
Validation loss decreased (-0.227760 --> -0.411095).  Saving model ...
Epoch: 3 cost time: 1.4513797760009766
Epoch: 3, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.526 Vali Acc: 0.517 Test Loss: 1.526 Test Acc: 0.517
Validation loss decreased (-0.411095 --> -0.516651).  Saving model ...
Epoch: 4 cost time: 1.4934513568878174
Epoch: 4, Steps: 12 | Train Loss: 1.454 Vali Loss: 1.397 Vali Acc: 0.578 Test Loss: 1.397 Test Acc: 0.578
Validation loss decreased (-0.516651 --> -0.577764).  Saving model ...
Epoch: 5 cost time: 1.7251863479614258
Epoch: 5, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.263 Vali Acc: 0.628 Test Loss: 1.263 Test Acc: 0.628
Validation loss decreased (-0.577764 --> -0.627765).  Saving model ...
Epoch: 6 cost time: 1.5429184436798096
Epoch: 6, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.125 Vali Acc: 0.639 Test Loss: 1.125 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638878).  Saving model ...
Epoch: 7 cost time: 1.628206491470337
Epoch: 7, Steps: 12 | Train Loss: 1.039 Vali Loss: 0.992 Vali Acc: 0.661 Test Loss: 0.992 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661101).  Saving model ...
Epoch: 8 cost time: 1.6992018222808838
Epoch: 8, Steps: 12 | Train Loss: 0.866 Vali Loss: 0.878 Vali Acc: 0.694 Test Loss: 0.878 Test Acc: 0.694
Validation loss decreased (-0.661101 --> -0.694436).  Saving model ...
Epoch: 9 cost time: 1.642961025238037
Epoch: 9, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.789 Vali Acc: 0.722 Test Loss: 0.789 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722214).  Saving model ...
Epoch: 10 cost time: 1.6870663166046143
Epoch: 10, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.716 Vali Acc: 0.706 Test Loss: 0.716 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.667595386505127
Epoch: 11, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 1.4337317943572998
Epoch: 12, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3301191329956055
Epoch: 13, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.555 Vali Acc: 0.772 Test Loss: 0.555 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 14 cost time: 1.364257574081421
Epoch: 14, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783328).  Saving model ...
Epoch: 15 cost time: 1.3863778114318848
Epoch: 15, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 1.515124797821045
Epoch: 16, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
Validation loss decreased (-0.799995 --> -0.844440).  Saving model ...
Epoch: 17 cost time: 1.795151710510254
Epoch: 17, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.862191915512085
Epoch: 18, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.414 Vali Acc: 0.828 Test Loss: 0.414 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6891810894012451
Epoch: 19, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.392 Vali Acc: 0.856 Test Loss: 0.392 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 1.807220697402954
Epoch: 20, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.877603530883789
Epoch: 21, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8776519298553467
Epoch: 22, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.347 Vali Acc: 0.867 Test Loss: 0.347 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 23 cost time: 1.6687560081481934
Epoch: 23, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 24 cost time: 1.6662261486053467
Epoch: 24, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.369 Vali Acc: 0.822 Test Loss: 0.369 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.882829189300537
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.323 Vali Acc: 0.861 Test Loss: 0.323 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8655133247375488
Epoch: 26, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.322 Vali Acc: 0.867 Test Loss: 0.322 Test Acc: 0.867
Validation loss decreased (-0.866663 --> -0.866663).  Saving model ...
Epoch: 27 cost time: 1.6809053421020508
Epoch: 27, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.317 Vali Acc: 0.872 Test Loss: 0.317 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 28 cost time: 1.6457748413085938
Epoch: 28, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8645596504211426
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 30 cost time: 1.9019951820373535
Epoch: 30, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 523206
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.832544326782227
Epoch: 1, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.835 Vali Acc: 0.200 Test Loss: 1.835 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 2.7039010524749756
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.747 Vali Acc: 0.306 Test Loss: 1.747 Test Acc: 0.306
Validation loss decreased (-0.199982 --> -0.305538).  Saving model ...
Epoch: 3 cost time: 3.025559186935425
Epoch: 3, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.638 Vali Acc: 0.411 Test Loss: 1.638 Test Acc: 0.411
Validation loss decreased (-0.305538 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 2.7968344688415527
Epoch: 4, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.514 Vali Acc: 0.511 Test Loss: 1.514 Test Acc: 0.511
Validation loss decreased (-0.411095 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 2.7694618701934814
Epoch: 5, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.376 Vali Acc: 0.600 Test Loss: 1.376 Test Acc: 0.600
Validation loss decreased (-0.511096 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 3.0096940994262695
Epoch: 6, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.226 Vali Acc: 0.639 Test Loss: 1.226 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 2.8442234992980957
Epoch: 7, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.071 Vali Acc: 0.683 Test Loss: 1.071 Test Acc: 0.683
Validation loss decreased (-0.638877 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 3.0126397609710693
Epoch: 8, Steps: 12 | Train Loss: 0.962 Vali Loss: 0.934 Vali Acc: 0.706 Test Loss: 0.934 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 9 cost time: 3.022803783416748
Epoch: 9, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.821 Vali Acc: 0.744 Test Loss: 0.821 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 2.725320816040039
Epoch: 10, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.737 Vali Acc: 0.733 Test Loss: 0.737 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.93496036529541
Epoch: 11, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.672 Vali Acc: 0.761 Test Loss: 0.672 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 2.969656229019165
Epoch: 12, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.620 Vali Acc: 0.767 Test Loss: 0.620 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 2.91355037689209
Epoch: 13, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783328).  Saving model ...
Epoch: 14 cost time: 2.995732307434082
Epoch: 14, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.537 Vali Acc: 0.756 Test Loss: 0.537 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8593382835388184
Epoch: 15, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.501 Vali Acc: 0.794 Test Loss: 0.501 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794439).  Saving model ...
Epoch: 16 cost time: 2.1652300357818604
Epoch: 16, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.461 Vali Acc: 0.817 Test Loss: 0.461 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 17 cost time: 2.7684285640716553
Epoch: 17, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.436 Vali Acc: 0.817 Test Loss: 0.436 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 18 cost time: 2.521121025085449
Epoch: 18, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 2.4751713275909424
Epoch: 19, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.382 Vali Acc: 0.833 Test Loss: 0.382 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 20 cost time: 2.725769519805908
Epoch: 20, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 2.4613001346588135
Epoch: 21, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.762584686279297
Epoch: 22, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.307 Vali Acc: 0.867 Test Loss: 0.307 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 23 cost time: 2.747715473175049
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 2.4384372234344482
Epoch: 24, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.872219 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 2.6336209774017334
Epoch: 25, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 2.7517659664154053
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 2.46494722366333
Epoch: 27, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.993103265762329
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.336 Vali Acc: 0.872 Test Loss: 0.336 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9508285522460938
Epoch: 29, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.65517258644104
Epoch: 30, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 885606
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7337839603424072
Epoch: 1, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.900 Vali Acc: 0.089 Test Loss: 1.900 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 2.277125597000122
Epoch: 2, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.820 Vali Acc: 0.183 Test Loss: 1.820 Test Acc: 0.183
Validation loss decreased (-0.088870 --> -0.183315).  Saving model ...
Epoch: 3 cost time: 2.1163792610168457
Epoch: 3, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.720 Vali Acc: 0.333 Test Loss: 1.720 Test Acc: 0.333
Validation loss decreased (-0.183315 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 2.128493309020996
Epoch: 4, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.606 Vali Acc: 0.444 Test Loss: 1.606 Test Acc: 0.444
Validation loss decreased (-0.333316 --> -0.444428).  Saving model ...
Epoch: 5 cost time: 2.2697956562042236
Epoch: 5, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.478 Vali Acc: 0.533 Test Loss: 1.478 Test Acc: 0.533
Validation loss decreased (-0.444428 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 2.2437145709991455
Epoch: 6, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
Validation loss decreased (-0.533319 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 2.224745035171509
Epoch: 7, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.192 Vali Acc: 0.567 Test Loss: 1.192 Test Acc: 0.567
Validation loss decreased (-0.549987 --> -0.566655).  Saving model ...
Epoch: 8 cost time: 2.1001880168914795
Epoch: 8, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.566655 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 2.2737879753112793
Epoch: 9, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.957 Vali Acc: 0.622 Test Loss: 0.957 Test Acc: 0.622
Validation loss decreased (-0.599989 --> -0.622213).  Saving model ...
Epoch: 10 cost time: 2.135119676589966
Epoch: 10, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.866 Vali Acc: 0.700 Test Loss: 0.866 Test Acc: 0.700
Validation loss decreased (-0.622213 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 2.1382627487182617
Epoch: 11, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.799 Vali Acc: 0.667 Test Loss: 0.799 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.43400502204895
Epoch: 12, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711104).  Saving model ...
Epoch: 13 cost time: 2.2803289890289307
Epoch: 13, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.700 Vali Acc: 0.728 Test Loss: 0.700 Test Acc: 0.728
Validation loss decreased (-0.711104 --> -0.727771).  Saving model ...
Epoch: 14 cost time: 2.3461999893188477
Epoch: 14, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.658 Vali Acc: 0.733 Test Loss: 0.658 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 15 cost time: 2.4195449352264404
Epoch: 15, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 2.3994078636169434
Epoch: 16, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 17 cost time: 2.2977559566497803
Epoch: 17, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783328).  Saving model ...
Epoch: 18 cost time: 2.450371503829956
Epoch: 18, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.501 Vali Acc: 0.761 Test Loss: 0.501 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.42669939994812
Epoch: 19, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 20 cost time: 2.1164627075195312
Epoch: 20, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.462 Vali Acc: 0.811 Test Loss: 0.462 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811106).  Saving model ...
Epoch: 21 cost time: 2.481447458267212
Epoch: 21, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.432349681854248
Epoch: 22, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 2.1792819499969482
Epoch: 23, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3195502758026123
Epoch: 24, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.384 Vali Acc: 0.839 Test Loss: 0.384 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 25 cost time: 2.414341688156128
Epoch: 25, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.370 Vali Acc: 0.822 Test Loss: 0.370 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.235527753829956
Epoch: 26, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.430830955505371
Epoch: 27, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.361 Vali Acc: 0.822 Test Loss: 0.361 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.4135076999664307
Epoch: 28, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2865359783172607
Epoch: 29, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.183223009109497
Epoch: 30, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 264774
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.347218990325928
Epoch: 1, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.835 Vali Acc: 0.200 Test Loss: 1.835 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 2.5022599697113037
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.747 Vali Acc: 0.306 Test Loss: 1.747 Test Acc: 0.306
Validation loss decreased (-0.199982 --> -0.305538).  Saving model ...
Epoch: 3 cost time: 2.0253918170928955
Epoch: 3, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.638 Vali Acc: 0.411 Test Loss: 1.638 Test Acc: 0.411
Validation loss decreased (-0.305538 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 2.275628089904785
Epoch: 4, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.514 Vali Acc: 0.511 Test Loss: 1.514 Test Acc: 0.511
Validation loss decreased (-0.411095 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 1.8088550567626953
Epoch: 5, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.375 Vali Acc: 0.600 Test Loss: 1.375 Test Acc: 0.600
Validation loss decreased (-0.511096 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 1.762458324432373
Epoch: 6, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.225 Vali Acc: 0.639 Test Loss: 1.225 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 1.768517017364502
Epoch: 7, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.070 Vali Acc: 0.683 Test Loss: 1.070 Test Acc: 0.683
Validation loss decreased (-0.638877 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 1.8067800998687744
Epoch: 8, Steps: 12 | Train Loss: 0.962 Vali Loss: 0.933 Vali Acc: 0.706 Test Loss: 0.933 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 9 cost time: 2.147178888320923
Epoch: 9, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.819 Vali Acc: 0.744 Test Loss: 0.819 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 2.2036101818084717
Epoch: 10, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.736 Vali Acc: 0.733 Test Loss: 0.736 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0727546215057373
Epoch: 11, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.672 Vali Acc: 0.761 Test Loss: 0.672 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 2.327991008758545
Epoch: 12, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.619 Vali Acc: 0.767 Test Loss: 0.619 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 1.9967195987701416
Epoch: 13, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783328).  Saving model ...
Epoch: 14 cost time: 2.2348690032958984
Epoch: 14, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.020930051803589
Epoch: 15, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.502 Vali Acc: 0.794 Test Loss: 0.502 Test Acc: 0.794
Validation loss decreased (-0.783328 --> -0.794439).  Saving model ...
Epoch: 16 cost time: 1.962106466293335
Epoch: 16, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.462 Vali Acc: 0.817 Test Loss: 0.462 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 17 cost time: 2.2359893321990967
Epoch: 17, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.437 Vali Acc: 0.822 Test Loss: 0.437 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 2.230461835861206
Epoch: 18, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 19 cost time: 2.489776611328125
Epoch: 19, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 2.1961562633514404
Epoch: 20, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 2.4704909324645996
Epoch: 21, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.305739164352417
Epoch: 22, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 23 cost time: 2.4755914211273193
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 2.1995646953582764
Epoch: 24, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.872219 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 2.325411796569824
Epoch: 25, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 2.378242015838623
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 2.231835126876831
Epoch: 27, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.247 Vali Acc: 0.928 Test Loss: 0.247 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4563100337982178
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.337 Vali Acc: 0.872 Test Loss: 0.337 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1296546459198
Epoch: 29, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.429635524749756
Epoch: 30, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 885606
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.759859561920166
Epoch: 1, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.900 Vali Acc: 0.089 Test Loss: 1.900 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 1.8262755870819092
Epoch: 2, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.820 Vali Acc: 0.183 Test Loss: 1.820 Test Acc: 0.183
Validation loss decreased (-0.088870 --> -0.183315).  Saving model ...
Epoch: 3 cost time: 1.8045179843902588
Epoch: 3, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.720 Vali Acc: 0.333 Test Loss: 1.720 Test Acc: 0.333
Validation loss decreased (-0.183315 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 1.8823931217193604
Epoch: 4, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.606 Vali Acc: 0.444 Test Loss: 1.606 Test Acc: 0.444
Validation loss decreased (-0.333316 --> -0.444428).  Saving model ...
Epoch: 5 cost time: 1.7946910858154297
Epoch: 5, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.478 Vali Acc: 0.533 Test Loss: 1.478 Test Acc: 0.533
Validation loss decreased (-0.444428 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 1.8728044033050537
Epoch: 6, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
Validation loss decreased (-0.533319 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 1.7990906238555908
Epoch: 7, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.191 Vali Acc: 0.567 Test Loss: 1.191 Test Acc: 0.567
Validation loss decreased (-0.549987 --> -0.566655).  Saving model ...
Epoch: 8 cost time: 2.073052167892456
Epoch: 8, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
Validation loss decreased (-0.566655 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.9829185009002686
Epoch: 9, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.956 Vali Acc: 0.622 Test Loss: 0.956 Test Acc: 0.622
Validation loss decreased (-0.599989 --> -0.622213).  Saving model ...
Epoch: 10 cost time: 2.0537757873535156
Epoch: 10, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.866 Vali Acc: 0.700 Test Loss: 0.866 Test Acc: 0.700
Validation loss decreased (-0.622213 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 1.770705223083496
Epoch: 11, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.799 Vali Acc: 0.667 Test Loss: 0.799 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0059263706207275
Epoch: 12, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716659).  Saving model ...
Epoch: 13 cost time: 1.8133938312530518
Epoch: 13, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.700 Vali Acc: 0.728 Test Loss: 0.700 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727771).  Saving model ...
Epoch: 14 cost time: 2.0301105976104736
Epoch: 14, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.657 Vali Acc: 0.733 Test Loss: 0.657 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 15 cost time: 1.8581945896148682
Epoch: 15, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 2.0947177410125732
Epoch: 16, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.571 Vali Acc: 0.761 Test Loss: 0.571 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 17 cost time: 1.8595871925354004
Epoch: 17, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783328).  Saving model ...
Epoch: 18 cost time: 1.9721784591674805
Epoch: 18, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.501 Vali Acc: 0.761 Test Loss: 0.501 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8860783576965332
Epoch: 19, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 20 cost time: 1.8637614250183105
Epoch: 20, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.462 Vali Acc: 0.811 Test Loss: 0.462 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811106).  Saving model ...
Epoch: 21 cost time: 2.028477668762207
Epoch: 21, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0290982723236084
Epoch: 22, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
Validation loss decreased (-0.811106 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 2.0508434772491455
Epoch: 23, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8949053287506104
Epoch: 24, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.383 Vali Acc: 0.839 Test Loss: 0.383 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 25 cost time: 1.9124388694763184
Epoch: 25, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.370 Vali Acc: 0.822 Test Loss: 0.370 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4297585487365723
Epoch: 26, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5038108825683594
Epoch: 27, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.361 Vali Acc: 0.822 Test Loss: 0.361 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4748458862304688
Epoch: 28, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4173340797424316
Epoch: 29, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8481309413909912
Epoch: 30, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 264774
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.374937057495117
Epoch: 1, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.836 Vali Acc: 0.200 Test Loss: 1.836 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.7405595779418945
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.748 Vali Acc: 0.300 Test Loss: 1.748 Test Acc: 0.300
Validation loss decreased (-0.199982 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.7756547927856445
Epoch: 3, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.639 Vali Acc: 0.417 Test Loss: 1.639 Test Acc: 0.417
Validation loss decreased (-0.299983 --> -0.416650).  Saving model ...
Epoch: 4 cost time: 1.6333873271942139
Epoch: 4, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.516 Vali Acc: 0.511 Test Loss: 1.516 Test Acc: 0.511
Validation loss decreased (-0.416650 --> -0.511096).  Saving model ...
Epoch: 5 cost time: 1.6988270282745361
Epoch: 5, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.378 Vali Acc: 0.600 Test Loss: 1.378 Test Acc: 0.600
Validation loss decreased (-0.511096 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 1.7540886402130127
Epoch: 6, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.229 Vali Acc: 0.639 Test Loss: 1.229 Test Acc: 0.639
Validation loss decreased (-0.599986 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 1.80173921585083
Epoch: 7, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.074 Vali Acc: 0.689 Test Loss: 1.074 Test Acc: 0.689
Validation loss decreased (-0.638877 --> -0.688878).  Saving model ...
Epoch: 8 cost time: 1.7478742599487305
Epoch: 8, Steps: 12 | Train Loss: 0.967 Vali Loss: 0.938 Vali Acc: 0.700 Test Loss: 0.938 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 1.79246187210083
Epoch: 9, Steps: 12 | Train Loss: 0.834 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
Validation loss decreased (-0.699991 --> -0.733325).  Saving model ...
Epoch: 10 cost time: 1.6648879051208496
Epoch: 10, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.749 Vali Acc: 0.728 Test Loss: 0.749 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9628469944000244
Epoch: 11, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.687 Vali Acc: 0.756 Test Loss: 0.687 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 1.8838860988616943
Epoch: 12, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.635 Vali Acc: 0.772 Test Loss: 0.635 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 1.7799668312072754
Epoch: 13, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.585 Vali Acc: 0.778 Test Loss: 0.585 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 14 cost time: 1.7091567516326904
Epoch: 14, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.558485746383667
Epoch: 15, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 16 cost time: 1.9235234260559082
Epoch: 16, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.479 Vali Acc: 0.811 Test Loss: 0.479 Test Acc: 0.811
Validation loss decreased (-0.788884 --> -0.811106).  Saving model ...
Epoch: 17 cost time: 1.873765230178833
Epoch: 17, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.456 Vali Acc: 0.828 Test Loss: 0.456 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827773).  Saving model ...
Epoch: 18 cost time: 1.7394869327545166
Epoch: 18, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.429 Vali Acc: 0.822 Test Loss: 0.429 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8654770851135254
Epoch: 19, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.90248703956604
Epoch: 20, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.376 Vali Acc: 0.839 Test Loss: 0.376 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 21 cost time: 1.9007444381713867
Epoch: 21, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.364 Vali Acc: 0.839 Test Loss: 0.364 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 1.8898959159851074
Epoch: 22, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 23 cost time: 1.815030813217163
Epoch: 23, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.333 Vali Acc: 0.861 Test Loss: 0.333 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 24 cost time: 1.797739028930664
Epoch: 24, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.307 Vali Acc: 0.889 Test Loss: 0.307 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 1.9078567028045654
Epoch: 25, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
Validation loss decreased (-0.888886 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 1.9246349334716797
Epoch: 26, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8974254131317139
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6851916313171387
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.341 Vali Acc: 0.872 Test Loss: 0.341 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6687345504760742
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 1.8837499618530273
Epoch: 30, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.328 Vali Acc: 0.878 Test Loss: 0.328 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 885606
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4918434619903564
Epoch: 1, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.898 Vali Acc: 0.089 Test Loss: 1.898 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 1.6991939544677734
Epoch: 2, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.819 Vali Acc: 0.189 Test Loss: 1.819 Test Acc: 0.189
Validation loss decreased (-0.088870 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 1.6498467922210693
Epoch: 3, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.721 Vali Acc: 0.344 Test Loss: 1.721 Test Acc: 0.344
Validation loss decreased (-0.188871 --> -0.344427).  Saving model ...
Epoch: 4 cost time: 1.6238853931427002
Epoch: 4, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.608 Vali Acc: 0.450 Test Loss: 1.608 Test Acc: 0.450
Validation loss decreased (-0.344427 --> -0.449984).  Saving model ...
Epoch: 5 cost time: 1.5290534496307373
Epoch: 5, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.481 Vali Acc: 0.533 Test Loss: 1.481 Test Acc: 0.533
Validation loss decreased (-0.449984 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 1.6713714599609375
Epoch: 6, Steps: 12 | Train Loss: 1.370 Vali Loss: 1.340 Vali Acc: 0.550 Test Loss: 1.340 Test Acc: 0.550
Validation loss decreased (-0.533319 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 1.6722707748413086
Epoch: 7, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.199 Vali Acc: 0.567 Test Loss: 1.199 Test Acc: 0.567
Validation loss decreased (-0.549987 --> -0.566655).  Saving model ...
Epoch: 8 cost time: 1.664351463317871
Epoch: 8, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.070 Vali Acc: 0.594 Test Loss: 1.070 Test Acc: 0.594
Validation loss decreased (-0.566655 --> -0.594434).  Saving model ...
Epoch: 9 cost time: 1.443934440612793
Epoch: 9, Steps: 12 | Train Loss: 0.950 Vali Loss: 0.968 Vali Acc: 0.611 Test Loss: 0.968 Test Acc: 0.611
Validation loss decreased (-0.594434 --> -0.611101).  Saving model ...
Epoch: 10 cost time: 1.3556807041168213
Epoch: 10, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.878 Vali Acc: 0.694 Test Loss: 0.878 Test Acc: 0.694
Validation loss decreased (-0.611101 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 1.7467725276947021
Epoch: 11, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.811 Vali Acc: 0.661 Test Loss: 0.811 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7368457317352295
Epoch: 12, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.759 Vali Acc: 0.706 Test Loss: 0.759 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 13 cost time: 1.597644329071045
Epoch: 13, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.712 Vali Acc: 0.722 Test Loss: 0.712 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722215).  Saving model ...
Epoch: 14 cost time: 1.57643723487854
Epoch: 14, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 15 cost time: 1.6813342571258545
Epoch: 15, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.622 Vali Acc: 0.744 Test Loss: 0.622 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 16 cost time: 1.659693717956543
Epoch: 16, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.585 Vali Acc: 0.767 Test Loss: 0.585 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 17 cost time: 1.6906485557556152
Epoch: 17, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.546 Vali Acc: 0.778 Test Loss: 0.546 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777772).  Saving model ...
Epoch: 18 cost time: 1.628854751586914
Epoch: 18, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.519 Vali Acc: 0.756 Test Loss: 0.519 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.598222255706787
Epoch: 19, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.501 Vali Acc: 0.778 Test Loss: 0.501 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 20 cost time: 1.7329506874084473
Epoch: 20, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.480 Vali Acc: 0.811 Test Loss: 0.480 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811106).  Saving model ...
Epoch: 21 cost time: 1.6681888103485107
Epoch: 21, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.459 Vali Acc: 0.789 Test Loss: 0.459 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.741605520248413
Epoch: 22, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 23 cost time: 1.6748311519622803
Epoch: 23, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.411 Vali Acc: 0.800 Test Loss: 0.411 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6138393878936768
Epoch: 24, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.401 Vali Acc: 0.828 Test Loss: 0.401 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.6798787117004395
Epoch: 25, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.389 Vali Acc: 0.806 Test Loss: 0.389 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.684187889099121
Epoch: 26, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5639410018920898
Epoch: 27, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.381 Vali Acc: 0.800 Test Loss: 0.381 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5012657642364502
Epoch: 28, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 29 cost time: 1.3422822952270508
Epoch: 29, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.560295820236206
Epoch: 30, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.365 Vali Acc: 0.817 Test Loss: 0.365 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 264774
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6085286140441895
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.849 Vali Acc: 0.139 Test Loss: 1.849 Test Acc: 0.139
Validation loss decreased (inf --> -0.138870).  Saving model ...
Epoch: 2 cost time: 2.415592908859253
Epoch: 2, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.775 Vali Acc: 0.222 Test Loss: 1.775 Test Acc: 0.222
Validation loss decreased (-0.138870 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 2.4034268856048584
Epoch: 3, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.677 Vali Acc: 0.333 Test Loss: 1.677 Test Acc: 0.333
Validation loss decreased (-0.222204 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 2.3036112785339355
Epoch: 4, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.561 Vali Acc: 0.456 Test Loss: 1.561 Test Acc: 0.456
Validation loss decreased (-0.333317 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 2.494140863418579
Epoch: 5, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.432 Vali Acc: 0.533 Test Loss: 1.432 Test Acc: 0.533
Validation loss decreased (-0.455540 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 2.458275556564331
Epoch: 6, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.290 Vali Acc: 0.633 Test Loss: 1.290 Test Acc: 0.633
Validation loss decreased (-0.533319 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 2.31201171875
Epoch: 7, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.139 Vali Acc: 0.683 Test Loss: 1.139 Test Acc: 0.683
Validation loss decreased (-0.633320 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 2.4163143634796143
Epoch: 8, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.995 Vali Acc: 0.689 Test Loss: 0.995 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 2.772824287414551
Epoch: 9, Steps: 12 | Train Loss: 0.881 Vali Loss: 0.876 Vali Acc: 0.700 Test Loss: 0.876 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 2.6581878662109375
Epoch: 10, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744437).  Saving model ...
Epoch: 11 cost time: 2.4308316707611084
Epoch: 11, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.721 Vali Acc: 0.756 Test Loss: 0.721 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 12 cost time: 2.7796683311462402
Epoch: 12, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.665 Vali Acc: 0.767 Test Loss: 0.665 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 2.852818250656128
Epoch: 13, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5750064849853516
Epoch: 14, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.572 Vali Acc: 0.778 Test Loss: 0.572 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 2.88853120803833
Epoch: 15, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.528 Vali Acc: 0.778 Test Loss: 0.528 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 16 cost time: 2.8046040534973145
Epoch: 16, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.484 Vali Acc: 0.794 Test Loss: 0.484 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 17 cost time: 2.642645835876465
Epoch: 17, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.450 Vali Acc: 0.800 Test Loss: 0.450 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 18 cost time: 2.6823978424072266
Epoch: 18, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.420 Vali Acc: 0.789 Test Loss: 0.420 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.907443046569824
Epoch: 19, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.399 Vali Acc: 0.828 Test Loss: 0.399 Test Acc: 0.828
Validation loss decreased (-0.799996 --> -0.827774).  Saving model ...
Epoch: 20 cost time: 2.7698028087615967
Epoch: 20, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.378 Vali Acc: 0.828 Test Loss: 0.378 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 21 cost time: 2.365532636642456
Epoch: 21, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 22 cost time: 2.820436954498291
Epoch: 22, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.346 Vali Acc: 0.822 Test Loss: 0.346 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7397758960723877
Epoch: 23, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.635343551635742
Epoch: 24, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4870963096618652
Epoch: 25, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.330 Vali Acc: 0.800 Test Loss: 0.330 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.7480313777923584
Epoch: 26, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.317 Vali Acc: 0.828 Test Loss: 0.317 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.8184003829956055
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.322 Vali Acc: 0.839 Test Loss: 0.322 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 28 cost time: 2.5319018363952637
Epoch: 28, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.304 Vali Acc: 0.839 Test Loss: 0.304 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 29 cost time: 2.807774543762207
Epoch: 29, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 30 cost time: 2.8205015659332275
Epoch: 30, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.313 Vali Acc: 0.839 Test Loss: 0.313 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 446022
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.048267602920532
Epoch: 1, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.872 Vali Acc: 0.178 Test Loss: 1.872 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 2.1888856887817383
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.780 Vali Acc: 0.228 Test Loss: 1.780 Test Acc: 0.228
Validation loss decreased (-0.177759 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 2.02862286567688
Epoch: 3, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.665 Vali Acc: 0.344 Test Loss: 1.665 Test Acc: 0.344
Validation loss decreased (-0.227760 --> -0.344428).  Saving model ...
Epoch: 4 cost time: 2.307846784591675
Epoch: 4, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.544 Vali Acc: 0.411 Test Loss: 1.544 Test Acc: 0.411
Validation loss decreased (-0.344428 --> -0.411096).  Saving model ...
Epoch: 5 cost time: 2.254429817199707
Epoch: 5, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.419 Vali Acc: 0.572 Test Loss: 1.419 Test Acc: 0.572
Validation loss decreased (-0.411096 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 2.167006254196167
Epoch: 6, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.279 Vali Acc: 0.661 Test Loss: 1.279 Test Acc: 0.661
Validation loss decreased (-0.572208 --> -0.661098).  Saving model ...
Epoch: 7 cost time: 2.027169942855835
Epoch: 7, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.142 Vali Acc: 0.678 Test Loss: 1.142 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677766).  Saving model ...
Epoch: 8 cost time: 2.2456705570220947
Epoch: 8, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.007 Vali Acc: 0.733 Test Loss: 1.007 Test Acc: 0.733
Validation loss decreased (-0.677766 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 2.2352569103240967
Epoch: 9, Steps: 12 | Train Loss: 0.918 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 2.105541467666626
Epoch: 10, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 2.1488919258117676
Epoch: 11, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.696 Vali Acc: 0.756 Test Loss: 0.696 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 2.2837276458740234
Epoch: 12, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.619 Vali Acc: 0.811 Test Loss: 0.619 Test Acc: 0.811
Validation loss decreased (-0.755549 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 2.306879758834839
Epoch: 13, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.558 Vali Acc: 0.817 Test Loss: 0.558 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 14 cost time: 2.0883336067199707
Epoch: 14, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.518 Vali Acc: 0.817 Test Loss: 0.518 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 15 cost time: 1.9980080127716064
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.5459516048431396
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.5720102787017822
Epoch: 17, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.422 Vali Acc: 0.839 Test Loss: 0.422 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 1.6470692157745361
Epoch: 18, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.638416051864624
Epoch: 19, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 1.8220999240875244
Epoch: 20, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8923122882843018
Epoch: 21, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7894351482391357
Epoch: 22, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.9885802268981934
Epoch: 23, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 24 cost time: 1.7787282466888428
Epoch: 24, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 1.923900842666626
Epoch: 25, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 1.7819106578826904
Epoch: 26, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 27 cost time: 2.0531649589538574
Epoch: 27, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 28 cost time: 1.9160797595977783
Epoch: 28, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.284 Vali Acc: 0.861 Test Loss: 0.284 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 2.185068368911743
Epoch: 29, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 30 cost time: 2.0890777111053467
Epoch: 30, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 135558
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.115464210510254
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.849 Vali Acc: 0.139 Test Loss: 1.849 Test Acc: 0.139
Validation loss decreased (inf --> -0.138870).  Saving model ...
Epoch: 2 cost time: 2.407601833343506
Epoch: 2, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.775 Vali Acc: 0.222 Test Loss: 1.775 Test Acc: 0.222
Validation loss decreased (-0.138870 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 2.1185739040374756
Epoch: 3, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.677 Vali Acc: 0.333 Test Loss: 1.677 Test Acc: 0.333
Validation loss decreased (-0.222204 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 2.283616304397583
Epoch: 4, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.561 Vali Acc: 0.456 Test Loss: 1.561 Test Acc: 0.456
Validation loss decreased (-0.333317 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 2.1457815170288086
Epoch: 5, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.432 Vali Acc: 0.533 Test Loss: 1.432 Test Acc: 0.533
Validation loss decreased (-0.455540 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 2.1945061683654785
Epoch: 6, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.290 Vali Acc: 0.633 Test Loss: 1.290 Test Acc: 0.633
Validation loss decreased (-0.533319 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 2.143906593322754
Epoch: 7, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.139 Vali Acc: 0.683 Test Loss: 1.139 Test Acc: 0.683
Validation loss decreased (-0.633320 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 2.156999349594116
Epoch: 8, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.995 Vali Acc: 0.694 Test Loss: 0.995 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 2.196664333343506
Epoch: 9, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.877 Vali Acc: 0.706 Test Loss: 0.877 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 2.110435724258423
Epoch: 10, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
Validation loss decreased (-0.705547 --> -0.744437).  Saving model ...
Epoch: 11 cost time: 2.284864664077759
Epoch: 11, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 2.020272970199585
Epoch: 12, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.665 Vali Acc: 0.767 Test Loss: 0.665 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 2.3228306770324707
Epoch: 13, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.619 Vali Acc: 0.761 Test Loss: 0.619 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.094675302505493
Epoch: 14, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.573 Vali Acc: 0.778 Test Loss: 0.573 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 2.4323346614837646
Epoch: 15, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.529 Vali Acc: 0.772 Test Loss: 0.529 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.147383451461792
Epoch: 16, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 17 cost time: 2.337635040283203
Epoch: 17, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.450 Vali Acc: 0.800 Test Loss: 0.450 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 2.208000659942627
Epoch: 18, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.420 Vali Acc: 0.794 Test Loss: 0.420 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3514115810394287
Epoch: 19, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
Validation loss decreased (-0.799995 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 2.2203261852264404
Epoch: 20, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.377 Vali Acc: 0.828 Test Loss: 0.377 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3568530082702637
Epoch: 21, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.241468667984009
Epoch: 22, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.343 Vali Acc: 0.822 Test Loss: 0.343 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.327775716781616
Epoch: 23, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.089350700378418
Epoch: 24, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.333 Vali Acc: 0.822 Test Loss: 0.333 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.340174913406372
Epoch: 25, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.338 Vali Acc: 0.800 Test Loss: 0.338 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0997464656829834
Epoch: 26, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.323 Vali Acc: 0.828 Test Loss: 0.323 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9694750308990479
Epoch: 27, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849997).  Saving model ...
Epoch: 28 cost time: 1.869628667831421
Epoch: 28, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.299 Vali Acc: 0.839 Test Loss: 0.299 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7965099811553955
Epoch: 29, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.286 Vali Acc: 0.850 Test Loss: 0.286 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 1.9156529903411865
Epoch: 30, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.279 Vali Acc: 0.861 Test Loss: 0.279 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 446022
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.7725796699523926
Epoch: 1, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.872 Vali Acc: 0.178 Test Loss: 1.872 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 2.0712289810180664
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.780 Vali Acc: 0.228 Test Loss: 1.780 Test Acc: 0.228
Validation loss decreased (-0.177759 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 2.0788967609405518
Epoch: 3, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.665 Vali Acc: 0.344 Test Loss: 1.665 Test Acc: 0.344
Validation loss decreased (-0.227760 --> -0.344428).  Saving model ...
Epoch: 4 cost time: 1.8909797668457031
Epoch: 4, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.544 Vali Acc: 0.411 Test Loss: 1.544 Test Acc: 0.411
Validation loss decreased (-0.344428 --> -0.411096).  Saving model ...
Epoch: 5 cost time: 1.9865801334381104
Epoch: 5, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.419 Vali Acc: 0.572 Test Loss: 1.419 Test Acc: 0.572
Validation loss decreased (-0.411096 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 1.8860926628112793
Epoch: 6, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.279 Vali Acc: 0.661 Test Loss: 1.279 Test Acc: 0.661
Validation loss decreased (-0.572208 --> -0.661098).  Saving model ...
Epoch: 7 cost time: 1.552065372467041
Epoch: 7, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.142 Vali Acc: 0.678 Test Loss: 1.142 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677766).  Saving model ...
Epoch: 8 cost time: 1.6634831428527832
Epoch: 8, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.007 Vali Acc: 0.733 Test Loss: 1.007 Test Acc: 0.733
Validation loss decreased (-0.677766 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.8952388763427734
Epoch: 9, Steps: 12 | Train Loss: 0.918 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.7267231941223145
Epoch: 10, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.785 Vali Acc: 0.756 Test Loss: 0.785 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 1.7339873313903809
Epoch: 11, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.696 Vali Acc: 0.756 Test Loss: 0.696 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 2.002366781234741
Epoch: 12, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.619 Vali Acc: 0.811 Test Loss: 0.619 Test Acc: 0.811
Validation loss decreased (-0.755549 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 1.8284783363342285
Epoch: 13, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.558 Vali Acc: 0.817 Test Loss: 0.558 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 14 cost time: 1.8492498397827148
Epoch: 14, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.518 Vali Acc: 0.817 Test Loss: 0.518 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 15 cost time: 1.9719581604003906
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.474 Vali Acc: 0.833 Test Loss: 0.474 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 2.02270245552063
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.5612120628356934
Epoch: 17, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.422 Vali Acc: 0.839 Test Loss: 0.422 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 1.9936013221740723
Epoch: 18, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.394 Vali Acc: 0.828 Test Loss: 0.394 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8693318367004395
Epoch: 19, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.377 Vali Acc: 0.839 Test Loss: 0.377 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 1.5538876056671143
Epoch: 20, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.362 Vali Acc: 0.828 Test Loss: 0.362 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8000428676605225
Epoch: 21, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.350 Vali Acc: 0.822 Test Loss: 0.350 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9542789459228516
Epoch: 22, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.345 Vali Acc: 0.839 Test Loss: 0.345 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.8684146404266357
Epoch: 23, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 24 cost time: 1.683671474456787
Epoch: 24, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 1.932699203491211
Epoch: 25, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 1.862837791442871
Epoch: 26, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 27 cost time: 1.507392406463623
Epoch: 27, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.295 Vali Acc: 0.856 Test Loss: 0.295 Test Acc: 0.856
Validation loss decreased (-0.855553 --> -0.855553).  Saving model ...
Epoch: 28 cost time: 1.674931287765503
Epoch: 28, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
Validation loss decreased (-0.855553 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 1.389568567276001
Epoch: 29, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.279 Vali Acc: 0.883 Test Loss: 0.279 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 30 cost time: 1.8444561958312988
Epoch: 30, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
Validation loss decreased (-0.883331 --> -0.894442).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 135558
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2871153354644775
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.849 Vali Acc: 0.139 Test Loss: 1.849 Test Acc: 0.139
Validation loss decreased (inf --> -0.138870).  Saving model ...
Epoch: 2 cost time: 1.7192645072937012
Epoch: 2, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.776 Vali Acc: 0.222 Test Loss: 1.776 Test Acc: 0.222
Validation loss decreased (-0.138870 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 1.681753158569336
Epoch: 3, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.678 Vali Acc: 0.333 Test Loss: 1.678 Test Acc: 0.333
Validation loss decreased (-0.222204 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 1.549638271331787
Epoch: 4, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.562 Vali Acc: 0.456 Test Loss: 1.562 Test Acc: 0.456
Validation loss decreased (-0.333317 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.7509896755218506
Epoch: 5, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.435 Vali Acc: 0.533 Test Loss: 1.435 Test Acc: 0.533
Validation loss decreased (-0.455540 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 1.7388942241668701
Epoch: 6, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.294 Vali Acc: 0.633 Test Loss: 1.294 Test Acc: 0.633
Validation loss decreased (-0.533319 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 1.436997413635254
Epoch: 7, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.144 Vali Acc: 0.683 Test Loss: 1.144 Test Acc: 0.683
Validation loss decreased (-0.633320 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 1.8216118812561035
Epoch: 8, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.003 Vali Acc: 0.694 Test Loss: 1.003 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 1.703510046005249
Epoch: 9, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.886 Vali Acc: 0.700 Test Loss: 0.886 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 1.4968111515045166
Epoch: 10, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.801 Vali Acc: 0.739 Test Loss: 0.801 Test Acc: 0.739
Validation loss decreased (-0.699991 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 1.6453778743743896
Epoch: 11, Steps: 12 | Train Loss: 0.709 Vali Loss: 0.736 Vali Acc: 0.744 Test Loss: 0.736 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 1.6915743350982666
Epoch: 12, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.682 Vali Acc: 0.756 Test Loss: 0.682 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 13 cost time: 1.7324340343475342
Epoch: 13, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.638 Vali Acc: 0.744 Test Loss: 0.638 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.698331356048584
Epoch: 14, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6089794635772705
Epoch: 15, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.549 Vali Acc: 0.750 Test Loss: 0.549 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7977087497711182
Epoch: 16, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.506 Vali Acc: 0.772 Test Loss: 0.506 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772217).  Saving model ...
Epoch: 17 cost time: 1.7229135036468506
Epoch: 17, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.471 Vali Acc: 0.778 Test Loss: 0.471 Test Acc: 0.778
Validation loss decreased (-0.772217 --> -0.777773).  Saving model ...
Epoch: 18 cost time: 1.4164071083068848
Epoch: 18, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.442 Vali Acc: 0.778 Test Loss: 0.442 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 19 cost time: 1.6745624542236328
Epoch: 19, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.420 Vali Acc: 0.822 Test Loss: 0.420 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 20 cost time: 1.7177958488464355
Epoch: 20, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.398 Vali Acc: 0.806 Test Loss: 0.398 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.636674404144287
Epoch: 21, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.383 Vali Acc: 0.822 Test Loss: 0.383 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 22 cost time: 1.4995980262756348
Epoch: 22, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.363 Vali Acc: 0.817 Test Loss: 0.363 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6793596744537354
Epoch: 23, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.359 Vali Acc: 0.822 Test Loss: 0.359 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 24 cost time: 1.536055088043213
Epoch: 24, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.353 Vali Acc: 0.828 Test Loss: 0.353 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 1.5609281063079834
Epoch: 25, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.348 Vali Acc: 0.828 Test Loss: 0.348 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 1.6969568729400635
Epoch: 26, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.336 Vali Acc: 0.822 Test Loss: 0.336 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6563031673431396
Epoch: 27, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.322 Vali Acc: 0.833 Test Loss: 0.322 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 1.6215715408325195
Epoch: 28, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.319 Vali Acc: 0.833 Test Loss: 0.319 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 29 cost time: 1.502981185913086
Epoch: 29, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.311 Vali Acc: 0.839 Test Loss: 0.311 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 30 cost time: 1.8353965282440186
Epoch: 30, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.303 Vali Acc: 0.850 Test Loss: 0.303 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 446022
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.337672710418701
Epoch: 1, Steps: 12 | Train Loss: 1.918 Vali Loss: 1.871 Vali Acc: 0.178 Test Loss: 1.871 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 1.314901351928711
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.778 Vali Acc: 0.228 Test Loss: 1.778 Test Acc: 0.228
Validation loss decreased (-0.177759 --> -0.227760).  Saving model ...
Epoch: 3 cost time: 1.5225262641906738
Epoch: 3, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.664 Vali Acc: 0.350 Test Loss: 1.664 Test Acc: 0.350
Validation loss decreased (-0.227760 --> -0.349983).  Saving model ...
Epoch: 4 cost time: 1.6002984046936035
Epoch: 4, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.545 Vali Acc: 0.406 Test Loss: 1.545 Test Acc: 0.406
Validation loss decreased (-0.349983 --> -0.405540).  Saving model ...
Epoch: 5 cost time: 1.2998061180114746
Epoch: 5, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.421 Vali Acc: 0.572 Test Loss: 1.421 Test Acc: 0.572
Validation loss decreased (-0.405540 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 1.4543921947479248
Epoch: 6, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.282 Vali Acc: 0.661 Test Loss: 1.282 Test Acc: 0.661
Validation loss decreased (-0.572208 --> -0.661098).  Saving model ...
Epoch: 7 cost time: 1.5332705974578857
Epoch: 7, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.146 Vali Acc: 0.678 Test Loss: 1.146 Test Acc: 0.678
Validation loss decreased (-0.661098 --> -0.677766).  Saving model ...
Epoch: 8 cost time: 1.577380657196045
Epoch: 8, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.011 Vali Acc: 0.733 Test Loss: 1.011 Test Acc: 0.733
Validation loss decreased (-0.677766 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 1.4389894008636475
Epoch: 9, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.3682208061218262
Epoch: 10, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.791 Vali Acc: 0.756 Test Loss: 0.791 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 1.5377225875854492
Epoch: 11, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.702 Vali Acc: 0.756 Test Loss: 0.702 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 12 cost time: 1.5351104736328125
Epoch: 12, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.625 Vali Acc: 0.811 Test Loss: 0.625 Test Acc: 0.811
Validation loss decreased (-0.755549 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 1.4448318481445312
Epoch: 13, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.564 Vali Acc: 0.817 Test Loss: 0.564 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 14 cost time: 1.4670593738555908
Epoch: 14, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.525 Vali Acc: 0.817 Test Loss: 0.525 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 15 cost time: 1.5290205478668213
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 1.365844964981079
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.452 Vali Acc: 0.833 Test Loss: 0.452 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 17 cost time: 1.308476209640503
Epoch: 17, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.432 Vali Acc: 0.839 Test Loss: 0.432 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 1.2751641273498535
Epoch: 18, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3992395401000977
Epoch: 19, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 1.3894305229187012
Epoch: 20, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3055570125579834
Epoch: 21, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.362 Vali Acc: 0.822 Test Loss: 0.362 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1882526874542236
Epoch: 22, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 23 cost time: 1.3352351188659668
Epoch: 23, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 24 cost time: 1.3246352672576904
Epoch: 24, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.328 Vali Acc: 0.850 Test Loss: 0.328 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 25 cost time: 1.2270383834838867
Epoch: 25, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.326 Vali Acc: 0.850 Test Loss: 0.326 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 26 cost time: 0.9907255172729492
Epoch: 26, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 1.365121603012085
Epoch: 27, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 28 cost time: 1.5215983390808105
Epoch: 28, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.295 Vali Acc: 0.861 Test Loss: 0.295 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 29 cost time: 1.2367820739746094
Epoch: 29, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.291 Vali Acc: 0.883 Test Loss: 0.291 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883330).  Saving model ...
Epoch: 30 cost time: 1.1474392414093018
Epoch: 30, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.278 Vali Acc: 0.894 Test Loss: 0.278 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 135558
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.025669574737549
Epoch: 1, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.850 Vali Acc: 0.028 Test Loss: 1.850 Test Acc: 0.028
Validation loss decreased (inf --> -0.027759).  Saving model ...
Epoch: 2 cost time: 2.6721460819244385
Epoch: 2, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.790 Vali Acc: 0.061 Test Loss: 1.790 Test Acc: 0.061
Validation loss decreased (-0.027759 --> -0.061093).  Saving model ...
Epoch: 3 cost time: 2.3267428874969482
Epoch: 3, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.709 Vali Acc: 0.178 Test Loss: 1.709 Test Acc: 0.178
Validation loss decreased (-0.061093 --> -0.177761).  Saving model ...
Epoch: 4 cost time: 2.5455076694488525
Epoch: 4, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.627 Vali Acc: 0.322 Test Loss: 1.627 Test Acc: 0.322
Validation loss decreased (-0.177761 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 2.7834644317626953
Epoch: 5, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.543 Vali Acc: 0.417 Test Loss: 1.543 Test Acc: 0.417
Validation loss decreased (-0.322206 --> -0.416651).  Saving model ...
Epoch: 6 cost time: 2.778080940246582
Epoch: 6, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.451 Vali Acc: 0.483 Test Loss: 1.451 Test Acc: 0.483
Validation loss decreased (-0.416651 --> -0.483319).  Saving model ...
Epoch: 7 cost time: 2.429995536804199
Epoch: 7, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.364 Vali Acc: 0.550 Test Loss: 1.364 Test Acc: 0.550
Validation loss decreased (-0.483319 --> -0.549986).  Saving model ...
Epoch: 8 cost time: 2.72627592086792
Epoch: 8, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.267 Vali Acc: 0.594 Test Loss: 1.267 Test Acc: 0.594
Validation loss decreased (-0.549986 --> -0.594432).  Saving model ...
Epoch: 9 cost time: 2.7095632553100586
Epoch: 9, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.180 Vali Acc: 0.589 Test Loss: 1.180 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2773425579071045
Epoch: 10, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.108 Vali Acc: 0.589 Test Loss: 1.108 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5110390186309814
Epoch: 11, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.041 Vali Acc: 0.594 Test Loss: 1.041 Test Acc: 0.594
Validation loss decreased (-0.594432 --> -0.594434).  Saving model ...
Epoch: 12 cost time: 2.344080924987793
Epoch: 12, Steps: 12 | Train Loss: 0.967 Vali Loss: 0.981 Vali Acc: 0.594 Test Loss: 0.981 Test Acc: 0.594
Validation loss decreased (-0.594434 --> -0.594435).  Saving model ...
Epoch: 13 cost time: 2.21815824508667
Epoch: 13, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.919 Vali Acc: 0.606 Test Loss: 0.919 Test Acc: 0.606
Validation loss decreased (-0.594435 --> -0.605546).  Saving model ...
Epoch: 14 cost time: 2.4100186824798584
Epoch: 14, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.871 Vali Acc: 0.628 Test Loss: 0.871 Test Acc: 0.628
Validation loss decreased (-0.605546 --> -0.627769).  Saving model ...
Epoch: 15 cost time: 2.2270395755767822
Epoch: 15, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
Validation loss decreased (-0.627769 --> -0.677770).  Saving model ...
Epoch: 16 cost time: 2.208557367324829
Epoch: 16, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.778 Vali Acc: 0.706 Test Loss: 0.778 Test Acc: 0.706
Validation loss decreased (-0.677770 --> -0.705548).  Saving model ...
Epoch: 17 cost time: 2.514512538909912
Epoch: 17, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.747 Vali Acc: 0.722 Test Loss: 0.747 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722215).  Saving model ...
Epoch: 18 cost time: 2.6555800437927246
Epoch: 18, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 2.485004425048828
Epoch: 19, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.662 Vali Acc: 0.761 Test Loss: 0.662 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 20 cost time: 2.7264018058776855
Epoch: 20, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5340421199798584
Epoch: 21, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761105).  Saving model ...
Epoch: 22 cost time: 2.388241767883301
Epoch: 22, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.521 Vali Acc: 0.794 Test Loss: 0.521 Test Acc: 0.794
Validation loss decreased (-0.761105 --> -0.794439).  Saving model ...
Epoch: 23 cost time: 2.7899882793426514
Epoch: 23, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5628750324249268
Epoch: 24, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
Validation loss decreased (-0.794439 --> -0.827774).  Saving model ...
Epoch: 25 cost time: 2.528731346130371
Epoch: 25, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.386 Vali Acc: 0.822 Test Loss: 0.386 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7728567123413086
Epoch: 26, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 2.5520482063293457
Epoch: 27, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4423320293426514
Epoch: 28, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.336 Vali Acc: 0.850 Test Loss: 0.336 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 29 cost time: 2.6519978046417236
Epoch: 29, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.337 Vali Acc: 0.844 Test Loss: 0.337 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4481730461120605
Epoch: 30, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.308 Vali Acc: 0.844 Test Loss: 0.308 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 882966
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1936933994293213
Epoch: 1, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.967 Vali Acc: 0.039 Test Loss: 1.967 Test Acc: 0.039
Validation loss decreased (inf --> -0.038869).  Saving model ...
Epoch: 2 cost time: 2.1640398502349854
Epoch: 2, Steps: 12 | Train Loss: 1.994 Vali Loss: 1.919 Vali Acc: 0.044 Test Loss: 1.919 Test Acc: 0.044
Validation loss decreased (-0.038869 --> -0.044425).  Saving model ...
Epoch: 3 cost time: 1.8647077083587646
Epoch: 3, Steps: 12 | Train Loss: 1.912 Vali Loss: 1.859 Vali Acc: 0.100 Test Loss: 1.859 Test Acc: 0.100
Validation loss decreased (-0.044425 --> -0.099981).  Saving model ...
Epoch: 4 cost time: 2.142629623413086
Epoch: 4, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.794 Vali Acc: 0.161 Test Loss: 1.794 Test Acc: 0.161
Validation loss decreased (-0.099981 --> -0.161093).  Saving model ...
Epoch: 5 cost time: 1.9111483097076416
Epoch: 5, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.728 Vali Acc: 0.244 Test Loss: 1.728 Test Acc: 0.244
Validation loss decreased (-0.161093 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 2.1120107173919678
Epoch: 6, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.652 Vali Acc: 0.333 Test Loss: 1.652 Test Acc: 0.333
Validation loss decreased (-0.244427 --> -0.333317).  Saving model ...
Epoch: 7 cost time: 1.9241793155670166
Epoch: 7, Steps: 12 | Train Loss: 1.614 Vali Loss: 1.560 Vali Acc: 0.417 Test Loss: 1.560 Test Acc: 0.417
Validation loss decreased (-0.333317 --> -0.416651).  Saving model ...
Epoch: 8 cost time: 2.2061893939971924
Epoch: 8, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.452 Vali Acc: 0.533 Test Loss: 1.452 Test Acc: 0.533
Validation loss decreased (-0.416651 --> -0.533319).  Saving model ...
Epoch: 9 cost time: 2.1554019451141357
Epoch: 9, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.328 Vali Acc: 0.606 Test Loss: 1.328 Test Acc: 0.606
Validation loss decreased (-0.533319 --> -0.605542).  Saving model ...
Epoch: 10 cost time: 1.959484338760376
Epoch: 10, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.205 Vali Acc: 0.639 Test Loss: 1.205 Test Acc: 0.639
Validation loss decreased (-0.605542 --> -0.638877).  Saving model ...
Epoch: 11 cost time: 2.362081289291382
Epoch: 11, Steps: 12 | Train Loss: 1.163 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 2.0980539321899414
Epoch: 12, Steps: 12 | Train Loss: 1.054 Vali Loss: 0.991 Vali Acc: 0.683 Test Loss: 0.991 Test Acc: 0.683
Validation loss decreased (-0.649989 --> -0.683323).  Saving model ...
Epoch: 13 cost time: 2.3728787899017334
Epoch: 13, Steps: 12 | Train Loss: 0.929 Vali Loss: 0.912 Vali Acc: 0.689 Test Loss: 0.912 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688880).  Saving model ...
Epoch: 14 cost time: 2.2391059398651123
Epoch: 14, Steps: 12 | Train Loss: 0.877 Vali Loss: 0.840 Vali Acc: 0.683 Test Loss: 0.840 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3354439735412598
Epoch: 15, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.787 Vali Acc: 0.694 Test Loss: 0.787 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694437).  Saving model ...
Epoch: 16 cost time: 2.1934893131256104
Epoch: 16, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.745 Vali Acc: 0.683 Test Loss: 0.745 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3373830318450928
Epoch: 17, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.715 Vali Acc: 0.706 Test Loss: 0.715 Test Acc: 0.706
Validation loss decreased (-0.694437 --> -0.705548).  Saving model ...
Epoch: 18 cost time: 2.077873945236206
Epoch: 18, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716660).  Saving model ...
Epoch: 19 cost time: 2.267167568206787
Epoch: 19, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.667 Vali Acc: 0.711 Test Loss: 0.667 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.997523307800293
Epoch: 20, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.650 Vali Acc: 0.694 Test Loss: 0.650 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.305753707885742
Epoch: 21, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.633 Vali Acc: 0.722 Test Loss: 0.633 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 22 cost time: 2.121302843093872
Epoch: 22, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.619 Vali Acc: 0.744 Test Loss: 0.619 Test Acc: 0.744
Validation loss decreased (-0.722216 --> -0.744438).  Saving model ...
Epoch: 23 cost time: 2.2589573860168457
Epoch: 23, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.603 Vali Acc: 0.750 Test Loss: 0.603 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 24 cost time: 1.8172264099121094
Epoch: 24, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 1.8416051864624023
Epoch: 25, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.578 Vali Acc: 0.744 Test Loss: 0.578 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8486099243164062
Epoch: 26, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 27 cost time: 1.8469815254211426
Epoch: 27, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.537 Vali Acc: 0.767 Test Loss: 0.537 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766661).  Saving model ...
Epoch: 28 cost time: 2.0287721157073975
Epoch: 28, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.521 Vali Acc: 0.772 Test Loss: 0.521 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 29 cost time: 1.8362913131713867
Epoch: 29, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783328).  Saving model ...
Epoch: 30 cost time: 2.027448892593384
Epoch: 30, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 261990
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.388168573379517
Epoch: 1, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.850 Vali Acc: 0.028 Test Loss: 1.850 Test Acc: 0.028
Validation loss decreased (inf --> -0.027759).  Saving model ...
Epoch: 2 cost time: 2.2167773246765137
Epoch: 2, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.790 Vali Acc: 0.061 Test Loss: 1.790 Test Acc: 0.061
Validation loss decreased (-0.027759 --> -0.061093).  Saving model ...
Epoch: 3 cost time: 2.507108211517334
Epoch: 3, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.709 Vali Acc: 0.178 Test Loss: 1.709 Test Acc: 0.178
Validation loss decreased (-0.061093 --> -0.177761).  Saving model ...
Epoch: 4 cost time: 2.351144790649414
Epoch: 4, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.627 Vali Acc: 0.322 Test Loss: 1.627 Test Acc: 0.322
Validation loss decreased (-0.177761 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 2.502182722091675
Epoch: 5, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.543 Vali Acc: 0.417 Test Loss: 1.543 Test Acc: 0.417
Validation loss decreased (-0.322206 --> -0.416651).  Saving model ...
Epoch: 6 cost time: 2.17861270904541
Epoch: 6, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.451 Vali Acc: 0.483 Test Loss: 1.451 Test Acc: 0.483
Validation loss decreased (-0.416651 --> -0.483319).  Saving model ...
Epoch: 7 cost time: 2.491276502609253
Epoch: 7, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.364 Vali Acc: 0.550 Test Loss: 1.364 Test Acc: 0.550
Validation loss decreased (-0.483319 --> -0.549986).  Saving model ...
Epoch: 8 cost time: 2.3518996238708496
Epoch: 8, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.267 Vali Acc: 0.594 Test Loss: 1.267 Test Acc: 0.594
Validation loss decreased (-0.549986 --> -0.594432).  Saving model ...
Epoch: 9 cost time: 2.5251119136810303
Epoch: 9, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.180 Vali Acc: 0.589 Test Loss: 1.180 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.402580738067627
Epoch: 10, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.109 Vali Acc: 0.589 Test Loss: 1.109 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.064262866973877
Epoch: 11, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.041 Vali Acc: 0.594 Test Loss: 1.041 Test Acc: 0.594
Validation loss decreased (-0.594432 --> -0.594434).  Saving model ...
Epoch: 12 cost time: 2.1074631214141846
Epoch: 12, Steps: 12 | Train Loss: 0.968 Vali Loss: 0.981 Vali Acc: 0.594 Test Loss: 0.981 Test Acc: 0.594
Validation loss decreased (-0.594434 --> -0.594435).  Saving model ...
Epoch: 13 cost time: 2.012901782989502
Epoch: 13, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.919 Vali Acc: 0.606 Test Loss: 0.919 Test Acc: 0.606
Validation loss decreased (-0.594435 --> -0.605546).  Saving model ...
Epoch: 14 cost time: 1.9785230159759521
Epoch: 14, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.872 Vali Acc: 0.628 Test Loss: 0.872 Test Acc: 0.628
Validation loss decreased (-0.605546 --> -0.627769).  Saving model ...
Epoch: 15 cost time: 2.044036865234375
Epoch: 15, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
Validation loss decreased (-0.627769 --> -0.677770).  Saving model ...
Epoch: 16 cost time: 2.0277485847473145
Epoch: 16, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.779 Vali Acc: 0.706 Test Loss: 0.779 Test Acc: 0.706
Validation loss decreased (-0.677770 --> -0.705548).  Saving model ...
Epoch: 17 cost time: 2.2369186878204346
Epoch: 17, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711104).  Saving model ...
Epoch: 18 cost time: 2.0734357833862305
Epoch: 18, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.694 Vali Acc: 0.744 Test Loss: 0.694 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 19 cost time: 1.9805550575256348
Epoch: 19, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.656 Vali Acc: 0.744 Test Loss: 0.656 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744438).  Saving model ...
Epoch: 20 cost time: 1.9586601257324219
Epoch: 20, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755549).  Saving model ...
Epoch: 21 cost time: 2.195361614227295
Epoch: 21, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.576 Vali Acc: 0.772 Test Loss: 0.576 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772216).  Saving model ...
Epoch: 22 cost time: 1.988781452178955
Epoch: 22, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.534 Vali Acc: 0.778 Test Loss: 0.534 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 23 cost time: 1.9446630477905273
Epoch: 23, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.496 Vali Acc: 0.778 Test Loss: 0.496 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 24 cost time: 2.39223575592041
Epoch: 24, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816663).  Saving model ...
Epoch: 25 cost time: 2.58911395072937
Epoch: 25, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 26 cost time: 2.172564744949341
Epoch: 26, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.355 Vali Acc: 0.828 Test Loss: 0.355 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 27 cost time: 2.1970129013061523
Epoch: 27, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 28 cost time: 2.418041706085205
Epoch: 28, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4363112449645996
Epoch: 29, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 30 cost time: 2.279991388320923
Epoch: 30, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.300 Vali Acc: 0.844 Test Loss: 0.300 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 882966
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.441230297088623
Epoch: 1, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.967 Vali Acc: 0.039 Test Loss: 1.967 Test Acc: 0.039
Validation loss decreased (inf --> -0.038869).  Saving model ...
Epoch: 2 cost time: 1.9679303169250488
Epoch: 2, Steps: 12 | Train Loss: 1.994 Vali Loss: 1.919 Vali Acc: 0.044 Test Loss: 1.919 Test Acc: 0.044
Validation loss decreased (-0.038869 --> -0.044425).  Saving model ...
Epoch: 3 cost time: 1.742687463760376
Epoch: 3, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.859 Vali Acc: 0.100 Test Loss: 1.859 Test Acc: 0.100
Validation loss decreased (-0.044425 --> -0.099981).  Saving model ...
Epoch: 4 cost time: 1.7679839134216309
Epoch: 4, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.794 Vali Acc: 0.161 Test Loss: 1.794 Test Acc: 0.161
Validation loss decreased (-0.099981 --> -0.161093).  Saving model ...
Epoch: 5 cost time: 1.9140887260437012
Epoch: 5, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.728 Vali Acc: 0.244 Test Loss: 1.728 Test Acc: 0.244
Validation loss decreased (-0.161093 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 1.550541877746582
Epoch: 6, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.652 Vali Acc: 0.339 Test Loss: 1.652 Test Acc: 0.339
Validation loss decreased (-0.244427 --> -0.338872).  Saving model ...
Epoch: 7 cost time: 1.4316260814666748
Epoch: 7, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.560 Vali Acc: 0.417 Test Loss: 1.560 Test Acc: 0.417
Validation loss decreased (-0.338872 --> -0.416651).  Saving model ...
Epoch: 8 cost time: 1.4924302101135254
Epoch: 8, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.452 Vali Acc: 0.528 Test Loss: 1.452 Test Acc: 0.528
Validation loss decreased (-0.416651 --> -0.527763).  Saving model ...
Epoch: 9 cost time: 1.5685677528381348
Epoch: 9, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.328 Vali Acc: 0.600 Test Loss: 1.328 Test Acc: 0.600
Validation loss decreased (-0.527763 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 1.4028308391571045
Epoch: 10, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.205 Vali Acc: 0.633 Test Loss: 1.205 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 11 cost time: 1.3932044506072998
Epoch: 11, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.095 Vali Acc: 0.644 Test Loss: 1.095 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644433).  Saving model ...
Epoch: 12 cost time: 1.5660016536712646
Epoch: 12, Steps: 12 | Train Loss: 1.054 Vali Loss: 0.994 Vali Acc: 0.683 Test Loss: 0.994 Test Acc: 0.683
Validation loss decreased (-0.644433 --> -0.683323).  Saving model ...
Epoch: 13 cost time: 1.4991891384124756
Epoch: 13, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.917 Vali Acc: 0.689 Test Loss: 0.917 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688880).  Saving model ...
Epoch: 14 cost time: 1.4079110622406006
Epoch: 14, Steps: 12 | Train Loss: 0.878 Vali Loss: 0.843 Vali Acc: 0.683 Test Loss: 0.843 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5906670093536377
Epoch: 15, Steps: 12 | Train Loss: 0.837 Vali Loss: 0.792 Vali Acc: 0.689 Test Loss: 0.792 Test Acc: 0.689
Validation loss decreased (-0.688880 --> -0.688881).  Saving model ...
Epoch: 16 cost time: 1.6247916221618652
Epoch: 16, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.747 Vali Acc: 0.683 Test Loss: 0.747 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6068813800811768
Epoch: 17, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.716 Vali Acc: 0.706 Test Loss: 0.716 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705548).  Saving model ...
Epoch: 18 cost time: 1.6330604553222656
Epoch: 18, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716660).  Saving model ...
Epoch: 19 cost time: 2.0689384937286377
Epoch: 19, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.668 Vali Acc: 0.711 Test Loss: 0.668 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.886897087097168
Epoch: 20, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.651 Vali Acc: 0.694 Test Loss: 0.651 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9743423461914062
Epoch: 21, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.634 Vali Acc: 0.722 Test Loss: 0.634 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 22 cost time: 2.0925161838531494
Epoch: 22, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.620 Vali Acc: 0.739 Test Loss: 0.620 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738883).  Saving model ...
Epoch: 23 cost time: 1.8186569213867188
Epoch: 23, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.604 Vali Acc: 0.744 Test Loss: 0.604 Test Acc: 0.744
Validation loss decreased (-0.738883 --> -0.744438).  Saving model ...
Epoch: 24 cost time: 1.7045514583587646
Epoch: 24, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 2.0934367179870605
Epoch: 25, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.578 Vali Acc: 0.750 Test Loss: 0.578 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 26 cost time: 1.9134986400604248
Epoch: 26, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 27 cost time: 1.8685803413391113
Epoch: 27, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.537 Vali Acc: 0.767 Test Loss: 0.537 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766661).  Saving model ...
Epoch: 28 cost time: 2.1072018146514893
Epoch: 28, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.521 Vali Acc: 0.772 Test Loss: 0.521 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 29 cost time: 1.7235922813415527
Epoch: 29, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783328).  Saving model ...
Epoch: 30 cost time: 2.136028528213501
Epoch: 30, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 261990
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2999942302703857
Epoch: 1, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.850 Vali Acc: 0.028 Test Loss: 1.850 Test Acc: 0.028
Validation loss decreased (inf --> -0.027759).  Saving model ...
Epoch: 2 cost time: 1.4679806232452393
Epoch: 2, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.790 Vali Acc: 0.061 Test Loss: 1.790 Test Acc: 0.061
Validation loss decreased (-0.027759 --> -0.061093).  Saving model ...
Epoch: 3 cost time: 1.6462044715881348
Epoch: 3, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.709 Vali Acc: 0.178 Test Loss: 1.709 Test Acc: 0.178
Validation loss decreased (-0.061093 --> -0.177761).  Saving model ...
Epoch: 4 cost time: 1.516813039779663
Epoch: 4, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.627 Vali Acc: 0.322 Test Loss: 1.627 Test Acc: 0.322
Validation loss decreased (-0.177761 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 1.5510878562927246
Epoch: 5, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.543 Vali Acc: 0.417 Test Loss: 1.543 Test Acc: 0.417
Validation loss decreased (-0.322206 --> -0.416651).  Saving model ...
Epoch: 6 cost time: 1.717766284942627
Epoch: 6, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.452 Vali Acc: 0.483 Test Loss: 1.452 Test Acc: 0.483
Validation loss decreased (-0.416651 --> -0.483319).  Saving model ...
Epoch: 7 cost time: 1.4861969947814941
Epoch: 7, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.365 Vali Acc: 0.550 Test Loss: 1.365 Test Acc: 0.550
Validation loss decreased (-0.483319 --> -0.549986).  Saving model ...
Epoch: 8 cost time: 1.6404221057891846
Epoch: 8, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.268 Vali Acc: 0.594 Test Loss: 1.268 Test Acc: 0.594
Validation loss decreased (-0.549986 --> -0.594432).  Saving model ...
Epoch: 9 cost time: 1.6601402759552002
Epoch: 9, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.181 Vali Acc: 0.589 Test Loss: 1.181 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7546148300170898
Epoch: 10, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.109 Vali Acc: 0.589 Test Loss: 1.109 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8815703392028809
Epoch: 11, Steps: 12 | Train Loss: 1.005 Vali Loss: 1.042 Vali Acc: 0.594 Test Loss: 1.042 Test Acc: 0.594
Validation loss decreased (-0.594432 --> -0.594434).  Saving model ...
Epoch: 12 cost time: 1.920306921005249
Epoch: 12, Steps: 12 | Train Loss: 0.968 Vali Loss: 0.982 Vali Acc: 0.594 Test Loss: 0.982 Test Acc: 0.594
Validation loss decreased (-0.594434 --> -0.594435).  Saving model ...
Epoch: 13 cost time: 1.915187120437622
Epoch: 13, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.920 Vali Acc: 0.606 Test Loss: 0.920 Test Acc: 0.606
Validation loss decreased (-0.594435 --> -0.605546).  Saving model ...
Epoch: 14 cost time: 1.6498761177062988
Epoch: 14, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.873 Vali Acc: 0.628 Test Loss: 0.873 Test Acc: 0.628
Validation loss decreased (-0.605546 --> -0.627769).  Saving model ...
Epoch: 15 cost time: 1.9268097877502441
Epoch: 15, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.826 Vali Acc: 0.672 Test Loss: 0.826 Test Acc: 0.672
Validation loss decreased (-0.627769 --> -0.672214).  Saving model ...
Epoch: 16 cost time: 1.9054129123687744
Epoch: 16, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.780 Vali Acc: 0.700 Test Loss: 0.780 Test Acc: 0.700
Validation loss decreased (-0.672214 --> -0.699992).  Saving model ...
Epoch: 17 cost time: 1.6209564208984375
Epoch: 17, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711104).  Saving model ...
Epoch: 18 cost time: 1.9997713565826416
Epoch: 18, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.695 Vali Acc: 0.744 Test Loss: 0.695 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744437).  Saving model ...
Epoch: 19 cost time: 1.9380171298980713
Epoch: 19, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.657 Vali Acc: 0.744 Test Loss: 0.657 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744438).  Saving model ...
Epoch: 20 cost time: 1.709169864654541
Epoch: 20, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 21 cost time: 1.9798271656036377
Epoch: 21, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.577 Vali Acc: 0.778 Test Loss: 0.577 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777772).  Saving model ...
Epoch: 22 cost time: 1.945641279220581
Epoch: 22, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.546 Vali Acc: 0.778 Test Loss: 0.546 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 23 cost time: 1.8506743907928467
Epoch: 23, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.540 Vali Acc: 0.767 Test Loss: 0.540 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7469077110290527
Epoch: 24, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.481 Vali Acc: 0.794 Test Loss: 0.481 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 25 cost time: 1.6246435642242432
Epoch: 25, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.468 Vali Acc: 0.783 Test Loss: 0.468 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8864271640777588
Epoch: 26, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.439 Vali Acc: 0.789 Test Loss: 0.439 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7761509418487549
Epoch: 27, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.419 Vali Acc: 0.806 Test Loss: 0.419 Test Acc: 0.806
Validation loss decreased (-0.794440 --> -0.805551).  Saving model ...
Epoch: 28 cost time: 1.951148271560669
Epoch: 28, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.421 Vali Acc: 0.783 Test Loss: 0.421 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.639451265335083
Epoch: 29, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.396 Vali Acc: 0.839 Test Loss: 0.396 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 30 cost time: 1.5406160354614258
Epoch: 30, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.397 Vali Acc: 0.811 Test Loss: 0.397 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 882966
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3484129905700684
Epoch: 1, Steps: 12 | Train Loss: 2.014 Vali Loss: 1.969 Vali Acc: 0.033 Test Loss: 1.969 Test Acc: 0.033
Validation loss decreased (inf --> -0.033314).  Saving model ...
Epoch: 2 cost time: 1.410029411315918
Epoch: 2, Steps: 12 | Train Loss: 1.995 Vali Loss: 1.920 Vali Acc: 0.039 Test Loss: 1.920 Test Acc: 0.039
Validation loss decreased (-0.033314 --> -0.038870).  Saving model ...
Epoch: 3 cost time: 1.2954611778259277
Epoch: 3, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.861 Vali Acc: 0.094 Test Loss: 1.861 Test Acc: 0.094
Validation loss decreased (-0.038870 --> -0.094426).  Saving model ...
Epoch: 4 cost time: 1.496823787689209
Epoch: 4, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.797 Vali Acc: 0.156 Test Loss: 1.797 Test Acc: 0.156
Validation loss decreased (-0.094426 --> -0.155538).  Saving model ...
Epoch: 5 cost time: 1.3249397277832031
Epoch: 5, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.732 Vali Acc: 0.233 Test Loss: 1.732 Test Acc: 0.233
Validation loss decreased (-0.155538 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 1.316375494003296
Epoch: 6, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.656 Vali Acc: 0.317 Test Loss: 1.656 Test Acc: 0.317
Validation loss decreased (-0.233316 --> -0.316650).  Saving model ...
Epoch: 7 cost time: 1.716170072555542
Epoch: 7, Steps: 12 | Train Loss: 1.622 Vali Loss: 1.566 Vali Acc: 0.411 Test Loss: 1.566 Test Acc: 0.411
Validation loss decreased (-0.316650 --> -0.411095).  Saving model ...
Epoch: 8 cost time: 1.4930331707000732
Epoch: 8, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.459 Vali Acc: 0.500 Test Loss: 1.459 Test Acc: 0.500
Validation loss decreased (-0.411095 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.6341733932495117
Epoch: 9, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.336 Vali Acc: 0.578 Test Loss: 1.336 Test Acc: 0.578
Validation loss decreased (-0.499985 --> -0.577764).  Saving model ...
Epoch: 10 cost time: 1.4524381160736084
Epoch: 10, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.215 Vali Acc: 0.600 Test Loss: 1.215 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 1.2765564918518066
Epoch: 11, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.106 Vali Acc: 0.639 Test Loss: 1.106 Test Acc: 0.639
Validation loss decreased (-0.599988 --> -0.638878).  Saving model ...
Epoch: 12 cost time: 1.3175153732299805
Epoch: 12, Steps: 12 | Train Loss: 1.069 Vali Loss: 1.011 Vali Acc: 0.689 Test Loss: 1.011 Test Acc: 0.689
Validation loss decreased (-0.638878 --> -0.688879).  Saving model ...
Epoch: 13 cost time: 1.2799651622772217
Epoch: 13, Steps: 12 | Train Loss: 0.958 Vali Loss: 0.939 Vali Acc: 0.672 Test Loss: 0.939 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2560324668884277
Epoch: 14, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.874 Vali Acc: 0.694 Test Loss: 0.874 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694436).  Saving model ...
Epoch: 15 cost time: 1.2647745609283447
Epoch: 15, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.826 Vali Acc: 0.694 Test Loss: 0.826 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694436).  Saving model ...
Epoch: 16 cost time: 1.3028616905212402
Epoch: 16, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.785 Vali Acc: 0.700 Test Loss: 0.785 Test Acc: 0.700
Validation loss decreased (-0.694436 --> -0.699992).  Saving model ...
Epoch: 17 cost time: 1.3300845623016357
Epoch: 17, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.754 Vali Acc: 0.706 Test Loss: 0.754 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705548).  Saving model ...
Epoch: 18 cost time: 1.7483065128326416
Epoch: 18, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.725 Vali Acc: 0.733 Test Loss: 0.725 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 19 cost time: 1.4769771099090576
Epoch: 19, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.703 Vali Acc: 0.722 Test Loss: 0.703 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6502037048339844
Epoch: 20, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.686 Vali Acc: 0.706 Test Loss: 0.686 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.489166021347046
Epoch: 21, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.662 Vali Acc: 0.744 Test Loss: 0.662 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 22 cost time: 1.590014934539795
Epoch: 22, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.645 Vali Acc: 0.733 Test Loss: 0.645 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4544410705566406
Epoch: 23, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
Validation loss decreased (-0.744438 --> -0.749994).  Saving model ...
Epoch: 24 cost time: 1.5777828693389893
Epoch: 24, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 25 cost time: 1.4147675037384033
Epoch: 25, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761105).  Saving model ...
Epoch: 26 cost time: 1.3907761573791504
Epoch: 26, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.563 Vali Acc: 0.778 Test Loss: 0.563 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777772).  Saving model ...
Epoch: 27 cost time: 1.2651660442352295
Epoch: 27, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.539 Vali Acc: 0.794 Test Loss: 0.539 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794439).  Saving model ...
Epoch: 28 cost time: 1.2981364727020264
Epoch: 28, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1731140613555908
Epoch: 29, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.511 Vali Acc: 0.800 Test Loss: 0.511 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799995).  Saving model ...
Epoch: 30 cost time: 1.1307244300842285
Epoch: 30, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 261990
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8361458778381348
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.756 Vali Acc: 0.194 Test Loss: 1.756 Test Acc: 0.194
Validation loss decreased (inf --> -0.194427).  Saving model ...
Epoch: 2 cost time: 2.188086748123169
Epoch: 2, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.717 Vali Acc: 0.239 Test Loss: 1.717 Test Acc: 0.239
Validation loss decreased (-0.194427 --> -0.238872).  Saving model ...
Epoch: 3 cost time: 2.3249778747558594
Epoch: 3, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.665 Vali Acc: 0.272 Test Loss: 1.665 Test Acc: 0.272
Validation loss decreased (-0.238872 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 2.4596328735351562
Epoch: 4, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.606 Vali Acc: 0.356 Test Loss: 1.606 Test Acc: 0.356
Validation loss decreased (-0.272206 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 2.4828929901123047
Epoch: 5, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.540 Vali Acc: 0.428 Test Loss: 1.540 Test Acc: 0.428
Validation loss decreased (-0.355539 --> -0.427762).  Saving model ...
Epoch: 6 cost time: 2.3048970699310303
Epoch: 6, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.467 Vali Acc: 0.517 Test Loss: 1.467 Test Acc: 0.517
Validation loss decreased (-0.427762 --> -0.516652).  Saving model ...
Epoch: 7 cost time: 2.4645495414733887
Epoch: 7, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.388 Vali Acc: 0.567 Test Loss: 1.388 Test Acc: 0.567
Validation loss decreased (-0.516652 --> -0.566653).  Saving model ...
Epoch: 8 cost time: 2.44218373298645
Epoch: 8, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.301 Vali Acc: 0.556 Test Loss: 1.301 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.319998025894165
Epoch: 9, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.214 Vali Acc: 0.567 Test Loss: 1.214 Test Acc: 0.567
Validation loss decreased (-0.566653 --> -0.566655).  Saving model ...
Epoch: 10 cost time: 2.5908665657043457
Epoch: 10, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.566655 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 2.3652102947235107
Epoch: 11, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.036 Vali Acc: 0.628 Test Loss: 1.036 Test Acc: 0.628
Validation loss decreased (-0.599989 --> -0.627767).  Saving model ...
Epoch: 12 cost time: 2.271604299545288
Epoch: 12, Steps: 12 | Train Loss: 0.945 Vali Loss: 0.948 Vali Acc: 0.667 Test Loss: 0.948 Test Acc: 0.667
Validation loss decreased (-0.627767 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 2.5635812282562256
Epoch: 13, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.866 Vali Acc: 0.683 Test Loss: 0.866 Test Acc: 0.683
Validation loss decreased (-0.666657 --> -0.683325).  Saving model ...
Epoch: 14 cost time: 2.210240125656128
Epoch: 14, Steps: 12 | Train Loss: 0.771 Vali Loss: 0.796 Vali Acc: 0.694 Test Loss: 0.796 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694436).  Saving model ...
Epoch: 15 cost time: 2.372997999191284
Epoch: 15, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.734 Vali Acc: 0.694 Test Loss: 0.734 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694437).  Saving model ...
Epoch: 16 cost time: 2.596198797225952
Epoch: 16, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.689 Vali Acc: 0.733 Test Loss: 0.689 Test Acc: 0.733
Validation loss decreased (-0.694437 --> -0.733326).  Saving model ...
Epoch: 17 cost time: 2.3287911415100098
Epoch: 17, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.653 Vali Acc: 0.728 Test Loss: 0.653 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9233403205871582
Epoch: 18, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9429714679718018
Epoch: 19, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.596 Vali Acc: 0.739 Test Loss: 0.596 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738883).  Saving model ...
Epoch: 20 cost time: 1.8316650390625
Epoch: 20, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8183069229125977
Epoch: 21, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.553 Vali Acc: 0.739 Test Loss: 0.553 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738883).  Saving model ...
Epoch: 22 cost time: 1.8524971008300781
Epoch: 22, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755550).  Saving model ...
Epoch: 23 cost time: 1.7670531272888184
Epoch: 23, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755550).  Saving model ...
Epoch: 24 cost time: 1.7752337455749512
Epoch: 24, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.512 Vali Acc: 0.756 Test Loss: 0.512 Test Acc: 0.756
Validation loss decreased (-0.755550 --> -0.755550).  Saving model ...
Epoch: 25 cost time: 2.310778856277466
Epoch: 25, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.494 Vali Acc: 0.761 Test Loss: 0.494 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 26 cost time: 2.380272388458252
Epoch: 26, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783328).  Saving model ...
Epoch: 27 cost time: 2.626966714859009
Epoch: 27, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783328).  Saving model ...
Epoch: 28 cost time: 2.3404123783111572
Epoch: 28, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.491 Vali Acc: 0.750 Test Loss: 0.491 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3899192810058594
Epoch: 29, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.492 Vali Acc: 0.756 Test Loss: 0.492 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4541866779327393
Epoch: 30, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.507 Vali Acc: 0.767 Test Loss: 0.507 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 443094
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.208959341049194
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.746 Vali Acc: 0.233 Test Loss: 1.746 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.9558372497558594
Epoch: 2, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.698 Vali Acc: 0.283 Test Loss: 1.698 Test Acc: 0.283
Validation loss decreased (-0.233316 --> -0.283316).  Saving model ...
Epoch: 3 cost time: 2.3642680644989014
Epoch: 3, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.634 Vali Acc: 0.294 Test Loss: 1.634 Test Acc: 0.294
Validation loss decreased (-0.283316 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 2.0971200466156006
Epoch: 4, Steps: 12 | Train Loss: 1.582 Vali Loss: 1.558 Vali Acc: 0.383 Test Loss: 1.558 Test Acc: 0.383
Validation loss decreased (-0.294428 --> -0.383318).  Saving model ...
Epoch: 5 cost time: 2.3069002628326416
Epoch: 5, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.476 Vali Acc: 0.489 Test Loss: 1.476 Test Acc: 0.489
Validation loss decreased (-0.383318 --> -0.488874).  Saving model ...
Epoch: 6 cost time: 2.0086519718170166
Epoch: 6, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.387 Vali Acc: 0.544 Test Loss: 1.387 Test Acc: 0.544
Validation loss decreased (-0.488874 --> -0.544431).  Saving model ...
Epoch: 7 cost time: 2.2160353660583496
Epoch: 7, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.296 Vali Acc: 0.611 Test Loss: 1.296 Test Acc: 0.611
Validation loss decreased (-0.544431 --> -0.611098).  Saving model ...
Epoch: 8 cost time: 2.0863029956817627
Epoch: 8, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.207 Vali Acc: 0.650 Test Loss: 1.207 Test Acc: 0.650
Validation loss decreased (-0.611098 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 1.837557077407837
Epoch: 9, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.122 Vali Acc: 0.661 Test Loss: 1.122 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 10 cost time: 1.852081537246704
Epoch: 10, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.044 Vali Acc: 0.706 Test Loss: 1.044 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705545).  Saving model ...
Epoch: 11 cost time: 1.728785514831543
Epoch: 11, Steps: 12 | Train Loss: 0.942 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 12 cost time: 2.0324668884277344
Epoch: 12, Steps: 12 | Train Loss: 0.888 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.7600934505462646
Epoch: 13, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.846 Vali Acc: 0.728 Test Loss: 0.846 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 2.122140645980835
Epoch: 14, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.791 Vali Acc: 0.722 Test Loss: 0.791 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9694569110870361
Epoch: 15, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.747 Vali Acc: 0.744 Test Loss: 0.747 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744437).  Saving model ...
Epoch: 16 cost time: 2.0699777603149414
Epoch: 16, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 1.868931531906128
Epoch: 17, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.697 Vali Acc: 0.728 Test Loss: 0.697 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2482287883758545
Epoch: 18, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.666 Vali Acc: 0.739 Test Loss: 0.666 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.031658887863159
Epoch: 19, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.648 Vali Acc: 0.744 Test Loss: 0.648 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.265657663345337
Epoch: 20, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.610 Vali Acc: 0.744 Test Loss: 0.610 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.006455898284912
Epoch: 21, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.596 Vali Acc: 0.756 Test Loss: 0.596 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755550).  Saving model ...
Epoch: 22 cost time: 2.3073031902313232
Epoch: 22, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0614004135131836
Epoch: 23, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.593 Vali Acc: 0.761 Test Loss: 0.593 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761105).  Saving model ...
Epoch: 24 cost time: 2.276170015335083
Epoch: 24, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9571621417999268
Epoch: 25, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0258524417877197
Epoch: 26, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.569 Vali Acc: 0.767 Test Loss: 0.569 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 27 cost time: 2.096179246902466
Epoch: 27, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.567 Vali Acc: 0.767 Test Loss: 0.567 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 28 cost time: 2.0242457389831543
Epoch: 28, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.580 Vali Acc: 0.756 Test Loss: 0.580 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.288784980773926
Epoch: 29, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.570 Vali Acc: 0.767 Test Loss: 0.570 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0940070152282715
Epoch: 30, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.563 Vali Acc: 0.750 Test Loss: 0.563 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 132582
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1744675636291504
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.756 Vali Acc: 0.194 Test Loss: 1.756 Test Acc: 0.194
Validation loss decreased (inf --> -0.194427).  Saving model ...
Epoch: 2 cost time: 1.5784580707550049
Epoch: 2, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.717 Vali Acc: 0.239 Test Loss: 1.717 Test Acc: 0.239
Validation loss decreased (-0.194427 --> -0.238872).  Saving model ...
Epoch: 3 cost time: 1.5079972743988037
Epoch: 3, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.665 Vali Acc: 0.272 Test Loss: 1.665 Test Acc: 0.272
Validation loss decreased (-0.238872 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 1.564908504486084
Epoch: 4, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.606 Vali Acc: 0.356 Test Loss: 1.606 Test Acc: 0.356
Validation loss decreased (-0.272206 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 1.5716207027435303
Epoch: 5, Steps: 12 | Train Loss: 1.561 Vali Loss: 1.540 Vali Acc: 0.428 Test Loss: 1.540 Test Acc: 0.428
Validation loss decreased (-0.355539 --> -0.427762).  Saving model ...
Epoch: 6 cost time: 1.523057460784912
Epoch: 6, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.466 Vali Acc: 0.517 Test Loss: 1.466 Test Acc: 0.517
Validation loss decreased (-0.427762 --> -0.516652).  Saving model ...
Epoch: 7 cost time: 1.695998191833496
Epoch: 7, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.388 Vali Acc: 0.567 Test Loss: 1.388 Test Acc: 0.567
Validation loss decreased (-0.516652 --> -0.566653).  Saving model ...
Epoch: 8 cost time: 1.9986803531646729
Epoch: 8, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.300 Vali Acc: 0.556 Test Loss: 1.300 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8081636428833008
Epoch: 9, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.213 Vali Acc: 0.567 Test Loss: 1.213 Test Acc: 0.567
Validation loss decreased (-0.566653 --> -0.566655).  Saving model ...
Epoch: 10 cost time: 1.999525547027588
Epoch: 10, Steps: 12 | Train Loss: 1.125 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.566655 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 2.2509751319885254
Epoch: 11, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
Validation loss decreased (-0.599989 --> -0.622212).  Saving model ...
Epoch: 12 cost time: 1.9598584175109863
Epoch: 12, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.954 Vali Acc: 0.667 Test Loss: 0.954 Test Acc: 0.667
Validation loss decreased (-0.622212 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 1.9262278079986572
Epoch: 13, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.873 Vali Acc: 0.678 Test Loss: 0.873 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 14 cost time: 2.255270004272461
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.806 Vali Acc: 0.694 Test Loss: 0.806 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694436).  Saving model ...
Epoch: 15 cost time: 1.967247486114502
Epoch: 15, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.744 Vali Acc: 0.694 Test Loss: 0.744 Test Acc: 0.694
Validation loss decreased (-0.694436 --> -0.694437).  Saving model ...
Epoch: 16 cost time: 2.0013182163238525
Epoch: 16, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
Validation loss decreased (-0.694437 --> -0.716660).  Saving model ...
Epoch: 17 cost time: 2.1087758541107178
Epoch: 17, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.662 Vali Acc: 0.722 Test Loss: 0.662 Test Acc: 0.722
Validation loss decreased (-0.716660 --> -0.722216).  Saving model ...
Epoch: 18 cost time: 1.9521477222442627
Epoch: 18, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.882803201675415
Epoch: 19, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.608 Vali Acc: 0.728 Test Loss: 0.608 Test Acc: 0.728
Validation loss decreased (-0.722216 --> -0.727772).  Saving model ...
Epoch: 20 cost time: 2.1786744594573975
Epoch: 20, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.594 Vali Acc: 0.728 Test Loss: 0.594 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727772).  Saving model ...
Epoch: 21 cost time: 1.9128503799438477
Epoch: 21, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.565 Vali Acc: 0.728 Test Loss: 0.565 Test Acc: 0.728
Validation loss decreased (-0.727772 --> -0.727772).  Saving model ...
Epoch: 22 cost time: 1.963181734085083
Epoch: 22, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.552 Vali Acc: 0.739 Test Loss: 0.552 Test Acc: 0.739
Validation loss decreased (-0.727772 --> -0.738883).  Saving model ...
Epoch: 23 cost time: 2.028484344482422
Epoch: 23, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.529 Vali Acc: 0.750 Test Loss: 0.529 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749995).  Saving model ...
Epoch: 24 cost time: 1.997041940689087
Epoch: 24, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.528 Vali Acc: 0.750 Test Loss: 0.528 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 25 cost time: 1.9037322998046875
Epoch: 25, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.749995 --> -0.755550).  Saving model ...
Epoch: 26 cost time: 1.735487699508667
Epoch: 26, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.513 Vali Acc: 0.772 Test Loss: 0.513 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 27 cost time: 2.017812728881836
Epoch: 27, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.498 Vali Acc: 0.767 Test Loss: 0.498 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7038772106170654
Epoch: 28, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.483 Vali Acc: 0.761 Test Loss: 0.483 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7345399856567383
Epoch: 29, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.494 Vali Acc: 0.772 Test Loss: 0.494 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 30 cost time: 2.0008697509765625
Epoch: 30, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.483 Vali Acc: 0.767 Test Loss: 0.483 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 443094
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5906524658203125
Epoch: 1, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.746 Vali Acc: 0.233 Test Loss: 1.746 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 1.751737356185913
Epoch: 2, Steps: 12 | Train Loss: 1.739 Vali Loss: 1.698 Vali Acc: 0.283 Test Loss: 1.698 Test Acc: 0.283
Validation loss decreased (-0.233316 --> -0.283316).  Saving model ...
Epoch: 3 cost time: 1.5227906703948975
Epoch: 3, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.634 Vali Acc: 0.294 Test Loss: 1.634 Test Acc: 0.294
Validation loss decreased (-0.283316 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 1.5932660102844238
Epoch: 4, Steps: 12 | Train Loss: 1.582 Vali Loss: 1.558 Vali Acc: 0.383 Test Loss: 1.558 Test Acc: 0.383
Validation loss decreased (-0.294428 --> -0.383318).  Saving model ...
Epoch: 5 cost time: 1.604978322982788
Epoch: 5, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.476 Vali Acc: 0.489 Test Loss: 1.476 Test Acc: 0.489
Validation loss decreased (-0.383318 --> -0.488874).  Saving model ...
Epoch: 6 cost time: 1.5568900108337402
Epoch: 6, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.388 Vali Acc: 0.544 Test Loss: 1.388 Test Acc: 0.544
Validation loss decreased (-0.488874 --> -0.544431).  Saving model ...
Epoch: 7 cost time: 1.5740633010864258
Epoch: 7, Steps: 12 | Train Loss: 1.319 Vali Loss: 1.297 Vali Acc: 0.611 Test Loss: 1.297 Test Acc: 0.611
Validation loss decreased (-0.544431 --> -0.611098).  Saving model ...
Epoch: 8 cost time: 1.6424038410186768
Epoch: 8, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.207 Vali Acc: 0.650 Test Loss: 1.207 Test Acc: 0.650
Validation loss decreased (-0.611098 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 1.8068139553070068
Epoch: 9, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.122 Vali Acc: 0.661 Test Loss: 1.122 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 10 cost time: 1.7636229991912842
Epoch: 10, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.044 Vali Acc: 0.706 Test Loss: 1.044 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705545).  Saving model ...
Epoch: 11 cost time: 1.9462974071502686
Epoch: 11, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716657).  Saving model ...
Epoch: 12 cost time: 1.7747611999511719
Epoch: 12, Steps: 12 | Train Loss: 0.888 Vali Loss: 0.905 Vali Acc: 0.722 Test Loss: 0.905 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.9696376323699951
Epoch: 13, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.847 Vali Acc: 0.728 Test Loss: 0.847 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 14 cost time: 1.7601070404052734
Epoch: 14, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.793 Vali Acc: 0.722 Test Loss: 0.793 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0207340717315674
Epoch: 15, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.751 Vali Acc: 0.733 Test Loss: 0.751 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733326).  Saving model ...
Epoch: 16 cost time: 1.5682451725006104
Epoch: 16, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.722 Vali Acc: 0.733 Test Loss: 0.722 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 17 cost time: 1.4831037521362305
Epoch: 17, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.700 Vali Acc: 0.728 Test Loss: 0.700 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.491002082824707
Epoch: 18, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.671 Vali Acc: 0.733 Test Loss: 0.671 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733327).  Saving model ...
Epoch: 19 cost time: 1.4960904121398926
Epoch: 19, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738882).  Saving model ...
Epoch: 20 cost time: 1.6424455642700195
Epoch: 20, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.618 Vali Acc: 0.739 Test Loss: 0.618 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 21 cost time: 1.586608648300171
Epoch: 21, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 1.8980555534362793
Epoch: 22, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 23 cost time: 1.5235011577606201
Epoch: 23, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.597 Vali Acc: 0.767 Test Loss: 0.597 Test Acc: 0.767
Validation loss decreased (-0.749994 --> -0.766661).  Saving model ...
Epoch: 24 cost time: 1.7987043857574463
Epoch: 24, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.617 Vali Acc: 0.756 Test Loss: 0.617 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6320974826812744
Epoch: 25, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.601 Vali Acc: 0.761 Test Loss: 0.601 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.871239423751831
Epoch: 26, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.575 Vali Acc: 0.778 Test Loss: 0.575 Test Acc: 0.778
Validation loss decreased (-0.766661 --> -0.777772).  Saving model ...
Epoch: 27 cost time: 1.706305980682373
Epoch: 27, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.569 Vali Acc: 0.767 Test Loss: 0.569 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7204480171203613
Epoch: 28, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.578 Vali Acc: 0.772 Test Loss: 0.578 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.980635643005371
Epoch: 29, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.571 Vali Acc: 0.778 Test Loss: 0.571 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 30 cost time: 1.6985492706298828
Epoch: 30, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 132582
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.468197822570801
Epoch: 1, Steps: 12 | Train Loss: 1.791 Vali Loss: 1.754 Vali Acc: 0.200 Test Loss: 1.754 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.6224708557128906
Epoch: 2, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.716 Vali Acc: 0.239 Test Loss: 1.716 Test Acc: 0.239
Validation loss decreased (-0.199982 --> -0.238872).  Saving model ...
Epoch: 3 cost time: 1.7940683364868164
Epoch: 3, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.665 Vali Acc: 0.272 Test Loss: 1.665 Test Acc: 0.272
Validation loss decreased (-0.238872 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 1.57084321975708
Epoch: 4, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.608 Vali Acc: 0.356 Test Loss: 1.608 Test Acc: 0.356
Validation loss decreased (-0.272206 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 1.6806387901306152
Epoch: 5, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.543 Vali Acc: 0.428 Test Loss: 1.543 Test Acc: 0.428
Validation loss decreased (-0.355539 --> -0.427762).  Saving model ...
Epoch: 6 cost time: 1.6444425582885742
Epoch: 6, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.471 Vali Acc: 0.506 Test Loss: 1.471 Test Acc: 0.506
Validation loss decreased (-0.427762 --> -0.505541).  Saving model ...
Epoch: 7 cost time: 1.8107218742370605
Epoch: 7, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.394 Vali Acc: 0.567 Test Loss: 1.394 Test Acc: 0.567
Validation loss decreased (-0.505541 --> -0.566653).  Saving model ...
Epoch: 8 cost time: 1.595376968383789
Epoch: 8, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.309 Vali Acc: 0.556 Test Loss: 1.309 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7356910705566406
Epoch: 9, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.225 Vali Acc: 0.561 Test Loss: 1.225 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5422909259796143
Epoch: 10, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.139 Vali Acc: 0.594 Test Loss: 1.139 Test Acc: 0.594
Validation loss decreased (-0.566653 --> -0.594433).  Saving model ...
Epoch: 11 cost time: 1.134281873703003
Epoch: 11, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.594433 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 1.21052885055542
Epoch: 12, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.968 Vali Acc: 0.644 Test Loss: 0.968 Test Acc: 0.644
Validation loss decreased (-0.599989 --> -0.644435).  Saving model ...
Epoch: 13 cost time: 1.2138793468475342
Epoch: 13, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.888 Vali Acc: 0.667 Test Loss: 0.888 Test Acc: 0.667
Validation loss decreased (-0.644435 --> -0.666658).  Saving model ...
Epoch: 14 cost time: 1.2243492603302002
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.824 Vali Acc: 0.672 Test Loss: 0.824 Test Acc: 0.672
Validation loss decreased (-0.666658 --> -0.672214).  Saving model ...
Epoch: 15 cost time: 1.1539509296417236
Epoch: 15, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.761 Vali Acc: 0.694 Test Loss: 0.761 Test Acc: 0.694
Validation loss decreased (-0.672214 --> -0.694437).  Saving model ...
Epoch: 16 cost time: 1.217677116394043
Epoch: 16, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.714 Vali Acc: 0.700 Test Loss: 0.714 Test Acc: 0.700
Validation loss decreased (-0.694437 --> -0.699993).  Saving model ...
Epoch: 17 cost time: 1.2357416152954102
Epoch: 17, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.677 Vali Acc: 0.706 Test Loss: 0.677 Test Acc: 0.706
Validation loss decreased (-0.699993 --> -0.705549).  Saving model ...
Epoch: 18 cost time: 1.1885230541229248
Epoch: 18, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.662 Vali Acc: 0.700 Test Loss: 0.662 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2276370525360107
Epoch: 19, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.618 Vali Acc: 0.711 Test Loss: 0.618 Test Acc: 0.711
Validation loss decreased (-0.705549 --> -0.711105).  Saving model ...
Epoch: 20 cost time: 1.5468125343322754
Epoch: 20, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
Validation loss decreased (-0.711105 --> -0.722216).  Saving model ...
Epoch: 21 cost time: 1.4806108474731445
Epoch: 21, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.577 Vali Acc: 0.739 Test Loss: 0.577 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738883).  Saving model ...
Epoch: 22 cost time: 1.7161462306976318
Epoch: 22, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.565 Vali Acc: 0.739 Test Loss: 0.565 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738883).  Saving model ...
Epoch: 23 cost time: 1.5099596977233887
Epoch: 23, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.536 Vali Acc: 0.733 Test Loss: 0.536 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5606532096862793
Epoch: 24, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.529 Vali Acc: 0.739 Test Loss: 0.529 Test Acc: 0.739
Validation loss decreased (-0.738883 --> -0.738884).  Saving model ...
Epoch: 25 cost time: 1.6735637187957764
Epoch: 25, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.508 Vali Acc: 0.744 Test Loss: 0.508 Test Acc: 0.744
Validation loss decreased (-0.738884 --> -0.744439).  Saving model ...
Epoch: 26 cost time: 1.541059970855713
Epoch: 26, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.500 Vali Acc: 0.744 Test Loss: 0.500 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744439).  Saving model ...
Epoch: 27 cost time: 1.473093032836914
Epoch: 27, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.479 Vali Acc: 0.761 Test Loss: 0.479 Test Acc: 0.761
Validation loss decreased (-0.744439 --> -0.761106).  Saving model ...
Epoch: 28 cost time: 1.560699701309204
Epoch: 28, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.480 Vali Acc: 0.750 Test Loss: 0.480 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5905661582946777
Epoch: 29, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.471 Vali Acc: 0.767 Test Loss: 0.471 Test Acc: 0.767
Validation loss decreased (-0.761106 --> -0.766662).  Saving model ...
Epoch: 30 cost time: 1.4094176292419434
Epoch: 30, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.461 Vali Acc: 0.750 Test Loss: 0.461 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 443094
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8830246925354004
Epoch: 1, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.743 Vali Acc: 0.239 Test Loss: 1.743 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 1.4077141284942627
Epoch: 2, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.695 Vali Acc: 0.283 Test Loss: 1.695 Test Acc: 0.283
Validation loss decreased (-0.238871 --> -0.283316).  Saving model ...
Epoch: 3 cost time: 1.498556137084961
Epoch: 3, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.631 Vali Acc: 0.294 Test Loss: 1.631 Test Acc: 0.294
Validation loss decreased (-0.283316 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 1.38075590133667
Epoch: 4, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.554 Vali Acc: 0.383 Test Loss: 1.554 Test Acc: 0.383
Validation loss decreased (-0.294428 --> -0.383318).  Saving model ...
Epoch: 5 cost time: 1.216785192489624
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.472 Vali Acc: 0.494 Test Loss: 1.472 Test Acc: 0.494
Validation loss decreased (-0.383318 --> -0.494430).  Saving model ...
Epoch: 6 cost time: 1.1579396724700928
Epoch: 6, Steps: 12 | Train Loss: 1.437 Vali Loss: 1.384 Vali Acc: 0.561 Test Loss: 1.384 Test Acc: 0.561
Validation loss decreased (-0.494430 --> -0.561097).  Saving model ...
Epoch: 7 cost time: 1.1912939548492432
Epoch: 7, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.292 Vali Acc: 0.611 Test Loss: 1.292 Test Acc: 0.611
Validation loss decreased (-0.561097 --> -0.611098).  Saving model ...
Epoch: 8 cost time: 1.3957972526550293
Epoch: 8, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.204 Vali Acc: 0.639 Test Loss: 1.204 Test Acc: 0.639
Validation loss decreased (-0.611098 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 1.1694221496582031
Epoch: 9, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.120 Vali Acc: 0.667 Test Loss: 1.120 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 1.1387393474578857
Epoch: 10, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 1.3936846256256104
Epoch: 11, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.977 Vali Acc: 0.717 Test Loss: 0.977 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716657).  Saving model ...
Epoch: 12 cost time: 1.1703746318817139
Epoch: 12, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 13 cost time: 1.2391643524169922
Epoch: 13, Steps: 12 | Train Loss: 0.875 Vali Loss: 0.864 Vali Acc: 0.722 Test Loss: 0.864 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 14 cost time: 1.1055378913879395
Epoch: 14, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.818 Vali Acc: 0.733 Test Loss: 0.818 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733325).  Saving model ...
Epoch: 15 cost time: 1.2435901165008545
Epoch: 15, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.518728256225586
Epoch: 16, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.743 Vali Acc: 0.728 Test Loss: 0.743 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.36759614944458
Epoch: 17, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.713 Vali Acc: 0.733 Test Loss: 0.713 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 18 cost time: 1.3722031116485596
Epoch: 18, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5428831577301025
Epoch: 19, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.664 Vali Acc: 0.733 Test Loss: 0.664 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733327).  Saving model ...
Epoch: 20 cost time: 1.4336185455322266
Epoch: 20, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3167107105255127
Epoch: 21, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5194323062896729
Epoch: 22, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.585 Vali Acc: 0.728 Test Loss: 0.585 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.338841438293457
Epoch: 23, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.569 Vali Acc: 0.744 Test Loss: 0.569 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 24 cost time: 1.3931193351745605
Epoch: 24, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755550).  Saving model ...
Epoch: 25 cost time: 1.385646104812622
Epoch: 25, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.525 Vali Acc: 0.767 Test Loss: 0.525 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766661).  Saving model ...
Epoch: 26 cost time: 1.3745512962341309
Epoch: 26, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.504 Vali Acc: 0.750 Test Loss: 0.504 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.456845760345459
Epoch: 27, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.484 Vali Acc: 0.772 Test Loss: 0.484 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 28 cost time: 1.3848512172698975
Epoch: 28, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.469 Vali Acc: 0.789 Test Loss: 0.469 Test Acc: 0.789
Validation loss decreased (-0.772217 --> -0.788884).  Saving model ...
Epoch: 29 cost time: 1.3510050773620605
Epoch: 29, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.450 Vali Acc: 0.800 Test Loss: 0.450 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 30 cost time: 1.5521128177642822
Epoch: 30, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.432 Vali Acc: 0.794 Test Loss: 0.432 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 132582
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6615355014801025
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.702 Vali Acc: 0.228 Test Loss: 1.702 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 1.8271915912628174
Epoch: 2, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.661 Vali Acc: 0.261 Test Loss: 1.661 Test Acc: 0.261
Validation loss decreased (-0.227761 --> -0.261094).  Saving model ...
Epoch: 3 cost time: 1.7970519065856934
Epoch: 3, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.608 Vali Acc: 0.367 Test Loss: 1.608 Test Acc: 0.367
Validation loss decreased (-0.261094 --> -0.366651).  Saving model ...
Epoch: 4 cost time: 1.7903919219970703
Epoch: 4, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.548 Vali Acc: 0.456 Test Loss: 1.548 Test Acc: 0.456
Validation loss decreased (-0.366651 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.686138391494751
Epoch: 5, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.485 Vali Acc: 0.506 Test Loss: 1.485 Test Acc: 0.506
Validation loss decreased (-0.455540 --> -0.505541).  Saving model ...
Epoch: 6 cost time: 2.1539626121520996
Epoch: 6, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.416 Vali Acc: 0.583 Test Loss: 1.416 Test Acc: 0.583
Validation loss decreased (-0.505541 --> -0.583319).  Saving model ...
Epoch: 7 cost time: 2.5147202014923096
Epoch: 7, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.348 Vali Acc: 0.622 Test Loss: 1.348 Test Acc: 0.622
Validation loss decreased (-0.583319 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 2.321382999420166
Epoch: 8, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.279 Vali Acc: 0.650 Test Loss: 1.279 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649987).  Saving model ...
Epoch: 9 cost time: 2.483466148376465
Epoch: 9, Steps: 12 | Train Loss: 1.250 Vali Loss: 1.210 Vali Acc: 0.628 Test Loss: 1.210 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3612678050994873
Epoch: 10, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.144 Vali Acc: 0.622 Test Loss: 1.144 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6960361003875732
Epoch: 11, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.086 Vali Acc: 0.644 Test Loss: 1.086 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.443380832672119
Epoch: 12, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.030 Vali Acc: 0.639 Test Loss: 1.030 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3490798473358154
Epoch: 13, Steps: 12 | Train Loss: 0.948 Vali Loss: 0.979 Vali Acc: 0.639 Test Loss: 0.979 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7142021656036377
Epoch: 14, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.933 Vali Acc: 0.661 Test Loss: 0.933 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661102).  Saving model ...
Epoch: 15 cost time: 2.3567824363708496
Epoch: 15, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.888 Vali Acc: 0.650 Test Loss: 0.888 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6526710987091064
Epoch: 16, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.851 Vali Acc: 0.656 Test Loss: 0.851 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.366347312927246
Epoch: 17, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.824 Vali Acc: 0.661 Test Loss: 0.824 Test Acc: 0.661
Validation loss decreased (-0.661102 --> -0.661103).  Saving model ...
Epoch: 18 cost time: 2.6555049419403076
Epoch: 18, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.804 Vali Acc: 0.667 Test Loss: 0.804 Test Acc: 0.667
Validation loss decreased (-0.661103 --> -0.666659).  Saving model ...
Epoch: 19 cost time: 2.3649446964263916
Epoch: 19, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.784 Vali Acc: 0.672 Test Loss: 0.784 Test Acc: 0.672
Validation loss decreased (-0.666659 --> -0.672214).  Saving model ...
Epoch: 20 cost time: 2.4789562225341797
Epoch: 20, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.766 Vali Acc: 0.667 Test Loss: 0.766 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7193260192871094
Epoch: 21, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.737 Vali Acc: 0.678 Test Loss: 0.737 Test Acc: 0.678
Validation loss decreased (-0.672214 --> -0.677770).  Saving model ...
Epoch: 22 cost time: 2.510028839111328
Epoch: 22, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.700 Vali Acc: 0.756 Test Loss: 0.700 Test Acc: 0.756
Validation loss decreased (-0.677770 --> -0.755549).  Saving model ...
Epoch: 23 cost time: 2.741131067276001
Epoch: 23, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.671 Vali Acc: 0.767 Test Loss: 0.671 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 24 cost time: 2.0120346546173096
Epoch: 24, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.457150936126709
Epoch: 25, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 26 cost time: 2.245865821838379
Epoch: 26, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.603 Vali Acc: 0.772 Test Loss: 0.603 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4003663063049316
Epoch: 27, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.529 Vali Acc: 0.761 Test Loss: 0.529 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1652135848999023
Epoch: 28, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788884).  Saving model ...
Epoch: 29 cost time: 2.1267049312591553
Epoch: 29, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.469 Vali Acc: 0.750 Test Loss: 0.469 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3848695755004883
Epoch: 30, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.456 Vali Acc: 0.767 Test Loss: 0.456 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 223158
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8622965812683105
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.800 Vali Acc: 0.211 Test Loss: 1.800 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 2.26055645942688
Epoch: 2, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.760 Vali Acc: 0.222 Test Loss: 1.760 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 2.149840831756592
Epoch: 3, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.708 Vali Acc: 0.278 Test Loss: 1.708 Test Acc: 0.278
Validation loss decreased (-0.222205 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 2.366218328475952
Epoch: 4, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.643 Vali Acc: 0.356 Test Loss: 1.643 Test Acc: 0.356
Validation loss decreased (-0.277761 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 2.215527296066284
Epoch: 5, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.572 Vali Acc: 0.478 Test Loss: 1.572 Test Acc: 0.478
Validation loss decreased (-0.355539 --> -0.477762).  Saving model ...
Epoch: 6 cost time: 2.1384170055389404
Epoch: 6, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.494 Vali Acc: 0.578 Test Loss: 1.494 Test Acc: 0.578
Validation loss decreased (-0.477762 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 2.4021353721618652
Epoch: 7, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
Validation loss decreased (-0.577763 --> -0.649986).  Saving model ...
Epoch: 8 cost time: 2.109196424484253
Epoch: 8, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.316 Vali Acc: 0.667 Test Loss: 1.316 Test Acc: 0.667
Validation loss decreased (-0.649986 --> -0.666654).  Saving model ...
Epoch: 9 cost time: 2.3184762001037598
Epoch: 9, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.220 Vali Acc: 0.700 Test Loss: 1.220 Test Acc: 0.700
Validation loss decreased (-0.666654 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 2.087007999420166
Epoch: 10, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.125 Vali Acc: 0.733 Test Loss: 1.125 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 2.0561563968658447
Epoch: 11, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.028 Vali Acc: 0.744 Test Loss: 1.028 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 2.366828203201294
Epoch: 12, Steps: 12 | Train Loss: 0.955 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.9909255504608154
Epoch: 13, Steps: 12 | Train Loss: 0.906 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 2.2848801612854004
Epoch: 14, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.808 Vali Acc: 0.756 Test Loss: 0.808 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 2.1286444664001465
Epoch: 15, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 1.8005919456481934
Epoch: 16, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.709 Vali Acc: 0.756 Test Loss: 0.709 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1182594299316406
Epoch: 17, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 1.7631027698516846
Epoch: 18, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.619 Vali Acc: 0.794 Test Loss: 0.619 Test Acc: 0.794
Validation loss decreased (-0.761104 --> -0.794438).  Saving model ...
Epoch: 19 cost time: 2.1090338230133057
Epoch: 19, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.579 Vali Acc: 0.778 Test Loss: 0.579 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8464677333831787
Epoch: 20, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8608064651489258
Epoch: 21, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.481 Vali Acc: 0.806 Test Loss: 0.481 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805551).  Saving model ...
Epoch: 22 cost time: 2.0749592781066895
Epoch: 22, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.454 Vali Acc: 0.817 Test Loss: 0.454 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 23 cost time: 1.7175722122192383
Epoch: 23, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.433 Vali Acc: 0.800 Test Loss: 0.433 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.026367425918579
Epoch: 24, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.416 Vali Acc: 0.789 Test Loss: 0.416 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.000333309173584
Epoch: 25, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9578969478607178
Epoch: 26, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.408 Vali Acc: 0.800 Test Loss: 0.408 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.323166608810425
Epoch: 27, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.394 Vali Acc: 0.789 Test Loss: 0.394 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0391123294830322
Epoch: 28, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.374 Vali Acc: 0.794 Test Loss: 0.374 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.2819595336914062
Epoch: 29, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.382 Vali Acc: 0.789 Test Loss: 0.382 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.191232204437256
Epoch: 30, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.380 Vali Acc: 0.794 Test Loss: 0.380 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 67878
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4912149906158447
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.702 Vali Acc: 0.228 Test Loss: 1.702 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 1.7295165061950684
Epoch: 2, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.661 Vali Acc: 0.261 Test Loss: 1.661 Test Acc: 0.261
Validation loss decreased (-0.227761 --> -0.261095).  Saving model ...
Epoch: 3 cost time: 1.6139249801635742
Epoch: 3, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.608 Vali Acc: 0.372 Test Loss: 1.608 Test Acc: 0.372
Validation loss decreased (-0.261095 --> -0.372206).  Saving model ...
Epoch: 4 cost time: 2.180462121963501
Epoch: 4, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.548 Vali Acc: 0.456 Test Loss: 1.548 Test Acc: 0.456
Validation loss decreased (-0.372206 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.8333008289337158
Epoch: 5, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.485 Vali Acc: 0.506 Test Loss: 1.485 Test Acc: 0.506
Validation loss decreased (-0.455540 --> -0.505541).  Saving model ...
Epoch: 6 cost time: 2.155022144317627
Epoch: 6, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.416 Vali Acc: 0.583 Test Loss: 1.416 Test Acc: 0.583
Validation loss decreased (-0.505541 --> -0.583319).  Saving model ...
Epoch: 7 cost time: 1.6687519550323486
Epoch: 7, Steps: 12 | Train Loss: 1.457 Vali Loss: 1.348 Vali Acc: 0.622 Test Loss: 1.348 Test Acc: 0.622
Validation loss decreased (-0.583319 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 1.7036559581756592
Epoch: 8, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.279 Vali Acc: 0.650 Test Loss: 1.279 Test Acc: 0.650
Validation loss decreased (-0.622209 --> -0.649987).  Saving model ...
Epoch: 9 cost time: 1.8542656898498535
Epoch: 9, Steps: 12 | Train Loss: 1.251 Vali Loss: 1.210 Vali Acc: 0.628 Test Loss: 1.210 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6590476036071777
Epoch: 10, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.144 Vali Acc: 0.622 Test Loss: 1.144 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9231672286987305
Epoch: 11, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.086 Vali Acc: 0.639 Test Loss: 1.086 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7418184280395508
Epoch: 12, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.030 Vali Acc: 0.639 Test Loss: 1.030 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.757370948791504
Epoch: 13, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.978 Vali Acc: 0.644 Test Loss: 0.978 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8057060241699219
Epoch: 14, Steps: 12 | Train Loss: 0.910 Vali Loss: 0.931 Vali Acc: 0.661 Test Loss: 0.931 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661102).  Saving model ...
Epoch: 15 cost time: 1.687774896621704
Epoch: 15, Steps: 12 | Train Loss: 0.834 Vali Loss: 0.885 Vali Acc: 0.656 Test Loss: 0.885 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9578804969787598
Epoch: 16, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.847 Vali Acc: 0.656 Test Loss: 0.847 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.774857997894287
Epoch: 17, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.816 Vali Acc: 0.661 Test Loss: 0.816 Test Acc: 0.661
Validation loss decreased (-0.661102 --> -0.661103).  Saving model ...
Epoch: 18 cost time: 1.8298707008361816
Epoch: 18, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.789 Vali Acc: 0.672 Test Loss: 0.789 Test Acc: 0.672
Validation loss decreased (-0.661103 --> -0.672214).  Saving model ...
Epoch: 19 cost time: 1.7993457317352295
Epoch: 19, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.767 Vali Acc: 0.672 Test Loss: 0.767 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672215).  Saving model ...
Epoch: 20 cost time: 1.5881602764129639
Epoch: 20, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.742 Vali Acc: 0.667 Test Loss: 0.742 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7848749160766602
Epoch: 21, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.726 Vali Acc: 0.689 Test Loss: 0.726 Test Acc: 0.689
Validation loss decreased (-0.672215 --> -0.688882).  Saving model ...
Epoch: 22 cost time: 1.608499526977539
Epoch: 22, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.700 Vali Acc: 0.756 Test Loss: 0.700 Test Acc: 0.756
Validation loss decreased (-0.688882 --> -0.755549).  Saving model ...
Epoch: 23 cost time: 2.0354673862457275
Epoch: 23, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.672 Vali Acc: 0.756 Test Loss: 0.672 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 24 cost time: 2.088874340057373
Epoch: 24, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.649 Vali Acc: 0.744 Test Loss: 0.649 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1141135692596436
Epoch: 25, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 26 cost time: 2.2993595600128174
Epoch: 26, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.592 Vali Acc: 0.778 Test Loss: 0.592 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777772).  Saving model ...
Epoch: 27 cost time: 2.0343868732452393
Epoch: 27, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.518 Vali Acc: 0.767 Test Loss: 0.518 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1184091567993164
Epoch: 28, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.481 Vali Acc: 0.800 Test Loss: 0.481 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799995).  Saving model ...
Epoch: 29 cost time: 2.1563737392425537
Epoch: 29, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.470 Vali Acc: 0.750 Test Loss: 0.470 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.024778366088867
Epoch: 30, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.458 Vali Acc: 0.767 Test Loss: 0.458 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 223158
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4708914756774902
Epoch: 1, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.800 Vali Acc: 0.211 Test Loss: 1.800 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.839329481124878
Epoch: 2, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.760 Vali Acc: 0.222 Test Loss: 1.760 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 1.7847368717193604
Epoch: 3, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.708 Vali Acc: 0.278 Test Loss: 1.708 Test Acc: 0.278
Validation loss decreased (-0.222205 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 1.8900220394134521
Epoch: 4, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.643 Vali Acc: 0.356 Test Loss: 1.643 Test Acc: 0.356
Validation loss decreased (-0.277761 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 1.9832096099853516
Epoch: 5, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.572 Vali Acc: 0.478 Test Loss: 1.572 Test Acc: 0.478
Validation loss decreased (-0.355539 --> -0.477762).  Saving model ...
Epoch: 6 cost time: 1.6984827518463135
Epoch: 6, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.494 Vali Acc: 0.578 Test Loss: 1.494 Test Acc: 0.578
Validation loss decreased (-0.477762 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 2.023394823074341
Epoch: 7, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
Validation loss decreased (-0.577763 --> -0.649986).  Saving model ...
Epoch: 8 cost time: 1.7359774112701416
Epoch: 8, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.316 Vali Acc: 0.667 Test Loss: 1.316 Test Acc: 0.667
Validation loss decreased (-0.649986 --> -0.666654).  Saving model ...
Epoch: 9 cost time: 2.0378708839416504
Epoch: 9, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.220 Vali Acc: 0.700 Test Loss: 1.220 Test Acc: 0.700
Validation loss decreased (-0.666654 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 1.6876862049102783
Epoch: 10, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.125 Vali Acc: 0.733 Test Loss: 1.125 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 1.948240041732788
Epoch: 11, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.028 Vali Acc: 0.744 Test Loss: 1.028 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 1.8163108825683594
Epoch: 12, Steps: 12 | Train Loss: 0.955 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.744434 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.9377844333648682
Epoch: 13, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.869 Vali Acc: 0.756 Test Loss: 0.869 Test Acc: 0.756
Validation loss decreased (-0.749991 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.7904508113861084
Epoch: 14, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.808 Vali Acc: 0.756 Test Loss: 0.808 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 1.8948323726654053
Epoch: 15, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 1.7798819541931152
Epoch: 16, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.711 Vali Acc: 0.756 Test Loss: 0.711 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8718221187591553
Epoch: 17, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.666 Vali Acc: 0.761 Test Loss: 0.666 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 1.7248668670654297
Epoch: 18, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.626 Vali Acc: 0.778 Test Loss: 0.626 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777772).  Saving model ...
Epoch: 19 cost time: 1.6146266460418701
Epoch: 19, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.590 Vali Acc: 0.767 Test Loss: 0.590 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6558218002319336
Epoch: 20, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.549 Vali Acc: 0.772 Test Loss: 0.549 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7176241874694824
Epoch: 21, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 22 cost time: 1.6263926029205322
Epoch: 22, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783328).  Saving model ...
Epoch: 23 cost time: 1.6865856647491455
Epoch: 23, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.449 Vali Acc: 0.811 Test Loss: 0.449 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 24 cost time: 1.657045841217041
Epoch: 24, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.423 Vali Acc: 0.794 Test Loss: 0.423 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6785340309143066
Epoch: 25, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.410 Vali Acc: 0.811 Test Loss: 0.410 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 26 cost time: 2.148630380630493
Epoch: 26, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.399 Vali Acc: 0.800 Test Loss: 0.399 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0235884189605713
Epoch: 27, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.380 Vali Acc: 0.800 Test Loss: 0.380 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1721580028533936
Epoch: 28, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.373 Vali Acc: 0.800 Test Loss: 0.373 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.928623914718628
Epoch: 29, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.371 Vali Acc: 0.789 Test Loss: 0.371 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7750601768493652
Epoch: 30, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 67878
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4858484268188477
Epoch: 1, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.702 Vali Acc: 0.228 Test Loss: 1.702 Test Acc: 0.228
Validation loss decreased (inf --> -0.227761).  Saving model ...
Epoch: 2 cost time: 1.7812151908874512
Epoch: 2, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.661 Vali Acc: 0.261 Test Loss: 1.661 Test Acc: 0.261
Validation loss decreased (-0.227761 --> -0.261095).  Saving model ...
Epoch: 3 cost time: 1.9378173351287842
Epoch: 3, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.607 Vali Acc: 0.372 Test Loss: 1.607 Test Acc: 0.372
Validation loss decreased (-0.261095 --> -0.372206).  Saving model ...
Epoch: 4 cost time: 1.767380952835083
Epoch: 4, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.548 Vali Acc: 0.456 Test Loss: 1.548 Test Acc: 0.456
Validation loss decreased (-0.372206 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.57999849319458
Epoch: 5, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.484 Vali Acc: 0.506 Test Loss: 1.484 Test Acc: 0.506
Validation loss decreased (-0.455540 --> -0.505541).  Saving model ...
Epoch: 6 cost time: 1.9183261394500732
Epoch: 6, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.416 Vali Acc: 0.583 Test Loss: 1.416 Test Acc: 0.583
Validation loss decreased (-0.505541 --> -0.583319).  Saving model ...
Epoch: 7 cost time: 1.704009771347046
Epoch: 7, Steps: 12 | Train Loss: 1.458 Vali Loss: 1.348 Vali Acc: 0.622 Test Loss: 1.348 Test Acc: 0.622
Validation loss decreased (-0.583319 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 1.9355063438415527
Epoch: 8, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.279 Vali Acc: 0.644 Test Loss: 1.279 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 1.9017972946166992
Epoch: 9, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.210 Vali Acc: 0.633 Test Loss: 1.210 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6615025997161865
Epoch: 10, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.144 Vali Acc: 0.628 Test Loss: 1.144 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9657304286956787
Epoch: 11, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.086 Vali Acc: 0.633 Test Loss: 1.086 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7285609245300293
Epoch: 12, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.029 Vali Acc: 0.633 Test Loss: 1.029 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7938427925109863
Epoch: 13, Steps: 12 | Train Loss: 0.955 Vali Loss: 0.977 Vali Acc: 0.644 Test Loss: 0.977 Test Acc: 0.644
Validation loss decreased (-0.644432 --> -0.644435).  Saving model ...
Epoch: 14 cost time: 1.936539649963379
Epoch: 14, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.929 Vali Acc: 0.661 Test Loss: 0.929 Test Acc: 0.661
Validation loss decreased (-0.644435 --> -0.661102).  Saving model ...
Epoch: 15 cost time: 1.8206348419189453
Epoch: 15, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.881 Vali Acc: 0.661 Test Loss: 0.881 Test Acc: 0.661
Validation loss decreased (-0.661102 --> -0.661102).  Saving model ...
Epoch: 16 cost time: 1.7073194980621338
Epoch: 16, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.839 Vali Acc: 0.667 Test Loss: 0.839 Test Acc: 0.667
Validation loss decreased (-0.661102 --> -0.666658).  Saving model ...
Epoch: 17 cost time: 1.94423508644104
Epoch: 17, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.802 Vali Acc: 0.678 Test Loss: 0.802 Test Acc: 0.678
Validation loss decreased (-0.666658 --> -0.677770).  Saving model ...
Epoch: 18 cost time: 1.6338772773742676
Epoch: 18, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.768 Vali Acc: 0.683 Test Loss: 0.768 Test Acc: 0.683
Validation loss decreased (-0.677770 --> -0.683326).  Saving model ...
Epoch: 19 cost time: 1.9048244953155518
Epoch: 19, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.729 Vali Acc: 0.689 Test Loss: 0.729 Test Acc: 0.689
Validation loss decreased (-0.683326 --> -0.688882).  Saving model ...
Epoch: 20 cost time: 1.8559012413024902
Epoch: 20, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.693 Vali Acc: 0.689 Test Loss: 0.693 Test Acc: 0.689
Validation loss decreased (-0.688882 --> -0.688882).  Saving model ...
Epoch: 21 cost time: 1.6805520057678223
Epoch: 21, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
Validation loss decreased (-0.688882 --> -0.716660).  Saving model ...
Epoch: 22 cost time: 1.913496494293213
Epoch: 22, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.620 Vali Acc: 0.767 Test Loss: 0.620 Test Acc: 0.767
Validation loss decreased (-0.716660 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 1.6265387535095215
Epoch: 23, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.583 Vali Acc: 0.761 Test Loss: 0.583 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.722632884979248
Epoch: 24, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.547 Vali Acc: 0.761 Test Loss: 0.547 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8731324672698975
Epoch: 25, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.515 Vali Acc: 0.794 Test Loss: 0.515 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794439).  Saving model ...
Epoch: 26 cost time: 1.7184498310089111
Epoch: 26, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.496 Vali Acc: 0.806 Test Loss: 0.496 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805551).  Saving model ...
Epoch: 27 cost time: 1.4772896766662598
Epoch: 27, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.469 Vali Acc: 0.789 Test Loss: 0.469 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8473539352416992
Epoch: 28, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.449 Vali Acc: 0.806 Test Loss: 0.449 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805551).  Saving model ...
Epoch: 29 cost time: 1.6466326713562012
Epoch: 29, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.438 Vali Acc: 0.783 Test Loss: 0.438 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.891141414642334
Epoch: 30, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.422 Vali Acc: 0.789 Test Loss: 0.422 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 223158
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1381967067718506
Epoch: 1, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.799 Vali Acc: 0.217 Test Loss: 1.799 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 1.788773775100708
Epoch: 2, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.760 Vali Acc: 0.222 Test Loss: 1.760 Test Acc: 0.222
Validation loss decreased (-0.216649 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 1.7319254875183105
Epoch: 3, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.707 Vali Acc: 0.283 Test Loss: 1.707 Test Acc: 0.283
Validation loss decreased (-0.222205 --> -0.283316).  Saving model ...
Epoch: 4 cost time: 1.5917375087738037
Epoch: 4, Steps: 12 | Train Loss: 1.727 Vali Loss: 1.642 Vali Acc: 0.361 Test Loss: 1.642 Test Acc: 0.361
Validation loss decreased (-0.283316 --> -0.361095).  Saving model ...
Epoch: 5 cost time: 1.7095363140106201
Epoch: 5, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.572 Vali Acc: 0.483 Test Loss: 1.572 Test Acc: 0.483
Validation loss decreased (-0.361095 --> -0.483318).  Saving model ...
Epoch: 6 cost time: 1.519474983215332
Epoch: 6, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.493 Vali Acc: 0.578 Test Loss: 1.493 Test Acc: 0.578
Validation loss decreased (-0.483318 --> -0.577763).  Saving model ...
Epoch: 7 cost time: 1.4718255996704102
Epoch: 7, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.409 Vali Acc: 0.650 Test Loss: 1.409 Test Acc: 0.650
Validation loss decreased (-0.577763 --> -0.649986).  Saving model ...
Epoch: 8 cost time: 1.7186033725738525
Epoch: 8, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.316 Vali Acc: 0.672 Test Loss: 1.316 Test Acc: 0.672
Validation loss decreased (-0.649986 --> -0.672209).  Saving model ...
Epoch: 9 cost time: 1.5248980522155762
Epoch: 9, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.220 Vali Acc: 0.700 Test Loss: 1.220 Test Acc: 0.700
Validation loss decreased (-0.672209 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 1.6724238395690918
Epoch: 10, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.126 Vali Acc: 0.733 Test Loss: 1.126 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733322).  Saving model ...
Epoch: 11 cost time: 1.7463343143463135
Epoch: 11, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.029 Vali Acc: 0.744 Test Loss: 1.029 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 1.54062819480896
Epoch: 12, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.944 Vali Acc: 0.739 Test Loss: 0.944 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7071592807769775
Epoch: 13, Steps: 12 | Train Loss: 0.909 Vali Loss: 0.872 Vali Acc: 0.756 Test Loss: 0.872 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.1143579483032227
Epoch: 14, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.812 Vali Acc: 0.756 Test Loss: 0.812 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 15 cost time: 1.6707510948181152
Epoch: 15, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.761 Vali Acc: 0.756 Test Loss: 0.761 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 16 cost time: 1.773223638534546
Epoch: 16, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.717 Vali Acc: 0.756 Test Loss: 0.717 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 17 cost time: 1.6652026176452637
Epoch: 17, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 1.5375781059265137
Epoch: 18, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.641 Vali Acc: 0.772 Test Loss: 0.641 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772216).  Saving model ...
Epoch: 19 cost time: 1.7898569107055664
Epoch: 19, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5447618961334229
Epoch: 20, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.582 Vali Acc: 0.756 Test Loss: 0.582 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7638766765594482
Epoch: 21, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.554 Vali Acc: 0.772 Test Loss: 0.554 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772217).  Saving model ...
Epoch: 22 cost time: 1.7638576030731201
Epoch: 22, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783328).  Saving model ...
Epoch: 23 cost time: 1.5945723056793213
Epoch: 23, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.514 Vali Acc: 0.772 Test Loss: 0.514 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7041778564453125
Epoch: 24, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.483 Vali Acc: 0.783 Test Loss: 0.483 Test Acc: 0.783
Validation loss decreased (-0.783328 --> -0.783329).  Saving model ...
Epoch: 25 cost time: 1.3961353302001953
Epoch: 25, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.471 Vali Acc: 0.761 Test Loss: 0.471 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3737235069274902
Epoch: 26, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.460 Vali Acc: 0.761 Test Loss: 0.460 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4208168983459473
Epoch: 27, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.432 Vali Acc: 0.778 Test Loss: 0.432 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3692984580993652
Epoch: 28, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.423 Vali Acc: 0.778 Test Loss: 0.423 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3804550170898438
Epoch: 29, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.415 Vali Acc: 0.789 Test Loss: 0.415 Test Acc: 0.789
Validation loss decreased (-0.783329 --> -0.788885).  Saving model ...
Epoch: 30 cost time: 1.4038281440734863
Epoch: 30, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.405 Vali Acc: 0.783 Test Loss: 0.405 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 67878
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 13.696539878845215
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.519 Vali Acc: 0.439 Test Loss: 1.519 Test Acc: 0.439
Validation loss decreased (inf --> -0.438874).  Saving model ...
Epoch: 2 cost time: 12.318391799926758
Epoch: 2, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.032 Vali Acc: 0.683 Test Loss: 1.032 Test Acc: 0.683
Validation loss decreased (-0.438874 --> -0.683323).  Saving model ...
Epoch: 3 cost time: 12.374610662460327
Epoch: 3, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.691 Vali Acc: 0.700 Test Loss: 0.691 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 12.1126868724823
Epoch: 4, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.516 Vali Acc: 0.778 Test Loss: 0.516 Test Acc: 0.778
Validation loss decreased (-0.699993 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 12.376165866851807
Epoch: 5, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
Validation loss decreased (-0.777773 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 12.098140716552734
Epoch: 6, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.403 Vali Acc: 0.839 Test Loss: 0.403 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 11.818754434585571
Epoch: 7, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.337 Vali Acc: 0.839 Test Loss: 0.337 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 8 cost time: 12.046626806259155
Epoch: 8, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.838886 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 11.647212266921997
Epoch: 9, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.255 Vali Acc: 0.861 Test Loss: 0.255 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.94382619857788
Epoch: 10, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.216 Vali Acc: 0.894 Test Loss: 0.216 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 10.632515907287598
Epoch: 11, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.259 Vali Acc: 0.883 Test Loss: 0.259 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.238100051879883
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 11.83235478401184
Epoch: 13, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.8021559715271
Epoch: 14, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 11.563077688217163
Epoch: 15, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.455997943878174
Epoch: 16, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.911108 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 11.955901622772217
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.468 Vali Acc: 0.906 Test Loss: 0.468 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.820337295532227
Epoch: 18, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.323 Vali Acc: 0.922 Test Loss: 0.323 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.086991786956787
Epoch: 19, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.374 Vali Acc: 0.911 Test Loss: 0.374 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.050535440444946
Epoch: 20, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.009721040725708
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.324 Vali Acc: 0.928 Test Loss: 0.324 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.173691511154175
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 12.28827452659607
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.898695230484009
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 10.102371215820312
Epoch: 25, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 10.8809494972229
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 11.03529667854309
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.522 Vali Acc: 0.922 Test Loss: 0.522 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.05432415008545
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.922 Test Loss: 0.405 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 11.130787134170532
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.395 Vali Acc: 0.928 Test Loss: 0.395 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 11.022369623184204
Epoch: 30, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.631 Vali Acc: 0.928 Test Loss: 0.631 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 37540358
model size : 145.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.703362226486206
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.585 Vali Acc: 0.422 Test Loss: 1.585 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 3.73234224319458
Epoch: 2, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.070 Vali Acc: 0.694 Test Loss: 1.070 Test Acc: 0.694
Validation loss decreased (-0.422206 --> -0.694434).  Saving model ...
Epoch: 3 cost time: 4.01525616645813
Epoch: 3, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.689 Vali Acc: 0.744 Test Loss: 0.689 Test Acc: 0.744
Validation loss decreased (-0.694434 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 3.981813907623291
Epoch: 4, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.500 Vali Acc: 0.806 Test Loss: 0.500 Test Acc: 0.806
Validation loss decreased (-0.744438 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 3.8381240367889404
Epoch: 5, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7586023807525635
Epoch: 6, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 3.8977038860321045
Epoch: 7, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.330 Vali Acc: 0.817 Test Loss: 0.330 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6350257396698
Epoch: 8, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 3.6419715881347656
Epoch: 9, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 3.6113617420196533
Epoch: 10, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.2692437171936035
Epoch: 11, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 4.062479734420776
Epoch: 12, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.883331 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 2.622957229614258
Epoch: 13, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
Validation loss decreased (-0.916665 --> -0.966666).  Saving model ...
Epoch: 14 cost time: 2.611440658569336
Epoch: 14, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.341074705123901
Epoch: 15, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.162 Vali Acc: 0.933 Test Loss: 0.162 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.00325083732605
Epoch: 16, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9467852115631104
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.290737152099609
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.023082494735718
Epoch: 19, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8758115768432617
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.153823137283325
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.080995798110962
Epoch: 22, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.00898814201355
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9666666666666667
model parameter : 11062278
model size : 44.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 11.07389521598816
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.519 Vali Acc: 0.439 Test Loss: 1.519 Test Acc: 0.439
Validation loss decreased (inf --> -0.438874).  Saving model ...
Epoch: 2 cost time: 9.05191969871521
Epoch: 2, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.032 Vali Acc: 0.683 Test Loss: 1.032 Test Acc: 0.683
Validation loss decreased (-0.438874 --> -0.683323).  Saving model ...
Epoch: 3 cost time: 8.897061109542847
Epoch: 3, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.691 Vali Acc: 0.700 Test Loss: 0.691 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699993).  Saving model ...
Epoch: 4 cost time: 9.204676628112793
Epoch: 4, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.516 Vali Acc: 0.778 Test Loss: 0.516 Test Acc: 0.778
Validation loss decreased (-0.699993 --> -0.777773).  Saving model ...
Epoch: 5 cost time: 8.82060694694519
Epoch: 5, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
Validation loss decreased (-0.777773 --> -0.827774).  Saving model ...
Epoch: 6 cost time: 9.35180401802063
Epoch: 6, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.403 Vali Acc: 0.839 Test Loss: 0.403 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 7.722166299819946
Epoch: 7, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.338 Vali Acc: 0.839 Test Loss: 0.338 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
Epoch: 8 cost time: 7.141258478164673
Epoch: 8, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
Validation loss decreased (-0.838886 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 6.982601165771484
Epoch: 9, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.255 Vali Acc: 0.861 Test Loss: 0.255 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.02348780632019
Epoch: 10, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.218 Vali Acc: 0.894 Test Loss: 0.218 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 8.195011138916016
Epoch: 11, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.03998851776123
Epoch: 12, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 7.9385881423950195
Epoch: 13, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.899996 --> -0.922220).  Saving model ...
Epoch: 14 cost time: 7.8338236808776855
Epoch: 14, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.349 Vali Acc: 0.928 Test Loss: 0.349 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927774).  Saving model ...
Epoch: 15 cost time: 8.134607791900635
Epoch: 15, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.191 Vali Acc: 0.917 Test Loss: 0.191 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.014381647109985
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.435 Vali Acc: 0.856 Test Loss: 0.435 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.129278659820557
Epoch: 17, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (-0.927774 --> -0.927775).  Saving model ...
Epoch: 18 cost time: 7.850630044937134
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.315 Vali Acc: 0.928 Test Loss: 0.315 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.777845859527588
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.394 Vali Acc: 0.917 Test Loss: 0.394 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.350495338439941
Epoch: 20, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.339 Vali Acc: 0.917 Test Loss: 0.339 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.457020282745361
Epoch: 21, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.78941535949707
Epoch: 22, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.272 Vali Acc: 0.939 Test Loss: 0.272 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938886).  Saving model ...
Epoch: 23 cost time: 7.524610757827759
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.297 Vali Acc: 0.933 Test Loss: 0.297 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.700378179550171
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.928 Test Loss: 0.419 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 8.343366861343384
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.456488132476807
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.535483837127686
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.484 Vali Acc: 0.911 Test Loss: 0.484 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 8.709385633468628
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.938886 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 8.639151334762573
Epoch: 29, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 8.531523704528809
Epoch: 30, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.652 Vali Acc: 0.878 Test Loss: 0.652 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 37540358
model size : 145.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.5727925300598145
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.585 Vali Acc: 0.422 Test Loss: 1.585 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 2.9255752563476562
Epoch: 2, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.070 Vali Acc: 0.694 Test Loss: 1.070 Test Acc: 0.694
Validation loss decreased (-0.422206 --> -0.694434).  Saving model ...
Epoch: 3 cost time: 3.0282204151153564
Epoch: 3, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.689 Vali Acc: 0.744 Test Loss: 0.689 Test Acc: 0.744
Validation loss decreased (-0.694434 --> -0.744438).  Saving model ...
Epoch: 4 cost time: 3.307072639465332
Epoch: 4, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.500 Vali Acc: 0.806 Test Loss: 0.500 Test Acc: 0.806
Validation loss decreased (-0.744438 --> -0.805551).  Saving model ...
Epoch: 5 cost time: 3.0754666328430176
Epoch: 5, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.396 Vali Acc: 0.800 Test Loss: 0.396 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8613712787628174
Epoch: 6, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.355 Vali Acc: 0.839 Test Loss: 0.355 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 7 cost time: 3.2357611656188965
Epoch: 7, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.330 Vali Acc: 0.817 Test Loss: 0.330 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.729491710662842
Epoch: 8, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849997).  Saving model ...
Epoch: 9 cost time: 2.6086769104003906
Epoch: 9, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.307 Vali Acc: 0.872 Test Loss: 0.307 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 2.523402452468872
Epoch: 10, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5309598445892334
Epoch: 11, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.267 Vali Acc: 0.883 Test Loss: 0.267 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883331).  Saving model ...
Epoch: 12 cost time: 2.790555000305176
Epoch: 12, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.189 Vali Acc: 0.917 Test Loss: 0.189 Test Acc: 0.917
Validation loss decreased (-0.883331 --> -0.916665).  Saving model ...
Epoch: 13 cost time: 2.8686935901641846
Epoch: 13, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
Validation loss decreased (-0.916665 --> -0.966666).  Saving model ...
Epoch: 14 cost time: 2.8248488903045654
Epoch: 14, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7489538192749023
Epoch: 15, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.161 Vali Acc: 0.933 Test Loss: 0.161 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7486040592193604
Epoch: 16, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.823529005050659
Epoch: 17, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8991687297821045
Epoch: 18, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.9481863975524902
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1335246562957764
Epoch: 20, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0727763175964355
Epoch: 21, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.0714550018310547
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.944 Test Loss: 0.146 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.891627550125122
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9666666666666667
model parameter : 11062278
model size : 44.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.234886884689331
Epoch: 1, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.520 Vali Acc: 0.439 Test Loss: 1.520 Test Acc: 0.439
Validation loss decreased (inf --> -0.438874).  Saving model ...
Epoch: 2 cost time: 4.500129461288452
Epoch: 2, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.037 Vali Acc: 0.683 Test Loss: 1.037 Test Acc: 0.683
Validation loss decreased (-0.438874 --> -0.683323).  Saving model ...
Epoch: 3 cost time: 4.893385410308838
Epoch: 3, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.700 Vali Acc: 0.694 Test Loss: 0.700 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694437).  Saving model ...
Epoch: 4 cost time: 4.840223550796509
Epoch: 4, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.528 Vali Acc: 0.772 Test Loss: 0.528 Test Acc: 0.772
Validation loss decreased (-0.694437 --> -0.772217).  Saving model ...
Epoch: 5 cost time: 4.660152435302734
Epoch: 5, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
Validation loss decreased (-0.772217 --> -0.816662).  Saving model ...
Epoch: 6 cost time: 4.7172791957855225
Epoch: 6, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.414 Vali Acc: 0.828 Test Loss: 0.414 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 4.374906063079834
Epoch: 7, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 4.189414024353027
Epoch: 8, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866664).  Saving model ...
Epoch: 9 cost time: 5.012771129608154
Epoch: 9, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.268 Vali Acc: 0.856 Test Loss: 0.268 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.946275472640991
Epoch: 10, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.236 Vali Acc: 0.883 Test Loss: 0.236 Test Acc: 0.883
Validation loss decreased (-0.866664 --> -0.883331).  Saving model ...
Epoch: 11 cost time: 4.669243097305298
Epoch: 11, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.356 Vali Acc: 0.872 Test Loss: 0.356 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.614066123962402
Epoch: 12, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905552).  Saving model ...
Epoch: 13 cost time: 4.792190790176392
Epoch: 13, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
Validation loss decreased (-0.905552 --> -0.927775).  Saving model ...
Epoch: 14 cost time: 4.529065370559692
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.316 Vali Acc: 0.917 Test Loss: 0.316 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.346829175949097
Epoch: 15, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.524 Vali Acc: 0.872 Test Loss: 0.524 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.548918962478638
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.483024597167969
Epoch: 17, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.788973331451416
Epoch: 18, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.225259065628052
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.180 Vali Acc: 0.928 Test Loss: 0.180 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 20 cost time: 4.490657567977905
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.536789178848267
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.539494037628174
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 4.108206272125244
Epoch: 23, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.397 Vali Acc: 0.917 Test Loss: 0.397 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.478597402572632
Epoch: 24, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.499 Vali Acc: 0.917 Test Loss: 0.499 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.423702955245972
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.443 Vali Acc: 0.928 Test Loss: 0.443 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.091783046722412
Epoch: 26, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.647 Vali Acc: 0.911 Test Loss: 0.647 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.9208009243011475
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.458 Vali Acc: 0.922 Test Loss: 0.458 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.39083456993103
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.454 Vali Acc: 0.928 Test Loss: 0.454 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.2501232624053955
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.471 Vali Acc: 0.917 Test Loss: 0.471 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.444095134735107
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.911 Test Loss: 0.608 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 37540358
model size : 145.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.318756580352783
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.592 Vali Acc: 0.406 Test Loss: 1.592 Test Acc: 0.406
Validation loss decreased (inf --> -0.405540).  Saving model ...
Epoch: 2 cost time: 1.8206760883331299
Epoch: 2, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.095 Vali Acc: 0.683 Test Loss: 1.095 Test Acc: 0.683
Validation loss decreased (-0.405540 --> -0.683322).  Saving model ...
Epoch: 3 cost time: 1.9163947105407715
Epoch: 3, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.715 Vali Acc: 0.728 Test Loss: 0.715 Test Acc: 0.728
Validation loss decreased (-0.683322 --> -0.727771).  Saving model ...
Epoch: 4 cost time: 1.9352169036865234
Epoch: 4, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.521 Vali Acc: 0.794 Test Loss: 0.521 Test Acc: 0.794
Validation loss decreased (-0.727771 --> -0.794439).  Saving model ...
Epoch: 5 cost time: 1.9799885749816895
Epoch: 5, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.423 Vali Acc: 0.794 Test Loss: 0.423 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794440).  Saving model ...
Epoch: 6 cost time: 2.139960527420044
Epoch: 6, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.380 Vali Acc: 0.828 Test Loss: 0.380 Test Acc: 0.828
Validation loss decreased (-0.794440 --> -0.827774).  Saving model ...
Epoch: 7 cost time: 2.1696057319641113
Epoch: 7, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.342 Vali Acc: 0.811 Test Loss: 0.342 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9369866847991943
Epoch: 8, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.333 Vali Acc: 0.856 Test Loss: 0.333 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 1.9250414371490479
Epoch: 9, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.323 Vali Acc: 0.872 Test Loss: 0.323 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 1.9604897499084473
Epoch: 10, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.284 Vali Acc: 0.867 Test Loss: 0.284 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0767688751220703
Epoch: 11, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0809733867645264
Epoch: 12, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.203 Vali Acc: 0.906 Test Loss: 0.203 Test Acc: 0.906
Validation loss decreased (-0.872219 --> -0.905554).  Saving model ...
Epoch: 13 cost time: 1.9777562618255615
Epoch: 13, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.117 Vali Acc: 0.950 Test Loss: 0.117 Test Acc: 0.950
Validation loss decreased (-0.905554 --> -0.949999).  Saving model ...
Epoch: 14 cost time: 1.9740629196166992
Epoch: 14, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.345 Vali Acc: 0.906 Test Loss: 0.345 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9037399291992188
Epoch: 15, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.094111919403076
Epoch: 16, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0371735095977783
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.228 Vali Acc: 0.917 Test Loss: 0.228 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9423742294311523
Epoch: 18, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.956 Test Loss: 0.106 Test Acc: 0.956
Validation loss decreased (-0.949999 --> -0.955554).  Saving model ...
Epoch: 19 cost time: 1.9806220531463623
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.979905605316162
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.939 Test Loss: 0.260 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9162795543670654
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.329 Vali Acc: 0.928 Test Loss: 0.329 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.978339672088623
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8302245140075684
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.378 Vali Acc: 0.883 Test Loss: 0.378 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8361916542053223
Epoch: 24, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.925813913345337
Epoch: 25, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.956 Test Loss: 0.125 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2488059997558594
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
Validation loss decreased (-0.955554 --> -0.961110).  Saving model ...
Epoch: 27 cost time: 2.0302135944366455
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1025118827819824
Epoch: 28, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1553454399108887
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.069486379623413
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 11062278
model size : 44.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.512464761734009
Epoch: 1, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.693 Vali Acc: 0.306 Test Loss: 1.693 Test Acc: 0.306
Validation loss decreased (inf --> -0.305539).  Saving model ...
Epoch: 2 cost time: 6.3436126708984375
Epoch: 2, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.136 Vali Acc: 0.656 Test Loss: 1.136 Test Acc: 0.656
Validation loss decreased (-0.305539 --> -0.655544).  Saving model ...
Epoch: 3 cost time: 6.4422972202301025
Epoch: 3, Steps: 12 | Train Loss: 0.913 Vali Loss: 0.704 Vali Acc: 0.756 Test Loss: 0.704 Test Acc: 0.756
Validation loss decreased (-0.655544 --> -0.755549).  Saving model ...
Epoch: 4 cost time: 6.172735929489136
Epoch: 4, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 6.497490406036377
Epoch: 5, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.447 Vali Acc: 0.789 Test Loss: 0.447 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 6.0194151401519775
Epoch: 6, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.428 Vali Acc: 0.817 Test Loss: 0.428 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 6.029937982559204
Epoch: 7, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.0952982902526855
Epoch: 8, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.751804351806641
Epoch: 9, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 5.772911787033081
Epoch: 10, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 6.545238018035889
Epoch: 11, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 6.069960117340088
Epoch: 12, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 6.223630666732788
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.069539785385132
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 6.525254726409912
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.172 Vali Acc: 0.911 Test Loss: 0.172 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 6.220950603485107
Epoch: 16, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.412 Vali Acc: 0.883 Test Loss: 0.412 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.539351224899292
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 6.092242240905762
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.143 Vali Acc: 0.944 Test Loss: 0.143 Test Acc: 0.944
Validation loss decreased (-0.922220 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 6.556485414505005
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.158 Vali Acc: 0.928 Test Loss: 0.158 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.701128244400024
Epoch: 20, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 6.431475400924683
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.271225452423096
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.335 Vali Acc: 0.917 Test Loss: 0.335 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.432446002960205
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.350667238235474
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.917 Test Loss: 0.179 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.706902742385864
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.62157416343689
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.635854482650757
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.307 Vali Acc: 0.928 Test Loss: 0.307 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.606260538101196
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.581127882003784
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.939 Test Loss: 0.275 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.2786970138549805
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 18795526
model size : 74.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.188113689422607
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.606 Vali Acc: 0.422 Test Loss: 1.606 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 2.30184268951416
Epoch: 2, Steps: 12 | Train Loss: 1.417 Vali Loss: 1.172 Vali Acc: 0.661 Test Loss: 1.172 Test Acc: 0.661
Validation loss decreased (-0.422206 --> -0.661099).  Saving model ...
Epoch: 3 cost time: 2.6263866424560547
Epoch: 3, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
Validation loss decreased (-0.661099 --> -0.733325).  Saving model ...
Epoch: 4 cost time: 2.8209309577941895
Epoch: 4, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
Validation loss decreased (-0.733325 --> -0.788883).  Saving model ...
Epoch: 5 cost time: 2.5505266189575195
Epoch: 5, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.451 Vali Acc: 0.806 Test Loss: 0.451 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.4883410930633545
Epoch: 6, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
Validation loss decreased (-0.805551 --> -0.866663).  Saving model ...
Epoch: 7 cost time: 2.4955499172210693
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.884995698928833
Epoch: 8, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 2.6921942234039307
Epoch: 9, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.475177526473999
Epoch: 10, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4576287269592285
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.5663387775421143
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.273 Vali Acc: 0.883 Test Loss: 0.273 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7862348556518555
Epoch: 13, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.397 Vali Acc: 0.883 Test Loss: 0.397 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.577150583267212
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.158 Vali Acc: 0.928 Test Loss: 0.158 Test Acc: 0.928
Validation loss decreased (-0.888886 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 2.278365135192871
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.588846206665039
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7224044799804688
Epoch: 17, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.394014835357666
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 19 cost time: 2.2533295154571533
Epoch: 19, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.325 Vali Acc: 0.928 Test Loss: 0.325 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.506131410598755
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.723479747772217
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.328430414199829
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.321349620819092
Epoch: 23, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5542564392089844
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.556 Vali Acc: 0.911 Test Loss: 0.556 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.714104652404785
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 2.499417543411255
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.527 Vali Acc: 0.928 Test Loss: 0.527 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.392310380935669
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.434629440307617
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.346 Vali Acc: 0.939 Test Loss: 0.346 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.798617124557495
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.939 Test Loss: 0.278 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4980454444885254
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 5556230
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.537710189819336
Epoch: 1, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.693 Vali Acc: 0.306 Test Loss: 1.693 Test Acc: 0.306
Validation loss decreased (inf --> -0.305539).  Saving model ...
Epoch: 2 cost time: 4.556578636169434
Epoch: 2, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.136 Vali Acc: 0.656 Test Loss: 1.136 Test Acc: 0.656
Validation loss decreased (-0.305539 --> -0.655544).  Saving model ...
Epoch: 3 cost time: 4.1289567947387695
Epoch: 3, Steps: 12 | Train Loss: 0.913 Vali Loss: 0.704 Vali Acc: 0.756 Test Loss: 0.704 Test Acc: 0.756
Validation loss decreased (-0.655544 --> -0.755549).  Saving model ...
Epoch: 4 cost time: 4.883793592453003
Epoch: 4, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788884).  Saving model ...
Epoch: 5 cost time: 4.4581568241119385
Epoch: 5, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.447 Vali Acc: 0.789 Test Loss: 0.447 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 6 cost time: 5.0677008628845215
Epoch: 6, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.428 Vali Acc: 0.817 Test Loss: 0.428 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 7 cost time: 4.649968147277832
Epoch: 7, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.355 Vali Acc: 0.806 Test Loss: 0.355 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.891988039016724
Epoch: 8, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.381 Vali Acc: 0.806 Test Loss: 0.381 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.775448322296143
Epoch: 9, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 4.725234508514404
Epoch: 10, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.357 Vali Acc: 0.839 Test Loss: 0.357 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 4.900331020355225
Epoch: 11, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.326 Vali Acc: 0.856 Test Loss: 0.326 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 4.672882080078125
Epoch: 12, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 4.7573466300964355
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.47638726234436
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.204 Vali Acc: 0.900 Test Loss: 0.204 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 4.901978969573975
Epoch: 15, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.173 Vali Acc: 0.911 Test Loss: 0.173 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 4.7880494594573975
Epoch: 16, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.413 Vali Acc: 0.883 Test Loss: 0.413 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.48712944984436
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 4.569592475891113
Epoch: 18, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.143 Vali Acc: 0.944 Test Loss: 0.143 Test Acc: 0.944
Validation loss decreased (-0.922220 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 4.1016552448272705
Epoch: 19, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.158 Vali Acc: 0.928 Test Loss: 0.158 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.1296446323394775
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 4.540715456008911
Epoch: 21, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.323268890380859
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.649510383605957
Epoch: 23, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.280 Vali Acc: 0.906 Test Loss: 0.280 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.474172830581665
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.906 Test Loss: 0.240 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.459313154220581
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.668781518936157
Epoch: 26, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.363 Vali Acc: 0.922 Test Loss: 0.363 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.501168489456177
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.60358738899231
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.933 Test Loss: 0.127 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.428184509277344
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.939 Test Loss: 0.136 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.647083759307861
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 18795526
model size : 74.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4762256145477295
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.606 Vali Acc: 0.422 Test Loss: 1.606 Test Acc: 0.422
Validation loss decreased (inf --> -0.422206).  Saving model ...
Epoch: 2 cost time: 2.013535737991333
Epoch: 2, Steps: 12 | Train Loss: 1.417 Vali Loss: 1.172 Vali Acc: 0.661 Test Loss: 1.172 Test Acc: 0.661
Validation loss decreased (-0.422206 --> -0.661099).  Saving model ...
Epoch: 3 cost time: 1.7912518978118896
Epoch: 3, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
Validation loss decreased (-0.661099 --> -0.733325).  Saving model ...
Epoch: 4 cost time: 1.9160280227661133
Epoch: 4, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
Validation loss decreased (-0.733325 --> -0.788883).  Saving model ...
Epoch: 5 cost time: 2.218139886856079
Epoch: 5, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.451 Vali Acc: 0.806 Test Loss: 0.451 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805551).  Saving model ...
Epoch: 6 cost time: 2.0527570247650146
Epoch: 6, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
Validation loss decreased (-0.805551 --> -0.866663).  Saving model ...
Epoch: 7 cost time: 2.059096097946167
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.075922966003418
Epoch: 8, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.279 Vali Acc: 0.878 Test Loss: 0.279 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 9 cost time: 2.2075467109680176
Epoch: 9, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.265 Vali Acc: 0.861 Test Loss: 0.265 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3349177837371826
Epoch: 10, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1270339488983154
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 2.095460891723633
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.274 Vali Acc: 0.883 Test Loss: 0.274 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.911604881286621
Epoch: 13, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.398 Vali Acc: 0.883 Test Loss: 0.398 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0256450176239014
Epoch: 14, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.158 Vali Acc: 0.928 Test Loss: 0.158 Test Acc: 0.928
Validation loss decreased (-0.888886 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 1.890843391418457
Epoch: 15, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8123326301574707
Epoch: 16, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9470257759094238
Epoch: 17, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.068358898162842
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 19 cost time: 2.125932455062866
Epoch: 19, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.324 Vali Acc: 0.928 Test Loss: 0.324 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1010429859161377
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1607120037078857
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1243975162506104
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.314 Vali Acc: 0.928 Test Loss: 0.314 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.2200071811676025
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1852915287017822
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.922 Test Loss: 0.468 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1608452796936035
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1528682708740234
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.454 Vali Acc: 0.933 Test Loss: 0.454 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2002475261688232
Epoch: 27, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.451 Vali Acc: 0.922 Test Loss: 0.451 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8909318447113037
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.568 Vali Acc: 0.911 Test Loss: 0.568 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 5556230
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.514011383056641
Epoch: 1, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.694 Vali Acc: 0.300 Test Loss: 1.694 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 2.9611880779266357
Epoch: 2, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.145 Vali Acc: 0.644 Test Loss: 1.145 Test Acc: 0.644
Validation loss decreased (-0.299983 --> -0.644433).  Saving model ...
Epoch: 3 cost time: 2.9497950077056885
Epoch: 3, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.718 Vali Acc: 0.744 Test Loss: 0.718 Test Acc: 0.744
Validation loss decreased (-0.644433 --> -0.744437).  Saving model ...
Epoch: 4 cost time: 2.868112325668335
Epoch: 4, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.528 Vali Acc: 0.778 Test Loss: 0.528 Test Acc: 0.778
Validation loss decreased (-0.744437 --> -0.777772).  Saving model ...
Epoch: 5 cost time: 3.0114357471466064
Epoch: 5, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.462 Vali Acc: 0.778 Test Loss: 0.462 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 6 cost time: 2.7291483879089355
Epoch: 6, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.447 Vali Acc: 0.811 Test Loss: 0.447 Test Acc: 0.811
Validation loss decreased (-0.777773 --> -0.811107).  Saving model ...
Epoch: 7 cost time: 2.756284713745117
Epoch: 7, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.366 Vali Acc: 0.806 Test Loss: 0.366 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.586813449859619
Epoch: 8, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.389 Vali Acc: 0.806 Test Loss: 0.389 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5521981716156006
Epoch: 9, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.348 Vali Acc: 0.822 Test Loss: 0.348 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822219).  Saving model ...
Epoch: 10 cost time: 2.6074531078338623
Epoch: 10, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.366 Vali Acc: 0.839 Test Loss: 0.366 Test Acc: 0.839
Validation loss decreased (-0.822219 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 3.2691733837127686
Epoch: 11, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.335 Vali Acc: 0.856 Test Loss: 0.335 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 3.0569040775299072
Epoch: 12, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.295 Vali Acc: 0.872 Test Loss: 0.295 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 2.9602038860321045
Epoch: 13, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.253390073776245
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.208 Vali Acc: 0.900 Test Loss: 0.208 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 3.1158604621887207
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.177 Vali Acc: 0.911 Test Loss: 0.177 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 2.954802989959717
Epoch: 16, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.415 Vali Acc: 0.878 Test Loss: 0.415 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.274024486541748
Epoch: 17, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 3.106825351715088
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.144 Vali Acc: 0.944 Test Loss: 0.144 Test Acc: 0.944
Validation loss decreased (-0.916665 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 3.0323755741119385
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1823689937591553
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 21 cost time: 3.2002346515655518
Epoch: 21, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0459446907043457
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2556421756744385
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.0574686527252197
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.163 Vali Acc: 0.922 Test Loss: 0.163 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.999302387237549
Epoch: 25, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.276517391204834
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.922090768814087
Epoch: 27, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.402 Vali Acc: 0.917 Test Loss: 0.402 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.201240062713623
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.018949508666992
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.142 Vali Acc: 0.944 Test Loss: 0.142 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.8901665210723877
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 18795526
model size : 74.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3002219200134277
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.608 Vali Acc: 0.417 Test Loss: 1.608 Test Acc: 0.417
Validation loss decreased (inf --> -0.416651).  Saving model ...
Epoch: 2 cost time: 1.5412166118621826
Epoch: 2, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.179 Vali Acc: 0.661 Test Loss: 1.179 Test Acc: 0.661
Validation loss decreased (-0.416651 --> -0.661099).  Saving model ...
Epoch: 3 cost time: 1.8310065269470215
Epoch: 3, Steps: 12 | Train Loss: 0.964 Vali Loss: 0.809 Vali Acc: 0.717 Test Loss: 0.809 Test Acc: 0.717
Validation loss decreased (-0.661099 --> -0.716659).  Saving model ...
Epoch: 4 cost time: 1.6873443126678467
Epoch: 4, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.589 Vali Acc: 0.772 Test Loss: 0.589 Test Acc: 0.772
Validation loss decreased (-0.716659 --> -0.772216).  Saving model ...
Epoch: 5 cost time: 1.8575210571289062
Epoch: 5, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.472 Vali Acc: 0.783 Test Loss: 0.472 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783329).  Saving model ...
Epoch: 6 cost time: 1.7211332321166992
Epoch: 6, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.377 Vali Acc: 0.856 Test Loss: 0.377 Test Acc: 0.856
Validation loss decreased (-0.783329 --> -0.855552).  Saving model ...
Epoch: 7 cost time: 1.7885923385620117
Epoch: 7, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7020773887634277
Epoch: 8, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 9 cost time: 1.7049965858459473
Epoch: 9, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.276 Vali Acc: 0.856 Test Loss: 0.276 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8570702075958252
Epoch: 10, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.293 Vali Acc: 0.872 Test Loss: 0.293 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 1.590257167816162
Epoch: 11, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.254 Vali Acc: 0.889 Test Loss: 0.254 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 12 cost time: 1.8070309162139893
Epoch: 12, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.285 Vali Acc: 0.883 Test Loss: 0.285 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.568504810333252
Epoch: 13, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.410 Vali Acc: 0.883 Test Loss: 0.410 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5787391662597656
Epoch: 14, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.165 Vali Acc: 0.928 Test Loss: 0.165 Test Acc: 0.928
Validation loss decreased (-0.888886 --> -0.927776).  Saving model ...
Epoch: 15 cost time: 1.7674224376678467
Epoch: 15, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5224697589874268
Epoch: 16, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7958323955535889
Epoch: 17, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5905449390411377
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.227 Vali Acc: 0.939 Test Loss: 0.227 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 19 cost time: 1.4682023525238037
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.330 Vali Acc: 0.928 Test Loss: 0.330 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7753009796142578
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.562194585800171
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.917 Test Loss: 0.318 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8004052639007568
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.327 Vali Acc: 0.939 Test Loss: 0.327 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.675459861755371
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 1.5314602851867676
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.420 Vali Acc: 0.922 Test Loss: 0.420 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7439658641815186
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.372 Vali Acc: 0.928 Test Loss: 0.372 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5973470211029053
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 1.8404643535614014
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.407 Vali Acc: 0.933 Test Loss: 0.407 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5577096939086914
Epoch: 28, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.473 Vali Acc: 0.922 Test Loss: 0.473 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7252452373504639
Epoch: 29, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5602917671203613
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.436 Vali Acc: 0.922 Test Loss: 0.436 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 5556230
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 9.155410051345825
Epoch: 1, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.692 Vali Acc: 0.311 Test Loss: 1.692 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 6.527461051940918
Epoch: 2, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.368 Vali Acc: 0.594 Test Loss: 1.368 Test Acc: 0.594
Validation loss decreased (-0.311094 --> -0.594431).  Saving model ...
Epoch: 3 cost time: 7.647582054138184
Epoch: 3, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.002 Vali Acc: 0.683 Test Loss: 1.002 Test Acc: 0.683
Validation loss decreased (-0.594431 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 7.175185203552246
Epoch: 4, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
Validation loss decreased (-0.683323 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 7.044094800949097
Epoch: 5, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.526 Vali Acc: 0.806 Test Loss: 0.526 Test Acc: 0.806
Validation loss decreased (-0.749993 --> -0.805550).  Saving model ...
Epoch: 6 cost time: 6.744659423828125
Epoch: 6, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.433 Vali Acc: 0.800 Test Loss: 0.433 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.076206922531128
Epoch: 7, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 7.134190320968628
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 6.891090154647827
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.220681190490723
Epoch: 10, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.331 Vali Acc: 0.822 Test Loss: 0.331 Test Acc: 0.822
Validation loss decreased (-0.822219 --> -0.822219).  Saving model ...
Epoch: 11 cost time: 6.706905364990234
Epoch: 11, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827775).  Saving model ...
Epoch: 12 cost time: 7.1237263679504395
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.326 Vali Acc: 0.839 Test Loss: 0.326 Test Acc: 0.839
Validation loss decreased (-0.827775 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 6.984195947647095
Epoch: 13, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.330 Vali Acc: 0.844 Test Loss: 0.330 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 6.646581411361694
Epoch: 14, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.370 Vali Acc: 0.828 Test Loss: 0.370 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.713211297988892
Epoch: 15, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.319 Vali Acc: 0.822 Test Loss: 0.319 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.556891441345215
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.291 Vali Acc: 0.850 Test Loss: 0.291 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 7.602307319641113
Epoch: 17, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.239 Vali Acc: 0.878 Test Loss: 0.239 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 18 cost time: 7.959696292877197
Epoch: 18, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.484192848205566
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 7.832430362701416
Epoch: 20, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 7.98114538192749
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.176 Vali Acc: 0.928 Test Loss: 0.176 Test Acc: 0.928
Validation loss decreased (-0.899996 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 7.718564510345459
Epoch: 22, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.797534227371216
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.814114570617676
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.304 Vali Acc: 0.928 Test Loss: 0.304 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.361278533935547
Epoch: 25, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.371 Vali Acc: 0.928 Test Loss: 0.371 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.7520835399627686
Epoch: 26, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.306666135787964
Epoch: 27, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.24108624458313
Epoch: 28, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.261 Vali Acc: 0.878 Test Loss: 0.261 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.607641935348511
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.265 Vali Acc: 0.883 Test Loss: 0.265 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.900329113006592
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 18771718
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.827681303024292
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.622 Vali Acc: 0.367 Test Loss: 1.622 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 2.807810068130493
Epoch: 2, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.289 Vali Acc: 0.672 Test Loss: 1.289 Test Acc: 0.672
Validation loss decreased (-0.366650 --> -0.672209).  Saving model ...
Epoch: 3 cost time: 2.4731833934783936
Epoch: 3, Steps: 12 | Train Loss: 1.144 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
Validation loss decreased (-0.672209 --> -0.738879).  Saving model ...
Epoch: 4 cost time: 2.6892731189727783
Epoch: 4, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.712 Vali Acc: 0.756 Test Loss: 0.712 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 2.881357431411743
Epoch: 5, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5819969177246094
Epoch: 6, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.460 Vali Acc: 0.794 Test Loss: 0.460 Test Acc: 0.794
Validation loss decreased (-0.755548 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 2.5195131301879883
Epoch: 7, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.595126152038574
Epoch: 8, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 2.5341873168945312
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6619856357574463
Epoch: 10, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7240357398986816
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 2.758286476135254
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.7842631340026855
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.58412766456604
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.235 Vali Acc: 0.894 Test Loss: 0.235 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 2.6189215183258057
Epoch: 15, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.236 Vali Acc: 0.894 Test Loss: 0.236 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.598550319671631
Epoch: 16, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 17 cost time: 2.6288936138153076
Epoch: 17, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.181 Vali Acc: 0.917 Test Loss: 0.181 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 2.6728358268737793
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5594751834869385
Epoch: 19, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.153 Vali Acc: 0.939 Test Loss: 0.153 Test Acc: 0.939
Validation loss decreased (-0.916665 --> -0.938887).  Saving model ...
Epoch: 20 cost time: 2.5637664794921875
Epoch: 20, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.725743055343628
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.827648639678955
Epoch: 22, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8209798336029053
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.819282293319702
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 2.8015072345733643
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.7582218647003174
Epoch: 26, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.944 Test Loss: 0.144 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 2.7139439582824707
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.889054298400879
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.816478729248047
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 2.840358257293701
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.248 Vali Acc: 0.939 Test Loss: 0.248 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 5532166
model size : 22.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.171558380126953
Epoch: 1, Steps: 12 | Train Loss: 1.796 Vali Loss: 1.692 Vali Acc: 0.311 Test Loss: 1.692 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 5.143609523773193
Epoch: 2, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.368 Vali Acc: 0.594 Test Loss: 1.368 Test Acc: 0.594
Validation loss decreased (-0.311094 --> -0.594431).  Saving model ...
Epoch: 3 cost time: 5.224451303482056
Epoch: 3, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.002 Vali Acc: 0.683 Test Loss: 1.002 Test Acc: 0.683
Validation loss decreased (-0.594431 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 5.876192331314087
Epoch: 4, Steps: 12 | Train Loss: 0.843 Vali Loss: 0.704 Vali Acc: 0.750 Test Loss: 0.704 Test Acc: 0.750
Validation loss decreased (-0.683323 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 5.940633773803711
Epoch: 5, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.526 Vali Acc: 0.811 Test Loss: 0.526 Test Acc: 0.811
Validation loss decreased (-0.749993 --> -0.811106).  Saving model ...
Epoch: 6 cost time: 5.633112192153931
Epoch: 6, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.910379409790039
Epoch: 7, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.384 Vali Acc: 0.822 Test Loss: 0.384 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 5.8259477615356445
Epoch: 8, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.354 Vali Acc: 0.822 Test Loss: 0.354 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 9 cost time: 5.752797603607178
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.367 Vali Acc: 0.822 Test Loss: 0.367 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.673782110214233
Epoch: 10, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.331 Vali Acc: 0.828 Test Loss: 0.331 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 5.695283889770508
Epoch: 11, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.322 Vali Acc: 0.828 Test Loss: 0.322 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827775).  Saving model ...
Epoch: 12 cost time: 5.112634897232056
Epoch: 12, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.327 Vali Acc: 0.839 Test Loss: 0.327 Test Acc: 0.839
Validation loss decreased (-0.827775 --> -0.838886).  Saving model ...
Epoch: 13 cost time: 5.432383060455322
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 5.203312397003174
Epoch: 14, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.364 Vali Acc: 0.833 Test Loss: 0.364 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.228723049163818
Epoch: 15, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.317 Vali Acc: 0.822 Test Loss: 0.317 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.0416295528411865
Epoch: 16, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.292 Vali Acc: 0.856 Test Loss: 0.292 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 17 cost time: 5.1554131507873535
Epoch: 17, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.237 Vali Acc: 0.889 Test Loss: 0.237 Test Acc: 0.889
Validation loss decreased (-0.855553 --> -0.888887).  Saving model ...
Epoch: 18 cost time: 4.802056312561035
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.289 Vali Acc: 0.867 Test Loss: 0.289 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.329019546508789
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
Validation loss decreased (-0.888887 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 4.896085500717163
Epoch: 20, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.451 Vali Acc: 0.883 Test Loss: 0.451 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.978054046630859
Epoch: 21, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.178 Vali Acc: 0.928 Test Loss: 0.178 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 5.247020483016968
Epoch: 22, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.1931281089782715
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.293 Vali Acc: 0.917 Test Loss: 0.293 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.981800079345703
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.251187562942505
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.297503232955933
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.4955525398254395
Epoch: 27, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 5.521637439727783
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.505011558532715
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.470 Vali Acc: 0.922 Test Loss: 0.470 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.30044960975647
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.939 Test Loss: 0.161 Test Acc: 0.939
Validation loss decreased (-0.933330 --> -0.938887).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 18771718
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.160497665405273
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.622 Vali Acc: 0.367 Test Loss: 1.622 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 2.2467195987701416
Epoch: 2, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.289 Vali Acc: 0.672 Test Loss: 1.289 Test Acc: 0.672
Validation loss decreased (-0.366650 --> -0.672209).  Saving model ...
Epoch: 3 cost time: 2.120621681213379
Epoch: 3, Steps: 12 | Train Loss: 1.144 Vali Loss: 0.966 Vali Acc: 0.739 Test Loss: 0.966 Test Acc: 0.739
Validation loss decreased (-0.672209 --> -0.738879).  Saving model ...
Epoch: 4 cost time: 2.182907819747925
Epoch: 4, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.712 Vali Acc: 0.756 Test Loss: 0.712 Test Acc: 0.756
Validation loss decreased (-0.738879 --> -0.755548).  Saving model ...
Epoch: 5 cost time: 2.1714906692504883
Epoch: 5, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5267343521118164
Epoch: 6, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.460 Vali Acc: 0.794 Test Loss: 0.460 Test Acc: 0.794
Validation loss decreased (-0.755548 --> -0.794440).  Saving model ...
Epoch: 7 cost time: 2.454869270324707
Epoch: 7, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
Validation loss decreased (-0.794440 --> -0.838885).  Saving model ...
Epoch: 8 cost time: 2.543351888656616
Epoch: 8, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 2.836611032485962
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4649345874786377
Epoch: 10, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.322 Vali Acc: 0.844 Test Loss: 0.322 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.445491075515747
Epoch: 11, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 2.690446615219116
Epoch: 12, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 2.3979716300964355
Epoch: 13, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.337 Vali Acc: 0.850 Test Loss: 0.337 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.43255352973938
Epoch: 14, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 15 cost time: 2.6238420009613037
Epoch: 15, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.238 Vali Acc: 0.894 Test Loss: 0.238 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4948456287384033
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 17 cost time: 2.432483196258545
Epoch: 17, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927776).  Saving model ...
Epoch: 18 cost time: 2.467773675918579
Epoch: 18, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.677212715148926
Epoch: 19, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.153 Vali Acc: 0.939 Test Loss: 0.153 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 20 cost time: 2.3891448974609375
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3925442695617676
Epoch: 21, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 2.6231276988983154
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.380811929702759
Epoch: 23, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9331436157226562
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 2.5894381999969482
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 2.4895732402801514
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.933 Test Loss: 0.153 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.292053461074829
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.413789749145508
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 2.6495628356933594
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.956 Test Loss: 0.111 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 2.2804388999938965
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 5532166
model size : 22.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.847674369812012
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.695 Vali Acc: 0.311 Test Loss: 1.695 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 3.004467487335205
Epoch: 2, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.380 Vali Acc: 0.583 Test Loss: 1.380 Test Acc: 0.583
Validation loss decreased (-0.311094 --> -0.583320).  Saving model ...
Epoch: 3 cost time: 2.976588010787964
Epoch: 3, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.022 Vali Acc: 0.678 Test Loss: 1.022 Test Acc: 0.678
Validation loss decreased (-0.583320 --> -0.677768).  Saving model ...
Epoch: 4 cost time: 2.6776859760284424
Epoch: 4, Steps: 12 | Train Loss: 0.850 Vali Loss: 0.731 Vali Acc: 0.733 Test Loss: 0.731 Test Acc: 0.733
Validation loss decreased (-0.677768 --> -0.733326).  Saving model ...
Epoch: 5 cost time: 2.6906862258911133
Epoch: 5, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.549 Vali Acc: 0.794 Test Loss: 0.549 Test Acc: 0.794
Validation loss decreased (-0.733326 --> -0.794439).  Saving model ...
Epoch: 6 cost time: 2.59519624710083
Epoch: 6, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.450 Vali Acc: 0.789 Test Loss: 0.450 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8807857036590576
Epoch: 7, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822218).  Saving model ...
Epoch: 8 cost time: 3.0124099254608154
Epoch: 8, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.363 Vali Acc: 0.828 Test Loss: 0.363 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 2.912376880645752
Epoch: 9, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7736659049987793
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 2.7427494525909424
Epoch: 11, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.330 Vali Acc: 0.828 Test Loss: 0.330 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 2.833404302597046
Epoch: 12, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 2.7027461528778076
Epoch: 13, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.338 Vali Acc: 0.844 Test Loss: 0.338 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 2.834465265274048
Epoch: 14, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.379 Vali Acc: 0.839 Test Loss: 0.379 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7430951595306396
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.341 Vali Acc: 0.822 Test Loss: 0.341 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.975102424621582
Epoch: 16, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.289 Vali Acc: 0.850 Test Loss: 0.289 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 3.314857244491577
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.269 Vali Acc: 0.856 Test Loss: 0.269 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855553).  Saving model ...
Epoch: 18 cost time: 3.1970136165618896
Epoch: 18, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.855553 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 3.160916328430176
Epoch: 19, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.308 Vali Acc: 0.928 Test Loss: 0.308 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927775).  Saving model ...
Epoch: 20 cost time: 3.097468614578247
Epoch: 20, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0831046104431152
Epoch: 21, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1029491424560547
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.299 Vali Acc: 0.911 Test Loss: 0.299 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9879274368286133
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.483 Vali Acc: 0.889 Test Loss: 0.483 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.094508409500122
Epoch: 24, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2808494567871094
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1847281455993652
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 3.207599639892578
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.251 Vali Acc: 0.939 Test Loss: 0.251 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 28 cost time: 3.270495891571045
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.378 Vali Acc: 0.928 Test Loss: 0.378 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.334796190261841
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.405 Vali Acc: 0.928 Test Loss: 0.405 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1797873973846436
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 18771718
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1702609062194824
Epoch: 1, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.631 Vali Acc: 0.361 Test Loss: 1.631 Test Acc: 0.361
Validation loss decreased (inf --> -0.361095).  Saving model ...
Epoch: 2 cost time: 1.511204719543457
Epoch: 2, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.320 Vali Acc: 0.661 Test Loss: 1.320 Test Acc: 0.661
Validation loss decreased (-0.361095 --> -0.661098).  Saving model ...
Epoch: 3 cost time: 1.5610647201538086
Epoch: 3, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.002 Vali Acc: 0.728 Test Loss: 1.002 Test Acc: 0.728
Validation loss decreased (-0.661098 --> -0.727768).  Saving model ...
Epoch: 4 cost time: 1.7592897415161133
Epoch: 4, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.742 Vali Acc: 0.744 Test Loss: 0.742 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744437).  Saving model ...
Epoch: 5 cost time: 1.7538318634033203
Epoch: 5, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.596 Vali Acc: 0.739 Test Loss: 0.596 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9046719074249268
Epoch: 6, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.478 Vali Acc: 0.783 Test Loss: 0.478 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783329).  Saving model ...
Epoch: 7 cost time: 1.6841249465942383
Epoch: 7, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.413 Vali Acc: 0.828 Test Loss: 0.413 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
Epoch: 8 cost time: 1.7381017208099365
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 9 cost time: 1.6884534358978271
Epoch: 9, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.680494785308838
Epoch: 10, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.86289644241333
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 1.6281476020812988
Epoch: 12, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.276 Vali Acc: 0.878 Test Loss: 0.276 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 13 cost time: 1.7943406105041504
Epoch: 13, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2686684131622314
Epoch: 14, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 1.581345796585083
Epoch: 15, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899998).  Saving model ...
Epoch: 16 cost time: 1.8386445045471191
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.244 Vali Acc: 0.894 Test Loss: 0.244 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6413695812225342
Epoch: 17, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
Validation loss decreased (-0.899998 --> -0.916665).  Saving model ...
Epoch: 18 cost time: 1.6960463523864746
Epoch: 18, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5831935405731201
Epoch: 19, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.178 Vali Acc: 0.917 Test Loss: 0.178 Test Acc: 0.917
Validation loss decreased (-0.916665 --> -0.916665).  Saving model ...
Epoch: 20 cost time: 1.7311506271362305
Epoch: 20, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.200 Vali Acc: 0.928 Test Loss: 0.200 Test Acc: 0.928
Validation loss decreased (-0.916665 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 1.7706892490386963
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6331090927124023
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 1.664693832397461
Epoch: 23, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 1.6058847904205322
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.669823169708252
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 26 cost time: 1.7243869304656982
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.944 Test Loss: 0.133 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 1.594717264175415
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.939 Test Loss: 0.146 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7185719013214111
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5509662628173828
Epoch: 29, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.956 Test Loss: 0.121 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 1.6283369064331055
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 5532166
model size : 22.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.759876251220703
Epoch: 1, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.570 Vali Acc: 0.456 Test Loss: 1.570 Test Acc: 0.456
Validation loss decreased (inf --> -0.455540).  Saving model ...
Epoch: 2 cost time: 4.187084197998047
Epoch: 2, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.307 Vali Acc: 0.628 Test Loss: 1.307 Test Acc: 0.628
Validation loss decreased (-0.455540 --> -0.627765).  Saving model ...
Epoch: 3 cost time: 4.103352785110474
Epoch: 3, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.008 Vali Acc: 0.689 Test Loss: 1.008 Test Acc: 0.689
Validation loss decreased (-0.627765 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 4.509347677230835
Epoch: 4, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 3.8805508613586426
Epoch: 5, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.605 Vali Acc: 0.744 Test Loss: 0.605 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 3.645437479019165
Epoch: 6, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.497 Vali Acc: 0.767 Test Loss: 0.497 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 3.488325834274292
Epoch: 7, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.435 Vali Acc: 0.772 Test Loss: 0.435 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 8 cost time: 3.9196839332580566
Epoch: 8, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
Validation loss decreased (-0.772218 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 3.957888603210449
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.336 Vali Acc: 0.811 Test Loss: 0.336 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.30767560005188
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 3.97395658493042
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.188617467880249
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 3.988957643508911
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 4.017118215560913
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 4.040170192718506
Epoch: 15, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.410 Vali Acc: 0.856 Test Loss: 0.410 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9614484310150146
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.283 Vali Acc: 0.844 Test Loss: 0.283 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.191204071044922
Epoch: 17, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 4.367543935775757
Epoch: 18, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.360668182373047
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 4.163525819778442
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.217 Vali Acc: 0.906 Test Loss: 0.217 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 4.45706844329834
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.152040004730225
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.297680377960205
Epoch: 23, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 4.121371746063232
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.911108 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 4.481267690658569
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.0949413776397705
Epoch: 26, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8409159183502197
Epoch: 27, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.435 Vali Acc: 0.911 Test Loss: 0.435 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.047422647476196
Epoch: 28, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.6393370628356934
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.415 Vali Acc: 0.911 Test Loss: 0.415 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.090811014175415
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.488 Vali Acc: 0.894 Test Loss: 0.488 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 9398534
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.037376642227173
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.657 Vali Acc: 0.322 Test Loss: 1.657 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 1.7959802150726318
Epoch: 2, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.380 Vali Acc: 0.556 Test Loss: 1.380 Test Acc: 0.556
Validation loss decreased (-0.322206 --> -0.555542).  Saving model ...
Epoch: 3 cost time: 1.8670666217803955
Epoch: 3, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.080 Vali Acc: 0.706 Test Loss: 1.080 Test Acc: 0.706
Validation loss decreased (-0.555542 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 1.876835584640503
Epoch: 4, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.827 Vali Acc: 0.728 Test Loss: 0.827 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 1.9176435470581055
Epoch: 5, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0166585445404053
Epoch: 6, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.545 Vali Acc: 0.722 Test Loss: 0.545 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9451594352722168
Epoch: 7, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
Validation loss decreased (-0.727770 --> -0.816662).  Saving model ...
Epoch: 8 cost time: 1.8565373420715332
Epoch: 8, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.389 Vali Acc: 0.789 Test Loss: 0.389 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8561909198760986
Epoch: 9, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 2.0111517906188965
Epoch: 10, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0973238945007324
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9588253498077393
Epoch: 12, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7833545207977295
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.317 Vali Acc: 0.833 Test Loss: 0.317 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.912410020828247
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 1.9928722381591797
Epoch: 15, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 2.074687957763672
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.9382236003875732
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.391 Vali Acc: 0.828 Test Loss: 0.391 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9309544563293457
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
Validation loss decreased (-0.888886 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 1.8322675228118896
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.9409117698669434
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8478646278381348
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.209 Vali Acc: 0.906 Test Loss: 0.209 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6935884952545166
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.277 Vali Acc: 0.889 Test Loss: 0.277 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7854769229888916
Epoch: 23, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8367846012115479
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.174 Vali Acc: 0.928 Test Loss: 0.174 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 1.8519625663757324
Epoch: 25, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.502 Vali Acc: 0.894 Test Loss: 0.502 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.99937105178833
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9029557704925537
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8938117027282715
Epoch: 28, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9588046073913574
Epoch: 29, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.911468505859375
Epoch: 30, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.928 Test Loss: 0.203 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2778630
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6326210498809814
Epoch: 1, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.570 Vali Acc: 0.456 Test Loss: 1.570 Test Acc: 0.456
Validation loss decreased (inf --> -0.455540).  Saving model ...
Epoch: 2 cost time: 3.279458522796631
Epoch: 2, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.307 Vali Acc: 0.628 Test Loss: 1.307 Test Acc: 0.628
Validation loss decreased (-0.455540 --> -0.627765).  Saving model ...
Epoch: 3 cost time: 3.042426586151123
Epoch: 3, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.008 Vali Acc: 0.689 Test Loss: 1.008 Test Acc: 0.689
Validation loss decreased (-0.627765 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 3.2182772159576416
Epoch: 4, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
Validation loss decreased (-0.688879 --> -0.722215).  Saving model ...
Epoch: 5 cost time: 3.195775032043457
Epoch: 5, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.605 Vali Acc: 0.744 Test Loss: 0.605 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 6 cost time: 3.1804826259613037
Epoch: 6, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.497 Vali Acc: 0.767 Test Loss: 0.497 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766662).  Saving model ...
Epoch: 7 cost time: 3.016317367553711
Epoch: 7, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.435 Vali Acc: 0.772 Test Loss: 0.435 Test Acc: 0.772
Validation loss decreased (-0.766662 --> -0.772218).  Saving model ...
Epoch: 8 cost time: 3.128533363342285
Epoch: 8, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
Validation loss decreased (-0.772218 --> -0.822218).  Saving model ...
Epoch: 9 cost time: 3.2352936267852783
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.336 Vali Acc: 0.811 Test Loss: 0.336 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3338403701782227
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 3.020214319229126
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2209160327911377
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 3.248657703399658
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.298 Vali Acc: 0.861 Test Loss: 0.298 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 3.3280680179595947
Epoch: 14, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 3.248190402984619
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.411 Vali Acc: 0.856 Test Loss: 0.411 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.146610736846924
Epoch: 16, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.283 Vali Acc: 0.844 Test Loss: 0.283 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0483157634735107
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 3.1747655868530273
Epoch: 18, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9742541313171387
Epoch: 19, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 3.2957677841186523
Epoch: 20, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.219 Vali Acc: 0.900 Test Loss: 0.219 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2077105045318604
Epoch: 21, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.259533166885376
Epoch: 22, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2721798419952393
Epoch: 23, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 3.3092548847198486
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.911108 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 3.429326057434082
Epoch: 25, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.349919557571411
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3980839252471924
Epoch: 27, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.425 Vali Acc: 0.917 Test Loss: 0.425 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.29154109954834
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.55076265335083
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.353 Vali Acc: 0.922 Test Loss: 0.353 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.5680999755859375
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 9398534
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8438851833343506
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.657 Vali Acc: 0.322 Test Loss: 1.657 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 1.6349875926971436
Epoch: 2, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.380 Vali Acc: 0.556 Test Loss: 1.380 Test Acc: 0.556
Validation loss decreased (-0.322206 --> -0.555542).  Saving model ...
Epoch: 3 cost time: 1.6644704341888428
Epoch: 3, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.080 Vali Acc: 0.706 Test Loss: 1.080 Test Acc: 0.706
Validation loss decreased (-0.555542 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 1.7355144023895264
Epoch: 4, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.827 Vali Acc: 0.728 Test Loss: 0.827 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727770).  Saving model ...
Epoch: 5 cost time: 1.7097063064575195
Epoch: 5, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8024954795837402
Epoch: 6, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.545 Vali Acc: 0.722 Test Loss: 0.545 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6765613555908203
Epoch: 7, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
Validation loss decreased (-0.727770 --> -0.816662).  Saving model ...
Epoch: 8 cost time: 1.6647751331329346
Epoch: 8, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.389 Vali Acc: 0.794 Test Loss: 0.389 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.619739055633545
Epoch: 9, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
Validation loss decreased (-0.816662 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 1.648754596710205
Epoch: 10, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.365 Vali Acc: 0.833 Test Loss: 0.365 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.833298921585083
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.335 Vali Acc: 0.828 Test Loss: 0.335 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5497748851776123
Epoch: 12, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.314 Vali Acc: 0.844 Test Loss: 0.314 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7421231269836426
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.317 Vali Acc: 0.839 Test Loss: 0.317 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3788495063781738
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.291 Vali Acc: 0.856 Test Loss: 0.291 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855553).  Saving model ...
Epoch: 15 cost time: 1.635741949081421
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
Validation loss decreased (-0.855553 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 1.7848126888275146
Epoch: 16, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.244 Vali Acc: 0.889 Test Loss: 0.244 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 1.5526118278503418
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.391 Vali Acc: 0.828 Test Loss: 0.391 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.881981611251831
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
Validation loss decreased (-0.888886 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 1.7056331634521484
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.6028845310211182
Epoch: 20, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.256 Vali Acc: 0.894 Test Loss: 0.256 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7403054237365723
Epoch: 21, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6693472862243652
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7644870281219482
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.272 Vali Acc: 0.889 Test Loss: 0.272 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6162004470825195
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.181 Vali Acc: 0.928 Test Loss: 0.181 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 25 cost time: 1.7618563175201416
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.509 Vali Acc: 0.889 Test Loss: 0.509 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6143953800201416
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.363 Vali Acc: 0.894 Test Loss: 0.363 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.570361852645874
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5034801959991455
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.465019941329956
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5081586837768555
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 2778630
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8125314712524414
Epoch: 1, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.570 Vali Acc: 0.456 Test Loss: 1.570 Test Acc: 0.456
Validation loss decreased (inf --> -0.455540).  Saving model ...
Epoch: 2 cost time: 1.7726991176605225
Epoch: 2, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.309 Vali Acc: 0.628 Test Loss: 1.309 Test Acc: 0.628
Validation loss decreased (-0.455540 --> -0.627765).  Saving model ...
Epoch: 3 cost time: 2.037303924560547
Epoch: 3, Steps: 12 | Train Loss: 1.136 Vali Loss: 1.013 Vali Acc: 0.689 Test Loss: 1.013 Test Acc: 0.689
Validation loss decreased (-0.627765 --> -0.688879).  Saving model ...
Epoch: 4 cost time: 1.9686775207519531
Epoch: 4, Steps: 12 | Train Loss: 0.846 Vali Loss: 0.764 Vali Acc: 0.711 Test Loss: 0.764 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711103).  Saving model ...
Epoch: 5 cost time: 2.113948106765747
Epoch: 5, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.621 Vali Acc: 0.733 Test Loss: 0.621 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 2.1930854320526123
Epoch: 6, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.514 Vali Acc: 0.756 Test Loss: 0.514 Test Acc: 0.756
Validation loss decreased (-0.733327 --> -0.755550).  Saving model ...
Epoch: 7 cost time: 2.1727397441864014
Epoch: 7, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.451 Vali Acc: 0.761 Test Loss: 0.451 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761107).  Saving model ...
Epoch: 8 cost time: 2.0169172286987305
Epoch: 8, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.400 Vali Acc: 0.806 Test Loss: 0.400 Test Acc: 0.806
Validation loss decreased (-0.761107 --> -0.805552).  Saving model ...
Epoch: 9 cost time: 2.134819746017456
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.351 Vali Acc: 0.800 Test Loss: 0.351 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9987471103668213
Epoch: 10, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.334 Vali Acc: 0.844 Test Loss: 0.334 Test Acc: 0.844
Validation loss decreased (-0.805552 --> -0.844441).  Saving model ...
Epoch: 11 cost time: 2.0363314151763916
Epoch: 11, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.347 Vali Acc: 0.844 Test Loss: 0.347 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1664886474609375
Epoch: 12, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 2.2356646060943604
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.314 Vali Acc: 0.856 Test Loss: 0.314 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0861899852752686
Epoch: 14, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.359 Vali Acc: 0.889 Test Loss: 0.359 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 2.128828763961792
Epoch: 15, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.444 Vali Acc: 0.839 Test Loss: 0.444 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0735116004943848
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.309 Vali Acc: 0.833 Test Loss: 0.309 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.112619400024414
Epoch: 17, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2504312992095947
Epoch: 18, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 2.2423646450042725
Epoch: 19, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.275 Vali Acc: 0.906 Test Loss: 0.275 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0344948768615723
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.1969592571258545
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1859238147735596
Epoch: 22, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.339599609375
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.371 Vali Acc: 0.906 Test Loss: 0.371 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.219270944595337
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.253 Vali Acc: 0.939 Test Loss: 0.253 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938886).  Saving model ...
Epoch: 25 cost time: 2.179713249206543
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.480 Vali Acc: 0.906 Test Loss: 0.480 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0804545879364014
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1433489322662354
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.481 Vali Acc: 0.917 Test Loss: 0.481 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2199337482452393
Epoch: 28, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.457 Vali Acc: 0.894 Test Loss: 0.457 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2038986682891846
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.361 Vali Acc: 0.928 Test Loss: 0.361 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0092358589172363
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.938886 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 9398534
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1547305583953857
Epoch: 1, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.656 Vali Acc: 0.322 Test Loss: 1.656 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 1.278304100036621
Epoch: 2, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.383 Vali Acc: 0.550 Test Loss: 1.383 Test Acc: 0.550
Validation loss decreased (-0.322206 --> -0.549986).  Saving model ...
Epoch: 3 cost time: 1.4093317985534668
Epoch: 3, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.086 Vali Acc: 0.706 Test Loss: 1.086 Test Acc: 0.706
Validation loss decreased (-0.549986 --> -0.705545).  Saving model ...
Epoch: 4 cost time: 1.6934361457824707
Epoch: 4, Steps: 12 | Train Loss: 0.956 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722214).  Saving model ...
Epoch: 5 cost time: 1.322148084640503
Epoch: 5, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.676 Vali Acc: 0.711 Test Loss: 0.676 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.45719313621521
Epoch: 6, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.556 Vali Acc: 0.717 Test Loss: 0.556 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.303663730621338
Epoch: 7, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.466 Vali Acc: 0.806 Test Loss: 0.466 Test Acc: 0.806
Validation loss decreased (-0.722214 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 1.4673759937286377
Epoch: 8, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.399 Vali Acc: 0.789 Test Loss: 0.399 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.410184621810913
Epoch: 9, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
Validation loss decreased (-0.805551 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 1.309762954711914
Epoch: 10, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2793312072753906
Epoch: 11, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.328 Vali Acc: 0.833 Test Loss: 0.328 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4622471332550049
Epoch: 12, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 1.4824156761169434
Epoch: 13, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 14 cost time: 1.375739574432373
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.272 Vali Acc: 0.867 Test Loss: 0.272 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866664).  Saving model ...
Epoch: 15 cost time: 1.5206024646759033
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.866664 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.2839040756225586
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.223 Vali Acc: 0.900 Test Loss: 0.223 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 17 cost time: 1.523193597793579
Epoch: 17, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3467333316802979
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.899998 --> -0.933332).  Saving model ...
Epoch: 19 cost time: 1.3906581401824951
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
Validation loss decreased (-0.933332 --> -0.938887).  Saving model ...
Epoch: 20 cost time: 1.3293564319610596
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3082141876220703
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3076999187469482
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.318373203277588
Epoch: 23, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3926568031311035
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.933 Test Loss: 0.166 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.258089303970337
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3660285472869873
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4143028259277344
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2702903747558594
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.498 Vali Acc: 0.878 Test Loss: 0.498 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3570079803466797
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2778630
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.677521228790283
Epoch: 1, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.705 Vali Acc: 0.250 Test Loss: 1.705 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 3.0524301528930664
Epoch: 2, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.434 Vali Acc: 0.500 Test Loss: 1.434 Test Acc: 0.500
Validation loss decreased (-0.249983 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 3.0621798038482666
Epoch: 3, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.128 Vali Acc: 0.717 Test Loss: 1.128 Test Acc: 0.717
Validation loss decreased (-0.499986 --> -0.716655).  Saving model ...
Epoch: 4 cost time: 3.0842363834381104
Epoch: 4, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.840 Vali Acc: 0.706 Test Loss: 0.840 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.794524908065796
Epoch: 5, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.641 Vali Acc: 0.733 Test Loss: 0.641 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 3.1353261470794678
Epoch: 6, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 2.935227155685425
Epoch: 7, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.441 Vali Acc: 0.806 Test Loss: 0.441 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 3.0837244987487793
Epoch: 8, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 2.9217641353607178
Epoch: 9, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.650797128677368
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.693263292312622
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 2.9181506633758545
Epoch: 12, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 2.8255953788757324
Epoch: 13, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.871244192123413
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.6994502544403076
Epoch: 15, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 3.0387535095214844
Epoch: 16, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5717902183532715
Epoch: 17, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 18 cost time: 2.667224168777466
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 2.7660787105560303
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.9872684478759766
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.7441608905792236
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 2.7585325241088867
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7663347721099854
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8388171195983887
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6743898391723633
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 2.7396724224090576
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7530529499053955
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.868030071258545
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.348 Vali Acc: 0.911 Test Loss: 0.348 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.9559013843536377
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.252 Vali Acc: 0.917 Test Loss: 0.252 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.356875419616699
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 4711942
model size : 19.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.246532678604126
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.727 Vali Acc: 0.256 Test Loss: 1.727 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 1.662290334701538
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.456 Vali Acc: 0.550 Test Loss: 1.456 Test Acc: 0.550
Validation loss decreased (-0.255538 --> -0.549985).  Saving model ...
Epoch: 3 cost time: 1.5759391784667969
Epoch: 3, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.165 Vali Acc: 0.672 Test Loss: 1.165 Test Acc: 0.672
Validation loss decreased (-0.549985 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.6365199089050293
Epoch: 4, Steps: 12 | Train Loss: 1.017 Vali Loss: 0.902 Vali Acc: 0.717 Test Loss: 0.902 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716658).  Saving model ...
Epoch: 5 cost time: 1.5895893573760986
Epoch: 5, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.717 Vali Acc: 0.728 Test Loss: 0.717 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.7778782844543457
Epoch: 6, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.599 Vali Acc: 0.739 Test Loss: 0.599 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.7007358074188232
Epoch: 7, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.508 Vali Acc: 0.811 Test Loss: 0.508 Test Acc: 0.811
Validation loss decreased (-0.738883 --> -0.811106).  Saving model ...
Epoch: 8 cost time: 1.6820218563079834
Epoch: 8, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.435 Vali Acc: 0.794 Test Loss: 0.435 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.749678373336792
Epoch: 9, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.7723865509033203
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.6436758041381836
Epoch: 11, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 1.6369452476501465
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.73964524269104
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7536535263061523
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.6958048343658447
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.696075439453125
Epoch: 16, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6500639915466309
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.695321798324585
Epoch: 18, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 1.860752820968628
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8779332637786865
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.233 Vali Acc: 0.883 Test Loss: 0.233 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7486224174499512
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.7570018768310547
Epoch: 22, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.161 Vali Acc: 0.928 Test Loss: 0.161 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 1.6442131996154785
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6838233470916748
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.8379786014556885
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.77760910987854
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7204556465148926
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7634179592132568
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9468998908996582
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.276 Vali Acc: 0.939 Test Loss: 0.276 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6902549266815186
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 1401862
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.193581819534302
Epoch: 1, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.705 Vali Acc: 0.250 Test Loss: 1.705 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 2.5010125637054443
Epoch: 2, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.434 Vali Acc: 0.500 Test Loss: 1.434 Test Acc: 0.500
Validation loss decreased (-0.249983 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 2.644221544265747
Epoch: 3, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.128 Vali Acc: 0.717 Test Loss: 1.128 Test Acc: 0.717
Validation loss decreased (-0.499986 --> -0.716655).  Saving model ...
Epoch: 4 cost time: 2.423832416534424
Epoch: 4, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.840 Vali Acc: 0.706 Test Loss: 0.840 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4675474166870117
Epoch: 5, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.641 Vali Acc: 0.733 Test Loss: 0.641 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733327).  Saving model ...
Epoch: 6 cost time: 2.1475868225097656
Epoch: 6, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 2.2633206844329834
Epoch: 7, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.441 Vali Acc: 0.806 Test Loss: 0.441 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 2.4107468128204346
Epoch: 8, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833330).  Saving model ...
Epoch: 9 cost time: 2.204629421234131
Epoch: 9, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.343 Vali Acc: 0.833 Test Loss: 0.343 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 2.2678608894348145
Epoch: 10, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.322 Vali Acc: 0.850 Test Loss: 0.322 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 2.1893041133880615
Epoch: 11, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 2.2846179008483887
Epoch: 12, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 2.4988291263580322
Epoch: 13, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3647069931030273
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.278 Vali Acc: 0.878 Test Loss: 0.278 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 2.5617172718048096
Epoch: 15, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 2.4103596210479736
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.274 Vali Acc: 0.872 Test Loss: 0.274 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3479244709014893
Epoch: 17, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.247 Vali Acc: 0.900 Test Loss: 0.247 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899998).  Saving model ...
Epoch: 18 cost time: 2.0677573680877686
Epoch: 18, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 2.1477577686309814
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 2.3041417598724365
Epoch: 20, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 2.1213717460632324
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 2.404444694519043
Epoch: 22, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.323 Vali Acc: 0.917 Test Loss: 0.323 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1635382175445557
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.105272054672241
Epoch: 24, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.429 Vali Acc: 0.889 Test Loss: 0.429 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.351973533630371
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 2.1274776458740234
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.189182996749878
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.318796157836914
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.348 Vali Acc: 0.917 Test Loss: 0.348 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.265885591506958
Epoch: 29, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.251 Vali Acc: 0.917 Test Loss: 0.251 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3403024673461914
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 4711942
model size : 19.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.154515504837036
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.727 Vali Acc: 0.256 Test Loss: 1.727 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 1.3255953788757324
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.456 Vali Acc: 0.550 Test Loss: 1.456 Test Acc: 0.550
Validation loss decreased (-0.255538 --> -0.549985).  Saving model ...
Epoch: 3 cost time: 1.2911295890808105
Epoch: 3, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.165 Vali Acc: 0.672 Test Loss: 1.165 Test Acc: 0.672
Validation loss decreased (-0.549985 --> -0.672211).  Saving model ...
Epoch: 4 cost time: 1.3874728679656982
Epoch: 4, Steps: 12 | Train Loss: 1.017 Vali Loss: 0.902 Vali Acc: 0.717 Test Loss: 0.902 Test Acc: 0.717
Validation loss decreased (-0.672211 --> -0.716658).  Saving model ...
Epoch: 5 cost time: 1.3754234313964844
Epoch: 5, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.717 Vali Acc: 0.728 Test Loss: 0.717 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 1.6060514450073242
Epoch: 6, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.599 Vali Acc: 0.739 Test Loss: 0.599 Test Acc: 0.739
Validation loss decreased (-0.727771 --> -0.738883).  Saving model ...
Epoch: 7 cost time: 1.4617784023284912
Epoch: 7, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.508 Vali Acc: 0.811 Test Loss: 0.508 Test Acc: 0.811
Validation loss decreased (-0.738883 --> -0.811106).  Saving model ...
Epoch: 8 cost time: 1.6839876174926758
Epoch: 8, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.435 Vali Acc: 0.794 Test Loss: 0.435 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.446789264678955
Epoch: 9, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.373 Vali Acc: 0.828 Test Loss: 0.373 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827774).  Saving model ...
Epoch: 10 cost time: 1.6055443286895752
Epoch: 10, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.338 Vali Acc: 0.850 Test Loss: 0.338 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.548013687133789
Epoch: 11, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.307 Vali Acc: 0.883 Test Loss: 0.307 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 1.6864745616912842
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.532508373260498
Epoch: 13, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.274 Vali Acc: 0.867 Test Loss: 0.274 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.737668514251709
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.245 Vali Acc: 0.906 Test Loss: 0.245 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 15 cost time: 1.4761590957641602
Epoch: 15, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6459448337554932
Epoch: 16, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.251 Vali Acc: 0.889 Test Loss: 0.251 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4453797340393066
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6308298110961914
Epoch: 18, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.203 Vali Acc: 0.917 Test Loss: 0.203 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 1.4540588855743408
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.341 Vali Acc: 0.917 Test Loss: 0.341 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.597066879272461
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.233 Vali Acc: 0.883 Test Loss: 0.233 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.455254077911377
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.6999504566192627
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.161 Vali Acc: 0.928 Test Loss: 0.161 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 23 cost time: 1.4939579963684082
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.200 Vali Acc: 0.906 Test Loss: 0.200 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6901319026947021
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.478438377380371
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6740827560424805
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4955470561981201
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6659209728240967
Epoch: 28, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.248 Vali Acc: 0.928 Test Loss: 0.248 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.485828161239624
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.277 Vali Acc: 0.939 Test Loss: 0.277 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6906094551086426
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 1401862
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.050798177719116
Epoch: 1, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.708 Vali Acc: 0.244 Test Loss: 1.708 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.831730604171753
Epoch: 2, Steps: 12 | Train Loss: 1.647 Vali Loss: 1.444 Vali Acc: 0.494 Test Loss: 1.444 Test Acc: 0.494
Validation loss decreased (-0.244427 --> -0.494430).  Saving model ...
Epoch: 3 cost time: 1.589054822921753
Epoch: 3, Steps: 12 | Train Loss: 1.333 Vali Loss: 1.148 Vali Acc: 0.694 Test Loss: 1.148 Test Acc: 0.694
Validation loss decreased (-0.494430 --> -0.694433).  Saving model ...
Epoch: 4 cost time: 1.7831511497497559
Epoch: 4, Steps: 12 | Train Loss: 1.006 Vali Loss: 0.864 Vali Acc: 0.694 Test Loss: 0.864 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694436).  Saving model ...
Epoch: 5 cost time: 1.6873512268066406
Epoch: 5, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.662 Vali Acc: 0.722 Test Loss: 0.662 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722216).  Saving model ...
Epoch: 6 cost time: 1.7978434562683105
Epoch: 6, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.544 Vali Acc: 0.750 Test Loss: 0.544 Test Acc: 0.750
Validation loss decreased (-0.722216 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 1.6546995639801025
Epoch: 7, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.453 Vali Acc: 0.806 Test Loss: 0.453 Test Acc: 0.806
Validation loss decreased (-0.749995 --> -0.805551).  Saving model ...
Epoch: 8 cost time: 1.772022008895874
Epoch: 8, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.389 Vali Acc: 0.828 Test Loss: 0.389 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 9 cost time: 1.5684473514556885
Epoch: 9, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 10 cost time: 1.7769949436187744
Epoch: 10, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.6787986755371094
Epoch: 11, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 1.6590421199798584
Epoch: 12, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 13 cost time: 1.739546775817871
Epoch: 13, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.339 Vali Acc: 0.850 Test Loss: 0.339 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6480305194854736
Epoch: 14, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.286 Vali Acc: 0.878 Test Loss: 0.286 Test Acc: 0.878
Validation loss decreased (-0.849997 --> -0.877775).  Saving model ...
Epoch: 15 cost time: 1.7867341041564941
Epoch: 15, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.247 Vali Acc: 0.889 Test Loss: 0.247 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 1.694417953491211
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.279 Vali Acc: 0.872 Test Loss: 0.279 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8751871585845947
Epoch: 17, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.6488127708435059
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 1.8257317543029785
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 20 cost time: 1.594700813293457
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 1.8467366695404053
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 22 cost time: 1.6747550964355469
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.333 Vali Acc: 0.917 Test Loss: 0.333 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8179504871368408
Epoch: 23, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6145918369293213
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8657314777374268
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.190 Vali Acc: 0.928 Test Loss: 0.190 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 26 cost time: 1.6888113021850586
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.939 Test Loss: 0.196 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 1.8413138389587402
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.721672534942627
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9328746795654297
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7046830654144287
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.939 Test Loss: 0.265 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 4711942
model size : 19.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.485522985458374
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.735 Vali Acc: 0.244 Test Loss: 1.735 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.146705150604248
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.467 Vali Acc: 0.539 Test Loss: 1.467 Test Acc: 0.539
Validation loss decreased (-0.244427 --> -0.538874).  Saving model ...
Epoch: 3 cost time: 1.2011849880218506
Epoch: 3, Steps: 12 | Train Loss: 1.324 Vali Loss: 1.180 Vali Acc: 0.672 Test Loss: 1.180 Test Acc: 0.672
Validation loss decreased (-0.538874 --> -0.672210).  Saving model ...
Epoch: 4 cost time: 1.1352150440216064
Epoch: 4, Steps: 12 | Train Loss: 1.017 Vali Loss: 0.918 Vali Acc: 0.706 Test Loss: 0.918 Test Acc: 0.706
Validation loss decreased (-0.672210 --> -0.705546).  Saving model ...
Epoch: 5 cost time: 1.2017865180969238
Epoch: 5, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716659).  Saving model ...
Epoch: 6 cost time: 1.2115888595581055
Epoch: 6, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (-0.716659 --> -0.722216).  Saving model ...
Epoch: 7 cost time: 1.172020435333252
Epoch: 7, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.524 Vali Acc: 0.806 Test Loss: 0.524 Test Acc: 0.806
Validation loss decreased (-0.722216 --> -0.805550).  Saving model ...
Epoch: 8 cost time: 1.2044196128845215
Epoch: 8, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.450 Vali Acc: 0.789 Test Loss: 0.450 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2090764045715332
Epoch: 9, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.387 Vali Acc: 0.822 Test Loss: 0.387 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822218).  Saving model ...
Epoch: 10 cost time: 1.2683258056640625
Epoch: 10, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849997).  Saving model ...
Epoch: 11 cost time: 1.2232542037963867
Epoch: 11, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
Validation loss decreased (-0.849997 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 1.2561743259429932
Epoch: 12, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 1.1135547161102295
Epoch: 13, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.279 Vali Acc: 0.867 Test Loss: 0.279 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2520215511322021
Epoch: 14, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 1.0831105709075928
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.226 Vali Acc: 0.900 Test Loss: 0.226 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2439916133880615
Epoch: 16, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.253 Vali Acc: 0.889 Test Loss: 0.253 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.131312370300293
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.255 Vali Acc: 0.894 Test Loss: 0.255 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2424976825714111
Epoch: 18, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916665).  Saving model ...
Epoch: 19 cost time: 1.1725397109985352
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2584867477416992
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.236 Vali Acc: 0.883 Test Loss: 0.236 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1346814632415771
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.1689181327819824
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 23 cost time: 1.0649828910827637
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.906 Test Loss: 0.201 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0940160751342773
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.055189847946167
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2407879829406738
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.156207799911499
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1662025451660156
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.255 Vali Acc: 0.917 Test Loss: 0.255 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2825019359588623
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1073355674743652
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.179 Vali Acc: 0.939 Test Loss: 0.179 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 1401862
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.538352966308594
Epoch: 1, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.830 Vali Acc: 0.194 Test Loss: 1.830 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 2.6196768283843994
Epoch: 2, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.666 Vali Acc: 0.328 Test Loss: 1.666 Test Acc: 0.328
Validation loss decreased (-0.194426 --> -0.327761).  Saving model ...
Epoch: 3 cost time: 2.8293206691741943
Epoch: 3, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.462 Vali Acc: 0.528 Test Loss: 1.462 Test Acc: 0.528
Validation loss decreased (-0.327761 --> -0.527763).  Saving model ...
Epoch: 4 cost time: 2.452219009399414
Epoch: 4, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.214 Vali Acc: 0.633 Test Loss: 1.214 Test Acc: 0.633
Validation loss decreased (-0.527763 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 2.9371423721313477
Epoch: 5, Steps: 12 | Train Loss: 1.065 Vali Loss: 0.952 Vali Acc: 0.667 Test Loss: 0.952 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 2.838385820388794
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.762 Vali Acc: 0.694 Test Loss: 0.762 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694437).  Saving model ...
Epoch: 7 cost time: 2.842283010482788
Epoch: 7, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.654 Vali Acc: 0.750 Test Loss: 0.654 Test Acc: 0.750
Validation loss decreased (-0.694437 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 2.932358741760254
Epoch: 8, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 2.743988275527954
Epoch: 9, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.500 Vali Acc: 0.772 Test Loss: 0.500 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 2.725120782852173
Epoch: 10, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.449 Vali Acc: 0.811 Test Loss: 0.449 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.9971351623535156
Epoch: 11, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.9621219635009766
Epoch: 12, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.949294328689575
Epoch: 13, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 2.654775381088257
Epoch: 14, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 15 cost time: 2.5022101402282715
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 2.6913394927978516
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.345 Vali Acc: 0.817 Test Loss: 0.345 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9815309047698975
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.305 Vali Acc: 0.811 Test Loss: 0.305 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.058234930038452
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.309 Vali Acc: 0.822 Test Loss: 0.309 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9164509773254395
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.301 Vali Acc: 0.828 Test Loss: 0.301 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.0010149478912354
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.289 Vali Acc: 0.839 Test Loss: 0.289 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.911634922027588
Epoch: 21, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.292 Vali Acc: 0.861 Test Loss: 0.292 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 2.780313014984131
Epoch: 22, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.261 Vali Acc: 0.872 Test Loss: 0.261 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 23 cost time: 2.9749608039855957
Epoch: 23, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.312 Vali Acc: 0.861 Test Loss: 0.312 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.838798761367798
Epoch: 24, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.339 Vali Acc: 0.839 Test Loss: 0.339 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.87754225730896
Epoch: 25, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.264 Vali Acc: 0.878 Test Loss: 0.264 Test Acc: 0.878
Validation loss decreased (-0.872220 --> -0.877775).  Saving model ...
Epoch: 26 cost time: 2.795288562774658
Epoch: 26, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.215 Vali Acc: 0.906 Test Loss: 0.215 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 2.891150712966919
Epoch: 27, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0037295818328857
Epoch: 28, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0682570934295654
Epoch: 29, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.257 Vali Acc: 0.850 Test Loss: 0.257 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.15303111076355
Epoch: 30, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.197 Vali Acc: 0.917 Test Loss: 0.197 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916665).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 4700038
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.433793306350708
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.815 Vali Acc: 0.272 Test Loss: 1.815 Test Acc: 0.272
Validation loss decreased (inf --> -0.272204).  Saving model ...
Epoch: 2 cost time: 1.754408836364746
Epoch: 2, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.615 Vali Acc: 0.433 Test Loss: 1.615 Test Acc: 0.433
Validation loss decreased (-0.272204 --> -0.433317).  Saving model ...
Epoch: 3 cost time: 1.6636323928833008
Epoch: 3, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.378 Vali Acc: 0.556 Test Loss: 1.378 Test Acc: 0.556
Validation loss decreased (-0.433317 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 1.8609509468078613
Epoch: 4, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.146 Vali Acc: 0.639 Test Loss: 1.146 Test Acc: 0.639
Validation loss decreased (-0.555542 --> -0.638877).  Saving model ...
Epoch: 5 cost time: 1.667985439300537
Epoch: 5, Steps: 12 | Train Loss: 1.055 Vali Loss: 0.951 Vali Acc: 0.689 Test Loss: 0.951 Test Acc: 0.689
Validation loss decreased (-0.638877 --> -0.688879).  Saving model ...
Epoch: 6 cost time: 1.7371890544891357
Epoch: 6, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
Validation loss decreased (-0.688879 --> -0.727770).  Saving model ...
Epoch: 7 cost time: 1.8104541301727295
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6313726902008057
Epoch: 8, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.9140055179595947
Epoch: 9, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 1.7426378726959229
Epoch: 10, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.755550 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 1.201411485671997
Epoch: 11, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.464 Vali Acc: 0.817 Test Loss: 0.464 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.86588716506958
Epoch: 12, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.427 Vali Acc: 0.856 Test Loss: 0.427 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 1.7408802509307861
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.80214524269104
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7768580913543701
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.344 Vali Acc: 0.856 Test Loss: 0.344 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.7157247066497803
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9622306823730469
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.7725212574005127
Epoch: 18, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.711440086364746
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.8340473175048828
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.7317991256713867
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.8709161281585693
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.230 Vali Acc: 0.894 Test Loss: 0.230 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.793816328048706
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.173 Vali Acc: 0.939 Test Loss: 0.173 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 1.7399168014526367
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5949561595916748
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6499388217926025
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.335 Vali Acc: 0.911 Test Loss: 0.335 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6173458099365234
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.51251220703125
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 1.4994168281555176
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6331474781036377
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 1389830
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.821580171585083
Epoch: 1, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.830 Vali Acc: 0.194 Test Loss: 1.830 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 2.262983560562134
Epoch: 2, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.666 Vali Acc: 0.328 Test Loss: 1.666 Test Acc: 0.328
Validation loss decreased (-0.194426 --> -0.327761).  Saving model ...
Epoch: 3 cost time: 2.090346574783325
Epoch: 3, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.462 Vali Acc: 0.528 Test Loss: 1.462 Test Acc: 0.528
Validation loss decreased (-0.327761 --> -0.527763).  Saving model ...
Epoch: 4 cost time: 2.184548854827881
Epoch: 4, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.214 Vali Acc: 0.633 Test Loss: 1.214 Test Acc: 0.633
Validation loss decreased (-0.527763 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 2.175412893295288
Epoch: 5, Steps: 12 | Train Loss: 1.065 Vali Loss: 0.952 Vali Acc: 0.667 Test Loss: 0.952 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 2.224980592727661
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.762 Vali Acc: 0.694 Test Loss: 0.762 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694437).  Saving model ...
Epoch: 7 cost time: 2.3121819496154785
Epoch: 7, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.654 Vali Acc: 0.750 Test Loss: 0.654 Test Acc: 0.750
Validation loss decreased (-0.694437 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 2.1859447956085205
Epoch: 8, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.564 Vali Acc: 0.756 Test Loss: 0.564 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 2.3031115531921387
Epoch: 9, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.500 Vali Acc: 0.772 Test Loss: 0.500 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 2.245457410812378
Epoch: 10, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.449 Vali Acc: 0.811 Test Loss: 0.449 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 2.238612413406372
Epoch: 11, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 2.290680408477783
Epoch: 12, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.371 Vali Acc: 0.822 Test Loss: 0.371 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.908182144165039
Epoch: 13, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.362 Vali Acc: 0.833 Test Loss: 0.362 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833330).  Saving model ...
Epoch: 14 cost time: 2.3402562141418457
Epoch: 14, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 15 cost time: 2.357269287109375
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.838886 --> -0.861108).  Saving model ...
Epoch: 16 cost time: 2.273062229156494
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.345 Vali Acc: 0.817 Test Loss: 0.345 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3100426197052
Epoch: 17, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.305 Vali Acc: 0.811 Test Loss: 0.305 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.138598918914795
Epoch: 18, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.309 Vali Acc: 0.822 Test Loss: 0.309 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.329509735107422
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.302 Vali Acc: 0.828 Test Loss: 0.302 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.333995819091797
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.290 Vali Acc: 0.839 Test Loss: 0.290 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1857330799102783
Epoch: 21, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.293 Vali Acc: 0.861 Test Loss: 0.293 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 22 cost time: 1.7557072639465332
Epoch: 22, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.262 Vali Acc: 0.872 Test Loss: 0.262 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872220).  Saving model ...
Epoch: 23 cost time: 1.860832691192627
Epoch: 23, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.314 Vali Acc: 0.861 Test Loss: 0.314 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7676146030426025
Epoch: 24, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.336 Vali Acc: 0.839 Test Loss: 0.336 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2169439792633057
Epoch: 25, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.263 Vali Acc: 0.883 Test Loss: 0.263 Test Acc: 0.883
Validation loss decreased (-0.872220 --> -0.883331).  Saving model ...
Epoch: 26 cost time: 2.158684253692627
Epoch: 26, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.218 Vali Acc: 0.906 Test Loss: 0.218 Test Acc: 0.906
Validation loss decreased (-0.883331 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 2.1644816398620605
Epoch: 27, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.261 Vali Acc: 0.883 Test Loss: 0.261 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0487215518951416
Epoch: 28, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.012129306793213
Epoch: 29, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.226 Vali Acc: 0.878 Test Loss: 0.226 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.07312273979187
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.206 Vali Acc: 0.906 Test Loss: 0.206 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 4700038
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2110893726348877
Epoch: 1, Steps: 12 | Train Loss: 1.877 Vali Loss: 1.815 Vali Acc: 0.272 Test Loss: 1.815 Test Acc: 0.272
Validation loss decreased (inf --> -0.272204).  Saving model ...
Epoch: 2 cost time: 1.4798181056976318
Epoch: 2, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.615 Vali Acc: 0.433 Test Loss: 1.615 Test Acc: 0.433
Validation loss decreased (-0.272204 --> -0.433317).  Saving model ...
Epoch: 3 cost time: 1.4009153842926025
Epoch: 3, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.378 Vali Acc: 0.556 Test Loss: 1.378 Test Acc: 0.556
Validation loss decreased (-0.433317 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 1.365267038345337
Epoch: 4, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.146 Vali Acc: 0.639 Test Loss: 1.146 Test Acc: 0.639
Validation loss decreased (-0.555542 --> -0.638877).  Saving model ...
Epoch: 5 cost time: 1.4841318130493164
Epoch: 5, Steps: 12 | Train Loss: 1.055 Vali Loss: 0.951 Vali Acc: 0.689 Test Loss: 0.951 Test Acc: 0.689
Validation loss decreased (-0.638877 --> -0.688879).  Saving model ...
Epoch: 6 cost time: 1.4058656692504883
Epoch: 6, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
Validation loss decreased (-0.688879 --> -0.727770).  Saving model ...
Epoch: 7 cost time: 1.300271987915039
Epoch: 7, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4465374946594238
Epoch: 8, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.649 Vali Acc: 0.756 Test Loss: 0.649 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.2670888900756836
Epoch: 9, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 1.4095032215118408
Epoch: 10, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.522 Vali Acc: 0.828 Test Loss: 0.522 Test Acc: 0.828
Validation loss decreased (-0.755550 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 1.3303289413452148
Epoch: 11, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.464 Vali Acc: 0.817 Test Loss: 0.464 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2991437911987305
Epoch: 12, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.427 Vali Acc: 0.856 Test Loss: 0.427 Test Acc: 0.856
Validation loss decreased (-0.827773 --> -0.855551).  Saving model ...
Epoch: 13 cost time: 1.4971373081207275
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2900912761688232
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.355 Vali Acc: 0.844 Test Loss: 0.355 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3648416996002197
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.344 Vali Acc: 0.856 Test Loss: 0.344 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.4299519062042236
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.349 Vali Acc: 0.856 Test Loss: 0.349 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3305680751800537
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.2182719707489014
Epoch: 18, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.3662562370300293
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.1924431324005127
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.2920444011688232
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 1.3316943645477295
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.230 Vali Acc: 0.894 Test Loss: 0.230 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2477233409881592
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.173 Vali Acc: 0.939 Test Loss: 0.173 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 1.3898565769195557
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1916100978851318
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2760202884674072
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4422671794891357
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3714039325714111
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 1.3276889324188232
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 1.4876470565795898
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 1389830
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9742681980133057
Epoch: 1, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.831 Vali Acc: 0.194 Test Loss: 1.831 Test Acc: 0.194
Validation loss decreased (inf --> -0.194426).  Saving model ...
Epoch: 2 cost time: 1.4510064125061035
Epoch: 2, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.669 Vali Acc: 0.317 Test Loss: 1.669 Test Acc: 0.317
Validation loss decreased (-0.194426 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 1.6132278442382812
Epoch: 3, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.469 Vali Acc: 0.522 Test Loss: 1.469 Test Acc: 0.522
Validation loss decreased (-0.316650 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 1.47232985496521
Epoch: 4, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.226 Vali Acc: 0.622 Test Loss: 1.226 Test Acc: 0.622
Validation loss decreased (-0.522208 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 1.4781439304351807
Epoch: 5, Steps: 12 | Train Loss: 1.065 Vali Loss: 0.965 Vali Acc: 0.661 Test Loss: 0.965 Test Acc: 0.661
Validation loss decreased (-0.622210 --> -0.661101).  Saving model ...
Epoch: 6 cost time: 1.6373381614685059
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.776 Vali Acc: 0.689 Test Loss: 0.776 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 1.4721689224243164
Epoch: 7, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.670 Vali Acc: 0.739 Test Loss: 0.670 Test Acc: 0.739
Validation loss decreased (-0.688881 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 1.505739450454712
Epoch: 8, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.579 Vali Acc: 0.739 Test Loss: 0.579 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 9 cost time: 1.5263283252716064
Epoch: 9, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.516 Vali Acc: 0.756 Test Loss: 0.516 Test Acc: 0.756
Validation loss decreased (-0.738883 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 1.4975295066833496
Epoch: 10, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.460 Vali Acc: 0.811 Test Loss: 0.460 Test Acc: 0.811
Validation loss decreased (-0.755550 --> -0.811107).  Saving model ...
Epoch: 11 cost time: 1.4295105934143066
Epoch: 11, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.405 Vali Acc: 0.828 Test Loss: 0.405 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.382901668548584
Epoch: 12, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.383 Vali Acc: 0.817 Test Loss: 0.383 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3803985118865967
Epoch: 13, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.3681676387786865
Epoch: 14, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.349 Vali Acc: 0.833 Test Loss: 0.349 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 0.923123836517334
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.330 Vali Acc: 0.850 Test Loss: 0.330 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.618999719619751
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.359 Vali Acc: 0.811 Test Loss: 0.359 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4648070335388184
Epoch: 17, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.313 Vali Acc: 0.806 Test Loss: 0.313 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4854443073272705
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.318 Vali Acc: 0.817 Test Loss: 0.318 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.493811845779419
Epoch: 19, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.312 Vali Acc: 0.822 Test Loss: 0.312 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.365065336227417
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3964886665344238
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 22 cost time: 1.4472463130950928
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.283 Vali Acc: 0.861 Test Loss: 0.283 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 23 cost time: 1.4559810161590576
Epoch: 23, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.349 Vali Acc: 0.861 Test Loss: 0.349 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.519444227218628
Epoch: 24, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.352 Vali Acc: 0.839 Test Loss: 0.352 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3479325771331787
Epoch: 25, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.275 Vali Acc: 0.883 Test Loss: 0.275 Test Acc: 0.883
Validation loss decreased (-0.861108 --> -0.883331).  Saving model ...
Epoch: 26 cost time: 1.390082597732544
Epoch: 26, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
Validation loss decreased (-0.883331 --> -0.899998).  Saving model ...
Epoch: 27 cost time: 1.4000804424285889
Epoch: 27, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
Validation loss decreased (-0.899998 --> -0.911108).  Saving model ...
Epoch: 28 cost time: 1.4960854053497314
Epoch: 28, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.362011194229126
Epoch: 29, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.216 Vali Acc: 0.900 Test Loss: 0.216 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3759651184082031
Epoch: 30, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 4700038
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8714187145233154
Epoch: 1, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.818 Vali Acc: 0.272 Test Loss: 1.818 Test Acc: 0.272
Validation loss decreased (inf --> -0.272204).  Saving model ...
Epoch: 2 cost time: 1.0845773220062256
Epoch: 2, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.623 Vali Acc: 0.422 Test Loss: 1.623 Test Acc: 0.422
Validation loss decreased (-0.272204 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 1.1608598232269287
Epoch: 3, Steps: 12 | Train Loss: 1.519 Vali Loss: 1.391 Vali Acc: 0.550 Test Loss: 1.391 Test Acc: 0.550
Validation loss decreased (-0.422206 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 1.104041337966919
Epoch: 4, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.163 Vali Acc: 0.644 Test Loss: 1.163 Test Acc: 0.644
Validation loss decreased (-0.549986 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 1.1167986392974854
Epoch: 5, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.970 Vali Acc: 0.678 Test Loss: 0.970 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677768).  Saving model ...
Epoch: 6 cost time: 1.1330957412719727
Epoch: 6, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
Validation loss decreased (-0.677768 --> -0.716658).  Saving model ...
Epoch: 7 cost time: 1.1003985404968262
Epoch: 7, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.736 Vali Acc: 0.706 Test Loss: 0.736 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2043955326080322
Epoch: 8, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.716658 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.1920630931854248
Epoch: 9, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.600 Vali Acc: 0.744 Test Loss: 0.600 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0913338661193848
Epoch: 10, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.539 Vali Acc: 0.794 Test Loss: 0.539 Test Acc: 0.794
Validation loss decreased (-0.749993 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 1.1185641288757324
Epoch: 11, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.481 Vali Acc: 0.806 Test Loss: 0.481 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 1.1448915004730225
Epoch: 12, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.444 Vali Acc: 0.839 Test Loss: 0.444 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838884).  Saving model ...
Epoch: 13 cost time: 1.2649710178375244
Epoch: 13, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.411 Vali Acc: 0.828 Test Loss: 0.411 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.115983009338379
Epoch: 14, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.369 Vali Acc: 0.844 Test Loss: 0.369 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844441).  Saving model ...
Epoch: 15 cost time: 1.1247739791870117
Epoch: 15, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.118300199508667
Epoch: 16, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 1.1636724472045898
Epoch: 17, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 1.227207899093628
Epoch: 18, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 19 cost time: 1.137951135635376
Epoch: 19, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 1.140071153640747
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.258 Vali Acc: 0.906 Test Loss: 0.258 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 1.1656062602996826
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.254 Vali Acc: 0.906 Test Loss: 0.254 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 22 cost time: 1.1467726230621338
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2586140632629395
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.184 Vali Acc: 0.939 Test Loss: 0.184 Test Acc: 0.939
Validation loss decreased (-0.905553 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 1.1410763263702393
Epoch: 24, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.332 Vali Acc: 0.917 Test Loss: 0.332 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1486749649047852
Epoch: 25, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.226 Vali Acc: 0.917 Test Loss: 0.226 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1229777336120605
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.342 Vali Acc: 0.911 Test Loss: 0.342 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2010350227355957
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0425152778625488
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.938887 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 1.0613584518432617
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.223 Vali Acc: 0.939 Test Loss: 0.223 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0552337169647217
Epoch: 30, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 1389830
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.904383659362793
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.800 Vali Acc: 0.167 Test Loss: 1.800 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 2.4084036350250244
Epoch: 2, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.624 Vali Acc: 0.389 Test Loss: 1.624 Test Acc: 0.389
Validation loss decreased (-0.166649 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 2.139134168624878
Epoch: 3, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.426 Vali Acc: 0.578 Test Loss: 1.426 Test Acc: 0.578
Validation loss decreased (-0.388873 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 2.1287267208099365
Epoch: 4, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.215 Vali Acc: 0.667 Test Loss: 1.215 Test Acc: 0.667
Validation loss decreased (-0.577764 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 2.2753922939300537
Epoch: 5, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.002 Vali Acc: 0.717 Test Loss: 1.002 Test Acc: 0.717
Validation loss decreased (-0.666655 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 2.3671367168426514
Epoch: 6, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.819 Vali Acc: 0.756 Test Loss: 0.819 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 2.5271661281585693
Epoch: 7, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.684 Vali Acc: 0.767 Test Loss: 0.684 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 2.306389570236206
Epoch: 8, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.578 Vali Acc: 0.794 Test Loss: 0.578 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794439).  Saving model ...
Epoch: 9 cost time: 2.111891746520996
Epoch: 9, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.484 Vali Acc: 0.811 Test Loss: 0.484 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811106).  Saving model ...
Epoch: 10 cost time: 2.171121120452881
Epoch: 10, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.423 Vali Acc: 0.839 Test Loss: 0.423 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 2.3297712802886963
Epoch: 11, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 2.357525110244751
Epoch: 12, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 2.149489164352417
Epoch: 13, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.134558916091919
Epoch: 14, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.248049259185791
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4051411151885986
Epoch: 16, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0520811080932617
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 2.169259786605835
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 2.290430784225464
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 2.308549165725708
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2730348110198975
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 2.1647331714630127
Epoch: 22, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 2.437410593032837
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.173083782196045
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.182518720626831
Epoch: 25, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 2.012089490890503
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 1.923912525177002
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9632477760314941
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.235 Vali Acc: 0.939 Test Loss: 0.235 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 2.0020387172698975
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.290 Vali Acc: 0.928 Test Loss: 0.290 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.2655837535858154
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2356358
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1698949337005615
Epoch: 1, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.822 Vali Acc: 0.211 Test Loss: 1.822 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.3759515285491943
Epoch: 2, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.669 Vali Acc: 0.378 Test Loss: 1.669 Test Acc: 0.378
Validation loss decreased (-0.211093 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 1.686650276184082
Epoch: 3, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.490 Vali Acc: 0.533 Test Loss: 1.490 Test Acc: 0.533
Validation loss decreased (-0.377761 --> -0.533318).  Saving model ...
Epoch: 4 cost time: 1.4510257244110107
Epoch: 4, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.281 Vali Acc: 0.672 Test Loss: 1.281 Test Acc: 0.672
Validation loss decreased (-0.533318 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 1.5924630165100098
Epoch: 5, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.073 Vali Acc: 0.739 Test Loss: 1.073 Test Acc: 0.739
Validation loss decreased (-0.672209 --> -0.738878).  Saving model ...
Epoch: 6 cost time: 1.3739581108093262
Epoch: 6, Steps: 12 | Train Loss: 0.971 Vali Loss: 0.879 Vali Acc: 0.772 Test Loss: 0.879 Test Acc: 0.772
Validation loss decreased (-0.738878 --> -0.772213).  Saving model ...
Epoch: 7 cost time: 1.585951328277588
Epoch: 7, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783326).  Saving model ...
Epoch: 8 cost time: 1.4412107467651367
Epoch: 8, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.632 Vali Acc: 0.772 Test Loss: 0.632 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5572869777679443
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.551 Vali Acc: 0.778 Test Loss: 0.551 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4536292552947998
Epoch: 10, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.497 Vali Acc: 0.800 Test Loss: 0.497 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 1.282149076461792
Epoch: 11, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 1.2659893035888672
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.408 Vali Acc: 0.844 Test Loss: 0.408 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 1.35062837600708
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3501336574554443
Epoch: 14, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3087646961212158
Epoch: 15, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.357649326324463
Epoch: 16, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 1.4487643241882324
Epoch: 17, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.304 Vali Acc: 0.861 Test Loss: 0.304 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.5221729278564453
Epoch: 18, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.311 Vali Acc: 0.828 Test Loss: 0.311 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3890798091888428
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.283 Vali Acc: 0.867 Test Loss: 0.283 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.4434618949890137
Epoch: 20, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 1.4329988956451416
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.252 Vali Acc: 0.878 Test Loss: 0.252 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4032986164093018
Epoch: 22, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.219 Vali Acc: 0.894 Test Loss: 0.219 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 1.4444942474365234
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.241 Vali Acc: 0.894 Test Loss: 0.241 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5270650386810303
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.248 Vali Acc: 0.883 Test Loss: 0.248 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3910126686096191
Epoch: 25, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.3920657634735107
Epoch: 26, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5140795707702637
Epoch: 27, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.230 Vali Acc: 0.883 Test Loss: 0.230 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4881207942962646
Epoch: 28, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3747859001159668
Epoch: 29, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 30 cost time: 1.519951581954956
Epoch: 30, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.235 Vali Acc: 0.878 Test Loss: 0.235 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 701190
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.327080249786377
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.800 Vali Acc: 0.167 Test Loss: 1.800 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.7150709629058838
Epoch: 2, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.624 Vali Acc: 0.389 Test Loss: 1.624 Test Acc: 0.389
Validation loss decreased (-0.166649 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 1.753803014755249
Epoch: 3, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.426 Vali Acc: 0.578 Test Loss: 1.426 Test Acc: 0.578
Validation loss decreased (-0.388873 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 1.752720594406128
Epoch: 4, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.215 Vali Acc: 0.667 Test Loss: 1.215 Test Acc: 0.667
Validation loss decreased (-0.577764 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 1.9071199893951416
Epoch: 5, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.002 Vali Acc: 0.717 Test Loss: 1.002 Test Acc: 0.717
Validation loss decreased (-0.666655 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 1.8711087703704834
Epoch: 6, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.819 Vali Acc: 0.756 Test Loss: 0.819 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 1.7880403995513916
Epoch: 7, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.684 Vali Acc: 0.767 Test Loss: 0.684 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766660).  Saving model ...
Epoch: 8 cost time: 1.8189570903778076
Epoch: 8, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.578 Vali Acc: 0.794 Test Loss: 0.578 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794439).  Saving model ...
Epoch: 9 cost time: 1.8029005527496338
Epoch: 9, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.484 Vali Acc: 0.811 Test Loss: 0.484 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811106).  Saving model ...
Epoch: 10 cost time: 1.8857405185699463
Epoch: 10, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.423 Vali Acc: 0.839 Test Loss: 0.423 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 1.8750028610229492
Epoch: 11, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 12 cost time: 1.979490041732788
Epoch: 12, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.338 Vali Acc: 0.883 Test Loss: 0.338 Test Acc: 0.883
Validation loss decreased (-0.844441 --> -0.883330).  Saving model ...
Epoch: 13 cost time: 1.8495008945465088
Epoch: 13, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7660322189331055
Epoch: 14, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8787167072296143
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.324 Vali Acc: 0.872 Test Loss: 0.324 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8045213222503662
Epoch: 16, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.291 Vali Acc: 0.861 Test Loss: 0.291 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8086717128753662
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.255 Vali Acc: 0.889 Test Loss: 0.255 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 2.0286567211151123
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 1.9861979484558105
Epoch: 19, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 1.894482135772705
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.254 Vali Acc: 0.894 Test Loss: 0.254 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7622966766357422
Epoch: 21, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 1.7228617668151855
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 1.7356617450714111
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7459721565246582
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7179584503173828
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 1.9952425956726074
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 1.78989577293396
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8044383525848389
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.234 Vali Acc: 0.939 Test Loss: 0.234 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 29 cost time: 1.9240832328796387
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.290 Vali Acc: 0.928 Test Loss: 0.290 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8222675323486328
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2356358
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0894415378570557
Epoch: 1, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.822 Vali Acc: 0.211 Test Loss: 1.822 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.189814805984497
Epoch: 2, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.669 Vali Acc: 0.378 Test Loss: 1.669 Test Acc: 0.378
Validation loss decreased (-0.211093 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 1.1564946174621582
Epoch: 3, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.490 Vali Acc: 0.533 Test Loss: 1.490 Test Acc: 0.533
Validation loss decreased (-0.377761 --> -0.533318).  Saving model ...
Epoch: 4 cost time: 1.1258869171142578
Epoch: 4, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.281 Vali Acc: 0.672 Test Loss: 1.281 Test Acc: 0.672
Validation loss decreased (-0.533318 --> -0.672209).  Saving model ...
Epoch: 5 cost time: 1.2420718669891357
Epoch: 5, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.073 Vali Acc: 0.739 Test Loss: 1.073 Test Acc: 0.739
Validation loss decreased (-0.672209 --> -0.738878).  Saving model ...
Epoch: 6 cost time: 1.381321668624878
Epoch: 6, Steps: 12 | Train Loss: 0.971 Vali Loss: 0.879 Vali Acc: 0.772 Test Loss: 0.879 Test Acc: 0.772
Validation loss decreased (-0.738878 --> -0.772213).  Saving model ...
Epoch: 7 cost time: 1.2496354579925537
Epoch: 7, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783326).  Saving model ...
Epoch: 8 cost time: 1.3245530128479004
Epoch: 8, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.632 Vali Acc: 0.772 Test Loss: 0.632 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2542047500610352
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.551 Vali Acc: 0.778 Test Loss: 0.551 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2353527545928955
Epoch: 10, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.497 Vali Acc: 0.800 Test Loss: 0.497 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 1.2924909591674805
Epoch: 11, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.451 Vali Acc: 0.828 Test Loss: 0.451 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 12 cost time: 1.2452521324157715
Epoch: 12, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.408 Vali Acc: 0.844 Test Loss: 0.408 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 1.3576905727386475
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2301771640777588
Epoch: 14, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2478067874908447
Epoch: 15, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.345 Vali Acc: 0.850 Test Loss: 0.345 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.2395179271697998
Epoch: 16, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 1.289625883102417
Epoch: 17, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.307 Vali Acc: 0.861 Test Loss: 0.307 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 18 cost time: 1.3807117938995361
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.316 Vali Acc: 0.828 Test Loss: 0.316 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1707415580749512
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.288 Vali Acc: 0.867 Test Loss: 0.288 Test Acc: 0.867
Validation loss decreased (-0.861108 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.4729361534118652
Epoch: 20, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.257 Vali Acc: 0.894 Test Loss: 0.257 Test Acc: 0.894
Validation loss decreased (-0.866664 --> -0.894442).  Saving model ...
Epoch: 21 cost time: 1.248711109161377
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.256 Vali Acc: 0.872 Test Loss: 0.256 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2136282920837402
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.222 Vali Acc: 0.889 Test Loss: 0.222 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3771378993988037
Epoch: 23, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.243 Vali Acc: 0.889 Test Loss: 0.243 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2929627895355225
Epoch: 24, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1422233581542969
Epoch: 25, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.195 Vali Acc: 0.922 Test Loss: 0.195 Test Acc: 0.922
Validation loss decreased (-0.894442 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.2497904300689697
Epoch: 26, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4207141399383545
Epoch: 27, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.236 Vali Acc: 0.883 Test Loss: 0.236 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1746068000793457
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2703616619110107
Epoch: 29, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 30 cost time: 1.347768783569336
Epoch: 30, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.234 Vali Acc: 0.878 Test Loss: 0.234 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 701190
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.637631416320801
Epoch: 1, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.801 Vali Acc: 0.167 Test Loss: 1.801 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.272538185119629
Epoch: 2, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.628 Vali Acc: 0.383 Test Loss: 1.628 Test Acc: 0.383
Validation loss decreased (-0.166649 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 1.374878168106079
Epoch: 3, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.433 Vali Acc: 0.561 Test Loss: 1.433 Test Acc: 0.561
Validation loss decreased (-0.383317 --> -0.561097).  Saving model ...
Epoch: 4 cost time: 1.2251760959625244
Epoch: 4, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.226 Vali Acc: 0.656 Test Loss: 1.226 Test Acc: 0.656
Validation loss decreased (-0.561097 --> -0.655543).  Saving model ...
Epoch: 5 cost time: 1.339982509613037
Epoch: 5, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.655543 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.1930747032165527
Epoch: 6, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.836 Vali Acc: 0.739 Test Loss: 0.836 Test Acc: 0.739
Validation loss decreased (-0.699990 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 1.234330177307129
Epoch: 7, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.705 Vali Acc: 0.744 Test Loss: 0.705 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 1.1725757122039795
Epoch: 8, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.600 Vali Acc: 0.778 Test Loss: 0.600 Test Acc: 0.778
Validation loss decreased (-0.744437 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 1.14162278175354
Epoch: 9, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.506 Vali Acc: 0.800 Test Loss: 0.506 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 1.1135752201080322
Epoch: 10, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.442 Vali Acc: 0.828 Test Loss: 0.442 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 1.2309072017669678
Epoch: 11, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 1.245572566986084
Epoch: 12, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
Validation loss decreased (-0.833329 --> -0.877774).  Saving model ...
Epoch: 13 cost time: 1.2607405185699463
Epoch: 13, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.341 Vali Acc: 0.850 Test Loss: 0.341 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3810029029846191
Epoch: 14, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.306 Vali Acc: 0.867 Test Loss: 0.306 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9014737606048584
Epoch: 15, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2771365642547607
Epoch: 16, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.300 Vali Acc: 0.861 Test Loss: 0.300 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4516427516937256
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 1.392279863357544
Epoch: 18, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 1.3838896751403809
Epoch: 19, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 1.3695094585418701
Epoch: 20, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4303598403930664
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 1.3947234153747559
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 1.395155429840088
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3356754779815674
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4085259437561035
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.315 Vali Acc: 0.928 Test Loss: 0.315 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 1.3672904968261719
Epoch: 26, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 1.390535831451416
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.371 Vali Acc: 0.906 Test Loss: 0.371 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.358720064163208
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.245 Vali Acc: 0.939 Test Loss: 0.245 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 29 cost time: 1.380340337753296
Epoch: 29, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3744559288024902
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.939 Test Loss: 0.256 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 2356358
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.508692979812622
Epoch: 1, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.821 Vali Acc: 0.211 Test Loss: 1.821 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.1113591194152832
Epoch: 2, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.669 Vali Acc: 0.372 Test Loss: 1.669 Test Acc: 0.372
Validation loss decreased (-0.211093 --> -0.372206).  Saving model ...
Epoch: 3 cost time: 1.05556058883667
Epoch: 3, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.491 Vali Acc: 0.528 Test Loss: 1.491 Test Acc: 0.528
Validation loss decreased (-0.372206 --> -0.527763).  Saving model ...
Epoch: 4 cost time: 1.010382890701294
Epoch: 4, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.284 Vali Acc: 0.667 Test Loss: 1.284 Test Acc: 0.667
Validation loss decreased (-0.527763 --> -0.666654).  Saving model ...
Epoch: 5 cost time: 1.1215589046478271
Epoch: 5, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.078 Vali Acc: 0.728 Test Loss: 1.078 Test Acc: 0.728
Validation loss decreased (-0.666654 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 1.0190207958221436
Epoch: 6, Steps: 12 | Train Loss: 0.971 Vali Loss: 0.884 Vali Acc: 0.761 Test Loss: 0.884 Test Acc: 0.761
Validation loss decreased (-0.727767 --> -0.761102).  Saving model ...
Epoch: 7 cost time: 1.0175819396972656
Epoch: 7, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772215).  Saving model ...
Epoch: 8 cost time: 0.9303224086761475
Epoch: 8, Steps: 12 | Train Loss: 0.638 Vali Loss: 0.640 Vali Acc: 0.767 Test Loss: 0.640 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0652942657470703
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.558 Vali Acc: 0.767 Test Loss: 0.558 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0580642223358154
Epoch: 10, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 0.9611215591430664
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.462 Vali Acc: 0.822 Test Loss: 0.462 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 1.0136761665344238
Epoch: 12, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.419 Vali Acc: 0.839 Test Loss: 0.419 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 1.1215155124664307
Epoch: 13, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.400 Vali Acc: 0.828 Test Loss: 0.400 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0493016242980957
Epoch: 14, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.374 Vali Acc: 0.833 Test Loss: 0.374 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.988654613494873
Epoch: 15, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.360 Vali Acc: 0.844 Test Loss: 0.360 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 1.0666520595550537
Epoch: 16, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 17 cost time: 1.0158851146697998
Epoch: 17, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.327 Vali Acc: 0.856 Test Loss: 0.327 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 0.9861752986907959
Epoch: 18, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.128274917602539
Epoch: 19, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.319 Vali Acc: 0.861 Test Loss: 0.319 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 1.0326199531555176
Epoch: 20, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 21 cost time: 1.1358284950256348
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.281 Vali Acc: 0.878 Test Loss: 0.281 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0972797870635986
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 1.0444269180297852
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0182721614837646
Epoch: 24, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.297 Vali Acc: 0.867 Test Loss: 0.297 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0225763320922852
Epoch: 25, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 1.0066306591033936
Epoch: 26, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.310 Vali Acc: 0.883 Test Loss: 0.310 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0091054439544678
Epoch: 27, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.270 Vali Acc: 0.872 Test Loss: 0.270 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.017313003540039
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0329976081848145
Epoch: 29, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938887).  Saving model ...
Epoch: 30 cost time: 1.0369176864624023
Epoch: 30, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.249 Vali Acc: 0.889 Test Loss: 0.249 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 701190
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5791306495666504
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.699 Vali Acc: 0.322 Test Loss: 1.699 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 1.6955995559692383
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.566 Vali Acc: 0.456 Test Loss: 1.566 Test Acc: 0.456
Validation loss decreased (-0.322205 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 1.8431625366210938
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.408 Vali Acc: 0.528 Test Loss: 1.408 Test Acc: 0.528
Validation loss decreased (-0.455540 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.7515811920166016
Epoch: 4, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.234 Vali Acc: 0.633 Test Loss: 1.234 Test Acc: 0.633
Validation loss decreased (-0.527764 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 1.7364869117736816
Epoch: 5, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.050 Vali Acc: 0.667 Test Loss: 1.050 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 1.8331494331359863
Epoch: 6, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.879 Vali Acc: 0.683 Test Loss: 0.879 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 1.834125280380249
Epoch: 7, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.748 Vali Acc: 0.689 Test Loss: 0.748 Test Acc: 0.689
Validation loss decreased (-0.683325 --> -0.688881).  Saving model ...
Epoch: 8 cost time: 1.7598190307617188
Epoch: 8, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722216).  Saving model ...
Epoch: 9 cost time: 1.6773202419281006
Epoch: 9, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.722216 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.6559498310089111
Epoch: 10, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
Validation loss decreased (-0.722216 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.6712892055511475
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.469 Vali Acc: 0.772 Test Loss: 0.469 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.756110668182373
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.5801620483398438
Epoch: 13, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.5891096591949463
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.6352202892303467
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5148799419403076
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.352 Vali Acc: 0.800 Test Loss: 0.352 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.693124532699585
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.347 Vali Acc: 0.811 Test Loss: 0.347 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.609889030456543
Epoch: 18, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.338 Vali Acc: 0.811 Test Loss: 0.338 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6687791347503662
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.339 Vali Acc: 0.822 Test Loss: 0.339 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6851890087127686
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.340 Vali Acc: 0.794 Test Loss: 0.340 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6211879253387451
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.333 Vali Acc: 0.811 Test Loss: 0.333 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8302364349365234
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.414 Vali Acc: 0.822 Test Loss: 0.414 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7541422843933105
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.337 Vali Acc: 0.828 Test Loss: 0.337 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7072820663452148
Epoch: 24, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.336 Vali Acc: 0.817 Test Loss: 0.336 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 1184518
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9188790321350098
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.747 Vali Acc: 0.244 Test Loss: 1.747 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.4687471389770508
Epoch: 2, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.594 Vali Acc: 0.500 Test Loss: 1.594 Test Acc: 0.500
Validation loss decreased (-0.244427 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.3341434001922607
Epoch: 3, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.407 Vali Acc: 0.583 Test Loss: 1.407 Test Acc: 0.583
Validation loss decreased (-0.499984 --> -0.583319).  Saving model ...
Epoch: 4 cost time: 1.3334484100341797
Epoch: 4, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.207 Vali Acc: 0.667 Test Loss: 1.207 Test Acc: 0.667
Validation loss decreased (-0.583319 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 1.4293577671051025
Epoch: 5, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.019 Vali Acc: 0.672 Test Loss: 1.019 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 1.3665614128112793
Epoch: 6, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.851 Vali Acc: 0.756 Test Loss: 0.851 Test Acc: 0.756
Validation loss decreased (-0.672212 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 1.3369135856628418
Epoch: 7, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.720 Vali Acc: 0.756 Test Loss: 0.720 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 8 cost time: 1.3123970031738281
Epoch: 8, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.616 Vali Acc: 0.761 Test Loss: 0.616 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 1.332705020904541
Epoch: 9, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.3242766857147217
Epoch: 10, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.457 Vali Acc: 0.783 Test Loss: 0.457 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3281316757202148
Epoch: 11, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.408 Vali Acc: 0.828 Test Loss: 0.408 Test Acc: 0.828
Validation loss decreased (-0.788884 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 1.3039803504943848
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 13 cost time: 1.3378970623016357
Epoch: 13, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838886).  Saving model ...
Epoch: 14 cost time: 1.3088631629943848
Epoch: 14, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.345 Vali Acc: 0.817 Test Loss: 0.345 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.322378158569336
Epoch: 15, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
Validation loss decreased (-0.838886 --> -0.849997).  Saving model ...
Epoch: 16 cost time: 1.325289011001587
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
Validation loss decreased (-0.849997 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 1.4179964065551758
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2167487144470215
Epoch: 18, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 19 cost time: 1.2878260612487793
Epoch: 19, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855553).  Saving model ...
Epoch: 20 cost time: 1.2947418689727783
Epoch: 20, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.305 Vali Acc: 0.883 Test Loss: 0.305 Test Acc: 0.883
Validation loss decreased (-0.855553 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 1.2261624336242676
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 1.320345401763916
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3538484573364258
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.968358039855957
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.312 Vali Acc: 0.883 Test Loss: 0.312 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3259692192077637
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2843480110168457
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 27 cost time: 1.3212621212005615
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3541605472564697
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2586982250213623
Epoch: 29, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.368 Vali Acc: 0.856 Test Loss: 0.368 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3723983764648438
Epoch: 30, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.318 Vali Acc: 0.878 Test Loss: 0.318 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 356870
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0311243534088135
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.699 Vali Acc: 0.322 Test Loss: 1.699 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 1.4573280811309814
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.566 Vali Acc: 0.456 Test Loss: 1.566 Test Acc: 0.456
Validation loss decreased (-0.322205 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 1.4897243976593018
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.408 Vali Acc: 0.528 Test Loss: 1.408 Test Acc: 0.528
Validation loss decreased (-0.455540 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.4762661457061768
Epoch: 4, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.234 Vali Acc: 0.633 Test Loss: 1.234 Test Acc: 0.633
Validation loss decreased (-0.527764 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 1.4713530540466309
Epoch: 5, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.050 Vali Acc: 0.667 Test Loss: 1.050 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 1.5270099639892578
Epoch: 6, Steps: 12 | Train Loss: 0.952 Vali Loss: 0.879 Vali Acc: 0.683 Test Loss: 0.879 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 1.5670111179351807
Epoch: 7, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.748 Vali Acc: 0.689 Test Loss: 0.748 Test Acc: 0.689
Validation loss decreased (-0.683325 --> -0.688881).  Saving model ...
Epoch: 8 cost time: 1.532949447631836
Epoch: 8, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722216).  Saving model ...
Epoch: 9 cost time: 1.5141706466674805
Epoch: 9, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.722216 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.4975521564483643
Epoch: 10, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
Validation loss decreased (-0.722216 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.4859979152679443
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.469 Vali Acc: 0.772 Test Loss: 0.469 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4428398609161377
Epoch: 12, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.4257817268371582
Epoch: 13, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.408 Vali Acc: 0.811 Test Loss: 0.408 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.4578266143798828
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.382 Vali Acc: 0.839 Test Loss: 0.382 Test Acc: 0.839
Validation loss decreased (-0.811107 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 1.5928092002868652
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.367 Vali Acc: 0.817 Test Loss: 0.367 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4655139446258545
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.352 Vali Acc: 0.800 Test Loss: 0.352 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5172913074493408
Epoch: 17, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.347 Vali Acc: 0.811 Test Loss: 0.347 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3784849643707275
Epoch: 18, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.338 Vali Acc: 0.811 Test Loss: 0.338 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4503161907196045
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.514949083328247
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.340 Vali Acc: 0.794 Test Loss: 0.340 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.663146734237671
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.334 Vali Acc: 0.806 Test Loss: 0.334 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5094130039215088
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.415 Vali Acc: 0.822 Test Loss: 0.415 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6832425594329834
Epoch: 23, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.338 Vali Acc: 0.822 Test Loss: 0.338 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4623010158538818
Epoch: 24, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.338 Vali Acc: 0.817 Test Loss: 0.338 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 1184518
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.778522253036499
Epoch: 1, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.747 Vali Acc: 0.244 Test Loss: 1.747 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.2414705753326416
Epoch: 2, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.594 Vali Acc: 0.500 Test Loss: 1.594 Test Acc: 0.500
Validation loss decreased (-0.244427 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.348282814025879
Epoch: 3, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.407 Vali Acc: 0.583 Test Loss: 1.407 Test Acc: 0.583
Validation loss decreased (-0.499984 --> -0.583319).  Saving model ...
Epoch: 4 cost time: 1.2549340724945068
Epoch: 4, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.207 Vali Acc: 0.667 Test Loss: 1.207 Test Acc: 0.667
Validation loss decreased (-0.583319 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 1.4006457328796387
Epoch: 5, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.019 Vali Acc: 0.672 Test Loss: 1.019 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 1.3425993919372559
Epoch: 6, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.851 Vali Acc: 0.756 Test Loss: 0.851 Test Acc: 0.756
Validation loss decreased (-0.672212 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 1.3437726497650146
Epoch: 7, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.720 Vali Acc: 0.756 Test Loss: 0.720 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755548).  Saving model ...
Epoch: 8 cost time: 1.3360161781311035
Epoch: 8, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.618 Vali Acc: 0.761 Test Loss: 0.618 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 1.356576681137085
Epoch: 9, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788884).  Saving model ...
Epoch: 10 cost time: 1.5114142894744873
Epoch: 10, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.467 Vali Acc: 0.789 Test Loss: 0.467 Test Acc: 0.789
Validation loss decreased (-0.788884 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 1.285935878753662
Epoch: 11, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.423 Vali Acc: 0.822 Test Loss: 0.423 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 1.4361209869384766
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.373 Vali Acc: 0.822 Test Loss: 0.373 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 1.3062245845794678
Epoch: 13, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 1.2869012355804443
Epoch: 14, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.342 Vali Acc: 0.833 Test Loss: 0.342 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 1.5045890808105469
Epoch: 15, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 16 cost time: 1.3491415977478027
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.315 Vali Acc: 0.856 Test Loss: 0.315 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4989993572235107
Epoch: 17, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4475657939910889
Epoch: 18, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2729804515838623
Epoch: 19, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.309 Vali Acc: 0.867 Test Loss: 0.309 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 20 cost time: 1.3526604175567627
Epoch: 20, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
Validation loss decreased (-0.866664 --> -0.872219).  Saving model ...
Epoch: 21 cost time: 1.2849242687225342
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 1.363114833831787
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.295 Vali Acc: 0.867 Test Loss: 0.295 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.221954107284546
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 24 cost time: 1.4083671569824219
Epoch: 24, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.329 Vali Acc: 0.872 Test Loss: 0.329 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2623674869537354
Epoch: 25, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.375 Vali Acc: 0.856 Test Loss: 0.375 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3206231594085693
Epoch: 26, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.267113447189331
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.299 Vali Acc: 0.878 Test Loss: 0.299 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3072824478149414
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3714540004730225
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.369 Vali Acc: 0.856 Test Loss: 0.369 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2636268138885498
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.314 Vali Acc: 0.883 Test Loss: 0.314 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 356870
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.79681396484375
Epoch: 1, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.699 Vali Acc: 0.322 Test Loss: 1.699 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 1.2327442169189453
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.565 Vali Acc: 0.456 Test Loss: 1.565 Test Acc: 0.456
Validation loss decreased (-0.322205 --> -0.455540).  Saving model ...
Epoch: 3 cost time: 1.1017475128173828
Epoch: 3, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.408 Vali Acc: 0.528 Test Loss: 1.408 Test Acc: 0.528
Validation loss decreased (-0.455540 --> -0.527764).  Saving model ...
Epoch: 4 cost time: 1.2659416198730469
Epoch: 4, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.235 Vali Acc: 0.633 Test Loss: 1.235 Test Acc: 0.633
Validation loss decreased (-0.527764 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 1.1796252727508545
Epoch: 5, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.051 Vali Acc: 0.667 Test Loss: 1.051 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 1.1722822189331055
Epoch: 6, Steps: 12 | Train Loss: 0.953 Vali Loss: 0.879 Vali Acc: 0.683 Test Loss: 0.879 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683325).  Saving model ...
Epoch: 7 cost time: 1.1543993949890137
Epoch: 7, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.749 Vali Acc: 0.689 Test Loss: 0.749 Test Acc: 0.689
Validation loss decreased (-0.683325 --> -0.688881).  Saving model ...
Epoch: 8 cost time: 1.0888183116912842
Epoch: 8, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722216).  Saving model ...
Epoch: 9 cost time: 1.180562973022461
Epoch: 9, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.722216 --> -0.722216).  Saving model ...
Epoch: 10 cost time: 1.142688274383545
Epoch: 10, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
Validation loss decreased (-0.722216 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 1.1331546306610107
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.470 Vali Acc: 0.767 Test Loss: 0.470 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0900673866271973
Epoch: 12, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.432 Vali Acc: 0.800 Test Loss: 0.432 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799996).  Saving model ...
Epoch: 13 cost time: 1.0839133262634277
Epoch: 13, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.407 Vali Acc: 0.811 Test Loss: 0.407 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 1.0681431293487549
Epoch: 14, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 15 cost time: 1.146855354309082
Epoch: 15, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.102097511291504
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.345 Vali Acc: 0.800 Test Loss: 0.345 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1522433757781982
Epoch: 17, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.340 Vali Acc: 0.811 Test Loss: 0.340 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.166522741317749
Epoch: 18, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.327 Vali Acc: 0.817 Test Loss: 0.327 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.100672960281372
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.324 Vali Acc: 0.833 Test Loss: 0.324 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 20 cost time: 1.1034789085388184
Epoch: 20, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.321 Vali Acc: 0.811 Test Loss: 0.321 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2152645587921143
Epoch: 21, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.309 Vali Acc: 0.817 Test Loss: 0.309 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.116297721862793
Epoch: 22, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1561238765716553
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.308 Vali Acc: 0.822 Test Loss: 0.308 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1284723281860352
Epoch: 24, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.309 Vali Acc: 0.828 Test Loss: 0.309 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1539568901062012
Epoch: 25, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.317 Vali Acc: 0.856 Test Loss: 0.317 Test Acc: 0.856
Validation loss decreased (-0.833330 --> -0.855552).  Saving model ...
Epoch: 26 cost time: 1.2610020637512207
Epoch: 26, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.290 Vali Acc: 0.867 Test Loss: 0.290 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866664).  Saving model ...
Epoch: 27 cost time: 1.1442391872406006
Epoch: 27, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1378164291381836
Epoch: 28, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.276 Vali Acc: 0.856 Test Loss: 0.276 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1829886436462402
Epoch: 29, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
Validation loss decreased (-0.866664 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 1.2099969387054443
Epoch: 30, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1184518
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6690354347229004
Epoch: 1, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.743 Vali Acc: 0.256 Test Loss: 1.743 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 1.0922036170959473
Epoch: 2, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.592 Vali Acc: 0.500 Test Loss: 1.592 Test Acc: 0.500
Validation loss decreased (-0.255538 --> -0.499984).  Saving model ...
Epoch: 3 cost time: 1.0948264598846436
Epoch: 3, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.409 Vali Acc: 0.583 Test Loss: 1.409 Test Acc: 0.583
Validation loss decreased (-0.499984 --> -0.583319).  Saving model ...
Epoch: 4 cost time: 1.0340936183929443
Epoch: 4, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.213 Vali Acc: 0.661 Test Loss: 1.213 Test Acc: 0.661
Validation loss decreased (-0.583319 --> -0.661099).  Saving model ...
Epoch: 5 cost time: 0.901909351348877
Epoch: 5, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.030 Vali Acc: 0.672 Test Loss: 1.030 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672212).  Saving model ...
Epoch: 6 cost time: 1.046654462814331
Epoch: 6, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.867 Vali Acc: 0.739 Test Loss: 0.867 Test Acc: 0.739
Validation loss decreased (-0.672212 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.9964728355407715
Epoch: 7, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0545687675476074
Epoch: 8, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.648 Vali Acc: 0.739 Test Loss: 0.648 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 1.0052223205566406
Epoch: 9, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.577 Vali Acc: 0.778 Test Loss: 0.577 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 1.0279223918914795
Epoch: 10, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.519 Vali Acc: 0.778 Test Loss: 0.519 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 11 cost time: 1.1359734535217285
Epoch: 11, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.482 Vali Acc: 0.783 Test Loss: 0.482 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 12 cost time: 0.9731931686401367
Epoch: 12, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.438 Vali Acc: 0.811 Test Loss: 0.438 Test Acc: 0.811
Validation loss decreased (-0.783329 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 1.0183556079864502
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.407 Vali Acc: 0.806 Test Loss: 0.407 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9626021385192871
Epoch: 14, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.393 Vali Acc: 0.811 Test Loss: 0.393 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 1.0250341892242432
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833330).  Saving model ...
Epoch: 16 cost time: 1.058171033859253
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.354 Vali Acc: 0.844 Test Loss: 0.354 Test Acc: 0.844
Validation loss decreased (-0.833330 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 0.982337474822998
Epoch: 17, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
Validation loss decreased (-0.844441 --> -0.866663).  Saving model ...
Epoch: 18 cost time: 1.06982421875
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.327 Vali Acc: 0.872 Test Loss: 0.327 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 1.1122236251831055
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0287013053894043
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 21 cost time: 1.1517863273620605
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.302 Vali Acc: 0.856 Test Loss: 0.302 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0922431945800781
Epoch: 22, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.877775 --> -0.877775).  Saving model ...
Epoch: 23 cost time: 1.1286935806274414
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
Validation loss decreased (-0.877775 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 0.9901113510131836
Epoch: 24, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1293668746948242
Epoch: 25, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.283 Vali Acc: 0.889 Test Loss: 0.283 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0113306045532227
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927775).  Saving model ...
Epoch: 27 cost time: 1.071606159210205
Epoch: 27, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9997930526733398
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0340075492858887
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0088741779327393
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 356870
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4320504665374756
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.782 Vali Acc: 0.200 Test Loss: 1.782 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.8637347221374512
Epoch: 2, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.698 Vali Acc: 0.322 Test Loss: 1.698 Test Acc: 0.322
Validation loss decreased (-0.199982 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 1.9088613986968994
Epoch: 3, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.593 Vali Acc: 0.472 Test Loss: 1.593 Test Acc: 0.472
Validation loss decreased (-0.322205 --> -0.472206).  Saving model ...
Epoch: 4 cost time: 1.7616674900054932
Epoch: 4, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.470 Vali Acc: 0.611 Test Loss: 1.470 Test Acc: 0.611
Validation loss decreased (-0.472206 --> -0.611096).  Saving model ...
Epoch: 5 cost time: 1.7725763320922852
Epoch: 5, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.325 Vali Acc: 0.706 Test Loss: 1.325 Test Acc: 0.706
Validation loss decreased (-0.611096 --> -0.705542).  Saving model ...
Epoch: 6 cost time: 2.0289299488067627
Epoch: 6, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.170 Vali Acc: 0.728 Test Loss: 1.170 Test Acc: 0.728
Validation loss decreased (-0.705542 --> -0.727766).  Saving model ...
Epoch: 7 cost time: 1.871514081954956
Epoch: 7, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7362048625946045
Epoch: 8, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.912 Vali Acc: 0.711 Test Loss: 0.912 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.722792625427246
Epoch: 9, Steps: 12 | Train Loss: 0.820 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
Validation loss decreased (-0.727766 --> -0.733325).  Saving model ...
Epoch: 10 cost time: 2.065561056137085
Epoch: 10, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.701 Vali Acc: 0.733 Test Loss: 0.701 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 11 cost time: 1.9385695457458496
Epoch: 11, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.590 Vali Acc: 0.761 Test Loss: 0.590 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 1.8264563083648682
Epoch: 12, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788884).  Saving model ...
Epoch: 13 cost time: 1.7803385257720947
Epoch: 13, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799996).  Saving model ...
Epoch: 14 cost time: 1.8110852241516113
Epoch: 14, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.413 Vali Acc: 0.811 Test Loss: 0.413 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 15 cost time: 1.9913578033447266
Epoch: 15, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.388 Vali Acc: 0.811 Test Loss: 0.388 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 16 cost time: 1.9677529335021973
Epoch: 16, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.372 Vali Acc: 0.806 Test Loss: 0.372 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7884809970855713
Epoch: 17, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.366 Vali Acc: 0.811 Test Loss: 0.366 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 18 cost time: 1.7364320755004883
Epoch: 18, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.357 Vali Acc: 0.817 Test Loss: 0.357 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816663).  Saving model ...
Epoch: 19 cost time: 1.74082612991333
Epoch: 19, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.358 Vali Acc: 0.817 Test Loss: 0.358 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9082763195037842
Epoch: 20, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.357 Vali Acc: 0.811 Test Loss: 0.357 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7385549545288086
Epoch: 21, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.347 Vali Acc: 0.817 Test Loss: 0.347 Test Acc: 0.817
Validation loss decreased (-0.816663 --> -0.816663).  Saving model ...
Epoch: 22 cost time: 1.8843154907226562
Epoch: 22, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.348 Vali Acc: 0.806 Test Loss: 0.348 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9052894115447998
Epoch: 23, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.334 Vali Acc: 0.828 Test Loss: 0.334 Test Acc: 0.828
Validation loss decreased (-0.816663 --> -0.827774).  Saving model ...
Epoch: 24 cost time: 1.856752634048462
Epoch: 24, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.353 Vali Acc: 0.789 Test Loss: 0.353 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9639909267425537
Epoch: 25, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.338 Vali Acc: 0.828 Test Loss: 0.338 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7209362983703613
Epoch: 26, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.354 Vali Acc: 0.828 Test Loss: 0.354 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8079893589019775
Epoch: 27, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.353 Vali Acc: 0.811 Test Loss: 0.353 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8640761375427246
Epoch: 28, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.339 Vali Acc: 0.817 Test Loss: 0.339 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.93634033203125
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.330 Vali Acc: 0.833 Test Loss: 0.330 Test Acc: 0.833
Validation loss decreased (-0.827774 --> -0.833330).  Saving model ...
Epoch: 30 cost time: 1.888932704925537
Epoch: 30, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.325 Vali Acc: 0.811 Test Loss: 0.325 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 1178566
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.882136344909668
Epoch: 1, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.874 Vali Acc: 0.128 Test Loss: 1.874 Test Acc: 0.128
Validation loss decreased (inf --> -0.127759).  Saving model ...
Epoch: 2 cost time: 1.295661211013794
Epoch: 2, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.783 Vali Acc: 0.178 Test Loss: 1.783 Test Acc: 0.178
Validation loss decreased (-0.127759 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.2786834239959717
Epoch: 3, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.671 Vali Acc: 0.294 Test Loss: 1.671 Test Acc: 0.294
Validation loss decreased (-0.177760 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 1.3999371528625488
Epoch: 4, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.549 Vali Acc: 0.478 Test Loss: 1.549 Test Acc: 0.478
Validation loss decreased (-0.294428 --> -0.477762).  Saving model ...
Epoch: 5 cost time: 1.3979828357696533
Epoch: 5, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.413 Vali Acc: 0.589 Test Loss: 1.413 Test Acc: 0.589
Validation loss decreased (-0.477762 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 1.2924315929412842
Epoch: 6, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.264 Vali Acc: 0.628 Test Loss: 1.264 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 1.2852954864501953
Epoch: 7, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.112 Vali Acc: 0.678 Test Loss: 1.112 Test Acc: 0.678
Validation loss decreased (-0.627765 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 1.2302618026733398
Epoch: 8, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.975 Vali Acc: 0.689 Test Loss: 0.975 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 1.2840538024902344
Epoch: 9, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.862 Vali Acc: 0.672 Test Loss: 0.862 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2375035285949707
Epoch: 10, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 1.167539358139038
Epoch: 11, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.691 Vali Acc: 0.767 Test Loss: 0.691 Test Acc: 0.767
Validation loss decreased (-0.716659 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 1.2751731872558594
Epoch: 12, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.625 Vali Acc: 0.778 Test Loss: 0.625 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 13 cost time: 1.2514536380767822
Epoch: 13, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.577 Vali Acc: 0.744 Test Loss: 0.577 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2655999660491943
Epoch: 14, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.534 Vali Acc: 0.817 Test Loss: 0.534 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816661).  Saving model ...
Epoch: 15 cost time: 1.1790335178375244
Epoch: 15, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.500 Vali Acc: 0.772 Test Loss: 0.500 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.248237133026123
Epoch: 16, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.460 Vali Acc: 0.789 Test Loss: 0.460 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.285534143447876
Epoch: 17, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827773).  Saving model ...
Epoch: 18 cost time: 1.2086069583892822
Epoch: 18, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2594587802886963
Epoch: 19, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.3061978816986084
Epoch: 20, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866663).  Saving model ...
Epoch: 21 cost time: 1.288034200668335
Epoch: 21, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 1.3067741394042969
Epoch: 22, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3049030303955078
Epoch: 23, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 24 cost time: 1.3015720844268799
Epoch: 24, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.323 Vali Acc: 0.878 Test Loss: 0.323 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 1.3770287036895752
Epoch: 25, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3519582748413086
Epoch: 26, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3724937438964844
Epoch: 27, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3039720058441162
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3946919441223145
Epoch: 29, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 1.3050475120544434
Epoch: 30, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 350854
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0442328453063965
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.782 Vali Acc: 0.200 Test Loss: 1.782 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.5428292751312256
Epoch: 2, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.698 Vali Acc: 0.322 Test Loss: 1.698 Test Acc: 0.322
Validation loss decreased (-0.199982 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 1.5008068084716797
Epoch: 3, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.593 Vali Acc: 0.472 Test Loss: 1.593 Test Acc: 0.472
Validation loss decreased (-0.322205 --> -0.472206).  Saving model ...
Epoch: 4 cost time: 1.500413179397583
Epoch: 4, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.470 Vali Acc: 0.611 Test Loss: 1.470 Test Acc: 0.611
Validation loss decreased (-0.472206 --> -0.611096).  Saving model ...
Epoch: 5 cost time: 1.5042955875396729
Epoch: 5, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.325 Vali Acc: 0.706 Test Loss: 1.325 Test Acc: 0.706
Validation loss decreased (-0.611096 --> -0.705542).  Saving model ...
Epoch: 6 cost time: 1.6765391826629639
Epoch: 6, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.170 Vali Acc: 0.728 Test Loss: 1.170 Test Acc: 0.728
Validation loss decreased (-0.705542 --> -0.727766).  Saving model ...
Epoch: 7 cost time: 1.5152063369750977
Epoch: 7, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.030 Vali Acc: 0.717 Test Loss: 1.030 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4382290840148926
Epoch: 8, Steps: 12 | Train Loss: 0.951 Vali Loss: 0.913 Vali Acc: 0.711 Test Loss: 0.913 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.48118257522583
Epoch: 9, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.817 Vali Acc: 0.733 Test Loss: 0.817 Test Acc: 0.733
Validation loss decreased (-0.727766 --> -0.733325).  Saving model ...
Epoch: 10 cost time: 1.6680288314819336
Epoch: 10, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6883888244628906
Epoch: 11, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761105).  Saving model ...
Epoch: 12 cost time: 1.6053061485290527
Epoch: 12, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.761105 --> -0.783328).  Saving model ...
Epoch: 13 cost time: 1.4995596408843994
Epoch: 13, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.462 Vali Acc: 0.778 Test Loss: 0.462 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4292609691619873
Epoch: 14, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.435 Vali Acc: 0.806 Test Loss: 0.435 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 15 cost time: 1.5141866207122803
Epoch: 15, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.426 Vali Acc: 0.789 Test Loss: 0.426 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5754234790802002
Epoch: 16, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.392 Vali Acc: 0.794 Test Loss: 0.392 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4131770133972168
Epoch: 17, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.374 Vali Acc: 0.806 Test Loss: 0.374 Test Acc: 0.806
Validation loss decreased (-0.805551 --> -0.805552).  Saving model ...
Epoch: 18 cost time: 1.4085371494293213
Epoch: 18, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.365 Vali Acc: 0.822 Test Loss: 0.365 Test Acc: 0.822
Validation loss decreased (-0.805552 --> -0.822219).  Saving model ...
Epoch: 19 cost time: 1.2926535606384277
Epoch: 19, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.370 Vali Acc: 0.811 Test Loss: 0.370 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4231228828430176
Epoch: 20, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.375 Vali Acc: 0.811 Test Loss: 0.375 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4592084884643555
Epoch: 21, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.369 Vali Acc: 0.828 Test Loss: 0.369 Test Acc: 0.828
Validation loss decreased (-0.822219 --> -0.827774).  Saving model ...
Epoch: 22 cost time: 1.4478645324707031
Epoch: 22, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.373 Vali Acc: 0.789 Test Loss: 0.373 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5773520469665527
Epoch: 23, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4248294830322266
Epoch: 24, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.349 Vali Acc: 0.794 Test Loss: 0.349 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4881021976470947
Epoch: 25, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.356 Vali Acc: 0.811 Test Loss: 0.356 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5581300258636475
Epoch: 26, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5332896709442139
Epoch: 27, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.363 Vali Acc: 0.811 Test Loss: 0.363 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5639286041259766
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.354 Vali Acc: 0.811 Test Loss: 0.354 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5446827411651611
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.351 Vali Acc: 0.828 Test Loss: 0.351 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 30 cost time: 1.4542078971862793
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.348 Vali Acc: 0.817 Test Loss: 0.348 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 1178566
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9073233604431152
Epoch: 1, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.874 Vali Acc: 0.128 Test Loss: 1.874 Test Acc: 0.128
Validation loss decreased (inf --> -0.127759).  Saving model ...
Epoch: 2 cost time: 1.2643768787384033
Epoch: 2, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.783 Vali Acc: 0.178 Test Loss: 1.783 Test Acc: 0.178
Validation loss decreased (-0.127759 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.2615060806274414
Epoch: 3, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.671 Vali Acc: 0.294 Test Loss: 1.671 Test Acc: 0.294
Validation loss decreased (-0.177760 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 1.3216543197631836
Epoch: 4, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.549 Vali Acc: 0.478 Test Loss: 1.549 Test Acc: 0.478
Validation loss decreased (-0.294428 --> -0.477762).  Saving model ...
Epoch: 5 cost time: 1.277501106262207
Epoch: 5, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.413 Vali Acc: 0.589 Test Loss: 1.413 Test Acc: 0.589
Validation loss decreased (-0.477762 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 1.1909325122833252
Epoch: 6, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.264 Vali Acc: 0.628 Test Loss: 1.264 Test Acc: 0.628
Validation loss decreased (-0.588875 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 1.2711846828460693
Epoch: 7, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.112 Vali Acc: 0.678 Test Loss: 1.112 Test Acc: 0.678
Validation loss decreased (-0.627765 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 1.412407636642456
Epoch: 8, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.975 Vali Acc: 0.689 Test Loss: 0.975 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 1.2477140426635742
Epoch: 9, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.862 Vali Acc: 0.672 Test Loss: 0.862 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2853691577911377
Epoch: 10, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 1.3343172073364258
Epoch: 11, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.691 Vali Acc: 0.767 Test Loss: 0.691 Test Acc: 0.767
Validation loss decreased (-0.716659 --> -0.766660).  Saving model ...
Epoch: 12 cost time: 1.206932783126831
Epoch: 12, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.625 Vali Acc: 0.778 Test Loss: 0.625 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 13 cost time: 1.2417006492614746
Epoch: 13, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.577 Vali Acc: 0.744 Test Loss: 0.577 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.262772798538208
Epoch: 14, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.534 Vali Acc: 0.817 Test Loss: 0.534 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816661).  Saving model ...
Epoch: 15 cost time: 1.2946546077728271
Epoch: 15, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.500 Vali Acc: 0.772 Test Loss: 0.500 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1990320682525635
Epoch: 16, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.460 Vali Acc: 0.789 Test Loss: 0.460 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1672604084014893
Epoch: 17, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827773).  Saving model ...
Epoch: 18 cost time: 1.3821189403533936
Epoch: 18, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.417 Vali Acc: 0.817 Test Loss: 0.417 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1673288345336914
Epoch: 19, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 20 cost time: 1.1544241905212402
Epoch: 20, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866663).  Saving model ...
Epoch: 21 cost time: 1.2118732929229736
Epoch: 21, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.354 Vali Acc: 0.872 Test Loss: 0.354 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 1.147420883178711
Epoch: 22, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1354191303253174
Epoch: 23, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877774).  Saving model ...
Epoch: 24 cost time: 1.2506449222564697
Epoch: 24, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.323 Vali Acc: 0.878 Test Loss: 0.323 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 25 cost time: 1.151409387588501
Epoch: 25, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1620957851409912
Epoch: 26, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.308 Vali Acc: 0.867 Test Loss: 0.308 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1879746913909912
Epoch: 27, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.307 Vali Acc: 0.856 Test Loss: 0.307 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.129880428314209
Epoch: 28, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.291 Vali Acc: 0.872 Test Loss: 0.291 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.223228931427002
Epoch: 29, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.276 Vali Acc: 0.889 Test Loss: 0.276 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 30 cost time: 1.2688095569610596
Epoch: 30, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.249 Vali Acc: 0.917 Test Loss: 0.249 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 350854
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.597111463546753
Epoch: 1, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.785 Vali Acc: 0.200 Test Loss: 1.785 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.1327388286590576
Epoch: 2, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.703 Vali Acc: 0.317 Test Loss: 1.703 Test Acc: 0.317
Validation loss decreased (-0.199982 --> -0.316650).  Saving model ...
Epoch: 3 cost time: 1.1645300388336182
Epoch: 3, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.600 Vali Acc: 0.456 Test Loss: 1.600 Test Acc: 0.456
Validation loss decreased (-0.316650 --> -0.455540).  Saving model ...
Epoch: 4 cost time: 1.1035809516906738
Epoch: 4, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.480 Vali Acc: 0.589 Test Loss: 1.480 Test Acc: 0.589
Validation loss decreased (-0.455540 --> -0.588874).  Saving model ...
Epoch: 5 cost time: 1.1485729217529297
Epoch: 5, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.337 Vali Acc: 0.683 Test Loss: 1.337 Test Acc: 0.683
Validation loss decreased (-0.588874 --> -0.683320).  Saving model ...
Epoch: 6 cost time: 1.1250429153442383
Epoch: 6, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.186 Vali Acc: 0.722 Test Loss: 1.186 Test Acc: 0.722
Validation loss decreased (-0.683320 --> -0.722210).  Saving model ...
Epoch: 7 cost time: 1.1518476009368896
Epoch: 7, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.048 Vali Acc: 0.717 Test Loss: 1.048 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1288251876831055
Epoch: 8, Steps: 12 | Train Loss: 0.953 Vali Loss: 0.935 Vali Acc: 0.706 Test Loss: 0.935 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1720943450927734
Epoch: 9, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
Validation loss decreased (-0.722210 --> -0.722214).  Saving model ...
Epoch: 10 cost time: 1.1078011989593506
Epoch: 10, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.766 Vali Acc: 0.717 Test Loss: 0.766 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2641658782958984
Epoch: 11, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.696 Vali Acc: 0.744 Test Loss: 0.696 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 1.1847243309020996
Epoch: 12, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.625 Vali Acc: 0.772 Test Loss: 0.625 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772216).  Saving model ...
Epoch: 13 cost time: 1.1176230907440186
Epoch: 13, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.565 Vali Acc: 0.761 Test Loss: 0.565 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0986013412475586
Epoch: 14, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.524 Vali Acc: 0.772 Test Loss: 0.524 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772217).  Saving model ...
Epoch: 15 cost time: 1.1659862995147705
Epoch: 15, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.474 Vali Acc: 0.800 Test Loss: 0.474 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 16 cost time: 1.1417644023895264
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.432 Vali Acc: 0.806 Test Loss: 0.432 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 17 cost time: 1.1104795932769775
Epoch: 17, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 18 cost time: 1.05900239944458
Epoch: 18, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.388 Vali Acc: 0.817 Test Loss: 0.388 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2002007961273193
Epoch: 19, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.385 Vali Acc: 0.822 Test Loss: 0.385 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 20 cost time: 1.1970295906066895
Epoch: 20, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.376 Vali Acc: 0.828 Test Loss: 0.376 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 21 cost time: 0.9917886257171631
Epoch: 21, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1568517684936523
Epoch: 22, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.344 Vali Acc: 0.806 Test Loss: 0.344 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.054870367050171
Epoch: 23, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.323 Vali Acc: 0.817 Test Loss: 0.323 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0252642631530762
Epoch: 24, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.315 Vali Acc: 0.839 Test Loss: 0.315 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838886).  Saving model ...
Epoch: 25 cost time: 1.0600690841674805
Epoch: 25, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.312 Vali Acc: 0.828 Test Loss: 0.312 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0024425983428955
Epoch: 26, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.305 Vali Acc: 0.822 Test Loss: 0.305 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0631139278411865
Epoch: 27, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.294 Vali Acc: 0.839 Test Loss: 0.294 Test Acc: 0.839
Validation loss decreased (-0.838886 --> -0.838886).  Saving model ...
Epoch: 28 cost time: 1.1206309795379639
Epoch: 28, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.302 Vali Acc: 0.844 Test Loss: 0.302 Test Acc: 0.844
Validation loss decreased (-0.838886 --> -0.844441).  Saving model ...
Epoch: 29 cost time: 1.212510108947754
Epoch: 29, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.293 Vali Acc: 0.850 Test Loss: 0.293 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 30 cost time: 1.085458755493164
Epoch: 30, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.337 Vali Acc: 0.822 Test Loss: 0.337 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 1178566
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.698803424835205
Epoch: 1, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.876 Vali Acc: 0.128 Test Loss: 1.876 Test Acc: 0.128
Validation loss decreased (inf --> -0.127759).  Saving model ...
Epoch: 2 cost time: 1.0185258388519287
Epoch: 2, Steps: 12 | Train Loss: 1.817 Vali Loss: 1.787 Vali Acc: 0.178 Test Loss: 1.787 Test Acc: 0.178
Validation loss decreased (-0.127759 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.040391445159912
Epoch: 3, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.678 Vali Acc: 0.289 Test Loss: 1.678 Test Acc: 0.289
Validation loss decreased (-0.177760 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 1.009709119796753
Epoch: 4, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.559 Vali Acc: 0.478 Test Loss: 1.559 Test Acc: 0.478
Validation loss decreased (-0.288872 --> -0.477762).  Saving model ...
Epoch: 5 cost time: 1.0230398178100586
Epoch: 5, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.426 Vali Acc: 0.589 Test Loss: 1.426 Test Acc: 0.589
Validation loss decreased (-0.477762 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 1.0823538303375244
Epoch: 6, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.279 Vali Acc: 0.611 Test Loss: 1.279 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 1.0375359058380127
Epoch: 7, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.127 Vali Acc: 0.672 Test Loss: 1.127 Test Acc: 0.672
Validation loss decreased (-0.611098 --> -0.672211).  Saving model ...
Epoch: 8 cost time: 1.0209319591522217
Epoch: 8, Steps: 12 | Train Loss: 1.010 Vali Loss: 0.992 Vali Acc: 0.678 Test Loss: 0.992 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 1.0805673599243164
Epoch: 9, Steps: 12 | Train Loss: 0.870 Vali Loss: 0.880 Vali Acc: 0.656 Test Loss: 0.880 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0314726829528809
Epoch: 10, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.784 Vali Acc: 0.711 Test Loss: 0.784 Test Acc: 0.711
Validation loss decreased (-0.677768 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 0.9755785465240479
Epoch: 11, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 0.9984474182128906
Epoch: 12, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.648 Vali Acc: 0.767 Test Loss: 0.648 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 13 cost time: 1.014491081237793
Epoch: 13, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.602 Vali Acc: 0.728 Test Loss: 0.602 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0466361045837402
Epoch: 14, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.012162685394287
Epoch: 15, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.525 Vali Acc: 0.756 Test Loss: 0.525 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0462782382965088
Epoch: 16, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.483 Vali Acc: 0.778 Test Loss: 0.483 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9991590976715088
Epoch: 17, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.455 Vali Acc: 0.811 Test Loss: 0.455 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811107).  Saving model ...
Epoch: 18 cost time: 1.0461053848266602
Epoch: 18, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0733270645141602
Epoch: 19, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.416 Vali Acc: 0.822 Test Loss: 0.416 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 20 cost time: 1.3077571392059326
Epoch: 20, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 1.3731231689453125
Epoch: 21, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 22 cost time: 1.3881163597106934
Epoch: 22, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3677992820739746
Epoch: 23, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.346 Vali Acc: 0.872 Test Loss: 0.346 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
Epoch: 24 cost time: 1.38554048538208
Epoch: 24, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.338 Vali Acc: 0.867 Test Loss: 0.338 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.326270341873169
Epoch: 25, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.330 Vali Acc: 0.856 Test Loss: 0.330 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.328996181488037
Epoch: 26, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.322 Vali Acc: 0.856 Test Loss: 0.322 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2104461193084717
Epoch: 27, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.316122055053711
Epoch: 28, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.303 Vali Acc: 0.861 Test Loss: 0.303 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2649335861206055
Epoch: 29, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.287 Vali Acc: 0.878 Test Loss: 0.287 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 30 cost time: 1.2870662212371826
Epoch: 30, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
Validation loss decreased (-0.877775 --> -0.911108).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 350854
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.623441696166992
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.813 Vali Acc: 0.133 Test Loss: 1.813 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.9080688953399658
Epoch: 2, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.727 Vali Acc: 0.183 Test Loss: 1.727 Test Acc: 0.183
Validation loss decreased (-0.133315 --> -0.183316).  Saving model ...
Epoch: 3 cost time: 1.8474438190460205
Epoch: 3, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.621 Vali Acc: 0.317 Test Loss: 1.621 Test Acc: 0.317
Validation loss decreased (-0.183316 --> -0.316650).  Saving model ...
Epoch: 4 cost time: 1.9346296787261963
Epoch: 4, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.497 Vali Acc: 0.433 Test Loss: 1.497 Test Acc: 0.433
Validation loss decreased (-0.316650 --> -0.433318).  Saving model ...
Epoch: 5 cost time: 2.0931546688079834
Epoch: 5, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.361 Vali Acc: 0.489 Test Loss: 1.361 Test Acc: 0.489
Validation loss decreased (-0.433318 --> -0.488875).  Saving model ...
Epoch: 6 cost time: 2.050386667251587
Epoch: 6, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.215 Vali Acc: 0.528 Test Loss: 1.215 Test Acc: 0.528
Validation loss decreased (-0.488875 --> -0.527766).  Saving model ...
Epoch: 7 cost time: 2.022996664047241
Epoch: 7, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.068 Vali Acc: 0.611 Test Loss: 1.068 Test Acc: 0.611
Validation loss decreased (-0.527766 --> -0.611100).  Saving model ...
Epoch: 8 cost time: 1.8787939548492432
Epoch: 8, Steps: 12 | Train Loss: 0.981 Vali Loss: 0.953 Vali Acc: 0.661 Test Loss: 0.953 Test Acc: 0.661
Validation loss decreased (-0.611100 --> -0.661102).  Saving model ...
Epoch: 9 cost time: 1.9518263339996338
Epoch: 9, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.869 Vali Acc: 0.667 Test Loss: 0.869 Test Acc: 0.667
Validation loss decreased (-0.661102 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 1.961857557296753
Epoch: 10, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.796 Vali Acc: 0.694 Test Loss: 0.796 Test Acc: 0.694
Validation loss decreased (-0.666658 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 2.101351737976074
Epoch: 11, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711104).  Saving model ...
Epoch: 12 cost time: 1.9660999774932861
Epoch: 12, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.699 Vali Acc: 0.694 Test Loss: 0.699 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1164281368255615
Epoch: 13, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.655 Vali Acc: 0.739 Test Loss: 0.655 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 2.0217888355255127
Epoch: 14, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.618 Vali Acc: 0.733 Test Loss: 0.618 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0421648025512695
Epoch: 15, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.586 Vali Acc: 0.744 Test Loss: 0.586 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 16 cost time: 2.04374098777771
Epoch: 16, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.557 Vali Acc: 0.778 Test Loss: 0.557 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777772).  Saving model ...
Epoch: 17 cost time: 1.6692469120025635
Epoch: 17, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.536 Vali Acc: 0.778 Test Loss: 0.536 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 18 cost time: 2.1132161617279053
Epoch: 18, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.502 Vali Acc: 0.772 Test Loss: 0.502 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1717207431793213
Epoch: 19, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.484 Vali Acc: 0.789 Test Loss: 0.484 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 20 cost time: 2.0545284748077393
Epoch: 20, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 21 cost time: 2.086369037628174
Epoch: 21, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 22 cost time: 2.0541670322418213
Epoch: 22, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.407 Vali Acc: 0.811 Test Loss: 0.407 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 2.0538344383239746
Epoch: 23, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 24 cost time: 2.183027982711792
Epoch: 24, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.379 Vali Acc: 0.811 Test Loss: 0.379 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1516826152801514
Epoch: 25, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.03520131111145
Epoch: 26, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.367 Vali Acc: 0.839 Test Loss: 0.367 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 27 cost time: 2.1492202281951904
Epoch: 27, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.351 Vali Acc: 0.839 Test Loss: 0.351 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 2.0902180671691895
Epoch: 28, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9995601177215576
Epoch: 29, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.085740804672241
Epoch: 30, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.335 Vali Acc: 0.839 Test Loss: 0.335 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838886).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 592454
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2730462551116943
Epoch: 1, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.871 Vali Acc: 0.178 Test Loss: 1.871 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 1.6840927600860596
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.780 Vali Acc: 0.211 Test Loss: 1.780 Test Acc: 0.211
Validation loss decreased (-0.177759 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 1.6127896308898926
Epoch: 3, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.665 Vali Acc: 0.294 Test Loss: 1.665 Test Acc: 0.294
Validation loss decreased (-0.211093 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 1.5135095119476318
Epoch: 4, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.536 Vali Acc: 0.467 Test Loss: 1.536 Test Acc: 0.467
Validation loss decreased (-0.294428 --> -0.466651).  Saving model ...
Epoch: 5 cost time: 1.537175178527832
Epoch: 5, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.396 Vali Acc: 0.556 Test Loss: 1.396 Test Acc: 0.556
Validation loss decreased (-0.466651 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 1.5585224628448486
Epoch: 6, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.257 Vali Acc: 0.633 Test Loss: 1.257 Test Acc: 0.633
Validation loss decreased (-0.555542 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 1.5794684886932373
Epoch: 7, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.114 Vali Acc: 0.683 Test Loss: 1.114 Test Acc: 0.683
Validation loss decreased (-0.633321 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 1.591066598892212
Epoch: 8, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.983 Vali Acc: 0.678 Test Loss: 0.983 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5721149444580078
Epoch: 9, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.876 Vali Acc: 0.694 Test Loss: 0.876 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 1.535872459411621
Epoch: 10, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.790 Vali Acc: 0.706 Test Loss: 0.790 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 11 cost time: 1.4954514503479004
Epoch: 11, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.721 Vali Acc: 0.733 Test Loss: 0.721 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 1.5796492099761963
Epoch: 12, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.668 Vali Acc: 0.739 Test Loss: 0.668 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 1.1779327392578125
Epoch: 13, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.620 Vali Acc: 0.772 Test Loss: 0.620 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 1.6322777271270752
Epoch: 14, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.580 Vali Acc: 0.778 Test Loss: 0.580 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 1.629310131072998
Epoch: 15, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.545 Vali Acc: 0.772 Test Loss: 0.545 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5933926105499268
Epoch: 16, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.518 Vali Acc: 0.817 Test Loss: 0.518 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 1.6131386756896973
Epoch: 17, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.481 Vali Acc: 0.794 Test Loss: 0.481 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5307626724243164
Epoch: 18, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
Validation loss decreased (-0.816661 --> -0.844440).  Saving model ...
Epoch: 19 cost time: 1.5188612937927246
Epoch: 19, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.519669532775879
Epoch: 20, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.546614170074463
Epoch: 21, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.408 Vali Acc: 0.817 Test Loss: 0.408 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.601325273513794
Epoch: 22, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.395 Vali Acc: 0.828 Test Loss: 0.395 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5990040302276611
Epoch: 23, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6213207244873047
Epoch: 24, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5857553482055664
Epoch: 25, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 26 cost time: 1.5299155712127686
Epoch: 26, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.343 Vali Acc: 0.856 Test Loss: 0.343 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 27 cost time: 1.3945224285125732
Epoch: 27, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4555726051330566
Epoch: 28, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.330 Vali Acc: 0.872 Test Loss: 0.330 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 29 cost time: 1.5201399326324463
Epoch: 29, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.310 Vali Acc: 0.844 Test Loss: 0.310 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4802939891815186
Epoch: 30, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.299 Vali Acc: 0.872 Test Loss: 0.299 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 178566
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5674092769622803
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.813 Vali Acc: 0.133 Test Loss: 1.813 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.7980883121490479
Epoch: 2, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.727 Vali Acc: 0.183 Test Loss: 1.727 Test Acc: 0.183
Validation loss decreased (-0.133315 --> -0.183316).  Saving model ...
Epoch: 3 cost time: 1.882795810699463
Epoch: 3, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.621 Vali Acc: 0.317 Test Loss: 1.621 Test Acc: 0.317
Validation loss decreased (-0.183316 --> -0.316650).  Saving model ...
Epoch: 4 cost time: 1.919325828552246
Epoch: 4, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.497 Vali Acc: 0.433 Test Loss: 1.497 Test Acc: 0.433
Validation loss decreased (-0.316650 --> -0.433318).  Saving model ...
Epoch: 5 cost time: 1.9431040287017822
Epoch: 5, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.361 Vali Acc: 0.489 Test Loss: 1.361 Test Acc: 0.489
Validation loss decreased (-0.433318 --> -0.488875).  Saving model ...
Epoch: 6 cost time: 1.904284954071045
Epoch: 6, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.215 Vali Acc: 0.528 Test Loss: 1.215 Test Acc: 0.528
Validation loss decreased (-0.488875 --> -0.527766).  Saving model ...
Epoch: 7 cost time: 1.9395990371704102
Epoch: 7, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.068 Vali Acc: 0.611 Test Loss: 1.068 Test Acc: 0.611
Validation loss decreased (-0.527766 --> -0.611100).  Saving model ...
Epoch: 8 cost time: 1.839940071105957
Epoch: 8, Steps: 12 | Train Loss: 0.981 Vali Loss: 0.953 Vali Acc: 0.661 Test Loss: 0.953 Test Acc: 0.661
Validation loss decreased (-0.611100 --> -0.661102).  Saving model ...
Epoch: 9 cost time: 1.727529525756836
Epoch: 9, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.869 Vali Acc: 0.667 Test Loss: 0.869 Test Acc: 0.667
Validation loss decreased (-0.661102 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 1.8254480361938477
Epoch: 10, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.796 Vali Acc: 0.694 Test Loss: 0.796 Test Acc: 0.694
Validation loss decreased (-0.666658 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 1.8851375579833984
Epoch: 11, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711104).  Saving model ...
Epoch: 12 cost time: 1.900388240814209
Epoch: 12, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.699 Vali Acc: 0.694 Test Loss: 0.699 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9089558124542236
Epoch: 13, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.655 Vali Acc: 0.739 Test Loss: 0.655 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 1.909292221069336
Epoch: 14, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.618 Vali Acc: 0.733 Test Loss: 0.618 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9074087142944336
Epoch: 15, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.586 Vali Acc: 0.744 Test Loss: 0.586 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744439).  Saving model ...
Epoch: 16 cost time: 1.82100248336792
Epoch: 16, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.557 Vali Acc: 0.778 Test Loss: 0.557 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777772).  Saving model ...
Epoch: 17 cost time: 1.9090793132781982
Epoch: 17, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.536 Vali Acc: 0.778 Test Loss: 0.536 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 18 cost time: 1.9353866577148438
Epoch: 18, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.502 Vali Acc: 0.772 Test Loss: 0.502 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9865312576293945
Epoch: 19, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.484 Vali Acc: 0.789 Test Loss: 0.484 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 20 cost time: 1.8875234127044678
Epoch: 20, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.455 Vali Acc: 0.800 Test Loss: 0.455 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 21 cost time: 1.936034917831421
Epoch: 21, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.428 Vali Acc: 0.806 Test Loss: 0.428 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 22 cost time: 1.932677984237671
Epoch: 22, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.407 Vali Acc: 0.811 Test Loss: 0.407 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 23 cost time: 1.8790676593780518
Epoch: 23, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.398 Vali Acc: 0.822 Test Loss: 0.398 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 24 cost time: 1.656327486038208
Epoch: 24, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.379 Vali Acc: 0.811 Test Loss: 0.379 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9080259799957275
Epoch: 25, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.366 Vali Acc: 0.817 Test Loss: 0.366 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9626612663269043
Epoch: 26, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.367 Vali Acc: 0.833 Test Loss: 0.367 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833330).  Saving model ...
Epoch: 27 cost time: 1.9508497714996338
Epoch: 27, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 28 cost time: 1.952345371246338
Epoch: 28, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.341 Vali Acc: 0.833 Test Loss: 0.341 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
Epoch: 29 cost time: 1.9443299770355225
Epoch: 29, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.342 Vali Acc: 0.828 Test Loss: 0.342 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.917473316192627
Epoch: 30, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.340 Vali Acc: 0.833 Test Loss: 0.340 Test Acc: 0.833
Validation loss decreased (-0.833330 --> -0.833330).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 592454
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4463253021240234
Epoch: 1, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.871 Vali Acc: 0.178 Test Loss: 1.871 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 1.7412512302398682
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.780 Vali Acc: 0.211 Test Loss: 1.780 Test Acc: 0.211
Validation loss decreased (-0.177759 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 1.7006912231445312
Epoch: 3, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.665 Vali Acc: 0.294 Test Loss: 1.665 Test Acc: 0.294
Validation loss decreased (-0.211093 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 1.6873385906219482
Epoch: 4, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.536 Vali Acc: 0.467 Test Loss: 1.536 Test Acc: 0.467
Validation loss decreased (-0.294428 --> -0.466651).  Saving model ...
Epoch: 5 cost time: 1.7211277484893799
Epoch: 5, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.396 Vali Acc: 0.556 Test Loss: 1.396 Test Acc: 0.556
Validation loss decreased (-0.466651 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 1.7128255367279053
Epoch: 6, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.257 Vali Acc: 0.633 Test Loss: 1.257 Test Acc: 0.633
Validation loss decreased (-0.555542 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 1.706831693649292
Epoch: 7, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.113 Vali Acc: 0.683 Test Loss: 1.113 Test Acc: 0.683
Validation loss decreased (-0.633321 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 1.5304393768310547
Epoch: 8, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.983 Vali Acc: 0.678 Test Loss: 0.983 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7563607692718506
Epoch: 9, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.875 Vali Acc: 0.694 Test Loss: 0.875 Test Acc: 0.694
Validation loss decreased (-0.683322 --> -0.694436).  Saving model ...
Epoch: 10 cost time: 1.6972990036010742
Epoch: 10, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.789 Vali Acc: 0.706 Test Loss: 0.789 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 11 cost time: 1.7021358013153076
Epoch: 11, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.721 Vali Acc: 0.733 Test Loss: 0.721 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 1.6976449489593506
Epoch: 12, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.668 Vali Acc: 0.739 Test Loss: 0.668 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 1.7168395519256592
Epoch: 13, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.620 Vali Acc: 0.772 Test Loss: 0.620 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 1.6633214950561523
Epoch: 14, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.580 Vali Acc: 0.778 Test Loss: 0.580 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 1.6892733573913574
Epoch: 15, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.545 Vali Acc: 0.772 Test Loss: 0.545 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5169930458068848
Epoch: 16, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.518 Vali Acc: 0.817 Test Loss: 0.518 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 1.6961467266082764
Epoch: 17, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.481 Vali Acc: 0.794 Test Loss: 0.481 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7447876930236816
Epoch: 18, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
Validation loss decreased (-0.816661 --> -0.844440).  Saving model ...
Epoch: 19 cost time: 1.6904168128967285
Epoch: 19, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.441 Vali Acc: 0.822 Test Loss: 0.441 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7547309398651123
Epoch: 20, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.418 Vali Acc: 0.811 Test Loss: 0.418 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.750779390335083
Epoch: 21, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6008524894714355
Epoch: 22, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.395 Vali Acc: 0.828 Test Loss: 0.395 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5925273895263672
Epoch: 23, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.374 Vali Acc: 0.828 Test Loss: 0.374 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.423050880432129
Epoch: 24, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.374 Vali Acc: 0.839 Test Loss: 0.374 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6790292263031006
Epoch: 25, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 26 cost time: 1.7074689865112305
Epoch: 26, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 27 cost time: 1.6036453247070312
Epoch: 27, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.349 Vali Acc: 0.839 Test Loss: 0.349 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6703972816467285
Epoch: 28, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
Validation loss decreased (-0.849997 --> -0.866663).  Saving model ...
Epoch: 29 cost time: 1.6410768032073975
Epoch: 29, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.316 Vali Acc: 0.844 Test Loss: 0.316 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.583524227142334
Epoch: 30, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
Validation loss decreased (-0.866663 --> -0.872219).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 178566
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.169943332672119
Epoch: 1, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.813 Vali Acc: 0.133 Test Loss: 1.813 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 1.5688621997833252
Epoch: 2, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.727 Vali Acc: 0.183 Test Loss: 1.727 Test Acc: 0.183
Validation loss decreased (-0.133315 --> -0.183316).  Saving model ...
Epoch: 3 cost time: 1.481252670288086
Epoch: 3, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.621 Vali Acc: 0.317 Test Loss: 1.621 Test Acc: 0.317
Validation loss decreased (-0.183316 --> -0.316650).  Saving model ...
Epoch: 4 cost time: 1.4541709423065186
Epoch: 4, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.498 Vali Acc: 0.433 Test Loss: 1.498 Test Acc: 0.433
Validation loss decreased (-0.316650 --> -0.433318).  Saving model ...
Epoch: 5 cost time: 1.4822628498077393
Epoch: 5, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.363 Vali Acc: 0.489 Test Loss: 1.363 Test Acc: 0.489
Validation loss decreased (-0.433318 --> -0.488875).  Saving model ...
Epoch: 6 cost time: 1.4826362133026123
Epoch: 6, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.217 Vali Acc: 0.528 Test Loss: 1.217 Test Acc: 0.528
Validation loss decreased (-0.488875 --> -0.527766).  Saving model ...
Epoch: 7 cost time: 1.319152593612671
Epoch: 7, Steps: 12 | Train Loss: 1.120 Vali Loss: 1.073 Vali Acc: 0.606 Test Loss: 1.073 Test Acc: 0.606
Validation loss decreased (-0.527766 --> -0.605545).  Saving model ...
Epoch: 8 cost time: 1.587352991104126
Epoch: 8, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.963 Vali Acc: 0.644 Test Loss: 0.963 Test Acc: 0.644
Validation loss decreased (-0.605545 --> -0.644435).  Saving model ...
Epoch: 9 cost time: 1.4811029434204102
Epoch: 9, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.882 Vali Acc: 0.656 Test Loss: 0.882 Test Acc: 0.656
Validation loss decreased (-0.644435 --> -0.655547).  Saving model ...
Epoch: 10 cost time: 1.504467248916626
Epoch: 10, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.812 Vali Acc: 0.678 Test Loss: 0.812 Test Acc: 0.678
Validation loss decreased (-0.655547 --> -0.677770).  Saving model ...
Epoch: 11 cost time: 1.3935635089874268
Epoch: 11, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.762 Vali Acc: 0.700 Test Loss: 0.762 Test Acc: 0.700
Validation loss decreased (-0.677770 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 1.5624971389770508
Epoch: 12, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.712 Vali Acc: 0.678 Test Loss: 0.712 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5358989238739014
Epoch: 13, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.668 Vali Acc: 0.733 Test Loss: 0.668 Test Acc: 0.733
Validation loss decreased (-0.699992 --> -0.733327).  Saving model ...
Epoch: 14 cost time: 1.5321853160858154
Epoch: 14, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.631 Vali Acc: 0.733 Test Loss: 0.631 Test Acc: 0.733
Validation loss decreased (-0.733327 --> -0.733327).  Saving model ...
Epoch: 15 cost time: 1.503117561340332
Epoch: 15, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.595 Vali Acc: 0.739 Test Loss: 0.595 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 16 cost time: 1.4952914714813232
Epoch: 16, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.565 Vali Acc: 0.761 Test Loss: 0.565 Test Acc: 0.761
Validation loss decreased (-0.738883 --> -0.761105).  Saving model ...
Epoch: 17 cost time: 1.5192456245422363
Epoch: 17, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.542 Vali Acc: 0.772 Test Loss: 0.542 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 18 cost time: 1.5329103469848633
Epoch: 18, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.509 Vali Acc: 0.756 Test Loss: 0.509 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.600494146347046
Epoch: 19, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.489 Vali Acc: 0.772 Test Loss: 0.489 Test Acc: 0.772
Validation loss decreased (-0.772217 --> -0.772217).  Saving model ...
Epoch: 20 cost time: 1.5267696380615234
Epoch: 20, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.459 Vali Acc: 0.794 Test Loss: 0.459 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794440).  Saving model ...
Epoch: 21 cost time: 1.5413663387298584
Epoch: 21, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.431 Vali Acc: 0.794 Test Loss: 0.431 Test Acc: 0.794
Validation loss decreased (-0.794440 --> -0.794440).  Saving model ...
Epoch: 22 cost time: 1.5168426036834717
Epoch: 22, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.410 Vali Acc: 0.800 Test Loss: 0.410 Test Acc: 0.800
Validation loss decreased (-0.794440 --> -0.799996).  Saving model ...
Epoch: 23 cost time: 1.3395349979400635
Epoch: 23, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.401 Vali Acc: 0.811 Test Loss: 0.401 Test Acc: 0.811
Validation loss decreased (-0.799996 --> -0.811107).  Saving model ...
Epoch: 24 cost time: 1.5276563167572021
Epoch: 24, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.381 Vali Acc: 0.800 Test Loss: 0.381 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.58349609375
Epoch: 25, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.364 Vali Acc: 0.811 Test Loss: 0.364 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 26 cost time: 1.5241851806640625
Epoch: 26, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.366 Vali Acc: 0.828 Test Loss: 0.366 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 27 cost time: 1.6045691967010498
Epoch: 27, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.353 Vali Acc: 0.839 Test Loss: 0.353 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 28 cost time: 1.542736530303955
Epoch: 28, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.340 Vali Acc: 0.828 Test Loss: 0.340 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5505950450897217
Epoch: 29, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.340 Vali Acc: 0.822 Test Loss: 0.340 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5209953784942627
Epoch: 30, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.339 Vali Acc: 0.833 Test Loss: 0.339 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 592454
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.170576810836792
Epoch: 1, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.872 Vali Acc: 0.178 Test Loss: 1.872 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 1.3760027885437012
Epoch: 2, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.782 Vali Acc: 0.211 Test Loss: 1.782 Test Acc: 0.211
Validation loss decreased (-0.177759 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 1.35884428024292
Epoch: 3, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.668 Vali Acc: 0.294 Test Loss: 1.668 Test Acc: 0.294
Validation loss decreased (-0.211093 --> -0.294428).  Saving model ...
Epoch: 4 cost time: 1.3491551876068115
Epoch: 4, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.539 Vali Acc: 0.467 Test Loss: 1.539 Test Acc: 0.467
Validation loss decreased (-0.294428 --> -0.466651).  Saving model ...
Epoch: 5 cost time: 1.3558897972106934
Epoch: 5, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.400 Vali Acc: 0.561 Test Loss: 1.400 Test Acc: 0.561
Validation loss decreased (-0.466651 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 1.3312935829162598
Epoch: 6, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.263 Vali Acc: 0.633 Test Loss: 1.263 Test Acc: 0.633
Validation loss decreased (-0.561097 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 1.158646583557129
Epoch: 7, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.120 Vali Acc: 0.672 Test Loss: 1.120 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 8 cost time: 1.3312969207763672
Epoch: 8, Steps: 12 | Train Loss: 1.011 Vali Loss: 0.991 Vali Acc: 0.667 Test Loss: 0.991 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3532004356384277
Epoch: 9, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.884 Vali Acc: 0.683 Test Loss: 0.884 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 1.3654916286468506
Epoch: 10, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.799 Vali Acc: 0.694 Test Loss: 0.799 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 1.369720458984375
Epoch: 11, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.732 Vali Acc: 0.722 Test Loss: 0.732 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722215).  Saving model ...
Epoch: 12 cost time: 1.421401023864746
Epoch: 12, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.679 Vali Acc: 0.733 Test Loss: 0.679 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733327).  Saving model ...
Epoch: 13 cost time: 1.3394255638122559
Epoch: 13, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
Validation loss decreased (-0.733327 --> -0.761105).  Saving model ...
Epoch: 14 cost time: 1.3551585674285889
Epoch: 14, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.590 Vali Acc: 0.767 Test Loss: 0.590 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 15 cost time: 1.3214986324310303
Epoch: 15, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.556 Vali Acc: 0.756 Test Loss: 0.556 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3192968368530273
Epoch: 16, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.529 Vali Acc: 0.794 Test Loss: 0.529 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 17 cost time: 1.3189473152160645
Epoch: 17, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0139663219451904
Epoch: 18, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.463 Vali Acc: 0.839 Test Loss: 0.463 Test Acc: 0.839
Validation loss decreased (-0.794439 --> -0.838884).  Saving model ...
Epoch: 19 cost time: 1.3569481372833252
Epoch: 19, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.453 Vali Acc: 0.822 Test Loss: 0.453 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1152677536010742
Epoch: 20, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.430 Vali Acc: 0.811 Test Loss: 0.430 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.05350923538208
Epoch: 21, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.419 Vali Acc: 0.817 Test Loss: 0.419 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0132341384887695
Epoch: 22, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.407 Vali Acc: 0.822 Test Loss: 0.407 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9891126155853271
Epoch: 23, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.388 Vali Acc: 0.828 Test Loss: 0.388 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.007861614227295
Epoch: 24, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0497605800628662
Epoch: 25, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.384 Vali Acc: 0.839 Test Loss: 0.384 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 26 cost time: 1.0777456760406494
Epoch: 26, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.363 Vali Acc: 0.844 Test Loss: 0.363 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 27 cost time: 1.366285800933838
Epoch: 27, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4395456314086914
Epoch: 28, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
Validation loss decreased (-0.844441 --> -0.855552).  Saving model ...
Epoch: 29 cost time: 1.2713277339935303
Epoch: 29, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.350 Vali Acc: 0.844 Test Loss: 0.350 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1071922779083252
Epoch: 30, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.344 Vali Acc: 0.878 Test Loss: 0.344 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 178566
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8015565872192383
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.748 Vali Acc: 0.211 Test Loss: 1.748 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.9588940143585205
Epoch: 2, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.688 Vali Acc: 0.289 Test Loss: 1.688 Test Acc: 0.289
Validation loss decreased (-0.211094 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 1.8933203220367432
Epoch: 3, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.610 Vali Acc: 0.400 Test Loss: 1.610 Test Acc: 0.400
Validation loss decreased (-0.288872 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 2.00492000579834
Epoch: 4, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.515 Vali Acc: 0.533 Test Loss: 1.515 Test Acc: 0.533
Validation loss decreased (-0.399984 --> -0.533318).  Saving model ...
Epoch: 5 cost time: 2.0154881477355957
Epoch: 5, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.412 Vali Acc: 0.617 Test Loss: 1.412 Test Acc: 0.617
Validation loss decreased (-0.533318 --> -0.616653).  Saving model ...
Epoch: 6 cost time: 1.7900965213775635
Epoch: 6, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.288 Vali Acc: 0.633 Test Loss: 1.288 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 1.6343767642974854
Epoch: 7, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.161 Vali Acc: 0.667 Test Loss: 1.161 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 1.9418327808380127
Epoch: 8, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 1.804884433746338
Epoch: 9, Steps: 12 | Train Loss: 0.974 Vali Loss: 0.925 Vali Acc: 0.689 Test Loss: 0.925 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688880).  Saving model ...
Epoch: 10 cost time: 1.594435214996338
Epoch: 10, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.838 Vali Acc: 0.739 Test Loss: 0.838 Test Acc: 0.739
Validation loss decreased (-0.688880 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 1.9013011455535889
Epoch: 11, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.764 Vali Acc: 0.700 Test Loss: 0.764 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6182520389556885
Epoch: 12, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.710 Vali Acc: 0.711 Test Loss: 0.710 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.685425043106079
Epoch: 13, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.663 Vali Acc: 0.728 Test Loss: 0.663 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9023239612579346
Epoch: 14, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.629 Vali Acc: 0.744 Test Loss: 0.629 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 15 cost time: 1.8697874546051025
Epoch: 15, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.601 Vali Acc: 0.756 Test Loss: 0.601 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 16 cost time: 1.6264605522155762
Epoch: 16, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 17 cost time: 1.9044950008392334
Epoch: 17, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.534 Vali Acc: 0.772 Test Loss: 0.534 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9720444679260254
Epoch: 18, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822217).  Saving model ...
Epoch: 19 cost time: 1.7011241912841797
Epoch: 19, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.478 Vali Acc: 0.794 Test Loss: 0.478 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.360459804534912
Epoch: 20, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.443 Vali Acc: 0.811 Test Loss: 0.443 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8729755878448486
Epoch: 21, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844440).  Saving model ...
Epoch: 22 cost time: 1.747049331665039
Epoch: 22, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.413 Vali Acc: 0.811 Test Loss: 0.413 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6144440174102783
Epoch: 23, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9621093273162842
Epoch: 24, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.760810375213623
Epoch: 25, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8616764545440674
Epoch: 26, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9447081089019775
Epoch: 27, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 1.869023084640503
Epoch: 28, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 1.9452276229858398
Epoch: 29, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.114945888519287
Epoch: 30, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 299398
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3972668647766113
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.833 Vali Acc: 0.106 Test Loss: 1.833 Test Acc: 0.106
Validation loss decreased (inf --> -0.105537).  Saving model ...
Epoch: 2 cost time: 1.4423539638519287
Epoch: 2, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.766 Vali Acc: 0.194 Test Loss: 1.766 Test Acc: 0.194
Validation loss decreased (-0.105537 --> -0.194427).  Saving model ...
Epoch: 3 cost time: 1.7740604877471924
Epoch: 3, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.677 Vali Acc: 0.322 Test Loss: 1.677 Test Acc: 0.322
Validation loss decreased (-0.194427 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 1.7298963069915771
Epoch: 4, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.575 Vali Acc: 0.456 Test Loss: 1.575 Test Acc: 0.456
Validation loss decreased (-0.322205 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.6274819374084473
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.461 Vali Acc: 0.539 Test Loss: 1.461 Test Acc: 0.539
Validation loss decreased (-0.455540 --> -0.538874).  Saving model ...
Epoch: 6 cost time: 1.502389669418335
Epoch: 6, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.335 Vali Acc: 0.589 Test Loss: 1.335 Test Acc: 0.589
Validation loss decreased (-0.538874 --> -0.588876).  Saving model ...
Epoch: 7 cost time: 1.7220687866210938
Epoch: 7, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.207 Vali Acc: 0.633 Test Loss: 1.207 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 1.5752387046813965
Epoch: 8, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.074 Vali Acc: 0.683 Test Loss: 1.074 Test Acc: 0.683
Validation loss decreased (-0.633321 --> -0.683323).  Saving model ...
Epoch: 9 cost time: 1.6995065212249756
Epoch: 9, Steps: 12 | Train Loss: 0.978 Vali Loss: 0.953 Vali Acc: 0.711 Test Loss: 0.953 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 1.7519173622131348
Epoch: 10, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 1.717534065246582
Epoch: 11, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.767 Vali Acc: 0.739 Test Loss: 0.767 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738881).  Saving model ...
Epoch: 12 cost time: 1.4976706504821777
Epoch: 12, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 1.7651643753051758
Epoch: 13, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.647 Vali Acc: 0.772 Test Loss: 0.647 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 1.724484920501709
Epoch: 14, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 15 cost time: 1.6546096801757812
Epoch: 15, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.783327 --> -0.783328).  Saving model ...
Epoch: 16 cost time: 1.6915743350982666
Epoch: 16, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.540 Vali Acc: 0.778 Test Loss: 0.540 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7174403667449951
Epoch: 17, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.512 Vali Acc: 0.800 Test Loss: 0.512 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 1.6931343078613281
Epoch: 18, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.490 Vali Acc: 0.811 Test Loss: 0.490 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 19 cost time: 1.523822546005249
Epoch: 19, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.471 Vali Acc: 0.817 Test Loss: 0.471 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 1.436185598373413
Epoch: 20, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 21 cost time: 1.43599534034729
Epoch: 21, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4659759998321533
Epoch: 22, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5327410697937012
Epoch: 23, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4472010135650635
Epoch: 24, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.399 Vali Acc: 0.822 Test Loss: 0.399 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 25 cost time: 1.4302456378936768
Epoch: 25, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.389 Vali Acc: 0.822 Test Loss: 0.389 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 26 cost time: 1.616868257522583
Epoch: 26, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8078687191009521
Epoch: 27, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7329049110412598
Epoch: 28, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8113617897033691
Epoch: 29, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 30 cost time: 1.7672719955444336
Epoch: 30, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.351 Vali Acc: 0.800 Test Loss: 0.351 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 92422
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.662062883377075
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.748 Vali Acc: 0.211 Test Loss: 1.748 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.8772506713867188
Epoch: 2, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.688 Vali Acc: 0.289 Test Loss: 1.688 Test Acc: 0.289
Validation loss decreased (-0.211094 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 1.567897081375122
Epoch: 3, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.610 Vali Acc: 0.400 Test Loss: 1.610 Test Acc: 0.400
Validation loss decreased (-0.288872 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 1.6140823364257812
Epoch: 4, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.515 Vali Acc: 0.533 Test Loss: 1.515 Test Acc: 0.533
Validation loss decreased (-0.399984 --> -0.533318).  Saving model ...
Epoch: 5 cost time: 1.7732281684875488
Epoch: 5, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.412 Vali Acc: 0.617 Test Loss: 1.412 Test Acc: 0.617
Validation loss decreased (-0.533318 --> -0.616653).  Saving model ...
Epoch: 6 cost time: 1.8858428001403809
Epoch: 6, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.288 Vali Acc: 0.633 Test Loss: 1.288 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 1.8697795867919922
Epoch: 7, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.161 Vali Acc: 0.667 Test Loss: 1.161 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 1.9090125560760498
Epoch: 8, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 1.8372313976287842
Epoch: 9, Steps: 12 | Train Loss: 0.974 Vali Loss: 0.925 Vali Acc: 0.683 Test Loss: 0.925 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 1.8416454792022705
Epoch: 10, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.838 Vali Acc: 0.739 Test Loss: 0.838 Test Acc: 0.739
Validation loss decreased (-0.683324 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 1.5266687870025635
Epoch: 11, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.764 Vali Acc: 0.700 Test Loss: 0.764 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9358320236206055
Epoch: 12, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.710 Vali Acc: 0.711 Test Loss: 0.710 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.905229091644287
Epoch: 13, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.663 Vali Acc: 0.728 Test Loss: 0.663 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.827690839767456
Epoch: 14, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.629 Vali Acc: 0.744 Test Loss: 0.629 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744438).  Saving model ...
Epoch: 15 cost time: 1.7391881942749023
Epoch: 15, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.601 Vali Acc: 0.756 Test Loss: 0.601 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 16 cost time: 1.6953763961791992
Epoch: 16, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 17 cost time: 1.3538715839385986
Epoch: 17, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.534 Vali Acc: 0.772 Test Loss: 0.534 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7247962951660156
Epoch: 18, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.505 Vali Acc: 0.822 Test Loss: 0.505 Test Acc: 0.822
Validation loss decreased (-0.783328 --> -0.822217).  Saving model ...
Epoch: 19 cost time: 1.7567198276519775
Epoch: 19, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.478 Vali Acc: 0.794 Test Loss: 0.478 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7731342315673828
Epoch: 20, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.443 Vali Acc: 0.811 Test Loss: 0.443 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6879322528839111
Epoch: 21, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844440).  Saving model ...
Epoch: 22 cost time: 1.4916703701019287
Epoch: 22, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.413 Vali Acc: 0.811 Test Loss: 0.413 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.429356575012207
Epoch: 23, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.390 Vali Acc: 0.817 Test Loss: 0.390 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8277063369750977
Epoch: 24, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 25 cost time: 1.7992229461669922
Epoch: 25, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6723291873931885
Epoch: 26, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.362 Vali Acc: 0.817 Test Loss: 0.362 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7502820491790771
Epoch: 27, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
Validation loss decreased (-0.844441 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 1.791773796081543
Epoch: 28, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 1.363875150680542
Epoch: 29, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7106003761291504
Epoch: 30, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.300 Vali Acc: 0.872 Test Loss: 0.300 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 299398
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.083930015563965
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.833 Vali Acc: 0.106 Test Loss: 1.833 Test Acc: 0.106
Validation loss decreased (inf --> -0.105537).  Saving model ...
Epoch: 2 cost time: 1.4913008213043213
Epoch: 2, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.766 Vali Acc: 0.194 Test Loss: 1.766 Test Acc: 0.194
Validation loss decreased (-0.105537 --> -0.194427).  Saving model ...
Epoch: 3 cost time: 1.6517393589019775
Epoch: 3, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.677 Vali Acc: 0.322 Test Loss: 1.677 Test Acc: 0.322
Validation loss decreased (-0.194427 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 1.6288676261901855
Epoch: 4, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.575 Vali Acc: 0.456 Test Loss: 1.575 Test Acc: 0.456
Validation loss decreased (-0.322205 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.6752986907958984
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.461 Vali Acc: 0.539 Test Loss: 1.461 Test Acc: 0.539
Validation loss decreased (-0.455540 --> -0.538874).  Saving model ...
Epoch: 6 cost time: 1.6862585544586182
Epoch: 6, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.335 Vali Acc: 0.589 Test Loss: 1.335 Test Acc: 0.589
Validation loss decreased (-0.538874 --> -0.588876).  Saving model ...
Epoch: 7 cost time: 1.5707213878631592
Epoch: 7, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.207 Vali Acc: 0.633 Test Loss: 1.207 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 1.2392640113830566
Epoch: 8, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.074 Vali Acc: 0.683 Test Loss: 1.074 Test Acc: 0.683
Validation loss decreased (-0.633321 --> -0.683323).  Saving model ...
Epoch: 9 cost time: 1.5741045475006104
Epoch: 9, Steps: 12 | Train Loss: 0.978 Vali Loss: 0.953 Vali Acc: 0.711 Test Loss: 0.953 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 1.623805284500122
Epoch: 10, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.854 Vali Acc: 0.711 Test Loss: 0.854 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 1.673635721206665
Epoch: 11, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.767 Vali Acc: 0.739 Test Loss: 0.767 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738881).  Saving model ...
Epoch: 12 cost time: 1.6298818588256836
Epoch: 12, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 1.5928168296813965
Epoch: 13, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.646 Vali Acc: 0.772 Test Loss: 0.646 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 1.551823377609253
Epoch: 14, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 15 cost time: 1.7521357536315918
Epoch: 15, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.783327 --> -0.783328).  Saving model ...
Epoch: 16 cost time: 1.771069049835205
Epoch: 16, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.540 Vali Acc: 0.778 Test Loss: 0.540 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7894296646118164
Epoch: 17, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.512 Vali Acc: 0.800 Test Loss: 0.512 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 1.6058378219604492
Epoch: 18, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.489 Vali Acc: 0.811 Test Loss: 0.489 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 19 cost time: 1.4681808948516846
Epoch: 19, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.471 Vali Acc: 0.817 Test Loss: 0.471 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 1.4883427619934082
Epoch: 20, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.457 Vali Acc: 0.817 Test Loss: 0.457 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 21 cost time: 1.822460412979126
Epoch: 21, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.441 Vali Acc: 0.800 Test Loss: 0.441 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7641193866729736
Epoch: 22, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.428 Vali Acc: 0.794 Test Loss: 0.428 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7482054233551025
Epoch: 23, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.413 Vali Acc: 0.806 Test Loss: 0.413 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7359576225280762
Epoch: 24, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.399 Vali Acc: 0.822 Test Loss: 0.399 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 25 cost time: 1.706636905670166
Epoch: 25, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.389 Vali Acc: 0.822 Test Loss: 0.389 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 26 cost time: 1.6347627639770508
Epoch: 26, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6254703998565674
Epoch: 27, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.373 Vali Acc: 0.817 Test Loss: 0.373 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.799100637435913
Epoch: 28, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.364 Vali Acc: 0.806 Test Loss: 0.364 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8367631435394287
Epoch: 29, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.356 Vali Acc: 0.822 Test Loss: 0.356 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 30 cost time: 1.6755166053771973
Epoch: 30, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.351 Vali Acc: 0.800 Test Loss: 0.351 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 92422
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2420713901519775
Epoch: 1, Steps: 12 | Train Loss: 1.795 Vali Loss: 1.748 Vali Acc: 0.211 Test Loss: 1.748 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 1.410740613937378
Epoch: 2, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.688 Vali Acc: 0.289 Test Loss: 1.688 Test Acc: 0.289
Validation loss decreased (-0.211094 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 1.1511363983154297
Epoch: 3, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.610 Vali Acc: 0.400 Test Loss: 1.610 Test Acc: 0.400
Validation loss decreased (-0.288872 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 1.3915550708770752
Epoch: 4, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.516 Vali Acc: 0.533 Test Loss: 1.516 Test Acc: 0.533
Validation loss decreased (-0.399984 --> -0.533318).  Saving model ...
Epoch: 5 cost time: 1.3551065921783447
Epoch: 5, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.412 Vali Acc: 0.617 Test Loss: 1.412 Test Acc: 0.617
Validation loss decreased (-0.533318 --> -0.616653).  Saving model ...
Epoch: 6 cost time: 1.4964632987976074
Epoch: 6, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.289 Vali Acc: 0.633 Test Loss: 1.289 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 1.460296392440796
Epoch: 7, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.163 Vali Acc: 0.667 Test Loss: 1.163 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 1.4780526161193848
Epoch: 8, Steps: 12 | Train Loss: 1.075 Vali Loss: 1.040 Vali Acc: 0.678 Test Loss: 1.040 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677767).  Saving model ...
Epoch: 9 cost time: 1.4202890396118164
Epoch: 9, Steps: 12 | Train Loss: 0.974 Vali Loss: 0.930 Vali Acc: 0.678 Test Loss: 0.930 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 1.34519624710083
Epoch: 10, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.845 Vali Acc: 0.722 Test Loss: 0.845 Test Acc: 0.722
Validation loss decreased (-0.677768 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 1.4352695941925049
Epoch: 11, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.773 Vali Acc: 0.689 Test Loss: 0.773 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4883038997650146
Epoch: 12, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.720 Vali Acc: 0.700 Test Loss: 0.720 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4763562679290771
Epoch: 13, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 14 cost time: 1.532811164855957
Epoch: 14, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.638 Vali Acc: 0.733 Test Loss: 0.638 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733327).  Saving model ...
Epoch: 15 cost time: 1.4724464416503906
Epoch: 15, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 1.4401204586029053
Epoch: 16, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.579 Vali Acc: 0.778 Test Loss: 0.579 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777772).  Saving model ...
Epoch: 17 cost time: 1.3678624629974365
Epoch: 17, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.544 Vali Acc: 0.767 Test Loss: 0.544 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4808311462402344
Epoch: 18, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.515 Vali Acc: 0.817 Test Loss: 0.515 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816662).  Saving model ...
Epoch: 19 cost time: 1.1105575561523438
Epoch: 19, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5254771709442139
Epoch: 20, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.451 Vali Acc: 0.811 Test Loss: 0.451 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.476456880569458
Epoch: 21, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
Validation loss decreased (-0.816662 --> -0.844440).  Saving model ...
Epoch: 22 cost time: 1.4646122455596924
Epoch: 22, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.420 Vali Acc: 0.806 Test Loss: 0.420 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.561692476272583
Epoch: 23, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.396 Vali Acc: 0.817 Test Loss: 0.396 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4670448303222656
Epoch: 24, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 25 cost time: 1.3287887573242188
Epoch: 25, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.363 Vali Acc: 0.822 Test Loss: 0.363 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4307217597961426
Epoch: 26, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5000324249267578
Epoch: 27, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.326 Vali Acc: 0.861 Test Loss: 0.326 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 28 cost time: 1.43265700340271
Epoch: 28, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 29 cost time: 1.4624032974243164
Epoch: 29, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.312 Vali Acc: 0.856 Test Loss: 0.312 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4838905334472656
Epoch: 30, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 299398
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.03475022315979
Epoch: 1, Steps: 12 | Train Loss: 1.871 Vali Loss: 1.833 Vali Acc: 0.106 Test Loss: 1.833 Test Acc: 0.106
Validation loss decreased (inf --> -0.105537).  Saving model ...
Epoch: 2 cost time: 1.2773704528808594
Epoch: 2, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.766 Vali Acc: 0.194 Test Loss: 1.766 Test Acc: 0.194
Validation loss decreased (-0.105537 --> -0.194427).  Saving model ...
Epoch: 3 cost time: 1.3135864734649658
Epoch: 3, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.678 Vali Acc: 0.322 Test Loss: 1.678 Test Acc: 0.322
Validation loss decreased (-0.194427 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 1.1703732013702393
Epoch: 4, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.576 Vali Acc: 0.456 Test Loss: 1.576 Test Acc: 0.456
Validation loss decreased (-0.322205 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 1.2533807754516602
Epoch: 5, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.461 Vali Acc: 0.533 Test Loss: 1.461 Test Acc: 0.533
Validation loss decreased (-0.455540 --> -0.533319).  Saving model ...
Epoch: 6 cost time: 1.1988623142242432
Epoch: 6, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.336 Vali Acc: 0.589 Test Loss: 1.336 Test Acc: 0.589
Validation loss decreased (-0.533319 --> -0.588876).  Saving model ...
Epoch: 7 cost time: 1.2621207237243652
Epoch: 7, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.208 Vali Acc: 0.633 Test Loss: 1.208 Test Acc: 0.633
Validation loss decreased (-0.588876 --> -0.633321).  Saving model ...
Epoch: 8 cost time: 1.3631000518798828
Epoch: 8, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.075 Vali Acc: 0.672 Test Loss: 1.075 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 9 cost time: 1.2936222553253174
Epoch: 9, Steps: 12 | Train Loss: 0.978 Vali Loss: 0.954 Vali Acc: 0.706 Test Loss: 0.954 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705546).  Saving model ...
Epoch: 10 cost time: 1.2882435321807861
Epoch: 10, Steps: 12 | Train Loss: 0.838 Vali Loss: 0.856 Vali Acc: 0.700 Test Loss: 0.856 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2449777126312256
Epoch: 11, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.769 Vali Acc: 0.733 Test Loss: 0.769 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 1.3041696548461914
Epoch: 12, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.701 Vali Acc: 0.733 Test Loss: 0.701 Test Acc: 0.733
Validation loss decreased (-0.733326 --> -0.733326).  Saving model ...
Epoch: 13 cost time: 1.2889792919158936
Epoch: 13, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.649 Vali Acc: 0.767 Test Loss: 0.649 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766660).  Saving model ...
Epoch: 14 cost time: 1.3455214500427246
Epoch: 14, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.608 Vali Acc: 0.778 Test Loss: 0.608 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 1.315467119216919
Epoch: 15, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783328).  Saving model ...
Epoch: 16 cost time: 1.2971463203430176
Epoch: 16, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.542 Vali Acc: 0.778 Test Loss: 0.542 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3395514488220215
Epoch: 17, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.513 Vali Acc: 0.800 Test Loss: 0.513 Test Acc: 0.800
Validation loss decreased (-0.783328 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 1.3115839958190918
Epoch: 18, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.491 Vali Acc: 0.811 Test Loss: 0.491 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811106).  Saving model ...
Epoch: 19 cost time: 1.2810730934143066
Epoch: 19, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.473 Vali Acc: 0.817 Test Loss: 0.473 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816662).  Saving model ...
Epoch: 20 cost time: 1.3359012603759766
Epoch: 20, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.458 Vali Acc: 0.817 Test Loss: 0.458 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 21 cost time: 1.3196148872375488
Epoch: 21, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3916587829589844
Epoch: 22, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.430 Vali Acc: 0.794 Test Loss: 0.430 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.366478443145752
Epoch: 23, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.415 Vali Acc: 0.806 Test Loss: 0.415 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3267512321472168
Epoch: 24, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 25 cost time: 1.378711462020874
Epoch: 25, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.391 Vali Acc: 0.822 Test Loss: 0.391 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 26 cost time: 1.339956283569336
Epoch: 26, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.387 Vali Acc: 0.806 Test Loss: 0.387 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3928534984588623
Epoch: 27, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.076484203338623
Epoch: 28, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.366 Vali Acc: 0.806 Test Loss: 0.366 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3685643672943115
Epoch: 29, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.357 Vali Acc: 0.822 Test Loss: 0.357 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822219).  Saving model ...
Epoch: 30 cost time: 1.337097406387329
Epoch: 30, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.353 Vali Acc: 0.794 Test Loss: 0.353 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 92422
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.447791814804077
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.808 Vali Acc: 0.244 Test Loss: 1.808 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 2.4087109565734863
Epoch: 2, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.741 Vali Acc: 0.267 Test Loss: 1.741 Test Acc: 0.267
Validation loss decreased (-0.244426 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 2.3696019649505615
Epoch: 3, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.655 Vali Acc: 0.272 Test Loss: 1.655 Test Acc: 0.272
Validation loss decreased (-0.266649 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 2.3220248222351074
Epoch: 4, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.559 Vali Acc: 0.328 Test Loss: 1.559 Test Acc: 0.328
Validation loss decreased (-0.272206 --> -0.327762).  Saving model ...
Epoch: 5 cost time: 2.3781628608703613
Epoch: 5, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.460 Vali Acc: 0.406 Test Loss: 1.460 Test Acc: 0.406
Validation loss decreased (-0.327762 --> -0.405541).  Saving model ...
Epoch: 6 cost time: 2.345653533935547
Epoch: 6, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.364 Vali Acc: 0.478 Test Loss: 1.364 Test Acc: 0.478
Validation loss decreased (-0.405541 --> -0.477764).  Saving model ...
Epoch: 7 cost time: 2.423285484313965
Epoch: 7, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.278 Vali Acc: 0.483 Test Loss: 1.278 Test Acc: 0.483
Validation loss decreased (-0.477764 --> -0.483321).  Saving model ...
Epoch: 8 cost time: 2.33113956451416
Epoch: 8, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.198 Vali Acc: 0.511 Test Loss: 1.198 Test Acc: 0.511
Validation loss decreased (-0.483321 --> -0.511099).  Saving model ...
Epoch: 9 cost time: 2.3688461780548096
Epoch: 9, Steps: 12 | Train Loss: 1.125 Vali Loss: 1.127 Vali Acc: 0.544 Test Loss: 1.127 Test Acc: 0.544
Validation loss decreased (-0.511099 --> -0.544433).  Saving model ...
Epoch: 10 cost time: 2.314427614212036
Epoch: 10, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.062 Vali Acc: 0.517 Test Loss: 1.062 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2841029167175293
Epoch: 11, Steps: 12 | Train Loss: 0.983 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3361079692840576
Epoch: 12, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.958 Vali Acc: 0.550 Test Loss: 0.958 Test Acc: 0.550
Validation loss decreased (-0.544433 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 2.3414852619171143
Epoch: 13, Steps: 12 | Train Loss: 0.897 Vali Loss: 0.915 Vali Acc: 0.583 Test Loss: 0.915 Test Acc: 0.583
Validation loss decreased (-0.549990 --> -0.583324).  Saving model ...
Epoch: 14 cost time: 2.3218414783477783
Epoch: 14, Steps: 12 | Train Loss: 0.867 Vali Loss: 0.875 Vali Acc: 0.600 Test Loss: 0.875 Test Acc: 0.600
Validation loss decreased (-0.583324 --> -0.599991).  Saving model ...
Epoch: 15 cost time: 2.305913209915161
Epoch: 15, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.839 Vali Acc: 0.606 Test Loss: 0.839 Test Acc: 0.606
Validation loss decreased (-0.599991 --> -0.605547).  Saving model ...
Epoch: 16 cost time: 1.9984116554260254
Epoch: 16, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.810 Vali Acc: 0.633 Test Loss: 0.810 Test Acc: 0.633
Validation loss decreased (-0.605547 --> -0.633325).  Saving model ...
Epoch: 17 cost time: 1.833993911743164
Epoch: 17, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.779 Vali Acc: 0.622 Test Loss: 0.779 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.325298309326172
Epoch: 18, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.745 Vali Acc: 0.633 Test Loss: 0.745 Test Acc: 0.633
Validation loss decreased (-0.633325 --> -0.633326).  Saving model ...
Epoch: 19 cost time: 1.710146188735962
Epoch: 19, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.705 Vali Acc: 0.689 Test Loss: 0.705 Test Acc: 0.689
Validation loss decreased (-0.633326 --> -0.688882).  Saving model ...
Epoch: 20 cost time: 1.7322983741760254
Epoch: 20, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.674 Vali Acc: 0.678 Test Loss: 0.674 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6964385509490967
Epoch: 21, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.632 Vali Acc: 0.733 Test Loss: 0.632 Test Acc: 0.733
Validation loss decreased (-0.688882 --> -0.733327).  Saving model ...
Epoch: 22 cost time: 1.677236795425415
Epoch: 22, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.572 Vali Acc: 0.744 Test Loss: 0.572 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 23 cost time: 2.026400327682495
Epoch: 23, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.515 Vali Acc: 0.739 Test Loss: 0.515 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3019964694976807
Epoch: 24, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.477 Vali Acc: 0.778 Test Loss: 0.477 Test Acc: 0.778
Validation loss decreased (-0.744439 --> -0.777773).  Saving model ...
Epoch: 25 cost time: 1.9702515602111816
Epoch: 25, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.449 Vali Acc: 0.783 Test Loss: 0.449 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 26 cost time: 2.25655460357666
Epoch: 26, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.411 Vali Acc: 0.772 Test Loss: 0.411 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8830277919769287
Epoch: 27, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.386 Vali Acc: 0.800 Test Loss: 0.386 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 28 cost time: 1.8989832401275635
Epoch: 28, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.383 Vali Acc: 0.778 Test Loss: 0.383 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.2678332328796387
Epoch: 29, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 30 cost time: 1.9649465084075928
Epoch: 30, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.367 Vali Acc: 0.794 Test Loss: 0.367 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 589670
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.753300666809082
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.826 Vali Acc: 0.144 Test Loss: 1.826 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 1.797753095626831
Epoch: 2, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.783 Vali Acc: 0.172 Test Loss: 1.783 Test Acc: 0.172
Validation loss decreased (-0.144426 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 1.5285601615905762
Epoch: 3, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.725 Vali Acc: 0.250 Test Loss: 1.725 Test Acc: 0.250
Validation loss decreased (-0.172204 --> -0.249983).  Saving model ...
Epoch: 4 cost time: 1.974499225616455
Epoch: 4, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.659 Vali Acc: 0.350 Test Loss: 1.659 Test Acc: 0.350
Validation loss decreased (-0.249983 --> -0.349983).  Saving model ...
Epoch: 5 cost time: 1.422581434249878
Epoch: 5, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.585 Vali Acc: 0.428 Test Loss: 1.585 Test Acc: 0.428
Validation loss decreased (-0.349983 --> -0.427762).  Saving model ...
Epoch: 6 cost time: 1.8215765953063965
Epoch: 6, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.499 Vali Acc: 0.489 Test Loss: 1.499 Test Acc: 0.489
Validation loss decreased (-0.427762 --> -0.488874).  Saving model ...
Epoch: 7 cost time: 1.5599298477172852
Epoch: 7, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.406 Vali Acc: 0.567 Test Loss: 1.406 Test Acc: 0.567
Validation loss decreased (-0.488874 --> -0.566653).  Saving model ...
Epoch: 8 cost time: 1.635507345199585
Epoch: 8, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.303 Vali Acc: 0.594 Test Loss: 1.303 Test Acc: 0.594
Validation loss decreased (-0.566653 --> -0.594431).  Saving model ...
Epoch: 9 cost time: 1.8881645202636719
Epoch: 9, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.198 Vali Acc: 0.656 Test Loss: 1.198 Test Acc: 0.656
Validation loss decreased (-0.594431 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 1.726853847503662
Epoch: 10, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.090 Vali Acc: 0.672 Test Loss: 1.090 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 1.4254770278930664
Epoch: 11, Steps: 12 | Train Loss: 1.012 Vali Loss: 0.998 Vali Acc: 0.711 Test Loss: 0.998 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 1.8873677253723145
Epoch: 12, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.913 Vali Acc: 0.739 Test Loss: 0.913 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 1.5904383659362793
Epoch: 13, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.842 Vali Acc: 0.711 Test Loss: 0.842 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.685060977935791
Epoch: 14, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6794564723968506
Epoch: 15, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7770729064941406
Epoch: 16, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.711 Vali Acc: 0.739 Test Loss: 0.711 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738882).  Saving model ...
Epoch: 17 cost time: 1.8430895805358887
Epoch: 17, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.680 Vali Acc: 0.756 Test Loss: 0.680 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 18 cost time: 1.6636698246002197
Epoch: 18, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5727407932281494
Epoch: 19, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.622 Vali Acc: 0.767 Test Loss: 0.622 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 20 cost time: 1.9257287979125977
Epoch: 20, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4809868335723877
Epoch: 21, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8428196907043457
Epoch: 22, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.541 Vali Acc: 0.806 Test Loss: 0.541 Test Acc: 0.806
Validation loss decreased (-0.766660 --> -0.805550).  Saving model ...
Epoch: 23 cost time: 1.7143058776855469
Epoch: 23, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.522 Vali Acc: 0.800 Test Loss: 0.522 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8634600639343262
Epoch: 24, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.500 Vali Acc: 0.806 Test Loss: 0.500 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805551).  Saving model ...
Epoch: 25 cost time: 1.912015438079834
Epoch: 25, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.477 Vali Acc: 0.800 Test Loss: 0.477 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7096953392028809
Epoch: 26, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.457 Vali Acc: 0.800 Test Loss: 0.457 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.655625581741333
Epoch: 27, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.437 Vali Acc: 0.817 Test Loss: 0.437 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 28 cost time: 2.0563979148864746
Epoch: 28, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.423 Vali Acc: 0.822 Test Loss: 0.423 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 29 cost time: 1.7495055198669434
Epoch: 29, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.411 Vali Acc: 0.828 Test Loss: 0.411 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827774).  Saving model ...
Epoch: 30 cost time: 1.8997867107391357
Epoch: 30, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.397 Vali Acc: 0.839 Test Loss: 0.397 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 175686
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6224262714385986
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.808 Vali Acc: 0.244 Test Loss: 1.808 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 1.7928166389465332
Epoch: 2, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.741 Vali Acc: 0.267 Test Loss: 1.741 Test Acc: 0.267
Validation loss decreased (-0.244426 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 2.0891640186309814
Epoch: 3, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.655 Vali Acc: 0.272 Test Loss: 1.655 Test Acc: 0.272
Validation loss decreased (-0.266649 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 1.7925686836242676
Epoch: 4, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.559 Vali Acc: 0.328 Test Loss: 1.559 Test Acc: 0.328
Validation loss decreased (-0.272206 --> -0.327762).  Saving model ...
Epoch: 5 cost time: 1.7271356582641602
Epoch: 5, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.460 Vali Acc: 0.406 Test Loss: 1.460 Test Acc: 0.406
Validation loss decreased (-0.327762 --> -0.405541).  Saving model ...
Epoch: 6 cost time: 1.5209298133850098
Epoch: 6, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.364 Vali Acc: 0.478 Test Loss: 1.364 Test Acc: 0.478
Validation loss decreased (-0.405541 --> -0.477764).  Saving model ...
Epoch: 7 cost time: 1.5560848712921143
Epoch: 7, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.278 Vali Acc: 0.483 Test Loss: 1.278 Test Acc: 0.483
Validation loss decreased (-0.477764 --> -0.483321).  Saving model ...
Epoch: 8 cost time: 1.5033602714538574
Epoch: 8, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.198 Vali Acc: 0.511 Test Loss: 1.198 Test Acc: 0.511
Validation loss decreased (-0.483321 --> -0.511099).  Saving model ...
Epoch: 9 cost time: 1.5943641662597656
Epoch: 9, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.127 Vali Acc: 0.539 Test Loss: 1.127 Test Acc: 0.539
Validation loss decreased (-0.511099 --> -0.538878).  Saving model ...
Epoch: 10 cost time: 1.639277458190918
Epoch: 10, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.062 Vali Acc: 0.517 Test Loss: 1.062 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6333491802215576
Epoch: 11, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.003 Vali Acc: 0.561 Test Loss: 1.003 Test Acc: 0.561
Validation loss decreased (-0.538878 --> -0.561101).  Saving model ...
Epoch: 12 cost time: 2.200472593307495
Epoch: 12, Steps: 12 | Train Loss: 0.924 Vali Loss: 0.956 Vali Acc: 0.556 Test Loss: 0.956 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.200204849243164
Epoch: 13, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.912 Vali Acc: 0.583 Test Loss: 0.912 Test Acc: 0.583
Validation loss decreased (-0.561101 --> -0.583324).  Saving model ...
Epoch: 14 cost time: 2.013101100921631
Epoch: 14, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.873 Vali Acc: 0.606 Test Loss: 0.873 Test Acc: 0.606
Validation loss decreased (-0.583324 --> -0.605547).  Saving model ...
Epoch: 15 cost time: 1.769101858139038
Epoch: 15, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.835 Vali Acc: 0.617 Test Loss: 0.835 Test Acc: 0.617
Validation loss decreased (-0.605547 --> -0.616658).  Saving model ...
Epoch: 16 cost time: 2.1197168827056885
Epoch: 16, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.802 Vali Acc: 0.633 Test Loss: 0.802 Test Acc: 0.633
Validation loss decreased (-0.616658 --> -0.633325).  Saving model ...
Epoch: 17 cost time: 2.019050121307373
Epoch: 17, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.770 Vali Acc: 0.639 Test Loss: 0.770 Test Acc: 0.639
Validation loss decreased (-0.633325 --> -0.638881).  Saving model ...
Epoch: 18 cost time: 1.9015388488769531
Epoch: 18, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.735 Vali Acc: 0.656 Test Loss: 0.735 Test Acc: 0.656
Validation loss decreased (-0.638881 --> -0.655548).  Saving model ...
Epoch: 19 cost time: 1.6048259735107422
Epoch: 19, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.697 Vali Acc: 0.700 Test Loss: 0.697 Test Acc: 0.700
Validation loss decreased (-0.655548 --> -0.699993).  Saving model ...
Epoch: 20 cost time: 2.1546788215637207
Epoch: 20, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.666 Vali Acc: 0.694 Test Loss: 0.666 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1234872341156006
Epoch: 21, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.611 Vali Acc: 0.733 Test Loss: 0.611 Test Acc: 0.733
Validation loss decreased (-0.699993 --> -0.733327).  Saving model ...
Epoch: 22 cost time: 1.9022510051727295
Epoch: 22, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.546 Vali Acc: 0.772 Test Loss: 0.546 Test Acc: 0.772
Validation loss decreased (-0.733327 --> -0.772217).  Saving model ...
Epoch: 23 cost time: 1.951859474182129
Epoch: 23, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.486 Vali Acc: 0.761 Test Loss: 0.486 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0808663368225098
Epoch: 24, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.455 Vali Acc: 0.783 Test Loss: 0.455 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783329).  Saving model ...
Epoch: 25 cost time: 2.124112129211426
Epoch: 25, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799996).  Saving model ...
Epoch: 26 cost time: 1.929344892501831
Epoch: 26, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.402 Vali Acc: 0.783 Test Loss: 0.402 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0308284759521484
Epoch: 27, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.379 Vali Acc: 0.800 Test Loss: 0.379 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 28 cost time: 1.6925766468048096
Epoch: 28, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.376 Vali Acc: 0.794 Test Loss: 0.376 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0933642387390137
Epoch: 29, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.385 Vali Acc: 0.806 Test Loss: 0.385 Test Acc: 0.806
Validation loss decreased (-0.799996 --> -0.805552).  Saving model ...
Epoch: 30 cost time: 2.122819662094116
Epoch: 30, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.362 Vali Acc: 0.811 Test Loss: 0.362 Test Acc: 0.811
Validation loss decreased (-0.805552 --> -0.811107).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 589670
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4506235122680664
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.826 Vali Acc: 0.144 Test Loss: 1.826 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 1.7799549102783203
Epoch: 2, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.783 Vali Acc: 0.172 Test Loss: 1.783 Test Acc: 0.172
Validation loss decreased (-0.144426 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 1.488358974456787
Epoch: 3, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.725 Vali Acc: 0.250 Test Loss: 1.725 Test Acc: 0.250
Validation loss decreased (-0.172204 --> -0.249983).  Saving model ...
Epoch: 4 cost time: 1.806161642074585
Epoch: 4, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.659 Vali Acc: 0.350 Test Loss: 1.659 Test Acc: 0.350
Validation loss decreased (-0.249983 --> -0.349983).  Saving model ...
Epoch: 5 cost time: 1.806731939315796
Epoch: 5, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.585 Vali Acc: 0.428 Test Loss: 1.585 Test Acc: 0.428
Validation loss decreased (-0.349983 --> -0.427762).  Saving model ...
Epoch: 6 cost time: 1.684068202972412
Epoch: 6, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.499 Vali Acc: 0.489 Test Loss: 1.499 Test Acc: 0.489
Validation loss decreased (-0.427762 --> -0.488874).  Saving model ...
Epoch: 7 cost time: 1.6095223426818848
Epoch: 7, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.406 Vali Acc: 0.567 Test Loss: 1.406 Test Acc: 0.567
Validation loss decreased (-0.488874 --> -0.566653).  Saving model ...
Epoch: 8 cost time: 1.8280255794525146
Epoch: 8, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.303 Vali Acc: 0.594 Test Loss: 1.303 Test Acc: 0.594
Validation loss decreased (-0.566653 --> -0.594431).  Saving model ...
Epoch: 9 cost time: 1.762848138809204
Epoch: 9, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.198 Vali Acc: 0.656 Test Loss: 1.198 Test Acc: 0.656
Validation loss decreased (-0.594431 --> -0.655544).  Saving model ...
Epoch: 10 cost time: 1.5683753490447998
Epoch: 10, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.090 Vali Acc: 0.672 Test Loss: 1.090 Test Acc: 0.672
Validation loss decreased (-0.655544 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 1.3564906120300293
Epoch: 11, Steps: 12 | Train Loss: 1.012 Vali Loss: 0.998 Vali Acc: 0.711 Test Loss: 0.998 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 1.7712855339050293
Epoch: 12, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.912 Vali Acc: 0.739 Test Loss: 0.912 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 1.7529408931732178
Epoch: 13, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.842 Vali Acc: 0.711 Test Loss: 0.842 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.617511510848999
Epoch: 14, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.785 Vali Acc: 0.717 Test Loss: 0.785 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7476704120635986
Epoch: 15, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6826093196868896
Epoch: 16, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.711 Vali Acc: 0.739 Test Loss: 0.711 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738882).  Saving model ...
Epoch: 17 cost time: 1.7872490882873535
Epoch: 17, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.679 Vali Acc: 0.756 Test Loss: 0.679 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755549).  Saving model ...
Epoch: 18 cost time: 1.7244749069213867
Epoch: 18, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6740667819976807
Epoch: 19, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.622 Vali Acc: 0.767 Test Loss: 0.622 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 20 cost time: 1.7733445167541504
Epoch: 20, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.597 Vali Acc: 0.761 Test Loss: 0.597 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7674741744995117
Epoch: 21, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.570 Vali Acc: 0.761 Test Loss: 0.570 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7016620635986328
Epoch: 22, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799995).  Saving model ...
Epoch: 23 cost time: 1.6796839237213135
Epoch: 23, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.522 Vali Acc: 0.800 Test Loss: 0.522 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 24 cost time: 1.772176742553711
Epoch: 24, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.500 Vali Acc: 0.806 Test Loss: 0.500 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 25 cost time: 1.8327033519744873
Epoch: 25, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.477 Vali Acc: 0.800 Test Loss: 0.477 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5695054531097412
Epoch: 26, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.458 Vali Acc: 0.800 Test Loss: 0.458 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.543074607849121
Epoch: 27, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.438 Vali Acc: 0.817 Test Loss: 0.438 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 28 cost time: 1.733206033706665
Epoch: 28, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.423 Vali Acc: 0.822 Test Loss: 0.423 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 29 cost time: 1.562037706375122
Epoch: 29, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 30 cost time: 1.7599074840545654
Epoch: 30, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.402 Vali Acc: 0.828 Test Loss: 0.402 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 175686
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0889554023742676
Epoch: 1, Steps: 12 | Train Loss: 1.797 Vali Loss: 1.808 Vali Acc: 0.244 Test Loss: 1.808 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 1.6208245754241943
Epoch: 2, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.742 Vali Acc: 0.267 Test Loss: 1.742 Test Acc: 0.267
Validation loss decreased (-0.244426 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 1.659358024597168
Epoch: 3, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.655 Vali Acc: 0.272 Test Loss: 1.655 Test Acc: 0.272
Validation loss decreased (-0.266649 --> -0.272206).  Saving model ...
Epoch: 4 cost time: 1.6441662311553955
Epoch: 4, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.560 Vali Acc: 0.328 Test Loss: 1.560 Test Acc: 0.328
Validation loss decreased (-0.272206 --> -0.327762).  Saving model ...
Epoch: 5 cost time: 1.591773271560669
Epoch: 5, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.461 Vali Acc: 0.406 Test Loss: 1.461 Test Acc: 0.406
Validation loss decreased (-0.327762 --> -0.405541).  Saving model ...
Epoch: 6 cost time: 1.5924551486968994
Epoch: 6, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.365 Vali Acc: 0.472 Test Loss: 1.365 Test Acc: 0.472
Validation loss decreased (-0.405541 --> -0.472209).  Saving model ...
Epoch: 7 cost time: 1.5087108612060547
Epoch: 7, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.280 Vali Acc: 0.478 Test Loss: 1.280 Test Acc: 0.478
Validation loss decreased (-0.472209 --> -0.477765).  Saving model ...
Epoch: 8 cost time: 1.6237750053405762
Epoch: 8, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.200 Vali Acc: 0.511 Test Loss: 1.200 Test Acc: 0.511
Validation loss decreased (-0.477765 --> -0.511099).  Saving model ...
Epoch: 9 cost time: 1.6920113563537598
Epoch: 9, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.129 Vali Acc: 0.539 Test Loss: 1.129 Test Acc: 0.539
Validation loss decreased (-0.511099 --> -0.538878).  Saving model ...
Epoch: 10 cost time: 1.6579201221466064
Epoch: 10, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.063 Vali Acc: 0.517 Test Loss: 1.063 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5620620250701904
Epoch: 11, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.004 Vali Acc: 0.556 Test Loss: 1.004 Test Acc: 0.556
Validation loss decreased (-0.538878 --> -0.555546).  Saving model ...
Epoch: 12 cost time: 1.6810765266418457
Epoch: 12, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.957 Vali Acc: 0.556 Test Loss: 0.957 Test Acc: 0.556
Validation loss decreased (-0.555546 --> -0.555546).  Saving model ...
Epoch: 13 cost time: 1.64070463180542
Epoch: 13, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.914 Vali Acc: 0.583 Test Loss: 0.914 Test Acc: 0.583
Validation loss decreased (-0.555546 --> -0.583324).  Saving model ...
Epoch: 14 cost time: 1.506072998046875
Epoch: 14, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.875 Vali Acc: 0.606 Test Loss: 0.875 Test Acc: 0.606
Validation loss decreased (-0.583324 --> -0.605547).  Saving model ...
Epoch: 15 cost time: 1.3750803470611572
Epoch: 15, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.837 Vali Acc: 0.617 Test Loss: 0.837 Test Acc: 0.617
Validation loss decreased (-0.605547 --> -0.616658).  Saving model ...
Epoch: 16 cost time: 1.4033622741699219
Epoch: 16, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.803 Vali Acc: 0.639 Test Loss: 0.803 Test Acc: 0.639
Validation loss decreased (-0.616658 --> -0.638881).  Saving model ...
Epoch: 17 cost time: 1.6351680755615234
Epoch: 17, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.772 Vali Acc: 0.650 Test Loss: 0.772 Test Acc: 0.650
Validation loss decreased (-0.638881 --> -0.649992).  Saving model ...
Epoch: 18 cost time: 1.6242952346801758
Epoch: 18, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.737 Vali Acc: 0.661 Test Loss: 0.737 Test Acc: 0.661
Validation loss decreased (-0.649992 --> -0.661104).  Saving model ...
Epoch: 19 cost time: 1.596836805343628
Epoch: 19, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
Validation loss decreased (-0.661104 --> -0.716660).  Saving model ...
Epoch: 20 cost time: 1.551630973815918
Epoch: 20, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.670 Vali Acc: 0.689 Test Loss: 0.670 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.652879238128662
Epoch: 21, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.624 Vali Acc: 0.733 Test Loss: 0.624 Test Acc: 0.733
Validation loss decreased (-0.716660 --> -0.733327).  Saving model ...
Epoch: 22 cost time: 1.729835033416748
Epoch: 22, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.584 Vali Acc: 0.744 Test Loss: 0.584 Test Acc: 0.744
Validation loss decreased (-0.733327 --> -0.744439).  Saving model ...
Epoch: 23 cost time: 1.5162501335144043
Epoch: 23, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4044814109802246
Epoch: 24, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.529 Vali Acc: 0.744 Test Loss: 0.529 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744439).  Saving model ...
Epoch: 25 cost time: 1.5191359519958496
Epoch: 25, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.511 Vali Acc: 0.750 Test Loss: 0.511 Test Acc: 0.750
Validation loss decreased (-0.744439 --> -0.749995).  Saving model ...
Epoch: 26 cost time: 1.672980785369873
Epoch: 26, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.487 Vali Acc: 0.728 Test Loss: 0.487 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6841182708740234
Epoch: 27, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.783329).  Saving model ...
Epoch: 28 cost time: 1.6383814811706543
Epoch: 28, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.455 Vali Acc: 0.767 Test Loss: 0.455 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5278637409210205
Epoch: 29, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.430 Vali Acc: 0.778 Test Loss: 0.430 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.624403953552246
Epoch: 30, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.416 Vali Acc: 0.783 Test Loss: 0.416 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 589670
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1255297660827637
Epoch: 1, Steps: 12 | Train Loss: 1.889 Vali Loss: 1.826 Vali Acc: 0.144 Test Loss: 1.826 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 1.4679455757141113
Epoch: 2, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.783 Vali Acc: 0.172 Test Loss: 1.783 Test Acc: 0.172
Validation loss decreased (-0.144426 --> -0.172204).  Saving model ...
Epoch: 3 cost time: 1.2300691604614258
Epoch: 3, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.726 Vali Acc: 0.250 Test Loss: 1.726 Test Acc: 0.250
Validation loss decreased (-0.172204 --> -0.249983).  Saving model ...
Epoch: 4 cost time: 1.3395655155181885
Epoch: 4, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.661 Vali Acc: 0.350 Test Loss: 1.661 Test Acc: 0.350
Validation loss decreased (-0.249983 --> -0.349983).  Saving model ...
Epoch: 5 cost time: 1.515453815460205
Epoch: 5, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.588 Vali Acc: 0.422 Test Loss: 1.588 Test Acc: 0.422
Validation loss decreased (-0.349983 --> -0.422206).  Saving model ...
Epoch: 6 cost time: 1.447829008102417
Epoch: 6, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.504 Vali Acc: 0.494 Test Loss: 1.504 Test Acc: 0.494
Validation loss decreased (-0.422206 --> -0.494429).  Saving model ...
Epoch: 7 cost time: 1.4682786464691162
Epoch: 7, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.412 Vali Acc: 0.561 Test Loss: 1.412 Test Acc: 0.561
Validation loss decreased (-0.494429 --> -0.561097).  Saving model ...
Epoch: 8 cost time: 1.3694417476654053
Epoch: 8, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.311 Vali Acc: 0.594 Test Loss: 1.311 Test Acc: 0.594
Validation loss decreased (-0.561097 --> -0.594431).  Saving model ...
Epoch: 9 cost time: 1.4175195693969727
Epoch: 9, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.207 Vali Acc: 0.644 Test Loss: 1.207 Test Acc: 0.644
Validation loss decreased (-0.594431 --> -0.644432).  Saving model ...
Epoch: 10 cost time: 1.4426171779632568
Epoch: 10, Steps: 12 | Train Loss: 1.119 Vali Loss: 1.100 Vali Acc: 0.672 Test Loss: 1.100 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 1.4320487976074219
Epoch: 11, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.009 Vali Acc: 0.706 Test Loss: 1.009 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 1.488032341003418
Epoch: 12, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.925 Vali Acc: 0.733 Test Loss: 0.925 Test Acc: 0.733
Validation loss decreased (-0.705545 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 1.3451321125030518
Epoch: 13, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.856 Vali Acc: 0.700 Test Loss: 0.856 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2855005264282227
Epoch: 14, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.797 Vali Acc: 0.711 Test Loss: 0.797 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4533507823944092
Epoch: 15, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.755 Vali Acc: 0.706 Test Loss: 0.755 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5117790699005127
Epoch: 16, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.723 Vali Acc: 0.722 Test Loss: 0.723 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3261687755584717
Epoch: 17, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755549).  Saving model ...
Epoch: 18 cost time: 1.4092512130737305
Epoch: 18, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.665 Vali Acc: 0.744 Test Loss: 0.665 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1429994106292725
Epoch: 19, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4474868774414062
Epoch: 20, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 21 cost time: 1.166700839996338
Epoch: 21, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.581 Vali Acc: 0.772 Test Loss: 0.581 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772216).  Saving model ...
Epoch: 22 cost time: 1.1361021995544434
Epoch: 22, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
Validation loss decreased (-0.772216 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 1.1226115226745605
Epoch: 23, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 24 cost time: 0.9669091701507568
Epoch: 24, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.512 Vali Acc: 0.806 Test Loss: 0.512 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805550).  Saving model ...
Epoch: 25 cost time: 1.0696673393249512
Epoch: 25, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1197354793548584
Epoch: 26, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.468 Vali Acc: 0.800 Test Loss: 0.468 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1094107627868652
Epoch: 27, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.450 Vali Acc: 0.817 Test Loss: 0.450 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816662).  Saving model ...
Epoch: 28 cost time: 1.4261081218719482
Epoch: 28, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.435 Vali Acc: 0.811 Test Loss: 0.435 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2815477848052979
Epoch: 29, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.420 Vali Acc: 0.828 Test Loss: 0.420 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 30 cost time: 1.253343105316162
Epoch: 30, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.413 Vali Acc: 0.828 Test Loss: 0.413 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 175686
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6753766536712646
Epoch: 1, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.898 Vali Acc: 0.161 Test Loss: 1.898 Test Acc: 0.161
Validation loss decreased (inf --> -0.161092).  Saving model ...
Epoch: 2 cost time: 1.956512689590454
Epoch: 2, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.854 Vali Acc: 0.156 Test Loss: 1.854 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7997024059295654
Epoch: 3, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.801 Vali Acc: 0.178 Test Loss: 1.801 Test Acc: 0.178
Validation loss decreased (-0.161092 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 1.97184157371521
Epoch: 4, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.742 Vali Acc: 0.206 Test Loss: 1.742 Test Acc: 0.206
Validation loss decreased (-0.177760 --> -0.205538).  Saving model ...
Epoch: 5 cost time: 1.8709030151367188
Epoch: 5, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.679 Vali Acc: 0.317 Test Loss: 1.679 Test Acc: 0.317
Validation loss decreased (-0.205538 --> -0.316650).  Saving model ...
Epoch: 6 cost time: 2.125861883163452
Epoch: 6, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.613 Vali Acc: 0.372 Test Loss: 1.613 Test Acc: 0.372
Validation loss decreased (-0.316650 --> -0.372206).  Saving model ...
Epoch: 7 cost time: 1.9125981330871582
Epoch: 7, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.545 Vali Acc: 0.461 Test Loss: 1.545 Test Acc: 0.461
Validation loss decreased (-0.372206 --> -0.461096).  Saving model ...
Epoch: 8 cost time: 2.09623384475708
Epoch: 8, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.467 Vali Acc: 0.506 Test Loss: 1.467 Test Acc: 0.506
Validation loss decreased (-0.461096 --> -0.505541).  Saving model ...
Epoch: 9 cost time: 1.718400239944458
Epoch: 9, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.381 Vali Acc: 0.572 Test Loss: 1.381 Test Acc: 0.572
Validation loss decreased (-0.505541 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 2.18326997756958
Epoch: 10, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.289 Vali Acc: 0.600 Test Loss: 1.289 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 2.0299313068389893
Epoch: 11, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.198 Vali Acc: 0.606 Test Loss: 1.198 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605544).  Saving model ...
Epoch: 12 cost time: 2.2104246616363525
Epoch: 12, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.112 Vali Acc: 0.606 Test Loss: 1.112 Test Acc: 0.606
Validation loss decreased (-0.605544 --> -0.605544).  Saving model ...
Epoch: 13 cost time: 1.9487638473510742
Epoch: 13, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.028 Vali Acc: 0.628 Test Loss: 1.028 Test Acc: 0.628
Validation loss decreased (-0.605544 --> -0.627767).  Saving model ...
Epoch: 14 cost time: 2.1905856132507324
Epoch: 14, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.952 Vali Acc: 0.644 Test Loss: 0.952 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644435).  Saving model ...
Epoch: 15 cost time: 1.8965826034545898
Epoch: 15, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.878 Vali Acc: 0.678 Test Loss: 0.878 Test Acc: 0.678
Validation loss decreased (-0.644435 --> -0.677769).  Saving model ...
Epoch: 16 cost time: 2.228872299194336
Epoch: 16, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.819 Vali Acc: 0.711 Test Loss: 0.819 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711103).  Saving model ...
Epoch: 17 cost time: 2.0855886936187744
Epoch: 17, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.769 Vali Acc: 0.711 Test Loss: 0.769 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 18 cost time: 2.2179229259490967
Epoch: 18, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.725 Vali Acc: 0.706 Test Loss: 0.725 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.979013442993164
Epoch: 19, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.685 Vali Acc: 0.739 Test Loss: 0.685 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738882).  Saving model ...
Epoch: 20 cost time: 2.167703866958618
Epoch: 20, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.652 Vali Acc: 0.739 Test Loss: 0.652 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 21 cost time: 1.9498403072357178
Epoch: 21, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.618 Vali Acc: 0.744 Test Loss: 0.618 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 22 cost time: 1.982813835144043
Epoch: 22, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.594 Vali Acc: 0.744 Test Loss: 0.594 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744439).  Saving model ...
Epoch: 23 cost time: 1.8532133102416992
Epoch: 23, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.568 Vali Acc: 0.739 Test Loss: 0.568 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9325428009033203
Epoch: 24, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.546 Vali Acc: 0.739 Test Loss: 0.546 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8632996082305908
Epoch: 25, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.509 Vali Acc: 0.744 Test Loss: 0.509 Test Acc: 0.744
Validation loss decreased (-0.744439 --> -0.744439).  Saving model ...
Epoch: 26 cost time: 1.9514992237091064
Epoch: 26, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.477 Vali Acc: 0.756 Test Loss: 0.477 Test Acc: 0.756
Validation loss decreased (-0.744439 --> -0.755551).  Saving model ...
Epoch: 27 cost time: 1.9642202854156494
Epoch: 27, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.447 Vali Acc: 0.778 Test Loss: 0.447 Test Acc: 0.778
Validation loss decreased (-0.755551 --> -0.777773).  Saving model ...
Epoch: 28 cost time: 1.9852685928344727
Epoch: 28, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.422 Vali Acc: 0.783 Test Loss: 0.422 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 29 cost time: 1.959211826324463
Epoch: 29, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.417 Vali Acc: 0.772 Test Loss: 0.417 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.840552806854248
Epoch: 30, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.410 Vali Acc: 0.822 Test Loss: 0.410 Test Acc: 0.822
Validation loss decreased (-0.783329 --> -0.822218).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 296422
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.44010329246521
Epoch: 1, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.858 Vali Acc: 0.167 Test Loss: 1.858 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 1.48661208152771
Epoch: 2, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.824 Vali Acc: 0.206 Test Loss: 1.824 Test Acc: 0.206
Validation loss decreased (-0.166648 --> -0.205537).  Saving model ...
Epoch: 3 cost time: 1.836927890777588
Epoch: 3, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.781 Vali Acc: 0.222 Test Loss: 1.781 Test Acc: 0.222
Validation loss decreased (-0.205537 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 2.040813684463501
Epoch: 4, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.730 Vali Acc: 0.283 Test Loss: 1.730 Test Acc: 0.283
Validation loss decreased (-0.222204 --> -0.283316).  Saving model ...
Epoch: 5 cost time: 1.9853789806365967
Epoch: 5, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.673 Vali Acc: 0.339 Test Loss: 1.673 Test Acc: 0.339
Validation loss decreased (-0.283316 --> -0.338872).  Saving model ...
Epoch: 6 cost time: 1.8172063827514648
Epoch: 6, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.612 Vali Acc: 0.394 Test Loss: 1.612 Test Acc: 0.394
Validation loss decreased (-0.338872 --> -0.394428).  Saving model ...
Epoch: 7 cost time: 1.716059923171997
Epoch: 7, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.546 Vali Acc: 0.467 Test Loss: 1.546 Test Acc: 0.467
Validation loss decreased (-0.394428 --> -0.466651).  Saving model ...
Epoch: 8 cost time: 2.0130200386047363
Epoch: 8, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.471 Vali Acc: 0.511 Test Loss: 1.471 Test Acc: 0.511
Validation loss decreased (-0.466651 --> -0.511096).  Saving model ...
Epoch: 9 cost time: 1.950096845626831
Epoch: 9, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.391 Vali Acc: 0.550 Test Loss: 1.391 Test Acc: 0.550
Validation loss decreased (-0.511096 --> -0.549986).  Saving model ...
Epoch: 10 cost time: 1.8529584407806396
Epoch: 10, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
Validation loss decreased (-0.549986 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.7023932933807373
Epoch: 11, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.205 Vali Acc: 0.633 Test Loss: 1.205 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 1.8462531566619873
Epoch: 12, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.112 Vali Acc: 0.678 Test Loss: 1.112 Test Acc: 0.678
Validation loss decreased (-0.633321 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 1.9788014888763428
Epoch: 13, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.021 Vali Acc: 0.706 Test Loss: 1.021 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 1.783660888671875
Epoch: 14, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.936 Vali Acc: 0.711 Test Loss: 0.936 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711102).  Saving model ...
Epoch: 15 cost time: 1.7963697910308838
Epoch: 15, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.864 Vali Acc: 0.739 Test Loss: 0.864 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 1.6936728954315186
Epoch: 16, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 1.8915679454803467
Epoch: 17, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.740 Vali Acc: 0.761 Test Loss: 0.740 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 1.8911256790161133
Epoch: 18, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 1.9015531539916992
Epoch: 19, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.649 Vali Acc: 0.794 Test Loss: 0.649 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 20 cost time: 1.6217515468597412
Epoch: 20, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.900991678237915
Epoch: 21, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805550).  Saving model ...
Epoch: 22 cost time: 1.921907901763916
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822217).  Saving model ...
Epoch: 23 cost time: 1.8731544017791748
Epoch: 23, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.516 Vali Acc: 0.817 Test Loss: 0.516 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.786133050918579
Epoch: 24, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.822217 --> -0.855551).  Saving model ...
Epoch: 25 cost time: 1.8642699718475342
Epoch: 25, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.471 Vali Acc: 0.839 Test Loss: 0.471 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8876469135284424
Epoch: 26, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.457 Vali Acc: 0.839 Test Loss: 0.457 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7527484893798828
Epoch: 27, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5888535976409912
Epoch: 28, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.423 Vali Acc: 0.856 Test Loss: 0.423 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 29 cost time: 1.7549786567687988
Epoch: 29, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8471856117248535
Epoch: 30, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 89414
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6417462825775146
Epoch: 1, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.898 Vali Acc: 0.161 Test Loss: 1.898 Test Acc: 0.161
Validation loss decreased (inf --> -0.161092).  Saving model ...
Epoch: 2 cost time: 1.475632667541504
Epoch: 2, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.854 Vali Acc: 0.156 Test Loss: 1.854 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6528527736663818
Epoch: 3, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.801 Vali Acc: 0.178 Test Loss: 1.801 Test Acc: 0.178
Validation loss decreased (-0.161092 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 1.6232144832611084
Epoch: 4, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.742 Vali Acc: 0.206 Test Loss: 1.742 Test Acc: 0.206
Validation loss decreased (-0.177760 --> -0.205538).  Saving model ...
Epoch: 5 cost time: 1.8634898662567139
Epoch: 5, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.679 Vali Acc: 0.317 Test Loss: 1.679 Test Acc: 0.317
Validation loss decreased (-0.205538 --> -0.316650).  Saving model ...
Epoch: 6 cost time: 1.8372972011566162
Epoch: 6, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.613 Vali Acc: 0.372 Test Loss: 1.613 Test Acc: 0.372
Validation loss decreased (-0.316650 --> -0.372206).  Saving model ...
Epoch: 7 cost time: 1.7081177234649658
Epoch: 7, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.545 Vali Acc: 0.461 Test Loss: 1.545 Test Acc: 0.461
Validation loss decreased (-0.372206 --> -0.461096).  Saving model ...
Epoch: 8 cost time: 1.8396730422973633
Epoch: 8, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.467 Vali Acc: 0.506 Test Loss: 1.467 Test Acc: 0.506
Validation loss decreased (-0.461096 --> -0.505541).  Saving model ...
Epoch: 9 cost time: 1.7861747741699219
Epoch: 9, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.381 Vali Acc: 0.572 Test Loss: 1.381 Test Acc: 0.572
Validation loss decreased (-0.505541 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 1.8339934349060059
Epoch: 10, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.289 Vali Acc: 0.600 Test Loss: 1.289 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.7985105514526367
Epoch: 11, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.198 Vali Acc: 0.606 Test Loss: 1.198 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605544).  Saving model ...
Epoch: 12 cost time: 1.894658088684082
Epoch: 12, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.112 Vali Acc: 0.606 Test Loss: 1.112 Test Acc: 0.606
Validation loss decreased (-0.605544 --> -0.605544).  Saving model ...
Epoch: 13 cost time: 1.97166109085083
Epoch: 13, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.028 Vali Acc: 0.622 Test Loss: 1.028 Test Acc: 0.622
Validation loss decreased (-0.605544 --> -0.622212).  Saving model ...
Epoch: 14 cost time: 1.9114649295806885
Epoch: 14, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.951 Vali Acc: 0.644 Test Loss: 0.951 Test Acc: 0.644
Validation loss decreased (-0.622212 --> -0.644435).  Saving model ...
Epoch: 15 cost time: 1.8801214694976807
Epoch: 15, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.877 Vali Acc: 0.683 Test Loss: 0.877 Test Acc: 0.683
Validation loss decreased (-0.644435 --> -0.683325).  Saving model ...
Epoch: 16 cost time: 1.779595136642456
Epoch: 16, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.818 Vali Acc: 0.711 Test Loss: 0.818 Test Acc: 0.711
Validation loss decreased (-0.683325 --> -0.711103).  Saving model ...
Epoch: 17 cost time: 1.640073537826538
Epoch: 17, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.768 Vali Acc: 0.711 Test Loss: 0.768 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 18 cost time: 1.9834063053131104
Epoch: 18, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.723 Vali Acc: 0.711 Test Loss: 0.723 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711104).  Saving model ...
Epoch: 19 cost time: 1.9980859756469727
Epoch: 19, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.683 Vali Acc: 0.739 Test Loss: 0.683 Test Acc: 0.739
Validation loss decreased (-0.711104 --> -0.738882).  Saving model ...
Epoch: 20 cost time: 1.9259891510009766
Epoch: 20, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738882).  Saving model ...
Epoch: 21 cost time: 1.828437328338623
Epoch: 21, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.614 Vali Acc: 0.744 Test Loss: 0.614 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 22 cost time: 1.9256596565246582
Epoch: 22, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.589 Vali Acc: 0.739 Test Loss: 0.589 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9909892082214355
Epoch: 23, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.563 Vali Acc: 0.733 Test Loss: 0.563 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9140450954437256
Epoch: 24, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.543 Vali Acc: 0.733 Test Loss: 0.543 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.752338171005249
Epoch: 25, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.508 Vali Acc: 0.744 Test Loss: 0.508 Test Acc: 0.744
Validation loss decreased (-0.744438 --> -0.744439).  Saving model ...
Epoch: 26 cost time: 2.0180413722991943
Epoch: 26, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.472 Vali Acc: 0.767 Test Loss: 0.472 Test Acc: 0.767
Validation loss decreased (-0.744439 --> -0.766662).  Saving model ...
Epoch: 27 cost time: 2.020392656326294
Epoch: 27, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.446 Vali Acc: 0.783 Test Loss: 0.446 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 28 cost time: 2.0210511684417725
Epoch: 28, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.433 Vali Acc: 0.772 Test Loss: 0.433 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.974640130996704
Epoch: 29, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.428 Vali Acc: 0.772 Test Loss: 0.428 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7416625022888184
Epoch: 30, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.401 Vali Acc: 0.828 Test Loss: 0.401 Test Acc: 0.828
Validation loss decreased (-0.783329 --> -0.827774).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 296422
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2938501834869385
Epoch: 1, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.858 Vali Acc: 0.167 Test Loss: 1.858 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 1.783677101135254
Epoch: 2, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.824 Vali Acc: 0.206 Test Loss: 1.824 Test Acc: 0.206
Validation loss decreased (-0.166648 --> -0.205537).  Saving model ...
Epoch: 3 cost time: 1.789435863494873
Epoch: 3, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.781 Vali Acc: 0.222 Test Loss: 1.781 Test Acc: 0.222
Validation loss decreased (-0.205537 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 1.7435228824615479
Epoch: 4, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.730 Vali Acc: 0.283 Test Loss: 1.730 Test Acc: 0.283
Validation loss decreased (-0.222204 --> -0.283316).  Saving model ...
Epoch: 5 cost time: 1.7495052814483643
Epoch: 5, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.673 Vali Acc: 0.339 Test Loss: 1.673 Test Acc: 0.339
Validation loss decreased (-0.283316 --> -0.338872).  Saving model ...
Epoch: 6 cost time: 1.7418828010559082
Epoch: 6, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.612 Vali Acc: 0.394 Test Loss: 1.612 Test Acc: 0.394
Validation loss decreased (-0.338872 --> -0.394428).  Saving model ...
Epoch: 7 cost time: 1.7507579326629639
Epoch: 7, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.546 Vali Acc: 0.467 Test Loss: 1.546 Test Acc: 0.467
Validation loss decreased (-0.394428 --> -0.466651).  Saving model ...
Epoch: 8 cost time: 1.7866065502166748
Epoch: 8, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.471 Vali Acc: 0.511 Test Loss: 1.471 Test Acc: 0.511
Validation loss decreased (-0.466651 --> -0.511096).  Saving model ...
Epoch: 9 cost time: 1.729745626449585
Epoch: 9, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.391 Vali Acc: 0.550 Test Loss: 1.391 Test Acc: 0.550
Validation loss decreased (-0.511096 --> -0.549986).  Saving model ...
Epoch: 10 cost time: 1.494929313659668
Epoch: 10, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
Validation loss decreased (-0.549986 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.5716335773468018
Epoch: 11, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.204 Vali Acc: 0.633 Test Loss: 1.204 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 1.772700548171997
Epoch: 12, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
Validation loss decreased (-0.633321 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 1.7753989696502686
Epoch: 13, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.021 Vali Acc: 0.706 Test Loss: 1.021 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 1.6927213668823242
Epoch: 14, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.936 Vali Acc: 0.711 Test Loss: 0.936 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711102).  Saving model ...
Epoch: 15 cost time: 1.7527437210083008
Epoch: 15, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.864 Vali Acc: 0.739 Test Loss: 0.864 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 1.7497286796569824
Epoch: 16, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.799 Vali Acc: 0.750 Test Loss: 0.799 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 1.7977979183197021
Epoch: 17, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.740 Vali Acc: 0.761 Test Loss: 0.740 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 1.8535890579223633
Epoch: 18, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.698 Vali Acc: 0.778 Test Loss: 0.698 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 1.6415448188781738
Epoch: 19, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.649 Vali Acc: 0.794 Test Loss: 0.649 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 20 cost time: 1.745706558227539
Epoch: 20, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8207716941833496
Epoch: 21, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805550).  Saving model ...
Epoch: 22 cost time: 1.8047552108764648
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822217).  Saving model ...
Epoch: 23 cost time: 1.7499313354492188
Epoch: 23, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.515 Vali Acc: 0.817 Test Loss: 0.515 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.508190393447876
Epoch: 24, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.822217 --> -0.855551).  Saving model ...
Epoch: 25 cost time: 1.35723876953125
Epoch: 25, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.470 Vali Acc: 0.839 Test Loss: 0.470 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6176202297210693
Epoch: 26, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.456 Vali Acc: 0.839 Test Loss: 0.456 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.341195821762085
Epoch: 27, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 28 cost time: 1.3560078144073486
Epoch: 28, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.422 Vali Acc: 0.861 Test Loss: 0.422 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 29 cost time: 1.4031035900115967
Epoch: 29, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3503448963165283
Epoch: 30, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 89414
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9653573036193848
Epoch: 1, Steps: 12 | Train Loss: 1.886 Vali Loss: 1.898 Vali Acc: 0.161 Test Loss: 1.898 Test Acc: 0.161
Validation loss decreased (inf --> -0.161092).  Saving model ...
Epoch: 2 cost time: 1.3452205657958984
Epoch: 2, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.854 Vali Acc: 0.156 Test Loss: 1.854 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4084513187408447
Epoch: 3, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.801 Vali Acc: 0.178 Test Loss: 1.801 Test Acc: 0.178
Validation loss decreased (-0.161092 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 1.5291786193847656
Epoch: 4, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.742 Vali Acc: 0.206 Test Loss: 1.742 Test Acc: 0.206
Validation loss decreased (-0.177760 --> -0.205538).  Saving model ...
Epoch: 5 cost time: 1.2976558208465576
Epoch: 5, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.679 Vali Acc: 0.317 Test Loss: 1.679 Test Acc: 0.317
Validation loss decreased (-0.205538 --> -0.316650).  Saving model ...
Epoch: 6 cost time: 1.2498550415039062
Epoch: 6, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.614 Vali Acc: 0.372 Test Loss: 1.614 Test Acc: 0.372
Validation loss decreased (-0.316650 --> -0.372206).  Saving model ...
Epoch: 7 cost time: 1.4520175457000732
Epoch: 7, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.546 Vali Acc: 0.461 Test Loss: 1.546 Test Acc: 0.461
Validation loss decreased (-0.372206 --> -0.461096).  Saving model ...
Epoch: 8 cost time: 1.3310234546661377
Epoch: 8, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.468 Vali Acc: 0.506 Test Loss: 1.468 Test Acc: 0.506
Validation loss decreased (-0.461096 --> -0.505541).  Saving model ...
Epoch: 9 cost time: 1.362191915512085
Epoch: 9, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.381 Vali Acc: 0.572 Test Loss: 1.381 Test Acc: 0.572
Validation loss decreased (-0.505541 --> -0.572208).  Saving model ...
Epoch: 10 cost time: 1.5381474494934082
Epoch: 10, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.290 Vali Acc: 0.600 Test Loss: 1.290 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.2677228450775146
Epoch: 11, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.198 Vali Acc: 0.606 Test Loss: 1.198 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605544).  Saving model ...
Epoch: 12 cost time: 1.5025084018707275
Epoch: 12, Steps: 12 | Train Loss: 1.102 Vali Loss: 1.113 Vali Acc: 0.606 Test Loss: 1.113 Test Acc: 0.606
Validation loss decreased (-0.605544 --> -0.605544).  Saving model ...
Epoch: 13 cost time: 1.2582297325134277
Epoch: 13, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.029 Vali Acc: 0.622 Test Loss: 1.029 Test Acc: 0.622
Validation loss decreased (-0.605544 --> -0.622212).  Saving model ...
Epoch: 14 cost time: 1.3135154247283936
Epoch: 14, Steps: 12 | Train Loss: 0.859 Vali Loss: 0.952 Vali Acc: 0.644 Test Loss: 0.952 Test Acc: 0.644
Validation loss decreased (-0.622212 --> -0.644435).  Saving model ...
Epoch: 15 cost time: 1.4856984615325928
Epoch: 15, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.878 Vali Acc: 0.678 Test Loss: 0.878 Test Acc: 0.678
Validation loss decreased (-0.644435 --> -0.677769).  Saving model ...
Epoch: 16 cost time: 1.3399863243103027
Epoch: 16, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.818 Vali Acc: 0.700 Test Loss: 0.818 Test Acc: 0.700
Validation loss decreased (-0.677769 --> -0.699992).  Saving model ...
Epoch: 17 cost time: 1.4597759246826172
Epoch: 17, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.769 Vali Acc: 0.711 Test Loss: 0.769 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711103).  Saving model ...
Epoch: 18 cost time: 1.5188157558441162
Epoch: 18, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.723 Vali Acc: 0.706 Test Loss: 0.723 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3197689056396484
Epoch: 19, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738882).  Saving model ...
Epoch: 20 cost time: 1.4963915348052979
Epoch: 20, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.649 Vali Acc: 0.733 Test Loss: 0.649 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3711018562316895
Epoch: 21, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.616 Vali Acc: 0.739 Test Loss: 0.616 Test Acc: 0.739
Validation loss decreased (-0.738882 --> -0.738883).  Saving model ...
Epoch: 22 cost time: 1.4711101055145264
Epoch: 22, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
Validation loss decreased (-0.738883 --> -0.749994).  Saving model ...
Epoch: 23 cost time: 1.5261895656585693
Epoch: 23, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.564 Vali Acc: 0.744 Test Loss: 0.564 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4490032196044922
Epoch: 24, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.547 Vali Acc: 0.739 Test Loss: 0.547 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.970799446105957
Epoch: 25, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.524 Vali Acc: 0.756 Test Loss: 0.524 Test Acc: 0.756
Validation loss decreased (-0.749994 --> -0.755550).  Saving model ...
Epoch: 26 cost time: 1.6198198795318604
Epoch: 26, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.510 Vali Acc: 0.767 Test Loss: 0.510 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 27 cost time: 1.2722830772399902
Epoch: 27, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.497 Vali Acc: 0.778 Test Loss: 0.497 Test Acc: 0.778
Validation loss decreased (-0.766662 --> -0.777773).  Saving model ...
Epoch: 28 cost time: 1.4955248832702637
Epoch: 28, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.476 Vali Acc: 0.778 Test Loss: 0.476 Test Acc: 0.778
Validation loss decreased (-0.777773 --> -0.777773).  Saving model ...
Epoch: 29 cost time: 1.571714162826538
Epoch: 29, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.458 Vali Acc: 0.783 Test Loss: 0.458 Test Acc: 0.783
Validation loss decreased (-0.777773 --> -0.783329).  Saving model ...
Epoch: 30 cost time: 1.3483390808105469
Epoch: 30, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.451 Vali Acc: 0.783 Test Loss: 0.451 Test Acc: 0.783
Validation loss decreased (-0.783329 --> -0.783329).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 296422
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0311503410339355
Epoch: 1, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.859 Vali Acc: 0.156 Test Loss: 1.859 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 1.1616666316986084
Epoch: 2, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.826 Vali Acc: 0.200 Test Loss: 1.826 Test Acc: 0.200
Validation loss decreased (-0.155537 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 1.563302993774414
Epoch: 3, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.784 Vali Acc: 0.217 Test Loss: 1.784 Test Acc: 0.217
Validation loss decreased (-0.199982 --> -0.216649).  Saving model ...
Epoch: 4 cost time: 1.2010350227355957
Epoch: 4, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.734 Vali Acc: 0.278 Test Loss: 1.734 Test Acc: 0.278
Validation loss decreased (-0.216649 --> -0.277760).  Saving model ...
Epoch: 5 cost time: 1.4891490936279297
Epoch: 5, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.677 Vali Acc: 0.333 Test Loss: 1.677 Test Acc: 0.333
Validation loss decreased (-0.277760 --> -0.333317).  Saving model ...
Epoch: 6 cost time: 1.3493397235870361
Epoch: 6, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.615 Vali Acc: 0.394 Test Loss: 1.615 Test Acc: 0.394
Validation loss decreased (-0.333317 --> -0.394428).  Saving model ...
Epoch: 7 cost time: 1.4257023334503174
Epoch: 7, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.548 Vali Acc: 0.467 Test Loss: 1.548 Test Acc: 0.467
Validation loss decreased (-0.394428 --> -0.466651).  Saving model ...
Epoch: 8 cost time: 1.4737045764923096
Epoch: 8, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.473 Vali Acc: 0.506 Test Loss: 1.473 Test Acc: 0.506
Validation loss decreased (-0.466651 --> -0.505541).  Saving model ...
Epoch: 9 cost time: 1.2756714820861816
Epoch: 9, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.392 Vali Acc: 0.550 Test Loss: 1.392 Test Acc: 0.550
Validation loss decreased (-0.505541 --> -0.549986).  Saving model ...
Epoch: 10 cost time: 1.106353521347046
Epoch: 10, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
Validation loss decreased (-0.549986 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.453113079071045
Epoch: 11, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.204 Vali Acc: 0.633 Test Loss: 1.204 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 1.3088092803955078
Epoch: 12, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.111 Vali Acc: 0.672 Test Loss: 1.111 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 1.2478523254394531
Epoch: 13, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.020 Vali Acc: 0.706 Test Loss: 1.020 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 1.464080572128296
Epoch: 14, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711102).  Saving model ...
Epoch: 15 cost time: 1.2323594093322754
Epoch: 15, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.863 Vali Acc: 0.739 Test Loss: 0.863 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 1.4886808395385742
Epoch: 16, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.798 Vali Acc: 0.744 Test Loss: 0.798 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 1.4238736629486084
Epoch: 17, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.738 Vali Acc: 0.761 Test Loss: 0.738 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761104).  Saving model ...
Epoch: 18 cost time: 1.3057634830474854
Epoch: 18, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.697 Vali Acc: 0.778 Test Loss: 0.697 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 19 cost time: 1.4972753524780273
Epoch: 19, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.648 Vali Acc: 0.794 Test Loss: 0.648 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 20 cost time: 1.1184043884277344
Epoch: 20, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.309861421585083
Epoch: 21, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.572 Vali Acc: 0.806 Test Loss: 0.572 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805550).  Saving model ...
Epoch: 22 cost time: 1.2597265243530273
Epoch: 22, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822217).  Saving model ...
Epoch: 23 cost time: 1.1498792171478271
Epoch: 23, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.516 Vali Acc: 0.817 Test Loss: 0.516 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2422921657562256
Epoch: 24, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.111088514328003
Epoch: 25, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.473 Vali Acc: 0.839 Test Loss: 0.473 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.162248134613037
Epoch: 26, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.459 Vali Acc: 0.839 Test Loss: 0.459 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1484858989715576
Epoch: 27, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 1.23982834815979
Epoch: 28, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.427 Vali Acc: 0.856 Test Loss: 0.427 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 29 cost time: 1.5705573558807373
Epoch: 29, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4482779502868652
Epoch: 30, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 89414
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.238401889801025
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.840 Vali Acc: 0.172 Test Loss: 1.840 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.8979041576385498
Epoch: 2, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.809 Vali Acc: 0.222 Test Loss: 1.809 Test Acc: 0.222
Validation loss decreased (-0.172204 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 2.0484485626220703
Epoch: 3, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.768 Vali Acc: 0.261 Test Loss: 1.768 Test Acc: 0.261
Validation loss decreased (-0.222204 --> -0.261093).  Saving model ...
Epoch: 4 cost time: 2.1130716800689697
Epoch: 4, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.722 Vali Acc: 0.283 Test Loss: 1.722 Test Acc: 0.283
Validation loss decreased (-0.261093 --> -0.283316).  Saving model ...
Epoch: 5 cost time: 2.0198724269866943
Epoch: 5, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.669 Vali Acc: 0.317 Test Loss: 1.669 Test Acc: 0.317
Validation loss decreased (-0.283316 --> -0.316650).  Saving model ...
Epoch: 6 cost time: 1.860114574432373
Epoch: 6, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.611 Vali Acc: 0.372 Test Loss: 1.611 Test Acc: 0.372
Validation loss decreased (-0.316650 --> -0.372206).  Saving model ...
Epoch: 7 cost time: 2.129894256591797
Epoch: 7, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.546 Vali Acc: 0.411 Test Loss: 1.546 Test Acc: 0.411
Validation loss decreased (-0.372206 --> -0.411096).  Saving model ...
Epoch: 8 cost time: 2.174624443054199
Epoch: 8, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.475 Vali Acc: 0.450 Test Loss: 1.475 Test Acc: 0.450
Validation loss decreased (-0.411096 --> -0.449985).  Saving model ...
Epoch: 9 cost time: 1.8473560810089111
Epoch: 9, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.397 Vali Acc: 0.467 Test Loss: 1.397 Test Acc: 0.467
Validation loss decreased (-0.449985 --> -0.466653).  Saving model ...
Epoch: 10 cost time: 2.0772247314453125
Epoch: 10, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.316 Vali Acc: 0.506 Test Loss: 1.316 Test Acc: 0.506
Validation loss decreased (-0.466653 --> -0.505542).  Saving model ...
Epoch: 11 cost time: 2.100604295730591
Epoch: 11, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.238 Vali Acc: 0.544 Test Loss: 1.238 Test Acc: 0.544
Validation loss decreased (-0.505542 --> -0.544432).  Saving model ...
Epoch: 12 cost time: 1.9764111042022705
Epoch: 12, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.170 Vali Acc: 0.556 Test Loss: 1.170 Test Acc: 0.556
Validation loss decreased (-0.544432 --> -0.555544).  Saving model ...
Epoch: 13 cost time: 1.189375877380371
Epoch: 13, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.100 Vali Acc: 0.589 Test Loss: 1.100 Test Acc: 0.589
Validation loss decreased (-0.555544 --> -0.588878).  Saving model ...
Epoch: 14 cost time: 2.2324318885803223
Epoch: 14, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.048 Vali Acc: 0.606 Test Loss: 1.048 Test Acc: 0.606
Validation loss decreased (-0.588878 --> -0.605545).  Saving model ...
Epoch: 15 cost time: 2.0216541290283203
Epoch: 15, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.997 Vali Acc: 0.594 Test Loss: 0.997 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9685938358306885
Epoch: 16, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.949 Vali Acc: 0.622 Test Loss: 0.949 Test Acc: 0.622
Validation loss decreased (-0.605545 --> -0.622213).  Saving model ...
Epoch: 17 cost time: 2.1207573413848877
Epoch: 17, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.910 Vali Acc: 0.633 Test Loss: 0.910 Test Acc: 0.633
Validation loss decreased (-0.622213 --> -0.633324).  Saving model ...
Epoch: 18 cost time: 2.1593129634857178
Epoch: 18, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.877 Vali Acc: 0.639 Test Loss: 0.877 Test Acc: 0.639
Validation loss decreased (-0.633324 --> -0.638880).  Saving model ...
Epoch: 19 cost time: 1.6923189163208008
Epoch: 19, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.844 Vali Acc: 0.650 Test Loss: 0.844 Test Acc: 0.650
Validation loss decreased (-0.638880 --> -0.649992).  Saving model ...
Epoch: 20 cost time: 2.166109085083008
Epoch: 20, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.811 Vali Acc: 0.672 Test Loss: 0.811 Test Acc: 0.672
Validation loss decreased (-0.649992 --> -0.672214).  Saving model ...
Epoch: 21 cost time: 2.112792730331421
Epoch: 21, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.782 Vali Acc: 0.672 Test Loss: 0.782 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672214).  Saving model ...
Epoch: 22 cost time: 2.0431394577026367
Epoch: 22, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.746 Vali Acc: 0.672 Test Loss: 0.746 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672215).  Saving model ...
Epoch: 23 cost time: 1.8024795055389404
Epoch: 23, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.700 Vali Acc: 0.700 Test Loss: 0.700 Test Acc: 0.700
Validation loss decreased (-0.672215 --> -0.699993).  Saving model ...
Epoch: 24 cost time: 2.0762908458709717
Epoch: 24, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.656 Vali Acc: 0.711 Test Loss: 0.656 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711105).  Saving model ...
Epoch: 25 cost time: 2.1261305809020996
Epoch: 25, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.616 Vali Acc: 0.733 Test Loss: 0.616 Test Acc: 0.733
Validation loss decreased (-0.711105 --> -0.733327).  Saving model ...
Epoch: 26 cost time: 1.7796576023101807
Epoch: 26, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.577 Vali Acc: 0.767 Test Loss: 0.577 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766661).  Saving model ...
Epoch: 27 cost time: 2.0993473529815674
Epoch: 27, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788883).  Saving model ...
Epoch: 28 cost time: 2.084561824798584
Epoch: 28, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788884).  Saving model ...
Epoch: 29 cost time: 2.066195487976074
Epoch: 29, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.496 Vali Acc: 0.794 Test Loss: 0.496 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794439).  Saving model ...
Epoch: 30 cost time: 1.819493055343628
Epoch: 30, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799995).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 149798
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.013462543487549
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.782 Vali Acc: 0.278 Test Loss: 1.782 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 1.851172685623169
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.744 Vali Acc: 0.322 Test Loss: 1.744 Test Acc: 0.322
Validation loss decreased (-0.277760 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 1.8260252475738525
Epoch: 3, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.696 Vali Acc: 0.339 Test Loss: 1.696 Test Acc: 0.339
Validation loss decreased (-0.322205 --> -0.338872).  Saving model ...
Epoch: 4 cost time: 1.658644437789917
Epoch: 4, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.646 Vali Acc: 0.400 Test Loss: 1.646 Test Acc: 0.400
Validation loss decreased (-0.338872 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.9290447235107422
Epoch: 5, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.589 Vali Acc: 0.439 Test Loss: 1.589 Test Acc: 0.439
Validation loss decreased (-0.399984 --> -0.438873).  Saving model ...
Epoch: 6 cost time: 1.8953890800476074
Epoch: 6, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.522 Vali Acc: 0.456 Test Loss: 1.522 Test Acc: 0.456
Validation loss decreased (-0.438873 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 1.7588927745819092
Epoch: 7, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.448 Vali Acc: 0.517 Test Loss: 1.448 Test Acc: 0.517
Validation loss decreased (-0.455540 --> -0.516652).  Saving model ...
Epoch: 8 cost time: 1.9738740921020508
Epoch: 8, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.367 Vali Acc: 0.589 Test Loss: 1.367 Test Acc: 0.589
Validation loss decreased (-0.516652 --> -0.588875).  Saving model ...
Epoch: 9 cost time: 1.9826302528381348
Epoch: 9, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.283 Vali Acc: 0.633 Test Loss: 1.283 Test Acc: 0.633
Validation loss decreased (-0.588875 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 1.86692214012146
Epoch: 10, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.187 Vali Acc: 0.672 Test Loss: 1.187 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 1.6673531532287598
Epoch: 11, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.090 Vali Acc: 0.694 Test Loss: 1.090 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 1.9818825721740723
Epoch: 12, Steps: 12 | Train Loss: 1.042 Vali Loss: 0.997 Vali Acc: 0.739 Test Loss: 0.997 Test Acc: 0.739
Validation loss decreased (-0.694434 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.8739778995513916
Epoch: 13, Steps: 12 | Train Loss: 0.961 Vali Loss: 0.905 Vali Acc: 0.789 Test Loss: 0.905 Test Acc: 0.789
Validation loss decreased (-0.738879 --> -0.788880).  Saving model ...
Epoch: 14 cost time: 1.7888288497924805
Epoch: 14, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.90104079246521
Epoch: 15, Steps: 12 | Train Loss: 0.786 Vali Loss: 0.747 Vali Acc: 0.789 Test Loss: 0.747 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0492780208587646
Epoch: 16, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.8498589992523193
Epoch: 17, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.640 Vali Acc: 0.806 Test Loss: 0.640 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6170926094055176
Epoch: 18, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.595 Vali Acc: 0.822 Test Loss: 0.595 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9087944030761719
Epoch: 19, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.561 Vali Acc: 0.811 Test Loss: 0.561 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.854435920715332
Epoch: 20, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.530 Vali Acc: 0.817 Test Loss: 0.530 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.736126184463501
Epoch: 21, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.496 Vali Acc: 0.811 Test Loss: 0.496 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0022168159484863
Epoch: 22, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.477 Vali Acc: 0.828 Test Loss: 0.477 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827773).  Saving model ...
Epoch: 23 cost time: 1.9531822204589844
Epoch: 23, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.452 Vali Acc: 0.828 Test Loss: 0.452 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827773).  Saving model ...
Epoch: 24 cost time: 1.8169291019439697
Epoch: 24, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861107).  Saving model ...
Epoch: 25 cost time: 1.754422664642334
Epoch: 25, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.421 Vali Acc: 0.856 Test Loss: 0.421 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9894919395446777
Epoch: 26, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.914762258529663
Epoch: 27, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861107).  Saving model ...
Epoch: 28 cost time: 1.7267863750457764
Epoch: 28, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.395 Vali Acc: 0.856 Test Loss: 0.395 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9524407386779785
Epoch: 29, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 30 cost time: 1.9128477573394775
Epoch: 30, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.380 Vali Acc: 0.839 Test Loss: 0.380 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 46278
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.493115186691284
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.840 Vali Acc: 0.172 Test Loss: 1.840 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.517296314239502
Epoch: 2, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.809 Vali Acc: 0.222 Test Loss: 1.809 Test Acc: 0.222
Validation loss decreased (-0.172204 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 1.5486946105957031
Epoch: 3, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.768 Vali Acc: 0.261 Test Loss: 1.768 Test Acc: 0.261
Validation loss decreased (-0.222204 --> -0.261093).  Saving model ...
Epoch: 4 cost time: 1.5241177082061768
Epoch: 4, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.722 Vali Acc: 0.283 Test Loss: 1.722 Test Acc: 0.283
Validation loss decreased (-0.261093 --> -0.283316).  Saving model ...
Epoch: 5 cost time: 1.6809682846069336
Epoch: 5, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.669 Vali Acc: 0.317 Test Loss: 1.669 Test Acc: 0.317
Validation loss decreased (-0.283316 --> -0.316650).  Saving model ...
Epoch: 6 cost time: 1.8201653957366943
Epoch: 6, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.611 Vali Acc: 0.372 Test Loss: 1.611 Test Acc: 0.372
Validation loss decreased (-0.316650 --> -0.372206).  Saving model ...
Epoch: 7 cost time: 1.581662893295288
Epoch: 7, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.546 Vali Acc: 0.411 Test Loss: 1.546 Test Acc: 0.411
Validation loss decreased (-0.372206 --> -0.411096).  Saving model ...
Epoch: 8 cost time: 1.7955455780029297
Epoch: 8, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.475 Vali Acc: 0.450 Test Loss: 1.475 Test Acc: 0.450
Validation loss decreased (-0.411096 --> -0.449985).  Saving model ...
Epoch: 9 cost time: 1.7823140621185303
Epoch: 9, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.397 Vali Acc: 0.467 Test Loss: 1.397 Test Acc: 0.467
Validation loss decreased (-0.449985 --> -0.466653).  Saving model ...
Epoch: 10 cost time: 1.7325739860534668
Epoch: 10, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.316 Vali Acc: 0.506 Test Loss: 1.316 Test Acc: 0.506
Validation loss decreased (-0.466653 --> -0.505542).  Saving model ...
Epoch: 11 cost time: 1.5501885414123535
Epoch: 11, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.238 Vali Acc: 0.544 Test Loss: 1.238 Test Acc: 0.544
Validation loss decreased (-0.505542 --> -0.544432).  Saving model ...
Epoch: 12 cost time: 1.7047932147979736
Epoch: 12, Steps: 12 | Train Loss: 1.111 Vali Loss: 1.170 Vali Acc: 0.556 Test Loss: 1.170 Test Acc: 0.556
Validation loss decreased (-0.544432 --> -0.555544).  Saving model ...
Epoch: 13 cost time: 1.50982666015625
Epoch: 13, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.100 Vali Acc: 0.589 Test Loss: 1.100 Test Acc: 0.589
Validation loss decreased (-0.555544 --> -0.588878).  Saving model ...
Epoch: 14 cost time: 1.6555860042572021
Epoch: 14, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.048 Vali Acc: 0.606 Test Loss: 1.048 Test Acc: 0.606
Validation loss decreased (-0.588878 --> -0.605545).  Saving model ...
Epoch: 15 cost time: 1.4680852890014648
Epoch: 15, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.997 Vali Acc: 0.594 Test Loss: 0.997 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.524280071258545
Epoch: 16, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.949 Vali Acc: 0.622 Test Loss: 0.949 Test Acc: 0.622
Validation loss decreased (-0.605545 --> -0.622213).  Saving model ...
Epoch: 17 cost time: 1.5708637237548828
Epoch: 17, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.910 Vali Acc: 0.633 Test Loss: 0.910 Test Acc: 0.633
Validation loss decreased (-0.622213 --> -0.633324).  Saving model ...
Epoch: 18 cost time: 1.611546516418457
Epoch: 18, Steps: 12 | Train Loss: 0.798 Vali Loss: 0.877 Vali Acc: 0.639 Test Loss: 0.877 Test Acc: 0.639
Validation loss decreased (-0.633324 --> -0.638880).  Saving model ...
Epoch: 19 cost time: 1.5595111846923828
Epoch: 19, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.844 Vali Acc: 0.650 Test Loss: 0.844 Test Acc: 0.650
Validation loss decreased (-0.638880 --> -0.649992).  Saving model ...
Epoch: 20 cost time: 1.53922438621521
Epoch: 20, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.811 Vali Acc: 0.672 Test Loss: 0.811 Test Acc: 0.672
Validation loss decreased (-0.649992 --> -0.672214).  Saving model ...
Epoch: 21 cost time: 1.4942526817321777
Epoch: 21, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.782 Vali Acc: 0.672 Test Loss: 0.782 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672214).  Saving model ...
Epoch: 22 cost time: 1.7709569931030273
Epoch: 22, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.746 Vali Acc: 0.672 Test Loss: 0.746 Test Acc: 0.672
Validation loss decreased (-0.672214 --> -0.672215).  Saving model ...
Epoch: 23 cost time: 1.6521236896514893
Epoch: 23, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.700 Vali Acc: 0.700 Test Loss: 0.700 Test Acc: 0.700
Validation loss decreased (-0.672215 --> -0.699993).  Saving model ...
Epoch: 24 cost time: 1.5351552963256836
Epoch: 24, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.656 Vali Acc: 0.711 Test Loss: 0.656 Test Acc: 0.711
Validation loss decreased (-0.699993 --> -0.711105).  Saving model ...
Epoch: 25 cost time: 1.5237529277801514
Epoch: 25, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.616 Vali Acc: 0.733 Test Loss: 0.616 Test Acc: 0.733
Validation loss decreased (-0.711105 --> -0.733327).  Saving model ...
Epoch: 26 cost time: 1.5983328819274902
Epoch: 26, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.577 Vali Acc: 0.767 Test Loss: 0.577 Test Acc: 0.767
Validation loss decreased (-0.733327 --> -0.766661).  Saving model ...
Epoch: 27 cost time: 1.5184144973754883
Epoch: 27, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788883).  Saving model ...
Epoch: 28 cost time: 1.8001103401184082
Epoch: 28, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.515 Vali Acc: 0.794 Test Loss: 0.515 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794439).  Saving model ...
Epoch: 29 cost time: 1.6361477375030518
Epoch: 29, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.496 Vali Acc: 0.794 Test Loss: 0.496 Test Acc: 0.794
Validation loss decreased (-0.794439 --> -0.794439).  Saving model ...
Epoch: 30 cost time: 1.745995283126831
Epoch: 30, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799995).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8
model parameter : 149798
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.126126766204834
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.782 Vali Acc: 0.278 Test Loss: 1.782 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 1.7420451641082764
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.744 Vali Acc: 0.322 Test Loss: 1.744 Test Acc: 0.322
Validation loss decreased (-0.277760 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 1.4991209506988525
Epoch: 3, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.696 Vali Acc: 0.339 Test Loss: 1.696 Test Acc: 0.339
Validation loss decreased (-0.322205 --> -0.338872).  Saving model ...
Epoch: 4 cost time: 1.6135330200195312
Epoch: 4, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.646 Vali Acc: 0.400 Test Loss: 1.646 Test Acc: 0.400
Validation loss decreased (-0.338872 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.4232711791992188
Epoch: 5, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.589 Vali Acc: 0.439 Test Loss: 1.589 Test Acc: 0.439
Validation loss decreased (-0.399984 --> -0.438873).  Saving model ...
Epoch: 6 cost time: 1.3731086254119873
Epoch: 6, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.522 Vali Acc: 0.456 Test Loss: 1.522 Test Acc: 0.456
Validation loss decreased (-0.438873 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 1.4513437747955322
Epoch: 7, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.448 Vali Acc: 0.517 Test Loss: 1.448 Test Acc: 0.517
Validation loss decreased (-0.455540 --> -0.516652).  Saving model ...
Epoch: 8 cost time: 1.3447294235229492
Epoch: 8, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.367 Vali Acc: 0.589 Test Loss: 1.367 Test Acc: 0.589
Validation loss decreased (-0.516652 --> -0.588875).  Saving model ...
Epoch: 9 cost time: 1.5633578300476074
Epoch: 9, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.283 Vali Acc: 0.633 Test Loss: 1.283 Test Acc: 0.633
Validation loss decreased (-0.588875 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 1.4660413265228271
Epoch: 10, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.187 Vali Acc: 0.672 Test Loss: 1.187 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 1.674896478652954
Epoch: 11, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.090 Vali Acc: 0.694 Test Loss: 1.090 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 1.5228724479675293
Epoch: 12, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.997 Vali Acc: 0.739 Test Loss: 0.997 Test Acc: 0.739
Validation loss decreased (-0.694434 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.6479251384735107
Epoch: 13, Steps: 12 | Train Loss: 0.961 Vali Loss: 0.905 Vali Acc: 0.789 Test Loss: 0.905 Test Acc: 0.789
Validation loss decreased (-0.738879 --> -0.788880).  Saving model ...
Epoch: 14 cost time: 1.4690182209014893
Epoch: 14, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.5343809127807617
Epoch: 15, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3111319541931152
Epoch: 16, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.687 Vali Acc: 0.828 Test Loss: 0.687 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 17 cost time: 1.3628883361816406
Epoch: 17, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.639 Vali Acc: 0.794 Test Loss: 0.639 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3616271018981934
Epoch: 18, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.594 Vali Acc: 0.817 Test Loss: 0.594 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3425047397613525
Epoch: 19, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.559 Vali Acc: 0.794 Test Loss: 0.559 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3237833976745605
Epoch: 20, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.529 Vali Acc: 0.800 Test Loss: 0.529 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3771226406097412
Epoch: 21, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833328).  Saving model ...
Epoch: 22 cost time: 1.6798186302185059
Epoch: 22, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.475 Vali Acc: 0.822 Test Loss: 0.475 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3131351470947266
Epoch: 23, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.452 Vali Acc: 0.800 Test Loss: 0.452 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.810246229171753
Epoch: 24, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.440 Vali Acc: 0.800 Test Loss: 0.440 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7963287830352783
Epoch: 25, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.423 Vali Acc: 0.828 Test Loss: 0.423 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6229476928710938
Epoch: 26, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.418 Vali Acc: 0.806 Test Loss: 0.418 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.743234634399414
Epoch: 27, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.417 Vali Acc: 0.828 Test Loss: 0.417 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8022785186767578
Epoch: 28, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849996).  Saving model ...
Epoch: 29 cost time: 1.6142265796661377
Epoch: 29, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.396 Vali Acc: 0.844 Test Loss: 0.396 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7387745380401611
Epoch: 30, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.387 Vali Acc: 0.828 Test Loss: 0.387 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.85
model parameter : 46278
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.225680112838745
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.841 Vali Acc: 0.172 Test Loss: 1.841 Test Acc: 0.172
Validation loss decreased (inf --> -0.172204).  Saving model ...
Epoch: 2 cost time: 1.3379957675933838
Epoch: 2, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.809 Vali Acc: 0.222 Test Loss: 1.809 Test Acc: 0.222
Validation loss decreased (-0.172204 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 1.592414379119873
Epoch: 3, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.768 Vali Acc: 0.261 Test Loss: 1.768 Test Acc: 0.261
Validation loss decreased (-0.222204 --> -0.261093).  Saving model ...
Epoch: 4 cost time: 1.5583622455596924
Epoch: 4, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.722 Vali Acc: 0.283 Test Loss: 1.722 Test Acc: 0.283
Validation loss decreased (-0.261093 --> -0.283316).  Saving model ...
Epoch: 5 cost time: 1.3782050609588623
Epoch: 5, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.670 Vali Acc: 0.317 Test Loss: 1.670 Test Acc: 0.317
Validation loss decreased (-0.283316 --> -0.316650).  Saving model ...
Epoch: 6 cost time: 1.5945026874542236
Epoch: 6, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.611 Vali Acc: 0.372 Test Loss: 1.611 Test Acc: 0.372
Validation loss decreased (-0.316650 --> -0.372206).  Saving model ...
Epoch: 7 cost time: 1.597266674041748
Epoch: 7, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.547 Vali Acc: 0.411 Test Loss: 1.547 Test Acc: 0.411
Validation loss decreased (-0.372206 --> -0.411096).  Saving model ...
Epoch: 8 cost time: 1.361933946609497
Epoch: 8, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.475 Vali Acc: 0.450 Test Loss: 1.475 Test Acc: 0.450
Validation loss decreased (-0.411096 --> -0.449985).  Saving model ...
Epoch: 9 cost time: 1.533653736114502
Epoch: 9, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.398 Vali Acc: 0.467 Test Loss: 1.398 Test Acc: 0.467
Validation loss decreased (-0.449985 --> -0.466653).  Saving model ...
Epoch: 10 cost time: 1.5970399379730225
Epoch: 10, Steps: 12 | Train Loss: 1.326 Vali Loss: 1.317 Vali Acc: 0.506 Test Loss: 1.317 Test Acc: 0.506
Validation loss decreased (-0.466653 --> -0.505542).  Saving model ...
Epoch: 11 cost time: 1.4742064476013184
Epoch: 11, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.239 Vali Acc: 0.539 Test Loss: 1.239 Test Acc: 0.539
Validation loss decreased (-0.505542 --> -0.538876).  Saving model ...
Epoch: 12 cost time: 1.2054996490478516
Epoch: 12, Steps: 12 | Train Loss: 1.112 Vali Loss: 1.171 Vali Acc: 0.556 Test Loss: 1.171 Test Acc: 0.556
Validation loss decreased (-0.538876 --> -0.555544).  Saving model ...
Epoch: 13 cost time: 1.5689613819122314
Epoch: 13, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.101 Vali Acc: 0.589 Test Loss: 1.101 Test Acc: 0.589
Validation loss decreased (-0.555544 --> -0.588878).  Saving model ...
Epoch: 14 cost time: 1.3379337787628174
Epoch: 14, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.049 Vali Acc: 0.606 Test Loss: 1.049 Test Acc: 0.606
Validation loss decreased (-0.588878 --> -0.605545).  Saving model ...
Epoch: 15 cost time: 1.6044354438781738
Epoch: 15, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.998 Vali Acc: 0.589 Test Loss: 0.998 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5777769088745117
Epoch: 16, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.952 Vali Acc: 0.617 Test Loss: 0.952 Test Acc: 0.617
Validation loss decreased (-0.605545 --> -0.616657).  Saving model ...
Epoch: 17 cost time: 1.5329184532165527
Epoch: 17, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.913 Vali Acc: 0.628 Test Loss: 0.913 Test Acc: 0.628
Validation loss decreased (-0.616657 --> -0.627769).  Saving model ...
Epoch: 18 cost time: 1.2968418598175049
Epoch: 18, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.882 Vali Acc: 0.644 Test Loss: 0.882 Test Acc: 0.644
Validation loss decreased (-0.627769 --> -0.644436).  Saving model ...
Epoch: 19 cost time: 1.4211599826812744
Epoch: 19, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.849 Vali Acc: 0.650 Test Loss: 0.849 Test Acc: 0.650
Validation loss decreased (-0.644436 --> -0.649992).  Saving model ...
Epoch: 20 cost time: 1.4624426364898682
Epoch: 20, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.816 Vali Acc: 0.661 Test Loss: 0.816 Test Acc: 0.661
Validation loss decreased (-0.649992 --> -0.661103).  Saving model ...
Epoch: 21 cost time: 1.384516716003418
Epoch: 21, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.787 Vali Acc: 0.656 Test Loss: 0.787 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3623018264770508
Epoch: 22, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.752 Vali Acc: 0.661 Test Loss: 0.752 Test Acc: 0.661
Validation loss decreased (-0.661103 --> -0.661104).  Saving model ...
Epoch: 23 cost time: 1.5007102489471436
Epoch: 23, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.710 Vali Acc: 0.689 Test Loss: 0.710 Test Acc: 0.689
Validation loss decreased (-0.661104 --> -0.688882).  Saving model ...
Epoch: 24 cost time: 1.4668364524841309
Epoch: 24, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.672 Vali Acc: 0.694 Test Loss: 0.672 Test Acc: 0.694
Validation loss decreased (-0.688882 --> -0.694438).  Saving model ...
Epoch: 25 cost time: 1.3809196949005127
Epoch: 25, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.634 Vali Acc: 0.722 Test Loss: 0.634 Test Acc: 0.722
Validation loss decreased (-0.694438 --> -0.722216).  Saving model ...
Epoch: 26 cost time: 1.5281562805175781
Epoch: 26, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.597 Vali Acc: 0.739 Test Loss: 0.597 Test Acc: 0.739
Validation loss decreased (-0.722216 --> -0.738883).  Saving model ...
Epoch: 27 cost time: 1.4147839546203613
Epoch: 27, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
Validation loss decreased (-0.738883 --> -0.783328).  Saving model ...
Epoch: 28 cost time: 1.1388511657714844
Epoch: 28, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.539 Vali Acc: 0.772 Test Loss: 0.539 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.598262071609497
Epoch: 29, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 30 cost time: 1.4148752689361572
Epoch: 30, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.502 Vali Acc: 0.794 Test Loss: 0.502 Test Acc: 0.794
Validation loss decreased (-0.788884 --> -0.794439).  Saving model ...
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 149798
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.149868965148926
Epoch: 1, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.782 Vali Acc: 0.278 Test Loss: 1.782 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 1.4463698863983154
Epoch: 2, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.744 Vali Acc: 0.322 Test Loss: 1.744 Test Acc: 0.322
Validation loss decreased (-0.277760 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 1.1836154460906982
Epoch: 3, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.696 Vali Acc: 0.339 Test Loss: 1.696 Test Acc: 0.339
Validation loss decreased (-0.322205 --> -0.338872).  Saving model ...
Epoch: 4 cost time: 1.4521753787994385
Epoch: 4, Steps: 12 | Train Loss: 1.690 Vali Loss: 1.646 Vali Acc: 0.400 Test Loss: 1.646 Test Acc: 0.400
Validation loss decreased (-0.338872 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.4674768447875977
Epoch: 5, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.589 Vali Acc: 0.439 Test Loss: 1.589 Test Acc: 0.439
Validation loss decreased (-0.399984 --> -0.438873).  Saving model ...
Epoch: 6 cost time: 1.067631721496582
Epoch: 6, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.522 Vali Acc: 0.456 Test Loss: 1.522 Test Acc: 0.456
Validation loss decreased (-0.438873 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 1.454042911529541
Epoch: 7, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.448 Vali Acc: 0.517 Test Loss: 1.448 Test Acc: 0.517
Validation loss decreased (-0.455540 --> -0.516652).  Saving model ...
Epoch: 8 cost time: 1.5085561275482178
Epoch: 8, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.368 Vali Acc: 0.589 Test Loss: 1.368 Test Acc: 0.589
Validation loss decreased (-0.516652 --> -0.588875).  Saving model ...
Epoch: 9 cost time: 1.420253038406372
Epoch: 9, Steps: 12 | Train Loss: 1.325 Vali Loss: 1.283 Vali Acc: 0.633 Test Loss: 1.283 Test Acc: 0.633
Validation loss decreased (-0.588875 --> -0.633321).  Saving model ...
Epoch: 10 cost time: 1.231389045715332
Epoch: 10, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.188 Vali Acc: 0.672 Test Loss: 1.188 Test Acc: 0.672
Validation loss decreased (-0.633321 --> -0.672210).  Saving model ...
Epoch: 11 cost time: 1.511336088180542
Epoch: 11, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.090 Vali Acc: 0.694 Test Loss: 1.090 Test Acc: 0.694
Validation loss decreased (-0.672210 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 1.4428377151489258
Epoch: 12, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.997 Vali Acc: 0.739 Test Loss: 0.997 Test Acc: 0.739
Validation loss decreased (-0.694434 --> -0.738879).  Saving model ...
Epoch: 13 cost time: 1.2536473274230957
Epoch: 13, Steps: 12 | Train Loss: 0.962 Vali Loss: 0.905 Vali Acc: 0.789 Test Loss: 0.905 Test Acc: 0.789
Validation loss decreased (-0.738879 --> -0.788880).  Saving model ...
Epoch: 14 cost time: 1.4825725555419922
Epoch: 14, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.821 Vali Acc: 0.800 Test Loss: 0.821 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.3589348793029785
Epoch: 15, Steps: 12 | Train Loss: 0.787 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3997159004211426
Epoch: 16, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822215).  Saving model ...
Epoch: 17 cost time: 1.2874908447265625
Epoch: 17, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1943531036376953
Epoch: 18, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.600 Vali Acc: 0.811 Test Loss: 0.600 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.280851125717163
Epoch: 19, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.568 Vali Acc: 0.806 Test Loss: 0.568 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1931750774383545
Epoch: 20, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1858351230621338
Epoch: 21, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.512 Vali Acc: 0.839 Test Loss: 0.512 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838884).  Saving model ...
Epoch: 22 cost time: 1.1401309967041016
Epoch: 22, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.494 Vali Acc: 0.828 Test Loss: 0.494 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1563096046447754
Epoch: 23, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.473 Vali Acc: 0.822 Test Loss: 0.473 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4517946243286133
Epoch: 24, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.464 Vali Acc: 0.817 Test Loss: 0.464 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1951792240142822
Epoch: 25, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.449 Vali Acc: 0.828 Test Loss: 0.449 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4497759342193604
Epoch: 26, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.443 Vali Acc: 0.822 Test Loss: 0.443 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2707815170288086
Epoch: 27, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.33156156539917
Epoch: 28, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.419 Vali Acc: 0.839 Test Loss: 0.419 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838885).  Saving model ...
Epoch: 29 cost time: 1.2849469184875488
Epoch: 29, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.416 Vali Acc: 0.833 Test Loss: 0.416 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4040277004241943
Epoch: 30, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.407 Vali Acc: 0.817 Test Loss: 0.407 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_NATOPS_TimesNet_UEA_ftM_sl51_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 46278
model size : 0.34MB
