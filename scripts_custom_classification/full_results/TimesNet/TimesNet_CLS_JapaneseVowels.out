Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 42.97970485687256
Epoch: 1, Steps: 17 | Train Loss: 2.064 Vali Loss: 1.671 Vali Acc: 0.768 Test Loss: 1.671 Test Acc: 0.768
Validation loss decreased (inf --> -0.767551).  Saving model ...
Epoch: 2 cost time: 41.330960750579834
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 0.848 Vali Acc: 0.819 Test Loss: 0.848 Test Acc: 0.819
Validation loss decreased (-0.767551 --> -0.818910).  Saving model ...
Epoch: 3 cost time: 38.13501787185669
Epoch: 3, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
Validation loss decreased (-0.818910 --> -0.921618).  Saving model ...
Epoch: 4 cost time: 38.21802806854248
Epoch: 4, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.03293442726135
Epoch: 5, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.921618 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 39.924182653427124
Epoch: 6, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.940539 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 39.74791121482849
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 41.127615213394165
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 41.42263674736023
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 38.715397119522095
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 40.62285876274109
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 40.98585796356201
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 39.194727659225464
Epoch: 13, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 39.34038710594177
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 41.87413048744202
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.310 Vali Acc: 0.897 Test Loss: 0.310 Test Acc: 0.897
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 41.17941188812256
Epoch: 16, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 40.26052188873291
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 75021193
model size : 288.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 15.024296283721924
Epoch: 1, Steps: 17 | Train Loss: 2.033 Vali Loss: 1.711 Vali Acc: 0.673 Test Loss: 1.711 Test Acc: 0.673
Validation loss decreased (inf --> -0.672956).  Saving model ...
Epoch: 2 cost time: 13.939196586608887
Epoch: 2, Steps: 17 | Train Loss: 1.260 Vali Loss: 0.874 Vali Acc: 0.878 Test Loss: 0.874 Test Acc: 0.878
Validation loss decreased (-0.672956 --> -0.878370).  Saving model ...
Epoch: 3 cost time: 14.068592071533203
Epoch: 3, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.388 Vali Acc: 0.949 Test Loss: 0.388 Test Acc: 0.949
Validation loss decreased (-0.878370 --> -0.948645).  Saving model ...
Epoch: 4 cost time: 12.486417293548584
Epoch: 4, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.561815023422241
Epoch: 5, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.684706687927246
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.948645 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 13.224652528762817
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.208 Vali Acc: 0.927 Test Loss: 0.208 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.546977281570435
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.032808303833008
Epoch: 9, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.59009051322937
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.639222860336304
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 12.758883476257324
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 12.532047033309937
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.994763374328613
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.664161682128906
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.240154027938843
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.180345296859741
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.190757036209106
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.133222341537476
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 12.86572790145874
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.179052114486694
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 14.454248428344727
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 14.786471605300903
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 13.001196384429932
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 12.378600358963013
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 13.207257509231567
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 13.919688701629639
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 13.787890195846558
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 13.215365886688232
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 22065033
model size : 86.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 31.745843648910522
Epoch: 1, Steps: 17 | Train Loss: 2.064 Vali Loss: 1.673 Vali Acc: 0.768 Test Loss: 1.673 Test Acc: 0.768
Validation loss decreased (inf --> -0.767551).  Saving model ...
Epoch: 2 cost time: 29.89251685142517
Epoch: 2, Steps: 17 | Train Loss: 1.273 Vali Loss: 0.851 Vali Acc: 0.808 Test Loss: 0.851 Test Acc: 0.808
Validation loss decreased (-0.767551 --> -0.808100).  Saving model ...
Epoch: 3 cost time: 30.997190475463867
Epoch: 3, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
Validation loss decreased (-0.808100 --> -0.921618).  Saving model ...
Epoch: 4 cost time: 30.273966789245605
Epoch: 4, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.237 Vali Acc: 0.924 Test Loss: 0.237 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 29.7885582447052
Epoch: 5, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.924322 --> -0.954053).  Saving model ...
Epoch: 6 cost time: 28.84398651123047
Epoch: 6, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.180 Vali Acc: 0.924 Test Loss: 0.180 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.085711002349854
Epoch: 7, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 31.226309537887573
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 31.946669101715088
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 33.34168362617493
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 31.65298366546631
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 30.230359077453613
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 28.855576515197754
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 29.977887630462646
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 32.252530097961426
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 31.719162940979004
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 30.404946327209473
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 30.062541246414185
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 29.653082847595215
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 31.636094570159912
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 31.1325843334198
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 31.475135803222656
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 31.958155393600464
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 32.37892723083496
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 31.007179260253906
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 30.206201314926147
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 31.586058378219604
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 33.1237633228302
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 30.16903781890869
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 29.83159351348877
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 75021193
model size : 288.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 10.894776582717896
Epoch: 1, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.713 Vali Acc: 0.676 Test Loss: 1.713 Test Acc: 0.676
Validation loss decreased (inf --> -0.675659).  Saving model ...
Epoch: 2 cost time: 9.080492734909058
Epoch: 2, Steps: 17 | Train Loss: 1.261 Vali Loss: 0.876 Vali Acc: 0.873 Test Loss: 0.876 Test Acc: 0.873
Validation loss decreased (-0.675659 --> -0.872964).  Saving model ...
Epoch: 3 cost time: 7.49698543548584
Epoch: 3, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.389 Vali Acc: 0.949 Test Loss: 0.389 Test Acc: 0.949
Validation loss decreased (-0.872964 --> -0.948645).  Saving model ...
Epoch: 4 cost time: 9.505632400512695
Epoch: 4, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.174903631210327
Epoch: 5, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.20639443397522
Epoch: 6, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.948645 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 9.26619005203247
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.023489952087402
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.252995252609253
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.182202339172363
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.239368677139282
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 10.20988130569458
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 7.677102088928223
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.733658790588379
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.759199857711792
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.684977531433105
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.934886932373047
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.164233684539795
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.131663084030151
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.621916770935059
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.772114276885986
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.271186351776123
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22065033
model size : 86.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 18.791324615478516
Epoch: 1, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.716 Vali Acc: 0.749 Test Loss: 1.716 Test Acc: 0.749
Validation loss decreased (inf --> -0.748631).  Saving model ...
Epoch: 2 cost time: 18.376935720443726
Epoch: 2, Steps: 17 | Train Loss: 1.348 Vali Loss: 0.949 Vali Acc: 0.876 Test Loss: 0.949 Test Acc: 0.876
Validation loss decreased (-0.748631 --> -0.875666).  Saving model ...
Epoch: 3 cost time: 18.78679347038269
Epoch: 3, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.440 Vali Acc: 0.954 Test Loss: 0.440 Test Acc: 0.954
Validation loss decreased (-0.875666 --> -0.954050).  Saving model ...
Epoch: 4 cost time: 16.628523349761963
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.10715413093567
Epoch: 5, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.954050 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 18.189207077026367
Epoch: 6, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 16.70090961456299
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 17.260528564453125
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.192 Vali Acc: 0.932 Test Loss: 0.192 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.51014995574951
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.999593019485474
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.536105394363403
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 18.657305240631104
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.445677757263184
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.41210150718689
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 18.075361013412476
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.973342418670654
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 18.537333726882935
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.36001491546631
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 17.986724138259888
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 18.823874950408936
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.450772285461426
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 16.4820613861084
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 17.09431004524231
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 16.360979557037354
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 75021193
model size : 288.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.72640585899353
Epoch: 1, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.757 Vali Acc: 0.616 Test Loss: 1.757 Test Acc: 0.616
Validation loss decreased (inf --> -0.616199).  Saving model ...
Epoch: 2 cost time: 6.427725315093994
Epoch: 2, Steps: 17 | Train Loss: 1.346 Vali Loss: 0.994 Vali Acc: 0.905 Test Loss: 0.994 Test Acc: 0.905
Validation loss decreased (-0.616199 --> -0.905395).  Saving model ...
Epoch: 3 cost time: 6.627380132675171
Epoch: 3, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.467 Vali Acc: 0.965 Test Loss: 0.467 Test Acc: 0.965
Validation loss decreased (-0.905395 --> -0.964860).  Saving model ...
Epoch: 4 cost time: 5.736056327819824
Epoch: 4, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.267 Vali Acc: 0.957 Test Loss: 0.267 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.964561223983765
Epoch: 5, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.641916513442993
Epoch: 6, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.964860 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 6.271409034729004
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.192595720291138
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 7.014075994491577
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.355723857879639
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.81791615486145
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 7.337825536727905
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 6.641215085983276
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.3988425731658936
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.785410404205322
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.178265571594238
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.375364780426025
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 7.066681385040283
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 6.411275148391724
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.158947229385376
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.212957143783569
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.2326695919036865
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.092645883560181
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.290830612182617
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.279897689819336
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.823531627655029
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.405080795288086
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.211617946624756
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 22065033
model size : 86.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 25.61677598953247
Epoch: 1, Steps: 17 | Train Loss: 2.103 Vali Loss: 1.840 Vali Acc: 0.497 Test Loss: 1.840 Test Acc: 0.497
Validation loss decreased (inf --> -0.497279).  Saving model ...
Epoch: 2 cost time: 23.7450110912323
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.015 Vali Acc: 0.868 Test Loss: 1.015 Test Acc: 0.868
Validation loss decreased (-0.497279 --> -0.867557).  Saving model ...
Epoch: 3 cost time: 23.464311361312866
Epoch: 3, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.493 Vali Acc: 0.930 Test Loss: 0.493 Test Acc: 0.930
Validation loss decreased (-0.867557 --> -0.929725).  Saving model ...
Epoch: 4 cost time: 22.13565707206726
Epoch: 4, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.222 Vali Acc: 0.962 Test Loss: 0.222 Test Acc: 0.962
Validation loss decreased (-0.929725 --> -0.962160).  Saving model ...
Epoch: 5 cost time: 21.976635456085205
Epoch: 5, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.640799522399902
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964864).  Saving model ...
Epoch: 7 cost time: 22.93236994743347
Epoch: 7, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 23.96651268005371
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.264962911605835
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.960989952087402
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 19.723678588867188
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.954 Test Loss: 0.101 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.25705599784851
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.481003046035767
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 21.045448780059814
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 21.503209352493286
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.04669427871704
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 22.360167503356934
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 20.343039751052856
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.123426914215088
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 21.283419132232666
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 21.324862957000732
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 20.724650859832764
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 21.129080295562744
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 22.979546785354614
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 37531529
model size : 145.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.197458505630493
Epoch: 1, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.730 Vali Acc: 0.732 Test Loss: 1.730 Test Acc: 0.732
Validation loss decreased (inf --> -0.732415).  Saving model ...
Epoch: 2 cost time: 7.235162734985352
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.032 Vali Acc: 0.884 Test Loss: 1.032 Test Acc: 0.884
Validation loss decreased (-0.732415 --> -0.883773).  Saving model ...
Epoch: 3 cost time: 7.711917877197266
Epoch: 3, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.494 Vali Acc: 0.911 Test Loss: 0.494 Test Acc: 0.911
Validation loss decreased (-0.883773 --> -0.910806).  Saving model ...
Epoch: 4 cost time: 6.9743852615356445
Epoch: 4, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.277 Vali Acc: 0.938 Test Loss: 0.277 Test Acc: 0.938
Validation loss decreased (-0.910806 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 7.287829399108887
Epoch: 5, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
Validation loss decreased (-0.937835 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 6.986570119857788
Epoch: 6, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 7.737363338470459
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.666883945465088
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.957856178283691
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.503187894821167
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.910817623138428
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.805814027786255
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.970269 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 7.2131853103637695
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.471455097198486
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.165314435958862
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.125209808349609
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.955327272415161
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.370149612426758
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.363499402999878
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.472963333129883
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.159523487091064
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.413430452346802
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 11052937
model size : 44.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 15.201928615570068
Epoch: 1, Steps: 17 | Train Loss: 2.104 Vali Loss: 1.842 Vali Acc: 0.497 Test Loss: 1.842 Test Acc: 0.497
Validation loss decreased (inf --> -0.497279).  Saving model ...
Epoch: 2 cost time: 14.248239278793335
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.017 Vali Acc: 0.868 Test Loss: 1.017 Test Acc: 0.868
Validation loss decreased (-0.497279 --> -0.867557).  Saving model ...
Epoch: 3 cost time: 14.124292612075806
Epoch: 3, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.492 Vali Acc: 0.927 Test Loss: 0.492 Test Acc: 0.927
Validation loss decreased (-0.867557 --> -0.927022).  Saving model ...
Epoch: 4 cost time: 14.522040128707886
Epoch: 4, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.222 Vali Acc: 0.965 Test Loss: 0.222 Test Acc: 0.965
Validation loss decreased (-0.927022 --> -0.964863).  Saving model ...
Epoch: 5 cost time: 13.955057621002197
Epoch: 5, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.730398178100586
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 13.18730115890503
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 14.273489236831665
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.968064069747925
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.986672639846802
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.153104305267334
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.50117802619934
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.477267980575562
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.806581497192383
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.457854747772217
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 14.056749105453491
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.254891157150269
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 37531529
model size : 145.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.442385911941528
Epoch: 1, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.732 Vali Acc: 0.732 Test Loss: 1.732 Test Acc: 0.732
Validation loss decreased (inf --> -0.732415).  Saving model ...
Epoch: 2 cost time: 5.780817031860352
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.032 Vali Acc: 0.886 Test Loss: 1.032 Test Acc: 0.886
Validation loss decreased (-0.732415 --> -0.886476).  Saving model ...
Epoch: 3 cost time: 5.844280481338501
Epoch: 3, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.497 Vali Acc: 0.908 Test Loss: 0.497 Test Acc: 0.908
Validation loss decreased (-0.886476 --> -0.908103).  Saving model ...
Epoch: 4 cost time: 5.746440410614014
Epoch: 4, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.279 Vali Acc: 0.938 Test Loss: 0.279 Test Acc: 0.938
Validation loss decreased (-0.908103 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 5.972809314727783
Epoch: 5, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.937835 --> -0.970269).  Saving model ...
Epoch: 6 cost time: 5.693030834197998
Epoch: 6, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.762819528579712
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.426334381103516
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.013057231903076
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.855101108551025
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.017954349517822
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.173619747161865
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 5.748265266418457
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.968 Test Loss: 0.083 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.212976455688477
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.497928142547607
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.273369789123535
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.398664712905884
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.0715343952178955
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.436194658279419
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.024402856826782
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.968 Test Loss: 0.081 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.079272985458374
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.320725679397583
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 11052937
model size : 44.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.92778468132019
Epoch: 1, Steps: 17 | Train Loss: 2.110 Vali Loss: 1.863 Vali Acc: 0.468 Test Loss: 1.863 Test Acc: 0.468
Validation loss decreased (inf --> -0.467549).  Saving model ...
Epoch: 2 cost time: 6.847669363021851
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.111 Vali Acc: 0.900 Test Loss: 1.111 Test Acc: 0.900
Validation loss decreased (-0.467549 --> -0.899989).  Saving model ...
Epoch: 3 cost time: 6.887905120849609
Epoch: 3, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.563 Vali Acc: 0.935 Test Loss: 0.563 Test Acc: 0.935
Validation loss decreased (-0.899989 --> -0.935130).  Saving model ...
Epoch: 4 cost time: 6.87811279296875
Epoch: 4, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.252 Vali Acc: 0.968 Test Loss: 0.252 Test Acc: 0.968
Validation loss decreased (-0.935130 --> -0.967565).  Saving model ...
Epoch: 5 cost time: 6.479010820388794
Epoch: 5, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.125190734863281
Epoch: 6, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.3991992473602295
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.030076265335083
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.967565 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 6.776726961135864
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.167710065841675
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.306246757507324
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.781709671020508
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.946221351623535
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.946 Test Loss: 0.134 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.2082202434539795
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.044221639633179
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.136073350906372
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.105945110321045
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.0492026805877686
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 37531529
model size : 145.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9502902030944824
Epoch: 1, Steps: 17 | Train Loss: 2.007 Vali Loss: 1.751 Vali Acc: 0.697 Test Loss: 1.751 Test Acc: 0.697
Validation loss decreased (inf --> -0.697280).  Saving model ...
Epoch: 2 cost time: 3.301821231842041
Epoch: 2, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.116 Vali Acc: 0.884 Test Loss: 1.116 Test Acc: 0.884
Validation loss decreased (-0.697280 --> -0.883773).  Saving model ...
Epoch: 3 cost time: 3.3005025386810303
Epoch: 3, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.590 Vali Acc: 0.932 Test Loss: 0.590 Test Acc: 0.932
Validation loss decreased (-0.883773 --> -0.932427).  Saving model ...
Epoch: 4 cost time: 3.444826602935791
Epoch: 4, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.302 Vali Acc: 0.957 Test Loss: 0.302 Test Acc: 0.957
Validation loss decreased (-0.932427 --> -0.956754).  Saving model ...
Epoch: 5 cost time: 2.9566121101379395
Epoch: 5, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 3.744257688522339
Epoch: 6, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 3.24776029586792
Epoch: 7, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 3.9132440090179443
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5587403774261475
Epoch: 9, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7229020595550537
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.647747755050659
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.4129490852355957
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 3.456310987472534
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4893484115600586
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3428523540496826
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.491046905517578
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.204888343811035
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7351479530334473
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.5977649688720703
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.39367938041687
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7267844676971436
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.08955979347229
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 11052937
model size : 44.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 22.95935845375061
Epoch: 1, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.848 Vali Acc: 0.557 Test Loss: 1.848 Test Acc: 0.557
Validation loss decreased (inf --> -0.556738).  Saving model ...
Epoch: 2 cost time: 20.613961458206177
Epoch: 2, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.205 Vali Acc: 0.846 Test Loss: 1.205 Test Acc: 0.846
Validation loss decreased (-0.556738 --> -0.845934).  Saving model ...
Epoch: 3 cost time: 22.952372550964355
Epoch: 3, Steps: 17 | Train Loss: 0.963 Vali Loss: 0.704 Vali Acc: 0.895 Test Loss: 0.704 Test Acc: 0.895
Validation loss decreased (-0.845934 --> -0.894588).  Saving model ...
Epoch: 4 cost time: 20.900447130203247
Epoch: 4, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.356 Vali Acc: 0.965 Test Loss: 0.356 Test Acc: 0.965
Validation loss decreased (-0.894588 --> -0.964861).  Saving model ...
Epoch: 5 cost time: 24.713080883026123
Epoch: 5, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.340 Vali Acc: 0.914 Test Loss: 0.340 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.126965761184692
Epoch: 6, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.031675577163696
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.964861 --> -0.981080).  Saving model ...
Epoch: 8 cost time: 25.797192096710205
Epoch: 8, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.861141443252563
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.196213245391846
Epoch: 10, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.675148725509644
Epoch: 11, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.33525562286377
Epoch: 12, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.116 Vali Acc: 0.951 Test Loss: 0.116 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.12834119796753
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.50635004043579
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.079 Vali Acc: 0.968 Test Loss: 0.079 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.124788522720337
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.056 Vali Acc: 0.976 Test Loss: 0.056 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 24.897214889526367
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 23.40431237220764
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 37513673
model size : 144.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 10.807530403137207
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 1.909 Vali Acc: 0.543 Test Loss: 1.909 Test Acc: 0.543
Validation loss decreased (inf --> -0.543224).  Saving model ...
Epoch: 2 cost time: 9.122389078140259
Epoch: 2, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.348 Vali Acc: 0.886 Test Loss: 1.348 Test Acc: 0.886
Validation loss decreased (-0.543224 --> -0.886473).  Saving model ...
Epoch: 3 cost time: 9.045414209365845
Epoch: 3, Steps: 17 | Train Loss: 1.109 Vali Loss: 0.874 Vali Acc: 0.884 Test Loss: 0.874 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.347749710083008
Epoch: 4, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.476 Vali Acc: 0.935 Test Loss: 0.476 Test Acc: 0.935
Validation loss decreased (-0.886473 --> -0.935130).  Saving model ...
Epoch: 5 cost time: 8.919106245040894
Epoch: 5, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.316 Vali Acc: 0.938 Test Loss: 0.316 Test Acc: 0.938
Validation loss decreased (-0.935130 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 8.380136489868164
Epoch: 6, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.222 Vali Acc: 0.951 Test Loss: 0.222 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 9.027396202087402
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.963476181030273
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 8.932155132293701
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 8.911378860473633
Epoch: 10, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.557893991470337
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 8.84509825706482
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.437155485153198
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.184489727020264
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 7.905237913131714
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.3418607711792
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.020824193954468
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 18 cost time: 7.4273810386657715
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.143462657928467
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 8.053194046020508
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 8.964396953582764
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.153585433959961
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.810800552368164
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.037526369094849
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.542357921600342
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.729605436325073
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.414705038070679
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.838521957397461
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 9.115298748016357
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.39725375175476
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 11034569
model size : 43.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 17.957184553146362
Epoch: 1, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.849 Vali Acc: 0.551 Test Loss: 1.849 Test Acc: 0.551
Validation loss decreased (inf --> -0.551333).  Saving model ...
Epoch: 2 cost time: 17.451769828796387
Epoch: 2, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.206 Vali Acc: 0.846 Test Loss: 1.206 Test Acc: 0.846
Validation loss decreased (-0.551333 --> -0.845934).  Saving model ...
Epoch: 3 cost time: 17.778719902038574
Epoch: 3, Steps: 17 | Train Loss: 0.965 Vali Loss: 0.707 Vali Acc: 0.889 Test Loss: 0.707 Test Acc: 0.889
Validation loss decreased (-0.845934 --> -0.889182).  Saving model ...
Epoch: 4 cost time: 16.179052352905273
Epoch: 4, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.358 Vali Acc: 0.965 Test Loss: 0.358 Test Acc: 0.965
Validation loss decreased (-0.889182 --> -0.964861).  Saving model ...
Epoch: 5 cost time: 16.461740016937256
Epoch: 5, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.363 Vali Acc: 0.905 Test Loss: 0.363 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.008370637893677
Epoch: 6, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.16856575012207
Epoch: 7, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.964861 --> -0.978377).  Saving model ...
Epoch: 8 cost time: 18.67134690284729
Epoch: 8, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.375224113464355
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.167892932891846
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.14451789855957
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.800187826156616
Epoch: 12, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.97898507118225
Epoch: 13, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.038970947265625
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 16.74016785621643
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 18.15749764442444
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 17.80335021018982
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 18 cost time: 17.486934661865234
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 16.892669677734375
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 16.89038324356079
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 16.989809274673462
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 18.650402307510376
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 19.040847063064575
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 18.393956899642944
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 18.0444176197052
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 16.965688228607178
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 17.481616973876953
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 37513673
model size : 144.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.722788572311401
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 1.911 Vali Acc: 0.538 Test Loss: 1.911 Test Acc: 0.538
Validation loss decreased (inf --> -0.537819).  Saving model ...
Epoch: 2 cost time: 7.23919153213501
Epoch: 2, Steps: 17 | Train Loss: 1.696 Vali Loss: 1.350 Vali Acc: 0.876 Test Loss: 1.350 Test Acc: 0.876
Validation loss decreased (-0.537819 --> -0.875662).  Saving model ...
Epoch: 3 cost time: 6.6893956661224365
Epoch: 3, Steps: 17 | Train Loss: 1.111 Vali Loss: 0.874 Vali Acc: 0.881 Test Loss: 0.874 Test Acc: 0.881
Validation loss decreased (-0.875662 --> -0.881072).  Saving model ...
Epoch: 4 cost time: 7.190677165985107
Epoch: 4, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.477 Vali Acc: 0.938 Test Loss: 0.477 Test Acc: 0.938
Validation loss decreased (-0.881072 --> -0.937833).  Saving model ...
Epoch: 5 cost time: 7.0223777294158936
Epoch: 5, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
Validation loss decreased (-0.937833 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 6.982845783233643
Epoch: 6, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 7 cost time: 7.80015754699707
Epoch: 7, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.107596158981323
Epoch: 8, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 7.50791597366333
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 6.799599647521973
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 6.815056085586548
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 7.4031822681427
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.618024826049805
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 6.923852920532227
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 6.714146852493286
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 6.9731268882751465
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.960118055343628
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 6.566730976104736
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.082060813903809
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.726428985595703
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.857780694961548
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.653068780899048
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.470484733581543
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 6.824451923370361
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.403680086135864
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.589289903640747
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.6250927448272705
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.569919586181641
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.002650499343872
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.680625915527344
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 11034569
model size : 43.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.228869199752808
Epoch: 1, Steps: 17 | Train Loss: 2.073 Vali Loss: 1.909 Vali Acc: 0.486 Test Loss: 1.909 Test Acc: 0.486
Validation loss decreased (inf --> -0.486467).  Saving model ...
Epoch: 2 cost time: 9.193474531173706
Epoch: 2, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.368 Vali Acc: 0.870 Test Loss: 1.368 Test Acc: 0.870
Validation loss decreased (-0.486467 --> -0.870257).  Saving model ...
Epoch: 3 cost time: 9.324518203735352
Epoch: 3, Steps: 17 | Train Loss: 1.092 Vali Loss: 0.857 Vali Acc: 0.922 Test Loss: 0.857 Test Acc: 0.922
Validation loss decreased (-0.870257 --> -0.921613).  Saving model ...
Epoch: 4 cost time: 9.825746536254883
Epoch: 4, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.525 Vali Acc: 0.946 Test Loss: 0.525 Test Acc: 0.946
Validation loss decreased (-0.921613 --> -0.945941).  Saving model ...
Epoch: 5 cost time: 9.152268171310425
Epoch: 5, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.351 Vali Acc: 0.954 Test Loss: 0.351 Test Acc: 0.954
Validation loss decreased (-0.945941 --> -0.954051).  Saving model ...
Epoch: 6 cost time: 9.456101894378662
Epoch: 6, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.224 Vali Acc: 0.968 Test Loss: 0.224 Test Acc: 0.968
Validation loss decreased (-0.954051 --> -0.967565).  Saving model ...
Epoch: 7 cost time: 9.944783926010132
Epoch: 7, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.149 Vali Acc: 0.984 Test Loss: 0.149 Test Acc: 0.984
Validation loss decreased (-0.967565 --> -0.983782).  Saving model ...
Epoch: 8 cost time: 9.933298349380493
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.398933172225952
Epoch: 9, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.84484076499939
Epoch: 10, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.941511631011963
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
Validation loss decreased (-0.983782 --> -0.983783).  Saving model ...
Epoch: 12 cost time: 8.958166360855103
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.219973802566528
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 14 cost time: 9.446588277816772
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.837048292160034
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.95103907585144
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.530568838119507
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.033568143844604
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.06473183631897
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.548025369644165
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.476823091506958
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.020458936691284
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.446659088134766
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 37513673
model size : 144.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.673638820648193
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 1.926 Vali Acc: 0.519 Test Loss: 1.926 Test Acc: 0.519
Validation loss decreased (inf --> -0.518900).  Saving model ...
Epoch: 2 cost time: 4.956152677536011
Epoch: 2, Steps: 17 | Train Loss: 1.739 Vali Loss: 1.430 Vali Acc: 0.862 Test Loss: 1.430 Test Acc: 0.862
Validation loss decreased (-0.518900 --> -0.862148).  Saving model ...
Epoch: 3 cost time: 5.120583534240723
Epoch: 3, Steps: 17 | Train Loss: 1.199 Vali Loss: 0.967 Vali Acc: 0.924 Test Loss: 0.967 Test Acc: 0.924
Validation loss decreased (-0.862148 --> -0.924315).  Saving model ...
Epoch: 4 cost time: 4.5116400718688965
Epoch: 4, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.623 Vali Acc: 0.949 Test Loss: 0.623 Test Acc: 0.949
Validation loss decreased (-0.924315 --> -0.948642).  Saving model ...
Epoch: 5 cost time: 4.69242262840271
Epoch: 5, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.407 Vali Acc: 0.951 Test Loss: 0.407 Test Acc: 0.951
Validation loss decreased (-0.948642 --> -0.951347).  Saving model ...
Epoch: 6 cost time: 4.3241126537323
Epoch: 6, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.269 Vali Acc: 0.959 Test Loss: 0.269 Test Acc: 0.959
Validation loss decreased (-0.951347 --> -0.959457).  Saving model ...
Epoch: 7 cost time: 4.587787628173828
Epoch: 7, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.226 Vali Acc: 0.957 Test Loss: 0.226 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.19352912902832
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 4.6991448402404785
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.821315765380859
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 4.874299049377441
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.924849033355713
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.240766763687134
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.656090259552002
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 4.649176359176636
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.500879526138306
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.929854393005371
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.798594236373901
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.869486331939697
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.959127187728882
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.306030988693237
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.4006195068359375
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.747683763504028
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.531097888946533
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 11034569
model size : 43.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 14.681291818618774
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.011 Vali Acc: 0.262 Test Loss: 2.011 Test Acc: 0.262
Validation loss decreased (inf --> -0.262142).  Saving model ...
Epoch: 2 cost time: 13.363380670547485
Epoch: 2, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.501 Vali Acc: 0.711 Test Loss: 1.501 Test Acc: 0.711
Validation loss decreased (-0.262142 --> -0.710796).  Saving model ...
Epoch: 3 cost time: 12.376807451248169
Epoch: 3, Steps: 17 | Train Loss: 1.258 Vali Loss: 0.973 Vali Acc: 0.857 Test Loss: 0.973 Test Acc: 0.857
Validation loss decreased (-0.710796 --> -0.856747).  Saving model ...
Epoch: 4 cost time: 12.544325351715088
Epoch: 4, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
Validation loss decreased (-0.856747 --> -0.918913).  Saving model ...
Epoch: 5 cost time: 12.643312931060791
Epoch: 5, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.404 Vali Acc: 0.911 Test Loss: 0.404 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.517436265945435
Epoch: 6, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.918913 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 12.765753507614136
Epoch: 7, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.714715003967285
Epoch: 8, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.890029907226562
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 12.595264434814453
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.447339534759521
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.246 Vali Acc: 0.914 Test Loss: 0.246 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.555967330932617
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 13.68232011795044
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.630248069763184
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.372 Vali Acc: 0.892 Test Loss: 0.372 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.17519235610962
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.354 Vali Acc: 0.908 Test Loss: 0.354 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.892937660217285
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.473930358886719
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.161336898803711
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
Validation loss decreased (-0.954053 --> -0.962160).  Saving model ...
Epoch: 19 cost time: 12.305380821228027
Epoch: 19, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 12.744157075881958
Epoch: 20, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.587 Vali Acc: 0.830 Test Loss: 0.587 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.811991930007935
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 11.933227777481079
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.431362867355347
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 12.39906644821167
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 12.411860704421997
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 12.039469242095947
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.140949487686157
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 12.267459392547607
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 12.689754009246826
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 12.571272850036621
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 18767305
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.737184762954712
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.057 Vali Acc: 0.205 Test Loss: 2.057 Test Acc: 0.205
Validation loss decreased (inf --> -0.205385).  Saving model ...
Epoch: 2 cost time: 5.12882661819458
Epoch: 2, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.575 Vali Acc: 0.811 Test Loss: 1.575 Test Acc: 0.811
Validation loss decreased (-0.205385 --> -0.810795).  Saving model ...
Epoch: 3 cost time: 5.084566116333008
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 0.996 Vali Acc: 0.886 Test Loss: 0.996 Test Acc: 0.886
Validation loss decreased (-0.810795 --> -0.886477).  Saving model ...
Epoch: 4 cost time: 4.8994646072387695
Epoch: 4, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.579 Vali Acc: 0.943 Test Loss: 0.579 Test Acc: 0.943
Validation loss decreased (-0.886477 --> -0.943237).  Saving model ...
Epoch: 5 cost time: 6.0105719566345215
Epoch: 5, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.402 Vali Acc: 0.927 Test Loss: 0.402 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7657470703125
Epoch: 6, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.259 Vali Acc: 0.957 Test Loss: 0.259 Test Acc: 0.957
Validation loss decreased (-0.943237 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 5.40157675743103
Epoch: 7, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.779116153717041
Epoch: 8, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 6.037468194961548
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 5.545916557312012
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 4.955919981002808
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.756989240646362
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.713489532470703
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.217775821685791
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 5.216473340988159
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.967566 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 5.671130895614624
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.6417155265808105
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.288290500640869
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 5.2732298374176025
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.774895191192627
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.506360054016113
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 22 cost time: 5.184962511062622
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 23 cost time: 5.420072793960571
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 24 cost time: 6.423704147338867
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.057 Vali Acc: 0.981 Test Loss: 0.057 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981081).  Saving model ...
Epoch: 25 cost time: 5.813555955886841
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.621259927749634
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.058 Vali Acc: 0.978 Test Loss: 0.058 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.128967046737671
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.055 Vali Acc: 0.981 Test Loss: 0.055 Test Acc: 0.981
Validation loss decreased (-0.981081 --> -0.981081).  Saving model ...
Epoch: 28 cost time: 6.1110382080078125
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.051 Vali Acc: 0.981 Test Loss: 0.051 Test Acc: 0.981
Validation loss decreased (-0.981081 --> -0.981081).  Saving model ...
Epoch: 29 cost time: 5.920348882675171
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.050 Vali Acc: 0.981 Test Loss: 0.050 Test Acc: 0.981
Validation loss decreased (-0.981081 --> -0.981081).  Saving model ...
Epoch: 30 cost time: 6.102638483047485
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.051 Vali Acc: 0.981 Test Loss: 0.051 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 5527497
model size : 22.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.685639381408691
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.011 Vali Acc: 0.262 Test Loss: 2.011 Test Acc: 0.262
Validation loss decreased (inf --> -0.262142).  Saving model ...
Epoch: 2 cost time: 9.93841028213501
Epoch: 2, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.500 Vali Acc: 0.711 Test Loss: 1.500 Test Acc: 0.711
Validation loss decreased (-0.262142 --> -0.710796).  Saving model ...
Epoch: 3 cost time: 10.7754225730896
Epoch: 3, Steps: 17 | Train Loss: 1.259 Vali Loss: 0.974 Vali Acc: 0.857 Test Loss: 0.974 Test Acc: 0.857
Validation loss decreased (-0.710796 --> -0.856747).  Saving model ...
Epoch: 4 cost time: 10.011375188827515
Epoch: 4, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.555 Vali Acc: 0.919 Test Loss: 0.555 Test Acc: 0.919
Validation loss decreased (-0.856747 --> -0.918913).  Saving model ...
Epoch: 5 cost time: 10.503978729248047
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.405 Vali Acc: 0.905 Test Loss: 0.405 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.292531490325928
Epoch: 6, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.918913 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 9.974340200424194
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.347 Vali Acc: 0.889 Test Loss: 0.347 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.689310312271118
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.215 Vali Acc: 0.927 Test Loss: 0.215 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.959730863571167
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.924 Test Loss: 0.223 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.982377290725708
Epoch: 10, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.616172790527344
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.282 Vali Acc: 0.892 Test Loss: 0.282 Test Acc: 0.892
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.027763366699219
Epoch: 12, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 9.849659442901611
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.200 Vali Acc: 0.927 Test Loss: 0.200 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.295551538467407
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.629056692123413
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.04097867012024
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.29736876487732
Epoch: 17, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.203 Vali Acc: 0.932 Test Loss: 0.203 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.02790641784668
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 19 cost time: 9.223058700561523
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 9.223883628845215
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 21 cost time: 10.043149709701538
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.158568859100342
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.8239426612854
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.353705644607544
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.169399976730347
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 10.016237497329712
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.275429964065552
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 10.157986879348755
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 9.85663366317749
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 9.249234199523926
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 18767305
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.914344310760498
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.057 Vali Acc: 0.205 Test Loss: 2.057 Test Acc: 0.205
Validation loss decreased (inf --> -0.205385).  Saving model ...
Epoch: 2 cost time: 4.271311044692993
Epoch: 2, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.575 Vali Acc: 0.811 Test Loss: 1.575 Test Acc: 0.811
Validation loss decreased (-0.205385 --> -0.810795).  Saving model ...
Epoch: 3 cost time: 4.583951234817505
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 0.996 Vali Acc: 0.886 Test Loss: 0.996 Test Acc: 0.886
Validation loss decreased (-0.810795 --> -0.886477).  Saving model ...
Epoch: 4 cost time: 4.862429857254028
Epoch: 4, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.580 Vali Acc: 0.943 Test Loss: 0.580 Test Acc: 0.943
Validation loss decreased (-0.886477 --> -0.943237).  Saving model ...
Epoch: 5 cost time: 4.692843437194824
Epoch: 5, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.402 Vali Acc: 0.927 Test Loss: 0.402 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.296942949295044
Epoch: 6, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.260 Vali Acc: 0.957 Test Loss: 0.260 Test Acc: 0.957
Validation loss decreased (-0.943237 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 4.239761829376221
Epoch: 7, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.546403884887695
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 4.690793752670288
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 4.531430244445801
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 4.401356220245361
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.207550048828125
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.2474188804626465
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 3.25766658782959
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 4.288813352584839
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.139112949371338
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 3.944812297821045
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 4.193397760391235
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.04375696182251
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9200453758239746
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 4.16381311416626
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 4.095052480697632
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.933739185333252
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.246332883834839
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 4.355059385299683
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.9212870597839355
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.1113128662109375
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.316983222961426
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 29 cost time: 4.042309761047363
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 30 cost time: 3.9481234550476074
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 5527497
model size : 22.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.2979066371917725
Epoch: 1, Steps: 17 | Train Loss: 2.215 Vali Loss: 2.027 Vali Acc: 0.235 Test Loss: 2.027 Test Acc: 0.235
Validation loss decreased (inf --> -0.235115).  Saving model ...
Epoch: 2 cost time: 4.834017515182495
Epoch: 2, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.578 Vali Acc: 0.730 Test Loss: 1.578 Test Acc: 0.730
Validation loss decreased (-0.235115 --> -0.729714).  Saving model ...
Epoch: 3 cost time: 4.899438381195068
Epoch: 3, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.087 Vali Acc: 0.870 Test Loss: 1.087 Test Acc: 0.870
Validation loss decreased (-0.729714 --> -0.870259).  Saving model ...
Epoch: 4 cost time: 4.831991195678711
Epoch: 4, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.700 Vali Acc: 0.908 Test Loss: 0.700 Test Acc: 0.908
Validation loss decreased (-0.870259 --> -0.908101).  Saving model ...
Epoch: 5 cost time: 5.188419580459595
Epoch: 5, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.471 Vali Acc: 0.924 Test Loss: 0.471 Test Acc: 0.924
Validation loss decreased (-0.908101 --> -0.924320).  Saving model ...
Epoch: 6 cost time: 4.649935722351074
Epoch: 6, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 7 cost time: 4.887900114059448
Epoch: 7, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
Validation loss decreased (-0.929726 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 5.3547868728637695
Epoch: 8, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
Validation loss decreased (-0.943241 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 4.74588418006897
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.70675802230835
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.309739112854004
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.7343363761901855
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 4.629339933395386
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.238790988922119
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.855123996734619
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.7210693359375
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.2162699699401855
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.787882089614868
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.822439432144165
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 4.721026420593262
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.943 Test Loss: 0.150 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.4889137744903564
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.531620264053345
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.065332412719727
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.63129186630249
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.471147537231445
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.174658536911011
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.6331422328948975
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.614238023757935
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.096130847930908
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 18767305
model size : 72.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.574084520339966
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.064 Vali Acc: 0.186 Test Loss: 2.064 Test Acc: 0.186
Validation loss decreased (inf --> -0.186466).  Saving model ...
Epoch: 2 cost time: 3.0648109912872314
Epoch: 2, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.623 Vali Acc: 0.789 Test Loss: 1.623 Test Acc: 0.789
Validation loss decreased (-0.186466 --> -0.789173).  Saving model ...
Epoch: 3 cost time: 2.780442237854004
Epoch: 3, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.117 Vali Acc: 0.881 Test Loss: 1.117 Test Acc: 0.881
Validation loss decreased (-0.789173 --> -0.881070).  Saving model ...
Epoch: 4 cost time: 2.741771697998047
Epoch: 4, Steps: 17 | Train Loss: 0.879 Vali Loss: 0.706 Vali Acc: 0.927 Test Loss: 0.706 Test Acc: 0.927
Validation loss decreased (-0.881070 --> -0.927020).  Saving model ...
Epoch: 5 cost time: 3.1385695934295654
Epoch: 5, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.459 Vali Acc: 0.941 Test Loss: 0.459 Test Acc: 0.941
Validation loss decreased (-0.927020 --> -0.940536).  Saving model ...
Epoch: 6 cost time: 2.8984789848327637
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.314 Vali Acc: 0.957 Test Loss: 0.314 Test Acc: 0.957
Validation loss decreased (-0.940536 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 2.724644184112549
Epoch: 7, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.255 Vali Acc: 0.954 Test Loss: 0.255 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9000868797302246
Epoch: 8, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 3.2503297328948975
Epoch: 9, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2461917400360107
Epoch: 10, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 2.9928741455078125
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0818862915039062
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 3.447033166885376
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.349290132522583
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 3.0037336349487305
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9859604835510254
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1922860145568848
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.18206524848938
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.930280923843384
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.958026170730591
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0799076557159424
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.902118682861328
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.1406965255737305
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.442930221557617
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 5527497
model size : 22.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 10.560198068618774
Epoch: 1, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.046 Vali Acc: 0.316 Test Loss: 2.046 Test Acc: 0.316
Validation loss decreased (inf --> -0.316196).  Saving model ...
Epoch: 2 cost time: 9.955333471298218
Epoch: 2, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.626 Vali Acc: 0.781 Test Loss: 1.626 Test Acc: 0.781
Validation loss decreased (-0.316196 --> -0.781065).  Saving model ...
Epoch: 3 cost time: 9.251806497573853
Epoch: 3, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.070 Vali Acc: 0.865 Test Loss: 1.070 Test Acc: 0.865
Validation loss decreased (-0.781065 --> -0.864854).  Saving model ...
Epoch: 4 cost time: 9.66369915008545
Epoch: 4, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.644 Vali Acc: 0.930 Test Loss: 0.644 Test Acc: 0.930
Validation loss decreased (-0.864854 --> -0.929723).  Saving model ...
Epoch: 5 cost time: 9.356409072875977
Epoch: 5, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.400 Vali Acc: 0.957 Test Loss: 0.400 Test Acc: 0.957
Validation loss decreased (-0.929723 --> -0.956753).  Saving model ...
Epoch: 6 cost time: 9.020178079605103
Epoch: 6, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.289 Vali Acc: 0.951 Test Loss: 0.289 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.993458986282349
Epoch: 7, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
Validation loss decreased (-0.956753 --> -0.970268).  Saving model ...
Epoch: 8 cost time: 8.449999332427979
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.216551065444946
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 8.30482006072998
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.233248710632324
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.114320993423462
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.970269 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 9.562758684158325
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.84617018699646
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.258097648620605
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 16 cost time: 8.59336519241333
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.448963165283203
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.968 Test Loss: 0.083 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.07236647605896
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.500265836715698
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.153602361679077
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 21 cost time: 9.379220724105835
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 22 cost time: 10.170604228973389
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.500311613082886
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 10.200417041778564
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.983783 --> -0.983783).  Saving model ...
Epoch: 25 cost time: 9.563217639923096
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.733563899993896
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.914738178253174
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.800047397613525
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.732548475265503
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 8.982009172439575
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 9394121
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.172222375869751
Epoch: 1, Steps: 17 | Train Loss: 2.116 Vali Loss: 1.996 Vali Acc: 0.341 Test Loss: 1.996 Test Acc: 0.341
Validation loss decreased (inf --> -0.340521).  Saving model ...
Epoch: 2 cost time: 4.480709075927734
Epoch: 2, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.632 Vali Acc: 0.741 Test Loss: 1.632 Test Acc: 0.741
Validation loss decreased (-0.340521 --> -0.740524).  Saving model ...
Epoch: 3 cost time: 4.7980921268463135
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.184 Vali Acc: 0.878 Test Loss: 1.184 Test Acc: 0.878
Validation loss decreased (-0.740524 --> -0.878367).  Saving model ...
Epoch: 4 cost time: 4.155810117721558
Epoch: 4, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.755 Vali Acc: 0.900 Test Loss: 0.755 Test Acc: 0.900
Validation loss decreased (-0.878367 --> -0.899992).  Saving model ...
Epoch: 5 cost time: 4.307779788970947
Epoch: 5, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.507 Vali Acc: 0.924 Test Loss: 0.507 Test Acc: 0.924
Validation loss decreased (-0.899992 --> -0.924319).  Saving model ...
Epoch: 6 cost time: 4.389784097671509
Epoch: 6, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.380 Vali Acc: 0.932 Test Loss: 0.380 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932429).  Saving model ...
Epoch: 7 cost time: 3.715595245361328
Epoch: 7, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 4.43108606338501
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 3.9609522819519043
Epoch: 9, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951350).  Saving model ...
Epoch: 10 cost time: 4.2329840660095215
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.270319223403931
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 4.559960603713989
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.322108507156372
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.2582292556762695
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.579592704772949
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.102157115936279
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.530852556228638
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.06702446937561
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.20563817024231
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.406886577606201
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 4.142097234725952
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.561896562576294
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.174684047698975
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 4.635918140411377
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 4.338104486465454
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 26 cost time: 4.40011191368103
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 4.439677953720093
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.138697147369385
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.5786354541778564
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.188134431838989
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 2773961
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.599069595336914
Epoch: 1, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.047 Vali Acc: 0.316 Test Loss: 2.047 Test Acc: 0.316
Validation loss decreased (inf --> -0.316196).  Saving model ...
Epoch: 2 cost time: 6.548059940338135
Epoch: 2, Steps: 17 | Train Loss: 1.815 Vali Loss: 1.628 Vali Acc: 0.778 Test Loss: 1.628 Test Acc: 0.778
Validation loss decreased (-0.316196 --> -0.778362).  Saving model ...
Epoch: 3 cost time: 5.966242790222168
Epoch: 3, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.071 Vali Acc: 0.859 Test Loss: 1.071 Test Acc: 0.859
Validation loss decreased (-0.778362 --> -0.859449).  Saving model ...
Epoch: 4 cost time: 6.559304714202881
Epoch: 4, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.646 Vali Acc: 0.930 Test Loss: 0.646 Test Acc: 0.930
Validation loss decreased (-0.859449 --> -0.929723).  Saving model ...
Epoch: 5 cost time: 5.953374624252319
Epoch: 5, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.402 Vali Acc: 0.957 Test Loss: 0.402 Test Acc: 0.957
Validation loss decreased (-0.929723 --> -0.956753).  Saving model ...
Epoch: 6 cost time: 6.6179749965667725
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.289 Vali Acc: 0.951 Test Loss: 0.289 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.882392644882202
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
Validation loss decreased (-0.956753 --> -0.972971).  Saving model ...
Epoch: 8 cost time: 6.603329658508301
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.507152795791626
Epoch: 9, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.3651347160339355
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.726340055465698
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.333622455596924
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.972971 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 6.842711687088013
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.288410663604736
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.964539289474487
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.239853382110596
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.534587383270264
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.91310715675354
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.13967251777649
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.064 Vali Acc: 0.976 Test Loss: 0.064 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.706885814666748
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.454450845718384
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 8.099350690841675
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.507791042327881
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.981080 --> -0.983783).  Saving model ...
Epoch: 24 cost time: 7.65458083152771
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
Validation loss decreased (-0.983783 --> -0.986486).  Saving model ...
Epoch: 25 cost time: 8.177260637283325
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.708174467086792
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 8.184725046157837
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.768360137939453
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.31729507446289
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 7.65812349319458
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9864864864864865
model parameter : 9394121
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.135308742523193
Epoch: 1, Steps: 17 | Train Loss: 2.116 Vali Loss: 1.997 Vali Acc: 0.341 Test Loss: 1.997 Test Acc: 0.341
Validation loss decreased (inf --> -0.340521).  Saving model ...
Epoch: 2 cost time: 4.618042945861816
Epoch: 2, Steps: 17 | Train Loss: 1.822 Vali Loss: 1.632 Vali Acc: 0.741 Test Loss: 1.632 Test Acc: 0.741
Validation loss decreased (-0.340521 --> -0.740524).  Saving model ...
Epoch: 3 cost time: 4.2948267459869385
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.183 Vali Acc: 0.881 Test Loss: 1.183 Test Acc: 0.881
Validation loss decreased (-0.740524 --> -0.881069).  Saving model ...
Epoch: 4 cost time: 4.1985626220703125
Epoch: 4, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.756 Vali Acc: 0.897 Test Loss: 0.756 Test Acc: 0.897
Validation loss decreased (-0.881069 --> -0.897290).  Saving model ...
Epoch: 5 cost time: 4.671388626098633
Epoch: 5, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.509 Vali Acc: 0.919 Test Loss: 0.509 Test Acc: 0.919
Validation loss decreased (-0.897290 --> -0.918914).  Saving model ...
Epoch: 6 cost time: 4.016519784927368
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921618).  Saving model ...
Epoch: 7 cost time: 4.150600433349609
Epoch: 7, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.293 Vali Acc: 0.935 Test Loss: 0.293 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935132).  Saving model ...
Epoch: 8 cost time: 4.879680156707764
Epoch: 8, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 4.3553383350372314
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 4.632424354553223
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.656989336013794
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 4.483609676361084
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.630337238311768
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.727137565612793
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.563412427902222
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.656261682510376
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 4.3624162673950195
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.15647029876709
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.64618706703186
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.207 Vali Acc: 0.935 Test Loss: 0.207 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.183812618255615
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.268026113510132
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.579247951507568
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.119857311248779
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.393240213394165
Epoch: 24, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.510289192199707
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.398248672485352
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 2773961
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.255254507064819
Epoch: 1, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.054 Vali Acc: 0.300 Test Loss: 2.054 Test Acc: 0.300
Validation loss decreased (inf --> -0.299979).  Saving model ...
Epoch: 2 cost time: 4.485777854919434
Epoch: 2, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.672 Vali Acc: 0.738 Test Loss: 1.672 Test Acc: 0.738
Validation loss decreased (-0.299979 --> -0.737821).  Saving model ...
Epoch: 3 cost time: 5.122537612915039
Epoch: 3, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.186 Vali Acc: 0.873 Test Loss: 1.186 Test Acc: 0.873
Validation loss decreased (-0.737821 --> -0.872961).  Saving model ...
Epoch: 4 cost time: 4.841192722320557
Epoch: 4, Steps: 17 | Train Loss: 0.923 Vali Loss: 0.781 Vali Acc: 0.911 Test Loss: 0.781 Test Acc: 0.911
Validation loss decreased (-0.872961 --> -0.910803).  Saving model ...
Epoch: 5 cost time: 4.779206991195679
Epoch: 5, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.512 Vali Acc: 0.949 Test Loss: 0.512 Test Acc: 0.949
Validation loss decreased (-0.910803 --> -0.948644).  Saving model ...
Epoch: 6 cost time: 5.073048114776611
Epoch: 6, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.353 Vali Acc: 0.954 Test Loss: 0.353 Test Acc: 0.954
Validation loss decreased (-0.948644 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 4.922162294387817
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.249 Vali Acc: 0.968 Test Loss: 0.249 Test Acc: 0.968
Validation loss decreased (-0.954051 --> -0.967565).  Saving model ...
Epoch: 8 cost time: 4.930459976196289
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.033577919006348
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
Validation loss decreased (-0.967565 --> -0.972971).  Saving model ...
Epoch: 10 cost time: 4.904052257537842
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975674).  Saving model ...
Epoch: 11 cost time: 4.9090094566345215
Epoch: 11, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.443742036819458
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 4.906682014465332
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.6970109939575195
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.8183088302612305
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.492102146148682
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.664628267288208
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.546553134918213
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.455625057220459
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.9942591190338135
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.562094211578369
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.740792989730835
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 4.582722187042236
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.754387378692627
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.6136393547058105
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.701912879943848
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.861469268798828
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.70489764213562
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.911662578582764
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.51198673248291
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 9394121
model size : 37.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.585661888122559
Epoch: 1, Steps: 17 | Train Loss: 2.118 Vali Loss: 2.002 Vali Acc: 0.335 Test Loss: 2.002 Test Acc: 0.335
Validation loss decreased (inf --> -0.335115).  Saving model ...
Epoch: 2 cost time: 2.998474359512329
Epoch: 2, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.657 Vali Acc: 0.714 Test Loss: 1.657 Test Acc: 0.714
Validation loss decreased (-0.335115 --> -0.713497).  Saving model ...
Epoch: 3 cost time: 3.136347770690918
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.259 Vali Acc: 0.878 Test Loss: 1.259 Test Acc: 0.878
Validation loss decreased (-0.713497 --> -0.878366).  Saving model ...
Epoch: 4 cost time: 2.905524969100952
Epoch: 4, Steps: 17 | Train Loss: 1.028 Vali Loss: 0.875 Vali Acc: 0.908 Test Loss: 0.875 Test Acc: 0.908
Validation loss decreased (-0.878366 --> -0.908099).  Saving model ...
Epoch: 5 cost time: 2.799053192138672
Epoch: 5, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.611 Vali Acc: 0.900 Test Loss: 0.611 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9972829818725586
Epoch: 6, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.441 Vali Acc: 0.914 Test Loss: 0.441 Test Acc: 0.914
Validation loss decreased (-0.908099 --> -0.913509).  Saving model ...
Epoch: 7 cost time: 2.868288040161133
Epoch: 7, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.913509 --> -0.940537).  Saving model ...
Epoch: 8 cost time: 2.964508056640625
Epoch: 8, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943241).  Saving model ...
Epoch: 9 cost time: 3.009341239929199
Epoch: 9, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.198 Vali Acc: 0.954 Test Loss: 0.198 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 2.959537982940674
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 2.9519858360290527
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 3.0677523612976074
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8213188648223877
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 2.9548583030700684
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9497904777526855
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7982430458068848
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0205495357513428
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8829479217529297
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.803351640701294
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9167113304138184
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.828662157058716
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.867683172225952
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0476455688476562
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 2773961
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 10.938662767410278
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 2.062 Vali Acc: 0.243 Test Loss: 2.062 Test Acc: 0.243
Validation loss decreased (inf --> -0.243223).  Saving model ...
Epoch: 2 cost time: 9.487216472625732
Epoch: 2, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.748 Vali Acc: 0.689 Test Loss: 1.748 Test Acc: 0.689
Validation loss decreased (-0.243223 --> -0.689172).  Saving model ...
Epoch: 3 cost time: 9.375821590423584
Epoch: 3, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.365 Vali Acc: 0.827 Test Loss: 1.365 Test Acc: 0.827
Validation loss decreased (-0.689172 --> -0.827013).  Saving model ...
Epoch: 4 cost time: 9.600282192230225
Epoch: 4, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.022 Vali Acc: 0.876 Test Loss: 1.022 Test Acc: 0.876
Validation loss decreased (-0.827013 --> -0.875665).  Saving model ...
Epoch: 5 cost time: 10.035613775253296
Epoch: 5, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.757 Vali Acc: 0.938 Test Loss: 0.757 Test Acc: 0.938
Validation loss decreased (-0.875665 --> -0.937830).  Saving model ...
Epoch: 6 cost time: 9.84795331954956
Epoch: 6, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.569 Vali Acc: 0.941 Test Loss: 0.569 Test Acc: 0.941
Validation loss decreased (-0.937830 --> -0.940535).  Saving model ...
Epoch: 7 cost time: 9.510183334350586
Epoch: 7, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.413 Vali Acc: 0.957 Test Loss: 0.413 Test Acc: 0.957
Validation loss decreased (-0.940535 --> -0.956753).  Saving model ...
Epoch: 8 cost time: 9.399335145950317
Epoch: 8, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.306 Vali Acc: 0.954 Test Loss: 0.306 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.816379070281982
Epoch: 9, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.262 Vali Acc: 0.957 Test Loss: 0.262 Test Acc: 0.957
Validation loss decreased (-0.956753 --> -0.956754).  Saving model ...
Epoch: 10 cost time: 9.585057497024536
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.216 Vali Acc: 0.954 Test Loss: 0.216 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.69871735572815
Epoch: 11, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.124136447906494
Epoch: 12, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 10.66875147819519
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.215055704116821
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.128032922744751
Epoch: 15, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.475159168243408
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.984970092773438
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.461426496505737
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.847193241119385
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 9.43023157119751
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 9.778414011001587
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.655734777450562
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.760234594345093
Epoch: 23, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.17357850074768
Epoch: 24, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.130547046661377
Epoch: 25, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.195 Vali Acc: 0.932 Test Loss: 0.195 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.55682635307312
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.196293592453003
Epoch: 27, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.696604013442993
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.946 Test Loss: 0.143 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 9.473056554794312
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.027671098709106
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.957 Test Loss: 0.107 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 9385193
model size : 36.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.082419872283936
Epoch: 1, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.059 Vali Acc: 0.259 Test Loss: 2.059 Test Acc: 0.259
Validation loss decreased (inf --> -0.259439).  Saving model ...
Epoch: 2 cost time: 5.736986875534058
Epoch: 2, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.786 Vali Acc: 0.695 Test Loss: 1.786 Test Acc: 0.695
Validation loss decreased (-0.259439 --> -0.694577).  Saving model ...
Epoch: 3 cost time: 5.643272638320923
Epoch: 3, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.429 Vali Acc: 0.835 Test Loss: 1.429 Test Acc: 0.835
Validation loss decreased (-0.694577 --> -0.835121).  Saving model ...
Epoch: 4 cost time: 5.954331636428833
Epoch: 4, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.080 Vali Acc: 0.892 Test Loss: 1.080 Test Acc: 0.892
Validation loss decreased (-0.835121 --> -0.891881).  Saving model ...
Epoch: 5 cost time: 5.6399900913238525
Epoch: 5, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.770 Vali Acc: 0.943 Test Loss: 0.770 Test Acc: 0.943
Validation loss decreased (-0.891881 --> -0.943236).  Saving model ...
Epoch: 6 cost time: 5.576808929443359
Epoch: 6, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.568 Vali Acc: 0.941 Test Loss: 0.568 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.673418760299683
Epoch: 7, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.457 Vali Acc: 0.941 Test Loss: 0.457 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.782657861709595
Epoch: 8, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.313 Vali Acc: 0.965 Test Loss: 0.313 Test Acc: 0.965
Validation loss decreased (-0.943236 --> -0.964862).  Saving model ...
Epoch: 9 cost time: 5.608546733856201
Epoch: 9, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.278 Vali Acc: 0.949 Test Loss: 0.278 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.968997001647949
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.211 Vali Acc: 0.965 Test Loss: 0.211 Test Acc: 0.965
Validation loss decreased (-0.964862 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 5.930945158004761
Epoch: 11, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.553919792175293
Epoch: 12, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 5.854385614395142
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.925793647766113
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 5.53987455368042
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.984257459640503
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 5.859571695327759
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.566449880599976
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 6.006728887557983
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.975846529006958
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.443516254425049
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.810924053192139
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.044347286224365
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.565618991851807
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.054889917373657
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.904917240142822
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.54054594039917
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.941889762878418
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2764777
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.058089971542358
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 2.063 Vali Acc: 0.243 Test Loss: 2.063 Test Acc: 0.243
Validation loss decreased (inf --> -0.243223).  Saving model ...
Epoch: 2 cost time: 7.352095365524292
Epoch: 2, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.749 Vali Acc: 0.689 Test Loss: 1.749 Test Acc: 0.689
Validation loss decreased (-0.243223 --> -0.689172).  Saving model ...
Epoch: 3 cost time: 7.052675485610962
Epoch: 3, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.364 Vali Acc: 0.822 Test Loss: 1.364 Test Acc: 0.822
Validation loss decreased (-0.689172 --> -0.821608).  Saving model ...
Epoch: 4 cost time: 6.718923330307007
Epoch: 4, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.022 Vali Acc: 0.873 Test Loss: 1.022 Test Acc: 0.873
Validation loss decreased (-0.821608 --> -0.872963).  Saving model ...
Epoch: 5 cost time: 7.254103899002075
Epoch: 5, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.757 Vali Acc: 0.935 Test Loss: 0.757 Test Acc: 0.935
Validation loss decreased (-0.872963 --> -0.935128).  Saving model ...
Epoch: 6 cost time: 6.8145036697387695
Epoch: 6, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.573 Vali Acc: 0.941 Test Loss: 0.573 Test Acc: 0.941
Validation loss decreased (-0.935128 --> -0.940535).  Saving model ...
Epoch: 7 cost time: 7.359423398971558
Epoch: 7, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.417 Vali Acc: 0.957 Test Loss: 0.417 Test Acc: 0.957
Validation loss decreased (-0.940535 --> -0.956753).  Saving model ...
Epoch: 8 cost time: 6.959681510925293
Epoch: 8, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.306 Vali Acc: 0.954 Test Loss: 0.306 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.233820676803589
Epoch: 9, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.261 Vali Acc: 0.951 Test Loss: 0.261 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.860812425613403
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.226 Vali Acc: 0.962 Test Loss: 0.226 Test Acc: 0.962
Validation loss decreased (-0.956753 --> -0.962160).  Saving model ...
Epoch: 11 cost time: 6.70965838432312
Epoch: 11, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.196481943130493
Epoch: 12, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.585275173187256
Epoch: 13, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.070479154586792
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.469455003738403
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.24177098274231
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 8.080580949783325
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 7.619719743728638
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.002013444900513
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 7.500831604003906
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.878037691116333
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.498389482498169
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.003045558929443
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.597994804382324
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 8.03256630897522
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.654087781906128
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.118224382400513
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.627322673797607
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 8.128618001937866
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 9385193
model size : 36.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.682571172714233
Epoch: 1, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.059 Vali Acc: 0.254 Test Loss: 2.059 Test Acc: 0.254
Validation loss decreased (inf --> -0.254033).  Saving model ...
Epoch: 2 cost time: 4.291757822036743
Epoch: 2, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.788 Vali Acc: 0.689 Test Loss: 1.788 Test Acc: 0.689
Validation loss decreased (-0.254033 --> -0.689171).  Saving model ...
Epoch: 3 cost time: 4.388142824172974
Epoch: 3, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.428 Vali Acc: 0.832 Test Loss: 1.428 Test Acc: 0.832
Validation loss decreased (-0.689171 --> -0.832418).  Saving model ...
Epoch: 4 cost time: 4.807766437530518
Epoch: 4, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.079 Vali Acc: 0.895 Test Loss: 1.079 Test Acc: 0.895
Validation loss decreased (-0.832418 --> -0.894584).  Saving model ...
Epoch: 5 cost time: 4.44910454750061
Epoch: 5, Steps: 17 | Train Loss: 0.930 Vali Loss: 0.771 Vali Acc: 0.943 Test Loss: 0.771 Test Acc: 0.943
Validation loss decreased (-0.894584 --> -0.943236).  Saving model ...
Epoch: 6 cost time: 4.468047380447388
Epoch: 6, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.569 Vali Acc: 0.943 Test Loss: 0.569 Test Acc: 0.943
Validation loss decreased (-0.943236 --> -0.943238).  Saving model ...
Epoch: 7 cost time: 4.867458820343018
Epoch: 7, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.457 Vali Acc: 0.941 Test Loss: 0.457 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.569534540176392
Epoch: 8, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.314 Vali Acc: 0.965 Test Loss: 0.314 Test Acc: 0.965
Validation loss decreased (-0.943238 --> -0.964862).  Saving model ...
Epoch: 9 cost time: 4.509905099868774
Epoch: 9, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.280 Vali Acc: 0.946 Test Loss: 0.280 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.859098672866821
Epoch: 10, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.69547438621521
Epoch: 11, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.4297778606414795
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.964862 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 4.530715703964233
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.423898696899414
Epoch: 14, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 4.655032396316528
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.2528910636901855
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 4.2128894329071045
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.779294967651367
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.359929323196411
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.253838062286377
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.362055540084839
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.382936477661133
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.659945487976074
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.540289878845215
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.612667083740234
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.861142158508301
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2764777
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.7421345710754395
Epoch: 1, Steps: 17 | Train Loss: 2.190 Vali Loss: 2.069 Vali Acc: 0.222 Test Loss: 2.069 Test Acc: 0.222
Validation loss decreased (inf --> -0.221601).  Saving model ...
Epoch: 2 cost time: 5.359099626541138
Epoch: 2, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.778 Vali Acc: 0.659 Test Loss: 1.778 Test Acc: 0.659
Validation loss decreased (-0.221601 --> -0.659442).  Saving model ...
Epoch: 3 cost time: 5.257205009460449
Epoch: 3, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.444 Vali Acc: 0.827 Test Loss: 1.444 Test Acc: 0.827
Validation loss decreased (-0.659442 --> -0.827013).  Saving model ...
Epoch: 4 cost time: 5.238974571228027
Epoch: 4, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.139 Vali Acc: 0.889 Test Loss: 1.139 Test Acc: 0.889
Validation loss decreased (-0.827013 --> -0.889178).  Saving model ...
Epoch: 5 cost time: 4.866129398345947
Epoch: 5, Steps: 17 | Train Loss: 0.996 Vali Loss: 0.880 Vali Acc: 0.919 Test Loss: 0.880 Test Acc: 0.919
Validation loss decreased (-0.889178 --> -0.918910).  Saving model ...
Epoch: 6 cost time: 5.525695323944092
Epoch: 6, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.685 Vali Acc: 0.946 Test Loss: 0.685 Test Acc: 0.946
Validation loss decreased (-0.918910 --> -0.945939).  Saving model ...
Epoch: 7 cost time: 5.3524158000946045
Epoch: 7, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.515 Vali Acc: 0.954 Test Loss: 0.515 Test Acc: 0.954
Validation loss decreased (-0.945939 --> -0.954049).  Saving model ...
Epoch: 8 cost time: 5.5019683837890625
Epoch: 8, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.388 Vali Acc: 0.954 Test Loss: 0.388 Test Acc: 0.954
Validation loss decreased (-0.954049 --> -0.954050).  Saving model ...
Epoch: 9 cost time: 5.667004346847534
Epoch: 9, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.337 Vali Acc: 0.949 Test Loss: 0.337 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.260579347610474
Epoch: 10, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.250 Vali Acc: 0.959 Test Loss: 0.250 Test Acc: 0.959
Validation loss decreased (-0.954050 --> -0.959457).  Saving model ...
Epoch: 11 cost time: 5.527752876281738
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.212 Vali Acc: 0.962 Test Loss: 0.212 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 12 cost time: 5.2659382820129395
Epoch: 12, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.18243670463562
Epoch: 13, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 5.581053972244263
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.272143363952637
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.2771217823028564
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 5.710460186004639
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 5.3390984535217285
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.365172624588013
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 5.738198757171631
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.355743408203125
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.499572277069092
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.545911550521851
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.328611373901367
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.6102354526519775
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.957 Test Loss: 0.097 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.304377794265747
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.320480108261108
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.494643449783325
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.962 Test Loss: 0.091 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.31830096244812
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 9385193
model size : 36.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.501789808273315
Epoch: 1, Steps: 17 | Train Loss: 2.147 Vali Loss: 2.066 Vali Acc: 0.241 Test Loss: 2.066 Test Acc: 0.241
Validation loss decreased (inf --> -0.240520).  Saving model ...
Epoch: 2 cost time: 3.5529229640960693
Epoch: 2, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.824 Vali Acc: 0.646 Test Loss: 1.824 Test Acc: 0.646
Validation loss decreased (-0.240520 --> -0.645928).  Saving model ...
Epoch: 3 cost time: 3.2565977573394775
Epoch: 3, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.525 Vali Acc: 0.846 Test Loss: 1.525 Test Acc: 0.846
Validation loss decreased (-0.645928 --> -0.845931).  Saving model ...
Epoch: 4 cost time: 3.496734380722046
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.222 Vali Acc: 0.884 Test Loss: 1.222 Test Acc: 0.884
Validation loss decreased (-0.845931 --> -0.883772).  Saving model ...
Epoch: 5 cost time: 3.6033077239990234
Epoch: 5, Steps: 17 | Train Loss: 1.045 Vali Loss: 0.939 Vali Acc: 0.924 Test Loss: 0.939 Test Acc: 0.924
Validation loss decreased (-0.883772 --> -0.924315).  Saving model ...
Epoch: 6 cost time: 3.2415804862976074
Epoch: 6, Steps: 17 | Train Loss: 0.790 Vali Loss: 0.729 Vali Acc: 0.935 Test Loss: 0.729 Test Acc: 0.935
Validation loss decreased (-0.924315 --> -0.935128).  Saving model ...
Epoch: 7 cost time: 3.324334144592285
Epoch: 7, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.568 Vali Acc: 0.949 Test Loss: 0.568 Test Acc: 0.949
Validation loss decreased (-0.935128 --> -0.948643).  Saving model ...
Epoch: 8 cost time: 3.4491312503814697
Epoch: 8, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.438 Vali Acc: 0.957 Test Loss: 0.438 Test Acc: 0.957
Validation loss decreased (-0.948643 --> -0.956752).  Saving model ...
Epoch: 9 cost time: 3.451759099960327
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.346 Vali Acc: 0.954 Test Loss: 0.346 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3257431983947754
Epoch: 10, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.277 Vali Acc: 0.965 Test Loss: 0.277 Test Acc: 0.965
Validation loss decreased (-0.956752 --> -0.964862).  Saving model ...
Epoch: 11 cost time: 3.261894464492798
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.223 Vali Acc: 0.962 Test Loss: 0.223 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5291335582733154
Epoch: 12, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.185 Vali Acc: 0.973 Test Loss: 0.185 Test Acc: 0.973
Validation loss decreased (-0.964862 --> -0.972971).  Saving model ...
Epoch: 13 cost time: 3.342219591140747
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3171019554138184
Epoch: 14, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972971).  Saving model ...
Epoch: 15 cost time: 3.301487684249878
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.461742639541626
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.215390205383301
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 3.1248700618743896
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.358994722366333
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4626805782318115
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 3.337118625640869
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2714273929595947
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3226940631866455
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.031933307647705
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.154240608215332
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3453617095947266
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 27 cost time: 3.1925716400146484
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.225074291229248
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 29 cost time: 3.3747825622558594
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1732044219970703
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2764777
model size : 11.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.387111186981201
Epoch: 1, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.101 Vali Acc: 0.168 Test Loss: 2.101 Test Acc: 0.168
Validation loss decreased (inf --> -0.167547).  Saving model ...
Epoch: 2 cost time: 7.424616098403931
Epoch: 2, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.909 Vali Acc: 0.432 Test Loss: 1.909 Test Acc: 0.432
Validation loss decreased (-0.167547 --> -0.432413).  Saving model ...
Epoch: 3 cost time: 7.227140188217163
Epoch: 3, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.639 Vali Acc: 0.727 Test Loss: 1.639 Test Acc: 0.727
Validation loss decreased (-0.432413 --> -0.727011).  Saving model ...
Epoch: 4 cost time: 7.9286322593688965
Epoch: 4, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.312 Vali Acc: 0.800 Test Loss: 1.312 Test Acc: 0.800
Validation loss decreased (-0.727011 --> -0.799987).  Saving model ...
Epoch: 5 cost time: 7.490048170089722
Epoch: 5, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.029 Vali Acc: 0.814 Test Loss: 1.029 Test Acc: 0.814
Validation loss decreased (-0.799987 --> -0.813503).  Saving model ...
Epoch: 6 cost time: 7.752096652984619
Epoch: 6, Steps: 17 | Train Loss: 0.828 Vali Loss: 0.777 Vali Acc: 0.878 Test Loss: 0.777 Test Acc: 0.878
Validation loss decreased (-0.813503 --> -0.878371).  Saving model ...
Epoch: 7 cost time: 7.6881139278411865
Epoch: 7, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.617 Vali Acc: 0.862 Test Loss: 0.617 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.417865514755249
Epoch: 8, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.451 Vali Acc: 0.938 Test Loss: 0.451 Test Acc: 0.938
Validation loss decreased (-0.878371 --> -0.937833).  Saving model ...
Epoch: 9 cost time: 8.020250082015991
Epoch: 9, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.362 Vali Acc: 0.951 Test Loss: 0.362 Test Acc: 0.951
Validation loss decreased (-0.937833 --> -0.951348).  Saving model ...
Epoch: 10 cost time: 7.776810169219971
Epoch: 10, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.84370231628418
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 7.9917473793029785
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 7.756808757781982
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 8.143827199935913
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.327 Vali Acc: 0.908 Test Loss: 0.327 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.768282890319824
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.859870195388794
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.553423166275024
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.545466661453247
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 7.675841569900513
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.208976984024048
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.302573919296265
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.518052339553833
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.105629920959473
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.516608476638794
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.255154132843018
Epoch: 25, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.26560640335083
Epoch: 26, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.615409851074219
Epoch: 27, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.541332483291626
Epoch: 28, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4697833
model size : 18.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.948651552200317
Epoch: 1, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.051 Vali Acc: 0.362 Test Loss: 2.051 Test Acc: 0.362
Validation loss decreased (inf --> -0.362142).  Saving model ...
Epoch: 2 cost time: 5.202582597732544
Epoch: 2, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.808 Vali Acc: 0.692 Test Loss: 1.808 Test Acc: 0.692
Validation loss decreased (-0.362142 --> -0.691874).  Saving model ...
Epoch: 3 cost time: 5.042749643325806
Epoch: 3, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.492 Vali Acc: 0.854 Test Loss: 1.492 Test Acc: 0.854
Validation loss decreased (-0.691874 --> -0.854039).  Saving model ...
Epoch: 4 cost time: 5.279085397720337
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.181 Vali Acc: 0.903 Test Loss: 1.181 Test Acc: 0.903
Validation loss decreased (-0.854039 --> -0.902691).  Saving model ...
Epoch: 5 cost time: 5.06828498840332
Epoch: 5, Steps: 17 | Train Loss: 1.051 Vali Loss: 0.905 Vali Acc: 0.900 Test Loss: 0.905 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.04071307182312
Epoch: 6, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.694 Vali Acc: 0.943 Test Loss: 0.694 Test Acc: 0.943
Validation loss decreased (-0.902691 --> -0.943236).  Saving model ...
Epoch: 7 cost time: 4.824220418930054
Epoch: 7, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.519 Vali Acc: 0.954 Test Loss: 0.519 Test Acc: 0.954
Validation loss decreased (-0.943236 --> -0.954049).  Saving model ...
Epoch: 8 cost time: 4.780472993850708
Epoch: 8, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.397 Vali Acc: 0.957 Test Loss: 0.397 Test Acc: 0.957
Validation loss decreased (-0.954049 --> -0.956753).  Saving model ...
Epoch: 9 cost time: 4.9056432247161865
Epoch: 9, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.310 Vali Acc: 0.951 Test Loss: 0.310 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.817788124084473
Epoch: 10, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.250 Vali Acc: 0.957 Test Loss: 0.250 Test Acc: 0.957
Validation loss decreased (-0.956753 --> -0.956754).  Saving model ...
Epoch: 11 cost time: 5.170135498046875
Epoch: 11, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 4.7711381912231445
Epoch: 12, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 4.682448148727417
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 4.446069955825806
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.7704174518585205
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 4.753594636917114
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.705288410186768
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.544821739196777
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.907383918762207
Epoch: 19, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.700268983840942
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.904012441635132
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 4.671583652496338
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 4.97596549987793
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 4.655834197998047
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.95943546295166
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.62255072593689
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 5.042901515960693
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.796649694442749
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.969526052474976
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.621722221374512
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1387497
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.486592531204224
Epoch: 1, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.102 Vali Acc: 0.170 Test Loss: 2.102 Test Acc: 0.170
Validation loss decreased (inf --> -0.170249).  Saving model ...
Epoch: 2 cost time: 5.529598236083984
Epoch: 2, Steps: 17 | Train Loss: 2.036 Vali Loss: 1.912 Vali Acc: 0.432 Test Loss: 1.912 Test Acc: 0.432
Validation loss decreased (-0.170249 --> -0.432413).  Saving model ...
Epoch: 3 cost time: 5.625215768814087
Epoch: 3, Steps: 17 | Train Loss: 1.794 Vali Loss: 1.644 Vali Acc: 0.732 Test Loss: 1.644 Test Acc: 0.732
Validation loss decreased (-0.432413 --> -0.732416).  Saving model ...
Epoch: 4 cost time: 5.610188722610474
Epoch: 4, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.317 Vali Acc: 0.800 Test Loss: 1.317 Test Acc: 0.800
Validation loss decreased (-0.732416 --> -0.799987).  Saving model ...
Epoch: 5 cost time: 5.817669630050659
Epoch: 5, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.039 Vali Acc: 0.816 Test Loss: 1.039 Test Acc: 0.816
Validation loss decreased (-0.799987 --> -0.816206).  Saving model ...
Epoch: 6 cost time: 5.6011152267456055
Epoch: 6, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.780 Vali Acc: 0.873 Test Loss: 0.780 Test Acc: 0.873
Validation loss decreased (-0.816206 --> -0.872965).  Saving model ...
Epoch: 7 cost time: 5.882000684738159
Epoch: 7, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.621 Vali Acc: 0.876 Test Loss: 0.621 Test Acc: 0.876
Validation loss decreased (-0.872965 --> -0.875669).  Saving model ...
Epoch: 8 cost time: 5.5473198890686035
Epoch: 8, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.462 Vali Acc: 0.938 Test Loss: 0.462 Test Acc: 0.938
Validation loss decreased (-0.875669 --> -0.937833).  Saving model ...
Epoch: 9 cost time: 5.78505277633667
Epoch: 9, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.372 Vali Acc: 0.941 Test Loss: 0.372 Test Acc: 0.941
Validation loss decreased (-0.937833 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 5.864529848098755
Epoch: 10, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.311 Vali Acc: 0.946 Test Loss: 0.311 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 5.872746467590332
Epoch: 11, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 12 cost time: 6.168458461761475
Epoch: 12, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
Validation loss decreased (-0.945943 --> -0.964863).  Saving model ...
Epoch: 13 cost time: 5.8008880615234375
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 5.928223371505737
Epoch: 14, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.781145095825195
Epoch: 15, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.9963366985321045
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 5.794695854187012
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 5.496357679367065
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 5.713677406311035
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 5.752772331237793
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 5.586888790130615
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.822229385375977
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 5.6266655921936035
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 24 cost time: 5.522146224975586
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.676170587539673
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.595027923583984
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 5.8016157150268555
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.907411336898804
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.956382513046265
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.095328092575073
Epoch: 30, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 4697833
model size : 18.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.57902455329895
Epoch: 1, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.051 Vali Acc: 0.359 Test Loss: 2.051 Test Acc: 0.359
Validation loss decreased (inf --> -0.359439).  Saving model ...
Epoch: 2 cost time: 3.752572774887085
Epoch: 2, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.809 Vali Acc: 0.689 Test Loss: 1.809 Test Acc: 0.689
Validation loss decreased (-0.359439 --> -0.689171).  Saving model ...
Epoch: 3 cost time: 3.819162368774414
Epoch: 3, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.491 Vali Acc: 0.854 Test Loss: 1.491 Test Acc: 0.854
Validation loss decreased (-0.689171 --> -0.854039).  Saving model ...
Epoch: 4 cost time: 3.8452022075653076
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.181 Vali Acc: 0.895 Test Loss: 1.181 Test Acc: 0.895
Validation loss decreased (-0.854039 --> -0.894583).  Saving model ...
Epoch: 5 cost time: 3.781921625137329
Epoch: 5, Steps: 17 | Train Loss: 1.051 Vali Loss: 0.906 Vali Acc: 0.900 Test Loss: 0.906 Test Acc: 0.900
Validation loss decreased (-0.894583 --> -0.899991).  Saving model ...
Epoch: 6 cost time: 3.8197944164276123
Epoch: 6, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.696 Vali Acc: 0.943 Test Loss: 0.696 Test Acc: 0.943
Validation loss decreased (-0.899991 --> -0.943236).  Saving model ...
Epoch: 7 cost time: 4.1897876262664795
Epoch: 7, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.522 Vali Acc: 0.949 Test Loss: 0.522 Test Acc: 0.949
Validation loss decreased (-0.943236 --> -0.948643).  Saving model ...
Epoch: 8 cost time: 3.712076425552368
Epoch: 8, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.399 Vali Acc: 0.954 Test Loss: 0.399 Test Acc: 0.954
Validation loss decreased (-0.948643 --> -0.954050).  Saving model ...
Epoch: 9 cost time: 3.835913896560669
Epoch: 9, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.313 Vali Acc: 0.951 Test Loss: 0.313 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7818241119384766
Epoch: 10, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
Validation loss decreased (-0.954050 --> -0.956754).  Saving model ...
Epoch: 11 cost time: 3.7838053703308105
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 3.52235746383667
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 3.507383108139038
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 3.673366069793701
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7688703536987305
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 3.699343204498291
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.432544708251953
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.762209892272949
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4890871047973633
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.781602382659912
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.597189426422119
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 3.663975238800049
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5907557010650635
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 3.704186201095581
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 3.8111021518707275
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8053767681121826
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 27 cost time: 3.6315653324127197
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.164332628250122
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.225926637649536
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.88265323638916
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1387497
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.31501317024231
Epoch: 1, Steps: 17 | Train Loss: 2.200 Vali Loss: 2.105 Vali Acc: 0.159 Test Loss: 2.105 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 4.378131151199341
Epoch: 2, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.924 Vali Acc: 0.395 Test Loss: 1.924 Test Acc: 0.395
Validation loss decreased (-0.159438 --> -0.394575).  Saving model ...
Epoch: 3 cost time: 4.264246225357056
Epoch: 3, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.690 Vali Acc: 0.686 Test Loss: 1.690 Test Acc: 0.686
Validation loss decreased (-0.394575 --> -0.686470).  Saving model ...
Epoch: 4 cost time: 4.423543930053711
Epoch: 4, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.410 Vali Acc: 0.786 Test Loss: 1.410 Test Acc: 0.786
Validation loss decreased (-0.686470 --> -0.786472).  Saving model ...
Epoch: 5 cost time: 4.493685960769653
Epoch: 5, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.129 Vali Acc: 0.827 Test Loss: 1.129 Test Acc: 0.827
Validation loss decreased (-0.786472 --> -0.827016).  Saving model ...
Epoch: 6 cost time: 4.4067206382751465
Epoch: 6, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.885 Vali Acc: 0.851 Test Loss: 0.885 Test Acc: 0.851
Validation loss decreased (-0.827016 --> -0.851342).  Saving model ...
Epoch: 7 cost time: 4.248077154159546
Epoch: 7, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.689 Vali Acc: 0.878 Test Loss: 0.689 Test Acc: 0.878
Validation loss decreased (-0.851342 --> -0.878371).  Saving model ...
Epoch: 8 cost time: 4.45764422416687
Epoch: 8, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.529 Vali Acc: 0.930 Test Loss: 0.529 Test Acc: 0.930
Validation loss decreased (-0.878371 --> -0.929724).  Saving model ...
Epoch: 9 cost time: 4.495373010635376
Epoch: 9, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.418 Vali Acc: 0.941 Test Loss: 0.418 Test Acc: 0.941
Validation loss decreased (-0.929724 --> -0.940536).  Saving model ...
Epoch: 10 cost time: 4.440455436706543
Epoch: 10, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.341 Vali Acc: 0.949 Test Loss: 0.341 Test Acc: 0.949
Validation loss decreased (-0.940536 --> -0.948645).  Saving model ...
Epoch: 11 cost time: 4.424479722976685
Epoch: 11, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.6001296043396
Epoch: 12, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.241 Vali Acc: 0.951 Test Loss: 0.241 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 4.625961065292358
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 4.294921636581421
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.516735792160034
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.577907085418701
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.499533176422119
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.305469036102295
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 4.775439500808716
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.54956316947937
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 4.409518480300903
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.2860002517700195
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.784789323806763
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 4.702229261398315
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.4519476890563965
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.554044961929321
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.672426462173462
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.518696546554565
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.13209342956543
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.479595899581909
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 4697833
model size : 18.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.707695484161377
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 2.056 Vali Acc: 0.354 Test Loss: 2.056 Test Acc: 0.354
Validation loss decreased (inf --> -0.354033).  Saving model ...
Epoch: 2 cost time: 3.0352933406829834
Epoch: 2, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.829 Vali Acc: 0.686 Test Loss: 1.829 Test Acc: 0.686
Validation loss decreased (-0.354033 --> -0.686468).  Saving model ...
Epoch: 3 cost time: 3.2094457149505615
Epoch: 3, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.548 Vali Acc: 0.854 Test Loss: 1.548 Test Acc: 0.854
Validation loss decreased (-0.686468 --> -0.854039).  Saving model ...
Epoch: 4 cost time: 3.2694547176361084
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.265 Vali Acc: 0.905 Test Loss: 1.265 Test Acc: 0.905
Validation loss decreased (-0.854039 --> -0.905393).  Saving model ...
Epoch: 5 cost time: 3.0730578899383545
Epoch: 5, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.007 Vali Acc: 0.911 Test Loss: 1.007 Test Acc: 0.911
Validation loss decreased (-0.905393 --> -0.910801).  Saving model ...
Epoch: 6 cost time: 2.9164047241210938
Epoch: 6, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.800 Vali Acc: 0.924 Test Loss: 0.800 Test Acc: 0.924
Validation loss decreased (-0.910801 --> -0.924316).  Saving model ...
Epoch: 7 cost time: 3.1211376190185547
Epoch: 7, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.613 Vali Acc: 0.954 Test Loss: 0.613 Test Acc: 0.954
Validation loss decreased (-0.924316 --> -0.954048).  Saving model ...
Epoch: 8 cost time: 3.2063093185424805
Epoch: 8, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.474 Vali Acc: 0.951 Test Loss: 0.474 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.195610523223877
Epoch: 9, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.378 Vali Acc: 0.954 Test Loss: 0.378 Test Acc: 0.954
Validation loss decreased (-0.954048 --> -0.954050).  Saving model ...
Epoch: 10 cost time: 3.080592632293701
Epoch: 10, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.288 Vali Acc: 0.957 Test Loss: 0.288 Test Acc: 0.957
Validation loss decreased (-0.954050 --> -0.956754).  Saving model ...
Epoch: 11 cost time: 3.064145088195801
Epoch: 11, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 12 cost time: 3.0808968544006348
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.209 Vali Acc: 0.965 Test Loss: 0.209 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 13 cost time: 3.289043426513672
Epoch: 13, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970268).  Saving model ...
Epoch: 14 cost time: 3.0868849754333496
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0061299800872803
Epoch: 15, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975674).  Saving model ...
Epoch: 16 cost time: 3.0097081661224365
Epoch: 16, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4007928371429443
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.335181713104248
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0848474502563477
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.258713483810425
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.126819133758545
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.521463394165039
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.421931743621826
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.3339622020721436
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.2701480388641357
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1387497
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 18.07903218269348
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.149 Vali Acc: 0.111 Test Loss: 2.149 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 16.281482219696045
Epoch: 2, Steps: 17 | Train Loss: 2.037 Vali Loss: 1.948 Vali Acc: 0.341 Test Loss: 1.948 Test Acc: 0.341
Validation loss decreased (-0.110789 --> -0.340521).  Saving model ...
Epoch: 3 cost time: 15.823264122009277
Epoch: 3, Steps: 17 | Train Loss: 1.775 Vali Loss: 1.667 Vali Acc: 0.686 Test Loss: 1.667 Test Acc: 0.686
Validation loss decreased (-0.340521 --> -0.686470).  Saving model ...
Epoch: 4 cost time: 16.573510885238647
Epoch: 4, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.336 Vali Acc: 0.824 Test Loss: 1.336 Test Acc: 0.824
Validation loss decreased (-0.686470 --> -0.824311).  Saving model ...
Epoch: 5 cost time: 15.698867321014404
Epoch: 5, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.038 Vali Acc: 0.878 Test Loss: 1.038 Test Acc: 0.878
Validation loss decreased (-0.824311 --> -0.878368).  Saving model ...
Epoch: 6 cost time: 16.75592851638794
Epoch: 6, Steps: 17 | Train Loss: 0.909 Vali Loss: 0.801 Vali Acc: 0.895 Test Loss: 0.801 Test Acc: 0.895
Validation loss decreased (-0.878368 --> -0.894587).  Saving model ...
Epoch: 7 cost time: 15.320751428604126
Epoch: 7, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.623 Vali Acc: 0.911 Test Loss: 0.623 Test Acc: 0.911
Validation loss decreased (-0.894587 --> -0.910805).  Saving model ...
Epoch: 8 cost time: 16.27573251724243
Epoch: 8, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.486 Vali Acc: 0.916 Test Loss: 0.486 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 9 cost time: 15.431104898452759
Epoch: 9, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.386 Vali Acc: 0.935 Test Loss: 0.386 Test Acc: 0.935
Validation loss decreased (-0.916211 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 16.104652404785156
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.340 Vali Acc: 0.938 Test Loss: 0.340 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 11 cost time: 15.838913440704346
Epoch: 11, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.286 Vali Acc: 0.949 Test Loss: 0.286 Test Acc: 0.949
Validation loss decreased (-0.937834 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 15.649923324584961
Epoch: 12, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.506937503814697
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.238 Vali Acc: 0.946 Test Loss: 0.238 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.540894031524658
Epoch: 14, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.202 Vali Acc: 0.962 Test Loss: 0.202 Test Acc: 0.962
Validation loss decreased (-0.948646 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 15.527742147445679
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.018218994140625
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.860620975494385
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.951547384262085
Epoch: 18, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.317 Vali Acc: 0.908 Test Loss: 0.317 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 14.322346687316895
Epoch: 19, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.366252183914185
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.250 Vali Acc: 0.924 Test Loss: 0.250 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 14.761276245117188
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.93004035949707
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 15.338039636611938
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 15.17006516456604
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 15.47413158416748
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 15.307038307189941
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 14.653373956680298
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 14.681827068328857
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 15.71151351928711
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 15.673268795013428
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 2354153
model size : 9.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.365463495254517
Epoch: 1, Steps: 17 | Train Loss: 2.215 Vali Loss: 2.183 Vali Acc: 0.114 Test Loss: 2.183 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 9.07008171081543
Epoch: 2, Steps: 17 | Train Loss: 2.074 Vali Loss: 1.981 Vali Acc: 0.308 Test Loss: 1.981 Test Acc: 0.308
Validation loss decreased (-0.113492 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 9.46013879776001
Epoch: 3, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.719 Vali Acc: 0.697 Test Loss: 1.719 Test Acc: 0.697
Validation loss decreased (-0.308088 --> -0.697280).  Saving model ...
Epoch: 4 cost time: 9.072295427322388
Epoch: 4, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.422 Vali Acc: 0.849 Test Loss: 1.422 Test Acc: 0.849
Validation loss decreased (-0.697280 --> -0.848634).  Saving model ...
Epoch: 5 cost time: 9.242390155792236
Epoch: 5, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.128 Vali Acc: 0.868 Test Loss: 1.128 Test Acc: 0.868
Validation loss decreased (-0.848634 --> -0.867556).  Saving model ...
Epoch: 6 cost time: 9.320148468017578
Epoch: 6, Steps: 17 | Train Loss: 0.974 Vali Loss: 0.867 Vali Acc: 0.900 Test Loss: 0.867 Test Acc: 0.900
Validation loss decreased (-0.867556 --> -0.899991).  Saving model ...
Epoch: 7 cost time: 9.12356185913086
Epoch: 7, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.671 Vali Acc: 0.905 Test Loss: 0.671 Test Acc: 0.905
Validation loss decreased (-0.899991 --> -0.905399).  Saving model ...
Epoch: 8 cost time: 9.555971384048462
Epoch: 8, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.510 Vali Acc: 0.924 Test Loss: 0.510 Test Acc: 0.924
Validation loss decreased (-0.905399 --> -0.924319).  Saving model ...
Epoch: 9 cost time: 8.645605564117432
Epoch: 9, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.411 Vali Acc: 0.932 Test Loss: 0.411 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 9.833667516708374
Epoch: 10, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.315 Vali Acc: 0.946 Test Loss: 0.315 Test Acc: 0.946
Validation loss decreased (-0.932428 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 9.215757369995117
Epoch: 11, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.250 Vali Acc: 0.959 Test Loss: 0.250 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 12 cost time: 9.678781509399414
Epoch: 12, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.298407554626465
Epoch: 13, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 9.424383401870728
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.326070785522461
Epoch: 15, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 8.814613819122314
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 9.26175856590271
Epoch: 17, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.706903457641602
Epoch: 18, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.30724310874939
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 8.531716346740723
Epoch: 20, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.884941339492798
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 8.524023532867432
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 8.306459426879883
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 9.061019897460938
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.731230020523071
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 9.366764068603516
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.748360633850098
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 9.414363861083984
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.829671144485474
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 9.149882555007935
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 698857
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.628512859344482
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.149 Vali Acc: 0.111 Test Loss: 2.149 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 10.79940414428711
Epoch: 2, Steps: 17 | Train Loss: 2.037 Vali Loss: 1.950 Vali Acc: 0.341 Test Loss: 1.950 Test Acc: 0.341
Validation loss decreased (-0.110789 --> -0.340521).  Saving model ...
Epoch: 3 cost time: 10.39964747428894
Epoch: 3, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.671 Vali Acc: 0.681 Test Loss: 1.671 Test Acc: 0.681
Validation loss decreased (-0.340521 --> -0.681064).  Saving model ...
Epoch: 4 cost time: 10.508849620819092
Epoch: 4, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.338 Vali Acc: 0.824 Test Loss: 1.338 Test Acc: 0.824
Validation loss decreased (-0.681064 --> -0.824311).  Saving model ...
Epoch: 5 cost time: 10.486234903335571
Epoch: 5, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.039 Vali Acc: 0.878 Test Loss: 1.039 Test Acc: 0.878
Validation loss decreased (-0.824311 --> -0.878368).  Saving model ...
Epoch: 6 cost time: 10.804174661636353
Epoch: 6, Steps: 17 | Train Loss: 0.912 Vali Loss: 0.805 Vali Acc: 0.895 Test Loss: 0.805 Test Acc: 0.895
Validation loss decreased (-0.878368 --> -0.894587).  Saving model ...
Epoch: 7 cost time: 10.815105199813843
Epoch: 7, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.625 Vali Acc: 0.914 Test Loss: 0.625 Test Acc: 0.914
Validation loss decreased (-0.894587 --> -0.913507).  Saving model ...
Epoch: 8 cost time: 11.007962942123413
Epoch: 8, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.491 Vali Acc: 0.916 Test Loss: 0.491 Test Acc: 0.916
Validation loss decreased (-0.913507 --> -0.916211).  Saving model ...
Epoch: 9 cost time: 10.863686323165894
Epoch: 9, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.389 Vali Acc: 0.935 Test Loss: 0.389 Test Acc: 0.935
Validation loss decreased (-0.916211 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 10.89121150970459
Epoch: 10, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 11 cost time: 11.049475193023682
Epoch: 11, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.282 Vali Acc: 0.949 Test Loss: 0.282 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 10.884624481201172
Epoch: 12, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 13 cost time: 11.198521375656128
Epoch: 13, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.758749723434448
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
Validation loss decreased (-0.948646 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 10.82368779182434
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.580885171890259
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.198 Vali Acc: 0.954 Test Loss: 0.198 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.200132131576538
Epoch: 17, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.565640449523926
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.627769708633423
Epoch: 19, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.982475757598877
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.605988264083862
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.90267825126648
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.66823959350586
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.00389313697815
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 2354153
model size : 9.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.34422492980957
Epoch: 1, Steps: 17 | Train Loss: 2.215 Vali Loss: 2.183 Vali Acc: 0.114 Test Loss: 2.183 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 7.348241329193115
Epoch: 2, Steps: 17 | Train Loss: 2.074 Vali Loss: 1.981 Vali Acc: 0.308 Test Loss: 1.981 Test Acc: 0.308
Validation loss decreased (-0.113492 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 6.846529722213745
Epoch: 3, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.719 Vali Acc: 0.697 Test Loss: 1.719 Test Acc: 0.697
Validation loss decreased (-0.308088 --> -0.697280).  Saving model ...
Epoch: 4 cost time: 6.9516282081604
Epoch: 4, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.421 Vali Acc: 0.849 Test Loss: 1.421 Test Acc: 0.849
Validation loss decreased (-0.697280 --> -0.848634).  Saving model ...
Epoch: 5 cost time: 7.304140567779541
Epoch: 5, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.128 Vali Acc: 0.865 Test Loss: 1.128 Test Acc: 0.865
Validation loss decreased (-0.848634 --> -0.864854).  Saving model ...
Epoch: 6 cost time: 6.5463547706604
Epoch: 6, Steps: 17 | Train Loss: 0.975 Vali Loss: 0.869 Vali Acc: 0.900 Test Loss: 0.869 Test Acc: 0.900
Validation loss decreased (-0.864854 --> -0.899991).  Saving model ...
Epoch: 7 cost time: 6.974583625793457
Epoch: 7, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.672 Vali Acc: 0.905 Test Loss: 0.672 Test Acc: 0.905
Validation loss decreased (-0.899991 --> -0.905399).  Saving model ...
Epoch: 8 cost time: 6.3100104331970215
Epoch: 8, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.511 Vali Acc: 0.924 Test Loss: 0.511 Test Acc: 0.924
Validation loss decreased (-0.905399 --> -0.924319).  Saving model ...
Epoch: 9 cost time: 6.538592100143433
Epoch: 9, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.413 Vali Acc: 0.932 Test Loss: 0.413 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 6.095876216888428
Epoch: 10, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.315 Vali Acc: 0.951 Test Loss: 0.315 Test Acc: 0.951
Validation loss decreased (-0.932428 --> -0.951348).  Saving model ...
Epoch: 11 cost time: 6.563209772109985
Epoch: 11, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.251 Vali Acc: 0.959 Test Loss: 0.251 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959457).  Saving model ...
Epoch: 12 cost time: 6.391590595245361
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.372653484344482
Epoch: 13, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 6.318331003189087
Epoch: 14, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.214 Vali Acc: 0.932 Test Loss: 0.214 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.4453184604644775
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 6.2250940799713135
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 6.625993967056274
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.250052213668823
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 6.420330047607422
Epoch: 19, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 5.9011454582214355
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.241126775741577
Epoch: 21, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.163437128067017
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.092146396636963
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.302474737167358
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.192331314086914
Epoch: 25, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.2810304164886475
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.033198356628418
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.509929180145264
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 6.3326256275177
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.601968765258789
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 698857
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.783634185791016
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.154 Vali Acc: 0.111 Test Loss: 2.154 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 5.905258417129517
Epoch: 2, Steps: 17 | Train Loss: 2.045 Vali Loss: 1.965 Vali Acc: 0.324 Test Loss: 1.965 Test Acc: 0.324
Validation loss decreased (-0.110789 --> -0.324305).  Saving model ...
Epoch: 3 cost time: 6.227044343948364
Epoch: 3, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.717 Vali Acc: 0.578 Test Loss: 1.717 Test Acc: 0.578
Validation loss decreased (-0.324305 --> -0.578361).  Saving model ...
Epoch: 4 cost time: 5.624024152755737
Epoch: 4, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.446 Vali Acc: 0.795 Test Loss: 1.446 Test Acc: 0.795
Validation loss decreased (-0.578361 --> -0.794580).  Saving model ...
Epoch: 5 cost time: 5.762744188308716
Epoch: 5, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.167 Vali Acc: 0.889 Test Loss: 1.167 Test Acc: 0.889
Validation loss decreased (-0.794580 --> -0.889178).  Saving model ...
Epoch: 6 cost time: 5.608760356903076
Epoch: 6, Steps: 17 | Train Loss: 1.006 Vali Loss: 0.941 Vali Acc: 0.897 Test Loss: 0.941 Test Acc: 0.897
Validation loss decreased (-0.889178 --> -0.897288).  Saving model ...
Epoch: 7 cost time: 5.467929124832153
Epoch: 7, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.749 Vali Acc: 0.908 Test Loss: 0.749 Test Acc: 0.908
Validation loss decreased (-0.897288 --> -0.908101).  Saving model ...
Epoch: 8 cost time: 5.787536144256592
Epoch: 8, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.586 Vali Acc: 0.938 Test Loss: 0.586 Test Acc: 0.938
Validation loss decreased (-0.908101 --> -0.937832).  Saving model ...
Epoch: 9 cost time: 5.6392035484313965
Epoch: 9, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.469 Vali Acc: 0.941 Test Loss: 0.469 Test Acc: 0.941
Validation loss decreased (-0.937832 --> -0.940536).  Saving model ...
Epoch: 10 cost time: 6.017690658569336
Epoch: 10, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.381 Vali Acc: 0.946 Test Loss: 0.381 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 11 cost time: 5.636120319366455
Epoch: 11, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.306 Vali Acc: 0.951 Test Loss: 0.306 Test Acc: 0.951
Validation loss decreased (-0.945942 --> -0.951348).  Saving model ...
Epoch: 12 cost time: 5.7700135707855225
Epoch: 12, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.263 Vali Acc: 0.957 Test Loss: 0.263 Test Acc: 0.957
Validation loss decreased (-0.951348 --> -0.956754).  Saving model ...
Epoch: 13 cost time: 5.79565691947937
Epoch: 13, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 14 cost time: 5.652758836746216
Epoch: 14, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.215 Vali Acc: 0.954 Test Loss: 0.215 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.942458152770996
Epoch: 15, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 16 cost time: 6.0653603076934814
Epoch: 16, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.239388942718506
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.968561410903931
Epoch: 18, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.173938751220703
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.149095773696899
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.986661195755005
Epoch: 21, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.30339503288269
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 23 cost time: 5.936639308929443
Epoch: 23, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.171298980712891
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.015626907348633
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 26 cost time: 5.943394184112549
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.713452339172363
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.8436596393585205
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.183809041976929
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.761005401611328
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 2354153
model size : 9.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.564958572387695
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.187 Vali Acc: 0.108 Test Loss: 2.187 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 4.202851295471191
Epoch: 2, Steps: 17 | Train Loss: 2.081 Vali Loss: 1.997 Vali Acc: 0.284 Test Loss: 1.997 Test Acc: 0.284
Validation loss decreased (-0.108086 --> -0.283764).  Saving model ...
Epoch: 3 cost time: 3.888331413269043
Epoch: 3, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.760 Vali Acc: 0.643 Test Loss: 1.760 Test Acc: 0.643
Validation loss decreased (-0.283764 --> -0.643226).  Saving model ...
Epoch: 4 cost time: 3.9687681198120117
Epoch: 4, Steps: 17 | Train Loss: 1.597 Vali Loss: 1.502 Vali Acc: 0.808 Test Loss: 1.502 Test Acc: 0.808
Validation loss decreased (-0.643226 --> -0.808093).  Saving model ...
Epoch: 5 cost time: 4.035441160202026
Epoch: 5, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.232 Vali Acc: 0.857 Test Loss: 1.232 Test Acc: 0.857
Validation loss decreased (-0.808093 --> -0.856744).  Saving model ...
Epoch: 6 cost time: 3.9623165130615234
Epoch: 6, Steps: 17 | Train Loss: 1.053 Vali Loss: 0.980 Vali Acc: 0.876 Test Loss: 0.980 Test Acc: 0.876
Validation loss decreased (-0.856744 --> -0.875666).  Saving model ...
Epoch: 7 cost time: 3.957070827484131
Epoch: 7, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.779 Vali Acc: 0.895 Test Loss: 0.779 Test Acc: 0.895
Validation loss decreased (-0.875666 --> -0.894587).  Saving model ...
Epoch: 8 cost time: 3.976555824279785
Epoch: 8, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.627 Vali Acc: 0.911 Test Loss: 0.627 Test Acc: 0.911
Validation loss decreased (-0.894587 --> -0.910805).  Saving model ...
Epoch: 9 cost time: 3.892829179763794
Epoch: 9, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.506 Vali Acc: 0.932 Test Loss: 0.506 Test Acc: 0.932
Validation loss decreased (-0.910805 --> -0.932427).  Saving model ...
Epoch: 10 cost time: 4.094440937042236
Epoch: 10, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.408 Vali Acc: 0.943 Test Loss: 0.408 Test Acc: 0.943
Validation loss decreased (-0.932427 --> -0.943239).  Saving model ...
Epoch: 11 cost time: 3.8839786052703857
Epoch: 11, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.335 Vali Acc: 0.943 Test Loss: 0.335 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943240).  Saving model ...
Epoch: 12 cost time: 4.059128999710083
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.288 Vali Acc: 0.951 Test Loss: 0.288 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951348).  Saving model ...
Epoch: 13 cost time: 3.9357991218566895
Epoch: 13, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959457).  Saving model ...
Epoch: 14 cost time: 3.923884630203247
Epoch: 14, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.213 Vali Acc: 0.954 Test Loss: 0.213 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.055764198303223
Epoch: 15, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 16 cost time: 3.8722357749938965
Epoch: 16, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 3.9917874336242676
Epoch: 17, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975674).  Saving model ...
Epoch: 18 cost time: 4.019565582275391
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9731991291046143
Epoch: 19, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.1586689949035645
Epoch: 20, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.98102068901062
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.938713788986206
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 4.050718784332275
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.965639352798462
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 3.888244867324829
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 26 cost time: 3.6562507152557373
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.8323960304260254
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.990565299987793
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.8920938968658447
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 30 cost time: 3.964367151260376
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 698857
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.54534649848938
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.085 Vali Acc: 0.227 Test Loss: 2.085 Test Acc: 0.227
Validation loss decreased (inf --> -0.227006).  Saving model ...
Epoch: 2 cost time: 5.183032751083374
Epoch: 2, Steps: 17 | Train Loss: 2.064 Vali Loss: 1.970 Vali Acc: 0.384 Test Loss: 1.970 Test Acc: 0.384
Validation loss decreased (-0.227006 --> -0.383764).  Saving model ...
Epoch: 3 cost time: 5.492527008056641
Epoch: 3, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.819 Vali Acc: 0.595 Test Loss: 1.819 Test Acc: 0.595
Validation loss decreased (-0.383764 --> -0.594576).  Saving model ...
Epoch: 4 cost time: 5.351741313934326
Epoch: 4, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.642 Vali Acc: 0.689 Test Loss: 1.642 Test Acc: 0.689
Validation loss decreased (-0.594576 --> -0.689173).  Saving model ...
Epoch: 5 cost time: 5.4419543743133545
Epoch: 5, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.450 Vali Acc: 0.730 Test Loss: 1.450 Test Acc: 0.730
Validation loss decreased (-0.689173 --> -0.729715).  Saving model ...
Epoch: 6 cost time: 5.558326482772827
Epoch: 6, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.258 Vali Acc: 0.800 Test Loss: 1.258 Test Acc: 0.800
Validation loss decreased (-0.729715 --> -0.799987).  Saving model ...
Epoch: 7 cost time: 5.6485583782196045
Epoch: 7, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.081 Vali Acc: 0.805 Test Loss: 1.081 Test Acc: 0.805
Validation loss decreased (-0.799987 --> -0.805395).  Saving model ...
Epoch: 8 cost time: 5.598245620727539
Epoch: 8, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.927 Vali Acc: 0.862 Test Loss: 0.927 Test Acc: 0.862
Validation loss decreased (-0.805395 --> -0.862153).  Saving model ...
Epoch: 9 cost time: 5.612122535705566
Epoch: 9, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.788 Vali Acc: 0.889 Test Loss: 0.788 Test Acc: 0.889
Validation loss decreased (-0.862153 --> -0.889181).  Saving model ...
Epoch: 10 cost time: 5.8015992641448975
Epoch: 10, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.688 Vali Acc: 0.876 Test Loss: 0.688 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.5518903732299805
Epoch: 11, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.627 Vali Acc: 0.884 Test Loss: 0.627 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.811523199081421
Epoch: 12, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.525 Vali Acc: 0.916 Test Loss: 0.525 Test Acc: 0.916
Validation loss decreased (-0.889181 --> -0.916211).  Saving model ...
Epoch: 13 cost time: 5.538541793823242
Epoch: 13, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.440 Vali Acc: 0.927 Test Loss: 0.440 Test Acc: 0.927
Validation loss decreased (-0.916211 --> -0.927023).  Saving model ...
Epoch: 14 cost time: 5.823474645614624
Epoch: 14, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.492 Vali Acc: 0.865 Test Loss: 0.492 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.462635517120361
Epoch: 15, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.379 Vali Acc: 0.922 Test Loss: 0.379 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.833605051040649
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.305 Vali Acc: 0.943 Test Loss: 0.305 Test Acc: 0.943
Validation loss decreased (-0.927023 --> -0.943240).  Saving model ...
Epoch: 17 cost time: 6.915037155151367
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.817867279052734
Epoch: 18, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.943240 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 6.7130725383758545
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.517598390579224
Epoch: 20, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 21 cost time: 6.914131164550781
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.183 Vali Acc: 0.968 Test Loss: 0.183 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 6.508279323577881
Epoch: 22, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.994355201721191
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.907231330871582
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.107637882232666
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 6.618163824081421
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.1373114585876465
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.6592347621917725
Epoch: 28, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.103375196456909
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.64542818069458
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2349689
model size : 9.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.282192230224609
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.114 Vali Acc: 0.195 Test Loss: 2.114 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 4.268243789672852
Epoch: 2, Steps: 17 | Train Loss: 2.090 Vali Loss: 2.009 Vali Acc: 0.351 Test Loss: 2.009 Test Acc: 0.351
Validation loss decreased (-0.194573 --> -0.351331).  Saving model ...
Epoch: 3 cost time: 5.597095251083374
Epoch: 3, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.875 Vali Acc: 0.549 Test Loss: 1.875 Test Acc: 0.549
Validation loss decreased (-0.351331 --> -0.548630).  Saving model ...
Epoch: 4 cost time: 5.1501548290252686
Epoch: 4, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.716 Vali Acc: 0.697 Test Loss: 1.716 Test Acc: 0.697
Validation loss decreased (-0.548630 --> -0.697280).  Saving model ...
Epoch: 5 cost time: 5.520241737365723
Epoch: 5, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.536 Vali Acc: 0.773 Test Loss: 1.536 Test Acc: 0.773
Validation loss decreased (-0.697280 --> -0.772958).  Saving model ...
Epoch: 6 cost time: 5.3397300243377686
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.356 Vali Acc: 0.797 Test Loss: 1.356 Test Acc: 0.797
Validation loss decreased (-0.772958 --> -0.797284).  Saving model ...
Epoch: 7 cost time: 4.903308153152466
Epoch: 7, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.187 Vali Acc: 0.830 Test Loss: 1.187 Test Acc: 0.830
Validation loss decreased (-0.797284 --> -0.829718).  Saving model ...
Epoch: 8 cost time: 5.1455042362213135
Epoch: 8, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.017 Vali Acc: 0.849 Test Loss: 1.017 Test Acc: 0.849
Validation loss decreased (-0.829718 --> -0.848638).  Saving model ...
Epoch: 9 cost time: 5.093127250671387
Epoch: 9, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.899 Vali Acc: 0.851 Test Loss: 0.899 Test Acc: 0.851
Validation loss decreased (-0.848638 --> -0.851342).  Saving model ...
Epoch: 10 cost time: 5.248448848724365
Epoch: 10, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
Validation loss decreased (-0.851342 --> -0.889182).  Saving model ...
Epoch: 11 cost time: 5.070629358291626
Epoch: 11, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.655 Vali Acc: 0.897 Test Loss: 0.655 Test Acc: 0.897
Validation loss decreased (-0.889182 --> -0.897291).  Saving model ...
Epoch: 12 cost time: 5.206786155700684
Epoch: 12, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.571 Vali Acc: 0.922 Test Loss: 0.571 Test Acc: 0.922
Validation loss decreased (-0.897291 --> -0.921616).  Saving model ...
Epoch: 13 cost time: 5.010388374328613
Epoch: 13, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.472 Vali Acc: 0.927 Test Loss: 0.472 Test Acc: 0.927
Validation loss decreased (-0.921616 --> -0.927022).  Saving model ...
Epoch: 14 cost time: 4.979910612106323
Epoch: 14, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940537).  Saving model ...
Epoch: 15 cost time: 5.190991401672363
Epoch: 15, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.325 Vali Acc: 0.957 Test Loss: 0.325 Test Acc: 0.957
Validation loss decreased (-0.940537 --> -0.956754).  Saving model ...
Epoch: 16 cost time: 4.92785382270813
Epoch: 16, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.10895848274231
Epoch: 17, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.273 Vali Acc: 0.946 Test Loss: 0.273 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.548285245895386
Epoch: 18, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.228 Vali Acc: 0.957 Test Loss: 0.228 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 19 cost time: 5.531419277191162
Epoch: 19, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.254 Vali Acc: 0.949 Test Loss: 0.254 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.586730003356934
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 5.318803310394287
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.6841139793396
Epoch: 22, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.265722036361694
Epoch: 23, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.65152382850647
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.374377965927124
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.661113262176514
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 27 cost time: 5.553377389907837
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.686588525772095
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.453725814819336
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.592378377914429
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 694265
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.319066047668457
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.085 Vali Acc: 0.227 Test Loss: 2.085 Test Acc: 0.227
Validation loss decreased (inf --> -0.227006).  Saving model ...
Epoch: 2 cost time: 5.62075400352478
Epoch: 2, Steps: 17 | Train Loss: 2.064 Vali Loss: 1.971 Vali Acc: 0.386 Test Loss: 1.971 Test Acc: 0.386
Validation loss decreased (-0.227006 --> -0.386467).  Saving model ...
Epoch: 3 cost time: 5.42046046257019
Epoch: 3, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.819 Vali Acc: 0.595 Test Loss: 1.819 Test Acc: 0.595
Validation loss decreased (-0.386467 --> -0.594576).  Saving model ...
Epoch: 4 cost time: 5.610130548477173
Epoch: 4, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.641 Vali Acc: 0.689 Test Loss: 1.641 Test Acc: 0.689
Validation loss decreased (-0.594576 --> -0.689173).  Saving model ...
Epoch: 5 cost time: 5.597678899765015
Epoch: 5, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.451 Vali Acc: 0.727 Test Loss: 1.451 Test Acc: 0.727
Validation loss decreased (-0.689173 --> -0.727013).  Saving model ...
Epoch: 6 cost time: 5.43851375579834
Epoch: 6, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.260 Vali Acc: 0.792 Test Loss: 1.260 Test Acc: 0.792
Validation loss decreased (-0.727013 --> -0.791879).  Saving model ...
Epoch: 7 cost time: 5.683408498764038
Epoch: 7, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.086 Vali Acc: 0.814 Test Loss: 1.086 Test Acc: 0.814
Validation loss decreased (-0.791879 --> -0.813503).  Saving model ...
Epoch: 8 cost time: 5.413151979446411
Epoch: 8, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.937 Vali Acc: 0.851 Test Loss: 0.937 Test Acc: 0.851
Validation loss decreased (-0.813503 --> -0.851342).  Saving model ...
Epoch: 9 cost time: 5.6233134269714355
Epoch: 9, Steps: 17 | Train Loss: 0.808 Vali Loss: 0.802 Vali Acc: 0.884 Test Loss: 0.802 Test Acc: 0.884
Validation loss decreased (-0.851342 --> -0.883776).  Saving model ...
Epoch: 10 cost time: 5.3527913093566895
Epoch: 10, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.695 Vali Acc: 0.895 Test Loss: 0.695 Test Acc: 0.895
Validation loss decreased (-0.883776 --> -0.894588).  Saving model ...
Epoch: 11 cost time: 5.337061405181885
Epoch: 11, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.643 Vali Acc: 0.886 Test Loss: 0.643 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.100132942199707
Epoch: 12, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.536 Vali Acc: 0.916 Test Loss: 0.536 Test Acc: 0.916
Validation loss decreased (-0.894588 --> -0.916211).  Saving model ...
Epoch: 13 cost time: 6.109604835510254
Epoch: 13, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.435 Vali Acc: 0.938 Test Loss: 0.435 Test Acc: 0.938
Validation loss decreased (-0.916211 --> -0.937833).  Saving model ...
Epoch: 14 cost time: 5.878151893615723
Epoch: 14, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.515 Vali Acc: 0.857 Test Loss: 0.515 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.803365468978882
Epoch: 15, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.365 Vali Acc: 0.927 Test Loss: 0.365 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.227423191070557
Epoch: 16, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.280 Vali Acc: 0.965 Test Loss: 0.280 Test Acc: 0.965
Validation loss decreased (-0.937833 --> -0.964862).  Saving model ...
Epoch: 17 cost time: 6.130239963531494
Epoch: 17, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.262 Vali Acc: 0.957 Test Loss: 0.262 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.822337865829468
Epoch: 18, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
Validation loss decreased (-0.964862 --> -0.970268).  Saving model ...
Epoch: 19 cost time: 5.901137113571167
Epoch: 19, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.910972356796265
Epoch: 20, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.208 Vali Acc: 0.962 Test Loss: 0.208 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.160897970199585
Epoch: 21, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.198 Vali Acc: 0.965 Test Loss: 0.198 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.6865856647491455
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.483010530471802
Epoch: 23, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 4.745229721069336
Epoch: 24, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.431465148925781
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.029165744781494
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.204 Vali Acc: 0.932 Test Loss: 0.204 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.17715859413147
Epoch: 27, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.523983478546143
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.603070259094238
Epoch: 29, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 5.2362380027771
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2349689
model size : 9.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.714252233505249
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.114 Vali Acc: 0.195 Test Loss: 2.114 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 4.599837303161621
Epoch: 2, Steps: 17 | Train Loss: 2.090 Vali Loss: 2.010 Vali Acc: 0.351 Test Loss: 2.010 Test Acc: 0.351
Validation loss decreased (-0.194573 --> -0.351331).  Saving model ...
Epoch: 3 cost time: 4.3366851806640625
Epoch: 3, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.875 Vali Acc: 0.549 Test Loss: 1.875 Test Acc: 0.549
Validation loss decreased (-0.351331 --> -0.548630).  Saving model ...
Epoch: 4 cost time: 4.535718202590942
Epoch: 4, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.717 Vali Acc: 0.697 Test Loss: 1.717 Test Acc: 0.697
Validation loss decreased (-0.548630 --> -0.697280).  Saving model ...
Epoch: 5 cost time: 4.96321177482605
Epoch: 5, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.536 Vali Acc: 0.773 Test Loss: 1.536 Test Acc: 0.773
Validation loss decreased (-0.697280 --> -0.772958).  Saving model ...
Epoch: 6 cost time: 4.694749593734741
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.356 Vali Acc: 0.797 Test Loss: 1.356 Test Acc: 0.797
Validation loss decreased (-0.772958 --> -0.797284).  Saving model ...
Epoch: 7 cost time: 4.524530410766602
Epoch: 7, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.188 Vali Acc: 0.827 Test Loss: 1.188 Test Acc: 0.827
Validation loss decreased (-0.797284 --> -0.827015).  Saving model ...
Epoch: 8 cost time: 4.2205071449279785
Epoch: 8, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.018 Vali Acc: 0.849 Test Loss: 1.018 Test Acc: 0.849
Validation loss decreased (-0.827015 --> -0.848638).  Saving model ...
Epoch: 9 cost time: 4.62248158454895
Epoch: 9, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.900 Vali Acc: 0.851 Test Loss: 0.900 Test Acc: 0.851
Validation loss decreased (-0.848638 --> -0.851342).  Saving model ...
Epoch: 10 cost time: 4.67460036277771
Epoch: 10, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.750 Vali Acc: 0.886 Test Loss: 0.750 Test Acc: 0.886
Validation loss decreased (-0.851342 --> -0.886479).  Saving model ...
Epoch: 11 cost time: 4.5190534591674805
Epoch: 11, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.657 Vali Acc: 0.895 Test Loss: 0.657 Test Acc: 0.895
Validation loss decreased (-0.886479 --> -0.894588).  Saving model ...
Epoch: 12 cost time: 4.493597984313965
Epoch: 12, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.572 Vali Acc: 0.924 Test Loss: 0.572 Test Acc: 0.924
Validation loss decreased (-0.894588 --> -0.924319).  Saving model ...
Epoch: 13 cost time: 4.77069878578186
Epoch: 13, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.476 Vali Acc: 0.930 Test Loss: 0.476 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929725).  Saving model ...
Epoch: 14 cost time: 4.954541921615601
Epoch: 14, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.380 Vali Acc: 0.949 Test Loss: 0.380 Test Acc: 0.949
Validation loss decreased (-0.929725 --> -0.948645).  Saving model ...
Epoch: 15 cost time: 4.751971244812012
Epoch: 15, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.328 Vali Acc: 0.954 Test Loss: 0.328 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 16 cost time: 4.817432641983032
Epoch: 16, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.93340277671814
Epoch: 17, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.273 Vali Acc: 0.951 Test Loss: 0.273 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.776581287384033
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.228 Vali Acc: 0.959 Test Loss: 0.228 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 4.679543972015381
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.257 Vali Acc: 0.949 Test Loss: 0.257 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.415217161178589
Epoch: 20, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 4.5407795906066895
Epoch: 21, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.761064529418945
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.785977840423584
Epoch: 23, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.633054971694946
Epoch: 24, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.65428614616394
Epoch: 25, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.416058540344238
Epoch: 26, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 27 cost time: 4.919747591018677
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.7992095947265625
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.906942367553711
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.0108091831207275
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 694265
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.16028356552124
Epoch: 1, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.089 Vali Acc: 0.227 Test Loss: 2.089 Test Acc: 0.227
Validation loss decreased (inf --> -0.227006).  Saving model ...
Epoch: 2 cost time: 4.128837823867798
Epoch: 2, Steps: 17 | Train Loss: 2.071 Vali Loss: 1.985 Vali Acc: 0.373 Test Loss: 1.985 Test Acc: 0.373
Validation loss decreased (-0.227006 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 4.620974063873291
Epoch: 3, Steps: 17 | Train Loss: 1.934 Vali Loss: 1.852 Vali Acc: 0.538 Test Loss: 1.852 Test Acc: 0.538
Validation loss decreased (-0.372953 --> -0.537819).  Saving model ...
Epoch: 4 cost time: 4.578834772109985
Epoch: 4, Steps: 17 | Train Loss: 1.771 Vali Loss: 1.702 Vali Acc: 0.619 Test Loss: 1.702 Test Acc: 0.619
Validation loss decreased (-0.537819 --> -0.618902).  Saving model ...
Epoch: 5 cost time: 4.732664585113525
Epoch: 5, Steps: 17 | Train Loss: 1.601 Vali Loss: 1.537 Vali Acc: 0.692 Test Loss: 1.537 Test Acc: 0.692
Validation loss decreased (-0.618902 --> -0.691877).  Saving model ...
Epoch: 6 cost time: 4.260659456253052
Epoch: 6, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.370 Vali Acc: 0.768 Test Loss: 1.370 Test Acc: 0.768
Validation loss decreased (-0.691877 --> -0.767554).  Saving model ...
Epoch: 7 cost time: 4.468520641326904
Epoch: 7, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.203 Vali Acc: 0.800 Test Loss: 1.203 Test Acc: 0.800
Validation loss decreased (-0.767554 --> -0.799988).  Saving model ...
Epoch: 8 cost time: 4.642336845397949
Epoch: 8, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.061 Vali Acc: 0.849 Test Loss: 1.061 Test Acc: 0.849
Validation loss decreased (-0.799988 --> -0.848638).  Saving model ...
Epoch: 9 cost time: 4.373670816421509
Epoch: 9, Steps: 17 | Train Loss: 0.918 Vali Loss: 0.921 Vali Acc: 0.873 Test Loss: 0.921 Test Acc: 0.873
Validation loss decreased (-0.848638 --> -0.872964).  Saving model ...
Epoch: 10 cost time: 4.846261024475098
Epoch: 10, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.812 Vali Acc: 0.884 Test Loss: 0.812 Test Acc: 0.884
Validation loss decreased (-0.872964 --> -0.883776).  Saving model ...
Epoch: 11 cost time: 4.468825817108154
Epoch: 11, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.719 Vali Acc: 0.903 Test Loss: 0.719 Test Acc: 0.903
Validation loss decreased (-0.883776 --> -0.902696).  Saving model ...
Epoch: 12 cost time: 4.57281231880188
Epoch: 12, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.617 Vali Acc: 0.903 Test Loss: 0.617 Test Acc: 0.903
Validation loss decreased (-0.902696 --> -0.902697).  Saving model ...
Epoch: 13 cost time: 4.661046028137207
Epoch: 13, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.531 Vali Acc: 0.927 Test Loss: 0.531 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927022).  Saving model ...
Epoch: 14 cost time: 4.831208229064941
Epoch: 14, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.661200046539307
Epoch: 15, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.410 Vali Acc: 0.914 Test Loss: 0.410 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.48430871963501
Epoch: 16, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.345 Vali Acc: 0.943 Test Loss: 0.345 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943240).  Saving model ...
Epoch: 17 cost time: 4.5098841190338135
Epoch: 17, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.319 Vali Acc: 0.946 Test Loss: 0.319 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 18 cost time: 4.2975239753723145
Epoch: 18, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.269 Vali Acc: 0.959 Test Loss: 0.269 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 4.732690811157227
Epoch: 19, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.249 Vali Acc: 0.959 Test Loss: 0.249 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 20 cost time: 4.292829990386963
Epoch: 20, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.219 Vali Acc: 0.962 Test Loss: 0.219 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 21 cost time: 4.356950044631958
Epoch: 21, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.231 Vali Acc: 0.938 Test Loss: 0.231 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.190072774887085
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.671236515045166
Epoch: 23, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
Validation loss decreased (-0.962160 --> -0.975674).  Saving model ...
Epoch: 24 cost time: 4.486219644546509
Epoch: 24, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.257000207901001
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.17652440071106
Epoch: 26, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.6250195503234863
Epoch: 27, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.593932151794434
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.439699411392212
Epoch: 29, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.335153579711914
Epoch: 30, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2349689
model size : 9.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.683365345001221
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.115 Vali Acc: 0.197 Test Loss: 2.115 Test Acc: 0.197
Validation loss decreased (inf --> -0.197276).  Saving model ...
Epoch: 2 cost time: 3.8514325618743896
Epoch: 2, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.014 Vali Acc: 0.349 Test Loss: 2.014 Test Acc: 0.349
Validation loss decreased (-0.197276 --> -0.348629).  Saving model ...
Epoch: 3 cost time: 3.9004693031311035
Epoch: 3, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.884 Vali Acc: 0.527 Test Loss: 1.884 Test Acc: 0.527
Validation loss decreased (-0.348629 --> -0.527008).  Saving model ...
Epoch: 4 cost time: 3.7714531421661377
Epoch: 4, Steps: 17 | Train Loss: 1.842 Vali Loss: 1.736 Vali Acc: 0.673 Test Loss: 1.736 Test Acc: 0.673
Validation loss decreased (-0.527008 --> -0.672956).  Saving model ...
Epoch: 5 cost time: 3.6380655765533447
Epoch: 5, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.578 Vali Acc: 0.770 Test Loss: 1.578 Test Acc: 0.770
Validation loss decreased (-0.672956 --> -0.770254).  Saving model ...
Epoch: 6 cost time: 3.935805082321167
Epoch: 6, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.417 Vali Acc: 0.830 Test Loss: 1.417 Test Acc: 0.830
Validation loss decreased (-0.770254 --> -0.829716).  Saving model ...
Epoch: 7 cost time: 3.734323024749756
Epoch: 7, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.265 Vali Acc: 0.854 Test Loss: 1.265 Test Acc: 0.854
Validation loss decreased (-0.829716 --> -0.854041).  Saving model ...
Epoch: 8 cost time: 3.989346742630005
Epoch: 8, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.109 Vali Acc: 0.868 Test Loss: 1.109 Test Acc: 0.868
Validation loss decreased (-0.854041 --> -0.867556).  Saving model ...
Epoch: 9 cost time: 3.6607651710510254
Epoch: 9, Steps: 17 | Train Loss: 1.026 Vali Loss: 0.982 Vali Acc: 0.876 Test Loss: 0.982 Test Acc: 0.876
Validation loss decreased (-0.867556 --> -0.875666).  Saving model ...
Epoch: 10 cost time: 3.608464002609253
Epoch: 10, Steps: 17 | Train Loss: 0.897 Vali Loss: 0.862 Vali Acc: 0.895 Test Loss: 0.862 Test Acc: 0.895
Validation loss decreased (-0.875666 --> -0.894586).  Saving model ...
Epoch: 11 cost time: 3.861222743988037
Epoch: 11, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.742 Vali Acc: 0.919 Test Loss: 0.742 Test Acc: 0.919
Validation loss decreased (-0.894586 --> -0.918912).  Saving model ...
Epoch: 12 cost time: 3.8394341468811035
Epoch: 12, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.642 Vali Acc: 0.927 Test Loss: 0.642 Test Acc: 0.927
Validation loss decreased (-0.918912 --> -0.927021).  Saving model ...
Epoch: 13 cost time: 4.02548623085022
Epoch: 13, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.566 Vali Acc: 0.935 Test Loss: 0.566 Test Acc: 0.935
Validation loss decreased (-0.927021 --> -0.935129).  Saving model ...
Epoch: 14 cost time: 3.641085147857666
Epoch: 14, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.484 Vali Acc: 0.946 Test Loss: 0.484 Test Acc: 0.946
Validation loss decreased (-0.935129 --> -0.945941).  Saving model ...
Epoch: 15 cost time: 3.5031113624572754
Epoch: 15, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.405 Vali Acc: 0.949 Test Loss: 0.405 Test Acc: 0.949
Validation loss decreased (-0.945941 --> -0.948645).  Saving model ...
Epoch: 16 cost time: 3.7929108142852783
Epoch: 16, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.382 Vali Acc: 0.946 Test Loss: 0.382 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.860409736633301
Epoch: 17, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.314 Vali Acc: 0.965 Test Loss: 0.314 Test Acc: 0.965
Validation loss decreased (-0.948645 --> -0.964862).  Saving model ...
Epoch: 18 cost time: 4.001859903335571
Epoch: 18, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.303 Vali Acc: 0.954 Test Loss: 0.303 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5840437412261963
Epoch: 19, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.261 Vali Acc: 0.968 Test Loss: 0.261 Test Acc: 0.968
Validation loss decreased (-0.964862 --> -0.967565).  Saving model ...
Epoch: 20 cost time: 3.7063217163085938
Epoch: 20, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
Validation loss decreased (-0.967565 --> -0.970268).  Saving model ...
Epoch: 21 cost time: 3.6580896377563477
Epoch: 21, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.220 Vali Acc: 0.965 Test Loss: 0.220 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.818746328353882
Epoch: 22, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.200 Vali Acc: 0.965 Test Loss: 0.200 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.9587314128875732
Epoch: 23, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6097867488861084
Epoch: 24, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8022854328155518
Epoch: 25, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3849329948425293
Epoch: 26, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.465193271636963
Epoch: 27, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.011277437210083
Epoch: 28, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.762171745300293
Epoch: 29, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.8430185317993164
Epoch: 30, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 694265
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 21.50493311882019
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.219 Vali Acc: 0.092 Test Loss: 2.219 Test Acc: 0.092
Validation loss decreased (inf --> -0.091870).  Saving model ...
Epoch: 2 cost time: 15.297834157943726
Epoch: 2, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.122 Vali Acc: 0.211 Test Loss: 2.122 Test Acc: 0.211
Validation loss decreased (-0.091870 --> -0.210790).  Saving model ...
Epoch: 3 cost time: 18.221455097198486
Epoch: 3, Steps: 17 | Train Loss: 2.059 Vali Loss: 1.993 Vali Acc: 0.395 Test Loss: 1.993 Test Acc: 0.395
Validation loss decreased (-0.210790 --> -0.394575).  Saving model ...
Epoch: 4 cost time: 16.85349464416504
Epoch: 4, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.836 Vali Acc: 0.565 Test Loss: 1.836 Test Acc: 0.565
Validation loss decreased (-0.394575 --> -0.564847).  Saving model ...
Epoch: 5 cost time: 15.90761947631836
Epoch: 5, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.655 Vali Acc: 0.635 Test Loss: 1.655 Test Acc: 0.635
Validation loss decreased (-0.564847 --> -0.635119).  Saving model ...
Epoch: 6 cost time: 17.0096492767334
Epoch: 6, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.460 Vali Acc: 0.724 Test Loss: 1.460 Test Acc: 0.724
Validation loss decreased (-0.635119 --> -0.724310).  Saving model ...
Epoch: 7 cost time: 16.005311489105225
Epoch: 7, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.258 Vali Acc: 0.781 Test Loss: 1.258 Test Acc: 0.781
Validation loss decreased (-0.724310 --> -0.781068).  Saving model ...
Epoch: 8 cost time: 17.348278760910034
Epoch: 8, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.099 Vali Acc: 0.811 Test Loss: 1.099 Test Acc: 0.811
Validation loss decreased (-0.781068 --> -0.810800).  Saving model ...
Epoch: 9 cost time: 16.187949180603027
Epoch: 9, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.939 Vali Acc: 0.841 Test Loss: 0.939 Test Acc: 0.841
Validation loss decreased (-0.810800 --> -0.840531).  Saving model ...
Epoch: 10 cost time: 15.406307220458984
Epoch: 10, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.790 Vali Acc: 0.881 Test Loss: 0.790 Test Acc: 0.881
Validation loss decreased (-0.840531 --> -0.881073).  Saving model ...
Epoch: 11 cost time: 16.957112312316895
Epoch: 11, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.667 Vali Acc: 0.903 Test Loss: 0.667 Test Acc: 0.903
Validation loss decreased (-0.881073 --> -0.902696).  Saving model ...
Epoch: 12 cost time: 15.285986423492432
Epoch: 12, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.564 Vali Acc: 0.924 Test Loss: 0.564 Test Acc: 0.924
Validation loss decreased (-0.902696 --> -0.924319).  Saving model ...
Epoch: 13 cost time: 14.202468872070312
Epoch: 13, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.490 Vali Acc: 0.930 Test Loss: 0.490 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929725).  Saving model ...
Epoch: 14 cost time: 15.651850938796997
Epoch: 14, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.441 Vali Acc: 0.930 Test Loss: 0.441 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929725).  Saving model ...
Epoch: 15 cost time: 13.193021059036255
Epoch: 15, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.411 Vali Acc: 0.932 Test Loss: 0.411 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932428).  Saving model ...
Epoch: 16 cost time: 16.08683729171753
Epoch: 16, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.324 Vali Acc: 0.943 Test Loss: 0.324 Test Acc: 0.943
Validation loss decreased (-0.932428 --> -0.943240).  Saving model ...
Epoch: 17 cost time: 16.140733003616333
Epoch: 17, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.298 Vali Acc: 0.938 Test Loss: 0.298 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.872556209564209
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.235 Vali Acc: 0.965 Test Loss: 0.235 Test Acc: 0.965
Validation loss decreased (-0.943240 --> -0.964863).  Saving model ...
Epoch: 19 cost time: 16.861703157424927
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.215 Vali Acc: 0.968 Test Loss: 0.215 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967565).  Saving model ...
Epoch: 20 cost time: 16.453348398208618
Epoch: 20, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 15.941766738891602
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.256 Vali Acc: 0.951 Test Loss: 0.256 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.95370841026306
Epoch: 22, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
Validation loss decreased (-0.967565 --> -0.970268).  Saving model ...
Epoch: 23 cost time: 16.153408527374268
Epoch: 23, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975674).  Saving model ...
Epoch: 24 cost time: 16.494523763656616
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 17.55408477783203
Epoch: 25, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 14.324182748794556
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 16.10053825378418
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 16.55726408958435
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 15.558766841888428
Epoch: 29, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 16.30738401412964
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1177465
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 12.228669881820679
Epoch: 1, Steps: 17 | Train Loss: 2.094 Vali Loss: 2.075 Vali Acc: 0.373 Test Loss: 2.075 Test Acc: 0.373
Validation loss decreased (inf --> -0.372952).  Saving model ...
Epoch: 2 cost time: 9.633714199066162
Epoch: 2, Steps: 17 | Train Loss: 2.013 Vali Loss: 1.984 Vali Acc: 0.462 Test Loss: 1.984 Test Acc: 0.462
Validation loss decreased (-0.372952 --> -0.462142).  Saving model ...
Epoch: 3 cost time: 10.494298458099365
Epoch: 3, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.868 Vali Acc: 0.527 Test Loss: 1.868 Test Acc: 0.527
Validation loss decreased (-0.462142 --> -0.527008).  Saving model ...
Epoch: 4 cost time: 9.947370290756226
Epoch: 4, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.732 Vali Acc: 0.624 Test Loss: 1.732 Test Acc: 0.624
Validation loss decreased (-0.527008 --> -0.624307).  Saving model ...
Epoch: 5 cost time: 9.108373880386353
Epoch: 5, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.575 Vali Acc: 0.657 Test Loss: 1.575 Test Acc: 0.657
Validation loss decreased (-0.624307 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 8.647087812423706
Epoch: 6, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.417 Vali Acc: 0.722 Test Loss: 1.417 Test Acc: 0.722
Validation loss decreased (-0.656741 --> -0.721607).  Saving model ...
Epoch: 7 cost time: 9.365390300750732
Epoch: 7, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.236 Vali Acc: 0.786 Test Loss: 1.236 Test Acc: 0.786
Validation loss decreased (-0.721607 --> -0.786474).  Saving model ...
Epoch: 8 cost time: 8.596961975097656
Epoch: 8, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.084 Vali Acc: 0.803 Test Loss: 1.084 Test Acc: 0.803
Validation loss decreased (-0.786474 --> -0.802692).  Saving model ...
Epoch: 9 cost time: 9.088818073272705
Epoch: 9, Steps: 17 | Train Loss: 0.940 Vali Loss: 0.931 Vali Acc: 0.805 Test Loss: 0.931 Test Acc: 0.805
Validation loss decreased (-0.802692 --> -0.805396).  Saving model ...
Epoch: 10 cost time: 8.611855745315552
Epoch: 10, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.800 Vali Acc: 0.873 Test Loss: 0.800 Test Acc: 0.873
Validation loss decreased (-0.805396 --> -0.872965).  Saving model ...
Epoch: 11 cost time: 9.183161973953247
Epoch: 11, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.735 Vali Acc: 0.838 Test Loss: 0.735 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.099539995193481
Epoch: 12, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.583 Vali Acc: 0.903 Test Loss: 0.583 Test Acc: 0.903
Validation loss decreased (-0.872965 --> -0.902697).  Saving model ...
Epoch: 13 cost time: 8.899332284927368
Epoch: 13, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.466586351394653
Epoch: 14, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.90652585029602
Epoch: 15, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.470 Vali Acc: 0.886 Test Loss: 0.470 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.490607023239136
Epoch: 16, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.431 Vali Acc: 0.895 Test Loss: 0.431 Test Acc: 0.895
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.67789888381958
Epoch: 17, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.303 Vali Acc: 0.943 Test Loss: 0.303 Test Acc: 0.943
Validation loss decreased (-0.902697 --> -0.943240).  Saving model ...
Epoch: 18 cost time: 5.813184499740601
Epoch: 18, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.492602825164795
Epoch: 19, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.289 Vali Acc: 0.924 Test Loss: 0.289 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.117153644561768
Epoch: 20, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.267 Vali Acc: 0.924 Test Loss: 0.267 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.421377897262573
Epoch: 21, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.251 Vali Acc: 0.927 Test Loss: 0.251 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.914020538330078
Epoch: 22, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.943240 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 9.518616676330566
Epoch: 23, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.283018350601196
Epoch: 24, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.031802415847778
Epoch: 25, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.449509859085083
Epoch: 26, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.247 Vali Acc: 0.927 Test Loss: 0.247 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.475865364074707
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.324155569076538
Epoch: 28, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.240 Vali Acc: 0.927 Test Loss: 0.240 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 8.520766735076904
Epoch: 29, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.924 Test Loss: 0.234 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.420271873474121
Epoch: 30, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 349689
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.936074495315552
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.220 Vali Acc: 0.092 Test Loss: 2.220 Test Acc: 0.092
Validation loss decreased (inf --> -0.091870).  Saving model ...
Epoch: 2 cost time: 11.395914554595947
Epoch: 2, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.122 Vali Acc: 0.211 Test Loss: 2.122 Test Acc: 0.211
Validation loss decreased (-0.091870 --> -0.210790).  Saving model ...
Epoch: 3 cost time: 11.057093620300293
Epoch: 3, Steps: 17 | Train Loss: 2.061 Vali Loss: 1.994 Vali Acc: 0.395 Test Loss: 1.994 Test Acc: 0.395
Validation loss decreased (-0.210790 --> -0.394575).  Saving model ...
Epoch: 4 cost time: 11.032956838607788
Epoch: 4, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.839 Vali Acc: 0.562 Test Loss: 1.839 Test Acc: 0.562
Validation loss decreased (-0.394575 --> -0.562144).  Saving model ...
Epoch: 5 cost time: 11.461924076080322
Epoch: 5, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.660 Vali Acc: 0.638 Test Loss: 1.660 Test Acc: 0.638
Validation loss decreased (-0.562144 --> -0.637821).  Saving model ...
Epoch: 6 cost time: 11.303238868713379
Epoch: 6, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.471 Vali Acc: 0.711 Test Loss: 1.471 Test Acc: 0.711
Validation loss decreased (-0.637821 --> -0.710796).  Saving model ...
Epoch: 7 cost time: 12.241328477859497
Epoch: 7, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.274 Vali Acc: 0.778 Test Loss: 1.274 Test Acc: 0.778
Validation loss decreased (-0.710796 --> -0.778366).  Saving model ...
Epoch: 8 cost time: 11.558547019958496
Epoch: 8, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.117 Vali Acc: 0.816 Test Loss: 1.117 Test Acc: 0.816
Validation loss decreased (-0.778366 --> -0.816205).  Saving model ...
Epoch: 9 cost time: 12.490272998809814
Epoch: 9, Steps: 17 | Train Loss: 0.956 Vali Loss: 0.954 Vali Acc: 0.862 Test Loss: 0.954 Test Acc: 0.862
Validation loss decreased (-0.816205 --> -0.862153).  Saving model ...
Epoch: 10 cost time: 11.737557172775269
Epoch: 10, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.812 Vali Acc: 0.889 Test Loss: 0.812 Test Acc: 0.889
Validation loss decreased (-0.862153 --> -0.889181).  Saving model ...
Epoch: 11 cost time: 11.5211181640625
Epoch: 11, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.680 Vali Acc: 0.911 Test Loss: 0.680 Test Acc: 0.911
Validation loss decreased (-0.889181 --> -0.910804).  Saving model ...
Epoch: 12 cost time: 10.53761625289917
Epoch: 12, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.589 Vali Acc: 0.919 Test Loss: 0.589 Test Acc: 0.919
Validation loss decreased (-0.910804 --> -0.918913).  Saving model ...
Epoch: 13 cost time: 10.76766300201416
Epoch: 13, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.514 Vali Acc: 0.935 Test Loss: 0.514 Test Acc: 0.935
Validation loss decreased (-0.918913 --> -0.935130).  Saving model ...
Epoch: 14 cost time: 10.97916841506958
Epoch: 14, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.441 Vali Acc: 0.938 Test Loss: 0.441 Test Acc: 0.938
Validation loss decreased (-0.935130 --> -0.937833).  Saving model ...
Epoch: 15 cost time: 11.020347118377686
Epoch: 15, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.401 Vali Acc: 0.932 Test Loss: 0.401 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.83534836769104
Epoch: 16, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.343 Vali Acc: 0.943 Test Loss: 0.343 Test Acc: 0.943
Validation loss decreased (-0.937833 --> -0.943240).  Saving model ...
Epoch: 17 cost time: 10.858604907989502
Epoch: 17, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.292 Vali Acc: 0.954 Test Loss: 0.292 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954051).  Saving model ...
Epoch: 18 cost time: 11.726451396942139
Epoch: 18, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.246 Vali Acc: 0.957 Test Loss: 0.246 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 19 cost time: 10.82502031326294
Epoch: 19, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 20 cost time: 11.757664680480957
Epoch: 20, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.898764848709106
Epoch: 21, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.471205711364746
Epoch: 22, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.19817852973938
Epoch: 23, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 10.5351881980896
Epoch: 24, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.345639705657959
Epoch: 25, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 10.294264554977417
Epoch: 26, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 10.75987696647644
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.071571826934814
Epoch: 28, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 11.948310375213623
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 11.078640460968018
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1177465
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.520816326141357
Epoch: 1, Steps: 17 | Train Loss: 2.094 Vali Loss: 2.075 Vali Acc: 0.373 Test Loss: 2.075 Test Acc: 0.373
Validation loss decreased (inf --> -0.372952).  Saving model ...
Epoch: 2 cost time: 6.867866516113281
Epoch: 2, Steps: 17 | Train Loss: 2.013 Vali Loss: 1.984 Vali Acc: 0.462 Test Loss: 1.984 Test Acc: 0.462
Validation loss decreased (-0.372952 --> -0.462142).  Saving model ...
Epoch: 3 cost time: 7.200232267379761
Epoch: 3, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.868 Vali Acc: 0.530 Test Loss: 1.868 Test Acc: 0.530
Validation loss decreased (-0.462142 --> -0.529711).  Saving model ...
Epoch: 4 cost time: 6.818583726882935
Epoch: 4, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.731 Vali Acc: 0.627 Test Loss: 1.731 Test Acc: 0.627
Validation loss decreased (-0.529711 --> -0.627010).  Saving model ...
Epoch: 5 cost time: 6.893240690231323
Epoch: 5, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.574 Vali Acc: 0.657 Test Loss: 1.574 Test Acc: 0.657
Validation loss decreased (-0.627010 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 7.14177131652832
Epoch: 6, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.415 Vali Acc: 0.724 Test Loss: 1.415 Test Acc: 0.724
Validation loss decreased (-0.656741 --> -0.724310).  Saving model ...
Epoch: 7 cost time: 6.704946517944336
Epoch: 7, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.235 Vali Acc: 0.781 Test Loss: 1.235 Test Acc: 0.781
Validation loss decreased (-0.724310 --> -0.781069).  Saving model ...
Epoch: 8 cost time: 6.377883672714233
Epoch: 8, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.083 Vali Acc: 0.808 Test Loss: 1.083 Test Acc: 0.808
Validation loss decreased (-0.781069 --> -0.808097).  Saving model ...
Epoch: 9 cost time: 6.83233904838562
Epoch: 9, Steps: 17 | Train Loss: 0.941 Vali Loss: 0.930 Vali Acc: 0.808 Test Loss: 0.930 Test Acc: 0.808
Validation loss decreased (-0.808097 --> -0.808099).  Saving model ...
Epoch: 10 cost time: 5.001065254211426
Epoch: 10, Steps: 17 | Train Loss: 0.801 Vali Loss: 0.801 Vali Acc: 0.865 Test Loss: 0.801 Test Acc: 0.865
Validation loss decreased (-0.808099 --> -0.864857).  Saving model ...
Epoch: 11 cost time: 7.243931770324707
Epoch: 11, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.728 Vali Acc: 0.843 Test Loss: 0.728 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.236833095550537
Epoch: 12, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.583 Vali Acc: 0.911 Test Loss: 0.583 Test Acc: 0.911
Validation loss decreased (-0.864857 --> -0.910805).  Saving model ...
Epoch: 13 cost time: 6.970009088516235
Epoch: 13, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.542 Vali Acc: 0.908 Test Loss: 0.542 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.739256143569946
Epoch: 14, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.475 Vali Acc: 0.903 Test Loss: 0.475 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.140849828720093
Epoch: 15, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.440 Vali Acc: 0.903 Test Loss: 0.440 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.054808616638184
Epoch: 16, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.413 Vali Acc: 0.911 Test Loss: 0.413 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910807).  Saving model ...
Epoch: 17 cost time: 7.778945446014404
Epoch: 17, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.296 Vali Acc: 0.946 Test Loss: 0.296 Test Acc: 0.946
Validation loss decreased (-0.910807 --> -0.945943).  Saving model ...
Epoch: 18 cost time: 7.2706074714660645
Epoch: 18, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.298681259155273
Epoch: 19, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.862490177154541
Epoch: 20, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.260 Vali Acc: 0.927 Test Loss: 0.260 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.294949054718018
Epoch: 21, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.592733860015869
Epoch: 22, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 23 cost time: 7.851826906204224
Epoch: 23, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.063420057296753
Epoch: 24, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.3814332485198975
Epoch: 25, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.259607315063477
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.777012586593628
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.398213624954224
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.9454665184021
Epoch: 29, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.276209831237793
Epoch: 30, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 349689
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.645092964172363
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.221 Vali Acc: 0.092 Test Loss: 2.221 Test Acc: 0.092
Validation loss decreased (inf --> -0.091870).  Saving model ...
Epoch: 2 cost time: 6.733588933944702
Epoch: 2, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.126 Vali Acc: 0.205 Test Loss: 2.126 Test Acc: 0.205
Validation loss decreased (-0.091870 --> -0.205384).  Saving model ...
Epoch: 3 cost time: 7.045772314071655
Epoch: 3, Steps: 17 | Train Loss: 2.067 Vali Loss: 2.001 Vali Acc: 0.395 Test Loss: 2.001 Test Acc: 0.395
Validation loss decreased (-0.205384 --> -0.394575).  Saving model ...
Epoch: 4 cost time: 6.802997589111328
Epoch: 4, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.850 Vali Acc: 0.565 Test Loss: 1.850 Test Acc: 0.565
Validation loss decreased (-0.394575 --> -0.564846).  Saving model ...
Epoch: 5 cost time: 6.720313549041748
Epoch: 5, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.680 Vali Acc: 0.641 Test Loss: 1.680 Test Acc: 0.641
Validation loss decreased (-0.564846 --> -0.640524).  Saving model ...
Epoch: 6 cost time: 7.431962966918945
Epoch: 6, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.506 Vali Acc: 0.689 Test Loss: 1.506 Test Acc: 0.689
Validation loss decreased (-0.640524 --> -0.689174).  Saving model ...
Epoch: 7 cost time: 7.354067802429199
Epoch: 7, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.337 Vali Acc: 0.735 Test Loss: 1.337 Test Acc: 0.735
Validation loss decreased (-0.689174 --> -0.735122).  Saving model ...
Epoch: 8 cost time: 7.164015293121338
Epoch: 8, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.193 Vali Acc: 0.776 Test Loss: 1.193 Test Acc: 0.776
Validation loss decreased (-0.735122 --> -0.775664).  Saving model ...
Epoch: 9 cost time: 6.812279462814331
Epoch: 9, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.050 Vali Acc: 0.832 Test Loss: 1.050 Test Acc: 0.832
Validation loss decreased (-0.775664 --> -0.832422).  Saving model ...
Epoch: 10 cost time: 5.983086585998535
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.915 Vali Acc: 0.884 Test Loss: 0.915 Test Acc: 0.884
Validation loss decreased (-0.832422 --> -0.883775).  Saving model ...
Epoch: 11 cost time: 7.045134544372559
Epoch: 11, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.792 Vali Acc: 0.886 Test Loss: 0.792 Test Acc: 0.886
Validation loss decreased (-0.883775 --> -0.886479).  Saving model ...
Epoch: 12 cost time: 6.776827335357666
Epoch: 12, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.691 Vali Acc: 0.911 Test Loss: 0.691 Test Acc: 0.911
Validation loss decreased (-0.886479 --> -0.910804).  Saving model ...
Epoch: 13 cost time: 5.196666717529297
Epoch: 13, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.588 Vali Acc: 0.919 Test Loss: 0.588 Test Acc: 0.919
Validation loss decreased (-0.910804 --> -0.918913).  Saving model ...
Epoch: 14 cost time: 5.9573352336883545
Epoch: 14, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.504 Vali Acc: 0.938 Test Loss: 0.504 Test Acc: 0.938
Validation loss decreased (-0.918913 --> -0.937833).  Saving model ...
Epoch: 15 cost time: 5.464674711227417
Epoch: 15, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.441 Vali Acc: 0.938 Test Loss: 0.441 Test Acc: 0.938
Validation loss decreased (-0.937833 --> -0.937833).  Saving model ...
Epoch: 16 cost time: 6.033825159072876
Epoch: 16, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.407 Vali Acc: 0.943 Test Loss: 0.407 Test Acc: 0.943
Validation loss decreased (-0.937833 --> -0.943239).  Saving model ...
Epoch: 17 cost time: 5.501129865646362
Epoch: 17, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.362 Vali Acc: 0.941 Test Loss: 0.362 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.349737167358398
Epoch: 18, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.293 Vali Acc: 0.959 Test Loss: 0.293 Test Acc: 0.959
Validation loss decreased (-0.943239 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 6.383630752563477
Epoch: 19, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.283 Vali Acc: 0.949 Test Loss: 0.283 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.780811309814453
Epoch: 20, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.034883499145508
Epoch: 21, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.233 Vali Acc: 0.962 Test Loss: 0.233 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 22 cost time: 6.1532464027404785
Epoch: 22, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 5.955240726470947
Epoch: 23, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.085325241088867
Epoch: 24, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.272351026535034
Epoch: 25, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.765418529510498
Epoch: 26, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.463872194290161
Epoch: 27, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.110624074935913
Epoch: 28, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.278299331665039
Epoch: 29, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.618707895278931
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1177465
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.294630289077759
Epoch: 1, Steps: 17 | Train Loss: 2.094 Vali Loss: 2.077 Vali Acc: 0.373 Test Loss: 2.077 Test Acc: 0.373
Validation loss decreased (inf --> -0.372952).  Saving model ...
Epoch: 2 cost time: 4.12723183631897
Epoch: 2, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.990 Vali Acc: 0.457 Test Loss: 1.990 Test Acc: 0.457
Validation loss decreased (-0.372952 --> -0.456737).  Saving model ...
Epoch: 3 cost time: 3.7369000911712646
Epoch: 3, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.878 Vali Acc: 0.505 Test Loss: 1.878 Test Acc: 0.505
Validation loss decreased (-0.456737 --> -0.505387).  Saving model ...
Epoch: 4 cost time: 3.5125539302825928
Epoch: 4, Steps: 17 | Train Loss: 1.794 Vali Loss: 1.750 Vali Acc: 0.578 Test Loss: 1.750 Test Acc: 0.578
Validation loss decreased (-0.505387 --> -0.578361).  Saving model ...
Epoch: 5 cost time: 4.50941014289856
Epoch: 5, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.608 Vali Acc: 0.643 Test Loss: 1.608 Test Acc: 0.643
Validation loss decreased (-0.578361 --> -0.643227).  Saving model ...
Epoch: 6 cost time: 4.115095853805542
Epoch: 6, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.472 Vali Acc: 0.714 Test Loss: 1.472 Test Acc: 0.714
Validation loss decreased (-0.643227 --> -0.713499).  Saving model ...
Epoch: 7 cost time: 4.195396423339844
Epoch: 7, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.325 Vali Acc: 0.754 Test Loss: 1.325 Test Acc: 0.754
Validation loss decreased (-0.713499 --> -0.754041).  Saving model ...
Epoch: 8 cost time: 4.798027992248535
Epoch: 8, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.187 Vali Acc: 0.768 Test Loss: 1.187 Test Acc: 0.768
Validation loss decreased (-0.754041 --> -0.767556).  Saving model ...
Epoch: 9 cost time: 4.434812545776367
Epoch: 9, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.057 Vali Acc: 0.803 Test Loss: 1.057 Test Acc: 0.803
Validation loss decreased (-0.767556 --> -0.802692).  Saving model ...
Epoch: 10 cost time: 4.327731132507324
Epoch: 10, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.943 Vali Acc: 0.822 Test Loss: 0.943 Test Acc: 0.822
Validation loss decreased (-0.802692 --> -0.821612).  Saving model ...
Epoch: 11 cost time: 4.622456789016724
Epoch: 11, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.821 Vali Acc: 0.851 Test Loss: 0.821 Test Acc: 0.851
Validation loss decreased (-0.821612 --> -0.851343).  Saving model ...
Epoch: 12 cost time: 4.002137660980225
Epoch: 12, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.737 Vali Acc: 0.868 Test Loss: 0.737 Test Acc: 0.868
Validation loss decreased (-0.851343 --> -0.867560).  Saving model ...
Epoch: 13 cost time: 4.055022716522217
Epoch: 13, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.647 Vali Acc: 0.881 Test Loss: 0.647 Test Acc: 0.881
Validation loss decreased (-0.867560 --> -0.881075).  Saving model ...
Epoch: 14 cost time: 4.2614991664886475
Epoch: 14, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.576 Vali Acc: 0.892 Test Loss: 0.576 Test Acc: 0.892
Validation loss decreased (-0.881075 --> -0.891886).  Saving model ...
Epoch: 15 cost time: 4.439061880111694
Epoch: 15, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.891886 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 4.236152172088623
Epoch: 16, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.490 Vali Acc: 0.892 Test Loss: 0.490 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.589880466461182
Epoch: 17, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.403 Vali Acc: 0.927 Test Loss: 0.403 Test Acc: 0.927
Validation loss decreased (-0.899995 --> -0.927023).  Saving model ...
Epoch: 18 cost time: 4.392441511154175
Epoch: 18, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.385 Vali Acc: 0.908 Test Loss: 0.385 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.502471446990967
Epoch: 19, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.349 Vali Acc: 0.924 Test Loss: 0.349 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.692589998245239
Epoch: 20, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.326 Vali Acc: 0.924 Test Loss: 0.326 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.279639959335327
Epoch: 21, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927024).  Saving model ...
Epoch: 22 cost time: 4.099492311477661
Epoch: 22, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.272 Vali Acc: 0.927 Test Loss: 0.272 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 23 cost time: 4.404102802276611
Epoch: 23, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 24 cost time: 4.002016305923462
Epoch: 24, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.023555278778076
Epoch: 25, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.242 Vali Acc: 0.927 Test Loss: 0.242 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.551872253417969
Epoch: 26, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.217 Vali Acc: 0.938 Test Loss: 0.217 Test Acc: 0.938
Validation loss decreased (-0.932430 --> -0.937836).  Saving model ...
Epoch: 27 cost time: 4.292246341705322
Epoch: 27, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.232 Vali Acc: 0.935 Test Loss: 0.232 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.468066930770874
Epoch: 28, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.049564599990845
Epoch: 29, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.008736848831177
Epoch: 30, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 349689
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 16.679113626480103
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 2.171 Vali Acc: 0.122 Test Loss: 2.171 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 14.950580835342407
Epoch: 2, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.087 Vali Acc: 0.227 Test Loss: 2.087 Test Acc: 0.227
Validation loss decreased (-0.121600 --> -0.227006).  Saving model ...
Epoch: 3 cost time: 14.168989181518555
Epoch: 3, Steps: 17 | Train Loss: 2.093 Vali Loss: 1.975 Vali Acc: 0.427 Test Loss: 1.975 Test Acc: 0.427
Validation loss decreased (-0.227006 --> -0.427007).  Saving model ...
Epoch: 4 cost time: 14.668320894241333
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.834 Vali Acc: 0.616 Test Loss: 1.834 Test Acc: 0.616
Validation loss decreased (-0.427007 --> -0.616198).  Saving model ...
Epoch: 5 cost time: 14.676777839660645
Epoch: 5, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.664 Vali Acc: 0.759 Test Loss: 1.664 Test Acc: 0.759
Validation loss decreased (-0.616198 --> -0.759443).  Saving model ...
Epoch: 6 cost time: 13.964260339736938
Epoch: 6, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.471 Vali Acc: 0.857 Test Loss: 1.471 Test Acc: 0.857
Validation loss decreased (-0.759443 --> -0.856742).  Saving model ...
Epoch: 7 cost time: 12.461029291152954
Epoch: 7, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.279 Vali Acc: 0.886 Test Loss: 1.279 Test Acc: 0.886
Validation loss decreased (-0.856742 --> -0.886474).  Saving model ...
Epoch: 8 cost time: 13.536439895629883
Epoch: 8, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.095 Vali Acc: 0.886 Test Loss: 1.095 Test Acc: 0.886
Validation loss decreased (-0.886474 --> -0.886476).  Saving model ...
Epoch: 9 cost time: 15.205205202102661
Epoch: 9, Steps: 17 | Train Loss: 1.021 Vali Loss: 0.888 Vali Acc: 0.905 Test Loss: 0.888 Test Acc: 0.905
Validation loss decreased (-0.886476 --> -0.905397).  Saving model ...
Epoch: 10 cost time: 14.961405992507935
Epoch: 10, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.750 Vali Acc: 0.903 Test Loss: 0.750 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.113269329071045
Epoch: 11, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.599 Vali Acc: 0.919 Test Loss: 0.599 Test Acc: 0.919
Validation loss decreased (-0.905397 --> -0.918913).  Saving model ...
Epoch: 12 cost time: 17.138800859451294
Epoch: 12, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.481 Vali Acc: 0.930 Test Loss: 0.481 Test Acc: 0.930
Validation loss decreased (-0.918913 --> -0.929725).  Saving model ...
Epoch: 13 cost time: 15.794870853424072
Epoch: 13, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.387 Vali Acc: 0.957 Test Loss: 0.387 Test Acc: 0.957
Validation loss decreased (-0.929725 --> -0.956753).  Saving model ...
Epoch: 14 cost time: 15.962172508239746
Epoch: 14, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.403 Vali Acc: 0.914 Test Loss: 0.403 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.977749824523926
Epoch: 15, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.285 Vali Acc: 0.962 Test Loss: 0.285 Test Acc: 0.962
Validation loss decreased (-0.956753 --> -0.962159).  Saving model ...
Epoch: 16 cost time: 16.949476718902588
Epoch: 16, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.277 Vali Acc: 0.949 Test Loss: 0.277 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 15.788211822509766
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.255 Vali Acc: 0.949 Test Loss: 0.255 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.195107460021973
Epoch: 18, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
Validation loss decreased (-0.962159 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 14.04143500328064
Epoch: 19, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.857672691345215
Epoch: 20, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 16.637088537216187
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 16.805002450942993
Epoch: 22, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 16.36824655532837
Epoch: 23, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 15.763814926147461
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 17.329508066177368
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 17.74155831336975
Epoch: 26, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 16.944064378738403
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 15.326061248779297
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 15.529500484466553
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 15.920027256011963
Epoch: 30, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 591353
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.286397933959961
Epoch: 1, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.223 Vali Acc: 0.084 Test Loss: 2.223 Test Acc: 0.084
Validation loss decreased (inf --> -0.083762).  Saving model ...
Epoch: 2 cost time: 10.187762260437012
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.134 Vali Acc: 0.189 Test Loss: 2.134 Test Acc: 0.189
Validation loss decreased (-0.083762 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 9.559290409088135
Epoch: 3, Steps: 17 | Train Loss: 2.056 Vali Loss: 2.018 Vali Acc: 0.330 Test Loss: 2.018 Test Acc: 0.330
Validation loss decreased (-0.189168 --> -0.329710).  Saving model ...
Epoch: 4 cost time: 10.097721338272095
Epoch: 4, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.883 Vali Acc: 0.481 Test Loss: 1.883 Test Acc: 0.481
Validation loss decreased (-0.329710 --> -0.481062).  Saving model ...
Epoch: 5 cost time: 9.566855192184448
Epoch: 5, Steps: 17 | Train Loss: 1.791 Vali Loss: 1.728 Vali Acc: 0.608 Test Loss: 1.728 Test Acc: 0.608
Validation loss decreased (-0.481062 --> -0.608091).  Saving model ...
Epoch: 6 cost time: 9.431241512298584
Epoch: 6, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.567 Vali Acc: 0.722 Test Loss: 1.567 Test Acc: 0.722
Validation loss decreased (-0.608091 --> -0.721606).  Saving model ...
Epoch: 7 cost time: 9.734869956970215
Epoch: 7, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.396 Vali Acc: 0.773 Test Loss: 1.396 Test Acc: 0.773
Validation loss decreased (-0.721606 --> -0.772959).  Saving model ...
Epoch: 8 cost time: 9.344374895095825
Epoch: 8, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.219 Vali Acc: 0.846 Test Loss: 1.219 Test Acc: 0.846
Validation loss decreased (-0.772959 --> -0.845934).  Saving model ...
Epoch: 9 cost time: 8.934739589691162
Epoch: 9, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.076 Vali Acc: 0.846 Test Loss: 1.076 Test Acc: 0.846
Validation loss decreased (-0.845934 --> -0.845935).  Saving model ...
Epoch: 10 cost time: 7.967406749725342
Epoch: 10, Steps: 17 | Train Loss: 0.957 Vali Loss: 0.930 Vali Acc: 0.881 Test Loss: 0.930 Test Acc: 0.881
Validation loss decreased (-0.845935 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 7.954739332199097
Epoch: 11, Steps: 17 | Train Loss: 0.833 Vali Loss: 0.808 Vali Acc: 0.892 Test Loss: 0.808 Test Acc: 0.892
Validation loss decreased (-0.881072 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 8.51503872871399
Epoch: 12, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.713 Vali Acc: 0.903 Test Loss: 0.713 Test Acc: 0.903
Validation loss decreased (-0.891884 --> -0.902696).  Saving model ...
Epoch: 13 cost time: 8.007851600646973
Epoch: 13, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.622 Vali Acc: 0.914 Test Loss: 0.622 Test Acc: 0.914
Validation loss decreased (-0.902696 --> -0.913507).  Saving model ...
Epoch: 14 cost time: 9.453535079956055
Epoch: 14, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.542 Vali Acc: 0.932 Test Loss: 0.542 Test Acc: 0.932
Validation loss decreased (-0.913507 --> -0.932427).  Saving model ...
Epoch: 15 cost time: 8.965072870254517
Epoch: 15, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.470 Vali Acc: 0.949 Test Loss: 0.470 Test Acc: 0.949
Validation loss decreased (-0.932427 --> -0.948644).  Saving model ...
Epoch: 16 cost time: 8.955357789993286
Epoch: 16, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.402 Vali Acc: 0.954 Test Loss: 0.402 Test Acc: 0.954
Validation loss decreased (-0.948644 --> -0.954050).  Saving model ...
Epoch: 17 cost time: 9.589655637741089
Epoch: 17, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.340 Vali Acc: 0.957 Test Loss: 0.340 Test Acc: 0.957
Validation loss decreased (-0.954050 --> -0.956753).  Saving model ...
Epoch: 18 cost time: 9.016469717025757
Epoch: 18, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.309 Vali Acc: 0.949 Test Loss: 0.309 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.147794961929321
Epoch: 19, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.278 Vali Acc: 0.957 Test Loss: 0.278 Test Acc: 0.957
Validation loss decreased (-0.956753 --> -0.956754).  Saving model ...
Epoch: 20 cost time: 8.538772821426392
Epoch: 20, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.230 Vali Acc: 0.970 Test Loss: 0.230 Test Acc: 0.970
Validation loss decreased (-0.956754 --> -0.970268).  Saving model ...
Epoch: 21 cost time: 8.525064468383789
Epoch: 21, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972971).  Saving model ...
Epoch: 22 cost time: 9.175736904144287
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972971).  Saving model ...
Epoch: 23 cost time: 7.755727529525757
Epoch: 23, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.340442657470703
Epoch: 24, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.503616809844971
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.687008857727051
Epoch: 26, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.502745866775513
Epoch: 27, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 8.79916524887085
Epoch: 28, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.26981234550476
Epoch: 29, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 8.617595672607422
Epoch: 30, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 177401
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 13.271493673324585
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 2.171 Vali Acc: 0.122 Test Loss: 2.171 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 10.793298244476318
Epoch: 2, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.087 Vali Acc: 0.227 Test Loss: 2.087 Test Acc: 0.227
Validation loss decreased (-0.121600 --> -0.227006).  Saving model ...
Epoch: 3 cost time: 10.984639883041382
Epoch: 3, Steps: 17 | Train Loss: 2.093 Vali Loss: 1.976 Vali Acc: 0.424 Test Loss: 1.976 Test Acc: 0.424
Validation loss decreased (-0.227006 --> -0.424305).  Saving model ...
Epoch: 4 cost time: 11.391026020050049
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.835 Vali Acc: 0.614 Test Loss: 1.835 Test Acc: 0.614
Validation loss decreased (-0.424305 --> -0.613495).  Saving model ...
Epoch: 5 cost time: 10.7352614402771
Epoch: 5, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.666 Vali Acc: 0.757 Test Loss: 1.666 Test Acc: 0.757
Validation loss decreased (-0.613495 --> -0.756740).  Saving model ...
Epoch: 6 cost time: 9.873501300811768
Epoch: 6, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.472 Vali Acc: 0.857 Test Loss: 1.472 Test Acc: 0.857
Validation loss decreased (-0.756740 --> -0.856742).  Saving model ...
Epoch: 7 cost time: 10.499235391616821
Epoch: 7, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.280 Vali Acc: 0.884 Test Loss: 1.280 Test Acc: 0.884
Validation loss decreased (-0.856742 --> -0.883771).  Saving model ...
Epoch: 8 cost time: 9.609585046768188
Epoch: 8, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.096 Vali Acc: 0.886 Test Loss: 1.096 Test Acc: 0.886
Validation loss decreased (-0.883771 --> -0.886476).  Saving model ...
Epoch: 9 cost time: 10.15454626083374
Epoch: 9, Steps: 17 | Train Loss: 1.023 Vali Loss: 0.890 Vali Acc: 0.905 Test Loss: 0.890 Test Acc: 0.905
Validation loss decreased (-0.886476 --> -0.905397).  Saving model ...
Epoch: 10 cost time: 11.426055431365967
Epoch: 10, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.751 Vali Acc: 0.900 Test Loss: 0.751 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.00890064239502
Epoch: 11, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.595 Vali Acc: 0.919 Test Loss: 0.595 Test Acc: 0.919
Validation loss decreased (-0.905397 --> -0.918913).  Saving model ...
Epoch: 12 cost time: 11.157149314880371
Epoch: 12, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.479 Vali Acc: 0.938 Test Loss: 0.479 Test Acc: 0.938
Validation loss decreased (-0.918913 --> -0.937833).  Saving model ...
Epoch: 13 cost time: 11.085654258728027
Epoch: 13, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.390 Vali Acc: 0.954 Test Loss: 0.390 Test Acc: 0.954
Validation loss decreased (-0.937833 --> -0.954050).  Saving model ...
Epoch: 14 cost time: 10.554839849472046
Epoch: 14, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.409 Vali Acc: 0.914 Test Loss: 0.409 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.188510417938232
Epoch: 15, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.282 Vali Acc: 0.957 Test Loss: 0.282 Test Acc: 0.957
Validation loss decreased (-0.954050 --> -0.956754).  Saving model ...
Epoch: 16 cost time: 10.867544889450073
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.280 Vali Acc: 0.946 Test Loss: 0.280 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.512256860733032
Epoch: 17, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.246 Vali Acc: 0.959 Test Loss: 0.246 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 18 cost time: 10.994367122650146
Epoch: 18, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.206 Vali Acc: 0.965 Test Loss: 0.206 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 19 cost time: 9.745694160461426
Epoch: 19, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.9045729637146
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 10.123208999633789
Epoch: 21, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.527464151382446
Epoch: 22, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.713643074035645
Epoch: 23, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 10.56395959854126
Epoch: 24, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.441307544708252
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 10.302139043807983
Epoch: 26, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 9.85732102394104
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 9.886183500289917
Epoch: 28, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 10.532950401306152
Epoch: 29, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 10.163918495178223
Epoch: 30, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 591353
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.020402669906616
Epoch: 1, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.223 Vali Acc: 0.084 Test Loss: 2.223 Test Acc: 0.084
Validation loss decreased (inf --> -0.083762).  Saving model ...
Epoch: 2 cost time: 6.012907981872559
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.134 Vali Acc: 0.189 Test Loss: 2.134 Test Acc: 0.189
Validation loss decreased (-0.083762 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 5.560185194015503
Epoch: 3, Steps: 17 | Train Loss: 2.056 Vali Loss: 2.018 Vali Acc: 0.330 Test Loss: 2.018 Test Acc: 0.330
Validation loss decreased (-0.189168 --> -0.329710).  Saving model ...
Epoch: 4 cost time: 5.9901862144470215
Epoch: 4, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.883 Vali Acc: 0.481 Test Loss: 1.883 Test Acc: 0.481
Validation loss decreased (-0.329710 --> -0.481062).  Saving model ...
Epoch: 5 cost time: 5.712105751037598
Epoch: 5, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.728 Vali Acc: 0.608 Test Loss: 1.728 Test Acc: 0.608
Validation loss decreased (-0.481062 --> -0.608091).  Saving model ...
Epoch: 6 cost time: 5.887461423873901
Epoch: 6, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.566 Vali Acc: 0.722 Test Loss: 1.566 Test Acc: 0.722
Validation loss decreased (-0.608091 --> -0.721606).  Saving model ...
Epoch: 7 cost time: 6.019711971282959
Epoch: 7, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.395 Vali Acc: 0.773 Test Loss: 1.395 Test Acc: 0.773
Validation loss decreased (-0.721606 --> -0.772959).  Saving model ...
Epoch: 8 cost time: 6.487523555755615
Epoch: 8, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.217 Vali Acc: 0.843 Test Loss: 1.217 Test Acc: 0.843
Validation loss decreased (-0.772959 --> -0.843231).  Saving model ...
Epoch: 9 cost time: 6.007780313491821
Epoch: 9, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.074 Vali Acc: 0.846 Test Loss: 1.074 Test Acc: 0.846
Validation loss decreased (-0.843231 --> -0.845935).  Saving model ...
Epoch: 10 cost time: 6.5543224811553955
Epoch: 10, Steps: 17 | Train Loss: 0.956 Vali Loss: 0.929 Vali Acc: 0.878 Test Loss: 0.929 Test Acc: 0.878
Validation loss decreased (-0.845935 --> -0.878369).  Saving model ...
Epoch: 11 cost time: 6.4742443561553955
Epoch: 11, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.807 Vali Acc: 0.895 Test Loss: 0.807 Test Acc: 0.895
Validation loss decreased (-0.878369 --> -0.894587).  Saving model ...
Epoch: 12 cost time: 5.683846473693848
Epoch: 12, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.711 Vali Acc: 0.903 Test Loss: 0.711 Test Acc: 0.903
Validation loss decreased (-0.894587 --> -0.902696).  Saving model ...
Epoch: 13 cost time: 6.684389591217041
Epoch: 13, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.621 Vali Acc: 0.914 Test Loss: 0.621 Test Acc: 0.914
Validation loss decreased (-0.902696 --> -0.913507).  Saving model ...
Epoch: 14 cost time: 6.323157548904419
Epoch: 14, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.542 Vali Acc: 0.932 Test Loss: 0.542 Test Acc: 0.932
Validation loss decreased (-0.913507 --> -0.932427).  Saving model ...
Epoch: 15 cost time: 5.989904165267944
Epoch: 15, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.469 Vali Acc: 0.946 Test Loss: 0.469 Test Acc: 0.946
Validation loss decreased (-0.932427 --> -0.945941).  Saving model ...
Epoch: 16 cost time: 5.927887916564941
Epoch: 16, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.403 Vali Acc: 0.949 Test Loss: 0.403 Test Acc: 0.949
Validation loss decreased (-0.945941 --> -0.948645).  Saving model ...
Epoch: 17 cost time: 6.393157005310059
Epoch: 17, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.341 Vali Acc: 0.954 Test Loss: 0.341 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 18 cost time: 6.222091197967529
Epoch: 18, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.308 Vali Acc: 0.951 Test Loss: 0.308 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.61092209815979
Epoch: 19, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.277 Vali Acc: 0.957 Test Loss: 0.277 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 20 cost time: 5.806787014007568
Epoch: 20, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.228 Vali Acc: 0.973 Test Loss: 0.228 Test Acc: 0.973
Validation loss decreased (-0.956754 --> -0.972971).  Saving model ...
Epoch: 21 cost time: 5.663703441619873
Epoch: 21, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.221 Vali Acc: 0.968 Test Loss: 0.221 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.5493481159210205
Epoch: 22, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972971).  Saving model ...
Epoch: 23 cost time: 6.353166341781616
Epoch: 23, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.701974868774414
Epoch: 24, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.045469284057617
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.418479681015015
Epoch: 26, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.761789321899414
Epoch: 27, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.459740400314331
Epoch: 28, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.772978067398071
Epoch: 29, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.223256587982178
Epoch: 30, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 177401
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.249708890914917
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 2.172 Vali Acc: 0.122 Test Loss: 2.172 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 6.611843109130859
Epoch: 2, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.092 Vali Acc: 0.214 Test Loss: 2.092 Test Acc: 0.214
Validation loss decreased (-0.121600 --> -0.213493).  Saving model ...
Epoch: 3 cost time: 7.310169219970703
Epoch: 3, Steps: 17 | Train Loss: 2.098 Vali Loss: 1.986 Vali Acc: 0.416 Test Loss: 1.986 Test Acc: 0.416
Validation loss decreased (-0.213493 --> -0.416196).  Saving model ...
Epoch: 4 cost time: 7.282602071762085
Epoch: 4, Steps: 17 | Train Loss: 1.956 Vali Loss: 1.857 Vali Acc: 0.578 Test Loss: 1.857 Test Acc: 0.578
Validation loss decreased (-0.416196 --> -0.578360).  Saving model ...
Epoch: 5 cost time: 6.66792893409729
Epoch: 5, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.707 Vali Acc: 0.735 Test Loss: 1.707 Test Acc: 0.735
Validation loss decreased (-0.578360 --> -0.735118).  Saving model ...
Epoch: 6 cost time: 6.082536697387695
Epoch: 6, Steps: 17 | Train Loss: 1.657 Vali Loss: 1.536 Vali Acc: 0.835 Test Loss: 1.536 Test Acc: 0.835
Validation loss decreased (-0.735118 --> -0.835120).  Saving model ...
Epoch: 7 cost time: 5.657172679901123
Epoch: 7, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.363 Vali Acc: 0.873 Test Loss: 1.363 Test Acc: 0.873
Validation loss decreased (-0.835120 --> -0.872959).  Saving model ...
Epoch: 8 cost time: 5.710019826889038
Epoch: 8, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.195 Vali Acc: 0.878 Test Loss: 1.195 Test Acc: 0.878
Validation loss decreased (-0.872959 --> -0.878366).  Saving model ...
Epoch: 9 cost time: 5.6874918937683105
Epoch: 9, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.028 Vali Acc: 0.903 Test Loss: 1.028 Test Acc: 0.903
Validation loss decreased (-0.878366 --> -0.902692).  Saving model ...
Epoch: 10 cost time: 6.096758127212524
Epoch: 10, Steps: 17 | Train Loss: 0.922 Vali Loss: 0.865 Vali Acc: 0.927 Test Loss: 0.865 Test Acc: 0.927
Validation loss decreased (-0.902692 --> -0.927018).  Saving model ...
Epoch: 11 cost time: 6.117499589920044
Epoch: 11, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.720 Vali Acc: 0.943 Test Loss: 0.720 Test Acc: 0.943
Validation loss decreased (-0.927018 --> -0.943236).  Saving model ...
Epoch: 12 cost time: 6.307676553726196
Epoch: 12, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.611 Vali Acc: 0.946 Test Loss: 0.611 Test Acc: 0.946
Validation loss decreased (-0.943236 --> -0.945940).  Saving model ...
Epoch: 13 cost time: 6.793506383895874
Epoch: 13, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.510 Vali Acc: 0.957 Test Loss: 0.510 Test Acc: 0.957
Validation loss decreased (-0.945940 --> -0.956752).  Saving model ...
Epoch: 14 cost time: 6.798696279525757
Epoch: 14, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.463 Vali Acc: 0.949 Test Loss: 0.463 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.3418073654174805
Epoch: 15, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.378 Vali Acc: 0.959 Test Loss: 0.378 Test Acc: 0.959
Validation loss decreased (-0.956752 --> -0.959456).  Saving model ...
Epoch: 16 cost time: 6.323643922805786
Epoch: 16, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.344 Vali Acc: 0.954 Test Loss: 0.344 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.662794828414917
Epoch: 17, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.302 Vali Acc: 0.959 Test Loss: 0.302 Test Acc: 0.959
Validation loss decreased (-0.959456 --> -0.959456).  Saving model ...
Epoch: 18 cost time: 6.412317991256714
Epoch: 18, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.256 Vali Acc: 0.965 Test Loss: 0.256 Test Acc: 0.965
Validation loss decreased (-0.959456 --> -0.964862).  Saving model ...
Epoch: 19 cost time: 6.294181823730469
Epoch: 19, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.246 Vali Acc: 0.962 Test Loss: 0.246 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.85505223274231
Epoch: 20, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.211 Vali Acc: 0.968 Test Loss: 0.211 Test Acc: 0.968
Validation loss decreased (-0.964862 --> -0.967565).  Saving model ...
Epoch: 21 cost time: 6.618569850921631
Epoch: 21, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.195 Vali Acc: 0.968 Test Loss: 0.195 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 6.306274652481079
Epoch: 22, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.575243234634399
Epoch: 23, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 6.196538925170898
Epoch: 24, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.686805725097656
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.429127216339111
Epoch: 26, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 6.503957986831665
Epoch: 27, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.1646728515625
Epoch: 28, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.281070947647095
Epoch: 29, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 6.792446851730347
Epoch: 30, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 591353
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.299037218093872
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.222 Vali Acc: 0.081 Test Loss: 2.222 Test Acc: 0.081
Validation loss decreased (inf --> -0.081059).  Saving model ...
Epoch: 2 cost time: 4.614948987960815
Epoch: 2, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.135 Vali Acc: 0.186 Test Loss: 2.135 Test Acc: 0.186
Validation loss decreased (-0.081059 --> -0.186465).  Saving model ...
Epoch: 3 cost time: 5.039200782775879
Epoch: 3, Steps: 17 | Train Loss: 2.058 Vali Loss: 2.021 Vali Acc: 0.330 Test Loss: 2.021 Test Acc: 0.330
Validation loss decreased (-0.186465 --> -0.329710).  Saving model ...
Epoch: 4 cost time: 4.751775026321411
Epoch: 4, Steps: 17 | Train Loss: 1.954 Vali Loss: 1.889 Vali Acc: 0.473 Test Loss: 1.889 Test Acc: 0.473
Validation loss decreased (-0.329710 --> -0.472954).  Saving model ...
Epoch: 5 cost time: 4.667013168334961
Epoch: 5, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.738 Vali Acc: 0.605 Test Loss: 1.738 Test Acc: 0.605
Validation loss decreased (-0.472954 --> -0.605388).  Saving model ...
Epoch: 6 cost time: 4.710079193115234
Epoch: 6, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.583 Vali Acc: 0.689 Test Loss: 1.583 Test Acc: 0.689
Validation loss decreased (-0.605388 --> -0.689173).  Saving model ...
Epoch: 7 cost time: 5.097160816192627
Epoch: 7, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.422 Vali Acc: 0.754 Test Loss: 1.422 Test Acc: 0.754
Validation loss decreased (-0.689173 --> -0.754040).  Saving model ...
Epoch: 8 cost time: 4.748445987701416
Epoch: 8, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.260 Vali Acc: 0.819 Test Loss: 1.260 Test Acc: 0.819
Validation loss decreased (-0.754040 --> -0.818906).  Saving model ...
Epoch: 9 cost time: 4.686228036880493
Epoch: 9, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.128 Vali Acc: 0.830 Test Loss: 1.128 Test Acc: 0.830
Validation loss decreased (-0.818906 --> -0.829718).  Saving model ...
Epoch: 10 cost time: 5.0363640785217285
Epoch: 10, Steps: 17 | Train Loss: 1.011 Vali Loss: 0.999 Vali Acc: 0.873 Test Loss: 0.999 Test Acc: 0.873
Validation loss decreased (-0.829718 --> -0.872963).  Saving model ...
Epoch: 11 cost time: 4.8228349685668945
Epoch: 11, Steps: 17 | Train Loss: 0.897 Vali Loss: 0.882 Vali Acc: 0.886 Test Loss: 0.882 Test Acc: 0.886
Validation loss decreased (-0.872963 --> -0.886478).  Saving model ...
Epoch: 12 cost time: 4.729433298110962
Epoch: 12, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.779 Vali Acc: 0.908 Test Loss: 0.779 Test Acc: 0.908
Validation loss decreased (-0.886478 --> -0.908100).  Saving model ...
Epoch: 13 cost time: 4.760481119155884
Epoch: 13, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.684 Vali Acc: 0.932 Test Loss: 0.684 Test Acc: 0.932
Validation loss decreased (-0.908100 --> -0.932426).  Saving model ...
Epoch: 14 cost time: 4.745464324951172
Epoch: 14, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.601 Vali Acc: 0.941 Test Loss: 0.601 Test Acc: 0.941
Validation loss decreased (-0.932426 --> -0.940535).  Saving model ...
Epoch: 15 cost time: 4.919350624084473
Epoch: 15, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.516 Vali Acc: 0.951 Test Loss: 0.516 Test Acc: 0.951
Validation loss decreased (-0.940535 --> -0.951346).  Saving model ...
Epoch: 16 cost time: 4.388842344284058
Epoch: 16, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.457 Vali Acc: 0.954 Test Loss: 0.457 Test Acc: 0.954
Validation loss decreased (-0.951346 --> -0.954049).  Saving model ...
Epoch: 17 cost time: 4.711461305618286
Epoch: 17, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.398 Vali Acc: 0.962 Test Loss: 0.398 Test Acc: 0.962
Validation loss decreased (-0.954049 --> -0.962158).  Saving model ...
Epoch: 18 cost time: 4.666887283325195
Epoch: 18, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.352 Vali Acc: 0.959 Test Loss: 0.352 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.646753787994385
Epoch: 19, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.319 Vali Acc: 0.962 Test Loss: 0.319 Test Acc: 0.962
Validation loss decreased (-0.962158 --> -0.962159).  Saving model ...
Epoch: 20 cost time: 4.673560380935669
Epoch: 20, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.272 Vali Acc: 0.965 Test Loss: 0.272 Test Acc: 0.965
Validation loss decreased (-0.962159 --> -0.964862).  Saving model ...
Epoch: 21 cost time: 4.442613124847412
Epoch: 21, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.253 Vali Acc: 0.962 Test Loss: 0.253 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.667222738265991
Epoch: 22, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.230 Vali Acc: 0.965 Test Loss: 0.230 Test Acc: 0.965
Validation loss decreased (-0.964862 --> -0.964863).  Saving model ...
Epoch: 23 cost time: 5.256402254104614
Epoch: 23, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 5.068567991256714
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.803285837173462
Epoch: 25, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.17427659034729
Epoch: 26, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.172 Vali Acc: 0.968 Test Loss: 0.172 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 5.3508875370025635
Epoch: 27, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 4.816885471343994
Epoch: 28, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.780503749847412
Epoch: 29, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.212160587310791
Epoch: 30, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 177401
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.391830682754517
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.195 Vali Acc: 0.116 Test Loss: 2.195 Test Acc: 0.116
Validation loss decreased (inf --> -0.116194).  Saving model ...
Epoch: 2 cost time: 6.46513557434082
Epoch: 2, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.131 Vali Acc: 0.181 Test Loss: 2.131 Test Acc: 0.181
Validation loss decreased (-0.116194 --> -0.181060).  Saving model ...
Epoch: 3 cost time: 6.35283899307251
Epoch: 3, Steps: 17 | Train Loss: 2.103 Vali Loss: 2.040 Vali Acc: 0.314 Test Loss: 2.040 Test Acc: 0.314
Validation loss decreased (-0.181060 --> -0.313493).  Saving model ...
Epoch: 4 cost time: 5.2918455600738525
Epoch: 4, Steps: 17 | Train Loss: 1.995 Vali Loss: 1.929 Vali Acc: 0.435 Test Loss: 1.929 Test Acc: 0.435
Validation loss decreased (-0.313493 --> -0.435116).  Saving model ...
Epoch: 5 cost time: 5.963271856307983
Epoch: 5, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.790 Vali Acc: 0.584 Test Loss: 1.790 Test Acc: 0.584
Validation loss decreased (-0.435116 --> -0.583766).  Saving model ...
Epoch: 6 cost time: 5.716215133666992
Epoch: 6, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.657 Vali Acc: 0.676 Test Loss: 1.657 Test Acc: 0.676
Validation loss decreased (-0.583766 --> -0.675659).  Saving model ...
Epoch: 7 cost time: 5.322821617126465
Epoch: 7, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.508 Vali Acc: 0.711 Test Loss: 1.508 Test Acc: 0.711
Validation loss decreased (-0.675659 --> -0.710796).  Saving model ...
Epoch: 8 cost time: 5.6578309535980225
Epoch: 8, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.379 Vali Acc: 0.743 Test Loss: 1.379 Test Acc: 0.743
Validation loss decreased (-0.710796 --> -0.743229).  Saving model ...
Epoch: 9 cost time: 5.752587080001831
Epoch: 9, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.234 Vali Acc: 0.751 Test Loss: 1.234 Test Acc: 0.751
Validation loss decreased (-0.743229 --> -0.751339).  Saving model ...
Epoch: 10 cost time: 5.506118059158325
Epoch: 10, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.120 Vali Acc: 0.765 Test Loss: 1.120 Test Acc: 0.765
Validation loss decreased (-0.751339 --> -0.764854).  Saving model ...
Epoch: 11 cost time: 6.026621103286743
Epoch: 11, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.011 Vali Acc: 0.784 Test Loss: 1.011 Test Acc: 0.784
Validation loss decreased (-0.764854 --> -0.783774).  Saving model ...
Epoch: 12 cost time: 6.059348106384277
Epoch: 12, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.941 Vali Acc: 0.814 Test Loss: 0.941 Test Acc: 0.814
Validation loss decreased (-0.783774 --> -0.813504).  Saving model ...
Epoch: 13 cost time: 5.55577826499939
Epoch: 13, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.839 Vali Acc: 0.830 Test Loss: 0.839 Test Acc: 0.830
Validation loss decreased (-0.813504 --> -0.829721).  Saving model ...
Epoch: 14 cost time: 5.9359352588653564
Epoch: 14, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.786 Vali Acc: 0.816 Test Loss: 0.786 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.870568752288818
Epoch: 15, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.709 Vali Acc: 0.841 Test Loss: 0.709 Test Acc: 0.841
Validation loss decreased (-0.829721 --> -0.840533).  Saving model ...
Epoch: 16 cost time: 5.521069526672363
Epoch: 16, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.665 Vali Acc: 0.865 Test Loss: 0.665 Test Acc: 0.865
Validation loss decreased (-0.840533 --> -0.864858).  Saving model ...
Epoch: 17 cost time: 6.04714822769165
Epoch: 17, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.574 Vali Acc: 0.895 Test Loss: 0.574 Test Acc: 0.895
Validation loss decreased (-0.864858 --> -0.894589).  Saving model ...
Epoch: 18 cost time: 5.9991490840911865
Epoch: 18, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.531 Vali Acc: 0.889 Test Loss: 0.531 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.760277032852173
Epoch: 19, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.545 Vali Acc: 0.865 Test Loss: 0.545 Test Acc: 0.865
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.686398267745972
Epoch: 20, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.532 Vali Acc: 0.843 Test Loss: 0.532 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.213465452194214
Epoch: 21, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.471 Vali Acc: 0.884 Test Loss: 0.471 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.862401485443115
Epoch: 22, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.731908321380615
Epoch: 23, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.431 Vali Acc: 0.870 Test Loss: 0.431 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.568648099899292
Epoch: 24, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.402 Vali Acc: 0.892 Test Loss: 0.402 Test Acc: 0.892
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.476412773132324
Epoch: 25, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.661860942840576
Epoch: 26, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.320466995239258
Epoch: 27, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.374 Vali Acc: 0.876 Test Loss: 0.374 Test Acc: 0.876
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.8945945945945946
model parameter : 1175617
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.038231372833252
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.212 Vali Acc: 0.122 Test Loss: 2.212 Test Acc: 0.122
Validation loss decreased (inf --> -0.121599).  Saving model ...
Epoch: 2 cost time: 5.533451795578003
Epoch: 2, Steps: 17 | Train Loss: 2.151 Vali Loss: 2.159 Vali Acc: 0.165 Test Loss: 2.159 Test Acc: 0.165
Validation loss decreased (-0.121599 --> -0.164843).  Saving model ...
Epoch: 3 cost time: 4.6204893589019775
Epoch: 3, Steps: 17 | Train Loss: 2.087 Vali Loss: 2.089 Vali Acc: 0.224 Test Loss: 2.089 Test Acc: 0.224
Validation loss decreased (-0.164843 --> -0.224303).  Saving model ...
Epoch: 4 cost time: 5.40559983253479
Epoch: 4, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.999 Vali Acc: 0.330 Test Loss: 1.999 Test Acc: 0.330
Validation loss decreased (-0.224303 --> -0.329710).  Saving model ...
Epoch: 5 cost time: 5.449444532394409
Epoch: 5, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.890 Vali Acc: 0.470 Test Loss: 1.890 Test Acc: 0.470
Validation loss decreased (-0.329710 --> -0.470251).  Saving model ...
Epoch: 6 cost time: 5.321715354919434
Epoch: 6, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.758 Vali Acc: 0.584 Test Loss: 1.758 Test Acc: 0.584
Validation loss decreased (-0.470251 --> -0.583766).  Saving model ...
Epoch: 7 cost time: 5.338009357452393
Epoch: 7, Steps: 17 | Train Loss: 1.643 Vali Loss: 1.616 Vali Acc: 0.659 Test Loss: 1.616 Test Acc: 0.659
Validation loss decreased (-0.583766 --> -0.659443).  Saving model ...
Epoch: 8 cost time: 4.940951585769653
Epoch: 8, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.465 Vali Acc: 0.708 Test Loss: 1.465 Test Acc: 0.708
Validation loss decreased (-0.659443 --> -0.708093).  Saving model ...
Epoch: 9 cost time: 5.308039665222168
Epoch: 9, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.325 Vali Acc: 0.765 Test Loss: 1.325 Test Acc: 0.765
Validation loss decreased (-0.708093 --> -0.764852).  Saving model ...
Epoch: 10 cost time: 5.2704832553863525
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.190 Vali Acc: 0.795 Test Loss: 1.190 Test Acc: 0.795
Validation loss decreased (-0.764852 --> -0.794583).  Saving model ...
Epoch: 11 cost time: 5.250638723373413
Epoch: 11, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.066 Vali Acc: 0.814 Test Loss: 1.066 Test Acc: 0.814
Validation loss decreased (-0.794583 --> -0.813503).  Saving model ...
Epoch: 12 cost time: 5.36925196647644
Epoch: 12, Steps: 17 | Train Loss: 0.939 Vali Loss: 0.976 Vali Acc: 0.841 Test Loss: 0.976 Test Acc: 0.841
Validation loss decreased (-0.813503 --> -0.840531).  Saving model ...
Epoch: 13 cost time: 4.648861408233643
Epoch: 13, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.804 Vali Acc: 0.892 Test Loss: 0.804 Test Acc: 0.892
Validation loss decreased (-0.840531 --> -0.891884).  Saving model ...
Epoch: 14 cost time: 4.695312738418579
Epoch: 14, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.715 Vali Acc: 0.886 Test Loss: 0.715 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.63811182975769
Epoch: 15, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.619 Vali Acc: 0.897 Test Loss: 0.619 Test Acc: 0.897
Validation loss decreased (-0.891884 --> -0.897291).  Saving model ...
Epoch: 16 cost time: 4.83194899559021
Epoch: 16, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.592 Vali Acc: 0.881 Test Loss: 0.592 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.193691253662109
Epoch: 17, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.516 Vali Acc: 0.935 Test Loss: 0.516 Test Acc: 0.935
Validation loss decreased (-0.897291 --> -0.935130).  Saving model ...
Epoch: 18 cost time: 5.1226935386657715
Epoch: 18, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.468 Vali Acc: 0.908 Test Loss: 0.468 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.566301345825195
Epoch: 19, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.400 Vali Acc: 0.946 Test Loss: 0.400 Test Acc: 0.946
Validation loss decreased (-0.935130 --> -0.945942).  Saving model ...
Epoch: 20 cost time: 5.024730682373047
Epoch: 20, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.379 Vali Acc: 0.943 Test Loss: 0.379 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.916004419326782
Epoch: 21, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.360 Vali Acc: 0.941 Test Loss: 0.360 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.976663589477539
Epoch: 22, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.304 Vali Acc: 0.949 Test Loss: 0.304 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 4.779903411865234
Epoch: 23, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.9398157596588135
Epoch: 24, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.288 Vali Acc: 0.938 Test Loss: 0.288 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.7630534172058105
Epoch: 25, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.655801296234131
Epoch: 26, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.248 Vali Acc: 0.949 Test Loss: 0.248 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 27 cost time: 4.8404645919799805
Epoch: 27, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.259 Vali Acc: 0.935 Test Loss: 0.259 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.622642517089844
Epoch: 28, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.246 Vali Acc: 0.943 Test Loss: 0.246 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.87199068069458
Epoch: 29, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 30 cost time: 4.597666501998901
Epoch: 30, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 347649
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.081302642822266
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.196 Vali Acc: 0.116 Test Loss: 2.196 Test Acc: 0.116
Validation loss decreased (inf --> -0.116194).  Saving model ...
Epoch: 2 cost time: 3.687307834625244
Epoch: 2, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.132 Vali Acc: 0.176 Test Loss: 2.132 Test Acc: 0.176
Validation loss decreased (-0.116194 --> -0.175654).  Saving model ...
Epoch: 3 cost time: 4.197976350784302
Epoch: 3, Steps: 17 | Train Loss: 2.105 Vali Loss: 2.040 Vali Acc: 0.314 Test Loss: 2.040 Test Acc: 0.314
Validation loss decreased (-0.175654 --> -0.313493).  Saving model ...
Epoch: 4 cost time: 4.284964561462402
Epoch: 4, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.928 Vali Acc: 0.435 Test Loss: 1.928 Test Acc: 0.435
Validation loss decreased (-0.313493 --> -0.435116).  Saving model ...
Epoch: 5 cost time: 4.5756213665008545
Epoch: 5, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.784 Vali Acc: 0.592 Test Loss: 1.784 Test Acc: 0.592
Validation loss decreased (-0.435116 --> -0.591874).  Saving model ...
Epoch: 6 cost time: 4.6878790855407715
Epoch: 6, Steps: 17 | Train Loss: 1.723 Vali Loss: 1.653 Vali Acc: 0.668 Test Loss: 1.653 Test Acc: 0.668
Validation loss decreased (-0.591874 --> -0.667551).  Saving model ...
Epoch: 7 cost time: 4.991898775100708
Epoch: 7, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.501 Vali Acc: 0.714 Test Loss: 1.501 Test Acc: 0.714
Validation loss decreased (-0.667551 --> -0.713499).  Saving model ...
Epoch: 8 cost time: 4.700357437133789
Epoch: 8, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.372 Vali Acc: 0.735 Test Loss: 1.372 Test Acc: 0.735
Validation loss decreased (-0.713499 --> -0.735121).  Saving model ...
Epoch: 9 cost time: 5.032784938812256
Epoch: 9, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.224 Vali Acc: 0.749 Test Loss: 1.224 Test Acc: 0.749
Validation loss decreased (-0.735121 --> -0.748636).  Saving model ...
Epoch: 10 cost time: 4.766383647918701
Epoch: 10, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.101 Vali Acc: 0.778 Test Loss: 1.101 Test Acc: 0.778
Validation loss decreased (-0.748636 --> -0.778367).  Saving model ...
Epoch: 11 cost time: 4.708427667617798
Epoch: 11, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.001 Vali Acc: 0.803 Test Loss: 1.001 Test Acc: 0.803
Validation loss decreased (-0.778367 --> -0.802693).  Saving model ...
Epoch: 12 cost time: 5.179081678390503
Epoch: 12, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.906 Vali Acc: 0.832 Test Loss: 0.906 Test Acc: 0.832
Validation loss decreased (-0.802693 --> -0.832423).  Saving model ...
Epoch: 13 cost time: 4.530575752258301
Epoch: 13, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.802 Vali Acc: 0.857 Test Loss: 0.802 Test Acc: 0.857
Validation loss decreased (-0.832423 --> -0.856749).  Saving model ...
Epoch: 14 cost time: 4.907848834991455
Epoch: 14, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.770 Vali Acc: 0.835 Test Loss: 0.770 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.095662593841553
Epoch: 15, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.671 Vali Acc: 0.876 Test Loss: 0.671 Test Acc: 0.876
Validation loss decreased (-0.856749 --> -0.875669).  Saving model ...
Epoch: 16 cost time: 4.640036582946777
Epoch: 16, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
Validation loss decreased (-0.875669 --> -0.878372).  Saving model ...
Epoch: 17 cost time: 4.632717609405518
Epoch: 17, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.557 Vali Acc: 0.895 Test Loss: 0.557 Test Acc: 0.895
Validation loss decreased (-0.878372 --> -0.894589).  Saving model ...
Epoch: 18 cost time: 4.845873594284058
Epoch: 18, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.482 Vali Acc: 0.916 Test Loss: 0.482 Test Acc: 0.916
Validation loss decreased (-0.894589 --> -0.916211).  Saving model ...
Epoch: 19 cost time: 4.365341901779175
Epoch: 19, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.513 Vali Acc: 0.865 Test Loss: 0.513 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.495888710021973
Epoch: 20, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.363532543182373
Epoch: 21, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.468 Vali Acc: 0.859 Test Loss: 0.468 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.188357830047607
Epoch: 22, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.383 Vali Acc: 0.908 Test Loss: 0.383 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.019042253494263
Epoch: 23, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.018848657608032
Epoch: 24, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.406 Vali Acc: 0.876 Test Loss: 0.406 Test Acc: 0.876
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.095725059509277
Epoch: 25, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.397 Vali Acc: 0.886 Test Loss: 0.397 Test Acc: 0.886
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.399852991104126
Epoch: 26, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5532095432281494
Epoch: 27, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.345106363296509
Epoch: 28, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.391 Vali Acc: 0.868 Test Loss: 0.391 Test Acc: 0.868
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9162162162162162
model parameter : 1175617
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.088881731033325
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.213 Vali Acc: 0.122 Test Loss: 2.213 Test Acc: 0.122
Validation loss decreased (inf --> -0.121599).  Saving model ...
Epoch: 2 cost time: 4.216710090637207
Epoch: 2, Steps: 17 | Train Loss: 2.153 Vali Loss: 2.162 Vali Acc: 0.162 Test Loss: 2.162 Test Acc: 0.162
Validation loss decreased (-0.121599 --> -0.162141).  Saving model ...
Epoch: 3 cost time: 4.020471572875977
Epoch: 3, Steps: 17 | Train Loss: 2.092 Vali Loss: 2.094 Vali Acc: 0.216 Test Loss: 2.094 Test Acc: 0.216
Validation loss decreased (-0.162141 --> -0.216195).  Saving model ...
Epoch: 4 cost time: 4.111140489578247
Epoch: 4, Steps: 17 | Train Loss: 2.021 Vali Loss: 2.010 Vali Acc: 0.324 Test Loss: 2.010 Test Acc: 0.324
Validation loss decreased (-0.216195 --> -0.324304).  Saving model ...
Epoch: 5 cost time: 4.196545600891113
Epoch: 5, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.911 Vali Acc: 0.446 Test Loss: 1.911 Test Acc: 0.446
Validation loss decreased (-0.324304 --> -0.445927).  Saving model ...
Epoch: 6 cost time: 4.160843372344971
Epoch: 6, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.800 Vali Acc: 0.541 Test Loss: 1.800 Test Acc: 0.541
Validation loss decreased (-0.445927 --> -0.540523).  Saving model ...
Epoch: 7 cost time: 4.029011249542236
Epoch: 7, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.677 Vali Acc: 0.635 Test Loss: 1.677 Test Acc: 0.635
Validation loss decreased (-0.540523 --> -0.635118).  Saving model ...
Epoch: 8 cost time: 4.569445371627808
Epoch: 8, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.527 Vali Acc: 0.692 Test Loss: 1.527 Test Acc: 0.692
Validation loss decreased (-0.635118 --> -0.691877).  Saving model ...
Epoch: 9 cost time: 4.402654409408569
Epoch: 9, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.369 Vali Acc: 0.746 Test Loss: 1.369 Test Acc: 0.746
Validation loss decreased (-0.691877 --> -0.745932).  Saving model ...
Epoch: 10 cost time: 4.341766834259033
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.229 Vali Acc: 0.786 Test Loss: 1.229 Test Acc: 0.786
Validation loss decreased (-0.745932 --> -0.786474).  Saving model ...
Epoch: 11 cost time: 4.578388452529907
Epoch: 11, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.095 Vali Acc: 0.803 Test Loss: 1.095 Test Acc: 0.803
Validation loss decreased (-0.786474 --> -0.802692).  Saving model ...
Epoch: 12 cost time: 4.322406768798828
Epoch: 12, Steps: 17 | Train Loss: 0.979 Vali Loss: 0.995 Vali Acc: 0.816 Test Loss: 0.995 Test Acc: 0.816
Validation loss decreased (-0.802692 --> -0.816206).  Saving model ...
Epoch: 13 cost time: 4.343672513961792
Epoch: 13, Steps: 17 | Train Loss: 0.889 Vali Loss: 0.827 Vali Acc: 0.886 Test Loss: 0.827 Test Acc: 0.886
Validation loss decreased (-0.816206 --> -0.886478).  Saving model ...
Epoch: 14 cost time: 4.562276124954224
Epoch: 14, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.742 Vali Acc: 0.884 Test Loss: 0.742 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.427968740463257
Epoch: 15, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.646 Vali Acc: 0.903 Test Loss: 0.646 Test Acc: 0.903
Validation loss decreased (-0.886478 --> -0.902696).  Saving model ...
Epoch: 16 cost time: 4.489438533782959
Epoch: 16, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.608 Vali Acc: 0.886 Test Loss: 0.608 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.82687520980835
Epoch: 17, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.536 Vali Acc: 0.919 Test Loss: 0.536 Test Acc: 0.919
Validation loss decreased (-0.902696 --> -0.918914).  Saving model ...
Epoch: 18 cost time: 4.649326324462891
Epoch: 18, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.486 Vali Acc: 0.897 Test Loss: 0.486 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.373644828796387
Epoch: 19, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.417 Vali Acc: 0.932 Test Loss: 0.417 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932428).  Saving model ...
Epoch: 20 cost time: 4.16176176071167
Epoch: 20, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.404 Vali Acc: 0.932 Test Loss: 0.404 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932428).  Saving model ...
Epoch: 21 cost time: 4.486911296844482
Epoch: 21, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.374 Vali Acc: 0.932 Test Loss: 0.374 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 22 cost time: 4.31194543838501
Epoch: 22, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940537).  Saving model ...
Epoch: 23 cost time: 4.432521343231201
Epoch: 23, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.318 Vali Acc: 0.927 Test Loss: 0.318 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.61936616897583
Epoch: 24, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.381403923034668
Epoch: 25, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.266 Vali Acc: 0.949 Test Loss: 0.266 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 26 cost time: 4.505216598510742
Epoch: 26, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.254 Vali Acc: 0.949 Test Loss: 0.254 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 27 cost time: 4.719771862030029
Epoch: 27, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.261 Vali Acc: 0.927 Test Loss: 0.261 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.39189887046814
Epoch: 28, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.2421815395355225
Epoch: 29, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.433902025222778
Epoch: 30, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 347649
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.402954816818237
Epoch: 1, Steps: 17 | Train Loss: 2.229 Vali Loss: 2.198 Vali Acc: 0.114 Test Loss: 2.198 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 3.588630437850952
Epoch: 2, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.142 Vali Acc: 0.165 Test Loss: 2.142 Test Acc: 0.165
Validation loss decreased (-0.113492 --> -0.164843).  Saving model ...
Epoch: 3 cost time: 3.232494592666626
Epoch: 3, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.064 Vali Acc: 0.257 Test Loss: 2.064 Test Acc: 0.257
Validation loss decreased (-0.164843 --> -0.256736).  Saving model ...
Epoch: 4 cost time: 3.4330666065216064
Epoch: 4, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.976 Vali Acc: 0.373 Test Loss: 1.976 Test Acc: 0.373
Validation loss decreased (-0.256736 --> -0.372953).  Saving model ...
Epoch: 5 cost time: 3.6823620796203613
Epoch: 5, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.870 Vali Acc: 0.505 Test Loss: 1.870 Test Acc: 0.505
Validation loss decreased (-0.372953 --> -0.505387).  Saving model ...
Epoch: 6 cost time: 3.5279338359832764
Epoch: 6, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.762 Vali Acc: 0.616 Test Loss: 1.762 Test Acc: 0.616
Validation loss decreased (-0.505387 --> -0.616199).  Saving model ...
Epoch: 7 cost time: 3.5916695594787598
Epoch: 7, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.645 Vali Acc: 0.651 Test Loss: 1.645 Test Acc: 0.651
Validation loss decreased (-0.616199 --> -0.651335).  Saving model ...
Epoch: 8 cost time: 3.5484166145324707
Epoch: 8, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.535 Vali Acc: 0.684 Test Loss: 1.535 Test Acc: 0.684
Validation loss decreased (-0.651335 --> -0.683768).  Saving model ...
Epoch: 9 cost time: 3.752784252166748
Epoch: 9, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.424 Vali Acc: 0.711 Test Loss: 1.424 Test Acc: 0.711
Validation loss decreased (-0.683768 --> -0.710797).  Saving model ...
Epoch: 10 cost time: 3.5465922355651855
Epoch: 10, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.323 Vali Acc: 0.724 Test Loss: 1.323 Test Acc: 0.724
Validation loss decreased (-0.710797 --> -0.724311).  Saving model ...
Epoch: 11 cost time: 3.4801666736602783
Epoch: 11, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.225 Vali Acc: 0.759 Test Loss: 1.225 Test Acc: 0.759
Validation loss decreased (-0.724311 --> -0.759447).  Saving model ...
Epoch: 12 cost time: 3.823434591293335
Epoch: 12, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.135 Vali Acc: 0.776 Test Loss: 1.135 Test Acc: 0.776
Validation loss decreased (-0.759447 --> -0.775664).  Saving model ...
Epoch: 13 cost time: 3.655001640319824
Epoch: 13, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.062 Vali Acc: 0.805 Test Loss: 1.062 Test Acc: 0.805
Validation loss decreased (-0.775664 --> -0.805395).  Saving model ...
Epoch: 14 cost time: 3.532994031906128
Epoch: 14, Steps: 17 | Train Loss: 0.941 Vali Loss: 0.978 Vali Acc: 0.838 Test Loss: 0.978 Test Acc: 0.838
Validation loss decreased (-0.805395 --> -0.837828).  Saving model ...
Epoch: 15 cost time: 3.6423826217651367
Epoch: 15, Steps: 17 | Train Loss: 0.853 Vali Loss: 0.914 Vali Acc: 0.824 Test Loss: 0.914 Test Acc: 0.824
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6675519943237305
Epoch: 16, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.851 Vali Acc: 0.846 Test Loss: 0.851 Test Acc: 0.846
Validation loss decreased (-0.837828 --> -0.845937).  Saving model ...
Epoch: 17 cost time: 3.8180267810821533
Epoch: 17, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.807 Vali Acc: 0.849 Test Loss: 0.807 Test Acc: 0.849
Validation loss decreased (-0.845937 --> -0.848641).  Saving model ...
Epoch: 18 cost time: 3.4693806171417236
Epoch: 18, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.754 Vali Acc: 0.841 Test Loss: 0.754 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4750523567199707
Epoch: 19, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.737 Vali Acc: 0.843 Test Loss: 0.737 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.830202102661133
Epoch: 20, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.688 Vali Acc: 0.854 Test Loss: 0.688 Test Acc: 0.854
Validation loss decreased (-0.848641 --> -0.854047).  Saving model ...
Epoch: 21 cost time: 3.4732720851898193
Epoch: 21, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.619 Vali Acc: 0.859 Test Loss: 0.619 Test Acc: 0.859
Validation loss decreased (-0.854047 --> -0.859453).  Saving model ...
Epoch: 22 cost time: 3.3335323333740234
Epoch: 22, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.600 Vali Acc: 0.857 Test Loss: 0.600 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2864937782287598
Epoch: 23, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.572 Vali Acc: 0.857 Test Loss: 0.572 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7720401287078857
Epoch: 24, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
Validation loss decreased (-0.859453 --> -0.878373).  Saving model ...
Epoch: 25 cost time: 3.55182147026062
Epoch: 25, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.546 Vali Acc: 0.884 Test Loss: 0.546 Test Acc: 0.884
Validation loss decreased (-0.878373 --> -0.883778).  Saving model ...
Epoch: 26 cost time: 3.468702793121338
Epoch: 26, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.474 Vali Acc: 0.884 Test Loss: 0.474 Test Acc: 0.884
Validation loss decreased (-0.883778 --> -0.883779).  Saving model ...
Epoch: 27 cost time: 3.753234386444092
Epoch: 27, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.489 Vali Acc: 0.884 Test Loss: 0.489 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.818420171737671
Epoch: 28, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.442 Vali Acc: 0.897 Test Loss: 0.442 Test Acc: 0.897
Validation loss decreased (-0.883779 --> -0.897293).  Saving model ...
Epoch: 29 cost time: 3.7692935466766357
Epoch: 29, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.404 Vali Acc: 0.897 Test Loss: 0.404 Test Acc: 0.897
Validation loss decreased (-0.897293 --> -0.897293).  Saving model ...
Epoch: 30 cost time: 3.8350889682769775
Epoch: 30, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.400 Vali Acc: 0.914 Test Loss: 0.400 Test Acc: 0.914
Validation loss decreased (-0.897293 --> -0.913510).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9135135135135135
model parameter : 1175617
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.10903787612915
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.215 Vali Acc: 0.122 Test Loss: 2.215 Test Acc: 0.122
Validation loss decreased (inf --> -0.121599).  Saving model ...
Epoch: 2 cost time: 3.133002281188965
Epoch: 2, Steps: 17 | Train Loss: 2.155 Vali Loss: 2.165 Vali Acc: 0.162 Test Loss: 2.165 Test Acc: 0.162
Validation loss decreased (-0.121599 --> -0.162141).  Saving model ...
Epoch: 3 cost time: 3.3829760551452637
Epoch: 3, Steps: 17 | Train Loss: 2.096 Vali Loss: 2.099 Vali Acc: 0.216 Test Loss: 2.099 Test Acc: 0.216
Validation loss decreased (-0.162141 --> -0.216195).  Saving model ...
Epoch: 4 cost time: 3.341658353805542
Epoch: 4, Steps: 17 | Train Loss: 2.028 Vali Loss: 2.019 Vali Acc: 0.303 Test Loss: 2.019 Test Acc: 0.303
Validation loss decreased (-0.216195 --> -0.302683).  Saving model ...
Epoch: 5 cost time: 3.187669515609741
Epoch: 5, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.926 Vali Acc: 0.416 Test Loss: 1.926 Test Acc: 0.416
Validation loss decreased (-0.302683 --> -0.416197).  Saving model ...
Epoch: 6 cost time: 3.1393797397613525
Epoch: 6, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.830 Vali Acc: 0.495 Test Loss: 1.830 Test Acc: 0.495
Validation loss decreased (-0.416197 --> -0.494576).  Saving model ...
Epoch: 7 cost time: 3.390902519226074
Epoch: 7, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.732 Vali Acc: 0.562 Test Loss: 1.732 Test Acc: 0.562
Validation loss decreased (-0.494576 --> -0.562145).  Saving model ...
Epoch: 8 cost time: 3.176842451095581
Epoch: 8, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.628 Vali Acc: 0.616 Test Loss: 1.628 Test Acc: 0.616
Validation loss decreased (-0.562145 --> -0.616200).  Saving model ...
Epoch: 9 cost time: 3.1259984970092773
Epoch: 9, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.514 Vali Acc: 0.668 Test Loss: 1.514 Test Acc: 0.668
Validation loss decreased (-0.616200 --> -0.667552).  Saving model ...
Epoch: 10 cost time: 3.103182554244995
Epoch: 10, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.399 Vali Acc: 0.722 Test Loss: 1.399 Test Acc: 0.722
Validation loss decreased (-0.667552 --> -0.721608).  Saving model ...
Epoch: 11 cost time: 3.3579180240631104
Epoch: 11, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.289 Vali Acc: 0.759 Test Loss: 1.289 Test Acc: 0.759
Validation loss decreased (-0.721608 --> -0.759447).  Saving model ...
Epoch: 12 cost time: 3.3063220977783203
Epoch: 12, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.177 Vali Acc: 0.805 Test Loss: 1.177 Test Acc: 0.805
Validation loss decreased (-0.759447 --> -0.805394).  Saving model ...
Epoch: 13 cost time: 3.178487777709961
Epoch: 13, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.066 Vali Acc: 0.857 Test Loss: 1.066 Test Acc: 0.857
Validation loss decreased (-0.805394 --> -0.856746).  Saving model ...
Epoch: 14 cost time: 3.2740635871887207
Epoch: 14, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.967 Vali Acc: 0.886 Test Loss: 0.967 Test Acc: 0.886
Validation loss decreased (-0.856746 --> -0.886477).  Saving model ...
Epoch: 15 cost time: 3.480067253112793
Epoch: 15, Steps: 17 | Train Loss: 0.857 Vali Loss: 0.868 Vali Acc: 0.889 Test Loss: 0.868 Test Acc: 0.889
Validation loss decreased (-0.886477 --> -0.889181).  Saving model ...
Epoch: 16 cost time: 3.201047420501709
Epoch: 16, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.795 Vali Acc: 0.892 Test Loss: 0.795 Test Acc: 0.892
Validation loss decreased (-0.889181 --> -0.891884).  Saving model ...
Epoch: 17 cost time: 3.156024694442749
Epoch: 17, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.703 Vali Acc: 0.905 Test Loss: 0.703 Test Acc: 0.905
Validation loss decreased (-0.891884 --> -0.905398).  Saving model ...
Epoch: 18 cost time: 3.286198854446411
Epoch: 18, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.642 Vali Acc: 0.911 Test Loss: 0.642 Test Acc: 0.911
Validation loss decreased (-0.905398 --> -0.910804).  Saving model ...
Epoch: 19 cost time: 3.2573506832122803
Epoch: 19, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.561 Vali Acc: 0.927 Test Loss: 0.561 Test Acc: 0.927
Validation loss decreased (-0.910804 --> -0.927021).  Saving model ...
Epoch: 20 cost time: 3.251624345779419
Epoch: 20, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.525 Vali Acc: 0.922 Test Loss: 0.525 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9472272396087646
Epoch: 21, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.465 Vali Acc: 0.932 Test Loss: 0.465 Test Acc: 0.932
Validation loss decreased (-0.927021 --> -0.932428).  Saving model ...
Epoch: 22 cost time: 3.3800320625305176
Epoch: 22, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.432 Vali Acc: 0.943 Test Loss: 0.432 Test Acc: 0.943
Validation loss decreased (-0.932428 --> -0.943239).  Saving model ...
Epoch: 23 cost time: 3.3264448642730713
Epoch: 23, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.395 Vali Acc: 0.938 Test Loss: 0.395 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2564008235931396
Epoch: 24, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.353 Vali Acc: 0.949 Test Loss: 0.353 Test Acc: 0.949
Validation loss decreased (-0.943239 --> -0.948645).  Saving model ...
Epoch: 25 cost time: 3.076524019241333
Epoch: 25, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.368 Vali Acc: 0.935 Test Loss: 0.368 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3840572834014893
Epoch: 26, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.318 Vali Acc: 0.949 Test Loss: 0.318 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948645).  Saving model ...
Epoch: 27 cost time: 3.3237805366516113
Epoch: 27, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.306 Vali Acc: 0.946 Test Loss: 0.306 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1639437675476074
Epoch: 28, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.288 Vali Acc: 0.949 Test Loss: 0.288 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 29 cost time: 3.1939728260040283
Epoch: 29, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3690662384033203
Epoch: 30, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.263 Vali Acc: 0.951 Test Loss: 0.263 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 347649
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.069244384765625
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.197 Vali Acc: 0.130 Test Loss: 2.197 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 5.589870452880859
Epoch: 2, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.155 Vali Acc: 0.159 Test Loss: 2.155 Test Acc: 0.159
Validation loss decreased (-0.129708 --> -0.159438).  Saving model ...
Epoch: 3 cost time: 5.233299016952515
Epoch: 3, Steps: 17 | Train Loss: 2.096 Vali Loss: 2.101 Vali Acc: 0.216 Test Loss: 2.101 Test Acc: 0.216
Validation loss decreased (-0.159438 --> -0.216195).  Saving model ...
Epoch: 4 cost time: 5.467825412750244
Epoch: 4, Steps: 17 | Train Loss: 2.028 Vali Loss: 2.036 Vali Acc: 0.316 Test Loss: 2.036 Test Acc: 0.316
Validation loss decreased (-0.216195 --> -0.316196).  Saving model ...
Epoch: 5 cost time: 5.521336317062378
Epoch: 5, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.956 Vali Acc: 0.419 Test Loss: 1.956 Test Acc: 0.419
Validation loss decreased (-0.316196 --> -0.418899).  Saving model ...
Epoch: 6 cost time: 5.212644338607788
Epoch: 6, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.840 Vali Acc: 0.535 Test Loss: 1.840 Test Acc: 0.535
Validation loss decreased (-0.418899 --> -0.535117).  Saving model ...
Epoch: 7 cost time: 5.175670862197876
Epoch: 7, Steps: 17 | Train Loss: 1.736 Vali Loss: 1.721 Vali Acc: 0.624 Test Loss: 1.721 Test Acc: 0.624
Validation loss decreased (-0.535117 --> -0.624307).  Saving model ...
Epoch: 8 cost time: 5.533134460449219
Epoch: 8, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.607 Vali Acc: 0.649 Test Loss: 1.607 Test Acc: 0.649
Validation loss decreased (-0.624307 --> -0.648633).  Saving model ...
Epoch: 9 cost time: 5.328402757644653
Epoch: 9, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.504 Vali Acc: 0.649 Test Loss: 1.504 Test Acc: 0.649
Validation loss decreased (-0.648633 --> -0.648634).  Saving model ...
Epoch: 10 cost time: 5.5273051261901855
Epoch: 10, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.384 Vali Acc: 0.684 Test Loss: 1.384 Test Acc: 0.684
Validation loss decreased (-0.648634 --> -0.683770).  Saving model ...
Epoch: 11 cost time: 5.225193023681641
Epoch: 11, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.253 Vali Acc: 0.730 Test Loss: 1.253 Test Acc: 0.730
Validation loss decreased (-0.683770 --> -0.729717).  Saving model ...
Epoch: 12 cost time: 5.510083436965942
Epoch: 12, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.146 Vali Acc: 0.738 Test Loss: 1.146 Test Acc: 0.738
Validation loss decreased (-0.729717 --> -0.737826).  Saving model ...
Epoch: 13 cost time: 5.285509824752808
Epoch: 13, Steps: 17 | Train Loss: 1.000 Vali Loss: 0.986 Vali Acc: 0.822 Test Loss: 0.986 Test Acc: 0.822
Validation loss decreased (-0.737826 --> -0.821612).  Saving model ...
Epoch: 14 cost time: 5.2104198932647705
Epoch: 14, Steps: 17 | Train Loss: 0.885 Vali Loss: 0.880 Vali Acc: 0.835 Test Loss: 0.880 Test Acc: 0.835
Validation loss decreased (-0.821612 --> -0.835126).  Saving model ...
Epoch: 15 cost time: 5.4066853523254395
Epoch: 15, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.792 Vali Acc: 0.846 Test Loss: 0.792 Test Acc: 0.846
Validation loss decreased (-0.835126 --> -0.845938).  Saving model ...
Epoch: 16 cost time: 4.838456153869629
Epoch: 16, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.691 Vali Acc: 0.895 Test Loss: 0.691 Test Acc: 0.895
Validation loss decreased (-0.845938 --> -0.894588).  Saving model ...
Epoch: 17 cost time: 4.942267894744873
Epoch: 17, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.658 Vali Acc: 0.851 Test Loss: 0.658 Test Acc: 0.851
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.7032270431518555
Epoch: 18, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
Validation loss decreased (-0.894588 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 4.964410066604614
Epoch: 19, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.512 Vali Acc: 0.897 Test Loss: 0.512 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.6761696338653564
Epoch: 20, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.439 Vali Acc: 0.916 Test Loss: 0.439 Test Acc: 0.916
Validation loss decreased (-0.899994 --> -0.916212).  Saving model ...
Epoch: 21 cost time: 4.532918214797974
Epoch: 21, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.664719581604004
Epoch: 22, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921618).  Saving model ...
Epoch: 23 cost time: 4.752081394195557
Epoch: 23, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.352 Vali Acc: 0.916 Test Loss: 0.352 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.870867967605591
Epoch: 24, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.369 Vali Acc: 0.908 Test Loss: 0.369 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.94611930847168
Epoch: 25, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.311 Vali Acc: 0.916 Test Loss: 0.311 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.833950757980347
Epoch: 26, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.989678144454956
Epoch: 27, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.275 Vali Acc: 0.927 Test Loss: 0.275 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 28 cost time: 4.9996020793914795
Epoch: 28, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.282 Vali Acc: 0.932 Test Loss: 0.282 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932430).  Saving model ...
Epoch: 29 cost time: 5.022223234176636
Epoch: 29, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.328 Vali Acc: 0.897 Test Loss: 0.328 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.100993633270264
Epoch: 30, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.237 Vali Acc: 0.924 Test Loss: 0.237 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9324324324324325
model parameter : 589121
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.466966152191162
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.203 Vali Acc: 0.108 Test Loss: 2.203 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 4.278920888900757
Epoch: 2, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.161 Vali Acc: 0.146 Test Loss: 2.161 Test Acc: 0.146
Validation loss decreased (-0.108086 --> -0.145924).  Saving model ...
Epoch: 3 cost time: 5.078893423080444
Epoch: 3, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.105 Vali Acc: 0.230 Test Loss: 2.105 Test Acc: 0.230
Validation loss decreased (-0.145924 --> -0.229709).  Saving model ...
Epoch: 4 cost time: 5.044416666030884
Epoch: 4, Steps: 17 | Train Loss: 2.040 Vali Loss: 2.032 Vali Acc: 0.343 Test Loss: 2.032 Test Acc: 0.343
Validation loss decreased (-0.229709 --> -0.343223).  Saving model ...
Epoch: 5 cost time: 4.931971311569214
Epoch: 5, Steps: 17 | Train Loss: 1.952 Vali Loss: 1.940 Vali Acc: 0.486 Test Loss: 1.940 Test Acc: 0.486
Validation loss decreased (-0.343223 --> -0.486467).  Saving model ...
Epoch: 6 cost time: 4.968241930007935
Epoch: 6, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.831 Vali Acc: 0.562 Test Loss: 1.831 Test Acc: 0.562
Validation loss decreased (-0.486467 --> -0.562144).  Saving model ...
Epoch: 7 cost time: 5.047992467880249
Epoch: 7, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.727 Vali Acc: 0.605 Test Loss: 1.727 Test Acc: 0.605
Validation loss decreased (-0.562144 --> -0.605388).  Saving model ...
Epoch: 8 cost time: 4.754496097564697
Epoch: 8, Steps: 17 | Train Loss: 1.583 Vali Loss: 1.614 Vali Acc: 0.627 Test Loss: 1.614 Test Acc: 0.627
Validation loss decreased (-0.605388 --> -0.627011).  Saving model ...
Epoch: 9 cost time: 4.981076240539551
Epoch: 9, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.507 Vali Acc: 0.670 Test Loss: 1.507 Test Acc: 0.670
Validation loss decreased (-0.627011 --> -0.670255).  Saving model ...
Epoch: 10 cost time: 5.060563087463379
Epoch: 10, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.401 Vali Acc: 0.695 Test Loss: 1.401 Test Acc: 0.695
Validation loss decreased (-0.670255 --> -0.694581).  Saving model ...
Epoch: 11 cost time: 4.6698317527771
Epoch: 11, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.297 Vali Acc: 0.724 Test Loss: 1.297 Test Acc: 0.724
Validation loss decreased (-0.694581 --> -0.724311).  Saving model ...
Epoch: 12 cost time: 5.158591032028198
Epoch: 12, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.182 Vali Acc: 0.762 Test Loss: 1.182 Test Acc: 0.762
Validation loss decreased (-0.724311 --> -0.762150).  Saving model ...
Epoch: 13 cost time: 4.823365926742554
Epoch: 13, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.099 Vali Acc: 0.795 Test Loss: 1.099 Test Acc: 0.795
Validation loss decreased (-0.762150 --> -0.794584).  Saving model ...
Epoch: 14 cost time: 4.746963739395142
Epoch: 14, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.991 Vali Acc: 0.808 Test Loss: 0.991 Test Acc: 0.808
Validation loss decreased (-0.794584 --> -0.808098).  Saving model ...
Epoch: 15 cost time: 5.2508628368377686
Epoch: 15, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.920 Vali Acc: 0.819 Test Loss: 0.920 Test Acc: 0.819
Validation loss decreased (-0.808098 --> -0.818910).  Saving model ...
Epoch: 16 cost time: 5.02997612953186
Epoch: 16, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.803 Vali Acc: 0.849 Test Loss: 0.803 Test Acc: 0.849
Validation loss decreased (-0.818910 --> -0.848641).  Saving model ...
Epoch: 17 cost time: 4.808949947357178
Epoch: 17, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.768 Vali Acc: 0.851 Test Loss: 0.768 Test Acc: 0.851
Validation loss decreased (-0.848641 --> -0.851344).  Saving model ...
Epoch: 18 cost time: 4.932416677474976
Epoch: 18, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.691 Vali Acc: 0.854 Test Loss: 0.691 Test Acc: 0.854
Validation loss decreased (-0.851344 --> -0.854047).  Saving model ...
Epoch: 19 cost time: 4.761941432952881
Epoch: 19, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.646 Vali Acc: 0.862 Test Loss: 0.646 Test Acc: 0.862
Validation loss decreased (-0.854047 --> -0.862156).  Saving model ...
Epoch: 20 cost time: 4.7863054275512695
Epoch: 20, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.574 Vali Acc: 0.870 Test Loss: 0.574 Test Acc: 0.870
Validation loss decreased (-0.862156 --> -0.870265).  Saving model ...
Epoch: 21 cost time: 4.792906284332275
Epoch: 21, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.509 Vali Acc: 0.889 Test Loss: 0.509 Test Acc: 0.889
Validation loss decreased (-0.870265 --> -0.889184).  Saving model ...
Epoch: 22 cost time: 4.5315022468566895
Epoch: 22, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.485 Vali Acc: 0.873 Test Loss: 0.485 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.985984802246094
Epoch: 23, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.889184 --> -0.889185).  Saving model ...
Epoch: 24 cost time: 4.58014178276062
Epoch: 24, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.469 Vali Acc: 0.873 Test Loss: 0.469 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.585499048233032
Epoch: 25, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
Validation loss decreased (-0.889185 --> -0.889185).  Saving model ...
Epoch: 26 cost time: 4.757437229156494
Epoch: 26, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.367 Vali Acc: 0.908 Test Loss: 0.367 Test Acc: 0.908
Validation loss decreased (-0.889185 --> -0.908104).  Saving model ...
Epoch: 27 cost time: 4.621486186981201
Epoch: 27, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.86748480796814
Epoch: 28, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.336 Vali Acc: 0.916 Test Loss: 0.336 Test Acc: 0.916
Validation loss decreased (-0.908104 --> -0.916213).  Saving model ...
Epoch: 29 cost time: 4.880866050720215
Epoch: 29, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.422 Vali Acc: 0.892 Test Loss: 0.422 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.963660478591919
Epoch: 30, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.311 Vali Acc: 0.927 Test Loss: 0.311 Test Acc: 0.927
Validation loss decreased (-0.916213 --> -0.927024).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.927027027027027
model parameter : 175105
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.048017978668213
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.197 Vali Acc: 0.130 Test Loss: 2.197 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 4.12330174446106
Epoch: 2, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.157 Vali Acc: 0.157 Test Loss: 2.157 Test Acc: 0.157
Validation loss decreased (-0.129708 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 4.37690806388855
Epoch: 3, Steps: 17 | Train Loss: 2.100 Vali Loss: 2.105 Vali Acc: 0.214 Test Loss: 2.105 Test Acc: 0.214
Validation loss decreased (-0.156735 --> -0.213492).  Saving model ...
Epoch: 4 cost time: 4.29166841506958
Epoch: 4, Steps: 17 | Train Loss: 2.035 Vali Loss: 2.042 Vali Acc: 0.311 Test Loss: 2.042 Test Acc: 0.311
Validation loss decreased (-0.213492 --> -0.310790).  Saving model ...
Epoch: 5 cost time: 4.439411878585815
Epoch: 5, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.971 Vali Acc: 0.405 Test Loss: 1.971 Test Acc: 0.405
Validation loss decreased (-0.310790 --> -0.405386).  Saving model ...
Epoch: 6 cost time: 4.479253053665161
Epoch: 6, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.889 Vali Acc: 0.505 Test Loss: 1.889 Test Acc: 0.505
Validation loss decreased (-0.405386 --> -0.505387).  Saving model ...
Epoch: 7 cost time: 4.198574542999268
Epoch: 7, Steps: 17 | Train Loss: 1.796 Vali Loss: 1.790 Vali Acc: 0.605 Test Loss: 1.790 Test Acc: 0.605
Validation loss decreased (-0.505387 --> -0.605388).  Saving model ...
Epoch: 8 cost time: 4.251821279525757
Epoch: 8, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.681 Vali Acc: 0.668 Test Loss: 1.681 Test Acc: 0.668
Validation loss decreased (-0.605388 --> -0.667551).  Saving model ...
Epoch: 9 cost time: 4.593418121337891
Epoch: 9, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.581 Vali Acc: 0.705 Test Loss: 1.581 Test Acc: 0.705
Validation loss decreased (-0.667551 --> -0.705390).  Saving model ...
Epoch: 10 cost time: 4.00122857093811
Epoch: 10, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.472 Vali Acc: 0.703 Test Loss: 1.472 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.4920494556427
Epoch: 11, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.368 Vali Acc: 0.719 Test Loss: 1.368 Test Acc: 0.719
Validation loss decreased (-0.705390 --> -0.718905).  Saving model ...
Epoch: 12 cost time: 4.453890562057495
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.268 Vali Acc: 0.724 Test Loss: 1.268 Test Acc: 0.724
Validation loss decreased (-0.718905 --> -0.724312).  Saving model ...
Epoch: 13 cost time: 4.4740149974823
Epoch: 13, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.165 Vali Acc: 0.768 Test Loss: 1.165 Test Acc: 0.768
Validation loss decreased (-0.724312 --> -0.767556).  Saving model ...
Epoch: 14 cost time: 4.508271932601929
Epoch: 14, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.070 Vali Acc: 0.781 Test Loss: 1.070 Test Acc: 0.781
Validation loss decreased (-0.767556 --> -0.781070).  Saving model ...
Epoch: 15 cost time: 4.516693115234375
Epoch: 15, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.984 Vali Acc: 0.808 Test Loss: 0.984 Test Acc: 0.808
Validation loss decreased (-0.781070 --> -0.808098).  Saving model ...
Epoch: 16 cost time: 4.47232723236084
Epoch: 16, Steps: 17 | Train Loss: 0.866 Vali Loss: 0.906 Vali Acc: 0.835 Test Loss: 0.906 Test Acc: 0.835
Validation loss decreased (-0.808098 --> -0.835126).  Saving model ...
Epoch: 17 cost time: 4.5496509075164795
Epoch: 17, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.800 Vali Acc: 0.849 Test Loss: 0.800 Test Acc: 0.849
Validation loss decreased (-0.835126 --> -0.848641).  Saving model ...
Epoch: 18 cost time: 4.497033596038818
Epoch: 18, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.737 Vali Acc: 0.868 Test Loss: 0.737 Test Acc: 0.868
Validation loss decreased (-0.848641 --> -0.867560).  Saving model ...
Epoch: 19 cost time: 4.5073113441467285
Epoch: 19, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.683 Vali Acc: 0.859 Test Loss: 0.683 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.498655796051025
Epoch: 20, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.578 Vali Acc: 0.886 Test Loss: 0.578 Test Acc: 0.886
Validation loss decreased (-0.867560 --> -0.886481).  Saving model ...
Epoch: 21 cost time: 4.16091775894165
Epoch: 21, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.566 Vali Acc: 0.873 Test Loss: 0.566 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.235016345977783
Epoch: 22, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.523 Vali Acc: 0.873 Test Loss: 0.523 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.309266805648804
Epoch: 23, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.451 Vali Acc: 0.903 Test Loss: 0.451 Test Acc: 0.903
Validation loss decreased (-0.886481 --> -0.902698).  Saving model ...
Epoch: 24 cost time: 4.254642009735107
Epoch: 24, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.432 Vali Acc: 0.886 Test Loss: 0.432 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.374856472015381
Epoch: 25, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.365 Vali Acc: 0.914 Test Loss: 0.365 Test Acc: 0.914
Validation loss decreased (-0.902698 --> -0.913510).  Saving model ...
Epoch: 26 cost time: 4.2226128578186035
Epoch: 26, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.346 Vali Acc: 0.914 Test Loss: 0.346 Test Acc: 0.914
Validation loss decreased (-0.913510 --> -0.913510).  Saving model ...
Epoch: 27 cost time: 4.21625280380249
Epoch: 27, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.351 Vali Acc: 0.892 Test Loss: 0.351 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.486692667007446
Epoch: 28, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
Validation loss decreased (-0.913510 --> -0.921619).  Saving model ...
Epoch: 29 cost time: 4.245707035064697
Epoch: 29, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.376 Vali Acc: 0.905 Test Loss: 0.376 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.402278900146484
Epoch: 30, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.296 Vali Acc: 0.916 Test Loss: 0.296 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9216216216216216
model parameter : 589121
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.512000560760498
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.203 Vali Acc: 0.108 Test Loss: 2.203 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 3.9137070178985596
Epoch: 2, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.161 Vali Acc: 0.143 Test Loss: 2.161 Test Acc: 0.143
Validation loss decreased (-0.108086 --> -0.143222).  Saving model ...
Epoch: 3 cost time: 3.821113348007202
Epoch: 3, Steps: 17 | Train Loss: 2.134 Vali Loss: 2.107 Vali Acc: 0.224 Test Loss: 2.107 Test Acc: 0.224
Validation loss decreased (-0.143222 --> -0.224303).  Saving model ...
Epoch: 4 cost time: 3.782900094985962
Epoch: 4, Steps: 17 | Train Loss: 2.044 Vali Loss: 2.036 Vali Acc: 0.341 Test Loss: 2.036 Test Acc: 0.341
Validation loss decreased (-0.224303 --> -0.340520).  Saving model ...
Epoch: 5 cost time: 3.986569881439209
Epoch: 5, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.944 Vali Acc: 0.486 Test Loss: 1.944 Test Acc: 0.486
Validation loss decreased (-0.340520 --> -0.486467).  Saving model ...
Epoch: 6 cost time: 3.807842969894409
Epoch: 6, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.833 Vali Acc: 0.568 Test Loss: 1.833 Test Acc: 0.568
Validation loss decreased (-0.486467 --> -0.567549).  Saving model ...
Epoch: 7 cost time: 3.986527442932129
Epoch: 7, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.729 Vali Acc: 0.616 Test Loss: 1.729 Test Acc: 0.616
Validation loss decreased (-0.567549 --> -0.616199).  Saving model ...
Epoch: 8 cost time: 3.920053720474243
Epoch: 8, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.617 Vali Acc: 0.627 Test Loss: 1.617 Test Acc: 0.627
Validation loss decreased (-0.616199 --> -0.627011).  Saving model ...
Epoch: 9 cost time: 4.001944303512573
Epoch: 9, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.508 Vali Acc: 0.676 Test Loss: 1.508 Test Acc: 0.676
Validation loss decreased (-0.627011 --> -0.675661).  Saving model ...
Epoch: 10 cost time: 3.97719407081604
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.405 Vali Acc: 0.697 Test Loss: 1.405 Test Acc: 0.697
Validation loss decreased (-0.675661 --> -0.697283).  Saving model ...
Epoch: 11 cost time: 3.9072952270507812
Epoch: 11, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.298 Vali Acc: 0.724 Test Loss: 1.298 Test Acc: 0.724
Validation loss decreased (-0.697283 --> -0.724311).  Saving model ...
Epoch: 12 cost time: 4.074175596237183
Epoch: 12, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.187 Vali Acc: 0.765 Test Loss: 1.187 Test Acc: 0.765
Validation loss decreased (-0.724311 --> -0.764853).  Saving model ...
Epoch: 13 cost time: 3.946909189224243
Epoch: 13, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.103 Vali Acc: 0.781 Test Loss: 1.103 Test Acc: 0.781
Validation loss decreased (-0.764853 --> -0.781070).  Saving model ...
Epoch: 14 cost time: 4.077615737915039
Epoch: 14, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.995 Vali Acc: 0.811 Test Loss: 0.995 Test Acc: 0.811
Validation loss decreased (-0.781070 --> -0.810801).  Saving model ...
Epoch: 15 cost time: 3.947650194168091
Epoch: 15, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.928 Vali Acc: 0.808 Test Loss: 0.928 Test Acc: 0.808
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.002534866333008
Epoch: 16, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.805 Vali Acc: 0.859 Test Loss: 0.805 Test Acc: 0.859
Validation loss decreased (-0.810801 --> -0.859451).  Saving model ...
Epoch: 17 cost time: 4.086822032928467
Epoch: 17, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.773 Vali Acc: 0.859 Test Loss: 0.773 Test Acc: 0.859
Validation loss decreased (-0.859451 --> -0.859452).  Saving model ...
Epoch: 18 cost time: 3.6222445964813232
Epoch: 18, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.709 Vali Acc: 0.846 Test Loss: 0.709 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.992055892944336
Epoch: 19, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.646 Vali Acc: 0.870 Test Loss: 0.646 Test Acc: 0.870
Validation loss decreased (-0.859452 --> -0.870264).  Saving model ...
Epoch: 20 cost time: 4.151359558105469
Epoch: 20, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.576 Vali Acc: 0.868 Test Loss: 0.576 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.234557867050171
Epoch: 21, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.521 Vali Acc: 0.881 Test Loss: 0.521 Test Acc: 0.881
Validation loss decreased (-0.870264 --> -0.881076).  Saving model ...
Epoch: 22 cost time: 4.259408473968506
Epoch: 22, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.501 Vali Acc: 0.876 Test Loss: 0.501 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.928675651550293
Epoch: 23, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.463 Vali Acc: 0.892 Test Loss: 0.463 Test Acc: 0.892
Validation loss decreased (-0.881076 --> -0.891887).  Saving model ...
Epoch: 24 cost time: 4.187355995178223
Epoch: 24, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.100883483886719
Epoch: 25, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.238723516464233
Epoch: 26, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
Validation loss decreased (-0.891887 --> -0.902699).  Saving model ...
Epoch: 27 cost time: 4.098050832748413
Epoch: 27, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9411089420318604
Epoch: 28, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.348 Vali Acc: 0.908 Test Loss: 0.348 Test Acc: 0.908
Validation loss decreased (-0.902699 --> -0.908105).  Saving model ...
Epoch: 29 cost time: 3.836135149002075
Epoch: 29, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.475 Vali Acc: 0.876 Test Loss: 0.475 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8105432987213135
Epoch: 30, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
Validation loss decreased (-0.908105 --> -0.910808).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9108108108108108
model parameter : 175105
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.956965923309326
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.198 Vali Acc: 0.130 Test Loss: 2.198 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 3.2558741569519043
Epoch: 2, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.159 Vali Acc: 0.159 Test Loss: 2.159 Test Acc: 0.159
Validation loss decreased (-0.129708 --> -0.159438).  Saving model ...
Epoch: 3 cost time: 3.350860834121704
Epoch: 3, Steps: 17 | Train Loss: 2.102 Vali Loss: 2.108 Vali Acc: 0.208 Test Loss: 2.108 Test Acc: 0.208
Validation loss decreased (-0.159438 --> -0.208087).  Saving model ...
Epoch: 4 cost time: 3.147165536880493
Epoch: 4, Steps: 17 | Train Loss: 2.041 Vali Loss: 2.048 Vali Acc: 0.311 Test Loss: 2.048 Test Acc: 0.311
Validation loss decreased (-0.208087 --> -0.310790).  Saving model ...
Epoch: 5 cost time: 3.0185728073120117
Epoch: 5, Steps: 17 | Train Loss: 1.977 Vali Loss: 1.982 Vali Acc: 0.397 Test Loss: 1.982 Test Acc: 0.397
Validation loss decreased (-0.310790 --> -0.397277).  Saving model ...
Epoch: 6 cost time: 3.3591299057006836
Epoch: 6, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.908 Vali Acc: 0.476 Test Loss: 1.908 Test Acc: 0.476
Validation loss decreased (-0.397277 --> -0.475657).  Saving model ...
Epoch: 7 cost time: 3.323932647705078
Epoch: 7, Steps: 17 | Train Loss: 1.822 Vali Loss: 1.825 Vali Acc: 0.562 Test Loss: 1.825 Test Acc: 0.562
Validation loss decreased (-0.475657 --> -0.562144).  Saving model ...
Epoch: 8 cost time: 3.3693275451660156
Epoch: 8, Steps: 17 | Train Loss: 1.740 Vali Loss: 1.735 Vali Acc: 0.627 Test Loss: 1.735 Test Acc: 0.627
Validation loss decreased (-0.562144 --> -0.627010).  Saving model ...
Epoch: 9 cost time: 3.392357110977173
Epoch: 9, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.648 Vali Acc: 0.635 Test Loss: 1.648 Test Acc: 0.635
Validation loss decreased (-0.627010 --> -0.635119).  Saving model ...
Epoch: 10 cost time: 3.3398239612579346
Epoch: 10, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.561 Vali Acc: 0.686 Test Loss: 1.561 Test Acc: 0.686
Validation loss decreased (-0.635119 --> -0.686471).  Saving model ...
Epoch: 11 cost time: 3.3686814308166504
Epoch: 11, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.470 Vali Acc: 0.703 Test Loss: 1.470 Test Acc: 0.703
Validation loss decreased (-0.686471 --> -0.702688).  Saving model ...
Epoch: 12 cost time: 3.3652188777923584
Epoch: 12, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.370 Vali Acc: 0.738 Test Loss: 1.370 Test Acc: 0.738
Validation loss decreased (-0.702688 --> -0.737824).  Saving model ...
Epoch: 13 cost time: 3.2762115001678467
Epoch: 13, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.273 Vali Acc: 0.757 Test Loss: 1.273 Test Acc: 0.757
Validation loss decreased (-0.737824 --> -0.756744).  Saving model ...
Epoch: 14 cost time: 3.3144028186798096
Epoch: 14, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.183 Vali Acc: 0.776 Test Loss: 1.183 Test Acc: 0.776
Validation loss decreased (-0.756744 --> -0.775664).  Saving model ...
Epoch: 15 cost time: 3.4025990962982178
Epoch: 15, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.086 Vali Acc: 0.789 Test Loss: 1.086 Test Acc: 0.789
Validation loss decreased (-0.775664 --> -0.789178).  Saving model ...
Epoch: 16 cost time: 3.3634252548217773
Epoch: 16, Steps: 17 | Train Loss: 0.977 Vali Loss: 0.992 Vali Acc: 0.822 Test Loss: 0.992 Test Acc: 0.822
Validation loss decreased (-0.789178 --> -0.821612).  Saving model ...
Epoch: 17 cost time: 3.3767175674438477
Epoch: 17, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.923 Vali Acc: 0.832 Test Loss: 0.923 Test Acc: 0.832
Validation loss decreased (-0.821612 --> -0.832423).  Saving model ...
Epoch: 18 cost time: 3.4614758491516113
Epoch: 18, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.839 Vali Acc: 0.846 Test Loss: 0.839 Test Acc: 0.846
Validation loss decreased (-0.832423 --> -0.845938).  Saving model ...
Epoch: 19 cost time: 3.282984733581543
Epoch: 19, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.772 Vali Acc: 0.862 Test Loss: 0.772 Test Acc: 0.862
Validation loss decreased (-0.845938 --> -0.862154).  Saving model ...
Epoch: 20 cost time: 3.211690902709961
Epoch: 20, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.684 Vali Acc: 0.876 Test Loss: 0.684 Test Acc: 0.876
Validation loss decreased (-0.862154 --> -0.875669).  Saving model ...
Epoch: 21 cost time: 3.309358596801758
Epoch: 21, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.617 Vali Acc: 0.895 Test Loss: 0.617 Test Acc: 0.895
Validation loss decreased (-0.875669 --> -0.894588).  Saving model ...
Epoch: 22 cost time: 3.131364583969116
Epoch: 22, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.625 Vali Acc: 0.865 Test Loss: 0.625 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3259012699127197
Epoch: 23, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
Validation loss decreased (-0.894588 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 3.549398899078369
Epoch: 24, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.513 Vali Acc: 0.897 Test Loss: 0.513 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5257585048675537
Epoch: 25, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.476 Vali Acc: 0.903 Test Loss: 0.476 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902698).  Saving model ...
Epoch: 26 cost time: 3.7849349975585938
Epoch: 26, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.458 Vali Acc: 0.905 Test Loss: 0.458 Test Acc: 0.905
Validation loss decreased (-0.902698 --> -0.905401).  Saving model ...
Epoch: 27 cost time: 3.6363868713378906
Epoch: 27, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
Validation loss decreased (-0.905401 --> -0.910807).  Saving model ...
Epoch: 28 cost time: 3.465998649597168
Epoch: 28, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.384 Vali Acc: 0.916 Test Loss: 0.384 Test Acc: 0.916
Validation loss decreased (-0.910807 --> -0.916212).  Saving model ...
Epoch: 29 cost time: 3.4730207920074463
Epoch: 29, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.397 Vali Acc: 0.905 Test Loss: 0.397 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4246230125427246
Epoch: 30, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.369 Vali Acc: 0.919 Test Loss: 0.369 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.918918918918919
model parameter : 589121
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.112667083740234
Epoch: 1, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.204 Vali Acc: 0.108 Test Loss: 2.204 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 3.372478485107422
Epoch: 2, Steps: 17 | Train Loss: 2.206 Vali Loss: 2.164 Vali Acc: 0.143 Test Loss: 2.164 Test Acc: 0.143
Validation loss decreased (-0.108086 --> -0.143222).  Saving model ...
Epoch: 3 cost time: 3.355485200881958
Epoch: 3, Steps: 17 | Train Loss: 2.137 Vali Loss: 2.114 Vali Acc: 0.219 Test Loss: 2.114 Test Acc: 0.219
Validation loss decreased (-0.143222 --> -0.218898).  Saving model ...
Epoch: 4 cost time: 3.3783929347991943
Epoch: 4, Steps: 17 | Train Loss: 2.055 Vali Loss: 2.050 Vali Acc: 0.322 Test Loss: 2.050 Test Acc: 0.322
Validation loss decreased (-0.218898 --> -0.321601).  Saving model ...
Epoch: 5 cost time: 3.151337146759033
Epoch: 5, Steps: 17 | Train Loss: 1.978 Vali Loss: 1.973 Vali Acc: 0.427 Test Loss: 1.973 Test Acc: 0.427
Validation loss decreased (-0.321601 --> -0.427007).  Saving model ...
Epoch: 6 cost time: 3.230337619781494
Epoch: 6, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.885 Vali Acc: 0.505 Test Loss: 1.885 Test Acc: 0.505
Validation loss decreased (-0.427007 --> -0.505387).  Saving model ...
Epoch: 7 cost time: 3.2975869178771973
Epoch: 7, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.795 Vali Acc: 0.576 Test Loss: 1.795 Test Acc: 0.576
Validation loss decreased (-0.505387 --> -0.575658).  Saving model ...
Epoch: 8 cost time: 3.1497890949249268
Epoch: 8, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.707 Vali Acc: 0.603 Test Loss: 1.707 Test Acc: 0.603
Validation loss decreased (-0.575658 --> -0.602686).  Saving model ...
Epoch: 9 cost time: 2.9809086322784424
Epoch: 9, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.613 Vali Acc: 0.651 Test Loss: 1.613 Test Acc: 0.651
Validation loss decreased (-0.602686 --> -0.651335).  Saving model ...
Epoch: 10 cost time: 2.7873013019561768
Epoch: 10, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.523 Vali Acc: 0.668 Test Loss: 1.523 Test Acc: 0.668
Validation loss decreased (-0.651335 --> -0.667552).  Saving model ...
Epoch: 11 cost time: 3.0142977237701416
Epoch: 11, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.424 Vali Acc: 0.700 Test Loss: 1.424 Test Acc: 0.700
Validation loss decreased (-0.667552 --> -0.699986).  Saving model ...
Epoch: 12 cost time: 3.0219008922576904
Epoch: 12, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.337 Vali Acc: 0.722 Test Loss: 1.337 Test Acc: 0.722
Validation loss decreased (-0.699986 --> -0.721608).  Saving model ...
Epoch: 13 cost time: 3.142598867416382
Epoch: 13, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.243 Vali Acc: 0.743 Test Loss: 1.243 Test Acc: 0.743
Validation loss decreased (-0.721608 --> -0.743231).  Saving model ...
Epoch: 14 cost time: 2.9726998805999756
Epoch: 14, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.149 Vali Acc: 0.765 Test Loss: 1.149 Test Acc: 0.765
Validation loss decreased (-0.743231 --> -0.764853).  Saving model ...
Epoch: 15 cost time: 3.076784610748291
Epoch: 15, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.066 Vali Acc: 0.781 Test Loss: 1.066 Test Acc: 0.781
Validation loss decreased (-0.764853 --> -0.781070).  Saving model ...
Epoch: 16 cost time: 2.988157033920288
Epoch: 16, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.971 Vali Acc: 0.824 Test Loss: 0.971 Test Acc: 0.824
Validation loss decreased (-0.781070 --> -0.824315).  Saving model ...
Epoch: 17 cost time: 2.949798583984375
Epoch: 17, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.909 Vali Acc: 0.830 Test Loss: 0.909 Test Acc: 0.830
Validation loss decreased (-0.824315 --> -0.829721).  Saving model ...
Epoch: 18 cost time: 3.0524628162384033
Epoch: 18, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.824 Vali Acc: 0.846 Test Loss: 0.824 Test Acc: 0.846
Validation loss decreased (-0.829721 --> -0.845938).  Saving model ...
Epoch: 19 cost time: 3.148674964904785
Epoch: 19, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.754 Vali Acc: 0.876 Test Loss: 0.754 Test Acc: 0.876
Validation loss decreased (-0.845938 --> -0.875668).  Saving model ...
Epoch: 20 cost time: 3.021038293838501
Epoch: 20, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.693 Vali Acc: 0.884 Test Loss: 0.693 Test Acc: 0.884
Validation loss decreased (-0.875668 --> -0.883777).  Saving model ...
Epoch: 21 cost time: 3.053856611251831
Epoch: 21, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1087844371795654
Epoch: 22, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.588 Vali Acc: 0.892 Test Loss: 0.588 Test Acc: 0.892
Validation loss decreased (-0.883777 --> -0.891886).  Saving model ...
Epoch: 23 cost time: 3.19566011428833
Epoch: 23, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.566 Vali Acc: 0.881 Test Loss: 0.566 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.189563512802124
Epoch: 24, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.516 Vali Acc: 0.897 Test Loss: 0.516 Test Acc: 0.897
Validation loss decreased (-0.891886 --> -0.897292).  Saving model ...
Epoch: 25 cost time: 3.2103047370910645
Epoch: 25, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.455 Vali Acc: 0.905 Test Loss: 0.455 Test Acc: 0.905
Validation loss decreased (-0.897292 --> -0.905401).  Saving model ...
Epoch: 26 cost time: 3.1239490509033203
Epoch: 26, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.315671920776367
Epoch: 27, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.435 Vali Acc: 0.908 Test Loss: 0.435 Test Acc: 0.908
Validation loss decreased (-0.905401 --> -0.908104).  Saving model ...
Epoch: 28 cost time: 3.116732597351074
Epoch: 28, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.382 Vali Acc: 0.914 Test Loss: 0.382 Test Acc: 0.914
Validation loss decreased (-0.908104 --> -0.913510).  Saving model ...
Epoch: 29 cost time: 3.3117144107818604
Epoch: 29, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.418 Vali Acc: 0.897 Test Loss: 0.418 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0889737606048584
Epoch: 30, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.343 Vali Acc: 0.924 Test Loss: 0.343 Test Acc: 0.924
Validation loss decreased (-0.913510 --> -0.924321).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 175105
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.814033269882202
Epoch: 1, Steps: 17 | Train Loss: 2.296 Vali Loss: 2.251 Vali Acc: 0.086 Test Loss: 2.251 Test Acc: 0.086
Validation loss decreased (inf --> -0.086464).  Saving model ...
Epoch: 2 cost time: 4.949052095413208
Epoch: 2, Steps: 17 | Train Loss: 2.249 Vali Loss: 2.210 Vali Acc: 0.135 Test Loss: 2.210 Test Acc: 0.135
Validation loss decreased (-0.086464 --> -0.135113).  Saving model ...
Epoch: 3 cost time: 5.056295394897461
Epoch: 3, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.158 Vali Acc: 0.178 Test Loss: 2.158 Test Acc: 0.178
Validation loss decreased (-0.135113 --> -0.178357).  Saving model ...
Epoch: 4 cost time: 5.077717065811157
Epoch: 4, Steps: 17 | Train Loss: 2.152 Vali Loss: 2.096 Vali Acc: 0.227 Test Loss: 2.096 Test Acc: 0.227
Validation loss decreased (-0.178357 --> -0.227006).  Saving model ...
Epoch: 5 cost time: 5.028800010681152
Epoch: 5, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.027 Vali Acc: 0.330 Test Loss: 2.027 Test Acc: 0.330
Validation loss decreased (-0.227006 --> -0.329709).  Saving model ...
Epoch: 6 cost time: 5.020155906677246
Epoch: 6, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.950 Vali Acc: 0.422 Test Loss: 1.950 Test Acc: 0.422
Validation loss decreased (-0.329709 --> -0.421602).  Saving model ...
Epoch: 7 cost time: 4.921649694442749
Epoch: 7, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.863 Vali Acc: 0.546 Test Loss: 1.863 Test Acc: 0.546
Validation loss decreased (-0.421602 --> -0.545927).  Saving model ...
Epoch: 8 cost time: 4.752686262130737
Epoch: 8, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.764 Vali Acc: 0.635 Test Loss: 1.764 Test Acc: 0.635
Validation loss decreased (-0.545927 --> -0.635117).  Saving model ...
Epoch: 9 cost time: 5.031594276428223
Epoch: 9, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.626 Vali Acc: 0.700 Test Loss: 1.626 Test Acc: 0.700
Validation loss decreased (-0.635117 --> -0.699984).  Saving model ...
Epoch: 10 cost time: 5.261654853820801
Epoch: 10, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.489 Vali Acc: 0.719 Test Loss: 1.489 Test Acc: 0.719
Validation loss decreased (-0.699984 --> -0.718904).  Saving model ...
Epoch: 11 cost time: 5.2264580726623535
Epoch: 11, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.310 Vali Acc: 0.797 Test Loss: 1.310 Test Acc: 0.797
Validation loss decreased (-0.718904 --> -0.797284).  Saving model ...
Epoch: 12 cost time: 5.174103260040283
Epoch: 12, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.172 Vali Acc: 0.816 Test Loss: 1.172 Test Acc: 0.816
Validation loss decreased (-0.797284 --> -0.816205).  Saving model ...
Epoch: 13 cost time: 5.115702390670776
Epoch: 13, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.022 Vali Acc: 0.865 Test Loss: 1.022 Test Acc: 0.865
Validation loss decreased (-0.816205 --> -0.864855).  Saving model ...
Epoch: 14 cost time: 5.224543571472168
Epoch: 14, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.891 Vali Acc: 0.914 Test Loss: 0.891 Test Acc: 0.914
Validation loss decreased (-0.864855 --> -0.913505).  Saving model ...
Epoch: 15 cost time: 4.987698554992676
Epoch: 15, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.790 Vali Acc: 0.911 Test Loss: 0.790 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.96367073059082
Epoch: 16, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.687 Vali Acc: 0.922 Test Loss: 0.687 Test Acc: 0.922
Validation loss decreased (-0.913505 --> -0.921615).  Saving model ...
Epoch: 17 cost time: 4.6500959396362305
Epoch: 17, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.584 Vali Acc: 0.935 Test Loss: 0.584 Test Acc: 0.935
Validation loss decreased (-0.921615 --> -0.935129).  Saving model ...
Epoch: 18 cost time: 4.737587928771973
Epoch: 18, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.521 Vali Acc: 0.932 Test Loss: 0.521 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.74246883392334
Epoch: 19, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.476 Vali Acc: 0.932 Test Loss: 0.476 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.874380826950073
Epoch: 20, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.410 Vali Acc: 0.935 Test Loss: 0.410 Test Acc: 0.935
Validation loss decreased (-0.935129 --> -0.935131).  Saving model ...
Epoch: 21 cost time: 4.863833427429199
Epoch: 21, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.372 Vali Acc: 0.943 Test Loss: 0.372 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943240).  Saving model ...
Epoch: 22 cost time: 4.911503791809082
Epoch: 22, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.369 Vali Acc: 0.941 Test Loss: 0.369 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.746735334396362
Epoch: 23, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.403 Vali Acc: 0.916 Test Loss: 0.403 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.616685152053833
Epoch: 24, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.365 Vali Acc: 0.935 Test Loss: 0.365 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.836072206497192
Epoch: 25, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.270 Vali Acc: 0.951 Test Loss: 0.270 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 5.10917854309082
Epoch: 26, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.234 Vali Acc: 0.962 Test Loss: 0.234 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962160).  Saving model ...
Epoch: 27 cost time: 4.918341398239136
Epoch: 27, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.232 Vali Acc: 0.954 Test Loss: 0.232 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.06955623626709
Epoch: 28, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.222 Vali Acc: 0.959 Test Loss: 0.222 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.970961570739746
Epoch: 29, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.06131386756897
Epoch: 30, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 295873
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.2338385581970215
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.200 Vali Acc: 0.095 Test Loss: 2.200 Test Acc: 0.095
Validation loss decreased (inf --> -0.094573).  Saving model ...
Epoch: 2 cost time: 4.4973859786987305
Epoch: 2, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.161 Vali Acc: 0.130 Test Loss: 2.161 Test Acc: 0.130
Validation loss decreased (-0.094573 --> -0.129708).  Saving model ...
Epoch: 3 cost time: 4.613304615020752
Epoch: 3, Steps: 17 | Train Loss: 2.128 Vali Loss: 2.110 Vali Acc: 0.197 Test Loss: 2.110 Test Acc: 0.197
Validation loss decreased (-0.129708 --> -0.197276).  Saving model ...
Epoch: 4 cost time: 4.4335527420043945
Epoch: 4, Steps: 17 | Train Loss: 2.076 Vali Loss: 2.048 Vali Acc: 0.281 Test Loss: 2.048 Test Acc: 0.281
Validation loss decreased (-0.197276 --> -0.281061).  Saving model ...
Epoch: 5 cost time: 4.45356297492981
Epoch: 5, Steps: 17 | Train Loss: 2.005 Vali Loss: 1.980 Vali Acc: 0.386 Test Loss: 1.980 Test Acc: 0.386
Validation loss decreased (-0.281061 --> -0.386467).  Saving model ...
Epoch: 6 cost time: 4.5059545040130615
Epoch: 6, Steps: 17 | Train Loss: 1.934 Vali Loss: 1.904 Vali Acc: 0.497 Test Loss: 1.904 Test Acc: 0.497
Validation loss decreased (-0.386467 --> -0.497278).  Saving model ...
Epoch: 7 cost time: 4.3187971115112305
Epoch: 7, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.813 Vali Acc: 0.581 Test Loss: 1.813 Test Acc: 0.581
Validation loss decreased (-0.497278 --> -0.581063).  Saving model ...
Epoch: 8 cost time: 4.548216342926025
Epoch: 8, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.720 Vali Acc: 0.627 Test Loss: 1.720 Test Acc: 0.627
Validation loss decreased (-0.581063 --> -0.627010).  Saving model ...
Epoch: 9 cost time: 4.589236259460449
Epoch: 9, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.618 Vali Acc: 0.703 Test Loss: 1.618 Test Acc: 0.703
Validation loss decreased (-0.627010 --> -0.702687).  Saving model ...
Epoch: 10 cost time: 4.5021374225616455
Epoch: 10, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.518 Vali Acc: 0.727 Test Loss: 1.518 Test Acc: 0.727
Validation loss decreased (-0.702687 --> -0.727012).  Saving model ...
Epoch: 11 cost time: 4.635170936584473
Epoch: 11, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.418 Vali Acc: 0.751 Test Loss: 1.418 Test Acc: 0.751
Validation loss decreased (-0.727012 --> -0.751337).  Saving model ...
Epoch: 12 cost time: 4.393405914306641
Epoch: 12, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.321 Vali Acc: 0.773 Test Loss: 1.321 Test Acc: 0.773
Validation loss decreased (-0.751337 --> -0.772960).  Saving model ...
Epoch: 13 cost time: 4.454993963241577
Epoch: 13, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.218 Vali Acc: 0.803 Test Loss: 1.218 Test Acc: 0.803
Validation loss decreased (-0.772960 --> -0.802691).  Saving model ...
Epoch: 14 cost time: 4.37443733215332
Epoch: 14, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.136 Vali Acc: 0.800 Test Loss: 1.136 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.408902406692505
Epoch: 15, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.058 Vali Acc: 0.824 Test Loss: 1.058 Test Acc: 0.824
Validation loss decreased (-0.802691 --> -0.824314).  Saving model ...
Epoch: 16 cost time: 4.19174337387085
Epoch: 16, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.965 Vali Acc: 0.822 Test Loss: 0.965 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.41077184677124
Epoch: 17, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.876 Vali Acc: 0.824 Test Loss: 0.876 Test Acc: 0.824
Validation loss decreased (-0.824314 --> -0.824316).  Saving model ...
Epoch: 18 cost time: 4.067018747329712
Epoch: 18, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.784 Vali Acc: 0.854 Test Loss: 0.784 Test Acc: 0.854
Validation loss decreased (-0.824316 --> -0.854046).  Saving model ...
Epoch: 19 cost time: 4.000986337661743
Epoch: 19, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.728 Vali Acc: 0.854 Test Loss: 0.728 Test Acc: 0.854
Validation loss decreased (-0.854046 --> -0.854047).  Saving model ...
Epoch: 20 cost time: 3.977999687194824
Epoch: 20, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.650 Vali Acc: 0.865 Test Loss: 0.650 Test Acc: 0.865
Validation loss decreased (-0.854047 --> -0.864858).  Saving model ...
Epoch: 21 cost time: 4.475792646408081
Epoch: 21, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.628 Vali Acc: 0.870 Test Loss: 0.628 Test Acc: 0.870
Validation loss decreased (-0.864858 --> -0.870264).  Saving model ...
Epoch: 22 cost time: 3.993913412094116
Epoch: 22, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.559 Vali Acc: 0.876 Test Loss: 0.559 Test Acc: 0.876
Validation loss decreased (-0.870264 --> -0.875670).  Saving model ...
Epoch: 23 cost time: 4.194395065307617
Epoch: 23, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.515 Vali Acc: 0.897 Test Loss: 0.515 Test Acc: 0.897
Validation loss decreased (-0.875670 --> -0.897292).  Saving model ...
Epoch: 24 cost time: 4.3531060218811035
Epoch: 24, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.185357570648193
Epoch: 25, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.455 Vali Acc: 0.878 Test Loss: 0.455 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.6424455642700195
Epoch: 26, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.439 Vali Acc: 0.881 Test Loss: 0.439 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.6074137687683105
Epoch: 27, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.403 Vali Acc: 0.897 Test Loss: 0.403 Test Acc: 0.897
Validation loss decreased (-0.897292 --> -0.897293).  Saving model ...
Epoch: 28 cost time: 4.481494665145874
Epoch: 28, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.779958724975586
Epoch: 29, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.353 Vali Acc: 0.916 Test Loss: 0.353 Test Acc: 0.916
Validation loss decreased (-0.897293 --> -0.916213).  Saving model ...
Epoch: 30 cost time: 4.668639183044434
Epoch: 30, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.321 Vali Acc: 0.905 Test Loss: 0.321 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9162162162162162
model parameter : 88833
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.992645263671875
Epoch: 1, Steps: 17 | Train Loss: 2.297 Vali Loss: 2.252 Vali Acc: 0.086 Test Loss: 2.252 Test Acc: 0.086
Validation loss decreased (inf --> -0.086464).  Saving model ...
Epoch: 2 cost time: 4.120647668838501
Epoch: 2, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.210 Vali Acc: 0.135 Test Loss: 2.210 Test Acc: 0.135
Validation loss decreased (-0.086464 --> -0.135113).  Saving model ...
Epoch: 3 cost time: 4.088804244995117
Epoch: 3, Steps: 17 | Train Loss: 2.202 Vali Loss: 2.159 Vali Acc: 0.178 Test Loss: 2.159 Test Acc: 0.178
Validation loss decreased (-0.135113 --> -0.178357).  Saving model ...
Epoch: 4 cost time: 4.2104291915893555
Epoch: 4, Steps: 17 | Train Loss: 2.154 Vali Loss: 2.097 Vali Acc: 0.219 Test Loss: 2.097 Test Acc: 0.219
Validation loss decreased (-0.178357 --> -0.218898).  Saving model ...
Epoch: 5 cost time: 4.671783447265625
Epoch: 5, Steps: 17 | Train Loss: 2.084 Vali Loss: 2.029 Vali Acc: 0.327 Test Loss: 2.029 Test Acc: 0.327
Validation loss decreased (-0.218898 --> -0.327007).  Saving model ...
Epoch: 6 cost time: 4.2308030128479
Epoch: 6, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.954 Vali Acc: 0.416 Test Loss: 1.954 Test Acc: 0.416
Validation loss decreased (-0.327007 --> -0.416197).  Saving model ...
Epoch: 7 cost time: 4.324819087982178
Epoch: 7, Steps: 17 | Train Loss: 1.902 Vali Loss: 1.870 Vali Acc: 0.538 Test Loss: 1.870 Test Acc: 0.538
Validation loss decreased (-0.416197 --> -0.537819).  Saving model ...
Epoch: 8 cost time: 4.606613874435425
Epoch: 8, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.772 Vali Acc: 0.638 Test Loss: 1.772 Test Acc: 0.638
Validation loss decreased (-0.537819 --> -0.637820).  Saving model ...
Epoch: 9 cost time: 4.2151758670806885
Epoch: 9, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.640 Vali Acc: 0.695 Test Loss: 1.640 Test Acc: 0.695
Validation loss decreased (-0.637820 --> -0.694578).  Saving model ...
Epoch: 10 cost time: 4.382068157196045
Epoch: 10, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.504 Vali Acc: 0.735 Test Loss: 1.504 Test Acc: 0.735
Validation loss decreased (-0.694578 --> -0.735120).  Saving model ...
Epoch: 11 cost time: 4.629327774047852
Epoch: 11, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.313 Vali Acc: 0.792 Test Loss: 1.313 Test Acc: 0.792
Validation loss decreased (-0.735120 --> -0.791879).  Saving model ...
Epoch: 12 cost time: 4.34920334815979
Epoch: 12, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.161 Vali Acc: 0.822 Test Loss: 1.161 Test Acc: 0.822
Validation loss decreased (-0.791879 --> -0.821610).  Saving model ...
Epoch: 13 cost time: 4.457052230834961
Epoch: 13, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.005 Vali Acc: 0.878 Test Loss: 1.005 Test Acc: 0.878
Validation loss decreased (-0.821610 --> -0.878368).  Saving model ...
Epoch: 14 cost time: 4.702096223831177
Epoch: 14, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.877 Vali Acc: 0.905 Test Loss: 0.877 Test Acc: 0.905
Validation loss decreased (-0.878368 --> -0.905397).  Saving model ...
Epoch: 15 cost time: 4.635651350021362
Epoch: 15, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.785 Vali Acc: 0.892 Test Loss: 0.785 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.504735469818115
Epoch: 16, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.678 Vali Acc: 0.927 Test Loss: 0.678 Test Acc: 0.927
Validation loss decreased (-0.905397 --> -0.927020).  Saving model ...
Epoch: 17 cost time: 4.536940574645996
Epoch: 17, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.575 Vali Acc: 0.941 Test Loss: 0.575 Test Acc: 0.941
Validation loss decreased (-0.927020 --> -0.940535).  Saving model ...
Epoch: 18 cost time: 4.491778612136841
Epoch: 18, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.511 Vali Acc: 0.938 Test Loss: 0.511 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.479098081588745
Epoch: 19, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.482 Vali Acc: 0.932 Test Loss: 0.482 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.520993232727051
Epoch: 20, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.408 Vali Acc: 0.938 Test Loss: 0.408 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.353683233261108
Epoch: 21, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.363 Vali Acc: 0.951 Test Loss: 0.363 Test Acc: 0.951
Validation loss decreased (-0.940535 --> -0.951348).  Saving model ...
Epoch: 22 cost time: 4.226182699203491
Epoch: 22, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.961317539215088
Epoch: 23, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.393 Vali Acc: 0.922 Test Loss: 0.393 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.185326814651489
Epoch: 24, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.325 Vali Acc: 0.943 Test Loss: 0.325 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8289310932159424
Epoch: 25, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.255 Vali Acc: 0.954 Test Loss: 0.255 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 26 cost time: 3.875072956085205
Epoch: 26, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.237 Vali Acc: 0.954 Test Loss: 0.237 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 4.029286623001099
Epoch: 27, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956754).  Saving model ...
Epoch: 28 cost time: 4.098308801651001
Epoch: 28, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.222 Vali Acc: 0.954 Test Loss: 0.222 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.006453514099121
Epoch: 29, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 30 cost time: 4.247695446014404
Epoch: 30, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972971).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 295873
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.257614374160767
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.200 Vali Acc: 0.092 Test Loss: 2.200 Test Acc: 0.092
Validation loss decreased (inf --> -0.091870).  Saving model ...
Epoch: 2 cost time: 3.693695545196533
Epoch: 2, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.161 Vali Acc: 0.130 Test Loss: 2.161 Test Acc: 0.130
Validation loss decreased (-0.091870 --> -0.129708).  Saving model ...
Epoch: 3 cost time: 3.9786884784698486
Epoch: 3, Steps: 17 | Train Loss: 2.130 Vali Loss: 2.112 Vali Acc: 0.184 Test Loss: 2.112 Test Acc: 0.184
Validation loss decreased (-0.129708 --> -0.183763).  Saving model ...
Epoch: 4 cost time: 3.7139110565185547
Epoch: 4, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.051 Vali Acc: 0.281 Test Loss: 2.051 Test Acc: 0.281
Validation loss decreased (-0.183763 --> -0.281061).  Saving model ...
Epoch: 5 cost time: 3.5253024101257324
Epoch: 5, Steps: 17 | Train Loss: 2.009 Vali Loss: 1.985 Vali Acc: 0.378 Test Loss: 1.985 Test Acc: 0.378
Validation loss decreased (-0.281061 --> -0.378359).  Saving model ...
Epoch: 6 cost time: 3.8592891693115234
Epoch: 6, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.911 Vali Acc: 0.489 Test Loss: 1.911 Test Acc: 0.489
Validation loss decreased (-0.378359 --> -0.489170).  Saving model ...
Epoch: 7 cost time: 3.732158660888672
Epoch: 7, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.821 Vali Acc: 0.589 Test Loss: 1.821 Test Acc: 0.589
Validation loss decreased (-0.489170 --> -0.589171).  Saving model ...
Epoch: 8 cost time: 3.5731725692749023
Epoch: 8, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.729 Vali Acc: 0.638 Test Loss: 1.729 Test Acc: 0.638
Validation loss decreased (-0.589171 --> -0.637821).  Saving model ...
Epoch: 9 cost time: 3.593838930130005
Epoch: 9, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.626 Vali Acc: 0.697 Test Loss: 1.626 Test Acc: 0.697
Validation loss decreased (-0.637821 --> -0.697281).  Saving model ...
Epoch: 10 cost time: 4.041837215423584
Epoch: 10, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.529 Vali Acc: 0.732 Test Loss: 1.529 Test Acc: 0.732
Validation loss decreased (-0.697281 --> -0.732417).  Saving model ...
Epoch: 11 cost time: 3.747236728668213
Epoch: 11, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.432 Vali Acc: 0.743 Test Loss: 1.432 Test Acc: 0.743
Validation loss decreased (-0.732417 --> -0.743229).  Saving model ...
Epoch: 12 cost time: 3.6576194763183594
Epoch: 12, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.335 Vali Acc: 0.765 Test Loss: 1.335 Test Acc: 0.765
Validation loss decreased (-0.743229 --> -0.764852).  Saving model ...
Epoch: 13 cost time: 4.057790756225586
Epoch: 13, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.235 Vali Acc: 0.795 Test Loss: 1.235 Test Acc: 0.795
Validation loss decreased (-0.764852 --> -0.794582).  Saving model ...
Epoch: 14 cost time: 3.9415130615234375
Epoch: 14, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.151 Vali Acc: 0.795 Test Loss: 1.151 Test Acc: 0.795
Validation loss decreased (-0.794582 --> -0.794583).  Saving model ...
Epoch: 15 cost time: 4.012433052062988
Epoch: 15, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.072 Vali Acc: 0.808 Test Loss: 1.072 Test Acc: 0.808
Validation loss decreased (-0.794583 --> -0.808097).  Saving model ...
Epoch: 16 cost time: 4.049614191055298
Epoch: 16, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.981 Vali Acc: 0.822 Test Loss: 0.981 Test Acc: 0.822
Validation loss decreased (-0.808097 --> -0.821612).  Saving model ...
Epoch: 17 cost time: 3.9957919120788574
Epoch: 17, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.893 Vali Acc: 0.824 Test Loss: 0.893 Test Acc: 0.824
Validation loss decreased (-0.821612 --> -0.824315).  Saving model ...
Epoch: 18 cost time: 3.8566830158233643
Epoch: 18, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.809 Vali Acc: 0.857 Test Loss: 0.809 Test Acc: 0.857
Validation loss decreased (-0.824315 --> -0.856749).  Saving model ...
Epoch: 19 cost time: 3.8712189197540283
Epoch: 19, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.755 Vali Acc: 0.868 Test Loss: 0.755 Test Acc: 0.868
Validation loss decreased (-0.856749 --> -0.867560).  Saving model ...
Epoch: 20 cost time: 4.177748441696167
Epoch: 20, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.666 Vali Acc: 0.876 Test Loss: 0.666 Test Acc: 0.876
Validation loss decreased (-0.867560 --> -0.875669).  Saving model ...
Epoch: 21 cost time: 3.9870760440826416
Epoch: 21, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.644 Vali Acc: 0.868 Test Loss: 0.644 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.691922426223755
Epoch: 22, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.577 Vali Acc: 0.878 Test Loss: 0.577 Test Acc: 0.878
Validation loss decreased (-0.875669 --> -0.878373).  Saving model ...
Epoch: 23 cost time: 4.154989004135132
Epoch: 23, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.538 Vali Acc: 0.892 Test Loss: 0.538 Test Acc: 0.892
Validation loss decreased (-0.878373 --> -0.891887).  Saving model ...
Epoch: 24 cost time: 4.198860168457031
Epoch: 24, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.489 Vali Acc: 0.903 Test Loss: 0.489 Test Acc: 0.903
Validation loss decreased (-0.891887 --> -0.902698).  Saving model ...
Epoch: 25 cost time: 3.957547664642334
Epoch: 25, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.469 Vali Acc: 0.881 Test Loss: 0.469 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.766836643218994
Epoch: 26, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.448 Vali Acc: 0.892 Test Loss: 0.448 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.675304889678955
Epoch: 27, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.408 Vali Acc: 0.897 Test Loss: 0.408 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5293753147125244
Epoch: 28, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.365 Vali Acc: 0.911 Test Loss: 0.365 Test Acc: 0.911
Validation loss decreased (-0.902698 --> -0.910807).  Saving model ...
Epoch: 29 cost time: 3.5925981998443604
Epoch: 29, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.377 Vali Acc: 0.897 Test Loss: 0.377 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7960126399993896
Epoch: 30, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
Validation loss decreased (-0.910807 --> -0.918916).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.918918918918919
model parameter : 88833
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.930434703826904
Epoch: 1, Steps: 17 | Train Loss: 2.297 Vali Loss: 2.252 Vali Acc: 0.084 Test Loss: 2.252 Test Acc: 0.084
Validation loss decreased (inf --> -0.083761).  Saving model ...
Epoch: 2 cost time: 3.093270778656006
Epoch: 2, Steps: 17 | Train Loss: 2.251 Vali Loss: 2.211 Vali Acc: 0.135 Test Loss: 2.211 Test Acc: 0.135
Validation loss decreased (-0.083761 --> -0.135113).  Saving model ...
Epoch: 3 cost time: 3.1882200241088867
Epoch: 3, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.162 Vali Acc: 0.176 Test Loss: 2.162 Test Acc: 0.176
Validation loss decreased (-0.135113 --> -0.175654).  Saving model ...
Epoch: 4 cost time: 3.0252597332000732
Epoch: 4, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.102 Vali Acc: 0.219 Test Loss: 2.102 Test Acc: 0.219
Validation loss decreased (-0.175654 --> -0.218898).  Saving model ...
Epoch: 5 cost time: 2.9960482120513916
Epoch: 5, Steps: 17 | Train Loss: 2.090 Vali Loss: 2.037 Vali Acc: 0.314 Test Loss: 2.037 Test Acc: 0.314
Validation loss decreased (-0.218898 --> -0.313493).  Saving model ...
Epoch: 6 cost time: 3.4015326499938965
Epoch: 6, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.966 Vali Acc: 0.403 Test Loss: 1.966 Test Acc: 0.403
Validation loss decreased (-0.313493 --> -0.402683).  Saving model ...
Epoch: 7 cost time: 3.339763879776001
Epoch: 7, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.890 Vali Acc: 0.514 Test Loss: 1.890 Test Acc: 0.514
Validation loss decreased (-0.402683 --> -0.513495).  Saving model ...
Epoch: 8 cost time: 3.134223222732544
Epoch: 8, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.809 Vali Acc: 0.597 Test Loss: 1.809 Test Acc: 0.597
Validation loss decreased (-0.513495 --> -0.597279).  Saving model ...
Epoch: 9 cost time: 3.170421600341797
Epoch: 9, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.717 Vali Acc: 0.651 Test Loss: 1.717 Test Acc: 0.651
Validation loss decreased (-0.597279 --> -0.651334).  Saving model ...
Epoch: 10 cost time: 3.1898295879364014
Epoch: 10, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.619 Vali Acc: 0.676 Test Loss: 1.619 Test Acc: 0.676
Validation loss decreased (-0.651334 --> -0.675659).  Saving model ...
Epoch: 11 cost time: 3.376098394393921
Epoch: 11, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.516 Vali Acc: 0.686 Test Loss: 1.516 Test Acc: 0.686
Validation loss decreased (-0.675659 --> -0.686471).  Saving model ...
Epoch: 12 cost time: 3.1209640502929688
Epoch: 12, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.404 Vali Acc: 0.722 Test Loss: 1.404 Test Acc: 0.722
Validation loss decreased (-0.686471 --> -0.721608).  Saving model ...
Epoch: 13 cost time: 3.127149820327759
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.293 Vali Acc: 0.759 Test Loss: 1.293 Test Acc: 0.759
Validation loss decreased (-0.721608 --> -0.759447).  Saving model ...
Epoch: 14 cost time: 3.0987019538879395
Epoch: 14, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.180 Vali Acc: 0.784 Test Loss: 1.180 Test Acc: 0.784
Validation loss decreased (-0.759447 --> -0.783772).  Saving model ...
Epoch: 15 cost time: 3.413609743118286
Epoch: 15, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.072 Vali Acc: 0.811 Test Loss: 1.072 Test Acc: 0.811
Validation loss decreased (-0.783772 --> -0.810800).  Saving model ...
Epoch: 16 cost time: 3.318800449371338
Epoch: 16, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.969 Vali Acc: 0.827 Test Loss: 0.969 Test Acc: 0.827
Validation loss decreased (-0.810800 --> -0.827017).  Saving model ...
Epoch: 17 cost time: 3.200873851776123
Epoch: 17, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.877 Vali Acc: 0.846 Test Loss: 0.877 Test Acc: 0.846
Validation loss decreased (-0.827017 --> -0.845937).  Saving model ...
Epoch: 18 cost time: 3.207718849182129
Epoch: 18, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.787 Vali Acc: 0.865 Test Loss: 0.787 Test Acc: 0.865
Validation loss decreased (-0.845937 --> -0.864857).  Saving model ...
Epoch: 19 cost time: 3.382664203643799
Epoch: 19, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.718 Vali Acc: 0.868 Test Loss: 0.718 Test Acc: 0.868
Validation loss decreased (-0.864857 --> -0.867560).  Saving model ...
Epoch: 20 cost time: 3.2472915649414062
Epoch: 20, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.637 Vali Acc: 0.908 Test Loss: 0.637 Test Acc: 0.908
Validation loss decreased (-0.867560 --> -0.908102).  Saving model ...
Epoch: 21 cost time: 3.176657199859619
Epoch: 21, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.580 Vali Acc: 0.916 Test Loss: 0.580 Test Acc: 0.916
Validation loss decreased (-0.908102 --> -0.916210).  Saving model ...
Epoch: 22 cost time: 3.169248580932617
Epoch: 22, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.540 Vali Acc: 0.914 Test Loss: 0.540 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.072336196899414
Epoch: 23, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.471 Vali Acc: 0.941 Test Loss: 0.471 Test Acc: 0.941
Validation loss decreased (-0.916210 --> -0.940536).  Saving model ...
Epoch: 24 cost time: 2.986534357070923
Epoch: 24, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.442 Vali Acc: 0.932 Test Loss: 0.442 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.36031436920166
Epoch: 25, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.415 Vali Acc: 0.935 Test Loss: 0.415 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.176140546798706
Epoch: 26, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.1271605491638184
Epoch: 27, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.356 Vali Acc: 0.941 Test Loss: 0.356 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 28 cost time: 3.2416985034942627
Epoch: 28, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 29 cost time: 3.2521233558654785
Epoch: 29, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.315 Vali Acc: 0.938 Test Loss: 0.315 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.054403305053711
Epoch: 30, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.290 Vali Acc: 0.946 Test Loss: 0.290 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 295873
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.587452173233032
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.202 Vali Acc: 0.095 Test Loss: 2.202 Test Acc: 0.095
Validation loss decreased (inf --> -0.094573).  Saving model ...
Epoch: 2 cost time: 2.8205695152282715
Epoch: 2, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.166 Vali Acc: 0.127 Test Loss: 2.166 Test Acc: 0.127
Validation loss decreased (-0.094573 --> -0.127005).  Saving model ...
Epoch: 3 cost time: 2.8164255619049072
Epoch: 3, Steps: 17 | Train Loss: 2.133 Vali Loss: 2.119 Vali Acc: 0.181 Test Loss: 2.119 Test Acc: 0.181
Validation loss decreased (-0.127005 --> -0.181060).  Saving model ...
Epoch: 4 cost time: 2.919693946838379
Epoch: 4, Steps: 17 | Train Loss: 2.086 Vali Loss: 2.063 Vali Acc: 0.246 Test Loss: 2.063 Test Acc: 0.246
Validation loss decreased (-0.181060 --> -0.245925).  Saving model ...
Epoch: 5 cost time: 2.8481605052948
Epoch: 5, Steps: 17 | Train Loss: 2.018 Vali Loss: 2.002 Vali Acc: 0.335 Test Loss: 2.002 Test Acc: 0.335
Validation loss decreased (-0.245925 --> -0.335115).  Saving model ...
Epoch: 6 cost time: 2.9159271717071533
Epoch: 6, Steps: 17 | Train Loss: 1.953 Vali Loss: 1.937 Vali Acc: 0.451 Test Loss: 1.937 Test Acc: 0.451
Validation loss decreased (-0.335115 --> -0.451332).  Saving model ...
Epoch: 7 cost time: 3.1272470951080322
Epoch: 7, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.860 Vali Acc: 0.543 Test Loss: 1.860 Test Acc: 0.543
Validation loss decreased (-0.451332 --> -0.543225).  Saving model ...
Epoch: 8 cost time: 2.8728878498077393
Epoch: 8, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.785 Vali Acc: 0.597 Test Loss: 1.785 Test Acc: 0.597
Validation loss decreased (-0.543225 --> -0.597279).  Saving model ...
Epoch: 9 cost time: 2.8578953742980957
Epoch: 9, Steps: 17 | Train Loss: 1.681 Vali Loss: 1.700 Vali Acc: 0.668 Test Loss: 1.700 Test Acc: 0.668
Validation loss decreased (-0.597279 --> -0.667551).  Saving model ...
Epoch: 10 cost time: 3.0162343978881836
Epoch: 10, Steps: 17 | Train Loss: 1.594 Vali Loss: 1.616 Vali Acc: 0.686 Test Loss: 1.616 Test Acc: 0.686
Validation loss decreased (-0.667551 --> -0.686470).  Saving model ...
Epoch: 11 cost time: 2.84460186958313
Epoch: 11, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.529 Vali Acc: 0.703 Test Loss: 1.529 Test Acc: 0.703
Validation loss decreased (-0.686470 --> -0.702687).  Saving model ...
Epoch: 12 cost time: 2.878514289855957
Epoch: 12, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.440 Vali Acc: 0.708 Test Loss: 1.440 Test Acc: 0.708
Validation loss decreased (-0.702687 --> -0.708094).  Saving model ...
Epoch: 13 cost time: 3.0462751388549805
Epoch: 13, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.348 Vali Acc: 0.741 Test Loss: 1.348 Test Acc: 0.741
Validation loss decreased (-0.708094 --> -0.740527).  Saving model ...
Epoch: 14 cost time: 2.9406344890594482
Epoch: 14, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.262 Vali Acc: 0.765 Test Loss: 1.262 Test Acc: 0.765
Validation loss decreased (-0.740527 --> -0.764852).  Saving model ...
Epoch: 15 cost time: 2.9259185791015625
Epoch: 15, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.186 Vali Acc: 0.781 Test Loss: 1.186 Test Acc: 0.781
Validation loss decreased (-0.764852 --> -0.781069).  Saving model ...
Epoch: 16 cost time: 3.011528730392456
Epoch: 16, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.098 Vali Acc: 0.795 Test Loss: 1.098 Test Acc: 0.795
Validation loss decreased (-0.781069 --> -0.794584).  Saving model ...
Epoch: 17 cost time: 3.0040225982666016
Epoch: 17, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.016 Vali Acc: 0.808 Test Loss: 1.016 Test Acc: 0.808
Validation loss decreased (-0.794584 --> -0.808098).  Saving model ...
Epoch: 18 cost time: 3.139852285385132
Epoch: 18, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.942 Vali Acc: 0.816 Test Loss: 0.942 Test Acc: 0.816
Validation loss decreased (-0.808098 --> -0.816207).  Saving model ...
Epoch: 19 cost time: 3.1877522468566895
Epoch: 19, Steps: 17 | Train Loss: 0.810 Vali Loss: 0.885 Vali Acc: 0.838 Test Loss: 0.885 Test Acc: 0.838
Validation loss decreased (-0.816207 --> -0.837829).  Saving model ...
Epoch: 20 cost time: 3.312258243560791
Epoch: 20, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.815 Vali Acc: 0.865 Test Loss: 0.815 Test Acc: 0.865
Validation loss decreased (-0.837829 --> -0.864857).  Saving model ...
Epoch: 21 cost time: 3.2391929626464844
Epoch: 21, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.768 Vali Acc: 0.868 Test Loss: 0.768 Test Acc: 0.868
Validation loss decreased (-0.864857 --> -0.867560).  Saving model ...
Epoch: 22 cost time: 3.203794479370117
Epoch: 22, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.709 Vali Acc: 0.868 Test Loss: 0.709 Test Acc: 0.868
Validation loss decreased (-0.867560 --> -0.867560).  Saving model ...
Epoch: 23 cost time: 3.2244133949279785
Epoch: 23, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.666 Vali Acc: 0.873 Test Loss: 0.666 Test Acc: 0.873
Validation loss decreased (-0.867560 --> -0.872966).  Saving model ...
Epoch: 24 cost time: 3.226832389831543
Epoch: 24, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.621 Vali Acc: 0.868 Test Loss: 0.621 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2689907550811768
Epoch: 25, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.586 Vali Acc: 0.884 Test Loss: 0.586 Test Acc: 0.884
Validation loss decreased (-0.872966 --> -0.883778).  Saving model ...
Epoch: 26 cost time: 3.1532552242279053
Epoch: 26, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
Validation loss decreased (-0.883778 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 3.2549965381622314
Epoch: 27, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.536 Vali Acc: 0.886 Test Loss: 0.536 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.287311315536499
Epoch: 28, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.484 Vali Acc: 0.903 Test Loss: 0.484 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902698).  Saving model ...
Epoch: 29 cost time: 3.2070815563201904
Epoch: 29, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.464 Vali Acc: 0.903 Test Loss: 0.464 Test Acc: 0.903
Validation loss decreased (-0.902698 --> -0.902698).  Saving model ...
Epoch: 30 cost time: 3.1591482162475586
Epoch: 30, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
Validation loss decreased (-0.902698 --> -0.910806).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9108108108108108
model parameter : 88833
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 36.79751777648926
Epoch: 1, Steps: 17 | Train Loss: 2.087 Vali Loss: 1.776 Vali Acc: 0.681 Test Loss: 1.776 Test Acc: 0.681
Validation loss decreased (inf --> -0.681063).  Saving model ...
Epoch: 2 cost time: 34.131991147994995
Epoch: 2, Steps: 17 | Train Loss: 1.359 Vali Loss: 0.932 Vali Acc: 0.857 Test Loss: 0.932 Test Acc: 0.857
Validation loss decreased (-0.681063 --> -0.856747).  Saving model ...
Epoch: 3 cost time: 32.62132692337036
Epoch: 3, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.380 Vali Acc: 0.932 Test Loss: 0.380 Test Acc: 0.932
Validation loss decreased (-0.856747 --> -0.932429).  Saving model ...
Epoch: 4 cost time: 32.9344003200531
Epoch: 4, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 31.13361620903015
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.242 Vali Acc: 0.914 Test Loss: 0.242 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 32.68420600891113
Epoch: 6, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.937835 --> -0.956756).  Saving model ...
Epoch: 7 cost time: 34.39405393600464
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.956756 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 34.58760952949524
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 34.51975440979004
Epoch: 9, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 33.22649049758911
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 33.22126603126526
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 32.89390683174133
Epoch: 12, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 31.276544094085693
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 31.155235290527344
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 33.28182768821716
Epoch: 15, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.321 Vali Acc: 0.892 Test Loss: 0.321 Test Acc: 0.892
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 33.06655144691467
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 33.662123918533325
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.932 Test Loss: 0.173 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 56275593
model size : 217.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 12.941776037216187
Epoch: 1, Steps: 17 | Train Loss: 2.062 Vali Loss: 1.737 Vali Acc: 0.673 Test Loss: 1.737 Test Acc: 0.673
Validation loss decreased (inf --> -0.672956).  Saving model ...
Epoch: 2 cost time: 10.630646467208862
Epoch: 2, Steps: 17 | Train Loss: 1.350 Vali Loss: 0.974 Vali Acc: 0.892 Test Loss: 0.974 Test Acc: 0.892
Validation loss decreased (-0.672956 --> -0.891882).  Saving model ...
Epoch: 3 cost time: 11.538254261016846
Epoch: 3, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.429 Vali Acc: 0.941 Test Loss: 0.429 Test Acc: 0.941
Validation loss decreased (-0.891882 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 11.468101263046265
Epoch: 4, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 11.399871110916138
Epoch: 5, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 11.803490161895752
Epoch: 6, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.148386001586914
Epoch: 7, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.231997728347778
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 10.48891544342041
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 10.411282062530518
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 11 cost time: 10.93436598777771
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 10.13327169418335
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.180088758468628
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.633533239364624
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 10.613665103912354
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.047606229782104
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 10.594715595245361
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.832663297653198
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.93156886100769
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.8277907371521
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 11.424058437347412
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.812776327133179
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.460926294326782
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.174764156341553
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.084537744522095
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 11.43993353843689
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 16558473
model size : 65.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 25.941756010055542
Epoch: 1, Steps: 17 | Train Loss: 2.088 Vali Loss: 1.777 Vali Acc: 0.681 Test Loss: 1.777 Test Acc: 0.681
Validation loss decreased (inf --> -0.681063).  Saving model ...
Epoch: 2 cost time: 22.928834676742554
Epoch: 2, Steps: 17 | Train Loss: 1.359 Vali Loss: 0.934 Vali Acc: 0.857 Test Loss: 0.934 Test Acc: 0.857
Validation loss decreased (-0.681063 --> -0.856747).  Saving model ...
Epoch: 3 cost time: 21.840944528579712
Epoch: 3, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.382 Vali Acc: 0.932 Test Loss: 0.382 Test Acc: 0.932
Validation loss decreased (-0.856747 --> -0.932429).  Saving model ...
Epoch: 4 cost time: 22.21947693824768
Epoch: 4, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.249 Vali Acc: 0.935 Test Loss: 0.249 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 22.52797818183899
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.850175142288208
Epoch: 6, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.935133 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 22.58702850341797
Epoch: 7, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 22.451552152633667
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.954 Test Loss: 0.111 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.789429187774658
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.875519275665283
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.94344186782837
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.954 Test Loss: 0.114 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.380560398101807
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.884762048721313
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 21.059616088867188
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.327 Vali Acc: 0.914 Test Loss: 0.327 Test Acc: 0.914
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 20.785685777664185
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.487 Vali Acc: 0.835 Test Loss: 0.487 Test Acc: 0.835
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 20.641544342041016
Epoch: 16, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.258 Vali Acc: 0.924 Test Loss: 0.258 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 21.193589448928833
Epoch: 17, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 56275593
model size : 217.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.71583080291748
Epoch: 1, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.738 Vali Acc: 0.668 Test Loss: 1.738 Test Acc: 0.668
Validation loss decreased (inf --> -0.667550).  Saving model ...
Epoch: 2 cost time: 7.759127616882324
Epoch: 2, Steps: 17 | Train Loss: 1.350 Vali Loss: 0.972 Vali Acc: 0.892 Test Loss: 0.972 Test Acc: 0.892
Validation loss decreased (-0.667550 --> -0.891882).  Saving model ...
Epoch: 3 cost time: 7.872715950012207
Epoch: 3, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.430 Vali Acc: 0.941 Test Loss: 0.430 Test Acc: 0.941
Validation loss decreased (-0.891882 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 7.568974494934082
Epoch: 4, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.247 Vali Acc: 0.946 Test Loss: 0.247 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945943).  Saving model ...
Epoch: 5 cost time: 7.67883038520813
Epoch: 5, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 7.6834187507629395
Epoch: 6, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 7.5452399253845215
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.698270320892334
Epoch: 8, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 7.532959938049316
Epoch: 9, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.172119379043579
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 7.351507186889648
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.515734672546387
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.313870191574097
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 7.57555627822876
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 7.323385715484619
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.606955528259277
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.31325364112854
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.5309531688690186
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.109278917312622
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.36717414855957
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.070744037628174
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.282001972198486
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.116305589675903
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.448193550109863
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 16558473
model size : 65.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 14.36561918258667
Epoch: 1, Steps: 17 | Train Loss: 2.092 Vali Loss: 1.802 Vali Acc: 0.670 Test Loss: 1.802 Test Acc: 0.670
Validation loss decreased (inf --> -0.670252).  Saving model ...
Epoch: 2 cost time: 13.437738418579102
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.018 Vali Acc: 0.884 Test Loss: 1.018 Test Acc: 0.884
Validation loss decreased (-0.670252 --> -0.883774).  Saving model ...
Epoch: 3 cost time: 13.86969256401062
Epoch: 3, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.475 Vali Acc: 0.919 Test Loss: 0.475 Test Acc: 0.919
Validation loss decreased (-0.883774 --> -0.918914).  Saving model ...
Epoch: 4 cost time: 13.815449237823486
Epoch: 4, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.298 Vali Acc: 0.938 Test Loss: 0.298 Test Acc: 0.938
Validation loss decreased (-0.918914 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 13.636445760726929
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.638729572296143
Epoch: 6, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.937835 --> -0.964864).  Saving model ...
Epoch: 7 cost time: 13.264648199081421
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.661321878433228
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.364624738693237
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 13.116212844848633
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.943 Test Loss: 0.135 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.241799354553223
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.310469388961792
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.000626802444458
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.927735567092896
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.096992015838623
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.205 Vali Acc: 0.935 Test Loss: 0.205 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.215855121612549
Epoch: 16, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.226526260375977
Epoch: 17, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.197640419006348
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.274739742279053
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 56275593
model size : 217.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.551506757736206
Epoch: 1, Steps: 17 | Train Loss: 2.067 Vali Loss: 1.765 Vali Acc: 0.603 Test Loss: 1.765 Test Acc: 0.603
Validation loss decreased (inf --> -0.602685).  Saving model ...
Epoch: 2 cost time: 4.975104808807373
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.080 Vali Acc: 0.892 Test Loss: 1.080 Test Acc: 0.892
Validation loss decreased (-0.602685 --> -0.891881).  Saving model ...
Epoch: 3 cost time: 5.29807710647583
Epoch: 3, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.537 Vali Acc: 0.930 Test Loss: 0.537 Test Acc: 0.930
Validation loss decreased (-0.891881 --> -0.929724).  Saving model ...
Epoch: 4 cost time: 5.277965545654297
Epoch: 4, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.306 Vali Acc: 0.946 Test Loss: 0.306 Test Acc: 0.946
Validation loss decreased (-0.929724 --> -0.945943).  Saving model ...
Epoch: 5 cost time: 5.404526233673096
Epoch: 5, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 5.053294658660889
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.959458 --> -0.975674).  Saving model ...
Epoch: 7 cost time: 5.323115587234497
Epoch: 7, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.146087884902954
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.120893478393555
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.29739236831665
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.13588285446167
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.311345338821411
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.099402904510498
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.135606288909912
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.353575706481934
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.162821054458618
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 5.3192784786224365
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.136444330215454
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.149749755859375
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.163726329803467
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.411500692367554
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.492863416671753
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.439810514450073
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.484092950820923
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.498101711273193
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.504728317260742
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 16558473
model size : 65.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 18.26900053024292
Epoch: 1, Steps: 17 | Train Loss: 2.134 Vali Loss: 1.835 Vali Acc: 0.597 Test Loss: 1.835 Test Acc: 0.597
Validation loss decreased (inf --> -0.597279).  Saving model ...
Epoch: 2 cost time: 15.854292392730713
Epoch: 2, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.111 Vali Acc: 0.886 Test Loss: 1.111 Test Acc: 0.886
Validation loss decreased (-0.597279 --> -0.886475).  Saving model ...
Epoch: 3 cost time: 16.373708963394165
Epoch: 3, Steps: 17 | Train Loss: 0.786 Vali Loss: 0.490 Vali Acc: 0.935 Test Loss: 0.490 Test Acc: 0.935
Validation loss decreased (-0.886475 --> -0.935130).  Saving model ...
Epoch: 4 cost time: 16.190112829208374
Epoch: 4, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.263 Vali Acc: 0.943 Test Loss: 0.263 Test Acc: 0.943
Validation loss decreased (-0.935130 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 15.10177206993103
Epoch: 5, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.943241 --> -0.962161).  Saving model ...
Epoch: 6 cost time: 16.44994831085205
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.564152479171753
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 16.140321493148804
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 16.342840433120728
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.471972227096558
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.965 Test Loss: 0.085 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 16.519103288650513
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 14.885919332504272
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.625253677368164
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 16.605093002319336
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.641906023025513
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.09927225112915
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.95142912864685
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.435189962387085
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 15.47977900505066
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.172122716903687
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 16.27099323272705
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 16.486071586608887
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 15.932860374450684
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 15.31832242012024
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 15.134133100509644
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 15.210232734680176
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 16.07207465171814
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 16.027413845062256
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 15.136977672576904
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 14.739222764968872
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 28158345
model size : 109.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.113303899765015
Epoch: 1, Steps: 17 | Train Loss: 2.130 Vali Loss: 1.864 Vali Acc: 0.627 Test Loss: 1.864 Test Acc: 0.627
Validation loss decreased (inf --> -0.627008).  Saving model ...
Epoch: 2 cost time: 5.52583122253418
Epoch: 2, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.170 Vali Acc: 0.889 Test Loss: 1.170 Test Acc: 0.889
Validation loss decreased (-0.627008 --> -0.889177).  Saving model ...
Epoch: 3 cost time: 5.85052227973938
Epoch: 3, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.586 Vali Acc: 0.916 Test Loss: 0.586 Test Acc: 0.916
Validation loss decreased (-0.889177 --> -0.916210).  Saving model ...
Epoch: 4 cost time: 5.8274595737457275
Epoch: 4, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.916210 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 5.729953289031982
Epoch: 5, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (-0.940538 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 6.025122880935669
Epoch: 6, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.222503662109375
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 6.312063217163086
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.2785985469818115
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.31165623664856
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.37152099609375
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.416995048522949
Epoch: 12, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 6.398906230926514
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.383147239685059
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.002401113510132
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.010861873626709
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.950133800506592
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.944958686828613
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.034825563430786
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.97455620765686
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.838790655136108
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.954413890838623
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 8299401
model size : 34.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 12.119304180145264
Epoch: 1, Steps: 17 | Train Loss: 2.135 Vali Loss: 1.836 Vali Acc: 0.597 Test Loss: 1.836 Test Acc: 0.597
Validation loss decreased (inf --> -0.597279).  Saving model ...
Epoch: 2 cost time: 10.218626022338867
Epoch: 2, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.112 Vali Acc: 0.889 Test Loss: 1.112 Test Acc: 0.889
Validation loss decreased (-0.597279 --> -0.889178).  Saving model ...
Epoch: 3 cost time: 10.375093221664429
Epoch: 3, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.494 Vali Acc: 0.935 Test Loss: 0.494 Test Acc: 0.935
Validation loss decreased (-0.889178 --> -0.935130).  Saving model ...
Epoch: 4 cost time: 10.252975702285767
Epoch: 4, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.270 Vali Acc: 0.943 Test Loss: 0.270 Test Acc: 0.943
Validation loss decreased (-0.935130 --> -0.943241).  Saving model ...
Epoch: 5 cost time: 10.344430923461914
Epoch: 5, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 10.436821222305298
Epoch: 6, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 10.552785158157349
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 10.713897466659546
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 10.597670316696167
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.576624155044556
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.215432405471802
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 11.112138271331787
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.126790523529053
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 11.184558868408203
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.136602878570557
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.397271394729614
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.479316234588623
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.384163618087769
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.365184545516968
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.034126996994019
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.329222679138184
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.209365129470825
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 23 cost time: 10.275063753128052
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.272414922714233
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.602036237716675
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 10.888879537582397
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.504406690597534
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.487375974655151
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 10.414712905883789
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 10.526201248168945
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 28158345
model size : 109.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.500782251358032
Epoch: 1, Steps: 17 | Train Loss: 2.130 Vali Loss: 1.865 Vali Acc: 0.624 Test Loss: 1.865 Test Acc: 0.624
Validation loss decreased (inf --> -0.624306).  Saving model ...
Epoch: 2 cost time: 4.504877090454102
Epoch: 2, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.171 Vali Acc: 0.895 Test Loss: 1.171 Test Acc: 0.895
Validation loss decreased (-0.624306 --> -0.894583).  Saving model ...
Epoch: 3 cost time: 4.599277496337891
Epoch: 3, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.587 Vali Acc: 0.916 Test Loss: 0.587 Test Acc: 0.916
Validation loss decreased (-0.894583 --> -0.916210).  Saving model ...
Epoch: 4 cost time: 4.5573296546936035
Epoch: 4, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.300 Vali Acc: 0.935 Test Loss: 0.300 Test Acc: 0.935
Validation loss decreased (-0.916210 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 4.5867018699646
Epoch: 5, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 4.591986179351807
Epoch: 6, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 4.611770868301392
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 4.606220483779907
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.180 Vali Acc: 0.935 Test Loss: 0.180 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.566713571548462
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.644624948501587
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 4.595184564590454
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.2767322063446045
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 4.219512939453125
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 4.241201877593994
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.2004969120025635
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7687323093414307
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.108161926269531
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8631553649902344
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 4.153838396072388
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.079020977020264
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.173307418823242
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 4.38276219367981
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.265088319778442
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.047976493835449
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.594243764877319
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.6314661502838135
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.527509927749634
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.622347116470337
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.497580528259277
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.62553596496582
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 8299401
model size : 34.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.531123399734497
Epoch: 1, Steps: 17 | Train Loss: 2.137 Vali Loss: 1.846 Vali Acc: 0.573 Test Loss: 1.846 Test Acc: 0.573
Validation loss decreased (inf --> -0.572955).  Saving model ...
Epoch: 2 cost time: 5.901813507080078
Epoch: 2, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.185 Vali Acc: 0.884 Test Loss: 1.185 Test Acc: 0.884
Validation loss decreased (-0.572955 --> -0.883772).  Saving model ...
Epoch: 3 cost time: 5.552876949310303
Epoch: 3, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.592 Vali Acc: 0.941 Test Loss: 0.592 Test Acc: 0.941
Validation loss decreased (-0.883772 --> -0.940535).  Saving model ...
Epoch: 4 cost time: 5.709253311157227
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.313 Vali Acc: 0.946 Test Loss: 0.313 Test Acc: 0.946
Validation loss decreased (-0.940535 --> -0.945943).  Saving model ...
Epoch: 5 cost time: 5.838706016540527
Epoch: 5, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 5.724406957626343
Epoch: 6, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 5.722045660018921
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.998084306716919
Epoch: 8, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.037788152694702
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 5.942638874053955
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.976571321487427
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.041256666183472
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.0154149532318115
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.991410255432129
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.978541374206543
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.9386608600616455
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.670740604400635
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.190381050109863
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.096016883850098
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 28158345
model size : 109.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.359541654586792
Epoch: 1, Steps: 17 | Train Loss: 2.133 Vali Loss: 1.878 Vali Acc: 0.616 Test Loss: 1.878 Test Acc: 0.616
Validation loss decreased (inf --> -0.616197).  Saving model ...
Epoch: 2 cost time: 2.6907293796539307
Epoch: 2, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.229 Vali Acc: 0.895 Test Loss: 1.229 Test Acc: 0.895
Validation loss decreased (-0.616197 --> -0.894582).  Saving model ...
Epoch: 3 cost time: 2.684506893157959
Epoch: 3, Steps: 17 | Train Loss: 0.899 Vali Loss: 0.666 Vali Acc: 0.927 Test Loss: 0.666 Test Acc: 0.927
Validation loss decreased (-0.894582 --> -0.927020).  Saving model ...
Epoch: 4 cost time: 2.8004863262176514
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.335 Vali Acc: 0.957 Test Loss: 0.335 Test Acc: 0.957
Validation loss decreased (-0.927020 --> -0.956753).  Saving model ...
Epoch: 5 cost time: 2.6545755863189697
Epoch: 5, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7939321994781494
Epoch: 6, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.956753 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 2.566704034805298
Epoch: 7, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 3.0980000495910645
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 3.097675085067749
Epoch: 9, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 3.049072504043579
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 3.1289706230163574
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.072305917739868
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.077655553817749
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1867737770080566
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.073169469833374
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 3.153075933456421
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0991718769073486
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9863221645355225
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 3.0862817764282227
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0841944217681885
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 2.8038690090179443
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.00449275970459
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9693238735198975
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8996822834014893
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 2.9631049633026123
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8861947059631348
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9846558570861816
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.91725492477417
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9519519805908203
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.914137840270996
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 8299401
model size : 34.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 19.50350260734558
Epoch: 1, Steps: 17 | Train Loss: 2.135 Vali Loss: 1.965 Vali Acc: 0.395 Test Loss: 1.965 Test Acc: 0.395
Validation loss decreased (inf --> -0.394575).  Saving model ...
Epoch: 2 cost time: 18.467437982559204
Epoch: 2, Steps: 17 | Train Loss: 1.694 Vali Loss: 1.396 Vali Acc: 0.849 Test Loss: 1.396 Test Acc: 0.849
Validation loss decreased (-0.394575 --> -0.848635).  Saving model ...
Epoch: 3 cost time: 18.193132162094116
Epoch: 3, Steps: 17 | Train Loss: 1.131 Vali Loss: 0.920 Vali Acc: 0.824 Test Loss: 0.920 Test Acc: 0.824
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.299248456954956
Epoch: 4, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.552 Vali Acc: 0.886 Test Loss: 0.552 Test Acc: 0.886
Validation loss decreased (-0.848635 --> -0.886481).  Saving model ...
Epoch: 5 cost time: 16.531516551971436
Epoch: 5, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.314 Vali Acc: 0.938 Test Loss: 0.314 Test Acc: 0.938
Validation loss decreased (-0.886481 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 17.799156665802002
Epoch: 6, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 17.79964280128479
Epoch: 7, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.365755319595337
Epoch: 8, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 18.443159818649292
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.05941414833069
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 19.686347007751465
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.280 Vali Acc: 0.914 Test Loss: 0.280 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.897216081619263
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.77466869354248
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.56045436859131
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 20.861551761627197
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.303133964538574
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.932 Test Loss: 0.191 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.038387298583984
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.91267681121826
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 19.26880955696106
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 20.514766216278076
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 28140105
model size : 108.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.581363677978516
Epoch: 1, Steps: 17 | Train Loss: 2.139 Vali Loss: 1.998 Vali Acc: 0.403 Test Loss: 1.998 Test Acc: 0.403
Validation loss decreased (inf --> -0.402683).  Saving model ...
Epoch: 2 cost time: 6.126259088516235
Epoch: 2, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.459 Vali Acc: 0.789 Test Loss: 1.459 Test Acc: 0.789
Validation loss decreased (-0.402683 --> -0.789175).  Saving model ...
Epoch: 3 cost time: 6.422553062438965
Epoch: 3, Steps: 17 | Train Loss: 1.188 Vali Loss: 0.957 Vali Acc: 0.843 Test Loss: 0.957 Test Acc: 0.843
Validation loss decreased (-0.789175 --> -0.843234).  Saving model ...
Epoch: 4 cost time: 6.939829349517822
Epoch: 4, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.566 Vali Acc: 0.922 Test Loss: 0.566 Test Acc: 0.922
Validation loss decreased (-0.843234 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 7.6317198276519775
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.355 Vali Acc: 0.943 Test Loss: 0.355 Test Acc: 0.943
Validation loss decreased (-0.921616 --> -0.943240).  Saving model ...
Epoch: 6 cost time: 7.711142063140869
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.251 Vali Acc: 0.938 Test Loss: 0.251 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.402225494384766
Epoch: 7, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.228 Vali Acc: 0.938 Test Loss: 0.228 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.24483585357666
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
Validation loss decreased (-0.943240 --> -0.975674).  Saving model ...
Epoch: 9 cost time: 7.573809623718262
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.012755870819092
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.093414783477783
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.730564594268799
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.928688049316406
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.288341283798218
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.0744948387146
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.831015348434448
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.413546323776245
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.964418888092041
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 8280777
model size : 32.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 15.320667743682861
Epoch: 1, Steps: 17 | Train Loss: 2.135 Vali Loss: 1.965 Vali Acc: 0.392 Test Loss: 1.965 Test Acc: 0.392
Validation loss decreased (inf --> -0.391872).  Saving model ...
Epoch: 2 cost time: 13.34453535079956
Epoch: 2, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.396 Vali Acc: 0.849 Test Loss: 1.396 Test Acc: 0.849
Validation loss decreased (-0.391872 --> -0.848635).  Saving model ...
Epoch: 3 cost time: 13.338120937347412
Epoch: 3, Steps: 17 | Train Loss: 1.132 Vali Loss: 0.921 Vali Acc: 0.824 Test Loss: 0.921 Test Acc: 0.824
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.846482992172241
Epoch: 4, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.551 Vali Acc: 0.886 Test Loss: 0.551 Test Acc: 0.886
Validation loss decreased (-0.848635 --> -0.886481).  Saving model ...
Epoch: 5 cost time: 9.589744329452515
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.314 Vali Acc: 0.943 Test Loss: 0.314 Test Acc: 0.943
Validation loss decreased (-0.886481 --> -0.943240).  Saving model ...
Epoch: 6 cost time: 13.013005495071411
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 14.104517936706543
Epoch: 7, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.459528684616089
Epoch: 8, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 13.32524824142456
Epoch: 9, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 13.218133211135864
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 12.748084545135498
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.489686489105225
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 14.199214220046997
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.410 Vali Acc: 0.873 Test Loss: 0.410 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.495944023132324
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.43664836883545
Epoch: 15, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.333 Vali Acc: 0.876 Test Loss: 0.333 Test Acc: 0.876
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.559017419815063
Epoch: 16, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.458297491073608
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.550643682479858
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.78212833404541
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.019938945770264
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.455763101577759
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.146227359771729
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 28140105
model size : 108.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.165879726409912
Epoch: 1, Steps: 17 | Train Loss: 2.139 Vali Loss: 1.999 Vali Acc: 0.403 Test Loss: 1.999 Test Acc: 0.403
Validation loss decreased (inf --> -0.402683).  Saving model ...
Epoch: 2 cost time: 6.253982305526733
Epoch: 2, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.458 Vali Acc: 0.792 Test Loss: 1.458 Test Acc: 0.792
Validation loss decreased (-0.402683 --> -0.791877).  Saving model ...
Epoch: 3 cost time: 5.769611835479736
Epoch: 3, Steps: 17 | Train Loss: 1.188 Vali Loss: 0.957 Vali Acc: 0.843 Test Loss: 0.957 Test Acc: 0.843
Validation loss decreased (-0.791877 --> -0.843234).  Saving model ...
Epoch: 4 cost time: 5.370052099227905
Epoch: 4, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.569 Vali Acc: 0.922 Test Loss: 0.569 Test Acc: 0.922
Validation loss decreased (-0.843234 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 5.339590311050415
Epoch: 5, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.358 Vali Acc: 0.946 Test Loss: 0.358 Test Acc: 0.946
Validation loss decreased (-0.921616 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 5.155523777008057
Epoch: 6, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.73597526550293
Epoch: 7, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.627186059951782
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.945942 --> -0.975674).  Saving model ...
Epoch: 9 cost time: 5.410414934158325
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.25106143951416
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.525043964385986
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.549140214920044
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.725115776062012
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.63447642326355
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.662451505661011
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.584224700927734
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.341240882873535
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.210944890975952
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 8280777
model size : 32.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.393242835998535
Epoch: 1, Steps: 17 | Train Loss: 2.138 Vali Loss: 1.979 Vali Acc: 0.368 Test Loss: 1.979 Test Acc: 0.368
Validation loss decreased (inf --> -0.367548).  Saving model ...
Epoch: 2 cost time: 6.573422193527222
Epoch: 2, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.485 Vali Acc: 0.819 Test Loss: 1.485 Test Acc: 0.819
Validation loss decreased (-0.367548 --> -0.818904).  Saving model ...
Epoch: 3 cost time: 7.471710920333862
Epoch: 3, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.027 Vali Acc: 0.868 Test Loss: 1.027 Test Acc: 0.868
Validation loss decreased (-0.818904 --> -0.867557).  Saving model ...
Epoch: 4 cost time: 7.383070468902588
Epoch: 4, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.662 Vali Acc: 0.908 Test Loss: 0.662 Test Acc: 0.908
Validation loss decreased (-0.867557 --> -0.908101).  Saving model ...
Epoch: 5 cost time: 7.088318824768066
Epoch: 5, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.406 Vali Acc: 0.938 Test Loss: 0.406 Test Acc: 0.938
Validation loss decreased (-0.908101 --> -0.937834).  Saving model ...
Epoch: 6 cost time: 6.85557746887207
Epoch: 6, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.254 Vali Acc: 0.968 Test Loss: 0.254 Test Acc: 0.968
Validation loss decreased (-0.937834 --> -0.967565).  Saving model ...
Epoch: 7 cost time: 7.432501316070557
Epoch: 7, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.916902780532837
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.622354984283447
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.967565 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 6.79315972328186
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.329509496688843
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.625816345214844
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.34323525428772
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.898471355438232
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.632238864898682
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.609747409820557
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.6489667892456055
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.933896541595459
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 7.888378620147705
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.159299612045288
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.240405797958374
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 6.080821990966797
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 6.195833921432495
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.956719636917114
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.814327239990234
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.82231879234314
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.8185014724731445
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 28 cost time: 6.9122583866119385
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 29 cost time: 6.79504919052124
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 30 cost time: 6.942206859588623
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 28140105
model size : 108.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.75741720199585
Epoch: 1, Steps: 17 | Train Loss: 2.141 Vali Loss: 2.015 Vali Acc: 0.365 Test Loss: 2.015 Test Acc: 0.365
Validation loss decreased (inf --> -0.364845).  Saving model ...
Epoch: 2 cost time: 3.0498108863830566
Epoch: 2, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.543 Vali Acc: 0.786 Test Loss: 1.543 Test Acc: 0.786
Validation loss decreased (-0.364845 --> -0.786471).  Saving model ...
Epoch: 3 cost time: 3.0864219665527344
Epoch: 3, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.098 Vali Acc: 0.857 Test Loss: 1.098 Test Acc: 0.857
Validation loss decreased (-0.786471 --> -0.856746).  Saving model ...
Epoch: 4 cost time: 3.211676597595215
Epoch: 4, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.689 Vali Acc: 0.919 Test Loss: 0.689 Test Acc: 0.919
Validation loss decreased (-0.856746 --> -0.918912).  Saving model ...
Epoch: 5 cost time: 2.8177998065948486
Epoch: 5, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.436 Vali Acc: 0.962 Test Loss: 0.436 Test Acc: 0.962
Validation loss decreased (-0.918912 --> -0.962158).  Saving model ...
Epoch: 6 cost time: 3.8239099979400635
Epoch: 6, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.301 Vali Acc: 0.965 Test Loss: 0.301 Test Acc: 0.965
Validation loss decreased (-0.962158 --> -0.964862).  Saving model ...
Epoch: 7 cost time: 3.94643497467041
Epoch: 7, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
Validation loss decreased (-0.964862 --> -0.970268).  Saving model ...
Epoch: 8 cost time: 4.000746965408325
Epoch: 8, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.175 Vali Acc: 0.976 Test Loss: 0.175 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975674).  Saving model ...
Epoch: 9 cost time: 4.163452386856079
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 10 cost time: 3.7227275371551514
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
Validation loss decreased (-0.975674 --> -0.981080).  Saving model ...
Epoch: 11 cost time: 3.972208023071289
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.058316469192505
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.932783365249634
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.904930830001831
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.033671855926514
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.121575355529785
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.837810516357422
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.923285961151123
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.8661675453186035
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.5391111373901367
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 8280777
model size : 32.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.758503198623657
Epoch: 1, Steps: 17 | Train Loss: 2.083 Vali Loss: 1.935 Vali Acc: 0.362 Test Loss: 1.935 Test Acc: 0.362
Validation loss decreased (inf --> -0.362143).  Saving model ...
Epoch: 2 cost time: 10.750950813293457
Epoch: 2, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.520 Vali Acc: 0.754 Test Loss: 1.520 Test Acc: 0.754
Validation loss decreased (-0.362143 --> -0.754039).  Saving model ...
Epoch: 3 cost time: 10.948622941970825
Epoch: 3, Steps: 17 | Train Loss: 1.237 Vali Loss: 0.984 Vali Acc: 0.889 Test Loss: 0.984 Test Acc: 0.889
Validation loss decreased (-0.754039 --> -0.889179).  Saving model ...
Epoch: 4 cost time: 10.942178964614868
Epoch: 4, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.563 Vali Acc: 0.946 Test Loss: 0.563 Test Acc: 0.946
Validation loss decreased (-0.889179 --> -0.945940).  Saving model ...
Epoch: 5 cost time: 10.848260641098022
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.354 Vali Acc: 0.959 Test Loss: 0.354 Test Acc: 0.959
Validation loss decreased (-0.945940 --> -0.959456).  Saving model ...
Epoch: 6 cost time: 11.773138046264648
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.360 Vali Acc: 0.908 Test Loss: 0.360 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.402593612670898
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
Validation loss decreased (-0.959456 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 10.243401288986206
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.246 Vali Acc: 0.943 Test Loss: 0.246 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.672563552856445
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.629613161087036
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.475944757461548
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.68591856956482
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 10.34862208366394
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 10.267551183700562
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.359582901000977
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 9.252824068069458
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.46497130393982
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.21676516532898
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 10.790677547454834
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 9.758817672729492
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.469152212142944
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.45305871963501
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.024435758590698
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 10.29578709602356
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.240958213806152
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.804629564285278
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.888629674911499
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 10.978870868682861
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 10.624322891235352
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 14080329
model size : 54.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.774179220199585
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.046 Vali Acc: 0.343 Test Loss: 2.046 Test Acc: 0.343
Validation loss decreased (inf --> -0.343223).  Saving model ...
Epoch: 2 cost time: 3.5845401287078857
Epoch: 2, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.628 Vali Acc: 0.786 Test Loss: 1.628 Test Acc: 0.786
Validation loss decreased (-0.343223 --> -0.786470).  Saving model ...
Epoch: 3 cost time: 4.0442163944244385
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.128 Vali Acc: 0.889 Test Loss: 1.128 Test Acc: 0.889
Validation loss decreased (-0.786470 --> -0.889178).  Saving model ...
Epoch: 4 cost time: 4.477818250656128
Epoch: 4, Steps: 17 | Train Loss: 0.889 Vali Loss: 0.698 Vali Acc: 0.908 Test Loss: 0.698 Test Acc: 0.908
Validation loss decreased (-0.889178 --> -0.908101).  Saving model ...
Epoch: 5 cost time: 4.557337999343872
Epoch: 5, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.446 Vali Acc: 0.941 Test Loss: 0.446 Test Acc: 0.941
Validation loss decreased (-0.908101 --> -0.940536).  Saving model ...
Epoch: 6 cost time: 4.444041013717651
Epoch: 6, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.275 Vali Acc: 0.970 Test Loss: 0.275 Test Acc: 0.970
Validation loss decreased (-0.940536 --> -0.970268).  Saving model ...
Epoch: 7 cost time: 3.6496706008911133
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970268).  Saving model ...
Epoch: 8 cost time: 4.034483194351196
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 4.173621416091919
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.095504522323608
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.097187757492065
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.076880693435669
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.02932071685791
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 4.065007925033569
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5389795303344727
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 3.568777084350586
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4002246856689453
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 3.597454071044922
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.512997627258301
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.519096851348877
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.959 Test Loss: 0.096 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.6949520111083984
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.973 Test Loss: 0.067 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.262441873550415
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6204071044921875
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.292 Vali Acc: 0.914 Test Loss: 0.292 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.400702476501465
Epoch: 24, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.210 Vali Acc: 0.924 Test Loss: 0.210 Test Acc: 0.924
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.013263463973999
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.404525518417358
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.079624176025391
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 4150473
model size : 17.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.64330005645752
Epoch: 1, Steps: 17 | Train Loss: 2.083 Vali Loss: 1.936 Vali Acc: 0.362 Test Loss: 1.936 Test Acc: 0.362
Validation loss decreased (inf --> -0.362143).  Saving model ...
Epoch: 2 cost time: 7.027434825897217
Epoch: 2, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.522 Vali Acc: 0.754 Test Loss: 1.522 Test Acc: 0.754
Validation loss decreased (-0.362143 --> -0.754039).  Saving model ...
Epoch: 3 cost time: 7.103051424026489
Epoch: 3, Steps: 17 | Train Loss: 1.238 Vali Loss: 0.986 Vali Acc: 0.889 Test Loss: 0.986 Test Acc: 0.889
Validation loss decreased (-0.754039 --> -0.889179).  Saving model ...
Epoch: 4 cost time: 6.908049583435059
Epoch: 4, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.565 Vali Acc: 0.946 Test Loss: 0.565 Test Acc: 0.946
Validation loss decreased (-0.889179 --> -0.945940).  Saving model ...
Epoch: 5 cost time: 7.228990077972412
Epoch: 5, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.358 Vali Acc: 0.957 Test Loss: 0.358 Test Acc: 0.957
Validation loss decreased (-0.945940 --> -0.956753).  Saving model ...
Epoch: 6 cost time: 7.126375198364258
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.369 Vali Acc: 0.908 Test Loss: 0.369 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.090154647827148
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.196 Vali Acc: 0.968 Test Loss: 0.196 Test Acc: 0.968
Validation loss decreased (-0.956753 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 6.451032400131226
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.598382949829102
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.08693790435791
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.505795955657959
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.363958358764648
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 13 cost time: 6.356645584106445
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 6.2501609325408936
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.3629889488220215
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 6.388974666595459
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.4055116176605225
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 18 cost time: 6.478642463684082
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 6.604235410690308
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.399864435195923
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.166569471359253
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.373513460159302
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.76756739616394
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.719393968582153
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.760968923568726
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.787071466445923
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.548832654953003
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.911883354187012
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 14080329
model size : 54.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.840745210647583
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.046 Vali Acc: 0.343 Test Loss: 2.046 Test Acc: 0.343
Validation loss decreased (inf --> -0.343223).  Saving model ...
Epoch: 2 cost time: 3.6069066524505615
Epoch: 2, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.628 Vali Acc: 0.786 Test Loss: 1.628 Test Acc: 0.786
Validation loss decreased (-0.343223 --> -0.786470).  Saving model ...
Epoch: 3 cost time: 3.8939719200134277
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.127 Vali Acc: 0.889 Test Loss: 1.127 Test Acc: 0.889
Validation loss decreased (-0.786470 --> -0.889178).  Saving model ...
Epoch: 4 cost time: 4.016883373260498
Epoch: 4, Steps: 17 | Train Loss: 0.889 Vali Loss: 0.699 Vali Acc: 0.908 Test Loss: 0.699 Test Acc: 0.908
Validation loss decreased (-0.889178 --> -0.908101).  Saving model ...
Epoch: 5 cost time: 3.8639564514160156
Epoch: 5, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.447 Vali Acc: 0.941 Test Loss: 0.447 Test Acc: 0.941
Validation loss decreased (-0.908101 --> -0.940536).  Saving model ...
Epoch: 6 cost time: 3.7984395027160645
Epoch: 6, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.276 Vali Acc: 0.968 Test Loss: 0.276 Test Acc: 0.968
Validation loss decreased (-0.940536 --> -0.967565).  Saving model ...
Epoch: 7 cost time: 3.9667205810546875
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7910494804382324
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.967565 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 3.894801378250122
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9654107093811035
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.642066717147827
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9642670154571533
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.075491666793823
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 3.9083080291748047
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.949 Test Loss: 0.142 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.076807975769043
Epoch: 15, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 16 cost time: 3.479236125946045
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6774418354034424
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8280487060546875
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 3.516388416290283
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.709012985229492
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.916749954223633
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 22 cost time: 3.6552860736846924
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 23 cost time: 4.020307540893555
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.165940761566162
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.080501556396484
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9906647205352783
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.208176851272583
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.040875673294067
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.9275405406951904
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.9629921913146973
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 4150473
model size : 17.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.510711193084717
Epoch: 1, Steps: 17 | Train Loss: 2.084 Vali Loss: 1.944 Vali Acc: 0.346 Test Loss: 1.944 Test Acc: 0.346
Validation loss decreased (inf --> -0.345927).  Saving model ...
Epoch: 2 cost time: 4.350118160247803
Epoch: 2, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.569 Vali Acc: 0.751 Test Loss: 1.569 Test Acc: 0.751
Validation loss decreased (-0.345927 --> -0.751336).  Saving model ...
Epoch: 3 cost time: 4.43839168548584
Epoch: 3, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.091 Vali Acc: 0.911 Test Loss: 1.091 Test Acc: 0.911
Validation loss decreased (-0.751336 --> -0.910800).  Saving model ...
Epoch: 4 cost time: 4.329730749130249
Epoch: 4, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.687 Vali Acc: 0.949 Test Loss: 0.687 Test Acc: 0.949
Validation loss decreased (-0.910800 --> -0.948642).  Saving model ...
Epoch: 5 cost time: 4.462437629699707
Epoch: 5, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.432 Vali Acc: 0.957 Test Loss: 0.432 Test Acc: 0.957
Validation loss decreased (-0.948642 --> -0.956752).  Saving model ...
Epoch: 6 cost time: 4.2057623863220215
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.333 Vali Acc: 0.932 Test Loss: 0.333 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.409351825714111
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
Validation loss decreased (-0.956752 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 4.277578353881836
Epoch: 8, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 4.119615316390991
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 4.111733913421631
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 4.341870307922363
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.049527168273926
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 4.369969367980957
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.152539253234863
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.882951259613037
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 4.465106964111328
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.6005213260650635
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.522750616073608
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.379710912704468
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.689619779586792
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.469118118286133
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.26753830909729
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.092616081237793
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.69946026802063
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.431311368942261
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 14080329
model size : 54.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.514642715454102
Epoch: 1, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.055 Vali Acc: 0.324 Test Loss: 2.055 Test Acc: 0.324
Validation loss decreased (inf --> -0.324304).  Saving model ...
Epoch: 2 cost time: 2.8133223056793213
Epoch: 2, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.671 Vali Acc: 0.800 Test Loss: 1.671 Test Acc: 0.800
Validation loss decreased (-0.324304 --> -0.799983).  Saving model ...
Epoch: 3 cost time: 2.322852373123169
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.227 Vali Acc: 0.900 Test Loss: 1.227 Test Acc: 0.900
Validation loss decreased (-0.799983 --> -0.899988).  Saving model ...
Epoch: 4 cost time: 2.462509870529175
Epoch: 4, Steps: 17 | Train Loss: 0.986 Vali Loss: 0.812 Vali Acc: 0.905 Test Loss: 0.812 Test Acc: 0.905
Validation loss decreased (-0.899988 --> -0.905397).  Saving model ...
Epoch: 5 cost time: 2.5652551651000977
Epoch: 5, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.548 Vali Acc: 0.924 Test Loss: 0.548 Test Acc: 0.924
Validation loss decreased (-0.905397 --> -0.924319).  Saving model ...
Epoch: 6 cost time: 2.4469220638275146
Epoch: 6, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.368 Vali Acc: 0.949 Test Loss: 0.368 Test Acc: 0.949
Validation loss decreased (-0.924319 --> -0.948645).  Saving model ...
Epoch: 7 cost time: 2.544604778289795
Epoch: 7, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.269 Vali Acc: 0.954 Test Loss: 0.269 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 8 cost time: 2.7170238494873047
Epoch: 8, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 9 cost time: 2.3111064434051514
Epoch: 9, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1823785305023193
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 2.4141204357147217
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 2.356579542160034
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6179823875427246
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.295583486557007
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3826754093170166
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6247365474700928
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3459694385528564
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6448066234588623
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.6794235706329346
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.519803524017334
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8055241107940674
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6902220249176025
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.6155316829681396
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 4150473
model size : 17.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.050959825515747
Epoch: 1, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.081 Vali Acc: 0.238 Test Loss: 2.081 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 7.499808073043823
Epoch: 2, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.713 Vali Acc: 0.662 Test Loss: 1.713 Test Acc: 0.662
Validation loss decreased (-0.237817 --> -0.662145).  Saving model ...
Epoch: 3 cost time: 7.2828803062438965
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.247 Vali Acc: 0.846 Test Loss: 1.247 Test Acc: 0.846
Validation loss decreased (-0.662145 --> -0.845933).  Saving model ...
Epoch: 4 cost time: 7.272905349731445
Epoch: 4, Steps: 17 | Train Loss: 0.973 Vali Loss: 0.807 Vali Acc: 0.857 Test Loss: 0.807 Test Acc: 0.857
Validation loss decreased (-0.845933 --> -0.856749).  Saving model ...
Epoch: 5 cost time: 7.390949010848999
Epoch: 5, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.533 Vali Acc: 0.903 Test Loss: 0.533 Test Acc: 0.903
Validation loss decreased (-0.856749 --> -0.902697).  Saving model ...
Epoch: 6 cost time: 7.1071436405181885
Epoch: 6, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.355 Vali Acc: 0.927 Test Loss: 0.355 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927023).  Saving model ...
Epoch: 7 cost time: 7.049137830734253
Epoch: 7, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927024).  Saving model ...
Epoch: 8 cost time: 5.276117563247681
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
Validation loss decreased (-0.927024 --> -0.948646).  Saving model ...
Epoch: 9 cost time: 5.684356451034546
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 5.51765251159668
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 6.988026142120361
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.173 Vali Acc: 0.938 Test Loss: 0.173 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.948600769042969
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.941 Test Loss: 0.152 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.955380201339722
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 7.06380295753479
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.138 Vali Acc: 0.943 Test Loss: 0.138 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.979983329772949
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.949 Test Loss: 0.123 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.03581976890564
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.954 Test Loss: 0.116 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.977560043334961
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.81999659538269
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.860772132873535
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.914728879928589
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.250247955322266
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.252727746963501
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.213869094848633
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 7050441
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.200404405593872
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.115 Vali Acc: 0.257 Test Loss: 2.115 Test Acc: 0.257
Validation loss decreased (inf --> -0.256736).  Saving model ...
Epoch: 2 cost time: 3.6240813732147217
Epoch: 2, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.733 Vali Acc: 0.668 Test Loss: 1.733 Test Acc: 0.668
Validation loss decreased (-0.256736 --> -0.667550).  Saving model ...
Epoch: 3 cost time: 3.503664016723633
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.280 Vali Acc: 0.862 Test Loss: 1.280 Test Acc: 0.862
Validation loss decreased (-0.667550 --> -0.862149).  Saving model ...
Epoch: 4 cost time: 3.8416714668273926
Epoch: 4, Steps: 17 | Train Loss: 1.048 Vali Loss: 0.871 Vali Acc: 0.870 Test Loss: 0.871 Test Acc: 0.870
Validation loss decreased (-0.862149 --> -0.870262).  Saving model ...
Epoch: 5 cost time: 3.876782178878784
Epoch: 5, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
Validation loss decreased (-0.870262 --> -0.878372).  Saving model ...
Epoch: 6 cost time: 4.113834619522095
Epoch: 6, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.391 Vali Acc: 0.932 Test Loss: 0.391 Test Acc: 0.932
Validation loss decreased (-0.878372 --> -0.932429).  Saving model ...
Epoch: 7 cost time: 3.8619022369384766
Epoch: 7, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.338 Vali Acc: 0.914 Test Loss: 0.338 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.032220840454102
Epoch: 8, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
Validation loss decreased (-0.932429 --> -0.948646).  Saving model ...
Epoch: 9 cost time: 4.047071218490601
Epoch: 9, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.948646 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 3.7068865299224854
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 4.095240116119385
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 3.835099935531616
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.083547830581665
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4536075592041016
Epoch: 14, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.538203001022339
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6797146797180176
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 3.411707878112793
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.344879388809204
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3426125049591064
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9915130138397217
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1527905464172363
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.248941659927368
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.346409559249878
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.551828622817993
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.606517791748047
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.7190966606140137
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2085321
model size : 9.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.905344247817993
Epoch: 1, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.081 Vali Acc: 0.238 Test Loss: 2.081 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 4.913747549057007
Epoch: 2, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.714 Vali Acc: 0.662 Test Loss: 1.714 Test Acc: 0.662
Validation loss decreased (-0.237817 --> -0.662145).  Saving model ...
Epoch: 3 cost time: 5.86209774017334
Epoch: 3, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.248 Vali Acc: 0.846 Test Loss: 1.248 Test Acc: 0.846
Validation loss decreased (-0.662145 --> -0.845933).  Saving model ...
Epoch: 4 cost time: 5.894479751586914
Epoch: 4, Steps: 17 | Train Loss: 0.974 Vali Loss: 0.810 Vali Acc: 0.851 Test Loss: 0.810 Test Acc: 0.851
Validation loss decreased (-0.845933 --> -0.851343).  Saving model ...
Epoch: 5 cost time: 5.762093782424927
Epoch: 5, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.535 Vali Acc: 0.903 Test Loss: 0.535 Test Acc: 0.903
Validation loss decreased (-0.851343 --> -0.902697).  Saving model ...
Epoch: 6 cost time: 5.790738105773926
Epoch: 6, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.356 Vali Acc: 0.927 Test Loss: 0.356 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927023).  Saving model ...
Epoch: 7 cost time: 5.877509355545044
Epoch: 7, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929727).  Saving model ...
Epoch: 8 cost time: 5.749621152877808
Epoch: 8, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
Validation loss decreased (-0.929727 --> -0.948646).  Saving model ...
Epoch: 9 cost time: 5.765279054641724
Epoch: 9, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 10 cost time: 5.492335796356201
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 4.956908702850342
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.068984270095825
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.170475244522095
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 4.840338230133057
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.759923458099365
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.5723042488098145
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.379400253295898
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.671670913696289
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.738549470901489
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.949 Test Loss: 0.132 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.707596063613892
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.979436159133911
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.7295026779174805
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.842219591140747
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 7050441
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.424344062805176
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.116 Vali Acc: 0.257 Test Loss: 2.116 Test Acc: 0.257
Validation loss decreased (inf --> -0.256736).  Saving model ...
Epoch: 2 cost time: 3.1442790031433105
Epoch: 2, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.734 Vali Acc: 0.668 Test Loss: 1.734 Test Acc: 0.668
Validation loss decreased (-0.256736 --> -0.667550).  Saving model ...
Epoch: 3 cost time: 3.186379909515381
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.281 Vali Acc: 0.854 Test Loss: 1.281 Test Acc: 0.854
Validation loss decreased (-0.667550 --> -0.854041).  Saving model ...
Epoch: 4 cost time: 3.122455596923828
Epoch: 4, Steps: 17 | Train Loss: 1.048 Vali Loss: 0.872 Vali Acc: 0.868 Test Loss: 0.872 Test Acc: 0.868
Validation loss decreased (-0.854041 --> -0.867559).  Saving model ...
Epoch: 5 cost time: 3.218560218811035
Epoch: 5, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.611 Vali Acc: 0.876 Test Loss: 0.611 Test Acc: 0.876
Validation loss decreased (-0.867559 --> -0.875670).  Saving model ...
Epoch: 6 cost time: 3.026545524597168
Epoch: 6, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.395 Vali Acc: 0.935 Test Loss: 0.395 Test Acc: 0.935
Validation loss decreased (-0.875670 --> -0.935131).  Saving model ...
Epoch: 7 cost time: 2.7177586555480957
Epoch: 7, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7114975452423096
Epoch: 8, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
Validation loss decreased (-0.935131 --> -0.951349).  Saving model ...
Epoch: 9 cost time: 2.7707583904266357
Epoch: 9, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.951349 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.7471861839294434
Epoch: 10, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.765967607498169
Epoch: 11, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.7529194355010986
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.812624931335449
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.9814634323120117
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9354782104492188
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0545969009399414
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.946840763092041
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8450710773468018
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7672336101531982
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 20 cost time: 2.65881085395813
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.597795248031616
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0721004009246826
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1427159309387207
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0999367237091064
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.045708417892456
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9655396938323975
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.919391393661499
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.991387128829956
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.976536750793457
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2085321
model size : 9.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.672821283340454
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.085 Vali Acc: 0.241 Test Loss: 2.085 Test Acc: 0.241
Validation loss decreased (inf --> -0.240520).  Saving model ...
Epoch: 2 cost time: 2.9577949047088623
Epoch: 2, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.732 Vali Acc: 0.638 Test Loss: 1.732 Test Acc: 0.638
Validation loss decreased (-0.240520 --> -0.637821).  Saving model ...
Epoch: 3 cost time: 2.8700788021087646
Epoch: 3, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.313 Vali Acc: 0.851 Test Loss: 1.313 Test Acc: 0.851
Validation loss decreased (-0.637821 --> -0.851338).  Saving model ...
Epoch: 4 cost time: 2.568510055541992
Epoch: 4, Steps: 17 | Train Loss: 1.069 Vali Loss: 0.893 Vali Acc: 0.889 Test Loss: 0.893 Test Acc: 0.889
Validation loss decreased (-0.851338 --> -0.889180).  Saving model ...
Epoch: 5 cost time: 2.6463840007781982
Epoch: 5, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.606 Vali Acc: 0.905 Test Loss: 0.606 Test Acc: 0.905
Validation loss decreased (-0.889180 --> -0.905399).  Saving model ...
Epoch: 6 cost time: 2.80039644241333
Epoch: 6, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.402 Vali Acc: 0.932 Test Loss: 0.402 Test Acc: 0.932
Validation loss decreased (-0.905399 --> -0.932428).  Saving model ...
Epoch: 7 cost time: 2.956963539123535
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.333 Vali Acc: 0.930 Test Loss: 0.333 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.830533742904663
Epoch: 8, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.932428 --> -0.940538).  Saving model ...
Epoch: 9 cost time: 2.743997812271118
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 3.005143880844116
Epoch: 10, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 2.961238145828247
Epoch: 11, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.945944 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 3.209758996963501
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2453715801239014
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.174687147140503
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.087662935256958
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 3.0838632583618164
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.937286615371704
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.081458568572998
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.855971336364746
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.0391647815704346
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0584516525268555
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.0296363830566406
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.201458692550659
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.0626866817474365
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.133502244949341
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 7050441
model size : 28.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8504960536956787
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.123 Vali Acc: 0.249 Test Loss: 2.123 Test Acc: 0.249
Validation loss decreased (inf --> -0.248627).  Saving model ...
Epoch: 2 cost time: 1.940337896347046
Epoch: 2, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.765 Vali Acc: 0.624 Test Loss: 1.765 Test Acc: 0.624
Validation loss decreased (-0.248627 --> -0.624307).  Saving model ...
Epoch: 3 cost time: 1.8746840953826904
Epoch: 3, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.353 Vali Acc: 0.838 Test Loss: 1.353 Test Acc: 0.838
Validation loss decreased (-0.624307 --> -0.837824).  Saving model ...
Epoch: 4 cost time: 1.9777004718780518
Epoch: 4, Steps: 17 | Train Loss: 1.109 Vali Loss: 0.961 Vali Acc: 0.878 Test Loss: 0.961 Test Acc: 0.878
Validation loss decreased (-0.837824 --> -0.878369).  Saving model ...
Epoch: 5 cost time: 1.9554765224456787
Epoch: 5, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.679 Vali Acc: 0.895 Test Loss: 0.679 Test Acc: 0.895
Validation loss decreased (-0.878369 --> -0.894588).  Saving model ...
Epoch: 6 cost time: 2.048525333404541
Epoch: 6, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.467 Vali Acc: 0.930 Test Loss: 0.467 Test Acc: 0.930
Validation loss decreased (-0.894588 --> -0.929725).  Saving model ...
Epoch: 7 cost time: 1.8918156623840332
Epoch: 7, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.353 Vali Acc: 0.954 Test Loss: 0.353 Test Acc: 0.954
Validation loss decreased (-0.929725 --> -0.954051).  Saving model ...
Epoch: 8 cost time: 1.9325034618377686
Epoch: 8, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.245 Vali Acc: 0.968 Test Loss: 0.245 Test Acc: 0.968
Validation loss decreased (-0.954051 --> -0.967565).  Saving model ...
Epoch: 9 cost time: 1.7720224857330322
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.201 Vali Acc: 0.968 Test Loss: 0.201 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.183711051940918
Epoch: 10, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.034658432006836
Epoch: 11, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.9261839389801025
Epoch: 12, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0074880123138428
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.1966159343719482
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.409029245376587
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 16 cost time: 2.158644676208496
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1040024757385254
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.100964069366455
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2623627185821533
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1253156661987305
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.943411111831665
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2915711402893066
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2892467975616455
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2852673530578613
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3084263801574707
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2085321
model size : 9.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.14341115951538
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.090 Vali Acc: 0.314 Test Loss: 2.090 Test Acc: 0.314
Validation loss decreased (inf --> -0.313493).  Saving model ...
Epoch: 2 cost time: 6.297251462936401
Epoch: 2, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.843 Vali Acc: 0.589 Test Loss: 1.843 Test Acc: 0.589
Validation loss decreased (-0.313493 --> -0.589171).  Saving model ...
Epoch: 3 cost time: 5.639578104019165
Epoch: 3, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.496 Vali Acc: 0.803 Test Loss: 1.496 Test Acc: 0.803
Validation loss decreased (-0.589171 --> -0.802688).  Saving model ...
Epoch: 4 cost time: 5.472095251083374
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.140 Vali Acc: 0.900 Test Loss: 1.140 Test Acc: 0.900
Validation loss decreased (-0.802688 --> -0.899989).  Saving model ...
Epoch: 5 cost time: 5.4306960105896
Epoch: 5, Steps: 17 | Train Loss: 0.955 Vali Loss: 0.831 Vali Acc: 0.922 Test Loss: 0.831 Test Acc: 0.922
Validation loss decreased (-0.899989 --> -0.921613).  Saving model ...
Epoch: 6 cost time: 5.804468631744385
Epoch: 6, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.587 Vali Acc: 0.935 Test Loss: 0.587 Test Acc: 0.935
Validation loss decreased (-0.921613 --> -0.935129).  Saving model ...
Epoch: 7 cost time: 5.840611696243286
Epoch: 7, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.446 Vali Acc: 0.927 Test Loss: 0.446 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.15275502204895
Epoch: 8, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.342 Vali Acc: 0.943 Test Loss: 0.342 Test Acc: 0.943
Validation loss decreased (-0.935129 --> -0.943240).  Saving model ...
Epoch: 9 cost time: 6.179436683654785
Epoch: 9, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.257 Vali Acc: 0.949 Test Loss: 0.257 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 10 cost time: 6.109638690948486
Epoch: 10, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.214 Vali Acc: 0.962 Test Loss: 0.214 Test Acc: 0.962
Validation loss decreased (-0.948646 --> -0.962160).  Saving model ...
Epoch: 11 cost time: 6.219959735870361
Epoch: 11, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.210 Vali Acc: 0.957 Test Loss: 0.210 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.182687044143677
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 6.017885208129883
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.190736770629883
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 7.097541332244873
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.991188287734985
Epoch: 16, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.933664321899414
Epoch: 17, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.995755672454834
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.487624168395996
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.367423057556152
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 21 cost time: 6.5341174602508545
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.552266597747803
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.785735845565796
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.85553765296936
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.834170341491699
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.806788206100464
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.8647356033325195
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.941005706787109
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.856835842132568
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.142160654067993
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 7041321
model size : 27.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.472799062728882
Epoch: 1, Steps: 17 | Train Loss: 2.241 Vali Loss: 2.077 Vali Acc: 0.319 Test Loss: 2.077 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 3.760749101638794
Epoch: 2, Steps: 17 | Train Loss: 2.033 Vali Loss: 1.833 Vali Acc: 0.535 Test Loss: 1.833 Test Acc: 0.535
Validation loss decreased (-0.318898 --> -0.535117).  Saving model ...
Epoch: 3 cost time: 3.804287910461426
Epoch: 3, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.523 Vali Acc: 0.835 Test Loss: 1.523 Test Acc: 0.835
Validation loss decreased (-0.535117 --> -0.835120).  Saving model ...
Epoch: 4 cost time: 3.440329074859619
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.188 Vali Acc: 0.881 Test Loss: 1.188 Test Acc: 0.881
Validation loss decreased (-0.835120 --> -0.881069).  Saving model ...
Epoch: 5 cost time: 3.562056541442871
Epoch: 5, Steps: 17 | Train Loss: 1.062 Vali Loss: 0.885 Vali Acc: 0.895 Test Loss: 0.885 Test Acc: 0.895
Validation loss decreased (-0.881069 --> -0.894586).  Saving model ...
Epoch: 6 cost time: 3.577282428741455
Epoch: 6, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.645 Vali Acc: 0.916 Test Loss: 0.645 Test Acc: 0.916
Validation loss decreased (-0.894586 --> -0.916210).  Saving model ...
Epoch: 7 cost time: 3.484328269958496
Epoch: 7, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.469 Vali Acc: 0.943 Test Loss: 0.469 Test Acc: 0.943
Validation loss decreased (-0.916210 --> -0.943239).  Saving model ...
Epoch: 8 cost time: 3.550427198410034
Epoch: 8, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4818577766418457
Epoch: 9, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 2.958984136581421
Epoch: 10, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.244 Vali Acc: 0.949 Test Loss: 0.244 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 3.546236991882324
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 3.4254159927368164
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 3.9194564819335938
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7439749240875244
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 3.9502899646759033
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.794559955596924
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 3.711820125579834
Epoch: 17, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.892533779144287
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 3.88360333442688
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.734586477279663
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.926286458969116
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8718082904815674
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.0163304805755615
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.079599857330322
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 25 cost time: 3.975890636444092
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.045199632644653
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.685584545135498
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2555127143859863
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.2866947650909424
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.2508304119110107
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2076009
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.379033088684082
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.091 Vali Acc: 0.314 Test Loss: 2.091 Test Acc: 0.314
Validation loss decreased (inf --> -0.313493).  Saving model ...
Epoch: 2 cost time: 4.20628547668457
Epoch: 2, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.844 Vali Acc: 0.589 Test Loss: 1.844 Test Acc: 0.589
Validation loss decreased (-0.313493 --> -0.589171).  Saving model ...
Epoch: 3 cost time: 4.312272310256958
Epoch: 3, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.499 Vali Acc: 0.803 Test Loss: 1.499 Test Acc: 0.803
Validation loss decreased (-0.589171 --> -0.802688).  Saving model ...
Epoch: 4 cost time: 4.383496999740601
Epoch: 4, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.142 Vali Acc: 0.900 Test Loss: 1.142 Test Acc: 0.900
Validation loss decreased (-0.802688 --> -0.899989).  Saving model ...
Epoch: 5 cost time: 4.359469175338745
Epoch: 5, Steps: 17 | Train Loss: 0.957 Vali Loss: 0.834 Vali Acc: 0.922 Test Loss: 0.834 Test Acc: 0.922
Validation loss decreased (-0.899989 --> -0.921613).  Saving model ...
Epoch: 6 cost time: 4.24573826789856
Epoch: 6, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.588 Vali Acc: 0.935 Test Loss: 0.588 Test Acc: 0.935
Validation loss decreased (-0.921613 --> -0.935129).  Saving model ...
Epoch: 7 cost time: 4.33671760559082
Epoch: 7, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.448 Vali Acc: 0.932 Test Loss: 0.448 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.359845399856567
Epoch: 8, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.344 Vali Acc: 0.938 Test Loss: 0.344 Test Acc: 0.938
Validation loss decreased (-0.935129 --> -0.937834).  Saving model ...
Epoch: 9 cost time: 4.305923223495483
Epoch: 9, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
Validation loss decreased (-0.937834 --> -0.948646).  Saving model ...
Epoch: 10 cost time: 4.343558073043823
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.211 Vali Acc: 0.965 Test Loss: 0.211 Test Acc: 0.965
Validation loss decreased (-0.948646 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 4.004230260848999
Epoch: 11, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.190 Vali Acc: 0.968 Test Loss: 0.190 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 4.0625646114349365
Epoch: 12, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.447729825973511
Epoch: 13, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.47013783454895
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.104260444641113
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 2.9009578227996826
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.723170280456543
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 4.036795616149902
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 4.04077410697937
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.607361555099487
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.34949803352356
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.533423662185669
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.609581232070923
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.285721778869629
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.8474314212799072
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.1632750034332275
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.077083349227905
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.024567365646362
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 7041321
model size : 27.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.687180995941162
Epoch: 1, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.078 Vali Acc: 0.319 Test Loss: 2.078 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 2.66947340965271
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.834 Vali Acc: 0.535 Test Loss: 1.834 Test Acc: 0.535
Validation loss decreased (-0.318898 --> -0.535117).  Saving model ...
Epoch: 3 cost time: 2.7364087104797363
Epoch: 3, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.523 Vali Acc: 0.832 Test Loss: 1.523 Test Acc: 0.832
Validation loss decreased (-0.535117 --> -0.832417).  Saving model ...
Epoch: 4 cost time: 2.7510886192321777
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.189 Vali Acc: 0.876 Test Loss: 1.189 Test Acc: 0.876
Validation loss decreased (-0.832417 --> -0.875664).  Saving model ...
Epoch: 5 cost time: 2.435397148132324
Epoch: 5, Steps: 17 | Train Loss: 1.063 Vali Loss: 0.886 Vali Acc: 0.892 Test Loss: 0.886 Test Acc: 0.892
Validation loss decreased (-0.875664 --> -0.891883).  Saving model ...
Epoch: 6 cost time: 2.41667103767395
Epoch: 6, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.647 Vali Acc: 0.919 Test Loss: 0.647 Test Acc: 0.919
Validation loss decreased (-0.891883 --> -0.918912).  Saving model ...
Epoch: 7 cost time: 2.459458351135254
Epoch: 7, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.470 Vali Acc: 0.941 Test Loss: 0.470 Test Acc: 0.941
Validation loss decreased (-0.918912 --> -0.940536).  Saving model ...
Epoch: 8 cost time: 2.049605131149292
Epoch: 8, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.383 Vali Acc: 0.941 Test Loss: 0.383 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 2.20773983001709
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.291 Vali Acc: 0.943 Test Loss: 0.291 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 2.5932087898254395
Epoch: 10, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.250 Vali Acc: 0.946 Test Loss: 0.250 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 2.4476284980773926
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 2.7900731563568115
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 2.990316152572632
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8320274353027344
Epoch: 14, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.774057388305664
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 3.1162569522857666
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 3.0363566875457764
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9584531784057617
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 3.1793088912963867
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.057680130004883
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.024470090866089
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.0878498554229736
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 3.3026909828186035
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 2.937371253967285
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 3.2160444259643555
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2010107040405273
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0643484592437744
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.993056297302246
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.968 Test Loss: 0.077 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.154935121536255
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.990164041519165
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2076009
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.970820903778076
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.094 Vali Acc: 0.311 Test Loss: 2.094 Test Acc: 0.311
Validation loss decreased (inf --> -0.310790).  Saving model ...
Epoch: 2 cost time: 2.8158111572265625
Epoch: 2, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.855 Vali Acc: 0.584 Test Loss: 1.855 Test Acc: 0.584
Validation loss decreased (-0.310790 --> -0.583765).  Saving model ...
Epoch: 3 cost time: 3.2917609214782715
Epoch: 3, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.543 Vali Acc: 0.789 Test Loss: 1.543 Test Acc: 0.789
Validation loss decreased (-0.583765 --> -0.789174).  Saving model ...
Epoch: 4 cost time: 3.261270523071289
Epoch: 4, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.219 Vali Acc: 0.854 Test Loss: 1.219 Test Acc: 0.854
Validation loss decreased (-0.789174 --> -0.854042).  Saving model ...
Epoch: 5 cost time: 3.400177240371704
Epoch: 5, Steps: 17 | Train Loss: 1.059 Vali Loss: 0.940 Vali Acc: 0.914 Test Loss: 0.940 Test Acc: 0.914
Validation loss decreased (-0.854042 --> -0.913504).  Saving model ...
Epoch: 6 cost time: 3.6375343799591064
Epoch: 6, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.715 Vali Acc: 0.916 Test Loss: 0.715 Test Acc: 0.916
Validation loss decreased (-0.913504 --> -0.916209).  Saving model ...
Epoch: 7 cost time: 3.680088520050049
Epoch: 7, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.547 Vali Acc: 0.938 Test Loss: 0.547 Test Acc: 0.938
Validation loss decreased (-0.916209 --> -0.937832).  Saving model ...
Epoch: 8 cost time: 3.270169734954834
Epoch: 8, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.440 Vali Acc: 0.941 Test Loss: 0.440 Test Acc: 0.941
Validation loss decreased (-0.937832 --> -0.940536).  Saving model ...
Epoch: 9 cost time: 3.1950206756591797
Epoch: 9, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.328 Vali Acc: 0.954 Test Loss: 0.328 Test Acc: 0.954
Validation loss decreased (-0.940536 --> -0.954051).  Saving model ...
Epoch: 10 cost time: 3.309293031692505
Epoch: 10, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.274 Vali Acc: 0.962 Test Loss: 0.274 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962159).  Saving model ...
Epoch: 11 cost time: 3.3826117515563965
Epoch: 11, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.225 Vali Acc: 0.968 Test Loss: 0.225 Test Acc: 0.968
Validation loss decreased (-0.962159 --> -0.967565).  Saving model ...
Epoch: 12 cost time: 3.3301591873168945
Epoch: 12, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.186 Vali Acc: 0.968 Test Loss: 0.186 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 3.2870330810546875
Epoch: 13, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.404832601547241
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972971).  Saving model ...
Epoch: 15 cost time: 3.447174072265625
Epoch: 15, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6980245113372803
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4470441341400146
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 3.3941261768341064
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 19 cost time: 3.7542951107025146
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8538451194763184
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5422916412353516
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7888271808624268
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0317916870117188
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.021915912628174
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1398112773895264
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.0914595127105713
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.219900608062744
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.249051809310913
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 7041321
model size : 27.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.184609413146973
Epoch: 1, Steps: 17 | Train Loss: 2.243 Vali Loss: 2.084 Vali Acc: 0.319 Test Loss: 2.084 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 2.5692992210388184
Epoch: 2, Steps: 17 | Train Loss: 2.044 Vali Loss: 1.858 Vali Acc: 0.500 Test Loss: 1.858 Test Acc: 0.500
Validation loss decreased (-0.318898 --> -0.499981).  Saving model ...
Epoch: 3 cost time: 2.4248383045196533
Epoch: 3, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.588 Vali Acc: 0.803 Test Loss: 1.588 Test Acc: 0.803
Validation loss decreased (-0.499981 --> -0.802687).  Saving model ...
Epoch: 4 cost time: 2.3772339820861816
Epoch: 4, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.302 Vali Acc: 0.881 Test Loss: 1.302 Test Acc: 0.881
Validation loss decreased (-0.802687 --> -0.881068).  Saving model ...
Epoch: 5 cost time: 2.5626492500305176
Epoch: 5, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.030 Vali Acc: 0.895 Test Loss: 1.030 Test Acc: 0.895
Validation loss decreased (-0.881068 --> -0.894584).  Saving model ...
Epoch: 6 cost time: 2.561915874481201
Epoch: 6, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.794 Vali Acc: 0.919 Test Loss: 0.794 Test Acc: 0.919
Validation loss decreased (-0.894584 --> -0.918911).  Saving model ...
Epoch: 7 cost time: 2.44236421585083
Epoch: 7, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.600 Vali Acc: 0.935 Test Loss: 0.600 Test Acc: 0.935
Validation loss decreased (-0.918911 --> -0.935129).  Saving model ...
Epoch: 8 cost time: 2.4280450344085693
Epoch: 8, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.488 Vali Acc: 0.938 Test Loss: 0.488 Test Acc: 0.938
Validation loss decreased (-0.935129 --> -0.937833).  Saving model ...
Epoch: 9 cost time: 2.493312358856201
Epoch: 9, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.370 Vali Acc: 0.949 Test Loss: 0.370 Test Acc: 0.949
Validation loss decreased (-0.937833 --> -0.948645).  Saving model ...
Epoch: 10 cost time: 2.093198776245117
Epoch: 10, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.320 Vali Acc: 0.946 Test Loss: 0.320 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.269990921020508
Epoch: 11, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.242 Vali Acc: 0.957 Test Loss: 0.242 Test Acc: 0.957
Validation loss decreased (-0.948645 --> -0.956754).  Saving model ...
Epoch: 12 cost time: 2.2722184658050537
Epoch: 12, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 13 cost time: 2.210692882537842
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 2.292146682739258
Epoch: 14, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.316511869430542
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 2.2454099655151367
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 2.3458495140075684
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 2.3346974849700928
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 2.293245315551758
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 2.460495710372925
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.439939022064209
Epoch: 21, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.396418333053589
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 2.302668809890747
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.216628313064575
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1308443546295166
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2503859996795654
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.959 Test Loss: 0.092 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.164330244064331
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.954 Test Loss: 0.107 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.2188262939453125
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8604235649108887
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9315812587738037
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2076009
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.604205369949341
Epoch: 1, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.018 Vali Acc: 0.405 Test Loss: 2.018 Test Acc: 0.405
Validation loss decreased (inf --> -0.405385).  Saving model ...
Epoch: 2 cost time: 4.8920509815216064
Epoch: 2, Steps: 17 | Train Loss: 1.978 Vali Loss: 1.849 Vali Acc: 0.630 Test Loss: 1.849 Test Acc: 0.630
Validation loss decreased (-0.405385 --> -0.629711).  Saving model ...
Epoch: 3 cost time: 4.9143877029418945
Epoch: 3, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.618 Vali Acc: 0.751 Test Loss: 1.618 Test Acc: 0.751
Validation loss decreased (-0.629711 --> -0.751335).  Saving model ...
Epoch: 4 cost time: 5.283426761627197
Epoch: 4, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.349 Vali Acc: 0.811 Test Loss: 1.349 Test Acc: 0.811
Validation loss decreased (-0.751335 --> -0.810797).  Saving model ...
Epoch: 5 cost time: 5.215900182723999
Epoch: 5, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.065 Vali Acc: 0.849 Test Loss: 1.065 Test Acc: 0.849
Validation loss decreased (-0.810797 --> -0.848638).  Saving model ...
Epoch: 6 cost time: 5.133653163909912
Epoch: 6, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.819 Vali Acc: 0.905 Test Loss: 0.819 Test Acc: 0.905
Validation loss decreased (-0.848638 --> -0.905397).  Saving model ...
Epoch: 7 cost time: 4.721736192703247
Epoch: 7, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.641 Vali Acc: 0.905 Test Loss: 0.641 Test Acc: 0.905
Validation loss decreased (-0.905397 --> -0.905399).  Saving model ...
Epoch: 8 cost time: 4.7617597579956055
Epoch: 8, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.451 Vali Acc: 0.935 Test Loss: 0.451 Test Acc: 0.935
Validation loss decreased (-0.905399 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 4.486541509628296
Epoch: 9, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.314428329467773
Epoch: 10, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.329 Vali Acc: 0.927 Test Loss: 0.329 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.168797254562378
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 4.210234880447388
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 3.605050802230835
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 3.6526825428009033
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 4.03718638420105
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.069240093231201
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 4.245794296264648
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.571968078613281
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.348737001419067
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.258608102798462
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 4.083552598953247
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.4900195598602295
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.567197561264038
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.588451147079468
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.971009731292725
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.8232762813568115
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.946649551391602
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 4.988147258758545
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 4.575312376022339
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.996412515640259
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 3525801
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.716805458068848
Epoch: 1, Steps: 17 | Train Loss: 2.135 Vali Loss: 2.132 Vali Acc: 0.219 Test Loss: 2.132 Test Acc: 0.219
Validation loss decreased (inf --> -0.218898).  Saving model ...
Epoch: 2 cost time: 2.8232898712158203
Epoch: 2, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.924 Vali Acc: 0.465 Test Loss: 1.924 Test Acc: 0.465
Validation loss decreased (-0.218898 --> -0.464846).  Saving model ...
Epoch: 3 cost time: 3.2150778770446777
Epoch: 3, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.673 Vali Acc: 0.651 Test Loss: 1.673 Test Acc: 0.651
Validation loss decreased (-0.464846 --> -0.651335).  Saving model ...
Epoch: 4 cost time: 3.2477223873138428
Epoch: 4, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.382 Vali Acc: 0.759 Test Loss: 1.382 Test Acc: 0.759
Validation loss decreased (-0.651335 --> -0.759446).  Saving model ...
Epoch: 5 cost time: 2.8642168045043945
Epoch: 5, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.110 Vali Acc: 0.816 Test Loss: 1.110 Test Acc: 0.816
Validation loss decreased (-0.759446 --> -0.816205).  Saving model ...
Epoch: 6 cost time: 3.0089900493621826
Epoch: 6, Steps: 17 | Train Loss: 0.945 Vali Loss: 0.842 Vali Acc: 0.873 Test Loss: 0.842 Test Acc: 0.873
Validation loss decreased (-0.816205 --> -0.872965).  Saving model ...
Epoch: 7 cost time: 3.0746066570281982
Epoch: 7, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.659 Vali Acc: 0.916 Test Loss: 0.659 Test Acc: 0.916
Validation loss decreased (-0.872965 --> -0.916210).  Saving model ...
Epoch: 8 cost time: 3.005215883255005
Epoch: 8, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.488 Vali Acc: 0.949 Test Loss: 0.488 Test Acc: 0.949
Validation loss decreased (-0.916210 --> -0.948644).  Saving model ...
Epoch: 9 cost time: 3.0785765647888184
Epoch: 9, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.400 Vali Acc: 0.951 Test Loss: 0.400 Test Acc: 0.951
Validation loss decreased (-0.948644 --> -0.951347).  Saving model ...
Epoch: 10 cost time: 2.8642842769622803
Epoch: 10, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.298 Vali Acc: 0.954 Test Loss: 0.298 Test Acc: 0.954
Validation loss decreased (-0.951347 --> -0.954051).  Saving model ...
Epoch: 11 cost time: 2.9242916107177734
Epoch: 11, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.270 Vali Acc: 0.943 Test Loss: 0.270 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.912113904953003
Epoch: 12, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.202 Vali Acc: 0.965 Test Loss: 0.202 Test Acc: 0.965
Validation loss decreased (-0.954051 --> -0.964863).  Saving model ...
Epoch: 13 cost time: 2.832350254058838
Epoch: 13, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9019675254821777
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9465548992156982
Epoch: 15, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8764307498931885
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 3.0722525119781494
Epoch: 17, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.057716131210327
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.137200355529785
Epoch: 19, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6676783561706543
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.653287410736084
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 2.8107473850250244
Epoch: 22, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6261696815490723
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5475080013275146
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.6963508129119873
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 3.2749860286712646
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.340353012084961
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 28 cost time: 3.224128246307373
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.508150100708008
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 3.545271873474121
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1043049
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.270294666290283
Epoch: 1, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.018 Vali Acc: 0.405 Test Loss: 2.018 Test Acc: 0.405
Validation loss decreased (inf --> -0.405385).  Saving model ...
Epoch: 2 cost time: 4.244463205337524
Epoch: 2, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.850 Vali Acc: 0.630 Test Loss: 1.850 Test Acc: 0.630
Validation loss decreased (-0.405385 --> -0.629711).  Saving model ...
Epoch: 3 cost time: 3.865278720855713
Epoch: 3, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.620 Vali Acc: 0.751 Test Loss: 1.620 Test Acc: 0.751
Validation loss decreased (-0.629711 --> -0.751335).  Saving model ...
Epoch: 4 cost time: 3.9994900226593018
Epoch: 4, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.352 Vali Acc: 0.816 Test Loss: 1.352 Test Acc: 0.816
Validation loss decreased (-0.751335 --> -0.816203).  Saving model ...
Epoch: 5 cost time: 3.830477714538574
Epoch: 5, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.067 Vali Acc: 0.846 Test Loss: 1.067 Test Acc: 0.846
Validation loss decreased (-0.816203 --> -0.845935).  Saving model ...
Epoch: 6 cost time: 3.6825103759765625
Epoch: 6, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.819 Vali Acc: 0.905 Test Loss: 0.819 Test Acc: 0.905
Validation loss decreased (-0.845935 --> -0.905397).  Saving model ...
Epoch: 7 cost time: 3.850611448287964
Epoch: 7, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.646 Vali Acc: 0.905 Test Loss: 0.646 Test Acc: 0.905
Validation loss decreased (-0.905397 --> -0.905399).  Saving model ...
Epoch: 8 cost time: 3.9443960189819336
Epoch: 8, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.457 Vali Acc: 0.935 Test Loss: 0.457 Test Acc: 0.935
Validation loss decreased (-0.905399 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 3.724477529525757
Epoch: 9, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.56209659576416
Epoch: 10, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6334288120269775
Epoch: 11, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.240 Vali Acc: 0.954 Test Loss: 0.240 Test Acc: 0.954
Validation loss decreased (-0.935131 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 2.89398455619812
Epoch: 12, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 2.726832866668701
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 3.9679207801818848
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 4.367720603942871
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.312183141708374
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.376636505126953
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 4.1550281047821045
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.261 Vali Acc: 0.916 Test Loss: 0.261 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.386911392211914
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.364901781082153
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.4423418045043945
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.404173135757446
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.363946437835693
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.412415027618408
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.446503400802612
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.307022333145142
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.383063554763794
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 4.456070423126221
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 4.1943724155426025
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7944209575653076
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 3525801
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.342754602432251
Epoch: 1, Steps: 17 | Train Loss: 2.135 Vali Loss: 2.132 Vali Acc: 0.219 Test Loss: 2.132 Test Acc: 0.219
Validation loss decreased (inf --> -0.218898).  Saving model ...
Epoch: 2 cost time: 2.5024771690368652
Epoch: 2, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.924 Vali Acc: 0.465 Test Loss: 1.924 Test Acc: 0.465
Validation loss decreased (-0.218898 --> -0.464846).  Saving model ...
Epoch: 3 cost time: 2.5219814777374268
Epoch: 3, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.672 Vali Acc: 0.651 Test Loss: 1.672 Test Acc: 0.651
Validation loss decreased (-0.464846 --> -0.651335).  Saving model ...
Epoch: 4 cost time: 2.745086669921875
Epoch: 4, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.381 Vali Acc: 0.754 Test Loss: 1.381 Test Acc: 0.754
Validation loss decreased (-0.651335 --> -0.754040).  Saving model ...
Epoch: 5 cost time: 2.7387306690216064
Epoch: 5, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.110 Vali Acc: 0.816 Test Loss: 1.110 Test Acc: 0.816
Validation loss decreased (-0.754040 --> -0.816205).  Saving model ...
Epoch: 6 cost time: 2.7392685413360596
Epoch: 6, Steps: 17 | Train Loss: 0.945 Vali Loss: 0.842 Vali Acc: 0.873 Test Loss: 0.842 Test Acc: 0.873
Validation loss decreased (-0.816205 --> -0.872965).  Saving model ...
Epoch: 7 cost time: 2.7722249031066895
Epoch: 7, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.660 Vali Acc: 0.914 Test Loss: 0.660 Test Acc: 0.914
Validation loss decreased (-0.872965 --> -0.913507).  Saving model ...
Epoch: 8 cost time: 2.7164840698242188
Epoch: 8, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.491 Vali Acc: 0.946 Test Loss: 0.491 Test Acc: 0.946
Validation loss decreased (-0.913507 --> -0.945941).  Saving model ...
Epoch: 9 cost time: 2.774101972579956
Epoch: 9, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.400 Vali Acc: 0.951 Test Loss: 0.400 Test Acc: 0.951
Validation loss decreased (-0.945941 --> -0.951347).  Saving model ...
Epoch: 10 cost time: 2.7661209106445312
Epoch: 10, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.300 Vali Acc: 0.957 Test Loss: 0.300 Test Acc: 0.957
Validation loss decreased (-0.951347 --> -0.956754).  Saving model ...
Epoch: 11 cost time: 2.751314640045166
Epoch: 11, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.792086601257324
Epoch: 12, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 2.7005908489227295
Epoch: 13, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8687262535095215
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.950474977493286
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 2.9626197814941406
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.714604616165161
Epoch: 17, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0580787658691406
Epoch: 18, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0854647159576416
Epoch: 19, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.943 Test Loss: 0.142 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0197789669036865
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.951618194580078
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.121311902999878
Epoch: 22, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.0733675956726074
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7609870433807373
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.760556936264038
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.8425650596618652
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 27 cost time: 2.761946678161621
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.632246255874634
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8156182765960693
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3902366161346436
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1043049
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.803284406661987
Epoch: 1, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.020 Vali Acc: 0.403 Test Loss: 2.020 Test Acc: 0.403
Validation loss decreased (inf --> -0.402683).  Saving model ...
Epoch: 2 cost time: 2.769282817840576
Epoch: 2, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.856 Vali Acc: 0.608 Test Loss: 1.856 Test Acc: 0.608
Validation loss decreased (-0.402683 --> -0.608090).  Saving model ...
Epoch: 3 cost time: 2.883859634399414
Epoch: 3, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.635 Vali Acc: 0.727 Test Loss: 1.635 Test Acc: 0.727
Validation loss decreased (-0.608090 --> -0.727011).  Saving model ...
Epoch: 4 cost time: 2.9562222957611084
Epoch: 4, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.391 Vali Acc: 0.824 Test Loss: 1.391 Test Acc: 0.824
Validation loss decreased (-0.727011 --> -0.824310).  Saving model ...
Epoch: 5 cost time: 2.939276695251465
Epoch: 5, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.144 Vali Acc: 0.857 Test Loss: 1.144 Test Acc: 0.857
Validation loss decreased (-0.824310 --> -0.856745).  Saving model ...
Epoch: 6 cost time: 2.896860361099243
Epoch: 6, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.927 Vali Acc: 0.886 Test Loss: 0.927 Test Acc: 0.886
Validation loss decreased (-0.856745 --> -0.886477).  Saving model ...
Epoch: 7 cost time: 2.9303665161132812
Epoch: 7, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.720 Vali Acc: 0.908 Test Loss: 0.720 Test Acc: 0.908
Validation loss decreased (-0.886477 --> -0.908101).  Saving model ...
Epoch: 8 cost time: 2.853489398956299
Epoch: 8, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.564 Vali Acc: 0.924 Test Loss: 0.564 Test Acc: 0.924
Validation loss decreased (-0.908101 --> -0.924319).  Saving model ...
Epoch: 9 cost time: 2.5786333084106445
Epoch: 9, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.440 Vali Acc: 0.943 Test Loss: 0.440 Test Acc: 0.943
Validation loss decreased (-0.924319 --> -0.943239).  Saving model ...
Epoch: 10 cost time: 2.731464147567749
Epoch: 10, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.360 Vali Acc: 0.938 Test Loss: 0.360 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.691875457763672
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.296 Vali Acc: 0.951 Test Loss: 0.296 Test Acc: 0.951
Validation loss decreased (-0.943239 --> -0.951348).  Saving model ...
Epoch: 12 cost time: 2.780946731567383
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.767869472503662
Epoch: 13, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7436623573303223
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 2.7421860694885254
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.709163188934326
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 2.7660751342773438
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3373196125030518
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.262382984161377
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.480618715286255
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.6463398933410645
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5042874813079834
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.489932060241699
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.510415554046631
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 2.765528678894043
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.659355878829956
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 2.9604897499084473
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.961606025695801
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9563212394714355
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.946 Test Loss: 0.139 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.970289945602417
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 3525801
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.75890851020813
Epoch: 1, Steps: 17 | Train Loss: 2.135 Vali Loss: 2.136 Vali Acc: 0.219 Test Loss: 2.136 Test Acc: 0.219
Validation loss decreased (inf --> -0.218898).  Saving model ...
Epoch: 2 cost time: 2.1090731620788574
Epoch: 2, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.943 Vali Acc: 0.427 Test Loss: 1.943 Test Acc: 0.427
Validation loss decreased (-0.218898 --> -0.427008).  Saving model ...
Epoch: 3 cost time: 2.242847204208374
Epoch: 3, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.720 Vali Acc: 0.627 Test Loss: 1.720 Test Acc: 0.627
Validation loss decreased (-0.427008 --> -0.627010).  Saving model ...
Epoch: 4 cost time: 2.1650586128234863
Epoch: 4, Steps: 17 | Train Loss: 1.549 Vali Loss: 1.466 Vali Acc: 0.773 Test Loss: 1.466 Test Acc: 0.773
Validation loss decreased (-0.627010 --> -0.772958).  Saving model ...
Epoch: 5 cost time: 1.9957067966461182
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.217 Vali Acc: 0.832 Test Loss: 1.217 Test Acc: 0.832
Validation loss decreased (-0.772958 --> -0.832420).  Saving model ...
Epoch: 6 cost time: 2.1229448318481445
Epoch: 6, Steps: 17 | Train Loss: 1.052 Vali Loss: 0.963 Vali Acc: 0.881 Test Loss: 0.963 Test Acc: 0.881
Validation loss decreased (-0.832420 --> -0.881071).  Saving model ...
Epoch: 7 cost time: 2.067960023880005
Epoch: 7, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.779 Vali Acc: 0.895 Test Loss: 0.779 Test Acc: 0.895
Validation loss decreased (-0.881071 --> -0.894587).  Saving model ...
Epoch: 8 cost time: 2.085716962814331
Epoch: 8, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.604 Vali Acc: 0.938 Test Loss: 0.604 Test Acc: 0.938
Validation loss decreased (-0.894587 --> -0.937832).  Saving model ...
Epoch: 9 cost time: 2.1269190311431885
Epoch: 9, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.492 Vali Acc: 0.935 Test Loss: 0.492 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0854711532592773
Epoch: 10, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.395 Vali Acc: 0.946 Test Loss: 0.395 Test Acc: 0.946
Validation loss decreased (-0.937832 --> -0.945942).  Saving model ...
Epoch: 11 cost time: 2.0935754776000977
Epoch: 11, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.334 Vali Acc: 0.941 Test Loss: 0.334 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1661086082458496
Epoch: 12, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.267 Vali Acc: 0.954 Test Loss: 0.267 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954051).  Saving model ...
Epoch: 13 cost time: 2.095773935317993
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.8044688701629639
Epoch: 14, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 2.010438919067383
Epoch: 15, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 16 cost time: 1.9114151000976562
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 1.9399003982543945
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.842353343963623
Epoch: 18, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0053822994232178
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9121577739715576
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6357238292694092
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8345239162445068
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0237247943878174
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0283608436584473
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0333378314971924
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9479749202728271
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1043049
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 10.08394193649292
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.196 Vali Acc: 0.124 Test Loss: 2.196 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 8.103309392929077
Epoch: 2, Steps: 17 | Train Loss: 2.103 Vali Loss: 2.035 Vali Acc: 0.278 Test Loss: 2.035 Test Acc: 0.278
Validation loss decreased (-0.124302 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 8.265429735183716
Epoch: 3, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.815 Vali Acc: 0.646 Test Loss: 1.815 Test Acc: 0.646
Validation loss decreased (-0.278358 --> -0.645928).  Saving model ...
Epoch: 4 cost time: 8.273258924484253
Epoch: 4, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.548 Vali Acc: 0.789 Test Loss: 1.548 Test Acc: 0.789
Validation loss decreased (-0.645928 --> -0.789174).  Saving model ...
Epoch: 5 cost time: 8.25515604019165
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.243 Vali Acc: 0.795 Test Loss: 1.243 Test Acc: 0.795
Validation loss decreased (-0.789174 --> -0.794582).  Saving model ...
Epoch: 6 cost time: 8.276859760284424
Epoch: 6, Steps: 17 | Train Loss: 1.064 Vali Loss: 0.935 Vali Acc: 0.854 Test Loss: 0.935 Test Acc: 0.854
Validation loss decreased (-0.794582 --> -0.854045).  Saving model ...
Epoch: 7 cost time: 8.836898565292358
Epoch: 7, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.671 Vali Acc: 0.889 Test Loss: 0.671 Test Acc: 0.889
Validation loss decreased (-0.854045 --> -0.889182).  Saving model ...
Epoch: 8 cost time: 9.078585147857666
Epoch: 8, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.525 Vali Acc: 0.914 Test Loss: 0.525 Test Acc: 0.914
Validation loss decreased (-0.889182 --> -0.913508).  Saving model ...
Epoch: 9 cost time: 8.485101222991943
Epoch: 9, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.394 Vali Acc: 0.924 Test Loss: 0.394 Test Acc: 0.924
Validation loss decreased (-0.913508 --> -0.924320).  Saving model ...
Epoch: 10 cost time: 8.373198986053467
Epoch: 10, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.293 Vali Acc: 0.954 Test Loss: 0.293 Test Acc: 0.954
Validation loss decreased (-0.924320 --> -0.954051).  Saving model ...
Epoch: 11 cost time: 8.505325555801392
Epoch: 11, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.276 Vali Acc: 0.943 Test Loss: 0.276 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.35293960571289
Epoch: 12, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.227 Vali Acc: 0.949 Test Loss: 0.227 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.615706443786621
Epoch: 13, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 6.734506845474243
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.41886043548584
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.294050216674805
Epoch: 16, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.32984447479248
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.331758975982666
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.119676351547241
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.669325351715088
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.792545318603516
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.067508220672607
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.773778915405273
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 1768041
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.9642980098724365
Epoch: 1, Steps: 17 | Train Loss: 2.299 Vali Loss: 2.246 Vali Acc: 0.108 Test Loss: 2.246 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 4.8940653800964355
Epoch: 2, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.072 Vali Acc: 0.230 Test Loss: 2.072 Test Acc: 0.230
Validation loss decreased (-0.108086 --> -0.229709).  Saving model ...
Epoch: 3 cost time: 5.234552383422852
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.853 Vali Acc: 0.535 Test Loss: 1.853 Test Acc: 0.535
Validation loss decreased (-0.229709 --> -0.535117).  Saving model ...
Epoch: 4 cost time: 4.505105972290039
Epoch: 4, Steps: 17 | Train Loss: 1.718 Vali Loss: 1.597 Vali Acc: 0.797 Test Loss: 1.597 Test Acc: 0.797
Validation loss decreased (-0.535117 --> -0.797281).  Saving model ...
Epoch: 5 cost time: 4.510547399520874
Epoch: 5, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.302 Vali Acc: 0.832 Test Loss: 1.302 Test Acc: 0.832
Validation loss decreased (-0.797281 --> -0.832419).  Saving model ...
Epoch: 6 cost time: 4.809269905090332
Epoch: 6, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.033 Vali Acc: 0.884 Test Loss: 1.033 Test Acc: 0.884
Validation loss decreased (-0.832419 --> -0.883773).  Saving model ...
Epoch: 7 cost time: 4.951932668685913
Epoch: 7, Steps: 17 | Train Loss: 0.907 Vali Loss: 0.817 Vali Acc: 0.900 Test Loss: 0.817 Test Acc: 0.900
Validation loss decreased (-0.883773 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 5.511439323425293
Epoch: 8, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.633 Vali Acc: 0.924 Test Loss: 0.633 Test Acc: 0.924
Validation loss decreased (-0.899992 --> -0.924318).  Saving model ...
Epoch: 9 cost time: 5.5112481117248535
Epoch: 9, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.483 Vali Acc: 0.930 Test Loss: 0.483 Test Acc: 0.930
Validation loss decreased (-0.924318 --> -0.929725).  Saving model ...
Epoch: 10 cost time: 5.58615255355835
Epoch: 10, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929726).  Saving model ...
Epoch: 11 cost time: 5.531758785247803
Epoch: 11, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.324 Vali Acc: 0.932 Test Loss: 0.324 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 12 cost time: 5.488056182861328
Epoch: 12, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 13 cost time: 5.127554893493652
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 4.605003118515015
Epoch: 14, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.250 Vali Acc: 0.924 Test Loss: 0.250 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.948970794677734
Epoch: 15, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 5.031522512435913
Epoch: 16, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.213 Vali Acc: 0.927 Test Loss: 0.213 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.732289552688599
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.63403058052063
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.633289098739624
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.701297760009766
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.5909998416900635
Epoch: 21, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.254053354263306
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.938 Test Loss: 0.173 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.698188543319702
Epoch: 23, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.686370849609375
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.633824348449707
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 526569
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.4925360679626465
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.196 Vali Acc: 0.122 Test Loss: 2.196 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 5.9021666049957275
Epoch: 2, Steps: 17 | Train Loss: 2.104 Vali Loss: 2.035 Vali Acc: 0.278 Test Loss: 2.035 Test Acc: 0.278
Validation loss decreased (-0.121600 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 5.893093109130859
Epoch: 3, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.816 Vali Acc: 0.643 Test Loss: 1.816 Test Acc: 0.643
Validation loss decreased (-0.278358 --> -0.643225).  Saving model ...
Epoch: 4 cost time: 5.880144357681274
Epoch: 4, Steps: 17 | Train Loss: 1.649 Vali Loss: 1.551 Vali Acc: 0.795 Test Loss: 1.551 Test Acc: 0.795
Validation loss decreased (-0.643225 --> -0.794579).  Saving model ...
Epoch: 5 cost time: 5.111708641052246
Epoch: 5, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.246 Vali Acc: 0.792 Test Loss: 1.246 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.804923057556152
Epoch: 6, Steps: 17 | Train Loss: 1.067 Vali Loss: 0.942 Vali Acc: 0.857 Test Loss: 0.942 Test Acc: 0.857
Validation loss decreased (-0.794579 --> -0.856747).  Saving model ...
Epoch: 7 cost time: 4.309696435928345
Epoch: 7, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.676 Vali Acc: 0.886 Test Loss: 0.676 Test Acc: 0.886
Validation loss decreased (-0.856747 --> -0.886480).  Saving model ...
Epoch: 8 cost time: 4.708969593048096
Epoch: 8, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.527 Vali Acc: 0.916 Test Loss: 0.527 Test Acc: 0.916
Validation loss decreased (-0.886480 --> -0.916211).  Saving model ...
Epoch: 9 cost time: 4.747833013534546
Epoch: 9, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.396 Vali Acc: 0.927 Test Loss: 0.396 Test Acc: 0.927
Validation loss decreased (-0.916211 --> -0.927023).  Saving model ...
Epoch: 10 cost time: 5.5572121143341064
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.294 Vali Acc: 0.954 Test Loss: 0.294 Test Acc: 0.954
Validation loss decreased (-0.927023 --> -0.954051).  Saving model ...
Epoch: 11 cost time: 5.490630149841309
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.283978700637817
Epoch: 12, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 5.692343235015869
Epoch: 13, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 5.6164233684539795
Epoch: 14, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.698006868362427
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.863652467727661
Epoch: 16, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.335 Vali Acc: 0.886 Test Loss: 0.335 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.844790935516357
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.839801788330078
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.092122554779053
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.72910213470459
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.642456769943237
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.444194793701172
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.417675018310547
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1768041
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.547244548797607
Epoch: 1, Steps: 17 | Train Loss: 2.299 Vali Loss: 2.246 Vali Acc: 0.108 Test Loss: 2.246 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 2.8186492919921875
Epoch: 2, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.073 Vali Acc: 0.230 Test Loss: 2.073 Test Acc: 0.230
Validation loss decreased (-0.108086 --> -0.229709).  Saving model ...
Epoch: 3 cost time: 2.7930679321289062
Epoch: 3, Steps: 17 | Train Loss: 1.947 Vali Loss: 1.854 Vali Acc: 0.532 Test Loss: 1.854 Test Acc: 0.532
Validation loss decreased (-0.229709 --> -0.532414).  Saving model ...
Epoch: 4 cost time: 2.785120964050293
Epoch: 4, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.598 Vali Acc: 0.795 Test Loss: 1.598 Test Acc: 0.795
Validation loss decreased (-0.532414 --> -0.794579).  Saving model ...
Epoch: 5 cost time: 3.324843645095825
Epoch: 5, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.302 Vali Acc: 0.835 Test Loss: 1.302 Test Acc: 0.835
Validation loss decreased (-0.794579 --> -0.835122).  Saving model ...
Epoch: 6 cost time: 3.3464090824127197
Epoch: 6, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.034 Vali Acc: 0.884 Test Loss: 1.034 Test Acc: 0.884
Validation loss decreased (-0.835122 --> -0.883773).  Saving model ...
Epoch: 7 cost time: 3.3029470443725586
Epoch: 7, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.817 Vali Acc: 0.903 Test Loss: 0.817 Test Acc: 0.903
Validation loss decreased (-0.883773 --> -0.902695).  Saving model ...
Epoch: 8 cost time: 3.343751907348633
Epoch: 8, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.635 Vali Acc: 0.924 Test Loss: 0.635 Test Acc: 0.924
Validation loss decreased (-0.902695 --> -0.924318).  Saving model ...
Epoch: 9 cost time: 3.286839246749878
Epoch: 9, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.484 Vali Acc: 0.930 Test Loss: 0.484 Test Acc: 0.930
Validation loss decreased (-0.924318 --> -0.929725).  Saving model ...
Epoch: 10 cost time: 3.3294200897216797
Epoch: 10, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929726).  Saving model ...
Epoch: 11 cost time: 3.1900854110717773
Epoch: 11, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.321 Vali Acc: 0.935 Test Loss: 0.321 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 3.0206191539764404
Epoch: 12, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.261 Vali Acc: 0.938 Test Loss: 0.261 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 13 cost time: 2.5613906383514404
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 3.2099647521972656
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.249 Vali Acc: 0.924 Test Loss: 0.249 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2358336448669434
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 3.24200439453125
Epoch: 16, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.212 Vali Acc: 0.927 Test Loss: 0.212 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7649316787719727
Epoch: 17, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.70552921295166
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7485759258270264
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.752565860748291
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.7050271034240723
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6726861000061035
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.932 Test Loss: 0.172 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6016860008239746
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.938 Test Loss: 0.165 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1511967182159424
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.2061102390289307
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 526569
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.36759877204895
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.197 Vali Acc: 0.122 Test Loss: 2.197 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 3.232182502746582
Epoch: 2, Steps: 17 | Train Loss: 2.106 Vali Loss: 2.039 Vali Acc: 0.259 Test Loss: 2.039 Test Acc: 0.259
Validation loss decreased (-0.121600 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 3.483828544616699
Epoch: 3, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.825 Vali Acc: 0.622 Test Loss: 1.825 Test Acc: 0.622
Validation loss decreased (-0.259439 --> -0.621603).  Saving model ...
Epoch: 4 cost time: 3.457003116607666
Epoch: 4, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.575 Vali Acc: 0.784 Test Loss: 1.575 Test Acc: 0.784
Validation loss decreased (-0.621603 --> -0.783768).  Saving model ...
Epoch: 5 cost time: 3.4928812980651855
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.308 Vali Acc: 0.814 Test Loss: 1.308 Test Acc: 0.814
Validation loss decreased (-0.783768 --> -0.813500).  Saving model ...
Epoch: 6 cost time: 3.42333722114563
Epoch: 6, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.061 Vali Acc: 0.859 Test Loss: 1.061 Test Acc: 0.859
Validation loss decreased (-0.813500 --> -0.859449).  Saving model ...
Epoch: 7 cost time: 3.229475498199463
Epoch: 7, Steps: 17 | Train Loss: 0.879 Vali Loss: 0.816 Vali Acc: 0.903 Test Loss: 0.816 Test Acc: 0.903
Validation loss decreased (-0.859449 --> -0.902695).  Saving model ...
Epoch: 8 cost time: 3.6889595985412598
Epoch: 8, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.626 Vali Acc: 0.924 Test Loss: 0.626 Test Acc: 0.924
Validation loss decreased (-0.902695 --> -0.924318).  Saving model ...
Epoch: 9 cost time: 3.693185567855835
Epoch: 9, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.488 Vali Acc: 0.935 Test Loss: 0.488 Test Acc: 0.935
Validation loss decreased (-0.924318 --> -0.935130).  Saving model ...
Epoch: 10 cost time: 3.264787197113037
Epoch: 10, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.392 Vali Acc: 0.949 Test Loss: 0.392 Test Acc: 0.949
Validation loss decreased (-0.935130 --> -0.948645).  Saving model ...
Epoch: 11 cost time: 3.2653000354766846
Epoch: 11, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.336 Vali Acc: 0.949 Test Loss: 0.336 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948645).  Saving model ...
Epoch: 12 cost time: 3.1671831607818604
Epoch: 12, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.263 Vali Acc: 0.954 Test Loss: 0.263 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 13 cost time: 3.2142443656921387
Epoch: 13, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.231 Vali Acc: 0.954 Test Loss: 0.231 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 3.2112045288085938
Epoch: 14, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.210 Vali Acc: 0.962 Test Loss: 0.210 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 3.470686197280884
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6604230403900146
Epoch: 16, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.742541551589966
Epoch: 17, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 3.4583868980407715
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.704235553741455
Epoch: 19, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7134931087493896
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.194 Vali Acc: 0.932 Test Loss: 0.194 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.744748115539551
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.737715005874634
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3089592456817627
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.4874210357666016
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4619717597961426
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.4181320667266846
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.442573070526123
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1768041
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.278167724609375
Epoch: 1, Steps: 17 | Train Loss: 2.301 Vali Loss: 2.249 Vali Acc: 0.108 Test Loss: 2.249 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 2.72658371925354
Epoch: 2, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.082 Vali Acc: 0.219 Test Loss: 2.082 Test Acc: 0.219
Validation loss decreased (-0.108086 --> -0.218898).  Saving model ...
Epoch: 3 cost time: 2.7079532146453857
Epoch: 3, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.875 Vali Acc: 0.468 Test Loss: 1.875 Test Acc: 0.468
Validation loss decreased (-0.218898 --> -0.467549).  Saving model ...
Epoch: 4 cost time: 2.757591724395752
Epoch: 4, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.647 Vali Acc: 0.738 Test Loss: 1.647 Test Acc: 0.738
Validation loss decreased (-0.467549 --> -0.737821).  Saving model ...
Epoch: 5 cost time: 2.784907817840576
Epoch: 5, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.396 Vali Acc: 0.846 Test Loss: 1.396 Test Acc: 0.846
Validation loss decreased (-0.737821 --> -0.845932).  Saving model ...
Epoch: 6 cost time: 2.6719439029693604
Epoch: 6, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.153 Vali Acc: 0.886 Test Loss: 1.153 Test Acc: 0.886
Validation loss decreased (-0.845932 --> -0.886475).  Saving model ...
Epoch: 7 cost time: 2.541165351867676
Epoch: 7, Steps: 17 | Train Loss: 0.989 Vali Loss: 0.928 Vali Acc: 0.905 Test Loss: 0.928 Test Acc: 0.905
Validation loss decreased (-0.886475 --> -0.905396).  Saving model ...
Epoch: 8 cost time: 2.6387429237365723
Epoch: 8, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.738 Vali Acc: 0.916 Test Loss: 0.738 Test Acc: 0.916
Validation loss decreased (-0.905396 --> -0.916209).  Saving model ...
Epoch: 9 cost time: 2.346086025238037
Epoch: 9, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.590 Vali Acc: 0.930 Test Loss: 0.590 Test Acc: 0.930
Validation loss decreased (-0.916209 --> -0.929724).  Saving model ...
Epoch: 10 cost time: 2.376854419708252
Epoch: 10, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.481 Vali Acc: 0.938 Test Loss: 0.481 Test Acc: 0.938
Validation loss decreased (-0.929724 --> -0.937833).  Saving model ...
Epoch: 11 cost time: 2.292919158935547
Epoch: 11, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.378 Vali Acc: 0.951 Test Loss: 0.378 Test Acc: 0.951
Validation loss decreased (-0.937833 --> -0.951348).  Saving model ...
Epoch: 12 cost time: 2.350374698638916
Epoch: 12, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.314 Vali Acc: 0.946 Test Loss: 0.314 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3641834259033203
Epoch: 13, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 2.364048480987549
Epoch: 14, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.238 Vali Acc: 0.946 Test Loss: 0.238 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6808717250823975
Epoch: 15, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 2.6874611377716064
Epoch: 16, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5942258834838867
Epoch: 17, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6481852531433105
Epoch: 18, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6813414096832275
Epoch: 19, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.677178382873535
Epoch: 20, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5661513805389404
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.5238137245178223
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.561241388320923
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.512096881866455
Epoch: 24, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 2.14365816116333
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.117563486099243
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.293879747390747
Epoch: 27, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2761449813842773
Epoch: 28, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.235602617263794
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.022080421447754
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 526569
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.430783987045288
Epoch: 1, Steps: 17 | Train Loss: 2.159 Vali Loss: 2.102 Vali Acc: 0.192 Test Loss: 2.102 Test Acc: 0.192
Validation loss decreased (inf --> -0.191871).  Saving model ...
Epoch: 2 cost time: 3.6187691688537598
Epoch: 2, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.007 Vali Acc: 0.324 Test Loss: 2.007 Test Acc: 0.324
Validation loss decreased (-0.191871 --> -0.324304).  Saving model ...
Epoch: 3 cost time: 3.6325886249542236
Epoch: 3, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.878 Vali Acc: 0.505 Test Loss: 1.878 Test Acc: 0.505
Validation loss decreased (-0.324304 --> -0.505387).  Saving model ...
Epoch: 4 cost time: 3.6562118530273438
Epoch: 4, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.717 Vali Acc: 0.649 Test Loss: 1.717 Test Acc: 0.649
Validation loss decreased (-0.505387 --> -0.648631).  Saving model ...
Epoch: 5 cost time: 3.6631016731262207
Epoch: 5, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.532 Vali Acc: 0.724 Test Loss: 1.532 Test Acc: 0.724
Validation loss decreased (-0.648631 --> -0.724309).  Saving model ...
Epoch: 6 cost time: 3.495579242706299
Epoch: 6, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.316 Vali Acc: 0.795 Test Loss: 1.316 Test Acc: 0.795
Validation loss decreased (-0.724309 --> -0.794581).  Saving model ...
Epoch: 7 cost time: 3.405715227127075
Epoch: 7, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.124 Vali Acc: 0.832 Test Loss: 1.124 Test Acc: 0.832
Validation loss decreased (-0.794581 --> -0.832421).  Saving model ...
Epoch: 8 cost time: 3.305147647857666
Epoch: 8, Steps: 17 | Train Loss: 1.039 Vali Loss: 0.920 Vali Acc: 0.903 Test Loss: 0.920 Test Acc: 0.903
Validation loss decreased (-0.832421 --> -0.902693).  Saving model ...
Epoch: 9 cost time: 3.4347167015075684
Epoch: 9, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.771 Vali Acc: 0.908 Test Loss: 0.771 Test Acc: 0.908
Validation loss decreased (-0.902693 --> -0.908100).  Saving model ...
Epoch: 10 cost time: 3.415037155151367
Epoch: 10, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.641 Vali Acc: 0.930 Test Loss: 0.641 Test Acc: 0.930
Validation loss decreased (-0.908100 --> -0.929723).  Saving model ...
Epoch: 11 cost time: 3.8309054374694824
Epoch: 11, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.545 Vali Acc: 0.919 Test Loss: 0.545 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7746078968048096
Epoch: 12, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.442 Vali Acc: 0.943 Test Loss: 0.442 Test Acc: 0.943
Validation loss decreased (-0.929723 --> -0.943239).  Saving model ...
Epoch: 13 cost time: 3.8181662559509277
Epoch: 13, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.357 Vali Acc: 0.959 Test Loss: 0.357 Test Acc: 0.959
Validation loss decreased (-0.943239 --> -0.959456).  Saving model ...
Epoch: 14 cost time: 3.7902560234069824
Epoch: 14, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.413 Vali Acc: 0.908 Test Loss: 0.413 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8319411277770996
Epoch: 15, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7940855026245117
Epoch: 16, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.784397840499878
Epoch: 17, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.391815423965454
Epoch: 18, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.178 Vali Acc: 0.968 Test Loss: 0.178 Test Acc: 0.968
Validation loss decreased (-0.959456 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 3.387984275817871
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972971).  Saving model ...
Epoch: 20 cost time: 3.3063557147979736
Epoch: 20, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.430105686187744
Epoch: 21, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.631014823913574
Epoch: 22, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5927178859710693
Epoch: 23, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.6542139053344727
Epoch: 24, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6007471084594727
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4212632179260254
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.5268714427948
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.5154080390930176
Epoch: 28, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.0427496433258057
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1763481
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.148226976394653
Epoch: 1, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.184 Vali Acc: 0.119 Test Loss: 2.184 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 2.4659838676452637
Epoch: 2, Steps: 17 | Train Loss: 2.140 Vali Loss: 2.066 Vali Acc: 0.259 Test Loss: 2.066 Test Acc: 0.259
Validation loss decreased (-0.118897 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 2.309028387069702
Epoch: 3, Steps: 17 | Train Loss: 2.000 Vali Loss: 1.906 Vali Acc: 0.470 Test Loss: 1.906 Test Acc: 0.470
Validation loss decreased (-0.259439 --> -0.470251).  Saving model ...
Epoch: 4 cost time: 2.125333309173584
Epoch: 4, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.737 Vali Acc: 0.659 Test Loss: 1.737 Test Acc: 0.659
Validation loss decreased (-0.470251 --> -0.659442).  Saving model ...
Epoch: 5 cost time: 2.2102372646331787
Epoch: 5, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.546 Vali Acc: 0.789 Test Loss: 1.546 Test Acc: 0.789
Validation loss decreased (-0.659442 --> -0.789174).  Saving model ...
Epoch: 6 cost time: 2.9212563037872314
Epoch: 6, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.348 Vali Acc: 0.865 Test Loss: 1.348 Test Acc: 0.865
Validation loss decreased (-0.789174 --> -0.864851).  Saving model ...
Epoch: 7 cost time: 2.943037986755371
Epoch: 7, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.171 Vali Acc: 0.868 Test Loss: 1.171 Test Acc: 0.868
Validation loss decreased (-0.864851 --> -0.867556).  Saving model ...
Epoch: 8 cost time: 2.9573655128479004
Epoch: 8, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.018 Vali Acc: 0.868 Test Loss: 1.018 Test Acc: 0.868
Validation loss decreased (-0.867556 --> -0.867557).  Saving model ...
Epoch: 9 cost time: 2.936704397201538
Epoch: 9, Steps: 17 | Train Loss: 0.903 Vali Loss: 0.863 Vali Acc: 0.881 Test Loss: 0.863 Test Acc: 0.881
Validation loss decreased (-0.867557 --> -0.881072).  Saving model ...
Epoch: 10 cost time: 2.920912742614746
Epoch: 10, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.767 Vali Acc: 0.889 Test Loss: 0.767 Test Acc: 0.889
Validation loss decreased (-0.881072 --> -0.889182).  Saving model ...
Epoch: 11 cost time: 3.053750991821289
Epoch: 11, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.643 Vali Acc: 0.908 Test Loss: 0.643 Test Acc: 0.908
Validation loss decreased (-0.889182 --> -0.908102).  Saving model ...
Epoch: 12 cost time: 3.0407745838165283
Epoch: 12, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.554 Vali Acc: 0.916 Test Loss: 0.554 Test Acc: 0.916
Validation loss decreased (-0.908102 --> -0.916211).  Saving model ...
Epoch: 13 cost time: 2.9855825901031494
Epoch: 13, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.517 Vali Acc: 0.905 Test Loss: 0.517 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.00459623336792
Epoch: 14, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.431 Vali Acc: 0.922 Test Loss: 0.431 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921617).  Saving model ...
Epoch: 15 cost time: 3.017184257507324
Epoch: 15, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.383 Vali Acc: 0.924 Test Loss: 0.383 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 16 cost time: 3.1502599716186523
Epoch: 16, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.355 Vali Acc: 0.927 Test Loss: 0.355 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 17 cost time: 3.0277535915374756
Epoch: 17, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.308 Vali Acc: 0.938 Test Loss: 0.308 Test Acc: 0.938
Validation loss decreased (-0.927023 --> -0.937835).  Saving model ...
Epoch: 18 cost time: 2.952836036682129
Epoch: 18, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 2.9229655265808105
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 20 cost time: 3.0683114528656006
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.034783124923706
Epoch: 21, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 3.0520248413085938
Epoch: 22, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0023884773254395
Epoch: 23, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.082929849624634
Epoch: 24, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1040427684783936
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.238 Vali Acc: 0.935 Test Loss: 0.238 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.052114486694336
Epoch: 26, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.968160390853882
Epoch: 27, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 2.983548402786255
Epoch: 28, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.932 Test Loss: 0.216 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1335694789886475
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.204 Vali Acc: 0.938 Test Loss: 0.204 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9927561283111572
Epoch: 30, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 521913
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.6390180587768555
Epoch: 1, Steps: 17 | Train Loss: 2.159 Vali Loss: 2.102 Vali Acc: 0.192 Test Loss: 2.102 Test Acc: 0.192
Validation loss decreased (inf --> -0.191871).  Saving model ...
Epoch: 2 cost time: 2.6913297176361084
Epoch: 2, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.008 Vali Acc: 0.322 Test Loss: 2.008 Test Acc: 0.322
Validation loss decreased (-0.191871 --> -0.321602).  Saving model ...
Epoch: 3 cost time: 2.725666046142578
Epoch: 3, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.879 Vali Acc: 0.505 Test Loss: 1.879 Test Acc: 0.505
Validation loss decreased (-0.321602 --> -0.505387).  Saving model ...
Epoch: 4 cost time: 2.741363286972046
Epoch: 4, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.717 Vali Acc: 0.646 Test Loss: 1.717 Test Acc: 0.646
Validation loss decreased (-0.505387 --> -0.645929).  Saving model ...
Epoch: 5 cost time: 2.7697646617889404
Epoch: 5, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.531 Vali Acc: 0.724 Test Loss: 1.531 Test Acc: 0.724
Validation loss decreased (-0.645929 --> -0.724309).  Saving model ...
Epoch: 6 cost time: 2.791539430618286
Epoch: 6, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.316 Vali Acc: 0.795 Test Loss: 1.316 Test Acc: 0.795
Validation loss decreased (-0.724309 --> -0.794581).  Saving model ...
Epoch: 7 cost time: 2.7823047637939453
Epoch: 7, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.124 Vali Acc: 0.832 Test Loss: 1.124 Test Acc: 0.832
Validation loss decreased (-0.794581 --> -0.832421).  Saving model ...
Epoch: 8 cost time: 2.757267951965332
Epoch: 8, Steps: 17 | Train Loss: 1.041 Vali Loss: 0.923 Vali Acc: 0.903 Test Loss: 0.923 Test Acc: 0.903
Validation loss decreased (-0.832421 --> -0.902693).  Saving model ...
Epoch: 9 cost time: 2.6936540603637695
Epoch: 9, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.772 Vali Acc: 0.911 Test Loss: 0.772 Test Acc: 0.911
Validation loss decreased (-0.902693 --> -0.910803).  Saving model ...
Epoch: 10 cost time: 2.999242067337036
Epoch: 10, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.642 Vali Acc: 0.932 Test Loss: 0.642 Test Acc: 0.932
Validation loss decreased (-0.910803 --> -0.932426).  Saving model ...
Epoch: 11 cost time: 2.9002292156219482
Epoch: 11, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.547 Vali Acc: 0.922 Test Loss: 0.547 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.847362518310547
Epoch: 12, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.441 Vali Acc: 0.932 Test Loss: 0.441 Test Acc: 0.932
Validation loss decreased (-0.932426 --> -0.932428).  Saving model ...
Epoch: 13 cost time: 2.9117910861968994
Epoch: 13, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.362 Vali Acc: 0.959 Test Loss: 0.362 Test Acc: 0.959
Validation loss decreased (-0.932428 --> -0.959456).  Saving model ...
Epoch: 14 cost time: 2.9929327964782715
Epoch: 14, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.415 Vali Acc: 0.903 Test Loss: 0.415 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1093103885650635
Epoch: 15, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.278 Vali Acc: 0.951 Test Loss: 0.278 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.011051893234253
Epoch: 16, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0509281158447266
Epoch: 17, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.228 Vali Acc: 0.957 Test Loss: 0.228 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0013203620910645
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
Validation loss decreased (-0.959456 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 3.0343406200408936
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 3.365410089492798
Epoch: 20, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3434932231903076
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3357906341552734
Epoch: 22, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2753775119781494
Epoch: 23, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4105403423309326
Epoch: 24, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.400967836380005
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.401808500289917
Epoch: 26, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3780112266540527
Epoch: 27, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.386580467224121
Epoch: 28, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.3979990482330322
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1763481
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.2437238693237305
Epoch: 1, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.184 Vali Acc: 0.119 Test Loss: 2.184 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 2.736985206604004
Epoch: 2, Steps: 17 | Train Loss: 2.140 Vali Loss: 2.066 Vali Acc: 0.259 Test Loss: 2.066 Test Acc: 0.259
Validation loss decreased (-0.118897 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 2.745121479034424
Epoch: 3, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.907 Vali Acc: 0.468 Test Loss: 1.907 Test Acc: 0.468
Validation loss decreased (-0.259439 --> -0.467549).  Saving model ...
Epoch: 4 cost time: 2.805928945541382
Epoch: 4, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.737 Vali Acc: 0.665 Test Loss: 1.737 Test Acc: 0.665
Validation loss decreased (-0.467549 --> -0.664847).  Saving model ...
Epoch: 5 cost time: 2.710592269897461
Epoch: 5, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.545 Vali Acc: 0.789 Test Loss: 1.545 Test Acc: 0.789
Validation loss decreased (-0.664847 --> -0.789174).  Saving model ...
Epoch: 6 cost time: 2.467402935028076
Epoch: 6, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.347 Vali Acc: 0.859 Test Loss: 1.347 Test Acc: 0.859
Validation loss decreased (-0.789174 --> -0.859446).  Saving model ...
Epoch: 7 cost time: 2.671630859375
Epoch: 7, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.170 Vali Acc: 0.868 Test Loss: 1.170 Test Acc: 0.868
Validation loss decreased (-0.859446 --> -0.867556).  Saving model ...
Epoch: 8 cost time: 2.584416151046753
Epoch: 8, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.019 Vali Acc: 0.862 Test Loss: 1.019 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5621562004089355
Epoch: 9, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.864 Vali Acc: 0.881 Test Loss: 0.864 Test Acc: 0.881
Validation loss decreased (-0.867556 --> -0.881072).  Saving model ...
Epoch: 10 cost time: 2.5203254222869873
Epoch: 10, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.769 Vali Acc: 0.873 Test Loss: 0.769 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.65401554107666
Epoch: 11, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.647 Vali Acc: 0.908 Test Loss: 0.647 Test Acc: 0.908
Validation loss decreased (-0.881072 --> -0.908102).  Saving model ...
Epoch: 12 cost time: 2.5555500984191895
Epoch: 12, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.558 Vali Acc: 0.916 Test Loss: 0.558 Test Acc: 0.916
Validation loss decreased (-0.908102 --> -0.916211).  Saving model ...
Epoch: 13 cost time: 2.60603404045105
Epoch: 13, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6125144958496094
Epoch: 14, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.431 Vali Acc: 0.922 Test Loss: 0.431 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921617).  Saving model ...
Epoch: 15 cost time: 2.472036361694336
Epoch: 15, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5504941940307617
Epoch: 16, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921618).  Saving model ...
Epoch: 17 cost time: 2.861189603805542
Epoch: 17, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.310 Vali Acc: 0.935 Test Loss: 0.310 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935132).  Saving model ...
Epoch: 18 cost time: 2.771883726119995
Epoch: 18, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 2.824314594268799
Epoch: 19, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 20 cost time: 2.8871009349823
Epoch: 20, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.956568956375122
Epoch: 21, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 2.726557731628418
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.758469343185425
Epoch: 23, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.972687005996704
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.293 Vali Acc: 0.914 Test Loss: 0.293 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9962401390075684
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 2.8976008892059326
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.901204824447632
Epoch: 27, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8414249420166016
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.200 Vali Acc: 0.932 Test Loss: 0.200 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.84818434715271
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.8832709789276123
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 521913
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.362258434295654
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 2.103 Vali Acc: 0.189 Test Loss: 2.103 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 2.5946691036224365
Epoch: 2, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.011 Vali Acc: 0.316 Test Loss: 2.011 Test Acc: 0.316
Validation loss decreased (-0.189168 --> -0.316196).  Saving model ...
Epoch: 3 cost time: 2.5833895206451416
Epoch: 3, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.889 Vali Acc: 0.486 Test Loss: 1.889 Test Acc: 0.486
Validation loss decreased (-0.316196 --> -0.486468).  Saving model ...
Epoch: 4 cost time: 2.4961068630218506
Epoch: 4, Steps: 17 | Train Loss: 1.816 Vali Loss: 1.743 Vali Acc: 0.624 Test Loss: 1.743 Test Acc: 0.624
Validation loss decreased (-0.486468 --> -0.624307).  Saving model ...
Epoch: 5 cost time: 2.5463461875915527
Epoch: 5, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.582 Vali Acc: 0.705 Test Loss: 1.582 Test Acc: 0.705
Validation loss decreased (-0.624307 --> -0.705390).  Saving model ...
Epoch: 6 cost time: 2.648797035217285
Epoch: 6, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.394 Vali Acc: 0.786 Test Loss: 1.394 Test Acc: 0.786
Validation loss decreased (-0.705390 --> -0.786473).  Saving model ...
Epoch: 7 cost time: 2.5753540992736816
Epoch: 7, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.203 Vali Acc: 0.838 Test Loss: 1.203 Test Acc: 0.838
Validation loss decreased (-0.786473 --> -0.837826).  Saving model ...
Epoch: 8 cost time: 2.6600685119628906
Epoch: 8, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.025 Vali Acc: 0.881 Test Loss: 1.025 Test Acc: 0.881
Validation loss decreased (-0.837826 --> -0.881071).  Saving model ...
Epoch: 9 cost time: 2.606044054031372
Epoch: 9, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.882 Vali Acc: 0.905 Test Loss: 0.882 Test Acc: 0.905
Validation loss decreased (-0.881071 --> -0.905397).  Saving model ...
Epoch: 10 cost time: 2.5965375900268555
Epoch: 10, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.750 Vali Acc: 0.922 Test Loss: 0.750 Test Acc: 0.922
Validation loss decreased (-0.905397 --> -0.921614).  Saving model ...
Epoch: 11 cost time: 2.6055448055267334
Epoch: 11, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.644 Vali Acc: 0.916 Test Loss: 0.644 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5492968559265137
Epoch: 12, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.543 Vali Acc: 0.924 Test Loss: 0.543 Test Acc: 0.924
Validation loss decreased (-0.921614 --> -0.924319).  Saving model ...
Epoch: 13 cost time: 2.6396305561065674
Epoch: 13, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.485 Vali Acc: 0.919 Test Loss: 0.485 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.574014902114868
Epoch: 14, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6567599773406982
Epoch: 15, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.353 Vali Acc: 0.949 Test Loss: 0.353 Test Acc: 0.949
Validation loss decreased (-0.924319 --> -0.948645).  Saving model ...
Epoch: 16 cost time: 2.5671963691711426
Epoch: 16, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.309 Vali Acc: 0.938 Test Loss: 0.309 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6090378761291504
Epoch: 17, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.316 Vali Acc: 0.924 Test Loss: 0.316 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.600015640258789
Epoch: 18, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.240 Vali Acc: 0.965 Test Loss: 0.240 Test Acc: 0.965
Validation loss decreased (-0.948645 --> -0.964862).  Saving model ...
Epoch: 19 cost time: 2.564908027648926
Epoch: 19, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.240 Vali Acc: 0.946 Test Loss: 0.240 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4623899459838867
Epoch: 20, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.213 Vali Acc: 0.954 Test Loss: 0.213 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4153082370758057
Epoch: 21, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.4642140865325928
Epoch: 22, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.363823175430298
Epoch: 23, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3342394828796387
Epoch: 24, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.357651948928833
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.4848520755767822
Epoch: 26, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.461137294769287
Epoch: 27, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.340113401412964
Epoch: 28, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1763481
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.788801670074463
Epoch: 1, Steps: 17 | Train Loss: 2.241 Vali Loss: 2.186 Vali Acc: 0.114 Test Loss: 2.186 Test Acc: 0.114
Validation loss decreased (inf --> -0.113492).  Saving model ...
Epoch: 2 cost time: 1.7454462051391602
Epoch: 2, Steps: 17 | Train Loss: 2.142 Vali Loss: 2.073 Vali Acc: 0.257 Test Loss: 2.073 Test Acc: 0.257
Validation loss decreased (-0.113492 --> -0.256736).  Saving model ...
Epoch: 3 cost time: 2.2315890789031982
Epoch: 3, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.923 Vali Acc: 0.459 Test Loss: 1.923 Test Acc: 0.459
Validation loss decreased (-0.256736 --> -0.459440).  Saving model ...
Epoch: 4 cost time: 2.152985095977783
Epoch: 4, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.769 Vali Acc: 0.611 Test Loss: 1.769 Test Acc: 0.611
Validation loss decreased (-0.459440 --> -0.610793).  Saving model ...
Epoch: 5 cost time: 2.2006213665008545
Epoch: 5, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.597 Vali Acc: 0.714 Test Loss: 1.597 Test Acc: 0.714
Validation loss decreased (-0.610793 --> -0.713498).  Saving model ...
Epoch: 6 cost time: 2.260175943374634
Epoch: 6, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.418 Vali Acc: 0.770 Test Loss: 1.418 Test Acc: 0.770
Validation loss decreased (-0.713498 --> -0.770256).  Saving model ...
Epoch: 7 cost time: 2.103973865509033
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.263 Vali Acc: 0.776 Test Loss: 1.263 Test Acc: 0.776
Validation loss decreased (-0.770256 --> -0.775663).  Saving model ...
Epoch: 8 cost time: 2.209399700164795
Epoch: 8, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.124 Vali Acc: 0.808 Test Loss: 1.124 Test Acc: 0.808
Validation loss decreased (-0.775663 --> -0.808097).  Saving model ...
Epoch: 9 cost time: 2.130117654800415
Epoch: 9, Steps: 17 | Train Loss: 1.013 Vali Loss: 0.993 Vali Acc: 0.843 Test Loss: 0.993 Test Acc: 0.843
Validation loss decreased (-0.808097 --> -0.843233).  Saving model ...
Epoch: 10 cost time: 2.2114293575286865
Epoch: 10, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.899 Vali Acc: 0.843 Test Loss: 0.899 Test Acc: 0.843
Validation loss decreased (-0.843233 --> -0.843234).  Saving model ...
Epoch: 11 cost time: 1.972362995147705
Epoch: 11, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.789 Vali Acc: 0.876 Test Loss: 0.789 Test Acc: 0.876
Validation loss decreased (-0.843234 --> -0.875668).  Saving model ...
Epoch: 12 cost time: 2.0758779048919678
Epoch: 12, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.696 Vali Acc: 0.900 Test Loss: 0.696 Test Acc: 0.900
Validation loss decreased (-0.875668 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 2.0222668647766113
Epoch: 13, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.629 Vali Acc: 0.905 Test Loss: 0.629 Test Acc: 0.905
Validation loss decreased (-0.899993 --> -0.905399).  Saving model ...
Epoch: 14 cost time: 2.085909843444824
Epoch: 14, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.556 Vali Acc: 0.908 Test Loss: 0.556 Test Acc: 0.908
Validation loss decreased (-0.905399 --> -0.908103).  Saving model ...
Epoch: 15 cost time: 2.014901876449585
Epoch: 15, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.492 Vali Acc: 0.914 Test Loss: 0.492 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 16 cost time: 1.9613564014434814
Epoch: 16, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.451 Vali Acc: 0.911 Test Loss: 0.451 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9995629787445068
Epoch: 17, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.913509 --> -0.921618).  Saving model ...
Epoch: 18 cost time: 2.0830321311950684
Epoch: 18, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.366 Vali Acc: 0.930 Test Loss: 0.366 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929726).  Saving model ...
Epoch: 19 cost time: 2.143190622329712
Epoch: 19, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.311 Vali Acc: 0.946 Test Loss: 0.311 Test Acc: 0.946
Validation loss decreased (-0.929726 --> -0.945943).  Saving model ...
Epoch: 20 cost time: 2.109541654586792
Epoch: 20, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0663416385650635
Epoch: 21, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.264 Vali Acc: 0.943 Test Loss: 0.264 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.16349196434021
Epoch: 22, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1350619792938232
Epoch: 23, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.250 Vali Acc: 0.943 Test Loss: 0.250 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0891501903533936
Epoch: 24, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.087751865386963
Epoch: 25, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0745022296905518
Epoch: 26, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 2.0763790607452393
Epoch: 27, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.213 Vali Acc: 0.949 Test Loss: 0.213 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 2.0917623043060303
Epoch: 28, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0920777320861816
Epoch: 29, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.057450294494629
Epoch: 30, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 521913
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.9839506149292
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.074 Vali Acc: 0.319 Test Loss: 2.074 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 7.896461248397827
Epoch: 2, Steps: 17 | Train Loss: 2.105 Vali Loss: 1.985 Vali Acc: 0.395 Test Loss: 1.985 Test Acc: 0.395
Validation loss decreased (-0.318898 --> -0.394575).  Saving model ...
Epoch: 3 cost time: 7.738502502441406
Epoch: 3, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.866 Vali Acc: 0.551 Test Loss: 1.866 Test Acc: 0.551
Validation loss decreased (-0.394575 --> -0.551333).  Saving model ...
Epoch: 4 cost time: 7.429921388626099
Epoch: 4, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.724 Vali Acc: 0.665 Test Loss: 1.724 Test Acc: 0.665
Validation loss decreased (-0.551333 --> -0.664848).  Saving model ...
Epoch: 5 cost time: 7.3956968784332275
Epoch: 5, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.566 Vali Acc: 0.716 Test Loss: 1.566 Test Acc: 0.716
Validation loss decreased (-0.664848 --> -0.716201).  Saving model ...
Epoch: 6 cost time: 7.358994007110596
Epoch: 6, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.383 Vali Acc: 0.770 Test Loss: 1.383 Test Acc: 0.770
Validation loss decreased (-0.716201 --> -0.770256).  Saving model ...
Epoch: 7 cost time: 6.79939866065979
Epoch: 7, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.194 Vali Acc: 0.835 Test Loss: 1.194 Test Acc: 0.835
Validation loss decreased (-0.770256 --> -0.835123).  Saving model ...
Epoch: 8 cost time: 7.218116760253906
Epoch: 8, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.037 Vali Acc: 0.846 Test Loss: 1.037 Test Acc: 0.846
Validation loss decreased (-0.835123 --> -0.845936).  Saving model ...
Epoch: 9 cost time: 7.895519971847534
Epoch: 9, Steps: 17 | Train Loss: 0.876 Vali Loss: 0.890 Vali Acc: 0.881 Test Loss: 0.890 Test Acc: 0.881
Validation loss decreased (-0.845936 --> -0.881072).  Saving model ...
Epoch: 10 cost time: 7.607884168624878
Epoch: 10, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.783 Vali Acc: 0.873 Test Loss: 0.783 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.6145713329315186
Epoch: 11, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.693 Vali Acc: 0.892 Test Loss: 0.693 Test Acc: 0.892
Validation loss decreased (-0.881072 --> -0.891885).  Saving model ...
Epoch: 12 cost time: 7.692364454269409
Epoch: 12, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.593 Vali Acc: 0.908 Test Loss: 0.593 Test Acc: 0.908
Validation loss decreased (-0.891885 --> -0.908102).  Saving model ...
Epoch: 13 cost time: 7.095581531524658
Epoch: 13, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.862711668014526
Epoch: 14, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.447 Vali Acc: 0.927 Test Loss: 0.447 Test Acc: 0.927
Validation loss decreased (-0.908102 --> -0.927023).  Saving model ...
Epoch: 15 cost time: 7.793321371078491
Epoch: 15, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.398 Vali Acc: 0.935 Test Loss: 0.398 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935131).  Saving model ...
Epoch: 16 cost time: 7.832115411758423
Epoch: 16, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.372 Vali Acc: 0.924 Test Loss: 0.372 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.809540748596191
Epoch: 17, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 18 cost time: 4.858784198760986
Epoch: 18, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.296 Vali Acc: 0.932 Test Loss: 0.296 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.804583311080933
Epoch: 19, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 20 cost time: 8.139014720916748
Epoch: 20, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.099568605422974
Epoch: 21, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
Validation loss decreased (-0.945943 --> -0.962160).  Saving model ...
Epoch: 22 cost time: 8.105021238327026
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.126249551773071
Epoch: 23, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 7.854882478713989
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.758981227874756
Epoch: 25, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.789262294769287
Epoch: 26, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.949 Test Loss: 0.150 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.810000658035278
Epoch: 27, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.954 Test Loss: 0.136 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.862719535827637
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.270 Vali Acc: 0.924 Test Loss: 0.270 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.936376094818115
Epoch: 29, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.171 Vali Acc: 0.938 Test Loss: 0.171 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.791709661483765
Epoch: 30, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 884313
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.084532260894775
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.141 Vali Acc: 0.162 Test Loss: 2.141 Test Acc: 0.162
Validation loss decreased (inf --> -0.162141).  Saving model ...
Epoch: 2 cost time: 5.406603574752808
Epoch: 2, Steps: 17 | Train Loss: 2.128 Vali Loss: 2.048 Vali Acc: 0.246 Test Loss: 2.048 Test Acc: 0.246
Validation loss decreased (-0.162141 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 5.474858999252319
Epoch: 3, Steps: 17 | Train Loss: 2.016 Vali Loss: 1.927 Vali Acc: 0.411 Test Loss: 1.927 Test Acc: 0.411
Validation loss decreased (-0.245925 --> -0.410792).  Saving model ...
Epoch: 4 cost time: 5.452859401702881
Epoch: 4, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.790 Vali Acc: 0.600 Test Loss: 1.790 Test Acc: 0.600
Validation loss decreased (-0.410792 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 5.488119840621948
Epoch: 5, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.629 Vali Acc: 0.741 Test Loss: 1.629 Test Acc: 0.741
Validation loss decreased (-0.599982 --> -0.740524).  Saving model ...
Epoch: 6 cost time: 5.29526162147522
Epoch: 6, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.454 Vali Acc: 0.797 Test Loss: 1.454 Test Acc: 0.797
Validation loss decreased (-0.740524 --> -0.797283).  Saving model ...
Epoch: 7 cost time: 5.028874158859253
Epoch: 7, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.273 Vali Acc: 0.822 Test Loss: 1.273 Test Acc: 0.822
Validation loss decreased (-0.797283 --> -0.821609).  Saving model ...
Epoch: 8 cost time: 5.013654470443726
Epoch: 8, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.118 Vali Acc: 0.841 Test Loss: 1.118 Test Acc: 0.841
Validation loss decreased (-0.821609 --> -0.840529).  Saving model ...
Epoch: 9 cost time: 5.02567458152771
Epoch: 9, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.981 Vali Acc: 0.846 Test Loss: 0.981 Test Acc: 0.846
Validation loss decreased (-0.840529 --> -0.845936).  Saving model ...
Epoch: 10 cost time: 5.131758689880371
Epoch: 10, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.875 Vali Acc: 0.857 Test Loss: 0.875 Test Acc: 0.857
Validation loss decreased (-0.845936 --> -0.856748).  Saving model ...
Epoch: 11 cost time: 4.850462198257446
Epoch: 11, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.761 Vali Acc: 0.889 Test Loss: 0.761 Test Acc: 0.889
Validation loss decreased (-0.856748 --> -0.889182).  Saving model ...
Epoch: 12 cost time: 5.049011468887329
Epoch: 12, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.682 Vali Acc: 0.886 Test Loss: 0.682 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.06621241569519
Epoch: 13, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.599 Vali Acc: 0.916 Test Loss: 0.599 Test Acc: 0.916
Validation loss decreased (-0.889182 --> -0.916210).  Saving model ...
Epoch: 14 cost time: 5.531995058059692
Epoch: 14, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.521 Vali Acc: 0.924 Test Loss: 0.521 Test Acc: 0.924
Validation loss decreased (-0.916210 --> -0.924319).  Saving model ...
Epoch: 15 cost time: 5.56424880027771
Epoch: 15, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.482 Vali Acc: 0.930 Test Loss: 0.482 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929725).  Saving model ...
Epoch: 16 cost time: 5.562966585159302
Epoch: 16, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.408 Vali Acc: 0.941 Test Loss: 0.408 Test Acc: 0.941
Validation loss decreased (-0.929725 --> -0.940536).  Saving model ...
Epoch: 17 cost time: 5.612060785293579
Epoch: 17, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 18 cost time: 5.5450029373168945
Epoch: 18, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 5.313256025314331
Epoch: 19, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 20 cost time: 5.359736919403076
Epoch: 20, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.275 Vali Acc: 0.957 Test Loss: 0.275 Test Acc: 0.957
Validation loss decreased (-0.940537 --> -0.956754).  Saving model ...
Epoch: 21 cost time: 4.862108469009399
Epoch: 21, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.265 Vali Acc: 0.957 Test Loss: 0.265 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 22 cost time: 4.682601451873779
Epoch: 22, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.252 Vali Acc: 0.946 Test Loss: 0.252 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.810452699661255
Epoch: 23, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 24 cost time: 4.380565404891968
Epoch: 24, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.247 Vali Acc: 0.946 Test Loss: 0.247 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.68285870552063
Epoch: 25, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 26 cost time: 5.052210092544556
Epoch: 26, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.9721479415893555
Epoch: 27, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.475005865097046
Epoch: 28, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.5120837688446045
Epoch: 29, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.954 Test Loss: 0.213 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.457228660583496
Epoch: 30, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 263481
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.964818954467773
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.075 Vali Acc: 0.319 Test Loss: 2.075 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 6.257289409637451
Epoch: 2, Steps: 17 | Train Loss: 2.105 Vali Loss: 1.985 Vali Acc: 0.395 Test Loss: 1.985 Test Acc: 0.395
Validation loss decreased (-0.318898 --> -0.394575).  Saving model ...
Epoch: 3 cost time: 6.297245025634766
Epoch: 3, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.866 Vali Acc: 0.551 Test Loss: 1.866 Test Acc: 0.551
Validation loss decreased (-0.394575 --> -0.551333).  Saving model ...
Epoch: 4 cost time: 5.454375267028809
Epoch: 4, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.724 Vali Acc: 0.668 Test Loss: 1.724 Test Acc: 0.668
Validation loss decreased (-0.551333 --> -0.667550).  Saving model ...
Epoch: 5 cost time: 5.740166902542114
Epoch: 5, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.566 Vali Acc: 0.716 Test Loss: 1.566 Test Acc: 0.716
Validation loss decreased (-0.667550 --> -0.716201).  Saving model ...
Epoch: 6 cost time: 5.787651777267456
Epoch: 6, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.384 Vali Acc: 0.773 Test Loss: 1.384 Test Acc: 0.773
Validation loss decreased (-0.716201 --> -0.772959).  Saving model ...
Epoch: 7 cost time: 5.7673492431640625
Epoch: 7, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.196 Vali Acc: 0.835 Test Loss: 1.196 Test Acc: 0.835
Validation loss decreased (-0.772959 --> -0.835123).  Saving model ...
Epoch: 8 cost time: 5.74262547492981
Epoch: 8, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.038 Vali Acc: 0.849 Test Loss: 1.038 Test Acc: 0.849
Validation loss decreased (-0.835123 --> -0.848638).  Saving model ...
Epoch: 9 cost time: 5.743683576583862
Epoch: 9, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.892 Vali Acc: 0.876 Test Loss: 0.892 Test Acc: 0.876
Validation loss decreased (-0.848638 --> -0.875667).  Saving model ...
Epoch: 10 cost time: 5.771085500717163
Epoch: 10, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.786 Vali Acc: 0.865 Test Loss: 0.786 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.897089958190918
Epoch: 11, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.693 Vali Acc: 0.892 Test Loss: 0.693 Test Acc: 0.892
Validation loss decreased (-0.875667 --> -0.891885).  Saving model ...
Epoch: 12 cost time: 6.38625431060791
Epoch: 12, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
Validation loss decreased (-0.891885 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 6.3503687381744385
Epoch: 13, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.548 Vali Acc: 0.892 Test Loss: 0.548 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.395901441574097
Epoch: 14, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.445 Vali Acc: 0.935 Test Loss: 0.445 Test Acc: 0.935
Validation loss decreased (-0.899994 --> -0.935131).  Saving model ...
Epoch: 15 cost time: 5.628024339675903
Epoch: 15, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.403 Vali Acc: 0.932 Test Loss: 0.403 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.929535388946533
Epoch: 16, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.378 Vali Acc: 0.924 Test Loss: 0.378 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.936659574508667
Epoch: 17, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.311 Vali Acc: 0.946 Test Loss: 0.311 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945943).  Saving model ...
Epoch: 18 cost time: 5.91630220413208
Epoch: 18, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.293 Vali Acc: 0.938 Test Loss: 0.293 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.392887830734253
Epoch: 19, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.245 Vali Acc: 0.946 Test Loss: 0.245 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 20 cost time: 4.569690465927124
Epoch: 20, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.509976148605347
Epoch: 21, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
Validation loss decreased (-0.945943 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 3.919382095336914
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.803557634353638
Epoch: 23, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.019078731536865
Epoch: 24, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.670623779296875
Epoch: 25, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.348706960678101
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.586461067199707
Epoch: 27, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 5.701923847198486
Epoch: 28, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.723981618881226
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.708970785140991
Epoch: 30, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 884313
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.411142110824585
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.141 Vali Acc: 0.162 Test Loss: 2.141 Test Acc: 0.162
Validation loss decreased (inf --> -0.162141).  Saving model ...
Epoch: 2 cost time: 3.4755032062530518
Epoch: 2, Steps: 17 | Train Loss: 2.128 Vali Loss: 2.048 Vali Acc: 0.246 Test Loss: 2.048 Test Acc: 0.246
Validation loss decreased (-0.162141 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 3.387178421020508
Epoch: 3, Steps: 17 | Train Loss: 2.016 Vali Loss: 1.928 Vali Acc: 0.408 Test Loss: 1.928 Test Acc: 0.408
Validation loss decreased (-0.245925 --> -0.408089).  Saving model ...
Epoch: 4 cost time: 3.4774930477142334
Epoch: 4, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.791 Vali Acc: 0.595 Test Loss: 1.791 Test Acc: 0.595
Validation loss decreased (-0.408089 --> -0.594577).  Saving model ...
Epoch: 5 cost time: 3.415527820587158
Epoch: 5, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.630 Vali Acc: 0.741 Test Loss: 1.630 Test Acc: 0.741
Validation loss decreased (-0.594577 --> -0.740524).  Saving model ...
Epoch: 6 cost time: 3.3674156665802
Epoch: 6, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.455 Vali Acc: 0.792 Test Loss: 1.455 Test Acc: 0.792
Validation loss decreased (-0.740524 --> -0.791877).  Saving model ...
Epoch: 7 cost time: 3.368710994720459
Epoch: 7, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.273 Vali Acc: 0.819 Test Loss: 1.273 Test Acc: 0.819
Validation loss decreased (-0.791877 --> -0.818906).  Saving model ...
Epoch: 8 cost time: 3.362898111343384
Epoch: 8, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.118 Vali Acc: 0.841 Test Loss: 1.118 Test Acc: 0.841
Validation loss decreased (-0.818906 --> -0.840529).  Saving model ...
Epoch: 9 cost time: 3.349714517593384
Epoch: 9, Steps: 17 | Train Loss: 1.025 Vali Loss: 0.981 Vali Acc: 0.849 Test Loss: 0.981 Test Acc: 0.849
Validation loss decreased (-0.840529 --> -0.848639).  Saving model ...
Epoch: 10 cost time: 3.1197285652160645
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.875 Vali Acc: 0.857 Test Loss: 0.875 Test Acc: 0.857
Validation loss decreased (-0.848639 --> -0.856748).  Saving model ...
Epoch: 11 cost time: 3.571291923522949
Epoch: 11, Steps: 17 | Train Loss: 0.771 Vali Loss: 0.761 Vali Acc: 0.889 Test Loss: 0.761 Test Acc: 0.889
Validation loss decreased (-0.856748 --> -0.889182).  Saving model ...
Epoch: 12 cost time: 3.6310486793518066
Epoch: 12, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.682 Vali Acc: 0.884 Test Loss: 0.682 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3099007606506348
Epoch: 13, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.600 Vali Acc: 0.914 Test Loss: 0.600 Test Acc: 0.914
Validation loss decreased (-0.889182 --> -0.913508).  Saving model ...
Epoch: 14 cost time: 3.4424569606781006
Epoch: 14, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.520 Vali Acc: 0.927 Test Loss: 0.520 Test Acc: 0.927
Validation loss decreased (-0.913508 --> -0.927022).  Saving model ...
Epoch: 15 cost time: 3.1416730880737305
Epoch: 15, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.482 Vali Acc: 0.927 Test Loss: 0.482 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927022).  Saving model ...
Epoch: 16 cost time: 3.4404664039611816
Epoch: 16, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.409 Vali Acc: 0.941 Test Loss: 0.409 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940536).  Saving model ...
Epoch: 17 cost time: 3.3939566612243652
Epoch: 17, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 18 cost time: 3.362360954284668
Epoch: 18, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.342 Vali Acc: 0.941 Test Loss: 0.342 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 2.824453115463257
Epoch: 19, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.320 Vali Acc: 0.941 Test Loss: 0.320 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 20 cost time: 3.065929889678955
Epoch: 20, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
Validation loss decreased (-0.940537 --> -0.956754).  Saving model ...
Epoch: 21 cost time: 3.0836102962493896
Epoch: 21, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.275 Vali Acc: 0.946 Test Loss: 0.275 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2531046867370605
Epoch: 22, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0602777004241943
Epoch: 23, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 3.3184707164764404
Epoch: 24, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.238215923309326
Epoch: 25, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 3.243748188018799
Epoch: 26, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.216343402862549
Epoch: 27, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 3.6916897296905518
Epoch: 28, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 3.7285468578338623
Epoch: 29, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.68650221824646
Epoch: 30, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 263481
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.0148279666900635
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.076 Vali Acc: 0.319 Test Loss: 2.076 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 3.406449317932129
Epoch: 2, Steps: 17 | Train Loss: 2.108 Vali Loss: 1.992 Vali Acc: 0.373 Test Loss: 1.992 Test Acc: 0.373
Validation loss decreased (-0.318898 --> -0.372953).  Saving model ...
Epoch: 3 cost time: 3.4683022499084473
Epoch: 3, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.884 Vali Acc: 0.500 Test Loss: 1.884 Test Acc: 0.500
Validation loss decreased (-0.372953 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 3.4424397945404053
Epoch: 4, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.760 Vali Acc: 0.646 Test Loss: 1.760 Test Acc: 0.646
Validation loss decreased (-0.499981 --> -0.645928).  Saving model ...
Epoch: 5 cost time: 3.317150354385376
Epoch: 5, Steps: 17 | Train Loss: 1.678 Vali Loss: 1.621 Vali Acc: 0.705 Test Loss: 1.621 Test Acc: 0.705
Validation loss decreased (-0.645928 --> -0.705389).  Saving model ...
Epoch: 6 cost time: 3.179591178894043
Epoch: 6, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.467 Vali Acc: 0.754 Test Loss: 1.467 Test Acc: 0.754
Validation loss decreased (-0.705389 --> -0.754039).  Saving model ...
Epoch: 7 cost time: 3.219649076461792
Epoch: 7, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.299 Vali Acc: 0.811 Test Loss: 1.299 Test Acc: 0.811
Validation loss decreased (-0.754039 --> -0.810798).  Saving model ...
Epoch: 8 cost time: 3.18355393409729
Epoch: 8, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.146 Vali Acc: 0.841 Test Loss: 1.146 Test Acc: 0.841
Validation loss decreased (-0.810798 --> -0.840529).  Saving model ...
Epoch: 9 cost time: 3.146465301513672
Epoch: 9, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.014 Vali Acc: 0.854 Test Loss: 1.014 Test Acc: 0.854
Validation loss decreased (-0.840529 --> -0.854044).  Saving model ...
Epoch: 10 cost time: 2.8634603023529053
Epoch: 10, Steps: 17 | Train Loss: 0.859 Vali Loss: 0.908 Vali Acc: 0.854 Test Loss: 0.908 Test Acc: 0.854
Validation loss decreased (-0.854044 --> -0.854045).  Saving model ...
Epoch: 11 cost time: 3.093803644180298
Epoch: 11, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.796 Vali Acc: 0.878 Test Loss: 0.796 Test Acc: 0.878
Validation loss decreased (-0.854045 --> -0.878370).  Saving model ...
Epoch: 12 cost time: 2.9716176986694336
Epoch: 12, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.705 Vali Acc: 0.895 Test Loss: 0.705 Test Acc: 0.895
Validation loss decreased (-0.878370 --> -0.894588).  Saving model ...
Epoch: 13 cost time: 3.0913307666778564
Epoch: 13, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.641 Vali Acc: 0.892 Test Loss: 0.641 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.054168701171875
Epoch: 14, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.543 Vali Acc: 0.932 Test Loss: 0.543 Test Acc: 0.932
Validation loss decreased (-0.894588 --> -0.932427).  Saving model ...
Epoch: 15 cost time: 3.8164639472961426
Epoch: 15, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.499 Vali Acc: 0.922 Test Loss: 0.499 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6071255207061768
Epoch: 16, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.432 Vali Acc: 0.924 Test Loss: 0.432 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.630310297012329
Epoch: 17, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.383 Vali Acc: 0.935 Test Loss: 0.383 Test Acc: 0.935
Validation loss decreased (-0.932427 --> -0.935131).  Saving model ...
Epoch: 18 cost time: 3.656028985977173
Epoch: 18, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6304519176483154
Epoch: 19, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.308 Vali Acc: 0.938 Test Loss: 0.308 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 20 cost time: 3.629352331161499
Epoch: 20, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.503141403198242
Epoch: 21, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 22 cost time: 3.6324777603149414
Epoch: 22, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 3.6265358924865723
Epoch: 23, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.671826124191284
Epoch: 24, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951350).  Saving model ...
Epoch: 25 cost time: 3.174504280090332
Epoch: 25, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2599422931671143
Epoch: 26, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 3.501734972000122
Epoch: 27, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.459221363067627
Epoch: 28, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.414214611053467
Epoch: 29, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.148 Vali Acc: 0.946 Test Loss: 0.148 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.3763201236724854
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 884313
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.063273191452026
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.142 Vali Acc: 0.159 Test Loss: 2.142 Test Acc: 0.159
Validation loss decreased (inf --> -0.159438).  Saving model ...
Epoch: 2 cost time: 2.5278642177581787
Epoch: 2, Steps: 17 | Train Loss: 2.129 Vali Loss: 2.051 Vali Acc: 0.243 Test Loss: 2.051 Test Acc: 0.243
Validation loss decreased (-0.159438 --> -0.243223).  Saving model ...
Epoch: 3 cost time: 2.5299532413482666
Epoch: 3, Steps: 17 | Train Loss: 2.020 Vali Loss: 1.933 Vali Acc: 0.400 Test Loss: 1.933 Test Acc: 0.400
Validation loss decreased (-0.243223 --> -0.399981).  Saving model ...
Epoch: 4 cost time: 2.7110402584075928
Epoch: 4, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.800 Vali Acc: 0.573 Test Loss: 1.800 Test Acc: 0.573
Validation loss decreased (-0.399981 --> -0.572955).  Saving model ...
Epoch: 5 cost time: 2.732760429382324
Epoch: 5, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.646 Vali Acc: 0.719 Test Loss: 1.646 Test Acc: 0.719
Validation loss decreased (-0.572955 --> -0.718902).  Saving model ...
Epoch: 6 cost time: 2.7283613681793213
Epoch: 6, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.486 Vali Acc: 0.784 Test Loss: 1.486 Test Acc: 0.784
Validation loss decreased (-0.718902 --> -0.783769).  Saving model ...
Epoch: 7 cost time: 2.7150113582611084
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.322 Vali Acc: 0.819 Test Loss: 1.322 Test Acc: 0.819
Validation loss decreased (-0.783769 --> -0.818906).  Saving model ...
Epoch: 8 cost time: 2.738264799118042
Epoch: 8, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.180 Vali Acc: 0.832 Test Loss: 1.180 Test Acc: 0.832
Validation loss decreased (-0.818906 --> -0.832421).  Saving model ...
Epoch: 9 cost time: 2.747370719909668
Epoch: 9, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.056 Vali Acc: 0.841 Test Loss: 1.056 Test Acc: 0.841
Validation loss decreased (-0.832421 --> -0.840530).  Saving model ...
Epoch: 10 cost time: 2.698983669281006
Epoch: 10, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.949 Vali Acc: 0.859 Test Loss: 0.949 Test Acc: 0.859
Validation loss decreased (-0.840530 --> -0.859450).  Saving model ...
Epoch: 11 cost time: 2.707552433013916
Epoch: 11, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.844 Vali Acc: 0.873 Test Loss: 0.844 Test Acc: 0.873
Validation loss decreased (-0.859450 --> -0.872965).  Saving model ...
Epoch: 12 cost time: 2.680182695388794
Epoch: 12, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.757 Vali Acc: 0.878 Test Loss: 0.757 Test Acc: 0.878
Validation loss decreased (-0.872965 --> -0.878371).  Saving model ...
Epoch: 13 cost time: 2.6648340225219727
Epoch: 13, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.678 Vali Acc: 0.903 Test Loss: 0.678 Test Acc: 0.903
Validation loss decreased (-0.878371 --> -0.902696).  Saving model ...
Epoch: 14 cost time: 2.638042449951172
Epoch: 14, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.602 Vali Acc: 0.905 Test Loss: 0.602 Test Acc: 0.905
Validation loss decreased (-0.902696 --> -0.905399).  Saving model ...
Epoch: 15 cost time: 2.7255451679229736
Epoch: 15, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.546 Vali Acc: 0.924 Test Loss: 0.546 Test Acc: 0.924
Validation loss decreased (-0.905399 --> -0.924319).  Saving model ...
Epoch: 16 cost time: 2.463683605194092
Epoch: 16, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.477 Vali Acc: 0.938 Test Loss: 0.477 Test Acc: 0.938
Validation loss decreased (-0.924319 --> -0.937833).  Saving model ...
Epoch: 17 cost time: 2.477635383605957
Epoch: 17, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.439 Vali Acc: 0.938 Test Loss: 0.439 Test Acc: 0.938
Validation loss decreased (-0.937833 --> -0.937833).  Saving model ...
Epoch: 18 cost time: 2.4579386711120605
Epoch: 18, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.386 Vali Acc: 0.941 Test Loss: 0.386 Test Acc: 0.941
Validation loss decreased (-0.937833 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 2.482795476913452
Epoch: 19, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.365 Vali Acc: 0.930 Test Loss: 0.365 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.465749740600586
Epoch: 20, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 21 cost time: 2.3049159049987793
Epoch: 21, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 22 cost time: 2.521744966506958
Epoch: 22, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.300 Vali Acc: 0.932 Test Loss: 0.300 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4734456539154053
Epoch: 23, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.240 Vali Acc: 0.951 Test Loss: 0.240 Test Acc: 0.951
Validation loss decreased (-0.940537 --> -0.951349).  Saving model ...
Epoch: 24 cost time: 2.490734815597534
Epoch: 24, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5473153591156006
Epoch: 25, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 2.2980310916900635
Epoch: 26, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.55942702293396
Epoch: 27, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.5480713844299316
Epoch: 28, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.560487985610962
Epoch: 29, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.5311169624328613
Epoch: 30, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 263481
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.687166452407837
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.138 Vali Acc: 0.154 Test Loss: 2.138 Test Acc: 0.154
Validation loss decreased (inf --> -0.154033).  Saving model ...
Epoch: 2 cost time: 8.030776739120483
Epoch: 2, Steps: 17 | Train Loss: 2.095 Vali Loss: 2.054 Vali Acc: 0.257 Test Loss: 2.054 Test Acc: 0.257
Validation loss decreased (-0.154033 --> -0.256736).  Saving model ...
Epoch: 3 cost time: 8.035263061523438
Epoch: 3, Steps: 17 | Train Loss: 1.984 Vali Loss: 1.942 Vali Acc: 0.424 Test Loss: 1.942 Test Acc: 0.424
Validation loss decreased (-0.256736 --> -0.424305).  Saving model ...
Epoch: 4 cost time: 7.690898180007935
Epoch: 4, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.803 Vali Acc: 0.554 Test Loss: 1.803 Test Acc: 0.554
Validation loss decreased (-0.424305 --> -0.554036).  Saving model ...
Epoch: 5 cost time: 7.684440851211548
Epoch: 5, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.638 Vali Acc: 0.716 Test Loss: 1.638 Test Acc: 0.716
Validation loss decreased (-0.554036 --> -0.716200).  Saving model ...
Epoch: 6 cost time: 7.5330119132995605
Epoch: 6, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.459 Vali Acc: 0.759 Test Loss: 1.459 Test Acc: 0.759
Validation loss decreased (-0.716200 --> -0.759445).  Saving model ...
Epoch: 7 cost time: 7.694528579711914
Epoch: 7, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.293 Vali Acc: 0.784 Test Loss: 1.293 Test Acc: 0.784
Validation loss decreased (-0.759445 --> -0.783771).  Saving model ...
Epoch: 8 cost time: 7.734025716781616
Epoch: 8, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.124 Vali Acc: 0.824 Test Loss: 1.124 Test Acc: 0.824
Validation loss decreased (-0.783771 --> -0.824313).  Saving model ...
Epoch: 9 cost time: 7.9315407276153564
Epoch: 9, Steps: 17 | Train Loss: 1.008 Vali Loss: 0.985 Vali Acc: 0.846 Test Loss: 0.985 Test Acc: 0.846
Validation loss decreased (-0.824313 --> -0.845936).  Saving model ...
Epoch: 10 cost time: 8.421069622039795
Epoch: 10, Steps: 17 | Train Loss: 0.853 Vali Loss: 0.858 Vali Acc: 0.854 Test Loss: 0.858 Test Acc: 0.854
Validation loss decreased (-0.845936 --> -0.854045).  Saving model ...
Epoch: 11 cost time: 8.422284364700317
Epoch: 11, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.736 Vali Acc: 0.862 Test Loss: 0.736 Test Acc: 0.862
Validation loss decreased (-0.854045 --> -0.862155).  Saving model ...
Epoch: 12 cost time: 8.452865839004517
Epoch: 12, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.638 Vali Acc: 0.881 Test Loss: 0.638 Test Acc: 0.881
Validation loss decreased (-0.862155 --> -0.881075).  Saving model ...
Epoch: 13 cost time: 8.437112092971802
Epoch: 13, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
Validation loss decreased (-0.881075 --> -0.889184).  Saving model ...
Epoch: 14 cost time: 8.398491382598877
Epoch: 14, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.481 Vali Acc: 0.908 Test Loss: 0.481 Test Acc: 0.908
Validation loss decreased (-0.889184 --> -0.908103).  Saving model ...
Epoch: 15 cost time: 7.722436189651489
Epoch: 15, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.393 Vali Acc: 0.927 Test Loss: 0.393 Test Acc: 0.927
Validation loss decreased (-0.908103 --> -0.927023).  Saving model ...
Epoch: 16 cost time: 7.716197490692139
Epoch: 16, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.339 Vali Acc: 0.938 Test Loss: 0.339 Test Acc: 0.938
Validation loss decreased (-0.927023 --> -0.937834).  Saving model ...
Epoch: 17 cost time: 6.590709209442139
Epoch: 17, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.741489887237549
Epoch: 18, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 19 cost time: 6.276379585266113
Epoch: 19, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.237 Vali Acc: 0.949 Test Loss: 0.237 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 20 cost time: 5.930547714233398
Epoch: 20, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 21 cost time: 6.894883394241333
Epoch: 21, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 6.9538962841033936
Epoch: 22, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 6.924196720123291
Epoch: 23, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.9630773067474365
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.408397197723389
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.744744777679443
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 6.651718854904175
Epoch: 27, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.657757520675659
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.694215536117554
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.623013019561768
Epoch: 30, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.949 Test Loss: 0.149 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 444729
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.158308744430542
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.175 Vali Acc: 0.195 Test Loss: 2.175 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 4.640057563781738
Epoch: 2, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.098 Vali Acc: 0.246 Test Loss: 2.098 Test Acc: 0.246
Validation loss decreased (-0.194573 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 4.611965894699097
Epoch: 3, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.997 Vali Acc: 0.332 Test Loss: 1.997 Test Acc: 0.332
Validation loss decreased (-0.245925 --> -0.332412).  Saving model ...
Epoch: 4 cost time: 4.667801856994629
Epoch: 4, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.877 Vali Acc: 0.430 Test Loss: 1.877 Test Acc: 0.430
Validation loss decreased (-0.332412 --> -0.429711).  Saving model ...
Epoch: 5 cost time: 4.689078092575073
Epoch: 5, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.752 Vali Acc: 0.541 Test Loss: 1.752 Test Acc: 0.541
Validation loss decreased (-0.429711 --> -0.540523).  Saving model ...
Epoch: 6 cost time: 4.6489245891571045
Epoch: 6, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.612 Vali Acc: 0.643 Test Loss: 1.612 Test Acc: 0.643
Validation loss decreased (-0.540523 --> -0.643227).  Saving model ...
Epoch: 7 cost time: 4.6723473072052
Epoch: 7, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.463 Vali Acc: 0.762 Test Loss: 1.463 Test Acc: 0.762
Validation loss decreased (-0.643227 --> -0.762148).  Saving model ...
Epoch: 8 cost time: 4.25521183013916
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.312 Vali Acc: 0.795 Test Loss: 1.312 Test Acc: 0.795
Validation loss decreased (-0.762148 --> -0.794581).  Saving model ...
Epoch: 9 cost time: 4.268987417221069
Epoch: 9, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.165 Vali Acc: 0.830 Test Loss: 1.165 Test Acc: 0.830
Validation loss decreased (-0.794581 --> -0.829718).  Saving model ...
Epoch: 10 cost time: 4.217122316360474
Epoch: 10, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.026 Vali Acc: 0.851 Test Loss: 1.026 Test Acc: 0.851
Validation loss decreased (-0.829718 --> -0.851341).  Saving model ...
Epoch: 11 cost time: 3.984840154647827
Epoch: 11, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.890 Vali Acc: 0.865 Test Loss: 0.890 Test Acc: 0.865
Validation loss decreased (-0.851341 --> -0.864856).  Saving model ...
Epoch: 12 cost time: 3.9200549125671387
Epoch: 12, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.775 Vali Acc: 0.892 Test Loss: 0.775 Test Acc: 0.892
Validation loss decreased (-0.864856 --> -0.891884).  Saving model ...
Epoch: 13 cost time: 3.9524595737457275
Epoch: 13, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.677 Vali Acc: 0.903 Test Loss: 0.677 Test Acc: 0.903
Validation loss decreased (-0.891884 --> -0.902696).  Saving model ...
Epoch: 14 cost time: 3.9447271823883057
Epoch: 14, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.597 Vali Acc: 0.914 Test Loss: 0.597 Test Acc: 0.914
Validation loss decreased (-0.902696 --> -0.913508).  Saving model ...
Epoch: 15 cost time: 3.9856767654418945
Epoch: 15, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.542 Vali Acc: 0.914 Test Loss: 0.542 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913508).  Saving model ...
Epoch: 16 cost time: 3.7936997413635254
Epoch: 16, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.467 Vali Acc: 0.922 Test Loss: 0.467 Test Acc: 0.922
Validation loss decreased (-0.913508 --> -0.921617).  Saving model ...
Epoch: 17 cost time: 3.965468645095825
Epoch: 17, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.442 Vali Acc: 0.914 Test Loss: 0.442 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.552060842514038
Epoch: 18, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.402 Vali Acc: 0.922 Test Loss: 0.402 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921618).  Saving model ...
Epoch: 19 cost time: 2.9662930965423584
Epoch: 19, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
Validation loss decreased (-0.921618 --> -0.929726).  Saving model ...
Epoch: 20 cost time: 4.8402791023254395
Epoch: 20, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.820677757263184
Epoch: 21, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.315 Vali Acc: 0.924 Test Loss: 0.315 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.83803915977478
Epoch: 22, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 4.836447715759277
Epoch: 23, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.276 Vali Acc: 0.935 Test Loss: 0.276 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.8605475425720215
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.8505778312683105
Epoch: 25, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 4.82847785949707
Epoch: 26, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.905505657196045
Epoch: 27, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 28 cost time: 4.888075351715088
Epoch: 28, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 4.815952777862549
Epoch: 29, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.49437403678894
Epoch: 30, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 134265
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.461640357971191
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.138 Vali Acc: 0.154 Test Loss: 2.138 Test Acc: 0.154
Validation loss decreased (inf --> -0.154033).  Saving model ...
Epoch: 2 cost time: 5.9153759479522705
Epoch: 2, Steps: 17 | Train Loss: 2.096 Vali Loss: 2.054 Vali Acc: 0.257 Test Loss: 2.054 Test Acc: 0.257
Validation loss decreased (-0.154033 --> -0.256736).  Saving model ...
Epoch: 3 cost time: 5.956548690795898
Epoch: 3, Steps: 17 | Train Loss: 1.984 Vali Loss: 1.942 Vali Acc: 0.424 Test Loss: 1.942 Test Acc: 0.424
Validation loss decreased (-0.256736 --> -0.424305).  Saving model ...
Epoch: 4 cost time: 5.930962800979614
Epoch: 4, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.803 Vali Acc: 0.554 Test Loss: 1.803 Test Acc: 0.554
Validation loss decreased (-0.424305 --> -0.554036).  Saving model ...
Epoch: 5 cost time: 5.954363584518433
Epoch: 5, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.638 Vali Acc: 0.714 Test Loss: 1.638 Test Acc: 0.714
Validation loss decreased (-0.554036 --> -0.713497).  Saving model ...
Epoch: 6 cost time: 5.92819619178772
Epoch: 6, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.460 Vali Acc: 0.759 Test Loss: 1.460 Test Acc: 0.759
Validation loss decreased (-0.713497 --> -0.759445).  Saving model ...
Epoch: 7 cost time: 5.589945316314697
Epoch: 7, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.294 Vali Acc: 0.786 Test Loss: 1.294 Test Acc: 0.786
Validation loss decreased (-0.759445 --> -0.786474).  Saving model ...
Epoch: 8 cost time: 5.664267063140869
Epoch: 8, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.125 Vali Acc: 0.830 Test Loss: 1.125 Test Acc: 0.830
Validation loss decreased (-0.786474 --> -0.829718).  Saving model ...
Epoch: 9 cost time: 5.468058824539185
Epoch: 9, Steps: 17 | Train Loss: 1.008 Vali Loss: 0.986 Vali Acc: 0.846 Test Loss: 0.986 Test Acc: 0.846
Validation loss decreased (-0.829718 --> -0.845936).  Saving model ...
Epoch: 10 cost time: 6.078929901123047
Epoch: 10, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.859 Vali Acc: 0.857 Test Loss: 0.859 Test Acc: 0.857
Validation loss decreased (-0.845936 --> -0.856748).  Saving model ...
Epoch: 11 cost time: 6.052441835403442
Epoch: 11, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.737 Vali Acc: 0.859 Test Loss: 0.737 Test Acc: 0.859
Validation loss decreased (-0.856748 --> -0.859452).  Saving model ...
Epoch: 12 cost time: 5.959026575088501
Epoch: 12, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.640 Vali Acc: 0.881 Test Loss: 0.640 Test Acc: 0.881
Validation loss decreased (-0.859452 --> -0.881075).  Saving model ...
Epoch: 13 cost time: 6.009760141372681
Epoch: 13, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.553 Vali Acc: 0.892 Test Loss: 0.553 Test Acc: 0.892
Validation loss decreased (-0.881075 --> -0.891886).  Saving model ...
Epoch: 14 cost time: 5.992141008377075
Epoch: 14, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.484 Vali Acc: 0.908 Test Loss: 0.484 Test Acc: 0.908
Validation loss decreased (-0.891886 --> -0.908103).  Saving model ...
Epoch: 15 cost time: 6.337538242340088
Epoch: 15, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.394 Vali Acc: 0.927 Test Loss: 0.394 Test Acc: 0.927
Validation loss decreased (-0.908103 --> -0.927023).  Saving model ...
Epoch: 16 cost time: 6.247235298156738
Epoch: 16, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.339 Vali Acc: 0.932 Test Loss: 0.339 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 17 cost time: 6.257734060287476
Epoch: 17, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 18 cost time: 6.2970664501190186
Epoch: 18, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 19 cost time: 6.306803464889526
Epoch: 19, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 20 cost time: 6.302397966384888
Epoch: 20, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 6.078317880630493
Epoch: 21, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 5.984273910522461
Epoch: 22, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 5.972626686096191
Epoch: 23, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.916290044784546
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.9750566482543945
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.767625331878662
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.970026016235352
Epoch: 27, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.054060220718384
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.96254301071167
Epoch: 29, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.948390245437622
Epoch: 30, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 444729
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.5310587882995605
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.175 Vali Acc: 0.195 Test Loss: 2.175 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 4.091374635696411
Epoch: 2, Steps: 17 | Train Loss: 2.108 Vali Loss: 2.098 Vali Acc: 0.246 Test Loss: 2.098 Test Acc: 0.246
Validation loss decreased (-0.194573 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 4.098330736160278
Epoch: 3, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.997 Vali Acc: 0.332 Test Loss: 1.997 Test Acc: 0.332
Validation loss decreased (-0.245925 --> -0.332412).  Saving model ...
Epoch: 4 cost time: 4.120067834854126
Epoch: 4, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.877 Vali Acc: 0.430 Test Loss: 1.877 Test Acc: 0.430
Validation loss decreased (-0.332412 --> -0.429711).  Saving model ...
Epoch: 5 cost time: 3.8899664878845215
Epoch: 5, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.753 Vali Acc: 0.541 Test Loss: 1.753 Test Acc: 0.541
Validation loss decreased (-0.429711 --> -0.540523).  Saving model ...
Epoch: 6 cost time: 3.898683786392212
Epoch: 6, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.613 Vali Acc: 0.641 Test Loss: 1.613 Test Acc: 0.641
Validation loss decreased (-0.540523 --> -0.640524).  Saving model ...
Epoch: 7 cost time: 3.862635850906372
Epoch: 7, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.463 Vali Acc: 0.759 Test Loss: 1.463 Test Acc: 0.759
Validation loss decreased (-0.640524 --> -0.759445).  Saving model ...
Epoch: 8 cost time: 3.8906567096710205
Epoch: 8, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.313 Vali Acc: 0.792 Test Loss: 1.313 Test Acc: 0.792
Validation loss decreased (-0.759445 --> -0.791879).  Saving model ...
Epoch: 9 cost time: 3.731138229370117
Epoch: 9, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.166 Vali Acc: 0.827 Test Loss: 1.166 Test Acc: 0.827
Validation loss decreased (-0.791879 --> -0.827015).  Saving model ...
Epoch: 10 cost time: 3.9306538105010986
Epoch: 10, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.028 Vali Acc: 0.846 Test Loss: 1.028 Test Acc: 0.846
Validation loss decreased (-0.827015 --> -0.845936).  Saving model ...
Epoch: 11 cost time: 3.8984227180480957
Epoch: 11, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.891 Vali Acc: 0.865 Test Loss: 0.891 Test Acc: 0.865
Validation loss decreased (-0.845936 --> -0.864856).  Saving model ...
Epoch: 12 cost time: 3.9891626834869385
Epoch: 12, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.776 Vali Acc: 0.884 Test Loss: 0.776 Test Acc: 0.884
Validation loss decreased (-0.864856 --> -0.883776).  Saving model ...
Epoch: 13 cost time: 3.8943064212799072
Epoch: 13, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.678 Vali Acc: 0.903 Test Loss: 0.678 Test Acc: 0.903
Validation loss decreased (-0.883776 --> -0.902696).  Saving model ...
Epoch: 14 cost time: 4.097436428070068
Epoch: 14, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.599 Vali Acc: 0.914 Test Loss: 0.599 Test Acc: 0.914
Validation loss decreased (-0.902696 --> -0.913508).  Saving model ...
Epoch: 15 cost time: 3.8961427211761475
Epoch: 15, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.544 Vali Acc: 0.916 Test Loss: 0.544 Test Acc: 0.916
Validation loss decreased (-0.913508 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 3.8369343280792236
Epoch: 16, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.471 Vali Acc: 0.919 Test Loss: 0.471 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918914).  Saving model ...
Epoch: 17 cost time: 3.8399417400360107
Epoch: 17, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8330588340759277
Epoch: 18, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.406 Vali Acc: 0.919 Test Loss: 0.406 Test Acc: 0.919
Validation loss decreased (-0.918914 --> -0.918915).  Saving model ...
Epoch: 19 cost time: 3.8623757362365723
Epoch: 19, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.918915 --> -0.929726).  Saving model ...
Epoch: 20 cost time: 3.913703441619873
Epoch: 20, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.357 Vali Acc: 0.924 Test Loss: 0.357 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8569138050079346
Epoch: 21, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.321 Vali Acc: 0.922 Test Loss: 0.321 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.8536946773529053
Epoch: 22, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.294 Vali Acc: 0.938 Test Loss: 0.294 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 3.850794792175293
Epoch: 23, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.281 Vali Acc: 0.938 Test Loss: 0.281 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 24 cost time: 3.8358325958251953
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.285 Vali Acc: 0.924 Test Loss: 0.285 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.893852472305298
Epoch: 25, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 3.3368451595306396
Epoch: 26, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.7306604385375977
Epoch: 27, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.779628038406372
Epoch: 28, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.707365036010742
Epoch: 29, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.667431116104126
Epoch: 30, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 134265
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.889179229736328
Epoch: 1, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.139 Vali Acc: 0.151 Test Loss: 2.139 Test Acc: 0.151
Validation loss decreased (inf --> -0.151330).  Saving model ...
Epoch: 2 cost time: 3.398036003112793
Epoch: 2, Steps: 17 | Train Loss: 2.097 Vali Loss: 2.057 Vali Acc: 0.254 Test Loss: 2.057 Test Acc: 0.254
Validation loss decreased (-0.151330 --> -0.254033).  Saving model ...
Epoch: 3 cost time: 3.3696911334991455
Epoch: 3, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.950 Vali Acc: 0.422 Test Loss: 1.950 Test Acc: 0.422
Validation loss decreased (-0.254033 --> -0.421602).  Saving model ...
Epoch: 4 cost time: 3.3986194133758545
Epoch: 4, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.822 Vali Acc: 0.551 Test Loss: 1.822 Test Acc: 0.551
Validation loss decreased (-0.421602 --> -0.551333).  Saving model ...
Epoch: 5 cost time: 3.3674585819244385
Epoch: 5, Steps: 17 | Train Loss: 1.736 Vali Loss: 1.676 Vali Acc: 0.705 Test Loss: 1.676 Test Acc: 0.705
Validation loss decreased (-0.551333 --> -0.705389).  Saving model ...
Epoch: 6 cost time: 3.3685243129730225
Epoch: 6, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.517 Vali Acc: 0.762 Test Loss: 1.517 Test Acc: 0.762
Validation loss decreased (-0.705389 --> -0.762147).  Saving model ...
Epoch: 7 cost time: 3.413616418838501
Epoch: 7, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.357 Vali Acc: 0.765 Test Loss: 1.357 Test Acc: 0.765
Validation loss decreased (-0.762147 --> -0.764851).  Saving model ...
Epoch: 8 cost time: 3.3696820735931396
Epoch: 8, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.204 Vali Acc: 0.776 Test Loss: 1.204 Test Acc: 0.776
Validation loss decreased (-0.764851 --> -0.775664).  Saving model ...
Epoch: 9 cost time: 3.2470388412475586
Epoch: 9, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.067 Vali Acc: 0.811 Test Loss: 1.067 Test Acc: 0.811
Validation loss decreased (-0.775664 --> -0.810800).  Saving model ...
Epoch: 10 cost time: 3.201481342315674
Epoch: 10, Steps: 17 | Train Loss: 0.947 Vali Loss: 0.934 Vali Acc: 0.846 Test Loss: 0.934 Test Acc: 0.846
Validation loss decreased (-0.810800 --> -0.845937).  Saving model ...
Epoch: 11 cost time: 3.0427098274230957
Epoch: 11, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.818 Vali Acc: 0.859 Test Loss: 0.818 Test Acc: 0.859
Validation loss decreased (-0.845937 --> -0.859451).  Saving model ...
Epoch: 12 cost time: 3.017667770385742
Epoch: 12, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.716 Vali Acc: 0.886 Test Loss: 0.716 Test Acc: 0.886
Validation loss decreased (-0.859451 --> -0.886479).  Saving model ...
Epoch: 13 cost time: 2.7735886573791504
Epoch: 13, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
Validation loss decreased (-0.886479 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 2.9595634937286377
Epoch: 14, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9969422817230225
Epoch: 15, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.476 Vali Acc: 0.911 Test Loss: 0.476 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.910806).  Saving model ...
Epoch: 16 cost time: 2.960841655731201
Epoch: 16, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.412 Vali Acc: 0.922 Test Loss: 0.412 Test Acc: 0.922
Validation loss decreased (-0.910806 --> -0.921617).  Saving model ...
Epoch: 17 cost time: 2.902148723602295
Epoch: 17, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921618).  Saving model ...
Epoch: 18 cost time: 2.8239455223083496
Epoch: 18, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.327 Vali Acc: 0.927 Test Loss: 0.327 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 19 cost time: 3.1814634799957275
Epoch: 19, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.318 Vali Acc: 0.927 Test Loss: 0.318 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 20 cost time: 3.177957773208618
Epoch: 20, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.269 Vali Acc: 0.938 Test Loss: 0.269 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 21 cost time: 3.1002018451690674
Epoch: 21, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 22 cost time: 3.1714401245117188
Epoch: 22, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1970739364624023
Epoch: 23, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 24 cost time: 3.388239860534668
Epoch: 24, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.198 Vali Acc: 0.954 Test Loss: 0.198 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 3.3813722133636475
Epoch: 25, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 3.3754024505615234
Epoch: 26, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 27 cost time: 3.3364434242248535
Epoch: 27, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 28 cost time: 3.3798015117645264
Epoch: 28, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 3.440504312515259
Epoch: 29, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 3.4093704223632812
Epoch: 30, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 444729
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.912205457687378
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.174 Vali Acc: 0.195 Test Loss: 2.174 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 2.3994851112365723
Epoch: 2, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.098 Vali Acc: 0.246 Test Loss: 2.098 Test Acc: 0.246
Validation loss decreased (-0.194573 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 2.3995916843414307
Epoch: 3, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.999 Vali Acc: 0.324 Test Loss: 1.999 Test Acc: 0.324
Validation loss decreased (-0.245925 --> -0.324304).  Saving model ...
Epoch: 4 cost time: 2.4010207653045654
Epoch: 4, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.881 Vali Acc: 0.430 Test Loss: 1.881 Test Acc: 0.430
Validation loss decreased (-0.324304 --> -0.429711).  Saving model ...
Epoch: 5 cost time: 2.4148120880126953
Epoch: 5, Steps: 17 | Train Loss: 1.761 Vali Loss: 1.760 Vali Acc: 0.543 Test Loss: 1.760 Test Acc: 0.543
Validation loss decreased (-0.429711 --> -0.543226).  Saving model ...
Epoch: 6 cost time: 2.42679500579834
Epoch: 6, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.624 Vali Acc: 0.632 Test Loss: 1.624 Test Acc: 0.632
Validation loss decreased (-0.543226 --> -0.632416).  Saving model ...
Epoch: 7 cost time: 2.4523704051971436
Epoch: 7, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.483 Vali Acc: 0.751 Test Loss: 1.483 Test Acc: 0.751
Validation loss decreased (-0.632416 --> -0.751337).  Saving model ...
Epoch: 8 cost time: 2.4418652057647705
Epoch: 8, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.343 Vali Acc: 0.776 Test Loss: 1.343 Test Acc: 0.776
Validation loss decreased (-0.751337 --> -0.775662).  Saving model ...
Epoch: 9 cost time: 2.4559078216552734
Epoch: 9, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.202 Vali Acc: 0.827 Test Loss: 1.202 Test Acc: 0.827
Validation loss decreased (-0.775662 --> -0.827015).  Saving model ...
Epoch: 10 cost time: 2.1065258979797363
Epoch: 10, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.070 Vali Acc: 0.832 Test Loss: 1.070 Test Acc: 0.832
Validation loss decreased (-0.827015 --> -0.832422).  Saving model ...
Epoch: 11 cost time: 2.315546751022339
Epoch: 11, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.941 Vali Acc: 0.862 Test Loss: 0.941 Test Acc: 0.862
Validation loss decreased (-0.832422 --> -0.862153).  Saving model ...
Epoch: 12 cost time: 2.326923370361328
Epoch: 12, Steps: 17 | Train Loss: 0.786 Vali Loss: 0.830 Vali Acc: 0.870 Test Loss: 0.830 Test Acc: 0.870
Validation loss decreased (-0.862153 --> -0.870262).  Saving model ...
Epoch: 13 cost time: 2.3298003673553467
Epoch: 13, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.738 Vali Acc: 0.881 Test Loss: 0.738 Test Acc: 0.881
Validation loss decreased (-0.870262 --> -0.881074).  Saving model ...
Epoch: 14 cost time: 2.3061203956604004
Epoch: 14, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.650 Vali Acc: 0.905 Test Loss: 0.650 Test Acc: 0.905
Validation loss decreased (-0.881074 --> -0.905399).  Saving model ...
Epoch: 15 cost time: 2.3167316913604736
Epoch: 15, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.597 Vali Acc: 0.908 Test Loss: 0.597 Test Acc: 0.908
Validation loss decreased (-0.905399 --> -0.908102).  Saving model ...
Epoch: 16 cost time: 2.326354742050171
Epoch: 16, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.517 Vali Acc: 0.916 Test Loss: 0.517 Test Acc: 0.916
Validation loss decreased (-0.908102 --> -0.916211).  Saving model ...
Epoch: 17 cost time: 2.226001024246216
Epoch: 17, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.483 Vali Acc: 0.916 Test Loss: 0.483 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916211).  Saving model ...
Epoch: 18 cost time: 2.2342262268066406
Epoch: 18, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918915).  Saving model ...
Epoch: 19 cost time: 2.161482572555542
Epoch: 19, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.392 Vali Acc: 0.930 Test Loss: 0.392 Test Acc: 0.930
Validation loss decreased (-0.918915 --> -0.929726).  Saving model ...
Epoch: 20 cost time: 2.1384775638580322
Epoch: 20, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.372 Vali Acc: 0.927 Test Loss: 0.372 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2085816860198975
Epoch: 21, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.334 Vali Acc: 0.935 Test Loss: 0.334 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 22 cost time: 2.039052963256836
Epoch: 22, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1432876586914062
Epoch: 23, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 24 cost time: 2.2127339839935303
Epoch: 24, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.368743419647217
Epoch: 25, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2618720531463623
Epoch: 26, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.393775701522827
Epoch: 27, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.432319164276123
Epoch: 28, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.4469308853149414
Epoch: 29, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 30 cost time: 2.430985927581787
Epoch: 30, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 134265
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.313838720321655
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.200 Vali Acc: 0.073 Test Loss: 2.200 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 3.647279739379883
Epoch: 2, Steps: 17 | Train Loss: 2.155 Vali Loss: 2.120 Vali Acc: 0.130 Test Loss: 2.120 Test Acc: 0.130
Validation loss decreased (-0.072951 --> -0.129709).  Saving model ...
Epoch: 3 cost time: 3.7338943481445312
Epoch: 3, Steps: 17 | Train Loss: 2.079 Vali Loss: 2.013 Vali Acc: 0.246 Test Loss: 2.013 Test Acc: 0.246
Validation loss decreased (-0.129709 --> -0.245926).  Saving model ...
Epoch: 4 cost time: 3.6544430255889893
Epoch: 4, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.899 Vali Acc: 0.378 Test Loss: 1.899 Test Acc: 0.378
Validation loss decreased (-0.245926 --> -0.378359).  Saving model ...
Epoch: 5 cost time: 3.649273633956909
Epoch: 5, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.785 Vali Acc: 0.495 Test Loss: 1.785 Test Acc: 0.495
Validation loss decreased (-0.378359 --> -0.494577).  Saving model ...
Epoch: 6 cost time: 3.6949427127838135
Epoch: 6, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.682 Vali Acc: 0.581 Test Loss: 1.682 Test Acc: 0.581
Validation loss decreased (-0.494577 --> -0.581064).  Saving model ...
Epoch: 7 cost time: 3.7099668979644775
Epoch: 7, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.579 Vali Acc: 0.662 Test Loss: 1.579 Test Acc: 0.662
Validation loss decreased (-0.581064 --> -0.662146).  Saving model ...
Epoch: 8 cost time: 3.6773438453674316
Epoch: 8, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.473 Vali Acc: 0.697 Test Loss: 1.473 Test Acc: 0.697
Validation loss decreased (-0.662146 --> -0.697283).  Saving model ...
Epoch: 9 cost time: 3.613581418991089
Epoch: 9, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.360 Vali Acc: 0.703 Test Loss: 1.360 Test Acc: 0.703
Validation loss decreased (-0.697283 --> -0.702689).  Saving model ...
Epoch: 10 cost time: 3.5958640575408936
Epoch: 10, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.261 Vali Acc: 0.711 Test Loss: 1.261 Test Acc: 0.711
Validation loss decreased (-0.702689 --> -0.710798).  Saving model ...
Epoch: 11 cost time: 3.599149703979492
Epoch: 11, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.124 Vali Acc: 0.749 Test Loss: 1.124 Test Acc: 0.749
Validation loss decreased (-0.710798 --> -0.748637).  Saving model ...
Epoch: 12 cost time: 3.489518404006958
Epoch: 12, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.075 Vali Acc: 0.743 Test Loss: 1.075 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.509965658187866
Epoch: 13, Steps: 17 | Train Loss: 0.940 Vali Loss: 0.952 Vali Acc: 0.789 Test Loss: 0.952 Test Acc: 0.789
Validation loss decreased (-0.748637 --> -0.789180).  Saving model ...
Epoch: 14 cost time: 3.5312938690185547
Epoch: 14, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.879 Vali Acc: 0.795 Test Loss: 0.879 Test Acc: 0.795
Validation loss decreased (-0.789180 --> -0.794586).  Saving model ...
Epoch: 15 cost time: 3.4473531246185303
Epoch: 15, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.859 Vali Acc: 0.778 Test Loss: 0.859 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4793009757995605
Epoch: 16, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.761 Vali Acc: 0.822 Test Loss: 0.761 Test Acc: 0.822
Validation loss decreased (-0.794586 --> -0.821614).  Saving model ...
Epoch: 17 cost time: 3.554359197616577
Epoch: 17, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.504788875579834
Epoch: 18, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.705 Vali Acc: 0.822 Test Loss: 0.705 Test Acc: 0.822
Validation loss decreased (-0.821614 --> -0.821615).  Saving model ...
Epoch: 19 cost time: 3.4414122104644775
Epoch: 19, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.602 Vali Acc: 0.868 Test Loss: 0.602 Test Acc: 0.868
Validation loss decreased (-0.821615 --> -0.867562).  Saving model ...
Epoch: 20 cost time: 3.477173328399658
Epoch: 20, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.602 Vali Acc: 0.857 Test Loss: 0.602 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1084299087524414
Epoch: 21, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.538 Vali Acc: 0.884 Test Loss: 0.538 Test Acc: 0.884
Validation loss decreased (-0.867562 --> -0.883778).  Saving model ...
Epoch: 22 cost time: 3.4499917030334473
Epoch: 22, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.508 Vali Acc: 0.878 Test Loss: 0.508 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.527564525604248
Epoch: 23, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.422 Vali Acc: 0.908 Test Loss: 0.422 Test Acc: 0.908
Validation loss decreased (-0.883778 --> -0.908104).  Saving model ...
Epoch: 24 cost time: 3.5355749130249023
Epoch: 24, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.485 Vali Acc: 0.881 Test Loss: 0.485 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.509073495864868
Epoch: 25, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4454245567321777
Epoch: 26, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.511014461517334
Epoch: 27, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.502143383026123
Epoch: 28, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.493488311767578
Epoch: 29, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.464865207672119
Epoch: 30, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.369 Vali Acc: 0.892 Test Loss: 0.369 Test Acc: 0.892
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9081081081081082
model parameter : 882321
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.954650402069092
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.209 Vali Acc: 0.111 Test Loss: 2.209 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 2.9427499771118164
Epoch: 2, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.157 Vali Acc: 0.157 Test Loss: 2.157 Test Acc: 0.157
Validation loss decreased (-0.110789 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 3.1380221843719482
Epoch: 3, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.091 Vali Acc: 0.208 Test Loss: 2.091 Test Acc: 0.208
Validation loss decreased (-0.156735 --> -0.208087).  Saving model ...
Epoch: 4 cost time: 2.5251309871673584
Epoch: 4, Steps: 17 | Train Loss: 2.053 Vali Loss: 2.012 Vali Acc: 0.278 Test Loss: 2.012 Test Acc: 0.278
Validation loss decreased (-0.208087 --> -0.278358).  Saving model ...
Epoch: 5 cost time: 2.3256380558013916
Epoch: 5, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.914 Vali Acc: 0.381 Test Loss: 1.914 Test Acc: 0.381
Validation loss decreased (-0.278358 --> -0.381062).  Saving model ...
Epoch: 6 cost time: 2.9113738536834717
Epoch: 6, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.798 Vali Acc: 0.476 Test Loss: 1.798 Test Acc: 0.476
Validation loss decreased (-0.381062 --> -0.475658).  Saving model ...
Epoch: 7 cost time: 2.861345052719116
Epoch: 7, Steps: 17 | Train Loss: 1.739 Vali Loss: 1.667 Vali Acc: 0.522 Test Loss: 1.667 Test Acc: 0.522
Validation loss decreased (-0.475658 --> -0.521605).  Saving model ...
Epoch: 8 cost time: 2.891221284866333
Epoch: 8, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.538 Vali Acc: 0.568 Test Loss: 1.538 Test Acc: 0.568
Validation loss decreased (-0.521605 --> -0.567552).  Saving model ...
Epoch: 9 cost time: 2.9035568237304688
Epoch: 9, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.419 Vali Acc: 0.595 Test Loss: 1.419 Test Acc: 0.595
Validation loss decreased (-0.567552 --> -0.594580).  Saving model ...
Epoch: 10 cost time: 2.9400882720947266
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.293 Vali Acc: 0.716 Test Loss: 1.293 Test Acc: 0.716
Validation loss decreased (-0.594580 --> -0.716203).  Saving model ...
Epoch: 11 cost time: 2.9312005043029785
Epoch: 11, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.169 Vali Acc: 0.792 Test Loss: 1.169 Test Acc: 0.792
Validation loss decreased (-0.716203 --> -0.791880).  Saving model ...
Epoch: 12 cost time: 2.9759132862091064
Epoch: 12, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.093 Vali Acc: 0.781 Test Loss: 1.093 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9460458755493164
Epoch: 13, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.971 Vali Acc: 0.841 Test Loss: 0.971 Test Acc: 0.841
Validation loss decreased (-0.791880 --> -0.840531).  Saving model ...
Epoch: 14 cost time: 2.971710205078125
Epoch: 14, Steps: 17 | Train Loss: 0.855 Vali Loss: 0.880 Vali Acc: 0.854 Test Loss: 0.880 Test Acc: 0.854
Validation loss decreased (-0.840531 --> -0.854045).  Saving model ...
Epoch: 15 cost time: 2.963733196258545
Epoch: 15, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.775 Vali Acc: 0.873 Test Loss: 0.775 Test Acc: 0.873
Validation loss decreased (-0.854045 --> -0.872965).  Saving model ...
Epoch: 16 cost time: 2.5329177379608154
Epoch: 16, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.718 Vali Acc: 0.870 Test Loss: 0.718 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.866105079650879
Epoch: 17, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.621 Vali Acc: 0.897 Test Loss: 0.621 Test Acc: 0.897
Validation loss decreased (-0.872965 --> -0.897291).  Saving model ...
Epoch: 18 cost time: 2.942301034927368
Epoch: 18, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.611 Vali Acc: 0.865 Test Loss: 0.611 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8928017616271973
Epoch: 19, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.521 Vali Acc: 0.905 Test Loss: 0.521 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905400).  Saving model ...
Epoch: 20 cost time: 2.952730894088745
Epoch: 20, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.463 Vali Acc: 0.905 Test Loss: 0.463 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905401).  Saving model ...
Epoch: 21 cost time: 3.060293436050415
Epoch: 21, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.432 Vali Acc: 0.908 Test Loss: 0.432 Test Acc: 0.908
Validation loss decreased (-0.905401 --> -0.908104).  Saving model ...
Epoch: 22 cost time: 2.986769676208496
Epoch: 22, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.432 Vali Acc: 0.897 Test Loss: 0.432 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9865403175354004
Epoch: 23, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.004423141479492
Epoch: 24, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.358 Vali Acc: 0.914 Test Loss: 0.358 Test Acc: 0.914
Validation loss decreased (-0.908104 --> -0.913510).  Saving model ...
Epoch: 25 cost time: 3.008627414703369
Epoch: 25, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.330 Vali Acc: 0.924 Test Loss: 0.330 Test Acc: 0.924
Validation loss decreased (-0.913510 --> -0.924321).  Saving model ...
Epoch: 26 cost time: 3.031595230102539
Epoch: 26, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.311 Vali Acc: 0.924 Test Loss: 0.311 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924321).  Saving model ...
Epoch: 27 cost time: 2.9998884201049805
Epoch: 27, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.367 Vali Acc: 0.908 Test Loss: 0.367 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9535915851593018
Epoch: 28, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.293 Vali Acc: 0.927 Test Loss: 0.293 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 29 cost time: 3.1077213287353516
Epoch: 29, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.302 Vali Acc: 0.927 Test Loss: 0.302 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0221707820892334
Epoch: 30, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.320 Vali Acc: 0.916 Test Loss: 0.320 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.927027027027027
model parameter : 261345
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.058042526245117
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.200 Vali Acc: 0.073 Test Loss: 2.200 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 2.538120746612549
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.121 Vali Acc: 0.127 Test Loss: 2.121 Test Acc: 0.127
Validation loss decreased (-0.072951 --> -0.127006).  Saving model ...
Epoch: 3 cost time: 2.462285280227661
Epoch: 3, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.015 Vali Acc: 0.235 Test Loss: 2.015 Test Acc: 0.235
Validation loss decreased (-0.127006 --> -0.235115).  Saving model ...
Epoch: 4 cost time: 2.313981533050537
Epoch: 4, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.900 Vali Acc: 0.378 Test Loss: 1.900 Test Acc: 0.378
Validation loss decreased (-0.235115 --> -0.378359).  Saving model ...
Epoch: 5 cost time: 2.301095962524414
Epoch: 5, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.785 Vali Acc: 0.492 Test Loss: 1.785 Test Acc: 0.492
Validation loss decreased (-0.378359 --> -0.491874).  Saving model ...
Epoch: 6 cost time: 2.405444860458374
Epoch: 6, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.681 Vali Acc: 0.586 Test Loss: 1.681 Test Acc: 0.586
Validation loss decreased (-0.491874 --> -0.586470).  Saving model ...
Epoch: 7 cost time: 2.4233546257019043
Epoch: 7, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.579 Vali Acc: 0.668 Test Loss: 1.579 Test Acc: 0.668
Validation loss decreased (-0.586470 --> -0.667552).  Saving model ...
Epoch: 8 cost time: 2.4902377128601074
Epoch: 8, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.477 Vali Acc: 0.711 Test Loss: 1.477 Test Acc: 0.711
Validation loss decreased (-0.667552 --> -0.710796).  Saving model ...
Epoch: 9 cost time: 2.449026584625244
Epoch: 9, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.370 Vali Acc: 0.703 Test Loss: 1.370 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.405038356781006
Epoch: 10, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.265 Vali Acc: 0.719 Test Loss: 1.265 Test Acc: 0.719
Validation loss decreased (-0.710796 --> -0.718906).  Saving model ...
Epoch: 11 cost time: 2.5575430393218994
Epoch: 11, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.135 Vali Acc: 0.765 Test Loss: 1.135 Test Acc: 0.765
Validation loss decreased (-0.718906 --> -0.764854).  Saving model ...
Epoch: 12 cost time: 2.315481185913086
Epoch: 12, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.065 Vali Acc: 0.749 Test Loss: 1.065 Test Acc: 0.749
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.629148244857788
Epoch: 13, Steps: 17 | Train Loss: 0.951 Vali Loss: 0.966 Vali Acc: 0.776 Test Loss: 0.966 Test Acc: 0.776
Validation loss decreased (-0.764854 --> -0.775666).  Saving model ...
Epoch: 14 cost time: 2.6523845195770264
Epoch: 14, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.891 Vali Acc: 0.795 Test Loss: 0.891 Test Acc: 0.795
Validation loss decreased (-0.775666 --> -0.794586).  Saving model ...
Epoch: 15 cost time: 2.6232290267944336
Epoch: 15, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.853 Vali Acc: 0.786 Test Loss: 0.853 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.676776170730591
Epoch: 16, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.782 Vali Acc: 0.822 Test Loss: 0.782 Test Acc: 0.822
Validation loss decreased (-0.794586 --> -0.821614).  Saving model ...
Epoch: 17 cost time: 2.540926694869995
Epoch: 17, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.759 Vali Acc: 0.784 Test Loss: 0.759 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5083162784576416
Epoch: 18, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.727 Vali Acc: 0.797 Test Loss: 0.727 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5250751972198486
Epoch: 19, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.622 Vali Acc: 0.854 Test Loss: 0.622 Test Acc: 0.854
Validation loss decreased (-0.821614 --> -0.854048).  Saving model ...
Epoch: 20 cost time: 2.4753174781799316
Epoch: 20, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.636 Vali Acc: 0.827 Test Loss: 0.636 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.447375535964966
Epoch: 21, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.594 Vali Acc: 0.859 Test Loss: 0.594 Test Acc: 0.859
Validation loss decreased (-0.854048 --> -0.859454).  Saving model ...
Epoch: 22 cost time: 2.469787120819092
Epoch: 22, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.518 Vali Acc: 0.868 Test Loss: 0.518 Test Acc: 0.868
Validation loss decreased (-0.859454 --> -0.867562).  Saving model ...
Epoch: 23 cost time: 2.6204817295074463
Epoch: 23, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.468 Vali Acc: 0.905 Test Loss: 0.468 Test Acc: 0.905
Validation loss decreased (-0.867562 --> -0.905401).  Saving model ...
Epoch: 24 cost time: 2.6662189960479736
Epoch: 24, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6391758918762207
Epoch: 25, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.499 Vali Acc: 0.876 Test Loss: 0.499 Test Acc: 0.876
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.6387572288513184
Epoch: 26, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.446 Vali Acc: 0.886 Test Loss: 0.446 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.6387784481048584
Epoch: 27, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.452 Vali Acc: 0.873 Test Loss: 0.452 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.538464307785034
Epoch: 28, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.339 Vali Acc: 0.927 Test Loss: 0.339 Test Acc: 0.927
Validation loss decreased (-0.905401 --> -0.927024).  Saving model ...
Epoch: 29 cost time: 2.5906784534454346
Epoch: 29, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.449 Vali Acc: 0.878 Test Loss: 0.449 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6007912158966064
Epoch: 30, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.372 Vali Acc: 0.905 Test Loss: 0.372 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.927027027027027
model parameter : 882321
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7493045330047607
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.209 Vali Acc: 0.108 Test Loss: 2.209 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 1.9070134162902832
Epoch: 2, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.158 Vali Acc: 0.157 Test Loss: 2.158 Test Acc: 0.157
Validation loss decreased (-0.108086 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 2.094067335128784
Epoch: 3, Steps: 17 | Train Loss: 2.123 Vali Loss: 2.093 Vali Acc: 0.203 Test Loss: 2.093 Test Acc: 0.203
Validation loss decreased (-0.156735 --> -0.202682).  Saving model ...
Epoch: 4 cost time: 2.0817489624023438
Epoch: 4, Steps: 17 | Train Loss: 2.056 Vali Loss: 2.017 Vali Acc: 0.289 Test Loss: 2.017 Test Acc: 0.289
Validation loss decreased (-0.202682 --> -0.289169).  Saving model ...
Epoch: 5 cost time: 2.0834996700286865
Epoch: 5, Steps: 17 | Train Loss: 1.953 Vali Loss: 1.923 Vali Acc: 0.392 Test Loss: 1.923 Test Acc: 0.392
Validation loss decreased (-0.289169 --> -0.391873).  Saving model ...
Epoch: 6 cost time: 2.0639870166778564
Epoch: 6, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.814 Vali Acc: 0.484 Test Loss: 1.814 Test Acc: 0.484
Validation loss decreased (-0.391873 --> -0.483766).  Saving model ...
Epoch: 7 cost time: 1.9754612445831299
Epoch: 7, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.698 Vali Acc: 0.557 Test Loss: 1.698 Test Acc: 0.557
Validation loss decreased (-0.483766 --> -0.556740).  Saving model ...
Epoch: 8 cost time: 2.132805585861206
Epoch: 8, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.577 Vali Acc: 0.632 Test Loss: 1.577 Test Acc: 0.632
Validation loss decreased (-0.556740 --> -0.632417).  Saving model ...
Epoch: 9 cost time: 2.3090174198150635
Epoch: 9, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.458 Vali Acc: 0.686 Test Loss: 1.458 Test Acc: 0.686
Validation loss decreased (-0.632417 --> -0.686472).  Saving model ...
Epoch: 10 cost time: 2.3328068256378174
Epoch: 10, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.352 Vali Acc: 0.692 Test Loss: 1.352 Test Acc: 0.692
Validation loss decreased (-0.686472 --> -0.691878).  Saving model ...
Epoch: 11 cost time: 2.3359386920928955
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.239 Vali Acc: 0.743 Test Loss: 1.239 Test Acc: 0.743
Validation loss decreased (-0.691878 --> -0.743231).  Saving model ...
Epoch: 12 cost time: 2.35378098487854
Epoch: 12, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.133 Vali Acc: 0.768 Test Loss: 1.133 Test Acc: 0.768
Validation loss decreased (-0.743231 --> -0.767556).  Saving model ...
Epoch: 13 cost time: 2.300783395767212
Epoch: 13, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.032 Vali Acc: 0.803 Test Loss: 1.032 Test Acc: 0.803
Validation loss decreased (-0.767556 --> -0.802692).  Saving model ...
Epoch: 14 cost time: 2.37123441696167
Epoch: 14, Steps: 17 | Train Loss: 0.938 Vali Loss: 0.931 Vali Acc: 0.835 Test Loss: 0.931 Test Acc: 0.835
Validation loss decreased (-0.802692 --> -0.835126).  Saving model ...
Epoch: 15 cost time: 2.326207160949707
Epoch: 15, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.841 Vali Acc: 0.859 Test Loss: 0.841 Test Acc: 0.859
Validation loss decreased (-0.835126 --> -0.859451).  Saving model ...
Epoch: 16 cost time: 2.3310837745666504
Epoch: 16, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.782 Vali Acc: 0.835 Test Loss: 0.782 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3209705352783203
Epoch: 17, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.687 Vali Acc: 0.868 Test Loss: 0.687 Test Acc: 0.868
Validation loss decreased (-0.859451 --> -0.867561).  Saving model ...
Epoch: 18 cost time: 2.28363037109375
Epoch: 18, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.663 Vali Acc: 0.868 Test Loss: 0.663 Test Acc: 0.868
Validation loss decreased (-0.867561 --> -0.867561).  Saving model ...
Epoch: 19 cost time: 2.285872459411621
Epoch: 19, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.598 Vali Acc: 0.884 Test Loss: 0.598 Test Acc: 0.884
Validation loss decreased (-0.867561 --> -0.883778).  Saving model ...
Epoch: 20 cost time: 2.0882556438446045
Epoch: 20, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.552 Vali Acc: 0.903 Test Loss: 0.552 Test Acc: 0.903
Validation loss decreased (-0.883778 --> -0.902697).  Saving model ...
Epoch: 21 cost time: 2.1147985458374023
Epoch: 21, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.531 Vali Acc: 0.897 Test Loss: 0.531 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2554945945739746
Epoch: 22, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.519 Vali Acc: 0.876 Test Loss: 0.519 Test Acc: 0.876
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2780089378356934
Epoch: 23, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.450 Vali Acc: 0.916 Test Loss: 0.450 Test Acc: 0.916
Validation loss decreased (-0.902697 --> -0.916212).  Saving model ...
Epoch: 24 cost time: 2.1654419898986816
Epoch: 24, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.423 Vali Acc: 0.905 Test Loss: 0.423 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1651270389556885
Epoch: 25, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.410 Vali Acc: 0.916 Test Loss: 0.410 Test Acc: 0.916
Validation loss decreased (-0.916212 --> -0.916212).  Saving model ...
Epoch: 26 cost time: 2.199198007583618
Epoch: 26, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.372 Vali Acc: 0.911 Test Loss: 0.372 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.231466054916382
Epoch: 27, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.399 Vali Acc: 0.892 Test Loss: 0.399 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1998164653778076
Epoch: 28, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.333 Vali Acc: 0.914 Test Loss: 0.333 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1480326652526855
Epoch: 29, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.343 Vali Acc: 0.905 Test Loss: 0.343 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.251574754714966
Epoch: 30, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.329 Vali Acc: 0.905 Test Loss: 0.329 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9162162162162162
model parameter : 261345
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3358092308044434
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.201 Vali Acc: 0.073 Test Loss: 2.201 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 1.8924686908721924
Epoch: 2, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.127 Vali Acc: 0.127 Test Loss: 2.127 Test Acc: 0.127
Validation loss decreased (-0.072951 --> -0.127006).  Saving model ...
Epoch: 3 cost time: 1.8794574737548828
Epoch: 3, Steps: 17 | Train Loss: 2.085 Vali Loss: 2.027 Vali Acc: 0.222 Test Loss: 2.027 Test Acc: 0.222
Validation loss decreased (-0.127006 --> -0.221601).  Saving model ...
Epoch: 4 cost time: 1.877065658569336
Epoch: 4, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.921 Vali Acc: 0.357 Test Loss: 1.921 Test Acc: 0.357
Validation loss decreased (-0.221601 --> -0.356738).  Saving model ...
Epoch: 5 cost time: 1.9396121501922607
Epoch: 5, Steps: 17 | Train Loss: 1.870 Vali Loss: 1.814 Vali Acc: 0.443 Test Loss: 1.814 Test Acc: 0.443
Validation loss decreased (-0.356738 --> -0.443225).  Saving model ...
Epoch: 6 cost time: 2.1066253185272217
Epoch: 6, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.716 Vali Acc: 0.541 Test Loss: 1.716 Test Acc: 0.541
Validation loss decreased (-0.443225 --> -0.540523).  Saving model ...
Epoch: 7 cost time: 1.9680871963500977
Epoch: 7, Steps: 17 | Train Loss: 1.643 Vali Loss: 1.613 Vali Acc: 0.605 Test Loss: 1.613 Test Acc: 0.605
Validation loss decreased (-0.540523 --> -0.605389).  Saving model ...
Epoch: 8 cost time: 2.006798267364502
Epoch: 8, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.517 Vali Acc: 0.641 Test Loss: 1.517 Test Acc: 0.641
Validation loss decreased (-0.605389 --> -0.640525).  Saving model ...
Epoch: 9 cost time: 2.1584537029266357
Epoch: 9, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.421 Vali Acc: 0.657 Test Loss: 1.421 Test Acc: 0.657
Validation loss decreased (-0.640525 --> -0.656743).  Saving model ...
Epoch: 10 cost time: 2.0197017192840576
Epoch: 10, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.333 Vali Acc: 0.662 Test Loss: 1.333 Test Acc: 0.662
Validation loss decreased (-0.656743 --> -0.662149).  Saving model ...
Epoch: 11 cost time: 2.146134376525879
Epoch: 11, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.238 Vali Acc: 0.700 Test Loss: 1.238 Test Acc: 0.700
Validation loss decreased (-0.662149 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 2.124145030975342
Epoch: 12, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.152 Vali Acc: 0.727 Test Loss: 1.152 Test Acc: 0.727
Validation loss decreased (-0.699988 --> -0.727016).  Saving model ...
Epoch: 13 cost time: 2.1268441677093506
Epoch: 13, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.078 Vali Acc: 0.735 Test Loss: 1.078 Test Acc: 0.735
Validation loss decreased (-0.727016 --> -0.735124).  Saving model ...
Epoch: 14 cost time: 2.269879102706909
Epoch: 14, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.009 Vali Acc: 0.746 Test Loss: 1.009 Test Acc: 0.746
Validation loss decreased (-0.735124 --> -0.745936).  Saving model ...
Epoch: 15 cost time: 2.2587132453918457
Epoch: 15, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.937 Vali Acc: 0.778 Test Loss: 0.937 Test Acc: 0.778
Validation loss decreased (-0.745936 --> -0.778369).  Saving model ...
Epoch: 16 cost time: 2.1878161430358887
Epoch: 16, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.872 Vali Acc: 0.786 Test Loss: 0.872 Test Acc: 0.786
Validation loss decreased (-0.778369 --> -0.786478).  Saving model ...
Epoch: 17 cost time: 2.188328981399536
Epoch: 17, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.833 Vali Acc: 0.808 Test Loss: 0.833 Test Acc: 0.808
Validation loss decreased (-0.786478 --> -0.808100).  Saving model ...
Epoch: 18 cost time: 2.2607147693634033
Epoch: 18, Steps: 17 | Train Loss: 0.690 Vali Loss: 0.766 Vali Acc: 0.816 Test Loss: 0.766 Test Acc: 0.816
Validation loss decreased (-0.808100 --> -0.816209).  Saving model ...
Epoch: 19 cost time: 2.337313652038574
Epoch: 19, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.713 Vali Acc: 0.838 Test Loss: 0.713 Test Acc: 0.838
Validation loss decreased (-0.816209 --> -0.837831).  Saving model ...
Epoch: 20 cost time: 2.276937961578369
Epoch: 20, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.691 Vali Acc: 0.843 Test Loss: 0.691 Test Acc: 0.843
Validation loss decreased (-0.837831 --> -0.843236).  Saving model ...
Epoch: 21 cost time: 2.252833366394043
Epoch: 21, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.636 Vali Acc: 0.859 Test Loss: 0.636 Test Acc: 0.859
Validation loss decreased (-0.843236 --> -0.859453).  Saving model ...
Epoch: 22 cost time: 2.3125345706939697
Epoch: 22, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.577 Vali Acc: 0.868 Test Loss: 0.577 Test Acc: 0.868
Validation loss decreased (-0.859453 --> -0.867562).  Saving model ...
Epoch: 23 cost time: 2.3606293201446533
Epoch: 23, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.540 Vali Acc: 0.881 Test Loss: 0.540 Test Acc: 0.881
Validation loss decreased (-0.867562 --> -0.881076).  Saving model ...
Epoch: 24 cost time: 2.275355815887451
Epoch: 24, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.521 Vali Acc: 0.878 Test Loss: 0.521 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2636194229125977
Epoch: 25, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.606 Vali Acc: 0.808 Test Loss: 0.606 Test Acc: 0.808
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2899186611175537
Epoch: 26, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.441 Vali Acc: 0.905 Test Loss: 0.441 Test Acc: 0.905
Validation loss decreased (-0.881076 --> -0.905401).  Saving model ...
Epoch: 27 cost time: 2.261127233505249
Epoch: 27, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.429 Vali Acc: 0.897 Test Loss: 0.429 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2674806118011475
Epoch: 28, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.391 Vali Acc: 0.908 Test Loss: 0.391 Test Acc: 0.908
Validation loss decreased (-0.905401 --> -0.908104).  Saving model ...
Epoch: 29 cost time: 2.066549777984619
Epoch: 29, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.413 Vali Acc: 0.897 Test Loss: 0.413 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1074821949005127
Epoch: 30, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.383 Vali Acc: 0.886 Test Loss: 0.383 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9081081081081082
model parameter : 882321
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.262561798095703
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.212 Vali Acc: 0.111 Test Loss: 2.212 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 1.8939599990844727
Epoch: 2, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.162 Vali Acc: 0.157 Test Loss: 2.162 Test Acc: 0.157
Validation loss decreased (-0.110789 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 1.8541901111602783
Epoch: 3, Steps: 17 | Train Loss: 2.127 Vali Loss: 2.101 Vali Acc: 0.197 Test Loss: 2.101 Test Acc: 0.197
Validation loss decreased (-0.156735 --> -0.197276).  Saving model ...
Epoch: 4 cost time: 1.9780800342559814
Epoch: 4, Steps: 17 | Train Loss: 2.063 Vali Loss: 2.029 Vali Acc: 0.270 Test Loss: 2.029 Test Acc: 0.270
Validation loss decreased (-0.197276 --> -0.270250).  Saving model ...
Epoch: 5 cost time: 1.9448838233947754
Epoch: 5, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.947 Vali Acc: 0.343 Test Loss: 1.947 Test Acc: 0.343
Validation loss decreased (-0.270250 --> -0.343224).  Saving model ...
Epoch: 6 cost time: 1.9111251831054688
Epoch: 6, Steps: 17 | Train Loss: 1.877 Vali Loss: 1.858 Vali Acc: 0.381 Test Loss: 1.858 Test Acc: 0.381
Validation loss decreased (-0.343224 --> -0.381063).  Saving model ...
Epoch: 7 cost time: 1.9152159690856934
Epoch: 7, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.761 Vali Acc: 0.438 Test Loss: 1.761 Test Acc: 0.438
Validation loss decreased (-0.381063 --> -0.437820).  Saving model ...
Epoch: 8 cost time: 1.931014060974121
Epoch: 8, Steps: 17 | Train Loss: 1.673 Vali Loss: 1.658 Vali Acc: 0.484 Test Loss: 1.658 Test Acc: 0.484
Validation loss decreased (-0.437820 --> -0.483767).  Saving model ...
Epoch: 9 cost time: 1.9766314029693604
Epoch: 9, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.550 Vali Acc: 0.562 Test Loss: 1.550 Test Acc: 0.562
Validation loss decreased (-0.483767 --> -0.562147).  Saving model ...
Epoch: 10 cost time: 1.9917213916778564
Epoch: 10, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.450 Vali Acc: 0.605 Test Loss: 1.450 Test Acc: 0.605
Validation loss decreased (-0.562147 --> -0.605391).  Saving model ...
Epoch: 11 cost time: 2.0194876194000244
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.345 Vali Acc: 0.681 Test Loss: 1.345 Test Acc: 0.681
Validation loss decreased (-0.605391 --> -0.681068).  Saving model ...
Epoch: 12 cost time: 1.9388060569763184
Epoch: 12, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.253 Vali Acc: 0.711 Test Loss: 1.253 Test Acc: 0.711
Validation loss decreased (-0.681068 --> -0.710798).  Saving model ...
Epoch: 13 cost time: 2.0714850425720215
Epoch: 13, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.157 Vali Acc: 0.724 Test Loss: 1.157 Test Acc: 0.724
Validation loss decreased (-0.710798 --> -0.724313).  Saving model ...
Epoch: 14 cost time: 2.0237514972686768
Epoch: 14, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.068 Vali Acc: 0.714 Test Loss: 1.068 Test Acc: 0.714
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0519542694091797
Epoch: 15, Steps: 17 | Train Loss: 0.937 Vali Loss: 0.993 Vali Acc: 0.751 Test Loss: 0.993 Test Acc: 0.751
Validation loss decreased (-0.724313 --> -0.751341).  Saving model ...
Epoch: 16 cost time: 2.06563401222229
Epoch: 16, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.914 Vali Acc: 0.773 Test Loss: 0.914 Test Acc: 0.773
Validation loss decreased (-0.751341 --> -0.772964).  Saving model ...
Epoch: 17 cost time: 2.0540218353271484
Epoch: 17, Steps: 17 | Train Loss: 0.779 Vali Loss: 0.845 Vali Acc: 0.781 Test Loss: 0.845 Test Acc: 0.781
Validation loss decreased (-0.772964 --> -0.781073).  Saving model ...
Epoch: 18 cost time: 1.9063208103179932
Epoch: 18, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.786 Vali Acc: 0.784 Test Loss: 0.786 Test Acc: 0.784
Validation loss decreased (-0.781073 --> -0.783776).  Saving model ...
Epoch: 19 cost time: 1.9257590770721436
Epoch: 19, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.728 Vali Acc: 0.797 Test Loss: 0.728 Test Acc: 0.797
Validation loss decreased (-0.783776 --> -0.797290).  Saving model ...
Epoch: 20 cost time: 1.8616514205932617
Epoch: 20, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
Validation loss decreased (-0.797290 --> -0.810804).  Saving model ...
Epoch: 21 cost time: 1.949141502380371
Epoch: 21, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.629 Vali Acc: 0.846 Test Loss: 0.629 Test Acc: 0.846
Validation loss decreased (-0.810804 --> -0.845940).  Saving model ...
Epoch: 22 cost time: 1.9041283130645752
Epoch: 22, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.597 Vali Acc: 0.830 Test Loss: 0.597 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9326107501983643
Epoch: 23, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.551 Vali Acc: 0.876 Test Loss: 0.551 Test Acc: 0.876
Validation loss decreased (-0.845940 --> -0.875670).  Saving model ...
Epoch: 24 cost time: 1.9213063716888428
Epoch: 24, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.875670 --> -0.878373).  Saving model ...
Epoch: 25 cost time: 1.9677236080169678
Epoch: 25, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.878373 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 2.086977958679199
Epoch: 26, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.444 Vali Acc: 0.930 Test Loss: 0.444 Test Acc: 0.930
Validation loss decreased (-0.899995 --> -0.929725).  Saving model ...
Epoch: 27 cost time: 1.970656156539917
Epoch: 27, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.459 Vali Acc: 0.884 Test Loss: 0.459 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.027621269226074
Epoch: 28, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.401 Vali Acc: 0.930 Test Loss: 0.401 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929726).  Saving model ...
Epoch: 29 cost time: 2.0419387817382812
Epoch: 29, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.390 Vali Acc: 0.927 Test Loss: 0.390 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0676159858703613
Epoch: 30, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.365 Vali Acc: 0.938 Test Loss: 0.365 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937834).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 261345
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.871673583984375
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.175 Vali Acc: 0.184 Test Loss: 2.175 Test Acc: 0.184
Validation loss decreased (inf --> -0.183762).  Saving model ...
Epoch: 2 cost time: 3.1542153358459473
Epoch: 2, Steps: 17 | Train Loss: 2.130 Vali Loss: 2.125 Vali Acc: 0.232 Test Loss: 2.125 Test Acc: 0.232
Validation loss decreased (-0.183762 --> -0.232411).  Saving model ...
Epoch: 3 cost time: 3.1526148319244385
Epoch: 3, Steps: 17 | Train Loss: 2.072 Vali Loss: 2.055 Vali Acc: 0.330 Test Loss: 2.055 Test Acc: 0.330
Validation loss decreased (-0.232411 --> -0.329709).  Saving model ...
Epoch: 4 cost time: 3.2227585315704346
Epoch: 4, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.951 Vali Acc: 0.500 Test Loss: 1.951 Test Acc: 0.500
Validation loss decreased (-0.329709 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 3.0839996337890625
Epoch: 5, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.836 Vali Acc: 0.622 Test Loss: 1.836 Test Acc: 0.622
Validation loss decreased (-0.499980 --> -0.621603).  Saving model ...
Epoch: 6 cost time: 3.044405937194824
Epoch: 6, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.727 Vali Acc: 0.686 Test Loss: 1.727 Test Acc: 0.686
Validation loss decreased (-0.621603 --> -0.686469).  Saving model ...
Epoch: 7 cost time: 2.923757791519165
Epoch: 7, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.611 Vali Acc: 0.735 Test Loss: 1.611 Test Acc: 0.735
Validation loss decreased (-0.686469 --> -0.735119).  Saving model ...
Epoch: 8 cost time: 2.9643990993499756
Epoch: 8, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.486 Vali Acc: 0.722 Test Loss: 1.486 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9948532581329346
Epoch: 9, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.364 Vali Acc: 0.765 Test Loss: 1.364 Test Acc: 0.765
Validation loss decreased (-0.735119 --> -0.764851).  Saving model ...
Epoch: 10 cost time: 2.8463761806488037
Epoch: 10, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.246 Vali Acc: 0.789 Test Loss: 1.246 Test Acc: 0.789
Validation loss decreased (-0.764851 --> -0.789177).  Saving model ...
Epoch: 11 cost time: 2.8621091842651367
Epoch: 11, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.137 Vali Acc: 0.778 Test Loss: 1.137 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.124722957611084
Epoch: 12, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.041 Vali Acc: 0.792 Test Loss: 1.041 Test Acc: 0.792
Validation loss decreased (-0.789177 --> -0.791881).  Saving model ...
Epoch: 13 cost time: 3.1617844104766846
Epoch: 13, Steps: 17 | Train Loss: 0.999 Vali Loss: 0.936 Vali Acc: 0.835 Test Loss: 0.936 Test Acc: 0.835
Validation loss decreased (-0.791881 --> -0.835126).  Saving model ...
Epoch: 14 cost time: 3.232943296432495
Epoch: 14, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.867 Vali Acc: 0.819 Test Loss: 0.867 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2431249618530273
Epoch: 15, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.798 Vali Acc: 0.832 Test Loss: 0.798 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2093777656555176
Epoch: 16, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.735 Vali Acc: 0.843 Test Loss: 0.735 Test Acc: 0.843
Validation loss decreased (-0.835126 --> -0.843236).  Saving model ...
Epoch: 17 cost time: 3.3205323219299316
Epoch: 17, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.625 Vali Acc: 0.881 Test Loss: 0.625 Test Acc: 0.881
Validation loss decreased (-0.843236 --> -0.881075).  Saving model ...
Epoch: 18 cost time: 3.233588457107544
Epoch: 18, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.565 Vali Acc: 0.903 Test Loss: 0.565 Test Acc: 0.903
Validation loss decreased (-0.881075 --> -0.902697).  Saving model ...
Epoch: 19 cost time: 3.2601113319396973
Epoch: 19, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.539 Vali Acc: 0.908 Test Loss: 0.539 Test Acc: 0.908
Validation loss decreased (-0.902697 --> -0.908103).  Saving model ...
Epoch: 20 cost time: 3.285649538040161
Epoch: 20, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.490 Vali Acc: 0.903 Test Loss: 0.490 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2990424633026123
Epoch: 21, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.433 Vali Acc: 0.914 Test Loss: 0.433 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 22 cost time: 3.0608010292053223
Epoch: 22, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.421 Vali Acc: 0.908 Test Loss: 0.421 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.170382022857666
Epoch: 23, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
Validation loss decreased (-0.913509 --> -0.929726).  Saving model ...
Epoch: 24 cost time: 2.8000378608703613
Epoch: 24, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.313 Vali Acc: 0.943 Test Loss: 0.313 Test Acc: 0.943
Validation loss decreased (-0.929726 --> -0.943240).  Saving model ...
Epoch: 25 cost time: 2.8266029357910156
Epoch: 25, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.378 Vali Acc: 0.905 Test Loss: 0.378 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8618245124816895
Epoch: 26, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.015411615371704
Epoch: 27, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.317 Vali Acc: 0.924 Test Loss: 0.317 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.0103604793548584
Epoch: 28, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.240 Vali Acc: 0.954 Test Loss: 0.240 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 2.950319766998291
Epoch: 29, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.343 Vali Acc: 0.911 Test Loss: 0.343 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.934828996658325
Epoch: 30, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 442449
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.048949480056763
Epoch: 1, Steps: 17 | Train Loss: 2.303 Vali Loss: 2.275 Vali Acc: 0.081 Test Loss: 2.275 Test Acc: 0.081
Validation loss decreased (inf --> -0.081058).  Saving model ...
Epoch: 2 cost time: 2.28939151763916
Epoch: 2, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.226 Vali Acc: 0.108 Test Loss: 2.226 Test Acc: 0.108
Validation loss decreased (-0.081058 --> -0.108086).  Saving model ...
Epoch: 3 cost time: 2.594139575958252
Epoch: 3, Steps: 17 | Train Loss: 2.190 Vali Loss: 2.162 Vali Acc: 0.143 Test Loss: 2.162 Test Acc: 0.143
Validation loss decreased (-0.108086 --> -0.143222).  Saving model ...
Epoch: 4 cost time: 2.7024588584899902
Epoch: 4, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.087 Vali Acc: 0.230 Test Loss: 2.087 Test Acc: 0.230
Validation loss decreased (-0.143222 --> -0.229709).  Saving model ...
Epoch: 5 cost time: 2.526240348815918
Epoch: 5, Steps: 17 | Train Loss: 2.029 Vali Loss: 2.005 Vali Acc: 0.292 Test Loss: 2.005 Test Acc: 0.292
Validation loss decreased (-0.229709 --> -0.291872).  Saving model ...
Epoch: 6 cost time: 2.4143221378326416
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.920 Vali Acc: 0.403 Test Loss: 1.920 Test Acc: 0.403
Validation loss decreased (-0.291872 --> -0.402684).  Saving model ...
Epoch: 7 cost time: 2.5165181159973145
Epoch: 7, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.835 Vali Acc: 0.486 Test Loss: 1.835 Test Acc: 0.486
Validation loss decreased (-0.402684 --> -0.486468).  Saving model ...
Epoch: 8 cost time: 2.651024103164673
Epoch: 8, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.748 Vali Acc: 0.565 Test Loss: 1.748 Test Acc: 0.565
Validation loss decreased (-0.486468 --> -0.564847).  Saving model ...
Epoch: 9 cost time: 2.5635478496551514
Epoch: 9, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.659 Vali Acc: 0.638 Test Loss: 1.659 Test Acc: 0.638
Validation loss decreased (-0.564847 --> -0.637821).  Saving model ...
Epoch: 10 cost time: 2.6482253074645996
Epoch: 10, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.562 Vali Acc: 0.703 Test Loss: 1.562 Test Acc: 0.703
Validation loss decreased (-0.637821 --> -0.702687).  Saving model ...
Epoch: 11 cost time: 2.734891891479492
Epoch: 11, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.459 Vali Acc: 0.730 Test Loss: 1.459 Test Acc: 0.730
Validation loss decreased (-0.702687 --> -0.729715).  Saving model ...
Epoch: 12 cost time: 2.66208815574646
Epoch: 12, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.367 Vali Acc: 0.724 Test Loss: 1.367 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8906126022338867
Epoch: 13, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.246 Vali Acc: 0.784 Test Loss: 1.246 Test Acc: 0.784
Validation loss decreased (-0.729715 --> -0.783771).  Saving model ...
Epoch: 14 cost time: 2.553732395172119
Epoch: 14, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.145 Vali Acc: 0.797 Test Loss: 1.145 Test Acc: 0.797
Validation loss decreased (-0.783771 --> -0.797286).  Saving model ...
Epoch: 15 cost time: 2.843258857727051
Epoch: 15, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.035 Vali Acc: 0.824 Test Loss: 1.035 Test Acc: 0.824
Validation loss decreased (-0.797286 --> -0.824314).  Saving model ...
Epoch: 16 cost time: 2.7753281593322754
Epoch: 16, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.931 Vali Acc: 0.854 Test Loss: 0.931 Test Acc: 0.854
Validation loss decreased (-0.824314 --> -0.854045).  Saving model ...
Epoch: 17 cost time: 2.7558865547180176
Epoch: 17, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.866 Vali Acc: 0.849 Test Loss: 0.866 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.670186758041382
Epoch: 18, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.755 Vali Acc: 0.884 Test Loss: 0.755 Test Acc: 0.884
Validation loss decreased (-0.854045 --> -0.883776).  Saving model ...
Epoch: 19 cost time: 2.6237106323242188
Epoch: 19, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.702 Vali Acc: 0.881 Test Loss: 0.702 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8020970821380615
Epoch: 20, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.635 Vali Acc: 0.889 Test Loss: 0.635 Test Acc: 0.889
Validation loss decreased (-0.883776 --> -0.889183).  Saving model ...
Epoch: 21 cost time: 2.5121374130249023
Epoch: 21, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.583 Vali Acc: 0.900 Test Loss: 0.583 Test Acc: 0.900
Validation loss decreased (-0.889183 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 2.54115891456604
Epoch: 22, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.526 Vali Acc: 0.903 Test Loss: 0.526 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902697).  Saving model ...
Epoch: 23 cost time: 2.4548299312591553
Epoch: 23, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.496 Vali Acc: 0.895 Test Loss: 0.496 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.530576705932617
Epoch: 24, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.366621255874634
Epoch: 25, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.432 Vali Acc: 0.897 Test Loss: 0.432 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.672776460647583
Epoch: 26, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.385 Vali Acc: 0.914 Test Loss: 0.385 Test Acc: 0.914
Validation loss decreased (-0.902697 --> -0.913510).  Saving model ...
Epoch: 27 cost time: 2.739433526992798
Epoch: 27, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
Validation loss decreased (-0.913510 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 2.579793691635132
Epoch: 28, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 29 cost time: 2.635282278060913
Epoch: 29, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.330 Vali Acc: 0.908 Test Loss: 0.330 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7041120529174805
Epoch: 30, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.286 Vali Acc: 0.935 Test Loss: 0.286 Test Acc: 0.935
Validation loss decreased (-0.921618 --> -0.935132).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9351351351351351
model parameter : 131937
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9964451789855957
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.176 Vali Acc: 0.184 Test Loss: 2.176 Test Acc: 0.184
Validation loss decreased (inf --> -0.183762).  Saving model ...
Epoch: 2 cost time: 2.429201602935791
Epoch: 2, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.128 Vali Acc: 0.232 Test Loss: 2.128 Test Acc: 0.232
Validation loss decreased (-0.183762 --> -0.232411).  Saving model ...
Epoch: 3 cost time: 2.5460989475250244
Epoch: 3, Steps: 17 | Train Loss: 2.074 Vali Loss: 2.062 Vali Acc: 0.311 Test Loss: 2.062 Test Acc: 0.311
Validation loss decreased (-0.232411 --> -0.310790).  Saving model ...
Epoch: 4 cost time: 2.299697160720825
Epoch: 4, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.963 Vali Acc: 0.489 Test Loss: 1.963 Test Acc: 0.489
Validation loss decreased (-0.310790 --> -0.489170).  Saving model ...
Epoch: 5 cost time: 2.407052516937256
Epoch: 5, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.849 Vali Acc: 0.605 Test Loss: 1.849 Test Acc: 0.605
Validation loss decreased (-0.489170 --> -0.605387).  Saving model ...
Epoch: 6 cost time: 2.2830710411071777
Epoch: 6, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.740 Vali Acc: 0.681 Test Loss: 1.740 Test Acc: 0.681
Validation loss decreased (-0.605387 --> -0.681064).  Saving model ...
Epoch: 7 cost time: 2.274317741394043
Epoch: 7, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.628 Vali Acc: 0.730 Test Loss: 1.628 Test Acc: 0.730
Validation loss decreased (-0.681064 --> -0.729713).  Saving model ...
Epoch: 8 cost time: 2.2719836235046387
Epoch: 8, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.514 Vali Acc: 0.741 Test Loss: 1.514 Test Acc: 0.741
Validation loss decreased (-0.729713 --> -0.740525).  Saving model ...
Epoch: 9 cost time: 2.2352705001831055
Epoch: 9, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.399 Vali Acc: 0.749 Test Loss: 1.399 Test Acc: 0.749
Validation loss decreased (-0.740525 --> -0.748635).  Saving model ...
Epoch: 10 cost time: 2.4181454181671143
Epoch: 10, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.294 Vali Acc: 0.765 Test Loss: 1.294 Test Acc: 0.765
Validation loss decreased (-0.748635 --> -0.764852).  Saving model ...
Epoch: 11 cost time: 2.444720983505249
Epoch: 11, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.187 Vali Acc: 0.773 Test Loss: 1.187 Test Acc: 0.773
Validation loss decreased (-0.764852 --> -0.772961).  Saving model ...
Epoch: 12 cost time: 2.590484857559204
Epoch: 12, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.089 Vali Acc: 0.781 Test Loss: 1.089 Test Acc: 0.781
Validation loss decreased (-0.772961 --> -0.781070).  Saving model ...
Epoch: 13 cost time: 2.5070486068725586
Epoch: 13, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.008 Vali Acc: 0.824 Test Loss: 1.008 Test Acc: 0.824
Validation loss decreased (-0.781070 --> -0.824314).  Saving model ...
Epoch: 14 cost time: 2.4878273010253906
Epoch: 14, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.922 Vali Acc: 0.805 Test Loss: 0.922 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.522535562515259
Epoch: 15, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.839 Vali Acc: 0.819 Test Loss: 0.839 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4721529483795166
Epoch: 16, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.781 Vali Acc: 0.827 Test Loss: 0.781 Test Acc: 0.827
Validation loss decreased (-0.824314 --> -0.827019).  Saving model ...
Epoch: 17 cost time: 2.5674657821655273
Epoch: 17, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.698 Vali Acc: 0.859 Test Loss: 0.698 Test Acc: 0.859
Validation loss decreased (-0.827019 --> -0.859452).  Saving model ...
Epoch: 18 cost time: 2.5020065307617188
Epoch: 18, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.649 Vali Acc: 0.865 Test Loss: 0.649 Test Acc: 0.865
Validation loss decreased (-0.859452 --> -0.864858).  Saving model ...
Epoch: 19 cost time: 2.408057451248169
Epoch: 19, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.632 Vali Acc: 0.843 Test Loss: 0.632 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.483086109161377
Epoch: 20, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.520 Vali Acc: 0.905 Test Loss: 0.520 Test Acc: 0.905
Validation loss decreased (-0.864858 --> -0.905400).  Saving model ...
Epoch: 21 cost time: 2.3461577892303467
Epoch: 21, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.507 Vali Acc: 0.881 Test Loss: 0.507 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.328491687774658
Epoch: 22, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.464 Vali Acc: 0.886 Test Loss: 0.464 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2574541568756104
Epoch: 23, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
Validation loss decreased (-0.905400 --> -0.918915).  Saving model ...
Epoch: 24 cost time: 2.2378928661346436
Epoch: 24, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.388 Vali Acc: 0.927 Test Loss: 0.388 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927023).  Saving model ...
Epoch: 25 cost time: 2.3274874687194824
Epoch: 25, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2691116333007812
Epoch: 26, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935132).  Saving model ...
Epoch: 27 cost time: 2.4707424640655518
Epoch: 27, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4330105781555176
Epoch: 28, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.246 Vali Acc: 0.957 Test Loss: 0.246 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956754).  Saving model ...
Epoch: 29 cost time: 2.4504849910736084
Epoch: 29, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5271060466766357
Epoch: 30, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.279 Vali Acc: 0.927 Test Loss: 0.279 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 442449
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7001760005950928
Epoch: 1, Steps: 17 | Train Loss: 2.303 Vali Loss: 2.275 Vali Acc: 0.081 Test Loss: 2.275 Test Acc: 0.081
Validation loss decreased (inf --> -0.081058).  Saving model ...
Epoch: 2 cost time: 2.212476968765259
Epoch: 2, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.226 Vali Acc: 0.108 Test Loss: 2.226 Test Acc: 0.108
Validation loss decreased (-0.081058 --> -0.108086).  Saving model ...
Epoch: 3 cost time: 2.295888900756836
Epoch: 3, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.162 Vali Acc: 0.143 Test Loss: 2.162 Test Acc: 0.143
Validation loss decreased (-0.108086 --> -0.143222).  Saving model ...
Epoch: 4 cost time: 2.1332781314849854
Epoch: 4, Steps: 17 | Train Loss: 2.123 Vali Loss: 2.088 Vali Acc: 0.227 Test Loss: 2.088 Test Acc: 0.227
Validation loss decreased (-0.143222 --> -0.227006).  Saving model ...
Epoch: 5 cost time: 2.2261955738067627
Epoch: 5, Steps: 17 | Train Loss: 2.033 Vali Loss: 2.007 Vali Acc: 0.289 Test Loss: 2.007 Test Acc: 0.289
Validation loss decreased (-0.227006 --> -0.289169).  Saving model ...
Epoch: 6 cost time: 2.2229113578796387
Epoch: 6, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.922 Vali Acc: 0.400 Test Loss: 1.922 Test Acc: 0.400
Validation loss decreased (-0.289169 --> -0.399981).  Saving model ...
Epoch: 7 cost time: 2.0561654567718506
Epoch: 7, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.837 Vali Acc: 0.486 Test Loss: 1.837 Test Acc: 0.486
Validation loss decreased (-0.399981 --> -0.486468).  Saving model ...
Epoch: 8 cost time: 1.9907174110412598
Epoch: 8, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.750 Vali Acc: 0.557 Test Loss: 1.750 Test Acc: 0.557
Validation loss decreased (-0.486468 --> -0.556739).  Saving model ...
Epoch: 9 cost time: 2.1385767459869385
Epoch: 9, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.662 Vali Acc: 0.627 Test Loss: 1.662 Test Acc: 0.627
Validation loss decreased (-0.556739 --> -0.627010).  Saving model ...
Epoch: 10 cost time: 2.041811943054199
Epoch: 10, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.565 Vali Acc: 0.684 Test Loss: 1.565 Test Acc: 0.684
Validation loss decreased (-0.627010 --> -0.683768).  Saving model ...
Epoch: 11 cost time: 1.9959816932678223
Epoch: 11, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.466 Vali Acc: 0.724 Test Loss: 1.466 Test Acc: 0.724
Validation loss decreased (-0.683768 --> -0.724310).  Saving model ...
Epoch: 12 cost time: 2.01855206489563
Epoch: 12, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.374 Vali Acc: 0.741 Test Loss: 1.374 Test Acc: 0.741
Validation loss decreased (-0.724310 --> -0.740527).  Saving model ...
Epoch: 13 cost time: 1.9859120845794678
Epoch: 13, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.261 Vali Acc: 0.765 Test Loss: 1.261 Test Acc: 0.765
Validation loss decreased (-0.740527 --> -0.764852).  Saving model ...
Epoch: 14 cost time: 2.172206163406372
Epoch: 14, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.167 Vali Acc: 0.786 Test Loss: 1.167 Test Acc: 0.786
Validation loss decreased (-0.764852 --> -0.786475).  Saving model ...
Epoch: 15 cost time: 2.1333062648773193
Epoch: 15, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.057 Vali Acc: 0.841 Test Loss: 1.057 Test Acc: 0.841
Validation loss decreased (-0.786475 --> -0.840530).  Saving model ...
Epoch: 16 cost time: 2.2749691009521484
Epoch: 16, Steps: 17 | Train Loss: 0.968 Vali Loss: 0.964 Vali Acc: 0.849 Test Loss: 0.964 Test Acc: 0.849
Validation loss decreased (-0.840530 --> -0.848639).  Saving model ...
Epoch: 17 cost time: 2.0912537574768066
Epoch: 17, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.870 Vali Acc: 0.854 Test Loss: 0.870 Test Acc: 0.854
Validation loss decreased (-0.848639 --> -0.854045).  Saving model ...
Epoch: 18 cost time: 2.1558539867401123
Epoch: 18, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.783 Vali Acc: 0.878 Test Loss: 0.783 Test Acc: 0.878
Validation loss decreased (-0.854045 --> -0.878371).  Saving model ...
Epoch: 19 cost time: 2.057481050491333
Epoch: 19, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.727 Vali Acc: 0.873 Test Loss: 0.727 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.862555980682373
Epoch: 20, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.667 Vali Acc: 0.884 Test Loss: 0.667 Test Acc: 0.884
Validation loss decreased (-0.878371 --> -0.883777).  Saving model ...
Epoch: 21 cost time: 1.7717339992523193
Epoch: 21, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.607 Vali Acc: 0.892 Test Loss: 0.607 Test Acc: 0.892
Validation loss decreased (-0.883777 --> -0.891886).  Saving model ...
Epoch: 22 cost time: 1.8281605243682861
Epoch: 22, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.572 Vali Acc: 0.895 Test Loss: 0.572 Test Acc: 0.895
Validation loss decreased (-0.891886 --> -0.894589).  Saving model ...
Epoch: 23 cost time: 1.7976579666137695
Epoch: 23, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.894589 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.9390854835510254
Epoch: 24, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.502 Vali Acc: 0.897 Test Loss: 0.502 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.390617847442627
Epoch: 25, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.472 Vali Acc: 0.908 Test Loss: 0.472 Test Acc: 0.908
Validation loss decreased (-0.899995 --> -0.908103).  Saving model ...
Epoch: 26 cost time: 2.496689558029175
Epoch: 26, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.447 Vali Acc: 0.905 Test Loss: 0.447 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2297537326812744
Epoch: 27, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.378 Vali Acc: 0.916 Test Loss: 0.378 Test Acc: 0.916
Validation loss decreased (-0.908103 --> -0.916212).  Saving model ...
Epoch: 28 cost time: 2.2772397994995117
Epoch: 28, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.34074330329895
Epoch: 29, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
Validation loss decreased (-0.916212 --> -0.918915).  Saving model ...
Epoch: 30 cost time: 1.9403235912322998
Epoch: 30, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.353 Vali Acc: 0.905 Test Loss: 0.353 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.918918918918919
model parameter : 131937
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.810364246368408
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.178 Vali Acc: 0.181 Test Loss: 2.178 Test Acc: 0.181
Validation loss decreased (inf --> -0.181059).  Saving model ...
Epoch: 2 cost time: 2.137251853942871
Epoch: 2, Steps: 17 | Train Loss: 2.133 Vali Loss: 2.138 Vali Acc: 0.224 Test Loss: 2.138 Test Acc: 0.224
Validation loss decreased (-0.181059 --> -0.224303).  Saving model ...
Epoch: 3 cost time: 2.177250862121582
Epoch: 3, Steps: 17 | Train Loss: 2.082 Vali Loss: 2.084 Vali Acc: 0.286 Test Loss: 2.084 Test Acc: 0.286
Validation loss decreased (-0.224303 --> -0.286466).  Saving model ...
Epoch: 4 cost time: 2.1632492542266846
Epoch: 4, Steps: 17 | Train Loss: 2.013 Vali Loss: 2.013 Vali Acc: 0.403 Test Loss: 2.013 Test Acc: 0.403
Validation loss decreased (-0.286466 --> -0.402683).  Saving model ...
Epoch: 5 cost time: 2.2131965160369873
Epoch: 5, Steps: 17 | Train Loss: 1.947 Vali Loss: 1.929 Vali Acc: 0.468 Test Loss: 1.929 Test Acc: 0.468
Validation loss decreased (-0.402683 --> -0.467548).  Saving model ...
Epoch: 6 cost time: 1.6059517860412598
Epoch: 6, Steps: 17 | Train Loss: 1.862 Vali Loss: 1.836 Vali Acc: 0.530 Test Loss: 1.836 Test Acc: 0.530
Validation loss decreased (-0.467548 --> -0.529711).  Saving model ...
Epoch: 7 cost time: 1.5962622165679932
Epoch: 7, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.741 Vali Acc: 0.589 Test Loss: 1.741 Test Acc: 0.589
Validation loss decreased (-0.529711 --> -0.589172).  Saving model ...
Epoch: 8 cost time: 1.6609244346618652
Epoch: 8, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.636 Vali Acc: 0.654 Test Loss: 1.636 Test Acc: 0.654
Validation loss decreased (-0.589172 --> -0.654038).  Saving model ...
Epoch: 9 cost time: 2.1415631771087646
Epoch: 9, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.537 Vali Acc: 0.695 Test Loss: 1.537 Test Acc: 0.695
Validation loss decreased (-0.654038 --> -0.694579).  Saving model ...
Epoch: 10 cost time: 2.158813238143921
Epoch: 10, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.444 Vali Acc: 0.697 Test Loss: 1.444 Test Acc: 0.697
Validation loss decreased (-0.694579 --> -0.697283).  Saving model ...
Epoch: 11 cost time: 2.175905466079712
Epoch: 11, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.352 Vali Acc: 0.722 Test Loss: 1.352 Test Acc: 0.722
Validation loss decreased (-0.697283 --> -0.721608).  Saving model ...
Epoch: 12 cost time: 2.0903022289276123
Epoch: 12, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.259 Vali Acc: 0.751 Test Loss: 1.259 Test Acc: 0.751
Validation loss decreased (-0.721608 --> -0.751339).  Saving model ...
Epoch: 13 cost time: 1.9669899940490723
Epoch: 13, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.183 Vali Acc: 0.759 Test Loss: 1.183 Test Acc: 0.759
Validation loss decreased (-0.751339 --> -0.759448).  Saving model ...
Epoch: 14 cost time: 2.0188379287719727
Epoch: 14, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.101 Vali Acc: 0.776 Test Loss: 1.101 Test Acc: 0.776
Validation loss decreased (-0.759448 --> -0.775665).  Saving model ...
Epoch: 15 cost time: 1.9848897457122803
Epoch: 15, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.017 Vali Acc: 0.800 Test Loss: 1.017 Test Acc: 0.800
Validation loss decreased (-0.775665 --> -0.799990).  Saving model ...
Epoch: 16 cost time: 1.9634990692138672
Epoch: 16, Steps: 17 | Train Loss: 0.876 Vali Loss: 0.942 Vali Acc: 0.795 Test Loss: 0.942 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.015857219696045
Epoch: 17, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.862 Vali Acc: 0.832 Test Loss: 0.862 Test Acc: 0.832
Validation loss decreased (-0.799990 --> -0.832424).  Saving model ...
Epoch: 18 cost time: 1.9994728565216064
Epoch: 18, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.805 Vali Acc: 0.832 Test Loss: 0.805 Test Acc: 0.832
Validation loss decreased (-0.832424 --> -0.832424).  Saving model ...
Epoch: 19 cost time: 1.8034682273864746
Epoch: 19, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.731 Vali Acc: 0.878 Test Loss: 0.731 Test Acc: 0.878
Validation loss decreased (-0.832424 --> -0.878371).  Saving model ...
Epoch: 20 cost time: 1.9182002544403076
Epoch: 20, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.675 Vali Acc: 0.886 Test Loss: 0.675 Test Acc: 0.886
Validation loss decreased (-0.878371 --> -0.886480).  Saving model ...
Epoch: 21 cost time: 1.955512285232544
Epoch: 21, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.630 Vali Acc: 0.884 Test Loss: 0.630 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9854977130889893
Epoch: 22, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.886480 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.970672369003296
Epoch: 23, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.520 Vali Acc: 0.905 Test Loss: 0.520 Test Acc: 0.905
Validation loss decreased (-0.899994 --> -0.905400).  Saving model ...
Epoch: 24 cost time: 2.0685815811157227
Epoch: 24, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.485 Vali Acc: 0.905 Test Loss: 0.485 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905401).  Saving model ...
Epoch: 25 cost time: 1.9703590869903564
Epoch: 25, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.448 Vali Acc: 0.903 Test Loss: 0.448 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.009190082550049
Epoch: 26, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.408 Vali Acc: 0.919 Test Loss: 0.408 Test Acc: 0.919
Validation loss decreased (-0.905401 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 1.9933390617370605
Epoch: 27, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 1.9863133430480957
Epoch: 28, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.347 Vali Acc: 0.946 Test Loss: 0.347 Test Acc: 0.946
Validation loss decreased (-0.918915 --> -0.945942).  Saving model ...
Epoch: 29 cost time: 2.1891701221466064
Epoch: 29, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.345 Vali Acc: 0.932 Test Loss: 0.345 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.208359479904175
Epoch: 30, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.307 Vali Acc: 0.946 Test Loss: 0.307 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 442449
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.556814432144165
Epoch: 1, Steps: 17 | Train Loss: 2.305 Vali Loss: 2.277 Vali Acc: 0.081 Test Loss: 2.277 Test Acc: 0.081
Validation loss decreased (inf --> -0.081058).  Saving model ...
Epoch: 2 cost time: 1.931952714920044
Epoch: 2, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.230 Vali Acc: 0.108 Test Loss: 2.230 Test Acc: 0.108
Validation loss decreased (-0.081058 --> -0.108086).  Saving model ...
Epoch: 3 cost time: 1.8809804916381836
Epoch: 3, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.168 Vali Acc: 0.143 Test Loss: 2.168 Test Acc: 0.143
Validation loss decreased (-0.108086 --> -0.143222).  Saving model ...
Epoch: 4 cost time: 1.8721654415130615
Epoch: 4, Steps: 17 | Train Loss: 2.133 Vali Loss: 2.096 Vali Acc: 0.219 Test Loss: 2.096 Test Acc: 0.219
Validation loss decreased (-0.143222 --> -0.218898).  Saving model ...
Epoch: 5 cost time: 1.9066894054412842
Epoch: 5, Steps: 17 | Train Loss: 2.048 Vali Loss: 2.018 Vali Acc: 0.281 Test Loss: 2.018 Test Acc: 0.281
Validation loss decreased (-0.218898 --> -0.281061).  Saving model ...
Epoch: 6 cost time: 1.739819049835205
Epoch: 6, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.936 Vali Acc: 0.373 Test Loss: 1.936 Test Acc: 0.373
Validation loss decreased (-0.281061 --> -0.372954).  Saving model ...
Epoch: 7 cost time: 1.7481367588043213
Epoch: 7, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.853 Vali Acc: 0.457 Test Loss: 1.853 Test Acc: 0.457
Validation loss decreased (-0.372954 --> -0.456738).  Saving model ...
Epoch: 8 cost time: 1.7147221565246582
Epoch: 8, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.770 Vali Acc: 0.522 Test Loss: 1.770 Test Acc: 0.522
Validation loss decreased (-0.456738 --> -0.521604).  Saving model ...
Epoch: 9 cost time: 1.8272395133972168
Epoch: 9, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.685 Vali Acc: 0.595 Test Loss: 1.685 Test Acc: 0.595
Validation loss decreased (-0.521604 --> -0.594578).  Saving model ...
Epoch: 10 cost time: 1.9226713180541992
Epoch: 10, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.596 Vali Acc: 0.649 Test Loss: 1.596 Test Acc: 0.649
Validation loss decreased (-0.594578 --> -0.648633).  Saving model ...
Epoch: 11 cost time: 1.7769489288330078
Epoch: 11, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.503 Vali Acc: 0.678 Test Loss: 1.503 Test Acc: 0.678
Validation loss decreased (-0.648633 --> -0.678363).  Saving model ...
Epoch: 12 cost time: 1.8622817993164062
Epoch: 12, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.417 Vali Acc: 0.692 Test Loss: 1.417 Test Acc: 0.692
Validation loss decreased (-0.678363 --> -0.691878).  Saving model ...
Epoch: 13 cost time: 1.8820745944976807
Epoch: 13, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.319 Vali Acc: 0.743 Test Loss: 1.319 Test Acc: 0.743
Validation loss decreased (-0.691878 --> -0.743230).  Saving model ...
Epoch: 14 cost time: 1.8592655658721924
Epoch: 14, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.231 Vali Acc: 0.751 Test Loss: 1.231 Test Acc: 0.751
Validation loss decreased (-0.743230 --> -0.751339).  Saving model ...
Epoch: 15 cost time: 1.8844490051269531
Epoch: 15, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.130 Vali Acc: 0.811 Test Loss: 1.130 Test Acc: 0.811
Validation loss decreased (-0.751339 --> -0.810800).  Saving model ...
Epoch: 16 cost time: 1.711334228515625
Epoch: 16, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.049 Vali Acc: 0.811 Test Loss: 1.049 Test Acc: 0.811
Validation loss decreased (-0.810800 --> -0.810800).  Saving model ...
Epoch: 17 cost time: 1.9874296188354492
Epoch: 17, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.960 Vali Acc: 0.830 Test Loss: 0.960 Test Acc: 0.830
Validation loss decreased (-0.810800 --> -0.829720).  Saving model ...
Epoch: 18 cost time: 1.986213207244873
Epoch: 18, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.877 Vali Acc: 0.846 Test Loss: 0.877 Test Acc: 0.846
Validation loss decreased (-0.829720 --> -0.845937).  Saving model ...
Epoch: 19 cost time: 1.9981310367584229
Epoch: 19, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.823 Vali Acc: 0.854 Test Loss: 0.823 Test Acc: 0.854
Validation loss decreased (-0.845937 --> -0.854046).  Saving model ...
Epoch: 20 cost time: 2.001415252685547
Epoch: 20, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.762 Vali Acc: 0.849 Test Loss: 0.762 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.036893367767334
Epoch: 21, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.690 Vali Acc: 0.884 Test Loss: 0.690 Test Acc: 0.884
Validation loss decreased (-0.854046 --> -0.883777).  Saving model ...
Epoch: 22 cost time: 2.0199806690216064
Epoch: 22, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.654 Vali Acc: 0.878 Test Loss: 0.654 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9622185230255127
Epoch: 23, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.600 Vali Acc: 0.895 Test Loss: 0.600 Test Acc: 0.895
Validation loss decreased (-0.883777 --> -0.894589).  Saving model ...
Epoch: 24 cost time: 2.0008246898651123
Epoch: 24, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.563 Vali Acc: 0.905 Test Loss: 0.563 Test Acc: 0.905
Validation loss decreased (-0.894589 --> -0.905400).  Saving model ...
Epoch: 25 cost time: 1.9008808135986328
Epoch: 25, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.532 Vali Acc: 0.905 Test Loss: 0.532 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905400).  Saving model ...
Epoch: 26 cost time: 1.90987229347229
Epoch: 26, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.497 Vali Acc: 0.905 Test Loss: 0.497 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905400).  Saving model ...
Epoch: 27 cost time: 1.7520480155944824
Epoch: 27, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.452 Vali Acc: 0.919 Test Loss: 0.452 Test Acc: 0.919
Validation loss decreased (-0.905400 --> -0.918914).  Saving model ...
Epoch: 28 cost time: 1.7273690700531006
Epoch: 28, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.432 Vali Acc: 0.908 Test Loss: 0.432 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.762807846069336
Epoch: 29, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.401 Vali Acc: 0.911 Test Loss: 0.401 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7239365577697754
Epoch: 30, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.372 Vali Acc: 0.924 Test Loss: 0.372 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924321).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 131937
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.528529405593872
Epoch: 1, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.204 Vali Acc: 0.119 Test Loss: 2.204 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 2.9225778579711914
Epoch: 2, Steps: 17 | Train Loss: 2.170 Vali Loss: 2.159 Vali Acc: 0.200 Test Loss: 2.159 Test Acc: 0.200
Validation loss decreased (-0.118897 --> -0.199978).  Saving model ...
Epoch: 3 cost time: 2.950099468231201
Epoch: 3, Steps: 17 | Train Loss: 2.124 Vali Loss: 2.101 Vali Acc: 0.257 Test Loss: 2.101 Test Acc: 0.257
Validation loss decreased (-0.199978 --> -0.256736).  Saving model ...
Epoch: 4 cost time: 3.178529977798462
Epoch: 4, Steps: 17 | Train Loss: 2.063 Vali Loss: 2.032 Vali Acc: 0.332 Test Loss: 2.032 Test Acc: 0.332
Validation loss decreased (-0.256736 --> -0.332412).  Saving model ...
Epoch: 5 cost time: 3.160635232925415
Epoch: 5, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.954 Vali Acc: 0.430 Test Loss: 1.954 Test Acc: 0.430
Validation loss decreased (-0.332412 --> -0.429710).  Saving model ...
Epoch: 6 cost time: 3.1663639545440674
Epoch: 6, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.865 Vali Acc: 0.489 Test Loss: 1.865 Test Acc: 0.489
Validation loss decreased (-0.429710 --> -0.489171).  Saving model ...
Epoch: 7 cost time: 3.2452151775360107
Epoch: 7, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.769 Vali Acc: 0.532 Test Loss: 1.769 Test Acc: 0.532
Validation loss decreased (-0.489171 --> -0.532415).  Saving model ...
Epoch: 8 cost time: 3.1455705165863037
Epoch: 8, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.667 Vali Acc: 0.581 Test Loss: 1.667 Test Acc: 0.581
Validation loss decreased (-0.532415 --> -0.581064).  Saving model ...
Epoch: 9 cost time: 3.2527382373809814
Epoch: 9, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.557 Vali Acc: 0.611 Test Loss: 1.557 Test Acc: 0.611
Validation loss decreased (-0.581064 --> -0.610795).  Saving model ...
Epoch: 10 cost time: 3.133608102798462
Epoch: 10, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.443 Vali Acc: 0.641 Test Loss: 1.443 Test Acc: 0.641
Validation loss decreased (-0.610795 --> -0.640526).  Saving model ...
Epoch: 11 cost time: 2.8043084144592285
Epoch: 11, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.332 Vali Acc: 0.676 Test Loss: 1.332 Test Acc: 0.676
Validation loss decreased (-0.640526 --> -0.675662).  Saving model ...
Epoch: 12 cost time: 2.8070027828216553
Epoch: 12, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.227 Vali Acc: 0.719 Test Loss: 1.227 Test Acc: 0.719
Validation loss decreased (-0.675662 --> -0.718907).  Saving model ...
Epoch: 13 cost time: 2.789830446243286
Epoch: 13, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.136 Vali Acc: 0.735 Test Loss: 1.136 Test Acc: 0.735
Validation loss decreased (-0.718907 --> -0.735124).  Saving model ...
Epoch: 14 cost time: 2.8319616317749023
Epoch: 14, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.043 Vali Acc: 0.741 Test Loss: 1.043 Test Acc: 0.741
Validation loss decreased (-0.735124 --> -0.740530).  Saving model ...
Epoch: 15 cost time: 2.8507332801818848
Epoch: 15, Steps: 17 | Train Loss: 0.898 Vali Loss: 0.967 Vali Acc: 0.781 Test Loss: 0.967 Test Acc: 0.781
Validation loss decreased (-0.740530 --> -0.781071).  Saving model ...
Epoch: 16 cost time: 2.986147880554199
Epoch: 16, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.888 Vali Acc: 0.808 Test Loss: 0.888 Test Acc: 0.808
Validation loss decreased (-0.781071 --> -0.808099).  Saving model ...
Epoch: 17 cost time: 2.900543451309204
Epoch: 17, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.818 Vali Acc: 0.816 Test Loss: 0.818 Test Acc: 0.816
Validation loss decreased (-0.808099 --> -0.816208).  Saving model ...
Epoch: 18 cost time: 3.23919939994812
Epoch: 18, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.742 Vali Acc: 0.838 Test Loss: 0.742 Test Acc: 0.838
Validation loss decreased (-0.816208 --> -0.837830).  Saving model ...
Epoch: 19 cost time: 3.207606315612793
Epoch: 19, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.691 Vali Acc: 0.849 Test Loss: 0.691 Test Acc: 0.849
Validation loss decreased (-0.837830 --> -0.848642).  Saving model ...
Epoch: 20 cost time: 3.232365369796753
Epoch: 20, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.627 Vali Acc: 0.865 Test Loss: 0.627 Test Acc: 0.865
Validation loss decreased (-0.848642 --> -0.864859).  Saving model ...
Epoch: 21 cost time: 3.1737401485443115
Epoch: 21, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
Validation loss decreased (-0.864859 --> -0.878373).  Saving model ...
Epoch: 22 cost time: 3.204287052154541
Epoch: 22, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.542 Vali Acc: 0.873 Test Loss: 0.542 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2028119564056396
Epoch: 23, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.491 Vali Acc: 0.892 Test Loss: 0.491 Test Acc: 0.892
Validation loss decreased (-0.878373 --> -0.891887).  Saving model ...
Epoch: 24 cost time: 3.216212034225464
Epoch: 24, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
Validation loss decreased (-0.891887 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 3.039637327194214
Epoch: 25, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.438 Vali Acc: 0.897 Test Loss: 0.438 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.720723867416382
Epoch: 26, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.8379781246185303
Epoch: 27, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.370 Vali Acc: 0.908 Test Loss: 0.370 Test Acc: 0.908
Validation loss decreased (-0.899995 --> -0.908104).  Saving model ...
Epoch: 28 cost time: 2.676833152770996
Epoch: 28, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
Validation loss decreased (-0.908104 --> -0.918916).  Saving model ...
Epoch: 29 cost time: 2.7767584323883057
Epoch: 29, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.344 Vali Acc: 0.905 Test Loss: 0.344 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7438690662384033
Epoch: 30, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
Validation loss decreased (-0.918916 --> -0.918916).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.918918918918919
model parameter : 222513
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.4938225746154785
Epoch: 1, Steps: 17 | Train Loss: 2.267 Vali Loss: 2.240 Vali Acc: 0.073 Test Loss: 2.240 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 2.932809591293335
Epoch: 2, Steps: 17 | Train Loss: 2.230 Vali Loss: 2.197 Vali Acc: 0.092 Test Loss: 2.197 Test Acc: 0.092
Validation loss decreased (-0.072951 --> -0.091870).  Saving model ...
Epoch: 3 cost time: 2.964310646057129
Epoch: 3, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.142 Vali Acc: 0.119 Test Loss: 2.142 Test Acc: 0.119
Validation loss decreased (-0.091870 --> -0.118897).  Saving model ...
Epoch: 4 cost time: 2.989330530166626
Epoch: 4, Steps: 17 | Train Loss: 2.106 Vali Loss: 2.077 Vali Acc: 0.178 Test Loss: 2.077 Test Acc: 0.178
Validation loss decreased (-0.118897 --> -0.178358).  Saving model ...
Epoch: 5 cost time: 2.9913268089294434
Epoch: 5, Steps: 17 | Train Loss: 2.019 Vali Loss: 2.004 Vali Acc: 0.295 Test Loss: 2.004 Test Acc: 0.295
Validation loss decreased (-0.178358 --> -0.294575).  Saving model ...
Epoch: 6 cost time: 2.815655469894409
Epoch: 6, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.923 Vali Acc: 0.435 Test Loss: 1.923 Test Acc: 0.435
Validation loss decreased (-0.294575 --> -0.435116).  Saving model ...
Epoch: 7 cost time: 2.825827121734619
Epoch: 7, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.836 Vali Acc: 0.486 Test Loss: 1.836 Test Acc: 0.486
Validation loss decreased (-0.435116 --> -0.486468).  Saving model ...
Epoch: 8 cost time: 2.713351249694824
Epoch: 8, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.746 Vali Acc: 0.543 Test Loss: 1.746 Test Acc: 0.543
Validation loss decreased (-0.486468 --> -0.543226).  Saving model ...
Epoch: 9 cost time: 2.8446719646453857
Epoch: 9, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.649 Vali Acc: 0.581 Test Loss: 1.649 Test Acc: 0.581
Validation loss decreased (-0.543226 --> -0.581065).  Saving model ...
Epoch: 10 cost time: 2.631796360015869
Epoch: 10, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.551 Vali Acc: 0.632 Test Loss: 1.551 Test Acc: 0.632
Validation loss decreased (-0.581065 --> -0.632417).  Saving model ...
Epoch: 11 cost time: 2.5701050758361816
Epoch: 11, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.454 Vali Acc: 0.651 Test Loss: 1.454 Test Acc: 0.651
Validation loss decreased (-0.632417 --> -0.651337).  Saving model ...
Epoch: 12 cost time: 2.510136127471924
Epoch: 12, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.357 Vali Acc: 0.697 Test Loss: 1.357 Test Acc: 0.697
Validation loss decreased (-0.651337 --> -0.697284).  Saving model ...
Epoch: 13 cost time: 2.5654807090759277
Epoch: 13, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.258 Vali Acc: 0.732 Test Loss: 1.258 Test Acc: 0.732
Validation loss decreased (-0.697284 --> -0.732420).  Saving model ...
Epoch: 14 cost time: 2.6009020805358887
Epoch: 14, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.164 Vali Acc: 0.738 Test Loss: 1.164 Test Acc: 0.738
Validation loss decreased (-0.732420 --> -0.737826).  Saving model ...
Epoch: 15 cost time: 2.7433581352233887
Epoch: 15, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.077 Vali Acc: 0.741 Test Loss: 1.077 Test Acc: 0.741
Validation loss decreased (-0.737826 --> -0.740530).  Saving model ...
Epoch: 16 cost time: 2.8700942993164062
Epoch: 16, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.995 Vali Acc: 0.768 Test Loss: 0.995 Test Acc: 0.768
Validation loss decreased (-0.740530 --> -0.767558).  Saving model ...
Epoch: 17 cost time: 2.9853665828704834
Epoch: 17, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.907 Vali Acc: 0.781 Test Loss: 0.907 Test Acc: 0.781
Validation loss decreased (-0.767558 --> -0.781072).  Saving model ...
Epoch: 18 cost time: 3.0235376358032227
Epoch: 18, Steps: 17 | Train Loss: 0.756 Vali Loss: 0.837 Vali Acc: 0.797 Test Loss: 0.837 Test Acc: 0.797
Validation loss decreased (-0.781072 --> -0.797289).  Saving model ...
Epoch: 19 cost time: 3.0038375854492188
Epoch: 19, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.771 Vali Acc: 0.816 Test Loss: 0.771 Test Acc: 0.816
Validation loss decreased (-0.797289 --> -0.816209).  Saving model ...
Epoch: 20 cost time: 2.910888195037842
Epoch: 20, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.707 Vali Acc: 0.832 Test Loss: 0.707 Test Acc: 0.832
Validation loss decreased (-0.816209 --> -0.832425).  Saving model ...
Epoch: 21 cost time: 3.0476062297821045
Epoch: 21, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.656 Vali Acc: 0.851 Test Loss: 0.656 Test Acc: 0.851
Validation loss decreased (-0.832425 --> -0.851345).  Saving model ...
Epoch: 22 cost time: 2.729344367980957
Epoch: 22, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.588 Vali Acc: 0.862 Test Loss: 0.588 Test Acc: 0.862
Validation loss decreased (-0.851345 --> -0.862156).  Saving model ...
Epoch: 23 cost time: 2.7400190830230713
Epoch: 23, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.571 Vali Acc: 0.870 Test Loss: 0.571 Test Acc: 0.870
Validation loss decreased (-0.862156 --> -0.870265).  Saving model ...
Epoch: 24 cost time: 2.8177027702331543
Epoch: 24, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.497 Vali Acc: 0.892 Test Loss: 0.497 Test Acc: 0.892
Validation loss decreased (-0.870265 --> -0.891887).  Saving model ...
Epoch: 25 cost time: 2.586367607116699
Epoch: 25, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6013083457946777
Epoch: 26, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.438 Vali Acc: 0.903 Test Loss: 0.438 Test Acc: 0.903
Validation loss decreased (-0.891887 --> -0.902698).  Saving model ...
Epoch: 27 cost time: 2.575042724609375
Epoch: 27, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5179800987243652
Epoch: 28, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.577080249786377
Epoch: 29, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.377 Vali Acc: 0.905 Test Loss: 0.377 Test Acc: 0.905
Validation loss decreased (-0.902698 --> -0.905402).  Saving model ...
Epoch: 30 cost time: 2.8151371479034424
Epoch: 30, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.343 Vali Acc: 0.905 Test Loss: 0.343 Test Acc: 0.905
Validation loss decreased (-0.905402 --> -0.905402).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9054054054054054
model parameter : 67233
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.224802494049072
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.203 Vali Acc: 0.122 Test Loss: 2.203 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 2.7451539039611816
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.159 Vali Acc: 0.197 Test Loss: 2.159 Test Acc: 0.197
Validation loss decreased (-0.121600 --> -0.197276).  Saving model ...
Epoch: 3 cost time: 2.7201554775238037
Epoch: 3, Steps: 17 | Train Loss: 2.125 Vali Loss: 2.102 Vali Acc: 0.251 Test Loss: 2.102 Test Acc: 0.251
Validation loss decreased (-0.197276 --> -0.251330).  Saving model ...
Epoch: 4 cost time: 2.6932590007781982
Epoch: 4, Steps: 17 | Train Loss: 2.066 Vali Loss: 2.033 Vali Acc: 0.332 Test Loss: 2.033 Test Acc: 0.332
Validation loss decreased (-0.251330 --> -0.332412).  Saving model ...
Epoch: 5 cost time: 2.7407870292663574
Epoch: 5, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.955 Vali Acc: 0.427 Test Loss: 1.955 Test Acc: 0.427
Validation loss decreased (-0.332412 --> -0.427007).  Saving model ...
Epoch: 6 cost time: 2.4143624305725098
Epoch: 6, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.866 Vali Acc: 0.497 Test Loss: 1.866 Test Acc: 0.497
Validation loss decreased (-0.427007 --> -0.497279).  Saving model ...
Epoch: 7 cost time: 2.6208181381225586
Epoch: 7, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.771 Vali Acc: 0.535 Test Loss: 1.771 Test Acc: 0.535
Validation loss decreased (-0.497279 --> -0.535117).  Saving model ...
Epoch: 8 cost time: 2.662416696548462
Epoch: 8, Steps: 17 | Train Loss: 1.696 Vali Loss: 1.674 Vali Acc: 0.595 Test Loss: 1.674 Test Acc: 0.595
Validation loss decreased (-0.535117 --> -0.594578).  Saving model ...
Epoch: 9 cost time: 2.621739625930786
Epoch: 9, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.575 Vali Acc: 0.630 Test Loss: 1.575 Test Acc: 0.630
Validation loss decreased (-0.594578 --> -0.629714).  Saving model ...
Epoch: 10 cost time: 2.7048375606536865
Epoch: 10, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.468 Vali Acc: 0.659 Test Loss: 1.468 Test Acc: 0.659
Validation loss decreased (-0.629714 --> -0.659445).  Saving model ...
Epoch: 11 cost time: 2.503955841064453
Epoch: 11, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.360 Vali Acc: 0.697 Test Loss: 1.360 Test Acc: 0.697
Validation loss decreased (-0.659445 --> -0.697284).  Saving model ...
Epoch: 12 cost time: 2.4495742321014404
Epoch: 12, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.254 Vali Acc: 0.732 Test Loss: 1.254 Test Acc: 0.732
Validation loss decreased (-0.697284 --> -0.732420).  Saving model ...
Epoch: 13 cost time: 2.2629926204681396
Epoch: 13, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.156 Vali Acc: 0.765 Test Loss: 1.156 Test Acc: 0.765
Validation loss decreased (-0.732420 --> -0.764853).  Saving model ...
Epoch: 14 cost time: 2.5566506385803223
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.059 Vali Acc: 0.765 Test Loss: 1.059 Test Acc: 0.765
Validation loss decreased (-0.764853 --> -0.764854).  Saving model ...
Epoch: 15 cost time: 2.207872152328491
Epoch: 15, Steps: 17 | Train Loss: 0.946 Vali Loss: 0.979 Vali Acc: 0.792 Test Loss: 0.979 Test Acc: 0.792
Validation loss decreased (-0.764854 --> -0.791882).  Saving model ...
Epoch: 16 cost time: 2.560892105102539
Epoch: 16, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.891 Vali Acc: 0.819 Test Loss: 0.891 Test Acc: 0.819
Validation loss decreased (-0.791882 --> -0.818910).  Saving model ...
Epoch: 17 cost time: 2.5889737606048584
Epoch: 17, Steps: 17 | Train Loss: 0.777 Vali Loss: 0.834 Vali Acc: 0.816 Test Loss: 0.834 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.497119426727295
Epoch: 18, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.759 Vali Acc: 0.832 Test Loss: 0.759 Test Acc: 0.832
Validation loss decreased (-0.818910 --> -0.832425).  Saving model ...
Epoch: 19 cost time: 2.4420182704925537
Epoch: 19, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.692 Vali Acc: 0.868 Test Loss: 0.692 Test Acc: 0.868
Validation loss decreased (-0.832425 --> -0.867561).  Saving model ...
Epoch: 20 cost time: 2.6768975257873535
Epoch: 20, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.637 Vali Acc: 0.878 Test Loss: 0.637 Test Acc: 0.878
Validation loss decreased (-0.867561 --> -0.878372).  Saving model ...
Epoch: 21 cost time: 2.5135138034820557
Epoch: 21, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.599 Vali Acc: 0.881 Test Loss: 0.599 Test Acc: 0.881
Validation loss decreased (-0.878372 --> -0.881075).  Saving model ...
Epoch: 22 cost time: 2.4668021202087402
Epoch: 22, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.557 Vali Acc: 0.884 Test Loss: 0.557 Test Acc: 0.884
Validation loss decreased (-0.881075 --> -0.883778).  Saving model ...
Epoch: 23 cost time: 2.469562530517578
Epoch: 23, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.883778 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 2.3699073791503906
Epoch: 24, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.470 Vali Acc: 0.903 Test Loss: 0.470 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902698).  Saving model ...
Epoch: 25 cost time: 2.3798556327819824
Epoch: 25, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.457 Vali Acc: 0.914 Test Loss: 0.457 Test Acc: 0.914
Validation loss decreased (-0.902698 --> -0.913509).  Saving model ...
Epoch: 26 cost time: 2.36893892288208
Epoch: 26, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.409 Vali Acc: 0.916 Test Loss: 0.409 Test Acc: 0.916
Validation loss decreased (-0.913509 --> -0.916212).  Saving model ...
Epoch: 27 cost time: 2.476925849914551
Epoch: 27, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.390 Vali Acc: 0.924 Test Loss: 0.390 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924320).  Saving model ...
Epoch: 28 cost time: 2.4282071590423584
Epoch: 28, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9982223510742188
Epoch: 29, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3376927375793457
Epoch: 30, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.348 Vali Acc: 0.914 Test Loss: 0.348 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 222513
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7212629318237305
Epoch: 1, Steps: 17 | Train Loss: 2.267 Vali Loss: 2.240 Vali Acc: 0.073 Test Loss: 2.240 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 2.2822389602661133
Epoch: 2, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.198 Vali Acc: 0.092 Test Loss: 2.198 Test Acc: 0.092
Validation loss decreased (-0.072951 --> -0.091870).  Saving model ...
Epoch: 3 cost time: 2.3433585166931152
Epoch: 3, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.143 Vali Acc: 0.122 Test Loss: 2.143 Test Acc: 0.122
Validation loss decreased (-0.091870 --> -0.121600).  Saving model ...
Epoch: 4 cost time: 2.3908116817474365
Epoch: 4, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.078 Vali Acc: 0.178 Test Loss: 2.078 Test Acc: 0.178
Validation loss decreased (-0.121600 --> -0.178358).  Saving model ...
Epoch: 5 cost time: 2.011770486831665
Epoch: 5, Steps: 17 | Train Loss: 2.021 Vali Loss: 2.005 Vali Acc: 0.292 Test Loss: 2.005 Test Acc: 0.292
Validation loss decreased (-0.178358 --> -0.291872).  Saving model ...
Epoch: 6 cost time: 2.048809289932251
Epoch: 6, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.924 Vali Acc: 0.435 Test Loss: 1.924 Test Acc: 0.435
Validation loss decreased (-0.291872 --> -0.435116).  Saving model ...
Epoch: 7 cost time: 2.2139174938201904
Epoch: 7, Steps: 17 | Train Loss: 1.858 Vali Loss: 1.837 Vali Acc: 0.486 Test Loss: 1.837 Test Acc: 0.486
Validation loss decreased (-0.435116 --> -0.486468).  Saving model ...
Epoch: 8 cost time: 2.153175115585327
Epoch: 8, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.746 Vali Acc: 0.546 Test Loss: 1.746 Test Acc: 0.546
Validation loss decreased (-0.486468 --> -0.545928).  Saving model ...
Epoch: 9 cost time: 1.9991991519927979
Epoch: 9, Steps: 17 | Train Loss: 1.655 Vali Loss: 1.649 Vali Acc: 0.584 Test Loss: 1.649 Test Acc: 0.584
Validation loss decreased (-0.545928 --> -0.583767).  Saving model ...
Epoch: 10 cost time: 2.102078676223755
Epoch: 10, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.550 Vali Acc: 0.632 Test Loss: 1.550 Test Acc: 0.632
Validation loss decreased (-0.583767 --> -0.632417).  Saving model ...
Epoch: 11 cost time: 2.254356861114502
Epoch: 11, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.453 Vali Acc: 0.649 Test Loss: 1.453 Test Acc: 0.649
Validation loss decreased (-0.632417 --> -0.648634).  Saving model ...
Epoch: 12 cost time: 2.1538069248199463
Epoch: 12, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.357 Vali Acc: 0.686 Test Loss: 1.357 Test Acc: 0.686
Validation loss decreased (-0.648634 --> -0.686473).  Saving model ...
Epoch: 13 cost time: 2.071425676345825
Epoch: 13, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.258 Vali Acc: 0.722 Test Loss: 1.258 Test Acc: 0.722
Validation loss decreased (-0.686473 --> -0.721609).  Saving model ...
Epoch: 14 cost time: 2.2130351066589355
Epoch: 14, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.166 Vali Acc: 0.741 Test Loss: 1.166 Test Acc: 0.741
Validation loss decreased (-0.721609 --> -0.740529).  Saving model ...
Epoch: 15 cost time: 2.212759494781494
Epoch: 15, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.083 Vali Acc: 0.749 Test Loss: 1.083 Test Acc: 0.749
Validation loss decreased (-0.740529 --> -0.748638).  Saving model ...
Epoch: 16 cost time: 2.222806692123413
Epoch: 16, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.005 Vali Acc: 0.762 Test Loss: 1.005 Test Acc: 0.762
Validation loss decreased (-0.748638 --> -0.762152).  Saving model ...
Epoch: 17 cost time: 2.2275588512420654
Epoch: 17, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.925 Vali Acc: 0.784 Test Loss: 0.925 Test Acc: 0.784
Validation loss decreased (-0.762152 --> -0.783775).  Saving model ...
Epoch: 18 cost time: 2.172915458679199
Epoch: 18, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.858 Vali Acc: 0.803 Test Loss: 0.858 Test Acc: 0.803
Validation loss decreased (-0.783775 --> -0.802694).  Saving model ...
Epoch: 19 cost time: 2.1841094493865967
Epoch: 19, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.791 Vali Acc: 0.832 Test Loss: 0.791 Test Acc: 0.832
Validation loss decreased (-0.802694 --> -0.832425).  Saving model ...
Epoch: 20 cost time: 2.2302072048187256
Epoch: 20, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.724 Vali Acc: 0.849 Test Loss: 0.724 Test Acc: 0.849
Validation loss decreased (-0.832425 --> -0.848641).  Saving model ...
Epoch: 21 cost time: 2.2245161533355713
Epoch: 21, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.669 Vali Acc: 0.865 Test Loss: 0.669 Test Acc: 0.865
Validation loss decreased (-0.848641 --> -0.864858).  Saving model ...
Epoch: 22 cost time: 2.221341848373413
Epoch: 22, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.620 Vali Acc: 0.878 Test Loss: 0.620 Test Acc: 0.878
Validation loss decreased (-0.864858 --> -0.878372).  Saving model ...
Epoch: 23 cost time: 2.1691813468933105
Epoch: 23, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.568 Vali Acc: 0.884 Test Loss: 0.568 Test Acc: 0.884
Validation loss decreased (-0.878372 --> -0.883778).  Saving model ...
Epoch: 24 cost time: 2.1456825733184814
Epoch: 24, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.536 Vali Acc: 0.903 Test Loss: 0.536 Test Acc: 0.903
Validation loss decreased (-0.883778 --> -0.902697).  Saving model ...
Epoch: 25 cost time: 2.3061091899871826
Epoch: 25, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.500 Vali Acc: 0.905 Test Loss: 0.500 Test Acc: 0.905
Validation loss decreased (-0.902697 --> -0.905400).  Saving model ...
Epoch: 26 cost time: 2.1246840953826904
Epoch: 26, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.467 Vali Acc: 0.911 Test Loss: 0.467 Test Acc: 0.911
Validation loss decreased (-0.905400 --> -0.910806).  Saving model ...
Epoch: 27 cost time: 2.212367057800293
Epoch: 27, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.430 Vali Acc: 0.916 Test Loss: 0.430 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916212).  Saving model ...
Epoch: 28 cost time: 2.2199318408966064
Epoch: 28, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.401 Vali Acc: 0.924 Test Loss: 0.401 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924320).  Saving model ...
Epoch: 29 cost time: 2.065845012664795
Epoch: 29, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.384 Vali Acc: 0.916 Test Loss: 0.384 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.300877571105957
Epoch: 30, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 67233
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3421850204467773
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.204 Vali Acc: 0.122 Test Loss: 2.204 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 1.8707301616668701
Epoch: 2, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.162 Vali Acc: 0.186 Test Loss: 2.162 Test Acc: 0.186
Validation loss decreased (-0.121600 --> -0.186465).  Saving model ...
Epoch: 3 cost time: 1.890773057937622
Epoch: 3, Steps: 17 | Train Loss: 2.127 Vali Loss: 2.107 Vali Acc: 0.243 Test Loss: 2.107 Test Acc: 0.243
Validation loss decreased (-0.186465 --> -0.243222).  Saving model ...
Epoch: 4 cost time: 1.8579914569854736
Epoch: 4, Steps: 17 | Train Loss: 2.070 Vali Loss: 2.041 Vali Acc: 0.324 Test Loss: 2.041 Test Acc: 0.324
Validation loss decreased (-0.243222 --> -0.324304).  Saving model ...
Epoch: 5 cost time: 1.8247957229614258
Epoch: 5, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.969 Vali Acc: 0.405 Test Loss: 1.969 Test Acc: 0.405
Validation loss decreased (-0.324304 --> -0.405386).  Saving model ...
Epoch: 6 cost time: 2.031352996826172
Epoch: 6, Steps: 17 | Train Loss: 1.924 Vali Loss: 1.888 Vali Acc: 0.484 Test Loss: 1.888 Test Acc: 0.484
Validation loss decreased (-0.405386 --> -0.483765).  Saving model ...
Epoch: 7 cost time: 1.805243730545044
Epoch: 7, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.804 Vali Acc: 0.530 Test Loss: 1.804 Test Acc: 0.530
Validation loss decreased (-0.483765 --> -0.529712).  Saving model ...
Epoch: 8 cost time: 1.9206008911132812
Epoch: 8, Steps: 17 | Train Loss: 1.721 Vali Loss: 1.716 Vali Acc: 0.586 Test Loss: 1.716 Test Acc: 0.586
Validation loss decreased (-0.529712 --> -0.586469).  Saving model ...
Epoch: 9 cost time: 1.802626371383667
Epoch: 9, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.625 Vali Acc: 0.614 Test Loss: 1.625 Test Acc: 0.614
Validation loss decreased (-0.586469 --> -0.613497).  Saving model ...
Epoch: 10 cost time: 1.9112656116485596
Epoch: 10, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.526 Vali Acc: 0.646 Test Loss: 1.526 Test Acc: 0.646
Validation loss decreased (-0.613497 --> -0.645931).  Saving model ...
Epoch: 11 cost time: 1.779735803604126
Epoch: 11, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.422 Vali Acc: 0.668 Test Loss: 1.422 Test Acc: 0.668
Validation loss decreased (-0.645931 --> -0.667553).  Saving model ...
Epoch: 12 cost time: 1.9410321712493896
Epoch: 12, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.323 Vali Acc: 0.724 Test Loss: 1.323 Test Acc: 0.724
Validation loss decreased (-0.667553 --> -0.724311).  Saving model ...
Epoch: 13 cost time: 1.9975438117980957
Epoch: 13, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.234 Vali Acc: 0.743 Test Loss: 1.234 Test Acc: 0.743
Validation loss decreased (-0.724311 --> -0.743231).  Saving model ...
Epoch: 14 cost time: 1.8705546855926514
Epoch: 14, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.141 Vali Acc: 0.759 Test Loss: 1.141 Test Acc: 0.759
Validation loss decreased (-0.743231 --> -0.759448).  Saving model ...
Epoch: 15 cost time: 1.7767605781555176
Epoch: 15, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.059 Vali Acc: 0.781 Test Loss: 1.059 Test Acc: 0.781
Validation loss decreased (-0.759448 --> -0.781070).  Saving model ...
Epoch: 16 cost time: 2.0315303802490234
Epoch: 16, Steps: 17 | Train Loss: 0.946 Vali Loss: 0.977 Vali Acc: 0.814 Test Loss: 0.977 Test Acc: 0.814
Validation loss decreased (-0.781070 --> -0.813504).  Saving model ...
Epoch: 17 cost time: 2.01762318611145
Epoch: 17, Steps: 17 | Train Loss: 0.865 Vali Loss: 0.914 Vali Acc: 0.808 Test Loss: 0.914 Test Acc: 0.808
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1069657802581787
Epoch: 18, Steps: 17 | Train Loss: 0.807 Vali Loss: 0.840 Vali Acc: 0.835 Test Loss: 0.840 Test Acc: 0.835
Validation loss decreased (-0.813504 --> -0.835127).  Saving model ...
Epoch: 19 cost time: 2.0965166091918945
Epoch: 19, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.772 Vali Acc: 0.862 Test Loss: 0.772 Test Acc: 0.862
Validation loss decreased (-0.835127 --> -0.862154).  Saving model ...
Epoch: 20 cost time: 1.9534938335418701
Epoch: 20, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.710 Vali Acc: 0.870 Test Loss: 0.710 Test Acc: 0.870
Validation loss decreased (-0.862154 --> -0.870263).  Saving model ...
Epoch: 21 cost time: 1.9694082736968994
Epoch: 21, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.656 Vali Acc: 0.884 Test Loss: 0.656 Test Acc: 0.884
Validation loss decreased (-0.870263 --> -0.883777).  Saving model ...
Epoch: 22 cost time: 1.9036598205566406
Epoch: 22, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.608 Vali Acc: 0.876 Test Loss: 0.608 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.890721321105957
Epoch: 23, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.883777 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.8947117328643799
Epoch: 24, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.504 Vali Acc: 0.903 Test Loss: 0.504 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902698).  Saving model ...
Epoch: 25 cost time: 1.8726344108581543
Epoch: 25, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.464 Vali Acc: 0.911 Test Loss: 0.464 Test Acc: 0.911
Validation loss decreased (-0.902698 --> -0.910806).  Saving model ...
Epoch: 26 cost time: 1.7029521465301514
Epoch: 26, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.429 Vali Acc: 0.919 Test Loss: 0.429 Test Acc: 0.919
Validation loss decreased (-0.910806 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 1.9030203819274902
Epoch: 27, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 28 cost time: 1.8758020401000977
Epoch: 28, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.358 Vali Acc: 0.927 Test Loss: 0.358 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927023).  Saving model ...
Epoch: 29 cost time: 1.9482271671295166
Epoch: 29, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 30 cost time: 1.779453992843628
Epoch: 30, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.327 Vali Acc: 0.924 Test Loss: 0.327 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9297297297297298
model parameter : 222513
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.135748863220215
Epoch: 1, Steps: 17 | Train Loss: 2.267 Vali Loss: 2.240 Vali Acc: 0.073 Test Loss: 2.240 Test Acc: 0.073
Validation loss decreased (inf --> -0.072951).  Saving model ...
Epoch: 2 cost time: 1.7222480773925781
Epoch: 2, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.198 Vali Acc: 0.089 Test Loss: 2.198 Test Acc: 0.089
Validation loss decreased (-0.072951 --> -0.089167).  Saving model ...
Epoch: 3 cost time: 2.030681848526001
Epoch: 3, Steps: 17 | Train Loss: 2.177 Vali Loss: 2.143 Vali Acc: 0.119 Test Loss: 2.143 Test Acc: 0.119
Validation loss decreased (-0.089167 --> -0.118897).  Saving model ...
Epoch: 4 cost time: 1.8118870258331299
Epoch: 4, Steps: 17 | Train Loss: 2.108 Vali Loss: 2.079 Vali Acc: 0.181 Test Loss: 2.079 Test Acc: 0.181
Validation loss decreased (-0.118897 --> -0.181060).  Saving model ...
Epoch: 5 cost time: 1.891754150390625
Epoch: 5, Steps: 17 | Train Loss: 2.022 Vali Loss: 2.007 Vali Acc: 0.286 Test Loss: 2.007 Test Acc: 0.286
Validation loss decreased (-0.181060 --> -0.286466).  Saving model ...
Epoch: 6 cost time: 1.8483340740203857
Epoch: 6, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.926 Vali Acc: 0.427 Test Loss: 1.926 Test Acc: 0.427
Validation loss decreased (-0.286466 --> -0.427008).  Saving model ...
Epoch: 7 cost time: 1.830930471420288
Epoch: 7, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.839 Vali Acc: 0.486 Test Loss: 1.839 Test Acc: 0.486
Validation loss decreased (-0.427008 --> -0.486468).  Saving model ...
Epoch: 8 cost time: 1.75105619430542
Epoch: 8, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.748 Vali Acc: 0.541 Test Loss: 1.748 Test Acc: 0.541
Validation loss decreased (-0.486468 --> -0.540523).  Saving model ...
Epoch: 9 cost time: 1.7514946460723877
Epoch: 9, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.651 Vali Acc: 0.584 Test Loss: 1.651 Test Acc: 0.584
Validation loss decreased (-0.540523 --> -0.583767).  Saving model ...
Epoch: 10 cost time: 1.752462387084961
Epoch: 10, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.553 Vali Acc: 0.624 Test Loss: 1.553 Test Acc: 0.624
Validation loss decreased (-0.583767 --> -0.624309).  Saving model ...
Epoch: 11 cost time: 1.6629488468170166
Epoch: 11, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.456 Vali Acc: 0.641 Test Loss: 1.456 Test Acc: 0.641
Validation loss decreased (-0.624309 --> -0.640526).  Saving model ...
Epoch: 12 cost time: 1.7761385440826416
Epoch: 12, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.360 Vali Acc: 0.678 Test Loss: 1.360 Test Acc: 0.678
Validation loss decreased (-0.640526 --> -0.678365).  Saving model ...
Epoch: 13 cost time: 1.6307222843170166
Epoch: 13, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.263 Vali Acc: 0.711 Test Loss: 1.263 Test Acc: 0.711
Validation loss decreased (-0.678365 --> -0.710798).  Saving model ...
Epoch: 14 cost time: 1.58854079246521
Epoch: 14, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.174 Vali Acc: 0.719 Test Loss: 1.174 Test Acc: 0.719
Validation loss decreased (-0.710798 --> -0.718907).  Saving model ...
Epoch: 15 cost time: 1.8312013149261475
Epoch: 15, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.094 Vali Acc: 0.724 Test Loss: 1.094 Test Acc: 0.724
Validation loss decreased (-0.718907 --> -0.724313).  Saving model ...
Epoch: 16 cost time: 1.8146421909332275
Epoch: 16, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.020 Vali Acc: 0.751 Test Loss: 1.020 Test Acc: 0.751
Validation loss decreased (-0.724313 --> -0.751341).  Saving model ...
Epoch: 17 cost time: 1.5788557529449463
Epoch: 17, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.947 Vali Acc: 0.773 Test Loss: 0.947 Test Acc: 0.773
Validation loss decreased (-0.751341 --> -0.772963).  Saving model ...
Epoch: 18 cost time: 1.381406545639038
Epoch: 18, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.889 Vali Acc: 0.797 Test Loss: 0.889 Test Acc: 0.797
Validation loss decreased (-0.772963 --> -0.797288).  Saving model ...
Epoch: 19 cost time: 1.9049875736236572
Epoch: 19, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
Validation loss decreased (-0.797288 --> -0.818911).  Saving model ...
Epoch: 20 cost time: 1.9098033905029297
Epoch: 20, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.769 Vali Acc: 0.835 Test Loss: 0.769 Test Acc: 0.835
Validation loss decreased (-0.818911 --> -0.835127).  Saving model ...
Epoch: 21 cost time: 1.9138188362121582
Epoch: 21, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.723 Vali Acc: 0.849 Test Loss: 0.723 Test Acc: 0.849
Validation loss decreased (-0.835127 --> -0.848641).  Saving model ...
Epoch: 22 cost time: 2.0645241737365723
Epoch: 22, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.682 Vali Acc: 0.862 Test Loss: 0.682 Test Acc: 0.862
Validation loss decreased (-0.848641 --> -0.862155).  Saving model ...
Epoch: 23 cost time: 2.0636093616485596
Epoch: 23, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.640 Vali Acc: 0.865 Test Loss: 0.640 Test Acc: 0.865
Validation loss decreased (-0.862155 --> -0.864858).  Saving model ...
Epoch: 24 cost time: 2.0533008575439453
Epoch: 24, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.603 Vali Acc: 0.873 Test Loss: 0.603 Test Acc: 0.873
Validation loss decreased (-0.864858 --> -0.872967).  Saving model ...
Epoch: 25 cost time: 2.058861017227173
Epoch: 25, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
Validation loss decreased (-0.872967 --> -0.878373).  Saving model ...
Epoch: 26 cost time: 2.048910140991211
Epoch: 26, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.538 Vali Acc: 0.884 Test Loss: 0.538 Test Acc: 0.884
Validation loss decreased (-0.878373 --> -0.883778).  Saving model ...
Epoch: 27 cost time: 2.046421527862549
Epoch: 27, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
Validation loss decreased (-0.883778 --> -0.889184).  Saving model ...
Epoch: 28 cost time: 2.0932457447052
Epoch: 28, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.477 Vali Acc: 0.895 Test Loss: 0.477 Test Acc: 0.895
Validation loss decreased (-0.889184 --> -0.894590).  Saving model ...
Epoch: 29 cost time: 1.9331903457641602
Epoch: 29, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8554201126098633
Epoch: 30, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.431 Vali Acc: 0.895 Test Loss: 0.431 Test Acc: 0.895
Validation loss decreased (-0.894590 --> -0.894590).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.8945945945945946
model parameter : 67233
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 16.20297932624817
Epoch: 1, Steps: 17 | Train Loss: 2.065 Vali Loss: 1.800 Vali Acc: 0.519 Test Loss: 1.800 Test Acc: 0.519
Validation loss decreased (inf --> -0.518901).  Saving model ...
Epoch: 2 cost time: 14.09965205192566
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.034 Vali Acc: 0.868 Test Loss: 1.034 Test Acc: 0.868
Validation loss decreased (-0.518901 --> -0.867557).  Saving model ...
Epoch: 3 cost time: 18.296459674835205
Epoch: 3, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.448 Vali Acc: 0.935 Test Loss: 0.448 Test Acc: 0.935
Validation loss decreased (-0.867557 --> -0.935131).  Saving model ...
Epoch: 4 cost time: 18.001495361328125
Epoch: 4, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.226 Vali Acc: 0.951 Test Loss: 0.226 Test Acc: 0.951
Validation loss decreased (-0.935131 --> -0.951349).  Saving model ...
Epoch: 5 cost time: 17.25544023513794
Epoch: 5, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.774454593658447
Epoch: 6, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.931260585784912
Epoch: 7, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 17.936030387878418
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.159844875335693
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.255 Vali Acc: 0.905 Test Loss: 0.255 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.97979736328125
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.94085669517517
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.1720929145813
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 17.677622318267822
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 17.7364022731781
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.61576247215271
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.644709825515747
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.827581644058228
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.892827033996582
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 18.334263563156128
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 18.458228588104248
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 18.380866050720215
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.38753604888916
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 17.370806455612183
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 37529993
model size : 145.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.602522373199463
Epoch: 1, Steps: 17 | Train Loss: 2.079 Vali Loss: 1.800 Vali Acc: 0.570 Test Loss: 1.800 Test Acc: 0.570
Validation loss decreased (inf --> -0.570252).  Saving model ...
Epoch: 2 cost time: 5.764569044113159
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.056 Vali Acc: 0.889 Test Loss: 1.056 Test Acc: 0.889
Validation loss decreased (-0.570252 --> -0.889179).  Saving model ...
Epoch: 3 cost time: 5.750768184661865
Epoch: 3, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.516 Vali Acc: 0.924 Test Loss: 0.516 Test Acc: 0.924
Validation loss decreased (-0.889179 --> -0.924319).  Saving model ...
Epoch: 4 cost time: 5.8205976486206055
Epoch: 4, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 5.716142892837524
Epoch: 5, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 5.814594745635986
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.137 Vali Acc: 0.949 Test Loss: 0.137 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 6.1503212451934814
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.859426736831665
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.948647 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 5.807260036468506
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.828612565994263
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 5.884070158004761
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.776056528091431
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.968 Test Loss: 0.075 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.796553134918213
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.965 Test Loss: 0.075 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.869736433029175
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.962 Test Loss: 0.079 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.621190547943115
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.965 Test Loss: 0.071 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.128486633300781
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.962 Test Loss: 0.081 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.158442497253418
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970270).  Saving model ...
Epoch: 18 cost time: 6.233278751373291
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.965 Test Loss: 0.078 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.1883580684661865
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.965 Test Loss: 0.072 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.0654144287109375
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.965 Test Loss: 0.080 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.2031450271606445
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.965 Test Loss: 0.079 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.898082971572876
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.965 Test Loss: 0.076 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.508440256118774
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.968 Test Loss: 0.075 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.488249778747559
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.968 Test Loss: 0.072 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.519663572311401
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.968 Test Loss: 0.075 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.5195841789245605
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.965 Test Loss: 0.078 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.612666845321655
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
Validation loss decreased (-0.970270 --> -0.970270).  Saving model ...
Epoch: 28 cost time: 5.918483018875122
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.862023591995239
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.643900632858276
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 11051913
model size : 44.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 14.533874988555908
Epoch: 1, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.801 Vali Acc: 0.519 Test Loss: 1.801 Test Acc: 0.519
Validation loss decreased (inf --> -0.518901).  Saving model ...
Epoch: 2 cost time: 13.136855840682983
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.035 Vali Acc: 0.862 Test Loss: 1.035 Test Acc: 0.862
Validation loss decreased (-0.518901 --> -0.862152).  Saving model ...
Epoch: 3 cost time: 13.156057119369507
Epoch: 3, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.447 Vali Acc: 0.938 Test Loss: 0.447 Test Acc: 0.938
Validation loss decreased (-0.862152 --> -0.937833).  Saving model ...
Epoch: 4 cost time: 12.909221172332764
Epoch: 4, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.225 Vali Acc: 0.954 Test Loss: 0.225 Test Acc: 0.954
Validation loss decreased (-0.937833 --> -0.954052).  Saving model ...
Epoch: 5 cost time: 11.733105421066284
Epoch: 5, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.35602879524231
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.142 Vali Acc: 0.943 Test Loss: 0.142 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.097510814666748
Epoch: 7, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 10.969353675842285
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.463905096054077
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.092427253723145
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 12.008582353591919
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.334 Vali Acc: 0.895 Test Loss: 0.334 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.072617769241333
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.523334980010986
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.422344207763672
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 11.473917484283447
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 11.587576150894165
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.101913452148438
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.647576093673706
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.29266357421875
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.446030139923096
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.641964435577393
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 11.221858739852905
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.47347903251648
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 11.342623472213745
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.917516231536865
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 37529993
model size : 145.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.085902690887451
Epoch: 1, Steps: 17 | Train Loss: 2.079 Vali Loss: 1.801 Vali Acc: 0.570 Test Loss: 1.801 Test Acc: 0.570
Validation loss decreased (inf --> -0.570252).  Saving model ...
Epoch: 2 cost time: 4.304117918014526
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.057 Vali Acc: 0.892 Test Loss: 1.057 Test Acc: 0.892
Validation loss decreased (-0.570252 --> -0.891881).  Saving model ...
Epoch: 3 cost time: 4.426631212234497
Epoch: 3, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.516 Vali Acc: 0.924 Test Loss: 0.516 Test Acc: 0.924
Validation loss decreased (-0.891881 --> -0.924319).  Saving model ...
Epoch: 4 cost time: 4.432785511016846
Epoch: 4, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 4.4306321144104
Epoch: 5, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 4.09882926940918
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 4.174907922744751
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9497339725494385
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.954053 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 3.8775100708007812
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8356728553771973
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 3.7535226345062256
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8938181400299072
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.968 Test Loss: 0.076 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8806169033050537
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.965 Test Loss: 0.075 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8599095344543457
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.962 Test Loss: 0.079 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7118430137634277
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.962 Test Loss: 0.071 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.466671466827393
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.962 Test Loss: 0.080 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.389824151992798
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.965 Test Loss: 0.074 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.378422260284424
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.962 Test Loss: 0.077 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.169298887252808
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.962 Test Loss: 0.072 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.3721325397491455
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.962 Test Loss: 0.080 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 11051913
model size : 44.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.801897287368774
Epoch: 1, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.816 Vali Acc: 0.514 Test Loss: 1.816 Test Acc: 0.514
Validation loss decreased (inf --> -0.513495).  Saving model ...
Epoch: 2 cost time: 6.854421138763428
Epoch: 2, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.126 Vali Acc: 0.884 Test Loss: 1.126 Test Acc: 0.884
Validation loss decreased (-0.513495 --> -0.883773).  Saving model ...
Epoch: 3 cost time: 6.952442169189453
Epoch: 3, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.517 Vali Acc: 0.946 Test Loss: 0.517 Test Acc: 0.946
Validation loss decreased (-0.883773 --> -0.945941).  Saving model ...
Epoch: 4 cost time: 6.962335824966431
Epoch: 4, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.296 Vali Acc: 0.954 Test Loss: 0.296 Test Acc: 0.954
Validation loss decreased (-0.945941 --> -0.954051).  Saving model ...
Epoch: 5 cost time: 6.960357666015625
Epoch: 5, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 7.041059255599976
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.936218738555908
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.956755 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 7.493248701095581
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.1423211097717285
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.109513998031616
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.004108190536499
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.147200584411621
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.01482892036438
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.117810249328613
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.451319217681885
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 7.467097282409668
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.370917797088623
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.965 Test Loss: 0.086 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.383322238922119
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.968 Test Loss: 0.081 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.464529991149902
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.968 Test Loss: 0.079 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.451997995376587
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.712242841720581
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.900594711303711
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.939225912094116
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.980489730834961
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.923662424087524
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 37529993
model size : 145.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.8028740882873535
Epoch: 1, Steps: 17 | Train Loss: 2.083 Vali Loss: 1.823 Vali Acc: 0.530 Test Loss: 1.823 Test Acc: 0.530
Validation loss decreased (inf --> -0.529711).  Saving model ...
Epoch: 2 cost time: 3.183302164077759
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.147 Vali Acc: 0.884 Test Loss: 1.147 Test Acc: 0.884
Validation loss decreased (-0.529711 --> -0.883772).  Saving model ...
Epoch: 3 cost time: 3.12638258934021
Epoch: 3, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.596 Vali Acc: 0.930 Test Loss: 0.596 Test Acc: 0.930
Validation loss decreased (-0.883772 --> -0.929724).  Saving model ...
Epoch: 4 cost time: 2.9413809776306152
Epoch: 4, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.302 Vali Acc: 0.951 Test Loss: 0.302 Test Acc: 0.951
Validation loss decreased (-0.929724 --> -0.951348).  Saving model ...
Epoch: 5 cost time: 2.9506969451904297
Epoch: 5, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.209 Vali Acc: 0.954 Test Loss: 0.209 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 2.991661310195923
Epoch: 6, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 2.974196434020996
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9488258361816406
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 3.0514612197875977
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9179368019104004
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.001020669937134
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.950913906097412
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1485042572021484
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.968 Test Loss: 0.077 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2453365325927734
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 3.3296027183532715
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.282378673553467
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3642144203186035
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.348508358001709
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.428386688232422
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4254443645477295
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.425673246383667
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.968 Test Loss: 0.075 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.3235552310943604
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3685131072998047
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.1607728004455566
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.973 Test Loss: 0.070 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 11051913
model size : 44.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 10.79754090309143
Epoch: 1, Steps: 17 | Train Loss: 2.115 Vali Loss: 1.904 Vali Acc: 0.430 Test Loss: 1.904 Test Acc: 0.430
Validation loss decreased (inf --> -0.429711).  Saving model ...
Epoch: 2 cost time: 9.050889253616333
Epoch: 2, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.229 Vali Acc: 0.841 Test Loss: 1.229 Test Acc: 0.841
Validation loss decreased (-0.429711 --> -0.840528).  Saving model ...
Epoch: 3 cost time: 9.08510684967041
Epoch: 3, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.567 Vali Acc: 0.908 Test Loss: 0.567 Test Acc: 0.908
Validation loss decreased (-0.840528 --> -0.908102).  Saving model ...
Epoch: 4 cost time: 9.715869903564453
Epoch: 4, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.304 Vali Acc: 0.938 Test Loss: 0.304 Test Acc: 0.938
Validation loss decreased (-0.908102 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 8.760672092437744
Epoch: 5, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.937835 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 9.010728359222412
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 9.006253719329834
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.426743030548096
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 8.954848766326904
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 8.835026264190674
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 8.989242315292358
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 9.523379564285278
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.46779203414917
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.430830240249634
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 9.498593807220459
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.973 Test Loss: 0.068 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.061929941177368
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 8.869343042373657
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.186291456222534
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.359158992767334
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 8.72154188156128
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.795315027236938
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.978 Test Loss: 0.060 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.41997766494751
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.419068336486816
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.976 Test Loss: 0.064 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 9.137557983398438
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 8.829183101654053
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.729188919067383
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 27 cost time: 8.81596302986145
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.916920900344849
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 9.42292046546936
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 30 cost time: 9.74692416191101
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 18785161
model size : 74.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.051645517349243
Epoch: 1, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.849 Vali Acc: 0.649 Test Loss: 1.849 Test Acc: 0.649
Validation loss decreased (inf --> -0.648630).  Saving model ...
Epoch: 2 cost time: 3.2216148376464844
Epoch: 2, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.218 Vali Acc: 0.886 Test Loss: 1.218 Test Acc: 0.886
Validation loss decreased (-0.648630 --> -0.886474).  Saving model ...
Epoch: 3 cost time: 3.4071288108825684
Epoch: 3, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.612 Vali Acc: 0.903 Test Loss: 0.612 Test Acc: 0.903
Validation loss decreased (-0.886474 --> -0.902697).  Saving model ...
Epoch: 4 cost time: 3.3697609901428223
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.347 Vali Acc: 0.927 Test Loss: 0.347 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 3.328312873840332
Epoch: 5, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 3.5426435470581055
Epoch: 6, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 3.5491058826446533
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.945944 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 3.5348525047302246
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.512733221054077
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 3.7707390785217285
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8123979568481445
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.807817220687866
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7157416343688965
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 3.7939789295196533
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7000434398651123
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8232905864715576
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8016715049743652
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3648934364318848
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6120355129241943
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.584195375442505
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.590731143951416
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4887592792510986
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.515587568283081
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 5545865
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.56107759475708
Epoch: 1, Steps: 17 | Train Loss: 2.115 Vali Loss: 1.905 Vali Acc: 0.430 Test Loss: 1.905 Test Acc: 0.430
Validation loss decreased (inf --> -0.429711).  Saving model ...
Epoch: 2 cost time: 6.265082359313965
Epoch: 2, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.232 Vali Acc: 0.841 Test Loss: 1.232 Test Acc: 0.841
Validation loss decreased (-0.429711 --> -0.840528).  Saving model ...
Epoch: 3 cost time: 6.333362340927124
Epoch: 3, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.568 Vali Acc: 0.911 Test Loss: 0.568 Test Acc: 0.911
Validation loss decreased (-0.840528 --> -0.910805).  Saving model ...
Epoch: 4 cost time: 6.347170114517212
Epoch: 4, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
Validation loss decreased (-0.910805 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 6.464869976043701
Epoch: 5, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.935132 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 6.576652765274048
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.272732496261597
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 6.373430013656616
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 9 cost time: 6.192229270935059
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 5.596295595169067
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.970 Test Loss: 0.072 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.833866596221924
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 5.764259576797485
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.968 Test Loss: 0.080 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.261117458343506
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.447745084762573
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 6.349271774291992
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.968 Test Loss: 0.071 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.385720252990723
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.976 Test Loss: 0.067 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.140426397323608
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.632146596908569
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.976 Test Loss: 0.064 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.5309295654296875
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 20 cost time: 5.453890323638916
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.403990983963013
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.252828121185303
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.976 Test Loss: 0.063 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.516380786895752
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.973 Test Loss: 0.066 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.309542894363403
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.98579478263855
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.356235027313232
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.186396598815918
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.246963024139404
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.175745725631714
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 18785161
model size : 74.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.021636724472046
Epoch: 1, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.850 Vali Acc: 0.649 Test Loss: 1.850 Test Acc: 0.649
Validation loss decreased (inf --> -0.648630).  Saving model ...
Epoch: 2 cost time: 2.414534091949463
Epoch: 2, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.219 Vali Acc: 0.886 Test Loss: 1.219 Test Acc: 0.886
Validation loss decreased (-0.648630 --> -0.886474).  Saving model ...
Epoch: 3 cost time: 2.613332986831665
Epoch: 3, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.612 Vali Acc: 0.903 Test Loss: 0.612 Test Acc: 0.903
Validation loss decreased (-0.886474 --> -0.902697).  Saving model ...
Epoch: 4 cost time: 2.539783239364624
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.348 Vali Acc: 0.927 Test Loss: 0.348 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 2.4273738861083984
Epoch: 5, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.452434778213501
Epoch: 6, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 2.6828532218933105
Epoch: 7, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 2.745222806930542
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6603939533233643
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.6648194789886475
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6288833618164062
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4020142555236816
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6444997787475586
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.5534145832061768
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.489713191986084
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.065300464630127
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5490760803222656
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2636234760284424
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.628504514694214
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5790913105010986
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.517646074295044
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.577420949935913
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.597527265548706
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 5545865
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.697016716003418
Epoch: 1, Steps: 17 | Train Loss: 2.117 Vali Loss: 1.914 Vali Acc: 0.416 Test Loss: 1.914 Test Acc: 0.416
Validation loss decreased (inf --> -0.416197).  Saving model ...
Epoch: 2 cost time: 3.503200054168701
Epoch: 2, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.290 Vali Acc: 0.824 Test Loss: 1.290 Test Acc: 0.824
Validation loss decreased (-0.416197 --> -0.824311).  Saving model ...
Epoch: 3 cost time: 3.567514657974243
Epoch: 3, Steps: 17 | Train Loss: 0.937 Vali Loss: 0.661 Vali Acc: 0.895 Test Loss: 0.661 Test Acc: 0.895
Validation loss decreased (-0.824311 --> -0.894588).  Saving model ...
Epoch: 4 cost time: 3.3730127811431885
Epoch: 4, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.358 Vali Acc: 0.951 Test Loss: 0.358 Test Acc: 0.951
Validation loss decreased (-0.894588 --> -0.951348).  Saving model ...
Epoch: 5 cost time: 3.4316389560699463
Epoch: 5, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.951348 --> -0.972971).  Saving model ...
Epoch: 6 cost time: 2.7324020862579346
Epoch: 6, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.733975887298584
Epoch: 7, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4675662517547607
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 3.4935684204101562
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.459350109100342
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 3.5565624237060547
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 3.6078147888183594
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2114920616149902
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1023666858673096
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.125040292739868
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.994614601135254
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0846145153045654
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.883920907974243
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.137082815170288
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3463664054870605
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.3051564693450928
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 18785161
model size : 74.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2683722972869873
Epoch: 1, Steps: 17 | Train Loss: 2.071 Vali Loss: 1.860 Vali Acc: 0.627 Test Loss: 1.860 Test Acc: 0.627
Validation loss decreased (inf --> -0.627008).  Saving model ...
Epoch: 2 cost time: 1.8053956031799316
Epoch: 2, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.267 Vali Acc: 0.859 Test Loss: 1.267 Test Acc: 0.859
Validation loss decreased (-0.627008 --> -0.859447).  Saving model ...
Epoch: 3 cost time: 1.6293423175811768
Epoch: 3, Steps: 17 | Train Loss: 0.950 Vali Loss: 0.697 Vali Acc: 0.908 Test Loss: 0.697 Test Acc: 0.908
Validation loss decreased (-0.859447 --> -0.908101).  Saving model ...
Epoch: 4 cost time: 1.6300339698791504
Epoch: 4, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.394 Vali Acc: 0.927 Test Loss: 0.394 Test Acc: 0.927
Validation loss decreased (-0.908101 --> -0.927023).  Saving model ...
Epoch: 5 cost time: 1.6147112846374512
Epoch: 5, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.927023 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 1.6775195598602295
Epoch: 6, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
Validation loss decreased (-0.940538 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 1.6871147155761719
Epoch: 7, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975674).  Saving model ...
Epoch: 8 cost time: 1.618100643157959
Epoch: 8, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6446213722229004
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6939005851745605
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.65653395652771
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8250184059143066
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7906341552734375
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.76344895362854
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.8157379627227783
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7841708660125732
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7885310649871826
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7929658889770508
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8052332401275635
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5762872695922852
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6543104648590088
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6852455139160156
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.968 Test Loss: 0.083 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6026902198791504
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7063076496124268
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 5545865
model size : 23.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.456493377685547
Epoch: 1, Steps: 17 | Train Loss: 2.142 Vali Loss: 1.964 Vali Acc: 0.495 Test Loss: 1.964 Test Acc: 0.495
Validation loss decreased (inf --> -0.494575).  Saving model ...
Epoch: 2 cost time: 10.51785945892334
Epoch: 2, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.468 Vali Acc: 0.795 Test Loss: 1.468 Test Acc: 0.795
Validation loss decreased (-0.494575 --> -0.794580).  Saving model ...
Epoch: 3 cost time: 10.547951698303223
Epoch: 3, Steps: 17 | Train Loss: 1.214 Vali Loss: 0.985 Vali Acc: 0.832 Test Loss: 0.985 Test Acc: 0.832
Validation loss decreased (-0.794580 --> -0.832423).  Saving model ...
Epoch: 4 cost time: 9.136091709136963
Epoch: 4, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.640 Vali Acc: 0.908 Test Loss: 0.640 Test Acc: 0.908
Validation loss decreased (-0.832423 --> -0.908102).  Saving model ...
Epoch: 5 cost time: 10.07861042022705
Epoch: 5, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.378 Vali Acc: 0.932 Test Loss: 0.378 Test Acc: 0.932
Validation loss decreased (-0.908102 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 10.538387775421143
Epoch: 6, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.281 Vali Acc: 0.954 Test Loss: 0.281 Test Acc: 0.954
Validation loss decreased (-0.932429 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 10.507503032684326
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.153874397277832
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.877789735794067
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.877259254455566
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954053).  Saving model ...
Epoch: 11 cost time: 10.85370659828186
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 10.813112497329712
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.593214511871338
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 9.359250545501709
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 9.872333765029907
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 10.69739842414856
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 10.827803611755371
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.597370386123657
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.9517080783844
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.861611127853394
Epoch: 20, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.746196269989014
Epoch: 21, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.01086711883545
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.658324718475342
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.927 Test Loss: 0.219 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 9.800315618515015
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.938 Test Loss: 0.208 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 10.512345552444458
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 9.629732847213745
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.542 Vali Acc: 0.876 Test Loss: 0.542 Test Acc: 0.876
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 18766537
model size : 72.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.35222864151001
Epoch: 1, Steps: 17 | Train Loss: 2.065 Vali Loss: 1.941 Vali Acc: 0.411 Test Loss: 1.941 Test Acc: 0.411
Validation loss decreased (inf --> -0.410791).  Saving model ...
Epoch: 2 cost time: 3.650965929031372
Epoch: 2, Steps: 17 | Train Loss: 1.732 Vali Loss: 1.504 Vali Acc: 0.830 Test Loss: 1.504 Test Acc: 0.830
Validation loss decreased (-0.410791 --> -0.829715).  Saving model ...
Epoch: 3 cost time: 4.223394393920898
Epoch: 3, Steps: 17 | Train Loss: 1.238 Vali Loss: 0.983 Vali Acc: 0.892 Test Loss: 0.983 Test Acc: 0.892
Validation loss decreased (-0.829715 --> -0.891882).  Saving model ...
Epoch: 4 cost time: 4.085393667221069
Epoch: 4, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.622 Vali Acc: 0.919 Test Loss: 0.622 Test Acc: 0.919
Validation loss decreased (-0.891882 --> -0.918913).  Saving model ...
Epoch: 5 cost time: 4.03085470199585
Epoch: 5, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.382 Vali Acc: 0.951 Test Loss: 0.382 Test Acc: 0.951
Validation loss decreased (-0.918913 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 4.097416162490845
Epoch: 6, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.280 Vali Acc: 0.946 Test Loss: 0.280 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0175886154174805
Epoch: 7, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7292213439941406
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 9 cost time: 3.723266124725342
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.951349 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 3.6122474670410156
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7485435009002686
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7654709815979004
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.9566991329193115
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.175069093704224
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.127019882202148
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 3.7689685821533203
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 3.775686502456665
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.64875864982605
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3331644535064697
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.534482955932617
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.4079222679138184
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.511528968811035
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.081125497817993
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.024007081985474
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.0390541553497314
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.121315956115723
Epoch: 26, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.615 Vali Acc: 0.827 Test Loss: 0.615 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 5526985
model size : 22.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.595976114273071
Epoch: 1, Steps: 17 | Train Loss: 2.142 Vali Loss: 1.965 Vali Acc: 0.495 Test Loss: 1.965 Test Acc: 0.495
Validation loss decreased (inf --> -0.494575).  Saving model ...
Epoch: 2 cost time: 6.879917144775391
Epoch: 2, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.468 Vali Acc: 0.795 Test Loss: 1.468 Test Acc: 0.795
Validation loss decreased (-0.494575 --> -0.794580).  Saving model ...
Epoch: 3 cost time: 7.506640195846558
Epoch: 3, Steps: 17 | Train Loss: 1.214 Vali Loss: 0.986 Vali Acc: 0.832 Test Loss: 0.986 Test Acc: 0.832
Validation loss decreased (-0.794580 --> -0.832423).  Saving model ...
Epoch: 4 cost time: 7.86441969871521
Epoch: 4, Steps: 17 | Train Loss: 0.756 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
Validation loss decreased (-0.832423 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 7.452263832092285
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.377 Vali Acc: 0.935 Test Loss: 0.377 Test Acc: 0.935
Validation loss decreased (-0.899994 --> -0.935131).  Saving model ...
Epoch: 6 cost time: 6.993597984313965
Epoch: 6, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.283 Vali Acc: 0.951 Test Loss: 0.283 Test Acc: 0.951
Validation loss decreased (-0.935131 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 6.784630060195923
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.213 Vali Acc: 0.949 Test Loss: 0.213 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.9082417488098145
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 6.552595853805542
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 6.952472686767578
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.031107187271118
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.125837564468384
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.6834189891815186
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.321056842803955
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.307451248168945
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.866318464279175
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.0513482093811035
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.626039743423462
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.243277311325073
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.935 Test Loss: 0.217 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 18766537
model size : 72.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.878033399581909
Epoch: 1, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.942 Vali Acc: 0.411 Test Loss: 1.942 Test Acc: 0.411
Validation loss decreased (inf --> -0.410791).  Saving model ...
Epoch: 2 cost time: 2.7089645862579346
Epoch: 2, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.505 Vali Acc: 0.830 Test Loss: 1.505 Test Acc: 0.830
Validation loss decreased (-0.410791 --> -0.829715).  Saving model ...
Epoch: 3 cost time: 2.6113181114196777
Epoch: 3, Steps: 17 | Train Loss: 1.239 Vali Loss: 0.983 Vali Acc: 0.892 Test Loss: 0.983 Test Acc: 0.892
Validation loss decreased (-0.829715 --> -0.891882).  Saving model ...
Epoch: 4 cost time: 2.6690781116485596
Epoch: 4, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.622 Vali Acc: 0.919 Test Loss: 0.622 Test Acc: 0.919
Validation loss decreased (-0.891882 --> -0.918913).  Saving model ...
Epoch: 5 cost time: 2.7983005046844482
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.383 Vali Acc: 0.951 Test Loss: 0.383 Test Acc: 0.951
Validation loss decreased (-0.918913 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 2.8710711002349854
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.279 Vali Acc: 0.946 Test Loss: 0.279 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.611600637435913
Epoch: 7, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.678718090057373
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.64933705329895
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.951348 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.361126184463501
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5046472549438477
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5048625469207764
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6607534885406494
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.677772283554077
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.5522775650024414
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 2.6301186084747314
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 2.5969126224517822
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.313492774963379
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2046685218811035
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.331275224685669
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4448204040527344
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5032477378845215
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4215664863586426
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7601876258850098
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.742508888244629
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.775010585784912
Epoch: 26, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.376 Vali Acc: 0.886 Test Loss: 0.376 Test Acc: 0.886
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 5526985
model size : 22.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.0192015171051025
Epoch: 1, Steps: 17 | Train Loss: 2.145 Vali Loss: 1.983 Vali Acc: 0.449 Test Loss: 1.983 Test Acc: 0.449
Validation loss decreased (inf --> -0.448629).  Saving model ...
Epoch: 2 cost time: 3.5126960277557373
Epoch: 2, Steps: 17 | Train Loss: 1.799 Vali Loss: 1.550 Vali Acc: 0.770 Test Loss: 1.550 Test Acc: 0.770
Validation loss decreased (-0.448629 --> -0.770255).  Saving model ...
Epoch: 3 cost time: 3.0583465099334717
Epoch: 3, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.093 Vali Acc: 0.827 Test Loss: 1.093 Test Acc: 0.827
Validation loss decreased (-0.770255 --> -0.827016).  Saving model ...
Epoch: 4 cost time: 3.5272929668426514
Epoch: 4, Steps: 17 | Train Loss: 0.865 Vali Loss: 0.725 Vali Acc: 0.905 Test Loss: 0.725 Test Acc: 0.905
Validation loss decreased (-0.827016 --> -0.905398).  Saving model ...
Epoch: 5 cost time: 3.3234474658966064
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.474 Vali Acc: 0.922 Test Loss: 0.474 Test Acc: 0.922
Validation loss decreased (-0.905398 --> -0.921617).  Saving model ...
Epoch: 6 cost time: 3.973999500274658
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.327 Vali Acc: 0.957 Test Loss: 0.327 Test Acc: 0.957
Validation loss decreased (-0.921617 --> -0.956753).  Saving model ...
Epoch: 7 cost time: 4.03290319442749
Epoch: 7, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.971041440963745
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9985716342926025
Epoch: 9, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.956753 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 3.7045810222625732
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 3.478044271469116
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6037724018096924
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 3.4525043964385986
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 3.321053981781006
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6322293281555176
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.717054843902588
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5048534870147705
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.0396342277526855
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.663848638534546
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.640162706375122
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.631294012069702
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.6334216594696045
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.7996933460235596
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 24 cost time: 4.090680837631226
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.870673894882202
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7498867511749268
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7265400886535645
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2645325660705566
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.4814682006835938
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.612262010574341
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 18766537
model size : 72.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.574556350708008
Epoch: 1, Steps: 17 | Train Loss: 2.067 Vali Loss: 1.950 Vali Acc: 0.397 Test Loss: 1.950 Test Acc: 0.397
Validation loss decreased (inf --> -0.397278).  Saving model ...
Epoch: 2 cost time: 2.077012538909912
Epoch: 2, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.543 Vali Acc: 0.800 Test Loss: 1.543 Test Acc: 0.800
Validation loss decreased (-0.397278 --> -0.799985).  Saving model ...
Epoch: 3 cost time: 1.9638571739196777
Epoch: 3, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.086 Vali Acc: 0.886 Test Loss: 1.086 Test Acc: 0.886
Validation loss decreased (-0.799985 --> -0.886476).  Saving model ...
Epoch: 4 cost time: 2.1152212619781494
Epoch: 4, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.718 Vali Acc: 0.938 Test Loss: 0.718 Test Acc: 0.938
Validation loss decreased (-0.886476 --> -0.937831).  Saving model ...
Epoch: 5 cost time: 1.891860008239746
Epoch: 5, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.472 Vali Acc: 0.951 Test Loss: 0.472 Test Acc: 0.951
Validation loss decreased (-0.937831 --> -0.951347).  Saving model ...
Epoch: 6 cost time: 2.1628482341766357
Epoch: 6, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.335 Vali Acc: 0.965 Test Loss: 0.335 Test Acc: 0.965
Validation loss decreased (-0.951347 --> -0.964862).  Saving model ...
Epoch: 7 cost time: 1.8518640995025635
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.255 Vali Acc: 0.954 Test Loss: 0.255 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7053325176239014
Epoch: 8, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.202 Vali Acc: 0.965 Test Loss: 0.202 Test Acc: 0.965
Validation loss decreased (-0.964862 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 1.5974695682525635
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972971).  Saving model ...
Epoch: 10 cost time: 1.8838849067687988
Epoch: 10, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.709151268005371
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8069629669189453
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8621129989624023
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.0419962406158447
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0296201705932617
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.216038942337036
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1220862865448
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0829529762268066
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9904108047485352
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9107766151428223
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.868666648864746
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8659732341766357
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.867809772491455
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 5526985
model size : 22.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.171926021575928
Epoch: 1, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.086 Vali Acc: 0.216 Test Loss: 2.086 Test Acc: 0.216
Validation loss decreased (inf --> -0.216195).  Saving model ...
Epoch: 2 cost time: 4.881733417510986
Epoch: 2, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.683 Vali Acc: 0.662 Test Loss: 1.683 Test Acc: 0.662
Validation loss decreased (-0.216195 --> -0.662145).  Saving model ...
Epoch: 3 cost time: 5.13714861869812
Epoch: 3, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.150 Vali Acc: 0.830 Test Loss: 1.150 Test Acc: 0.830
Validation loss decreased (-0.662145 --> -0.829718).  Saving model ...
Epoch: 4 cost time: 4.4888224601745605
Epoch: 4, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.698 Vali Acc: 0.919 Test Loss: 0.698 Test Acc: 0.919
Validation loss decreased (-0.829718 --> -0.918912).  Saving model ...
Epoch: 5 cost time: 5.04180645942688
Epoch: 5, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.430 Vali Acc: 0.941 Test Loss: 0.430 Test Acc: 0.941
Validation loss decreased (-0.918912 --> -0.940536).  Saving model ...
Epoch: 6 cost time: 4.717676877975464
Epoch: 6, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.320 Vali Acc: 0.932 Test Loss: 0.320 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.430626392364502
Epoch: 7, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
Validation loss decreased (-0.940536 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 4.459604740142822
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 3.7056045532226562
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.461917400360107
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.146530628204346
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.100894212722778
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 6.052931070327759
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 6.108186483383179
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.964496374130249
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 6.152035236358643
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.711028337478638
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 5.790433168411255
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 5.278248071670532
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 5.868680477142334
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.844835519790649
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.82068133354187
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.873151063919067
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 5.8360819816589355
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.50078558921814
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.630657196044922
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.8708882331848145
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.325406551361084
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.325351238250732
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.318450689315796
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 9393353
model size : 37.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.374325275421143
Epoch: 1, Steps: 17 | Train Loss: 2.142 Vali Loss: 2.022 Vali Acc: 0.303 Test Loss: 2.022 Test Acc: 0.303
Validation loss decreased (inf --> -0.302682).  Saving model ...
Epoch: 2 cost time: 2.815749168395996
Epoch: 2, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.641 Vali Acc: 0.865 Test Loss: 1.641 Test Acc: 0.865
Validation loss decreased (-0.302682 --> -0.864848).  Saving model ...
Epoch: 3 cost time: 2.669084310531616
Epoch: 3, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.163 Vali Acc: 0.903 Test Loss: 1.163 Test Acc: 0.903
Validation loss decreased (-0.864848 --> -0.902691).  Saving model ...
Epoch: 4 cost time: 2.6214215755462646
Epoch: 4, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.718 Vali Acc: 0.911 Test Loss: 0.718 Test Acc: 0.911
Validation loss decreased (-0.902691 --> -0.910804).  Saving model ...
Epoch: 5 cost time: 2.602102279663086
Epoch: 5, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.449 Vali Acc: 0.930 Test Loss: 0.449 Test Acc: 0.930
Validation loss decreased (-0.910804 --> -0.929725).  Saving model ...
Epoch: 6 cost time: 2.482295274734497
Epoch: 6, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
Validation loss decreased (-0.929725 --> -0.943240).  Saving model ...
Epoch: 7 cost time: 2.5240817070007324
Epoch: 7, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.209 Vali Acc: 0.954 Test Loss: 0.209 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 2.4964139461517334
Epoch: 8, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.649179458618164
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 2.6374447345733643
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 2.649822473526001
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.575051784515381
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6878809928894043
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 2.7093262672424316
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5998294353485107
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 2.644089460372925
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 17 cost time: 2.732255697250366
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7099435329437256
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 19 cost time: 2.626941204071045
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6682803630828857
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6227967739105225
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6641645431518555
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.644289255142212
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6248276233673096
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8265020847320557
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8616490364074707
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.825853109359741
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.8675782680511475
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 2773449
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.828505992889404
Epoch: 1, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.086 Vali Acc: 0.216 Test Loss: 2.086 Test Acc: 0.216
Validation loss decreased (inf --> -0.216195).  Saving model ...
Epoch: 2 cost time: 4.353816747665405
Epoch: 2, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.685 Vali Acc: 0.659 Test Loss: 1.685 Test Acc: 0.659
Validation loss decreased (-0.216195 --> -0.659443).  Saving model ...
Epoch: 3 cost time: 4.354558706283569
Epoch: 3, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.150 Vali Acc: 0.830 Test Loss: 1.150 Test Acc: 0.830
Validation loss decreased (-0.659443 --> -0.829718).  Saving model ...
Epoch: 4 cost time: 4.1013429164886475
Epoch: 4, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.701 Vali Acc: 0.911 Test Loss: 0.701 Test Acc: 0.911
Validation loss decreased (-0.829718 --> -0.910804).  Saving model ...
Epoch: 5 cost time: 3.845762014389038
Epoch: 5, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.430 Vali Acc: 0.943 Test Loss: 0.430 Test Acc: 0.943
Validation loss decreased (-0.910804 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 3.7672040462493896
Epoch: 6, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.321 Vali Acc: 0.927 Test Loss: 0.321 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9106032848358154
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
Validation loss decreased (-0.943239 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 4.145232200622559
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 4.113830089569092
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.058137893676758
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.121002435684204
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 4.065741777420044
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 4.151895761489868
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 3.9538214206695557
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.266530513763428
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 4.092171669006348
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.045888423919678
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.095725059509277
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 4.1066060066223145
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 4.358621597290039
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.339370489120483
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.347356557846069
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.390510082244873
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 4.39011549949646
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.351137161254883
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.355384111404419
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.8328752517700195
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.8707334995269775
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.8203394412994385
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.7027132511138916
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 9393353
model size : 37.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6393213272094727
Epoch: 1, Steps: 17 | Train Loss: 2.142 Vali Loss: 2.022 Vali Acc: 0.303 Test Loss: 2.022 Test Acc: 0.303
Validation loss decreased (inf --> -0.302682).  Saving model ...
Epoch: 2 cost time: 2.1047911643981934
Epoch: 2, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.642 Vali Acc: 0.865 Test Loss: 1.642 Test Acc: 0.865
Validation loss decreased (-0.302682 --> -0.864848).  Saving model ...
Epoch: 3 cost time: 2.1295034885406494
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.163 Vali Acc: 0.903 Test Loss: 1.163 Test Acc: 0.903
Validation loss decreased (-0.864848 --> -0.902691).  Saving model ...
Epoch: 4 cost time: 2.1375010013580322
Epoch: 4, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.719 Vali Acc: 0.914 Test Loss: 0.719 Test Acc: 0.914
Validation loss decreased (-0.902691 --> -0.913506).  Saving model ...
Epoch: 5 cost time: 2.1119887828826904
Epoch: 5, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.449 Vali Acc: 0.932 Test Loss: 0.449 Test Acc: 0.932
Validation loss decreased (-0.913506 --> -0.932428).  Saving model ...
Epoch: 6 cost time: 2.1128642559051514
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.298 Vali Acc: 0.946 Test Loss: 0.298 Test Acc: 0.946
Validation loss decreased (-0.932428 --> -0.945943).  Saving model ...
Epoch: 7 cost time: 2.1061301231384277
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 2.2356033325195312
Epoch: 8, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 9 cost time: 2.2440569400787354
Epoch: 9, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 10 cost time: 2.2744476795196533
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 2.1099820137023926
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1300766468048096
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1229941844940186
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 2.083484172821045
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 2.0947930812835693
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 2.140613317489624
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 2.2122182846069336
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2410101890563965
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2166759967803955
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.324019193649292
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2356622219085693
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.289379835128784
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.271696090698242
Epoch: 23, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2782578468322754
Epoch: 24, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.273876190185547
Epoch: 25, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2876758575439453
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2773449
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.94039249420166
Epoch: 1, Steps: 17 | Train Loss: 2.206 Vali Loss: 2.093 Vali Acc: 0.211 Test Loss: 2.093 Test Acc: 0.211
Validation loss decreased (inf --> -0.210790).  Saving model ...
Epoch: 2 cost time: 2.3797807693481445
Epoch: 2, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.720 Vali Acc: 0.662 Test Loss: 1.720 Test Acc: 0.662
Validation loss decreased (-0.210790 --> -0.662145).  Saving model ...
Epoch: 3 cost time: 2.420886278152466
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.241 Vali Acc: 0.849 Test Loss: 1.241 Test Acc: 0.849
Validation loss decreased (-0.662145 --> -0.848636).  Saving model ...
Epoch: 4 cost time: 2.4107213020324707
Epoch: 4, Steps: 17 | Train Loss: 0.958 Vali Loss: 0.806 Vali Acc: 0.897 Test Loss: 0.806 Test Acc: 0.897
Validation loss decreased (-0.848636 --> -0.897289).  Saving model ...
Epoch: 5 cost time: 2.4419665336608887
Epoch: 5, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.499 Vali Acc: 0.949 Test Loss: 0.499 Test Acc: 0.949
Validation loss decreased (-0.897289 --> -0.948644).  Saving model ...
Epoch: 6 cost time: 2.416100025177002
Epoch: 6, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.356 Vali Acc: 0.946 Test Loss: 0.356 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5517005920410156
Epoch: 7, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.231 Vali Acc: 0.965 Test Loss: 0.231 Test Acc: 0.965
Validation loss decreased (-0.948644 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 2.5957484245300293
Epoch: 8, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.553778886795044
Epoch: 9, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 2.601400375366211
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5863378047943115
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 2.571471929550171
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3445017337799072
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 2.7316718101501465
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.764448404312134
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 2.7544751167297363
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7666194438934326
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6072206497192383
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.572371244430542
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 2.6109862327575684
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.547128200531006
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5964419841766357
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5381717681884766
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7848803997039795
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.608419179916382
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.652604103088379
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.57888126373291
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.564518451690674
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6094918251037598
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6076767444610596
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 9393353
model size : 37.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1421990394592285
Epoch: 1, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.032 Vali Acc: 0.281 Test Loss: 2.032 Test Acc: 0.281
Validation loss decreased (inf --> -0.281061).  Saving model ...
Epoch: 2 cost time: 1.5352704524993896
Epoch: 2, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.682 Vali Acc: 0.819 Test Loss: 1.682 Test Acc: 0.819
Validation loss decreased (-0.281061 --> -0.818902).  Saving model ...
Epoch: 3 cost time: 1.3933250904083252
Epoch: 3, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.270 Vali Acc: 0.881 Test Loss: 1.270 Test Acc: 0.881
Validation loss decreased (-0.818902 --> -0.881068).  Saving model ...
Epoch: 4 cost time: 1.4180488586425781
Epoch: 4, Steps: 17 | Train Loss: 1.018 Vali Loss: 0.859 Vali Acc: 0.892 Test Loss: 0.859 Test Acc: 0.892
Validation loss decreased (-0.881068 --> -0.891883).  Saving model ...
Epoch: 5 cost time: 1.4474172592163086
Epoch: 5, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.559 Vali Acc: 0.924 Test Loss: 0.559 Test Acc: 0.924
Validation loss decreased (-0.891883 --> -0.924319).  Saving model ...
Epoch: 6 cost time: 1.4234323501586914
Epoch: 6, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.388 Vali Acc: 0.946 Test Loss: 0.388 Test Acc: 0.946
Validation loss decreased (-0.924319 --> -0.945942).  Saving model ...
Epoch: 7 cost time: 1.4542653560638428
Epoch: 7, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.283 Vali Acc: 0.954 Test Loss: 0.283 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954051).  Saving model ...
Epoch: 8 cost time: 1.4808998107910156
Epoch: 8, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
Validation loss decreased (-0.954051 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 1.4192893505096436
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4629921913146973
Epoch: 10, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5200695991516113
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5467267036437988
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 1.5150055885314941
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.553297758102417
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 1.5242033004760742
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.590583324432373
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4396874904632568
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6823980808258057
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.6721832752227783
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6115520000457764
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6561119556427002
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6362719535827637
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6715896129608154
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5528759956359863
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5344913005828857
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5384199619293213
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.526552438735962
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5371215343475342
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2773449
model size : 11.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.629138231277466
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.016 Vali Acc: 0.392 Test Loss: 2.016 Test Acc: 0.392
Validation loss decreased (inf --> -0.391872).  Saving model ...
Epoch: 2 cost time: 4.022589921951294
Epoch: 2, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.710 Vali Acc: 0.730 Test Loss: 1.710 Test Acc: 0.730
Validation loss decreased (-0.391872 --> -0.729713).  Saving model ...
Epoch: 3 cost time: 4.1200573444366455
Epoch: 3, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.279 Vali Acc: 0.873 Test Loss: 1.279 Test Acc: 0.873
Validation loss decreased (-0.729713 --> -0.872960).  Saving model ...
Epoch: 4 cost time: 4.094260215759277
Epoch: 4, Steps: 17 | Train Loss: 1.023 Vali Loss: 0.818 Vali Acc: 0.884 Test Loss: 0.818 Test Acc: 0.884
Validation loss decreased (-0.872960 --> -0.883776).  Saving model ...
Epoch: 5 cost time: 3.6130211353302
Epoch: 5, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.508 Vali Acc: 0.924 Test Loss: 0.508 Test Acc: 0.924
Validation loss decreased (-0.883776 --> -0.924319).  Saving model ...
Epoch: 6 cost time: 3.9493744373321533
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.319 Vali Acc: 0.954 Test Loss: 0.319 Test Acc: 0.954
Validation loss decreased (-0.924319 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 3.8236653804779053
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.298 Vali Acc: 0.927 Test Loss: 0.298 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.419954299926758
Epoch: 8, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 3.5571587085723877
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 3.5203053951263428
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5373940467834473
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 3.553593158721924
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.166712522506714
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.239438772201538
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.208651542663574
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 4.162076950073242
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.31263542175293
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.277736663818359
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.278044939041138
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.965 Test Loss: 0.079 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.277628660202026
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.965 Test Loss: 0.076 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.292206764221191
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.965 Test Loss: 0.073 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.290841341018677
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.965 Test Loss: 0.075 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.317579507827759
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.968 Test Loss: 0.074 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.927560806274414
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.48659086227417
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 4706761
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5772786140441895
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.009 Vali Acc: 0.324 Test Loss: 2.009 Test Acc: 0.324
Validation loss decreased (inf --> -0.324304).  Saving model ...
Epoch: 2 cost time: 2.2621700763702393
Epoch: 2, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.710 Vali Acc: 0.692 Test Loss: 1.710 Test Acc: 0.692
Validation loss decreased (-0.324304 --> -0.691875).  Saving model ...
Epoch: 3 cost time: 2.282377243041992
Epoch: 3, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.339 Vali Acc: 0.881 Test Loss: 1.339 Test Acc: 0.881
Validation loss decreased (-0.691875 --> -0.881068).  Saving model ...
Epoch: 4 cost time: 2.2468388080596924
Epoch: 4, Steps: 17 | Train Loss: 1.130 Vali Loss: 0.934 Vali Acc: 0.903 Test Loss: 0.934 Test Acc: 0.903
Validation loss decreased (-0.881068 --> -0.902693).  Saving model ...
Epoch: 5 cost time: 2.2873353958129883
Epoch: 5, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.610 Vali Acc: 0.908 Test Loss: 0.610 Test Acc: 0.908
Validation loss decreased (-0.902693 --> -0.908102).  Saving model ...
Epoch: 6 cost time: 2.2753920555114746
Epoch: 6, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.390 Vali Acc: 0.935 Test Loss: 0.390 Test Acc: 0.935
Validation loss decreased (-0.908102 --> -0.935131).  Saving model ...
Epoch: 7 cost time: 2.239097833633423
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.284 Vali Acc: 0.957 Test Loss: 0.284 Test Acc: 0.957
Validation loss decreased (-0.935131 --> -0.956754).  Saving model ...
Epoch: 8 cost time: 2.237929582595825
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.184865951538086
Epoch: 9, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.263975143432617
Epoch: 10, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 2.3152809143066406
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 2.383026599884033
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 2.480509042739868
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3748698234558105
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 2.3726704120635986
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4497156143188477
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1843769550323486
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.209219455718994
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.329158306121826
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 2.2850637435913086
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1714982986450195
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2471296787261963
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2597100734710693
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.484071969985962
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 2.394646644592285
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.428781032562256
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.531496286392212
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 2.5336971282958984
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.370732069015503
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.962 Test Loss: 0.091 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4030704498291016
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1396681
model size : 6.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.606301307678223
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.016 Vali Acc: 0.392 Test Loss: 2.016 Test Acc: 0.392
Validation loss decreased (inf --> -0.391872).  Saving model ...
Epoch: 2 cost time: 3.3280229568481445
Epoch: 2, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.712 Vali Acc: 0.724 Test Loss: 1.712 Test Acc: 0.724
Validation loss decreased (-0.391872 --> -0.724307).  Saving model ...
Epoch: 3 cost time: 3.210141658782959
Epoch: 3, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.282 Vali Acc: 0.873 Test Loss: 1.282 Test Acc: 0.873
Validation loss decreased (-0.724307 --> -0.872960).  Saving model ...
Epoch: 4 cost time: 3.1115455627441406
Epoch: 4, Steps: 17 | Train Loss: 1.025 Vali Loss: 0.820 Vali Acc: 0.881 Test Loss: 0.820 Test Acc: 0.881
Validation loss decreased (-0.872960 --> -0.881073).  Saving model ...
Epoch: 5 cost time: 2.9960479736328125
Epoch: 5, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.509 Vali Acc: 0.922 Test Loss: 0.509 Test Acc: 0.922
Validation loss decreased (-0.881073 --> -0.921617).  Saving model ...
Epoch: 6 cost time: 3.0093843936920166
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.319 Vali Acc: 0.954 Test Loss: 0.319 Test Acc: 0.954
Validation loss decreased (-0.921617 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 2.9564054012298584
Epoch: 7, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.829745292663574
Epoch: 8, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.954051 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 3.11004900932312
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4034526348114014
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3715999126434326
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 3.380854845046997
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.40232515335083
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.509150743484497
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5187249183654785
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 3.559175491333008
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.962 Test Loss: 0.084 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.485084295272827
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.592285394668579
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.957 Test Loss: 0.102 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.442702293395996
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.965 Test Loss: 0.081 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.549670457839966
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.965 Test Loss: 0.075 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.590790271759033
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2764644622802734
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.1047160625457764
Epoch: 23, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1021502017974854
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.08264422416687
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 4706761
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6953399181365967
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.009 Vali Acc: 0.324 Test Loss: 2.009 Test Acc: 0.324
Validation loss decreased (inf --> -0.324304).  Saving model ...
Epoch: 2 cost time: 1.9352328777313232
Epoch: 2, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.711 Vali Acc: 0.692 Test Loss: 1.711 Test Acc: 0.692
Validation loss decreased (-0.324304 --> -0.691875).  Saving model ...
Epoch: 3 cost time: 1.9826040267944336
Epoch: 3, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.341 Vali Acc: 0.884 Test Loss: 1.341 Test Acc: 0.884
Validation loss decreased (-0.691875 --> -0.883770).  Saving model ...
Epoch: 4 cost time: 1.98386812210083
Epoch: 4, Steps: 17 | Train Loss: 1.131 Vali Loss: 0.935 Vali Acc: 0.903 Test Loss: 0.935 Test Acc: 0.903
Validation loss decreased (-0.883770 --> -0.902693).  Saving model ...
Epoch: 5 cost time: 1.9835476875305176
Epoch: 5, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.610 Vali Acc: 0.903 Test Loss: 0.610 Test Acc: 0.903
Validation loss decreased (-0.902693 --> -0.902697).  Saving model ...
Epoch: 6 cost time: 1.963568925857544
Epoch: 6, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.390 Vali Acc: 0.935 Test Loss: 0.390 Test Acc: 0.935
Validation loss decreased (-0.902697 --> -0.935131).  Saving model ...
Epoch: 7 cost time: 1.9926302433013916
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.284 Vali Acc: 0.954 Test Loss: 0.284 Test Acc: 0.954
Validation loss decreased (-0.935131 --> -0.954051).  Saving model ...
Epoch: 8 cost time: 1.998110294342041
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.97737455368042
Epoch: 9, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.938077688217163
Epoch: 10, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 2.10115385055542
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 2.0878868103027344
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 2.0961809158325195
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 2.1511261463165283
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 2.103463888168335
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.110607147216797
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.082493543624878
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.9212729930877686
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 1.9890193939208984
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 1.9292871952056885
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8998301029205322
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 22 cost time: 1.9280369281768799
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.954042673110962
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 24 cost time: 1.9556598663330078
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 1.9326858520507812
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.097961902618408
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0771865844726562
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.1157548427581787
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1063499450683594
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0919134616851807
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1396681
model size : 6.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7831103801727295
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.020 Vali Acc: 0.395 Test Loss: 2.020 Test Acc: 0.395
Validation loss decreased (inf --> -0.394574).  Saving model ...
Epoch: 2 cost time: 2.165536403656006
Epoch: 2, Steps: 17 | Train Loss: 1.926 Vali Loss: 1.728 Vali Acc: 0.689 Test Loss: 1.728 Test Acc: 0.689
Validation loss decreased (-0.394574 --> -0.689172).  Saving model ...
Epoch: 3 cost time: 2.143878698348999
Epoch: 3, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.346 Vali Acc: 0.841 Test Loss: 1.346 Test Acc: 0.841
Validation loss decreased (-0.689172 --> -0.840527).  Saving model ...
Epoch: 4 cost time: 2.125441789627075
Epoch: 4, Steps: 17 | Train Loss: 1.100 Vali Loss: 0.918 Vali Acc: 0.889 Test Loss: 0.918 Test Acc: 0.889
Validation loss decreased (-0.840527 --> -0.889180).  Saving model ...
Epoch: 5 cost time: 2.128951072692871
Epoch: 5, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.621 Vali Acc: 0.905 Test Loss: 0.621 Test Acc: 0.905
Validation loss decreased (-0.889180 --> -0.905399).  Saving model ...
Epoch: 6 cost time: 2.120026111602783
Epoch: 6, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.400 Vali Acc: 0.951 Test Loss: 0.400 Test Acc: 0.951
Validation loss decreased (-0.905399 --> -0.951347).  Saving model ...
Epoch: 7 cost time: 2.130253791809082
Epoch: 7, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.297 Vali Acc: 0.959 Test Loss: 0.297 Test Acc: 0.959
Validation loss decreased (-0.951347 --> -0.959456).  Saving model ...
Epoch: 8 cost time: 2.117145538330078
Epoch: 8, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.198 Vali Acc: 0.973 Test Loss: 0.198 Test Acc: 0.973
Validation loss decreased (-0.959456 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 2.135040521621704
Epoch: 9, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.975672960281372
Epoch: 10, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.937978982925415
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 1.9843199253082275
Epoch: 12, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.954502820968628
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.940406322479248
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.975771427154541
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 2.1016621589660645
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0971498489379883
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2509043216705322
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2952024936676025
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 20 cost time: 2.2652268409729004
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2594501972198486
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2676002979278564
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.243424892425537
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.240645170211792
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2643561363220215
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2632880210876465
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2515149116516113
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2833874225616455
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.267378330230713
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 4706761
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.231365203857422
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.011 Vali Acc: 0.324 Test Loss: 2.011 Test Acc: 0.324
Validation loss decreased (inf --> -0.324304).  Saving model ...
Epoch: 2 cost time: 1.6523396968841553
Epoch: 2, Steps: 17 | Train Loss: 1.926 Vali Loss: 1.719 Vali Acc: 0.689 Test Loss: 1.719 Test Acc: 0.689
Validation loss decreased (-0.324304 --> -0.689172).  Saving model ...
Epoch: 3 cost time: 1.6751837730407715
Epoch: 3, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.361 Vali Acc: 0.878 Test Loss: 1.361 Test Acc: 0.878
Validation loss decreased (-0.689172 --> -0.878365).  Saving model ...
Epoch: 4 cost time: 1.7093372344970703
Epoch: 4, Steps: 17 | Train Loss: 1.165 Vali Loss: 0.987 Vali Acc: 0.897 Test Loss: 0.987 Test Acc: 0.897
Validation loss decreased (-0.878365 --> -0.897287).  Saving model ...
Epoch: 5 cost time: 1.5698180198669434
Epoch: 5, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.681 Vali Acc: 0.911 Test Loss: 0.681 Test Acc: 0.911
Validation loss decreased (-0.897287 --> -0.910804).  Saving model ...
Epoch: 6 cost time: 1.5040855407714844
Epoch: 6, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.457 Vali Acc: 0.938 Test Loss: 0.457 Test Acc: 0.938
Validation loss decreased (-0.910804 --> -0.937833).  Saving model ...
Epoch: 7 cost time: 1.4111435413360596
Epoch: 7, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.333 Vali Acc: 0.951 Test Loss: 0.333 Test Acc: 0.951
Validation loss decreased (-0.937833 --> -0.951348).  Saving model ...
Epoch: 8 cost time: 1.4329476356506348
Epoch: 8, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.258 Vali Acc: 0.959 Test Loss: 0.258 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959457).  Saving model ...
Epoch: 9 cost time: 1.422717809677124
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4497182369232178
Epoch: 10, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 1.4953749179840088
Epoch: 11, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.444791316986084
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4220707416534424
Epoch: 13, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.52866530418396
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 15 cost time: 1.571887731552124
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4636051654815674
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 1.5403013229370117
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.5654408931732178
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5661864280700684
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 20 cost time: 1.5546607971191406
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5566306114196777
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5504882335662842
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5418751239776611
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6171348094940186
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 25 cost time: 1.6006224155426025
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 26 cost time: 1.4120354652404785
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6521847248077393
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.6622626781463623
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6918549537658691
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6467297077178955
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1396681
model size : 6.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.99242091178894
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.127 Vali Acc: 0.189 Test Loss: 2.127 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 4.0151567459106445
Epoch: 2, Steps: 17 | Train Loss: 2.039 Vali Loss: 1.922 Vali Acc: 0.546 Test Loss: 1.922 Test Acc: 0.546
Validation loss decreased (-0.189168 --> -0.545927).  Saving model ...
Epoch: 3 cost time: 3.997715711593628
Epoch: 3, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.625 Vali Acc: 0.757 Test Loss: 1.625 Test Acc: 0.757
Validation loss decreased (-0.545927 --> -0.756741).  Saving model ...
Epoch: 4 cost time: 4.041147232055664
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.297 Vali Acc: 0.773 Test Loss: 1.297 Test Acc: 0.773
Validation loss decreased (-0.756741 --> -0.772960).  Saving model ...
Epoch: 5 cost time: 4.015679597854614
Epoch: 5, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.011 Vali Acc: 0.870 Test Loss: 1.011 Test Acc: 0.870
Validation loss decreased (-0.772960 --> -0.870260).  Saving model ...
Epoch: 6 cost time: 3.888669729232788
Epoch: 6, Steps: 17 | Train Loss: 0.818 Vali Loss: 0.763 Vali Acc: 0.911 Test Loss: 0.763 Test Acc: 0.911
Validation loss decreased (-0.870260 --> -0.910803).  Saving model ...
Epoch: 7 cost time: 4.34315299987793
Epoch: 7, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.562 Vali Acc: 0.922 Test Loss: 0.562 Test Acc: 0.922
Validation loss decreased (-0.910803 --> -0.921616).  Saving model ...
Epoch: 8 cost time: 4.3680336475372314
Epoch: 8, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.404 Vali Acc: 0.938 Test Loss: 0.404 Test Acc: 0.938
Validation loss decreased (-0.921616 --> -0.937834).  Saving model ...
Epoch: 9 cost time: 4.394548416137695
Epoch: 9, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 4.090912818908691
Epoch: 10, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.252 Vali Acc: 0.946 Test Loss: 0.252 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 5.426144123077393
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 5.522980451583862
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.815194845199585
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 6.837110996246338
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 6.781774044036865
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.871849060058594
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.607451438903809
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.540109872817993
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.487026929855347
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.572954893112183
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.699566841125488
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.1282384395599365
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.119789123535156
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.1281678676605225
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4697449
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.38620662689209
Epoch: 1, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.070 Vali Acc: 0.273 Test Loss: 2.070 Test Acc: 0.273
Validation loss decreased (inf --> -0.272952).  Saving model ...
Epoch: 2 cost time: 4.273460388183594
Epoch: 2, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.857 Vali Acc: 0.551 Test Loss: 1.857 Test Acc: 0.551
Validation loss decreased (-0.272952 --> -0.551333).  Saving model ...
Epoch: 3 cost time: 4.242487907409668
Epoch: 3, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.596 Vali Acc: 0.776 Test Loss: 1.596 Test Acc: 0.776
Validation loss decreased (-0.551333 --> -0.775660).  Saving model ...
Epoch: 4 cost time: 4.293038845062256
Epoch: 4, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.297 Vali Acc: 0.862 Test Loss: 1.297 Test Acc: 0.862
Validation loss decreased (-0.775660 --> -0.862149).  Saving model ...
Epoch: 5 cost time: 4.231072425842285
Epoch: 5, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.013 Vali Acc: 0.873 Test Loss: 1.013 Test Acc: 0.873
Validation loss decreased (-0.862149 --> -0.872963).  Saving model ...
Epoch: 6 cost time: 4.264851331710815
Epoch: 6, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.786 Vali Acc: 0.884 Test Loss: 0.786 Test Acc: 0.884
Validation loss decreased (-0.872963 --> -0.883776).  Saving model ...
Epoch: 7 cost time: 4.361248970031738
Epoch: 7, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.595 Vali Acc: 0.916 Test Loss: 0.595 Test Acc: 0.916
Validation loss decreased (-0.883776 --> -0.916210).  Saving model ...
Epoch: 8 cost time: 4.397510290145874
Epoch: 8, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.464 Vali Acc: 0.924 Test Loss: 0.464 Test Acc: 0.924
Validation loss decreased (-0.916210 --> -0.924320).  Saving model ...
Epoch: 9 cost time: 4.41337776184082
Epoch: 9, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 10 cost time: 4.374701738357544
Epoch: 10, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.310 Vali Acc: 0.943 Test Loss: 0.310 Test Acc: 0.943
Validation loss decreased (-0.929726 --> -0.943240).  Saving model ...
Epoch: 11 cost time: 4.149088382720947
Epoch: 11, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.14766001701355
Epoch: 12, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 4.081416130065918
Epoch: 13, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 3.969358205795288
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 4.004959583282471
Epoch: 15, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.055027008056641
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.983255386352539
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.096743106842041
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.1607043743133545
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.203077554702759
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.214900493621826
Epoch: 21, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.169055938720703
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.069901466369629
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.127718448638916
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 1387241
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.853512763977051
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.128 Vali Acc: 0.189 Test Loss: 2.128 Test Acc: 0.189
Validation loss decreased (inf --> -0.189168).  Saving model ...
Epoch: 2 cost time: 5.143132209777832
Epoch: 2, Steps: 17 | Train Loss: 2.040 Vali Loss: 1.922 Vali Acc: 0.546 Test Loss: 1.922 Test Acc: 0.546
Validation loss decreased (-0.189168 --> -0.545927).  Saving model ...
Epoch: 3 cost time: 5.157810211181641
Epoch: 3, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.625 Vali Acc: 0.757 Test Loss: 1.625 Test Acc: 0.757
Validation loss decreased (-0.545927 --> -0.756741).  Saving model ...
Epoch: 4 cost time: 5.159647703170776
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.298 Vali Acc: 0.773 Test Loss: 1.298 Test Acc: 0.773
Validation loss decreased (-0.756741 --> -0.772960).  Saving model ...
Epoch: 5 cost time: 5.177029848098755
Epoch: 5, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.014 Vali Acc: 0.868 Test Loss: 1.014 Test Acc: 0.868
Validation loss decreased (-0.772960 --> -0.867557).  Saving model ...
Epoch: 6 cost time: 5.2703070640563965
Epoch: 6, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.766 Vali Acc: 0.911 Test Loss: 0.766 Test Acc: 0.911
Validation loss decreased (-0.867557 --> -0.910803).  Saving model ...
Epoch: 7 cost time: 5.041321039199829
Epoch: 7, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.564 Vali Acc: 0.922 Test Loss: 0.564 Test Acc: 0.922
Validation loss decreased (-0.910803 --> -0.921616).  Saving model ...
Epoch: 8 cost time: 4.818153142929077
Epoch: 8, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.407 Vali Acc: 0.938 Test Loss: 0.407 Test Acc: 0.938
Validation loss decreased (-0.921616 --> -0.937834).  Saving model ...
Epoch: 9 cost time: 5.032189130783081
Epoch: 9, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 5.004705905914307
Epoch: 10, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 5.039669990539551
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 5.028369188308716
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.29778790473938
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 5.297360420227051
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 5.358583211898804
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.36106276512146
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.347060680389404
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.140296220779419
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.107619762420654
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.176344156265259
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.167272567749023
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.178074836730957
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.167210817337036
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.206127405166626
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4697449
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.3318705558776855
Epoch: 1, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.070 Vali Acc: 0.273 Test Loss: 2.070 Test Acc: 0.273
Validation loss decreased (inf --> -0.272952).  Saving model ...
Epoch: 2 cost time: 3.08359956741333
Epoch: 2, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.858 Vali Acc: 0.551 Test Loss: 1.858 Test Acc: 0.551
Validation loss decreased (-0.272952 --> -0.551333).  Saving model ...
Epoch: 3 cost time: 3.076561450958252
Epoch: 3, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.596 Vali Acc: 0.773 Test Loss: 1.596 Test Acc: 0.773
Validation loss decreased (-0.551333 --> -0.772957).  Saving model ...
Epoch: 4 cost time: 3.1111955642700195
Epoch: 4, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.298 Vali Acc: 0.859 Test Loss: 1.298 Test Acc: 0.859
Validation loss decreased (-0.772957 --> -0.859446).  Saving model ...
Epoch: 5 cost time: 3.0856757164001465
Epoch: 5, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.014 Vali Acc: 0.873 Test Loss: 1.014 Test Acc: 0.873
Validation loss decreased (-0.859446 --> -0.872963).  Saving model ...
Epoch: 6 cost time: 3.083160400390625
Epoch: 6, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.787 Vali Acc: 0.881 Test Loss: 0.787 Test Acc: 0.881
Validation loss decreased (-0.872963 --> -0.881073).  Saving model ...
Epoch: 7 cost time: 3.1663835048675537
Epoch: 7, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.595 Vali Acc: 0.916 Test Loss: 0.595 Test Acc: 0.916
Validation loss decreased (-0.881073 --> -0.916210).  Saving model ...
Epoch: 8 cost time: 3.2540018558502197
Epoch: 8, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.464 Vali Acc: 0.924 Test Loss: 0.464 Test Acc: 0.924
Validation loss decreased (-0.916210 --> -0.924320).  Saving model ...
Epoch: 9 cost time: 3.444359540939331
Epoch: 9, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.386 Vali Acc: 0.927 Test Loss: 0.386 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 10 cost time: 3.473780870437622
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.310 Vali Acc: 0.943 Test Loss: 0.310 Test Acc: 0.943
Validation loss decreased (-0.927023 --> -0.943240).  Saving model ...
Epoch: 11 cost time: 2.769834041595459
Epoch: 11, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.323 Vali Acc: 0.905 Test Loss: 0.323 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.774421215057373
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 2.7143352031707764
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.210 Vali Acc: 0.954 Test Loss: 0.210 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 2.673964262008667
Epoch: 14, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 2.734114170074463
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7437052726745605
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.747277021408081
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6677560806274414
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6547160148620605
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.951 Test Loss: 0.139 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6846232414245605
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6864867210388184
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6835849285125732
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.949 Test Loss: 0.122 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.661025285720825
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.951 Test Loss: 0.126 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6627118587493896
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 1387241
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.640544652938843
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.131 Vali Acc: 0.176 Test Loss: 2.131 Test Acc: 0.176
Validation loss decreased (inf --> -0.175654).  Saving model ...
Epoch: 2 cost time: 2.4175920486450195
Epoch: 2, Steps: 17 | Train Loss: 2.047 Vali Loss: 1.940 Vali Acc: 0.516 Test Loss: 1.940 Test Acc: 0.516
Validation loss decreased (-0.175654 --> -0.516197).  Saving model ...
Epoch: 3 cost time: 2.6701602935791016
Epoch: 3, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.680 Vali Acc: 0.716 Test Loss: 1.680 Test Acc: 0.716
Validation loss decreased (-0.516197 --> -0.716199).  Saving model ...
Epoch: 4 cost time: 2.5022010803222656
Epoch: 4, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.392 Vali Acc: 0.784 Test Loss: 1.392 Test Acc: 0.784
Validation loss decreased (-0.716199 --> -0.783770).  Saving model ...
Epoch: 5 cost time: 2.63713002204895
Epoch: 5, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.120 Vali Acc: 0.868 Test Loss: 1.120 Test Acc: 0.868
Validation loss decreased (-0.783770 --> -0.867556).  Saving model ...
Epoch: 6 cost time: 2.7048048973083496
Epoch: 6, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.883 Vali Acc: 0.919 Test Loss: 0.883 Test Acc: 0.919
Validation loss decreased (-0.867556 --> -0.918910).  Saving model ...
Epoch: 7 cost time: 2.5923213958740234
Epoch: 7, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.683 Vali Acc: 0.922 Test Loss: 0.683 Test Acc: 0.922
Validation loss decreased (-0.918910 --> -0.921615).  Saving model ...
Epoch: 8 cost time: 2.789828300476074
Epoch: 8, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.513 Vali Acc: 0.935 Test Loss: 0.513 Test Acc: 0.935
Validation loss decreased (-0.921615 --> -0.935130).  Saving model ...
Epoch: 9 cost time: 2.746056318283081
Epoch: 9, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.406 Vali Acc: 0.935 Test Loss: 0.406 Test Acc: 0.935
Validation loss decreased (-0.935130 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 2.935483455657959
Epoch: 10, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.314 Vali Acc: 0.946 Test Loss: 0.314 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 2.756183385848999
Epoch: 11, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.261 Vali Acc: 0.946 Test Loss: 0.261 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 12 cost time: 2.7227022647857666
Epoch: 12, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 13 cost time: 3.151041269302368
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.913193464279175
Epoch: 14, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.948646 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.8671793937683105
Epoch: 15, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.874366521835327
Epoch: 16, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8201041221618652
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.249480962753296
Epoch: 18, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.025282859802246
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.0748918056488037
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.0180788040161133
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1037516593933105
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 3.094350576400757
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9235918521881104
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.906585216522217
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.8139851093292236
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.8866164684295654
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.8993122577667236
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.9600560665130615
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.897826671600342
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 4697449
model size : 18.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8682186603546143
Epoch: 1, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.075 Vali Acc: 0.254 Test Loss: 2.075 Test Acc: 0.254
Validation loss decreased (inf --> -0.254033).  Saving model ...
Epoch: 2 cost time: 2.2574679851531982
Epoch: 2, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.876 Vali Acc: 0.527 Test Loss: 1.876 Test Acc: 0.527
Validation loss decreased (-0.254033 --> -0.527008).  Saving model ...
Epoch: 3 cost time: 2.2676970958709717
Epoch: 3, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.637 Vali Acc: 0.757 Test Loss: 1.637 Test Acc: 0.757
Validation loss decreased (-0.527008 --> -0.756740).  Saving model ...
Epoch: 4 cost time: 2.2370216846466064
Epoch: 4, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.369 Vali Acc: 0.851 Test Loss: 1.369 Test Acc: 0.851
Validation loss decreased (-0.756740 --> -0.851338).  Saving model ...
Epoch: 5 cost time: 2.263650894165039
Epoch: 5, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.102 Vali Acc: 0.870 Test Loss: 1.102 Test Acc: 0.870
Validation loss decreased (-0.851338 --> -0.870259).  Saving model ...
Epoch: 6 cost time: 2.3630528450012207
Epoch: 6, Steps: 17 | Train Loss: 0.945 Vali Loss: 0.877 Vali Acc: 0.897 Test Loss: 0.877 Test Acc: 0.897
Validation loss decreased (-0.870259 --> -0.897289).  Saving model ...
Epoch: 7 cost time: 2.1683902740478516
Epoch: 7, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.704 Vali Acc: 0.914 Test Loss: 0.704 Test Acc: 0.914
Validation loss decreased (-0.897289 --> -0.913506).  Saving model ...
Epoch: 8 cost time: 2.0912296772003174
Epoch: 8, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.549 Vali Acc: 0.935 Test Loss: 0.549 Test Acc: 0.935
Validation loss decreased (-0.913506 --> -0.935130).  Saving model ...
Epoch: 9 cost time: 2.2290780544281006
Epoch: 9, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.459 Vali Acc: 0.932 Test Loss: 0.459 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.148371934890747
Epoch: 10, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
Validation loss decreased (-0.935130 --> -0.940537).  Saving model ...
Epoch: 11 cost time: 2.1538045406341553
Epoch: 11, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.320 Vali Acc: 0.951 Test Loss: 0.320 Test Acc: 0.951
Validation loss decreased (-0.940537 --> -0.951348).  Saving model ...
Epoch: 12 cost time: 2.1358156204223633
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.261 Vali Acc: 0.954 Test Loss: 0.261 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 13 cost time: 2.1872575283050537
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.242 Vali Acc: 0.949 Test Loss: 0.242 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1556591987609863
Epoch: 14, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 2.1054279804229736
Epoch: 15, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1813957691192627
Epoch: 16, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1511292457580566
Epoch: 17, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.198462724685669
Epoch: 18, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.172947645187378
Epoch: 19, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 2.0994536876678467
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0857162475585938
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0502541065216064
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 2.096513509750366
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9958930015563965
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 2.007599115371704
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 1.9030582904815674
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.118260145187378
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 2.113820791244507
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.203200101852417
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.158553123474121
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 1387241
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.049891948699951
Epoch: 1, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.165 Vali Acc: 0.168 Test Loss: 2.165 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 3.520962715148926
Epoch: 2, Steps: 17 | Train Loss: 2.054 Vali Loss: 1.976 Vali Acc: 0.341 Test Loss: 1.976 Test Acc: 0.341
Validation loss decreased (-0.167546 --> -0.340521).  Saving model ...
Epoch: 3 cost time: 3.134899616241455
Epoch: 3, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.713 Vali Acc: 0.630 Test Loss: 1.713 Test Acc: 0.630
Validation loss decreased (-0.340521 --> -0.629713).  Saving model ...
Epoch: 4 cost time: 3.8331894874572754
Epoch: 4, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.402 Vali Acc: 0.759 Test Loss: 1.402 Test Acc: 0.759
Validation loss decreased (-0.629713 --> -0.759445).  Saving model ...
Epoch: 5 cost time: 4.198291540145874
Epoch: 5, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.102 Vali Acc: 0.824 Test Loss: 1.102 Test Acc: 0.824
Validation loss decreased (-0.759445 --> -0.824313).  Saving model ...
Epoch: 6 cost time: 4.178285360336304
Epoch: 6, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.834 Vali Acc: 0.908 Test Loss: 0.834 Test Acc: 0.908
Validation loss decreased (-0.824313 --> -0.908100).  Saving model ...
Epoch: 7 cost time: 4.337871551513672
Epoch: 7, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.633 Vali Acc: 0.903 Test Loss: 0.633 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.141502857208252
Epoch: 8, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.508 Vali Acc: 0.916 Test Loss: 0.508 Test Acc: 0.916
Validation loss decreased (-0.908100 --> -0.916211).  Saving model ...
Epoch: 9 cost time: 4.145944595336914
Epoch: 9, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.344 Vali Acc: 0.946 Test Loss: 0.344 Test Acc: 0.946
Validation loss decreased (-0.916211 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 4.301023483276367
Epoch: 10, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 3.812455415725708
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.220 Vali Acc: 0.962 Test Loss: 0.220 Test Acc: 0.962
Validation loss decreased (-0.948646 --> -0.962160).  Saving model ...
Epoch: 12 cost time: 3.7482690811157227
Epoch: 12, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.847569465637207
Epoch: 13, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8978583812713623
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.8253653049468994
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 3.8746633529663086
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 4.101065635681152
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 4.169898748397827
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 4.4962992668151855
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 4.443072319030762
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 4.4505743980407715
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.497867584228516
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.46506667137146
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.493731498718262
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.508180618286133
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.247221946716309
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.243194818496704
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.199491024017334
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.913461923599243
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.0099170207977295
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2353769
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.601822137832642
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.092 Vali Acc: 0.211 Test Loss: 2.092 Test Acc: 0.211
Validation loss decreased (inf --> -0.210790).  Saving model ...
Epoch: 2 cost time: 2.9852590560913086
Epoch: 2, Steps: 17 | Train Loss: 2.054 Vali Loss: 1.928 Vali Acc: 0.395 Test Loss: 1.928 Test Acc: 0.395
Validation loss decreased (-0.210790 --> -0.394575).  Saving model ...
Epoch: 3 cost time: 2.9874203205108643
Epoch: 3, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.706 Vali Acc: 0.662 Test Loss: 1.706 Test Acc: 0.662
Validation loss decreased (-0.394575 --> -0.662145).  Saving model ...
Epoch: 4 cost time: 3.008481979370117
Epoch: 4, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.457 Vali Acc: 0.830 Test Loss: 1.457 Test Acc: 0.830
Validation loss decreased (-0.662145 --> -0.829715).  Saving model ...
Epoch: 5 cost time: 3.135744094848633
Epoch: 5, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.177 Vali Acc: 0.895 Test Loss: 1.177 Test Acc: 0.895
Validation loss decreased (-0.829715 --> -0.894583).  Saving model ...
Epoch: 6 cost time: 3.1186411380767822
Epoch: 6, Steps: 17 | Train Loss: 1.034 Vali Loss: 0.934 Vali Acc: 0.900 Test Loss: 0.934 Test Acc: 0.900
Validation loss decreased (-0.894583 --> -0.899991).  Saving model ...
Epoch: 7 cost time: 3.1276726722717285
Epoch: 7, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.722 Vali Acc: 0.924 Test Loss: 0.722 Test Acc: 0.924
Validation loss decreased (-0.899991 --> -0.924317).  Saving model ...
Epoch: 8 cost time: 3.047051191329956
Epoch: 8, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.534 Vali Acc: 0.930 Test Loss: 0.534 Test Acc: 0.930
Validation loss decreased (-0.924317 --> -0.929724).  Saving model ...
Epoch: 9 cost time: 3.0628139972686768
Epoch: 9, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.416 Vali Acc: 0.938 Test Loss: 0.416 Test Acc: 0.938
Validation loss decreased (-0.929724 --> -0.937834).  Saving model ...
Epoch: 10 cost time: 3.1770050525665283
Epoch: 10, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.324 Vali Acc: 0.949 Test Loss: 0.324 Test Acc: 0.949
Validation loss decreased (-0.937834 --> -0.948645).  Saving model ...
Epoch: 11 cost time: 2.923635721206665
Epoch: 11, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.272 Vali Acc: 0.949 Test Loss: 0.272 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 3.0105605125427246
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.868333578109741
Epoch: 13, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 3.017284393310547
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 2.6447665691375732
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 2.965799331665039
Epoch: 16, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.967794179916382
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8805999755859375
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.694683074951172
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.917968511581421
Epoch: 20, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 21 cost time: 2.9862964153289795
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9235005378723145
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 3.029088258743286
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.929856300354004
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 3.0722954273223877
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.06213116645813
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2147912979125977
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.029698133468628
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.000504493713379
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.0846853256225586
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 698601
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.303754091262817
Epoch: 1, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.166 Vali Acc: 0.168 Test Loss: 2.166 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 3.3470418453216553
Epoch: 2, Steps: 17 | Train Loss: 2.054 Vali Loss: 1.978 Vali Acc: 0.341 Test Loss: 1.978 Test Acc: 0.341
Validation loss decreased (-0.167546 --> -0.340521).  Saving model ...
Epoch: 3 cost time: 3.2495594024658203
Epoch: 3, Steps: 17 | Train Loss: 1.823 Vali Loss: 1.715 Vali Acc: 0.627 Test Loss: 1.715 Test Acc: 0.627
Validation loss decreased (-0.340521 --> -0.627010).  Saving model ...
Epoch: 4 cost time: 3.3549740314483643
Epoch: 4, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.402 Vali Acc: 0.757 Test Loss: 1.402 Test Acc: 0.757
Validation loss decreased (-0.627010 --> -0.756743).  Saving model ...
Epoch: 5 cost time: 3.5632426738739014
Epoch: 5, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.104 Vali Acc: 0.822 Test Loss: 1.104 Test Acc: 0.822
Validation loss decreased (-0.756743 --> -0.821611).  Saving model ...
Epoch: 6 cost time: 3.5473523139953613
Epoch: 6, Steps: 17 | Train Loss: 0.922 Vali Loss: 0.834 Vali Acc: 0.905 Test Loss: 0.834 Test Acc: 0.905
Validation loss decreased (-0.821611 --> -0.905397).  Saving model ...
Epoch: 7 cost time: 3.5765984058380127
Epoch: 7, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.632 Vali Acc: 0.903 Test Loss: 0.632 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4468533992767334
Epoch: 8, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.502 Vali Acc: 0.914 Test Loss: 0.502 Test Acc: 0.914
Validation loss decreased (-0.905397 --> -0.913508).  Saving model ...
Epoch: 9 cost time: 3.4085965156555176
Epoch: 9, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.913508 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 3.3586647510528564
Epoch: 10, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.273 Vali Acc: 0.949 Test Loss: 0.273 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 3.385955333709717
Epoch: 11, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959457).  Saving model ...
Epoch: 12 cost time: 3.441565990447998
Epoch: 12, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.224 Vali Acc: 0.943 Test Loss: 0.224 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1930129528045654
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 3.18129301071167
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.220874071121216
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.233030319213867
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.23203182220459
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9775123596191406
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 2.9313583374023438
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3024749755859375
Epoch: 20, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 3.3784854412078857
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4338996410369873
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 3.5669679641723633
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.384420156478882
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.440776824951172
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.3329925537109375
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.2583694458007812
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.160095453262329
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.3495538234710693
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.0707945823669434
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 2353769
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.157572269439697
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.092 Vali Acc: 0.211 Test Loss: 2.092 Test Acc: 0.211
Validation loss decreased (inf --> -0.210790).  Saving model ...
Epoch: 2 cost time: 2.317890167236328
Epoch: 2, Steps: 17 | Train Loss: 2.055 Vali Loss: 1.929 Vali Acc: 0.389 Test Loss: 1.929 Test Acc: 0.389
Validation loss decreased (-0.210790 --> -0.389170).  Saving model ...
Epoch: 3 cost time: 2.3254873752593994
Epoch: 3, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.707 Vali Acc: 0.657 Test Loss: 1.707 Test Acc: 0.657
Validation loss decreased (-0.389170 --> -0.656740).  Saving model ...
Epoch: 4 cost time: 2.314122200012207
Epoch: 4, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.459 Vali Acc: 0.827 Test Loss: 1.459 Test Acc: 0.827
Validation loss decreased (-0.656740 --> -0.827012).  Saving model ...
Epoch: 5 cost time: 2.359043598175049
Epoch: 5, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.179 Vali Acc: 0.897 Test Loss: 1.179 Test Acc: 0.897
Validation loss decreased (-0.827012 --> -0.897286).  Saving model ...
Epoch: 6 cost time: 2.312666177749634
Epoch: 6, Steps: 17 | Train Loss: 1.036 Vali Loss: 0.936 Vali Acc: 0.900 Test Loss: 0.936 Test Acc: 0.900
Validation loss decreased (-0.897286 --> -0.899991).  Saving model ...
Epoch: 7 cost time: 2.434150457382202
Epoch: 7, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.725 Vali Acc: 0.927 Test Loss: 0.725 Test Acc: 0.927
Validation loss decreased (-0.899991 --> -0.927020).  Saving model ...
Epoch: 8 cost time: 2.319469928741455
Epoch: 8, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.537 Vali Acc: 0.930 Test Loss: 0.537 Test Acc: 0.930
Validation loss decreased (-0.927020 --> -0.929724).  Saving model ...
Epoch: 9 cost time: 2.520120859146118
Epoch: 9, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.417 Vali Acc: 0.941 Test Loss: 0.417 Test Acc: 0.941
Validation loss decreased (-0.929724 --> -0.940536).  Saving model ...
Epoch: 10 cost time: 2.4624392986297607
Epoch: 10, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.325 Vali Acc: 0.951 Test Loss: 0.325 Test Acc: 0.951
Validation loss decreased (-0.940536 --> -0.951348).  Saving model ...
Epoch: 11 cost time: 2.486599922180176
Epoch: 11, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.271 Vali Acc: 0.951 Test Loss: 0.271 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 2.4885940551757812
Epoch: 12, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6065945625305176
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 2.692533254623413
Epoch: 14, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 2.5347092151641846
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 2.623230457305908
Epoch: 16, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.586897611618042
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.472429037094116
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5140702724456787
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5361297130584717
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.5363752841949463
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3824453353881836
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3618791103363037
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.408261775970459
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 2.4098281860351562
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4185807704925537
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.500991106033325
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.672309398651123
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6402783393859863
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.6696300506591797
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 698601
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.7021002769470215
Epoch: 1, Steps: 17 | Train Loss: 2.192 Vali Loss: 2.169 Vali Acc: 0.168 Test Loss: 2.169 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 2.8578848838806152
Epoch: 2, Steps: 17 | Train Loss: 2.061 Vali Loss: 1.993 Vali Acc: 0.341 Test Loss: 1.993 Test Acc: 0.341
Validation loss decreased (-0.167546 --> -0.340521).  Saving model ...
Epoch: 3 cost time: 2.708268165588379
Epoch: 3, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.768 Vali Acc: 0.538 Test Loss: 1.768 Test Acc: 0.538
Validation loss decreased (-0.340521 --> -0.537820).  Saving model ...
Epoch: 4 cost time: 2.616816759109497
Epoch: 4, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.488 Vali Acc: 0.749 Test Loss: 1.488 Test Acc: 0.749
Validation loss decreased (-0.537820 --> -0.748634).  Saving model ...
Epoch: 5 cost time: 2.6051557064056396
Epoch: 5, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.200 Vali Acc: 0.862 Test Loss: 1.200 Test Acc: 0.862
Validation loss decreased (-0.748634 --> -0.862150).  Saving model ...
Epoch: 6 cost time: 2.4048945903778076
Epoch: 6, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.941 Vali Acc: 0.892 Test Loss: 0.941 Test Acc: 0.892
Validation loss decreased (-0.862150 --> -0.891882).  Saving model ...
Epoch: 7 cost time: 2.436448097229004
Epoch: 7, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.743 Vali Acc: 0.911 Test Loss: 0.743 Test Acc: 0.911
Validation loss decreased (-0.891882 --> -0.910803).  Saving model ...
Epoch: 8 cost time: 2.4446122646331787
Epoch: 8, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.593 Vali Acc: 0.922 Test Loss: 0.593 Test Acc: 0.922
Validation loss decreased (-0.910803 --> -0.921616).  Saving model ...
Epoch: 9 cost time: 2.6511993408203125
Epoch: 9, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.461 Vali Acc: 0.932 Test Loss: 0.461 Test Acc: 0.932
Validation loss decreased (-0.921616 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 2.5560338497161865
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.377 Vali Acc: 0.935 Test Loss: 0.377 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935131).  Saving model ...
Epoch: 11 cost time: 2.487175464630127
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.307 Vali Acc: 0.957 Test Loss: 0.307 Test Acc: 0.957
Validation loss decreased (-0.935131 --> -0.956754).  Saving model ...
Epoch: 12 cost time: 2.5826022624969482
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.593209743499756
Epoch: 13, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.220 Vali Acc: 0.954 Test Loss: 0.220 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5554604530334473
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.597174644470215
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 2.6928067207336426
Epoch: 16, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8236310482025146
Epoch: 17, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.6410255432128906
Epoch: 18, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6330697536468506
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.63725209236145
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.581681489944458
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 2.69755220413208
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 2.880401611328125
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.767385721206665
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.7911345958709717
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.562483072280884
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5971333980560303
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.610945463180542
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.647726058959961
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.489269733428955
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2353769
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3938679695129395
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.094 Vali Acc: 0.211 Test Loss: 2.094 Test Acc: 0.211
Validation loss decreased (inf --> -0.210790).  Saving model ...
Epoch: 2 cost time: 1.7589600086212158
Epoch: 2, Steps: 17 | Train Loss: 2.057 Vali Loss: 1.936 Vali Acc: 0.389 Test Loss: 1.936 Test Acc: 0.389
Validation loss decreased (-0.210790 --> -0.389170).  Saving model ...
Epoch: 3 cost time: 1.698347806930542
Epoch: 3, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.726 Vali Acc: 0.646 Test Loss: 1.726 Test Acc: 0.646
Validation loss decreased (-0.389170 --> -0.645929).  Saving model ...
Epoch: 4 cost time: 1.7846589088439941
Epoch: 4, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.500 Vali Acc: 0.832 Test Loss: 1.500 Test Acc: 0.832
Validation loss decreased (-0.645929 --> -0.832417).  Saving model ...
Epoch: 5 cost time: 2.040778636932373
Epoch: 5, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.248 Vali Acc: 0.892 Test Loss: 1.248 Test Acc: 0.892
Validation loss decreased (-0.832417 --> -0.891879).  Saving model ...
Epoch: 6 cost time: 1.9833669662475586
Epoch: 6, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.021 Vali Acc: 0.919 Test Loss: 1.021 Test Acc: 0.919
Validation loss decreased (-0.891879 --> -0.918909).  Saving model ...
Epoch: 7 cost time: 1.936628818511963
Epoch: 7, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.826 Vali Acc: 0.932 Test Loss: 0.826 Test Acc: 0.932
Validation loss decreased (-0.918909 --> -0.932424).  Saving model ...
Epoch: 8 cost time: 1.9913835525512695
Epoch: 8, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.644 Vali Acc: 0.941 Test Loss: 0.644 Test Acc: 0.941
Validation loss decreased (-0.932424 --> -0.940534).  Saving model ...
Epoch: 9 cost time: 2.0694453716278076
Epoch: 9, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.503 Vali Acc: 0.951 Test Loss: 0.503 Test Acc: 0.951
Validation loss decreased (-0.940534 --> -0.951346).  Saving model ...
Epoch: 10 cost time: 2.113751173019409
Epoch: 10, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.410 Vali Acc: 0.957 Test Loss: 0.410 Test Acc: 0.957
Validation loss decreased (-0.951346 --> -0.956753).  Saving model ...
Epoch: 11 cost time: 2.0671567916870117
Epoch: 11, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.341 Vali Acc: 0.954 Test Loss: 0.341 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.98441481590271
Epoch: 12, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.286 Vali Acc: 0.959 Test Loss: 0.286 Test Acc: 0.959
Validation loss decreased (-0.956753 --> -0.959457).  Saving model ...
Epoch: 13 cost time: 2.0250496864318848
Epoch: 13, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.250 Vali Acc: 0.957 Test Loss: 0.250 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1208410263061523
Epoch: 14, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.212 Vali Acc: 0.965 Test Loss: 0.212 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 2.0258405208587646
Epoch: 15, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.984057903289795
Epoch: 16, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9046599864959717
Epoch: 17, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.853628396987915
Epoch: 18, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 1.8507423400878906
Epoch: 19, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 1.7259888648986816
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.812211513519287
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8291082382202148
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8887825012207031
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.826730489730835
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8675806522369385
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 1.8241331577301025
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.856818675994873
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8691837787628174
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9488933086395264
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9719960689544678
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 698601
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.442686796188354
Epoch: 1, Steps: 17 | Train Loss: 2.291 Vali Loss: 2.287 Vali Acc: 0.089 Test Loss: 2.287 Test Acc: 0.089
Validation loss decreased (inf --> -0.089166).  Saving model ...
Epoch: 2 cost time: 6.573355436325073
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.124 Vali Acc: 0.278 Test Loss: 2.124 Test Acc: 0.278
Validation loss decreased (-0.089166 --> -0.278357).  Saving model ...
Epoch: 3 cost time: 6.572262763977051
Epoch: 3, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.896 Vali Acc: 0.508 Test Loss: 1.896 Test Acc: 0.508
Validation loss decreased (-0.278357 --> -0.508089).  Saving model ...
Epoch: 4 cost time: 6.548173904418945
Epoch: 4, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.602 Vali Acc: 0.708 Test Loss: 1.602 Test Acc: 0.708
Validation loss decreased (-0.508089 --> -0.708092).  Saving model ...
Epoch: 5 cost time: 6.423618316650391
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.239 Vali Acc: 0.816 Test Loss: 1.239 Test Acc: 0.816
Validation loss decreased (-0.708092 --> -0.816204).  Saving model ...
Epoch: 6 cost time: 6.470716953277588
Epoch: 6, Steps: 17 | Train Loss: 1.078 Vali Loss: 0.927 Vali Acc: 0.868 Test Loss: 0.927 Test Acc: 0.868
Validation loss decreased (-0.816204 --> -0.867558).  Saving model ...
Epoch: 7 cost time: 6.308353424072266
Epoch: 7, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.706 Vali Acc: 0.870 Test Loss: 0.706 Test Acc: 0.870
Validation loss decreased (-0.867558 --> -0.870263).  Saving model ...
Epoch: 8 cost time: 6.289010524749756
Epoch: 8, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.532 Vali Acc: 0.916 Test Loss: 0.532 Test Acc: 0.916
Validation loss decreased (-0.870263 --> -0.916211).  Saving model ...
Epoch: 9 cost time: 5.967462539672852
Epoch: 9, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.415 Vali Acc: 0.930 Test Loss: 0.415 Test Acc: 0.930
Validation loss decreased (-0.916211 --> -0.929726).  Saving model ...
Epoch: 10 cost time: 5.860550880432129
Epoch: 10, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.359 Vali Acc: 0.938 Test Loss: 0.359 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937834).  Saving model ...
Epoch: 11 cost time: 6.224089622497559
Epoch: 11, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.268 Vali Acc: 0.954 Test Loss: 0.268 Test Acc: 0.954
Validation loss decreased (-0.937834 --> -0.954051).  Saving model ...
Epoch: 12 cost time: 6.853468894958496
Epoch: 12, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.242 Vali Acc: 0.951 Test Loss: 0.242 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.786795616149902
Epoch: 13, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.634697914123535
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 6.726048231124878
Epoch: 15, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 6.134150981903076
Epoch: 16, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.5405073165893555
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 5.580103874206543
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 5.67277455329895
Epoch: 19, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.196509599685669
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.2433061599731445
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 6.739795207977295
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 6.68605375289917
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 6.72480320930481
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.005384683609009
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.496793031692505
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.588135242462158
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.482276678085327
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.489279747009277
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.478490352630615
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1181929
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.896254301071167
Epoch: 1, Steps: 17 | Train Loss: 2.295 Vali Loss: 2.236 Vali Acc: 0.100 Test Loss: 2.236 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 3.828834056854248
Epoch: 2, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.066 Vali Acc: 0.278 Test Loss: 2.066 Test Acc: 0.278
Validation loss decreased (-0.099978 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 4.186025142669678
Epoch: 3, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.850 Vali Acc: 0.503 Test Loss: 1.850 Test Acc: 0.503
Validation loss decreased (-0.278358 --> -0.502684).  Saving model ...
Epoch: 4 cost time: 4.1187169551849365
Epoch: 4, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.608 Vali Acc: 0.735 Test Loss: 1.608 Test Acc: 0.735
Validation loss decreased (-0.502684 --> -0.735119).  Saving model ...
Epoch: 5 cost time: 4.202265739440918
Epoch: 5, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.345 Vali Acc: 0.843 Test Loss: 1.345 Test Acc: 0.843
Validation loss decreased (-0.735119 --> -0.843230).  Saving model ...
Epoch: 6 cost time: 4.445594310760498
Epoch: 6, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.083 Vali Acc: 0.873 Test Loss: 1.083 Test Acc: 0.873
Validation loss decreased (-0.843230 --> -0.872962).  Saving model ...
Epoch: 7 cost time: 4.5415239334106445
Epoch: 7, Steps: 17 | Train Loss: 0.957 Vali Loss: 0.843 Vali Acc: 0.919 Test Loss: 0.843 Test Acc: 0.919
Validation loss decreased (-0.872962 --> -0.918910).  Saving model ...
Epoch: 8 cost time: 4.434196949005127
Epoch: 8, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.666 Vali Acc: 0.927 Test Loss: 0.666 Test Acc: 0.927
Validation loss decreased (-0.918910 --> -0.927020).  Saving model ...
Epoch: 9 cost time: 4.464742422103882
Epoch: 9, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.522 Vali Acc: 0.935 Test Loss: 0.522 Test Acc: 0.935
Validation loss decreased (-0.927020 --> -0.935130).  Saving model ...
Epoch: 10 cost time: 4.05159592628479
Epoch: 10, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.425 Vali Acc: 0.949 Test Loss: 0.425 Test Acc: 0.949
Validation loss decreased (-0.935130 --> -0.948644).  Saving model ...
Epoch: 11 cost time: 4.1025471687316895
Epoch: 11, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.356 Vali Acc: 0.946 Test Loss: 0.356 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.0423948764801025
Epoch: 12, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.299 Vali Acc: 0.949 Test Loss: 0.299 Test Acc: 0.949
Validation loss decreased (-0.948644 --> -0.948646).  Saving model ...
Epoch: 13 cost time: 3.793449640274048
Epoch: 13, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.275 Vali Acc: 0.946 Test Loss: 0.275 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7596373558044434
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 3.8633480072021484
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.803906202316284
Epoch: 16, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 3.991046905517578
Epoch: 17, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 4.422778844833374
Epoch: 18, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.3300621509552
Epoch: 19, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 4.37357759475708
Epoch: 20, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.3503241539001465
Epoch: 21, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.329691648483276
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.088998317718506
Epoch: 23, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.07155442237854
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 3.835332155227661
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7101738452911377
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 3.9956066608428955
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 28 cost time: 3.974205493927002
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.859105348587036
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.016585350036621
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 354281
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.374307632446289
Epoch: 1, Steps: 17 | Train Loss: 2.291 Vali Loss: 2.287 Vali Acc: 0.089 Test Loss: 2.287 Test Acc: 0.089
Validation loss decreased (inf --> -0.089166).  Saving model ...
Epoch: 2 cost time: 4.687488079071045
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 2.124 Vali Acc: 0.278 Test Loss: 2.124 Test Acc: 0.278
Validation loss decreased (-0.089166 --> -0.278357).  Saving model ...
Epoch: 3 cost time: 4.665102243423462
Epoch: 3, Steps: 17 | Train Loss: 1.959 Vali Loss: 1.897 Vali Acc: 0.505 Test Loss: 1.897 Test Acc: 0.505
Validation loss decreased (-0.278357 --> -0.505386).  Saving model ...
Epoch: 4 cost time: 4.658482074737549
Epoch: 4, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.603 Vali Acc: 0.711 Test Loss: 1.603 Test Acc: 0.711
Validation loss decreased (-0.505386 --> -0.710795).  Saving model ...
Epoch: 5 cost time: 3.6681885719299316
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.239 Vali Acc: 0.811 Test Loss: 1.239 Test Acc: 0.811
Validation loss decreased (-0.710795 --> -0.810798).  Saving model ...
Epoch: 6 cost time: 5.141682863235474
Epoch: 6, Steps: 17 | Train Loss: 1.079 Vali Loss: 0.928 Vali Acc: 0.865 Test Loss: 0.928 Test Acc: 0.865
Validation loss decreased (-0.810798 --> -0.864856).  Saving model ...
Epoch: 7 cost time: 5.178826093673706
Epoch: 7, Steps: 17 | Train Loss: 0.808 Vali Loss: 0.706 Vali Acc: 0.876 Test Loss: 0.706 Test Acc: 0.876
Validation loss decreased (-0.864856 --> -0.875669).  Saving model ...
Epoch: 8 cost time: 5.09756326675415
Epoch: 8, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.532 Vali Acc: 0.916 Test Loss: 0.532 Test Acc: 0.916
Validation loss decreased (-0.875669 --> -0.916211).  Saving model ...
Epoch: 9 cost time: 4.7205586433410645
Epoch: 9, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.414 Vali Acc: 0.932 Test Loss: 0.414 Test Acc: 0.932
Validation loss decreased (-0.916211 --> -0.932428).  Saving model ...
Epoch: 10 cost time: 4.726029396057129
Epoch: 10, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.356 Vali Acc: 0.938 Test Loss: 0.356 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 11 cost time: 4.747433423995972
Epoch: 11, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.267 Vali Acc: 0.957 Test Loss: 0.267 Test Acc: 0.957
Validation loss decreased (-0.937834 --> -0.956754).  Saving model ...
Epoch: 12 cost time: 4.81874418258667
Epoch: 12, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.239 Vali Acc: 0.951 Test Loss: 0.239 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.822099924087524
Epoch: 13, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.789789199829102
Epoch: 14, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 4.825655698776245
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.156651258468628
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.454085826873779
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.5574791431427
Epoch: 18, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.538707733154297
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.558201551437378
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.585278749465942
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 5.205718517303467
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 5.2221903800964355
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.885024547576904
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.906041383743286
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.140114068984985
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.191014528274536
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 5.182544469833374
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.173340797424316
Epoch: 29, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 5.037177324295044
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1181929
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.185611248016357
Epoch: 1, Steps: 17 | Train Loss: 2.295 Vali Loss: 2.236 Vali Acc: 0.100 Test Loss: 2.236 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 3.307081937789917
Epoch: 2, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.067 Vali Acc: 0.278 Test Loss: 2.067 Test Acc: 0.278
Validation loss decreased (-0.099978 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 3.3006911277770996
Epoch: 3, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.850 Vali Acc: 0.500 Test Loss: 1.850 Test Acc: 0.500
Validation loss decreased (-0.278358 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 3.3288486003875732
Epoch: 4, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.608 Vali Acc: 0.730 Test Loss: 1.608 Test Acc: 0.730
Validation loss decreased (-0.499981 --> -0.729714).  Saving model ...
Epoch: 5 cost time: 3.5318174362182617
Epoch: 5, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.344 Vali Acc: 0.843 Test Loss: 1.344 Test Acc: 0.843
Validation loss decreased (-0.729714 --> -0.843230).  Saving model ...
Epoch: 6 cost time: 3.566997766494751
Epoch: 6, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.083 Vali Acc: 0.878 Test Loss: 1.083 Test Acc: 0.878
Validation loss decreased (-0.843230 --> -0.878368).  Saving model ...
Epoch: 7 cost time: 3.6154823303222656
Epoch: 7, Steps: 17 | Train Loss: 0.958 Vali Loss: 0.843 Vali Acc: 0.914 Test Loss: 0.843 Test Acc: 0.914
Validation loss decreased (-0.878368 --> -0.913505).  Saving model ...
Epoch: 8 cost time: 3.5379016399383545
Epoch: 8, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.666 Vali Acc: 0.930 Test Loss: 0.666 Test Acc: 0.930
Validation loss decreased (-0.913505 --> -0.929723).  Saving model ...
Epoch: 9 cost time: 3.394473075866699
Epoch: 9, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.523 Vali Acc: 0.938 Test Loss: 0.523 Test Acc: 0.938
Validation loss decreased (-0.929723 --> -0.937833).  Saving model ...
Epoch: 10 cost time: 3.3221428394317627
Epoch: 10, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.427 Vali Acc: 0.951 Test Loss: 0.427 Test Acc: 0.951
Validation loss decreased (-0.937833 --> -0.951347).  Saving model ...
Epoch: 11 cost time: 3.3294005393981934
Epoch: 11, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.357 Vali Acc: 0.943 Test Loss: 0.357 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.345576047897339
Epoch: 12, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.300 Vali Acc: 0.949 Test Loss: 0.300 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0213747024536133
Epoch: 13, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.275 Vali Acc: 0.951 Test Loss: 0.275 Test Acc: 0.951
Validation loss decreased (-0.951347 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 3.178086042404175
Epoch: 14, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 3.1046395301818848
Epoch: 15, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1903038024902344
Epoch: 16, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 3.187432050704956
Epoch: 17, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 3.6769626140594482
Epoch: 18, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5960397720336914
Epoch: 19, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5889763832092285
Epoch: 20, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5498757362365723
Epoch: 21, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.716726064682007
Epoch: 22, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.701862335205078
Epoch: 23, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.695554256439209
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 3.521768569946289
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5342583656311035
Epoch: 26, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.224822998046875
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 3.258842706680298
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2572824954986572
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.435764789581299
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 354281
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.130276203155518
Epoch: 1, Steps: 17 | Train Loss: 2.291 Vali Loss: 2.289 Vali Acc: 0.086 Test Loss: 2.289 Test Acc: 0.086
Validation loss decreased (inf --> -0.086464).  Saving model ...
Epoch: 2 cost time: 3.279557943344116
Epoch: 2, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.131 Vali Acc: 0.273 Test Loss: 2.131 Test Acc: 0.273
Validation loss decreased (-0.086464 --> -0.272952).  Saving model ...
Epoch: 3 cost time: 3.2209858894348145
Epoch: 3, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.918 Vali Acc: 0.473 Test Loss: 1.918 Test Acc: 0.473
Validation loss decreased (-0.272952 --> -0.472954).  Saving model ...
Epoch: 4 cost time: 3.2003555297851562
Epoch: 4, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.669 Vali Acc: 0.641 Test Loss: 1.669 Test Acc: 0.641
Validation loss decreased (-0.472954 --> -0.640524).  Saving model ...
Epoch: 5 cost time: 3.223942756652832
Epoch: 5, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.374 Vali Acc: 0.795 Test Loss: 1.374 Test Acc: 0.795
Validation loss decreased (-0.640524 --> -0.794581).  Saving model ...
Epoch: 6 cost time: 3.053603172302246
Epoch: 6, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.089 Vali Acc: 0.865 Test Loss: 1.089 Test Acc: 0.865
Validation loss decreased (-0.794581 --> -0.864854).  Saving model ...
Epoch: 7 cost time: 3.0282623767852783
Epoch: 7, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.834 Vali Acc: 0.886 Test Loss: 0.834 Test Acc: 0.886
Validation loss decreased (-0.864854 --> -0.886478).  Saving model ...
Epoch: 8 cost time: 3.0030465126037598
Epoch: 8, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.652 Vali Acc: 0.900 Test Loss: 0.652 Test Acc: 0.900
Validation loss decreased (-0.886478 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 3.0247654914855957
Epoch: 9, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.511 Vali Acc: 0.935 Test Loss: 0.511 Test Acc: 0.935
Validation loss decreased (-0.899993 --> -0.935130).  Saving model ...
Epoch: 10 cost time: 2.55705189704895
Epoch: 10, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.420 Vali Acc: 0.930 Test Loss: 0.420 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.781876802444458
Epoch: 11, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.338 Vali Acc: 0.957 Test Loss: 0.338 Test Acc: 0.957
Validation loss decreased (-0.935130 --> -0.956753).  Saving model ...
Epoch: 12 cost time: 3.5662460327148438
Epoch: 12, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.286 Vali Acc: 0.954 Test Loss: 0.286 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.598097324371338
Epoch: 13, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
Validation loss decreased (-0.956753 --> -0.956754).  Saving model ...
Epoch: 14 cost time: 3.6116647720336914
Epoch: 14, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
Validation loss decreased (-0.956754 --> -0.970268).  Saving model ...
Epoch: 15 cost time: 3.5557007789611816
Epoch: 15, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5808870792388916
Epoch: 16, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 3.6191556453704834
Epoch: 17, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5959737300872803
Epoch: 18, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 3.525998592376709
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3706302642822266
Epoch: 20, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 3.3681142330169678
Epoch: 21, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.348640203475952
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.284759998321533
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 3.2991139888763428
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.447073459625244
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 3.538274049758911
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.329878807067871
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 28 cost time: 3.2870681285858154
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2990121841430664
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 30 cost time: 3.2783052921295166
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1181929
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.199007034301758
Epoch: 1, Steps: 17 | Train Loss: 2.294 Vali Loss: 2.238 Vali Acc: 0.100 Test Loss: 2.238 Test Acc: 0.100
Validation loss decreased (inf --> -0.099978).  Saving model ...
Epoch: 2 cost time: 2.2464330196380615
Epoch: 2, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.071 Vali Acc: 0.278 Test Loss: 2.071 Test Acc: 0.278
Validation loss decreased (-0.099978 --> -0.278358).  Saving model ...
Epoch: 3 cost time: 1.9908921718597412
Epoch: 3, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.862 Vali Acc: 0.495 Test Loss: 1.862 Test Acc: 0.495
Validation loss decreased (-0.278358 --> -0.494576).  Saving model ...
Epoch: 4 cost time: 2.198859453201294
Epoch: 4, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.634 Vali Acc: 0.692 Test Loss: 1.634 Test Acc: 0.692
Validation loss decreased (-0.494576 --> -0.691876).  Saving model ...
Epoch: 5 cost time: 2.2154932022094727
Epoch: 5, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.393 Vali Acc: 0.789 Test Loss: 1.393 Test Acc: 0.789
Validation loss decreased (-0.691876 --> -0.789175).  Saving model ...
Epoch: 6 cost time: 2.255300998687744
Epoch: 6, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.154 Vali Acc: 0.851 Test Loss: 1.154 Test Acc: 0.851
Validation loss decreased (-0.789175 --> -0.851340).  Saving model ...
Epoch: 7 cost time: 2.2892065048217773
Epoch: 7, Steps: 17 | Train Loss: 1.019 Vali Loss: 0.927 Vali Acc: 0.892 Test Loss: 0.927 Test Acc: 0.892
Validation loss decreased (-0.851340 --> -0.891883).  Saving model ...
Epoch: 8 cost time: 2.525984525680542
Epoch: 8, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.754 Vali Acc: 0.914 Test Loss: 0.754 Test Acc: 0.914
Validation loss decreased (-0.891883 --> -0.913506).  Saving model ...
Epoch: 9 cost time: 2.553110361099243
Epoch: 9, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.612 Vali Acc: 0.919 Test Loss: 0.612 Test Acc: 0.919
Validation loss decreased (-0.913506 --> -0.918913).  Saving model ...
Epoch: 10 cost time: 2.5475540161132812
Epoch: 10, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.507 Vali Acc: 0.941 Test Loss: 0.507 Test Acc: 0.941
Validation loss decreased (-0.918913 --> -0.940535).  Saving model ...
Epoch: 11 cost time: 2.504971981048584
Epoch: 11, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.426 Vali Acc: 0.938 Test Loss: 0.426 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.544179916381836
Epoch: 12, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.366 Vali Acc: 0.941 Test Loss: 0.366 Test Acc: 0.941
Validation loss decreased (-0.940535 --> -0.940537).  Saving model ...
Epoch: 13 cost time: 2.5184459686279297
Epoch: 13, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.323 Vali Acc: 0.949 Test Loss: 0.323 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948645).  Saving model ...
Epoch: 14 cost time: 2.5906288623809814
Epoch: 14, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.275 Vali Acc: 0.965 Test Loss: 0.275 Test Acc: 0.965
Validation loss decreased (-0.948645 --> -0.964862).  Saving model ...
Epoch: 15 cost time: 2.4779865741729736
Epoch: 15, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5744922161102295
Epoch: 16, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.435513973236084
Epoch: 17, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.200 Vali Acc: 0.957 Test Loss: 0.200 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2144851684570312
Epoch: 18, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.423001527786255
Epoch: 19, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.578495502471924
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.414597749710083
Epoch: 21, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.471910238265991
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.483639717102051
Epoch: 23, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.633937120437622
Epoch: 24, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 354281
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.5616302490234375
Epoch: 1, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.146 Vali Acc: 0.108 Test Loss: 2.146 Test Acc: 0.108
Validation loss decreased (inf --> -0.108087).  Saving model ...
Epoch: 2 cost time: 3.5294671058654785
Epoch: 2, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.047 Vali Acc: 0.192 Test Loss: 2.047 Test Acc: 0.192
Validation loss decreased (-0.108087 --> -0.191871).  Saving model ...
Epoch: 3 cost time: 3.5319530963897705
Epoch: 3, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.916 Vali Acc: 0.386 Test Loss: 1.916 Test Acc: 0.386
Validation loss decreased (-0.191871 --> -0.386467).  Saving model ...
Epoch: 4 cost time: 3.475679397583008
Epoch: 4, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.753 Vali Acc: 0.614 Test Loss: 1.753 Test Acc: 0.614
Validation loss decreased (-0.386467 --> -0.613496).  Saving model ...
Epoch: 5 cost time: 3.4797422885894775
Epoch: 5, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.576 Vali Acc: 0.711 Test Loss: 1.576 Test Acc: 0.711
Validation loss decreased (-0.613496 --> -0.710795).  Saving model ...
Epoch: 6 cost time: 3.3844552040100098
Epoch: 6, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.399 Vali Acc: 0.800 Test Loss: 1.399 Test Acc: 0.800
Validation loss decreased (-0.710795 --> -0.799986).  Saving model ...
Epoch: 7 cost time: 3.3391785621643066
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.211 Vali Acc: 0.814 Test Loss: 1.211 Test Acc: 0.814
Validation loss decreased (-0.799986 --> -0.813501).  Saving model ...
Epoch: 8 cost time: 3.3854525089263916
Epoch: 8, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.019 Vali Acc: 0.838 Test Loss: 1.019 Test Acc: 0.838
Validation loss decreased (-0.813501 --> -0.837828).  Saving model ...
Epoch: 9 cost time: 3.298182725906372
Epoch: 9, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.859 Vali Acc: 0.878 Test Loss: 0.859 Test Acc: 0.878
Validation loss decreased (-0.837828 --> -0.878370).  Saving model ...
Epoch: 10 cost time: 3.31310772895813
Epoch: 10, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.746 Vali Acc: 0.873 Test Loss: 0.746 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.658348321914673
Epoch: 11, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.639 Vali Acc: 0.903 Test Loss: 0.639 Test Acc: 0.903
Validation loss decreased (-0.878370 --> -0.902696).  Saving model ...
Epoch: 12 cost time: 3.761632204055786
Epoch: 12, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.510 Vali Acc: 0.922 Test Loss: 0.510 Test Acc: 0.922
Validation loss decreased (-0.902696 --> -0.921617).  Saving model ...
Epoch: 13 cost time: 3.6799838542938232
Epoch: 13, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.440 Vali Acc: 0.943 Test Loss: 0.440 Test Acc: 0.943
Validation loss decreased (-0.921617 --> -0.943239).  Saving model ...
Epoch: 14 cost time: 3.730905055999756
Epoch: 14, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.395 Vali Acc: 0.941 Test Loss: 0.395 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6905858516693115
Epoch: 15, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.352 Vali Acc: 0.938 Test Loss: 0.352 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6338095664978027
Epoch: 16, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.287 Vali Acc: 0.946 Test Loss: 0.287 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945943).  Saving model ...
Epoch: 17 cost time: 3.684492349624634
Epoch: 17, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 18 cost time: 3.4513895511627197
Epoch: 18, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.241 Vali Acc: 0.959 Test Loss: 0.241 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 3.499506950378418
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4564762115478516
Epoch: 20, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5362460613250732
Epoch: 21, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 3.7631072998046875
Epoch: 22, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.233980178833008
Epoch: 23, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.201555967330933
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.203605651855469
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.165072679519653
Epoch: 26, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.109040260314941
Epoch: 27, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.041783571243286
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 5.192538022994995
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.983224868774414
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1177273
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.1419196128845215
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.153 Vali Acc: 0.138 Test Loss: 2.153 Test Acc: 0.138
Validation loss decreased (inf --> -0.137816).  Saving model ...
Epoch: 2 cost time: 3.9755032062530518
Epoch: 2, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.067 Vali Acc: 0.238 Test Loss: 2.067 Test Acc: 0.238
Validation loss decreased (-0.137816 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 3.9043352603912354
Epoch: 3, Steps: 17 | Train Loss: 2.052 Vali Loss: 1.953 Vali Acc: 0.457 Test Loss: 1.953 Test Acc: 0.457
Validation loss decreased (-0.237817 --> -0.456737).  Saving model ...
Epoch: 4 cost time: 3.9100277423858643
Epoch: 4, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.810 Vali Acc: 0.695 Test Loss: 1.810 Test Acc: 0.695
Validation loss decreased (-0.456737 --> -0.694576).  Saving model ...
Epoch: 5 cost time: 3.976930618286133
Epoch: 5, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.640 Vali Acc: 0.784 Test Loss: 1.640 Test Acc: 0.784
Validation loss decreased (-0.694576 --> -0.783767).  Saving model ...
Epoch: 6 cost time: 3.885007381439209
Epoch: 6, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.449 Vali Acc: 0.822 Test Loss: 1.449 Test Acc: 0.822
Validation loss decreased (-0.783767 --> -0.821607).  Saving model ...
Epoch: 7 cost time: 4.444574356079102
Epoch: 7, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.251 Vali Acc: 0.835 Test Loss: 1.251 Test Acc: 0.835
Validation loss decreased (-0.821607 --> -0.835123).  Saving model ...
Epoch: 8 cost time: 4.58660888671875
Epoch: 8, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.073 Vali Acc: 0.865 Test Loss: 1.073 Test Acc: 0.865
Validation loss decreased (-0.835123 --> -0.864854).  Saving model ...
Epoch: 9 cost time: 4.549667835235596
Epoch: 9, Steps: 17 | Train Loss: 0.973 Vali Loss: 0.923 Vali Acc: 0.870 Test Loss: 0.923 Test Acc: 0.870
Validation loss decreased (-0.864854 --> -0.870261).  Saving model ...
Epoch: 10 cost time: 4.541399002075195
Epoch: 10, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.796 Vali Acc: 0.878 Test Loss: 0.796 Test Acc: 0.878
Validation loss decreased (-0.870261 --> -0.878370).  Saving model ...
Epoch: 11 cost time: 4.417432069778442
Epoch: 11, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.878370 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 4.40656304359436
Epoch: 12, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.583 Vali Acc: 0.922 Test Loss: 0.583 Test Acc: 0.922
Validation loss decreased (-0.899993 --> -0.921616).  Saving model ...
Epoch: 13 cost time: 4.494488716125488
Epoch: 13, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.492 Vali Acc: 0.927 Test Loss: 0.492 Test Acc: 0.927
Validation loss decreased (-0.921616 --> -0.927022).  Saving model ...
Epoch: 14 cost time: 4.5530595779418945
Epoch: 14, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.437 Vali Acc: 0.927 Test Loss: 0.437 Test Acc: 0.927
Validation loss decreased (-0.927022 --> -0.927023).  Saving model ...
Epoch: 15 cost time: 4.4039928913116455
Epoch: 15, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935131).  Saving model ...
Epoch: 16 cost time: 4.634809255599976
Epoch: 16, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.352 Vali Acc: 0.932 Test Loss: 0.352 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.672610759735107
Epoch: 17, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940538).  Saving model ...
Epoch: 18 cost time: 4.6612842082977295
Epoch: 18, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.271 Vali Acc: 0.932 Test Loss: 0.271 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.624743938446045
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 20 cost time: 4.541886806488037
Epoch: 20, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 4.457219839096069
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.543039560317993
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.670030832290649
Epoch: 23, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.57955265045166
Epoch: 24, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 4.548913478851318
Epoch: 25, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.593170166015625
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.569310426712036
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 28 cost time: 4.525757551193237
Epoch: 28, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.4293458461761475
Epoch: 29, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.39419960975647
Epoch: 30, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 349561
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.1987879276275635
Epoch: 1, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.147 Vali Acc: 0.108 Test Loss: 2.147 Test Acc: 0.108
Validation loss decreased (inf --> -0.108087).  Saving model ...
Epoch: 2 cost time: 4.797671556472778
Epoch: 2, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.047 Vali Acc: 0.192 Test Loss: 2.047 Test Acc: 0.192
Validation loss decreased (-0.108087 --> -0.191871).  Saving model ...
Epoch: 3 cost time: 4.792853355407715
Epoch: 3, Steps: 17 | Train Loss: 1.984 Vali Loss: 1.916 Vali Acc: 0.386 Test Loss: 1.916 Test Acc: 0.386
Validation loss decreased (-0.191871 --> -0.386467).  Saving model ...
Epoch: 4 cost time: 4.780157089233398
Epoch: 4, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.753 Vali Acc: 0.611 Test Loss: 1.753 Test Acc: 0.611
Validation loss decreased (-0.386467 --> -0.610793).  Saving model ...
Epoch: 5 cost time: 4.702842473983765
Epoch: 5, Steps: 17 | Train Loss: 1.691 Vali Loss: 1.577 Vali Acc: 0.708 Test Loss: 1.577 Test Acc: 0.708
Validation loss decreased (-0.610793 --> -0.708092).  Saving model ...
Epoch: 6 cost time: 4.494641304016113
Epoch: 6, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.402 Vali Acc: 0.800 Test Loss: 1.402 Test Acc: 0.800
Validation loss decreased (-0.708092 --> -0.799986).  Saving model ...
Epoch: 7 cost time: 4.686819553375244
Epoch: 7, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.214 Vali Acc: 0.808 Test Loss: 1.214 Test Acc: 0.808
Validation loss decreased (-0.799986 --> -0.808096).  Saving model ...
Epoch: 8 cost time: 4.549818277359009
Epoch: 8, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.023 Vali Acc: 0.838 Test Loss: 1.023 Test Acc: 0.838
Validation loss decreased (-0.808096 --> -0.837828).  Saving model ...
Epoch: 9 cost time: 4.627695322036743
Epoch: 9, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.863 Vali Acc: 0.881 Test Loss: 0.863 Test Acc: 0.881
Validation loss decreased (-0.837828 --> -0.881072).  Saving model ...
Epoch: 10 cost time: 4.779786109924316
Epoch: 10, Steps: 17 | Train Loss: 0.750 Vali Loss: 0.755 Vali Acc: 0.876 Test Loss: 0.755 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.744346618652344
Epoch: 11, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.641 Vali Acc: 0.897 Test Loss: 0.641 Test Acc: 0.897
Validation loss decreased (-0.881072 --> -0.897291).  Saving model ...
Epoch: 12 cost time: 4.685795545578003
Epoch: 12, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.517 Vali Acc: 0.916 Test Loss: 0.517 Test Acc: 0.916
Validation loss decreased (-0.897291 --> -0.916211).  Saving model ...
Epoch: 13 cost time: 4.613415956497192
Epoch: 13, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.451 Vali Acc: 0.927 Test Loss: 0.451 Test Acc: 0.927
Validation loss decreased (-0.916211 --> -0.927023).  Saving model ...
Epoch: 14 cost time: 4.663968563079834
Epoch: 14, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.402 Vali Acc: 0.935 Test Loss: 0.402 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935131).  Saving model ...
Epoch: 15 cost time: 4.587174892425537
Epoch: 15, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.359 Vali Acc: 0.930 Test Loss: 0.359 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.446998834609985
Epoch: 16, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.293 Vali Acc: 0.946 Test Loss: 0.293 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945943).  Saving model ...
Epoch: 17 cost time: 4.4486000537872314
Epoch: 17, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.249 Vali Acc: 0.946 Test Loss: 0.249 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 18 cost time: 4.454679012298584
Epoch: 18, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 4.5893731117248535
Epoch: 19, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.50898289680481
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.225 Vali Acc: 0.946 Test Loss: 0.225 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.550400733947754
Epoch: 21, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 22 cost time: 4.423783779144287
Epoch: 22, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.4492692947387695
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.2786078453063965
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.281904220581055
Epoch: 25, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.264242172241211
Epoch: 26, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.40212869644165
Epoch: 27, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.509235382080078
Epoch: 28, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 4.369844913482666
Epoch: 29, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 30 cost time: 4.709590673446655
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 1177273
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.9674365520477295
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.153 Vali Acc: 0.138 Test Loss: 2.153 Test Acc: 0.138
Validation loss decreased (inf --> -0.137816).  Saving model ...
Epoch: 2 cost time: 3.6975483894348145
Epoch: 2, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.068 Vali Acc: 0.238 Test Loss: 2.068 Test Acc: 0.238
Validation loss decreased (-0.137816 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 3.2796380519866943
Epoch: 3, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.953 Vali Acc: 0.451 Test Loss: 1.953 Test Acc: 0.451
Validation loss decreased (-0.237817 --> -0.451332).  Saving model ...
Epoch: 4 cost time: 3.859276056289673
Epoch: 4, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.811 Vali Acc: 0.689 Test Loss: 1.811 Test Acc: 0.689
Validation loss decreased (-0.451332 --> -0.689171).  Saving model ...
Epoch: 5 cost time: 3.8246564865112305
Epoch: 5, Steps: 17 | Train Loss: 1.739 Vali Loss: 1.641 Vali Acc: 0.781 Test Loss: 1.641 Test Acc: 0.781
Validation loss decreased (-0.689171 --> -0.781065).  Saving model ...
Epoch: 6 cost time: 3.909756660461426
Epoch: 6, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.450 Vali Acc: 0.822 Test Loss: 1.450 Test Acc: 0.822
Validation loss decreased (-0.781065 --> -0.821607).  Saving model ...
Epoch: 7 cost time: 3.8907155990600586
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.252 Vali Acc: 0.832 Test Loss: 1.252 Test Acc: 0.832
Validation loss decreased (-0.821607 --> -0.832420).  Saving model ...
Epoch: 8 cost time: 3.93013596534729
Epoch: 8, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.075 Vali Acc: 0.859 Test Loss: 1.075 Test Acc: 0.859
Validation loss decreased (-0.832420 --> -0.859449).  Saving model ...
Epoch: 9 cost time: 3.816957473754883
Epoch: 9, Steps: 17 | Train Loss: 0.975 Vali Loss: 0.925 Vali Acc: 0.868 Test Loss: 0.925 Test Acc: 0.868
Validation loss decreased (-0.859449 --> -0.867558).  Saving model ...
Epoch: 10 cost time: 3.849297046661377
Epoch: 10, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.797 Vali Acc: 0.878 Test Loss: 0.797 Test Acc: 0.878
Validation loss decreased (-0.867558 --> -0.878370).  Saving model ...
Epoch: 11 cost time: 3.818098783493042
Epoch: 11, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.678 Vali Acc: 0.892 Test Loss: 0.678 Test Acc: 0.892
Validation loss decreased (-0.878370 --> -0.891885).  Saving model ...
Epoch: 12 cost time: 3.88102388381958
Epoch: 12, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.585 Vali Acc: 0.919 Test Loss: 0.585 Test Acc: 0.919
Validation loss decreased (-0.891885 --> -0.918913).  Saving model ...
Epoch: 13 cost time: 3.847794532775879
Epoch: 13, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.493 Vali Acc: 0.927 Test Loss: 0.493 Test Acc: 0.927
Validation loss decreased (-0.918913 --> -0.927022).  Saving model ...
Epoch: 14 cost time: 3.8604960441589355
Epoch: 14, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.440 Vali Acc: 0.919 Test Loss: 0.440 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.940779685974121
Epoch: 15, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.384 Vali Acc: 0.932 Test Loss: 0.384 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932429).  Saving model ...
Epoch: 16 cost time: 3.7283036708831787
Epoch: 16, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.354 Vali Acc: 0.932 Test Loss: 0.354 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 17 cost time: 3.731485605239868
Epoch: 17, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 18 cost time: 3.748952865600586
Epoch: 18, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.75110125541687
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.259 Vali Acc: 0.946 Test Loss: 0.259 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945943).  Saving model ...
Epoch: 20 cost time: 3.5425987243652344
Epoch: 20, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 3.9229559898376465
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.237 Vali Acc: 0.938 Test Loss: 0.237 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.599527597427368
Epoch: 22, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7535531520843506
Epoch: 23, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.713467597961426
Epoch: 24, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 3.735089063644409
Epoch: 25, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.207 Vali Acc: 0.927 Test Loss: 0.207 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7644636631011963
Epoch: 26, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7635602951049805
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 28 cost time: 3.6848018169403076
Epoch: 28, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6573259830474854
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5838782787323
Epoch: 30, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 349561
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.156670093536377
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.156 Vali Acc: 0.105 Test Loss: 2.156 Test Acc: 0.105
Validation loss decreased (inf --> -0.105384).  Saving model ...
Epoch: 2 cost time: 3.7754673957824707
Epoch: 2, Steps: 17 | Train Loss: 2.125 Vali Loss: 2.072 Vali Acc: 0.157 Test Loss: 2.072 Test Acc: 0.157
Validation loss decreased (-0.105384 --> -0.156736).  Saving model ...
Epoch: 3 cost time: 3.8608617782592773
Epoch: 3, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.966 Vali Acc: 0.270 Test Loss: 1.966 Test Acc: 0.270
Validation loss decreased (-0.156736 --> -0.270251).  Saving model ...
Epoch: 4 cost time: 3.814021348953247
Epoch: 4, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.838 Vali Acc: 0.519 Test Loss: 1.838 Test Acc: 0.519
Validation loss decreased (-0.270251 --> -0.518901).  Saving model ...
Epoch: 5 cost time: 3.8178629875183105
Epoch: 5, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.691 Vali Acc: 0.695 Test Loss: 1.691 Test Acc: 0.695
Validation loss decreased (-0.518901 --> -0.694578).  Saving model ...
Epoch: 6 cost time: 3.535629987716675
Epoch: 6, Steps: 17 | Train Loss: 1.583 Vali Loss: 1.531 Vali Acc: 0.795 Test Loss: 1.531 Test Acc: 0.795
Validation loss decreased (-0.694578 --> -0.794579).  Saving model ...
Epoch: 7 cost time: 3.672731876373291
Epoch: 7, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.352 Vali Acc: 0.830 Test Loss: 1.352 Test Acc: 0.830
Validation loss decreased (-0.794579 --> -0.829716).  Saving model ...
Epoch: 8 cost time: 3.682971477508545
Epoch: 8, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.166 Vali Acc: 0.846 Test Loss: 1.166 Test Acc: 0.846
Validation loss decreased (-0.829716 --> -0.845934).  Saving model ...
Epoch: 9 cost time: 3.6550800800323486
Epoch: 9, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.012 Vali Acc: 0.854 Test Loss: 1.012 Test Acc: 0.854
Validation loss decreased (-0.845934 --> -0.854044).  Saving model ...
Epoch: 10 cost time: 3.6503732204437256
Epoch: 10, Steps: 17 | Train Loss: 0.860 Vali Loss: 0.881 Vali Acc: 0.876 Test Loss: 0.881 Test Acc: 0.876
Validation loss decreased (-0.854044 --> -0.875667).  Saving model ...
Epoch: 11 cost time: 3.5151729583740234
Epoch: 11, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.744 Vali Acc: 0.897 Test Loss: 0.744 Test Acc: 0.897
Validation loss decreased (-0.875667 --> -0.897290).  Saving model ...
Epoch: 12 cost time: 3.704230308532715
Epoch: 12, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.655 Vali Acc: 0.903 Test Loss: 0.655 Test Acc: 0.903
Validation loss decreased (-0.897290 --> -0.902696).  Saving model ...
Epoch: 13 cost time: 3.733445167541504
Epoch: 13, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.560 Vali Acc: 0.927 Test Loss: 0.560 Test Acc: 0.927
Validation loss decreased (-0.902696 --> -0.927021).  Saving model ...
Epoch: 14 cost time: 3.724849224090576
Epoch: 14, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.478 Vali Acc: 0.938 Test Loss: 0.478 Test Acc: 0.938
Validation loss decreased (-0.927021 --> -0.937833).  Saving model ...
Epoch: 15 cost time: 3.714832067489624
Epoch: 15, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.429 Vali Acc: 0.930 Test Loss: 0.429 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.769426107406616
Epoch: 16, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.364 Vali Acc: 0.946 Test Loss: 0.364 Test Acc: 0.946
Validation loss decreased (-0.937833 --> -0.945942).  Saving model ...
Epoch: 17 cost time: 3.7143943309783936
Epoch: 17, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.335 Vali Acc: 0.943 Test Loss: 0.335 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.512988567352295
Epoch: 18, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.293 Vali Acc: 0.954 Test Loss: 0.293 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954051).  Saving model ...
Epoch: 19 cost time: 3.522142171859741
Epoch: 19, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.519650459289551
Epoch: 20, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 21 cost time: 3.5087761878967285
Epoch: 21, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
Validation loss decreased (-0.959457 --> -0.972971).  Saving model ...
Epoch: 22 cost time: 3.6404263973236084
Epoch: 22, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5598390102386475
Epoch: 23, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6580803394317627
Epoch: 24, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.677459955215454
Epoch: 25, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.751004219055176
Epoch: 26, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.6689517498016357
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.6241650581359863
Epoch: 28, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.485653877258301
Epoch: 29, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.6528873443603516
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1177273
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.5164573192596436
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.154 Vali Acc: 0.135 Test Loss: 2.154 Test Acc: 0.135
Validation loss decreased (inf --> -0.135114).  Saving model ...
Epoch: 2 cost time: 3.010664939880371
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.072 Vali Acc: 0.230 Test Loss: 2.072 Test Acc: 0.230
Validation loss decreased (-0.135114 --> -0.229709).  Saving model ...
Epoch: 3 cost time: 3.1758546829223633
Epoch: 3, Steps: 17 | Train Loss: 2.059 Vali Loss: 1.963 Vali Acc: 0.432 Test Loss: 1.963 Test Acc: 0.432
Validation loss decreased (-0.229709 --> -0.432413).  Saving model ...
Epoch: 4 cost time: 3.167802095413208
Epoch: 4, Steps: 17 | Train Loss: 1.907 Vali Loss: 1.830 Vali Acc: 0.643 Test Loss: 1.830 Test Acc: 0.643
Validation loss decreased (-0.432413 --> -0.643225).  Saving model ...
Epoch: 5 cost time: 3.180689573287964
Epoch: 5, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.676 Vali Acc: 0.735 Test Loss: 1.676 Test Acc: 0.735
Validation loss decreased (-0.643225 --> -0.735118).  Saving model ...
Epoch: 6 cost time: 3.1566667556762695
Epoch: 6, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.511 Vali Acc: 0.805 Test Loss: 1.511 Test Acc: 0.805
Validation loss decreased (-0.735118 --> -0.805390).  Saving model ...
Epoch: 7 cost time: 3.0946333408355713
Epoch: 7, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.331 Vali Acc: 0.832 Test Loss: 1.331 Test Acc: 0.832
Validation loss decreased (-0.805390 --> -0.832419).  Saving model ...
Epoch: 8 cost time: 3.0729095935821533
Epoch: 8, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.164 Vali Acc: 0.851 Test Loss: 1.164 Test Acc: 0.851
Validation loss decreased (-0.832419 --> -0.851340).  Saving model ...
Epoch: 9 cost time: 3.2461345195770264
Epoch: 9, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.012 Vali Acc: 0.873 Test Loss: 1.012 Test Acc: 0.873
Validation loss decreased (-0.851340 --> -0.872963).  Saving model ...
Epoch: 10 cost time: 3.1462478637695312
Epoch: 10, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.882 Vali Acc: 0.884 Test Loss: 0.882 Test Acc: 0.884
Validation loss decreased (-0.872963 --> -0.883775).  Saving model ...
Epoch: 11 cost time: 3.2497904300689697
Epoch: 11, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.763 Vali Acc: 0.895 Test Loss: 0.763 Test Acc: 0.895
Validation loss decreased (-0.883775 --> -0.894587).  Saving model ...
Epoch: 12 cost time: 3.1635963916778564
Epoch: 12, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.673 Vali Acc: 0.914 Test Loss: 0.673 Test Acc: 0.914
Validation loss decreased (-0.894587 --> -0.913507).  Saving model ...
Epoch: 13 cost time: 3.2100212574005127
Epoch: 13, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.576 Vali Acc: 0.924 Test Loss: 0.576 Test Acc: 0.924
Validation loss decreased (-0.913507 --> -0.924319).  Saving model ...
Epoch: 14 cost time: 3.354753017425537
Epoch: 14, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.511 Vali Acc: 0.927 Test Loss: 0.511 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927022).  Saving model ...
Epoch: 15 cost time: 3.1786625385284424
Epoch: 15, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.454 Vali Acc: 0.930 Test Loss: 0.454 Test Acc: 0.930
Validation loss decreased (-0.927022 --> -0.929725).  Saving model ...
Epoch: 16 cost time: 3.196526050567627
Epoch: 16, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929726).  Saving model ...
Epoch: 17 cost time: 3.232537269592285
Epoch: 17, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.356 Vali Acc: 0.932 Test Loss: 0.356 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 3.165621280670166
Epoch: 18, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 3.145597457885742
Epoch: 19, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.291 Vali Acc: 0.938 Test Loss: 0.291 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2800145149230957
Epoch: 20, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
Validation loss decreased (-0.940537 --> -0.951349).  Saving model ...
Epoch: 21 cost time: 3.2433021068573
Epoch: 21, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0899863243103027
Epoch: 22, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.230 Vali Acc: 0.946 Test Loss: 0.230 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9513590335845947
Epoch: 23, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1556079387664795
Epoch: 24, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 3.0544474124908447
Epoch: 25, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.204 Vali Acc: 0.938 Test Loss: 0.204 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.1695337295532227
Epoch: 26, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0778167247772217
Epoch: 27, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.969794750213623
Epoch: 28, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.057236909866333
Epoch: 29, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 2.951029062271118
Epoch: 30, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 349561
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 14.631062269210815
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.164 Vali Acc: 0.105 Test Loss: 2.164 Test Acc: 0.105
Validation loss decreased (inf --> -0.105384).  Saving model ...
Epoch: 2 cost time: 11.322946071624756
Epoch: 2, Steps: 17 | Train Loss: 2.154 Vali Loss: 2.089 Vali Acc: 0.200 Test Loss: 2.089 Test Acc: 0.200
Validation loss decreased (-0.105384 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 12.221550464630127
Epoch: 3, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.993 Vali Acc: 0.359 Test Loss: 1.993 Test Acc: 0.359
Validation loss decreased (-0.199979 --> -0.359440).  Saving model ...
Epoch: 4 cost time: 11.935330390930176
Epoch: 4, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.876 Vali Acc: 0.538 Test Loss: 1.876 Test Acc: 0.538
Validation loss decreased (-0.359440 --> -0.537819).  Saving model ...
Epoch: 5 cost time: 12.289101123809814
Epoch: 5, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.744 Vali Acc: 0.649 Test Loss: 1.744 Test Acc: 0.649
Validation loss decreased (-0.537819 --> -0.648631).  Saving model ...
Epoch: 6 cost time: 12.365071296691895
Epoch: 6, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.586 Vali Acc: 0.730 Test Loss: 1.586 Test Acc: 0.730
Validation loss decreased (-0.648631 --> -0.729714).  Saving model ...
Epoch: 7 cost time: 12.493489980697632
Epoch: 7, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.415 Vali Acc: 0.751 Test Loss: 1.415 Test Acc: 0.751
Validation loss decreased (-0.729714 --> -0.751337).  Saving model ...
Epoch: 8 cost time: 12.36298942565918
Epoch: 8, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.231 Vali Acc: 0.805 Test Loss: 1.231 Test Acc: 0.805
Validation loss decreased (-0.751337 --> -0.805393).  Saving model ...
Epoch: 9 cost time: 12.103567361831665
Epoch: 9, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.060 Vali Acc: 0.819 Test Loss: 1.060 Test Acc: 0.819
Validation loss decreased (-0.805393 --> -0.818908).  Saving model ...
Epoch: 10 cost time: 12.152282238006592
Epoch: 10, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.902 Vali Acc: 0.859 Test Loss: 0.902 Test Acc: 0.859
Validation loss decreased (-0.818908 --> -0.859450).  Saving model ...
Epoch: 11 cost time: 12.332920789718628
Epoch: 11, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.774 Vali Acc: 0.865 Test Loss: 0.774 Test Acc: 0.865
Validation loss decreased (-0.859450 --> -0.864857).  Saving model ...
Epoch: 12 cost time: 11.9882333278656
Epoch: 12, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.648 Vali Acc: 0.881 Test Loss: 0.648 Test Acc: 0.881
Validation loss decreased (-0.864857 --> -0.881075).  Saving model ...
Epoch: 13 cost time: 11.95271921157837
Epoch: 13, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.561 Vali Acc: 0.905 Test Loss: 0.561 Test Acc: 0.905
Validation loss decreased (-0.881075 --> -0.905400).  Saving model ...
Epoch: 14 cost time: 12.14501166343689
Epoch: 14, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.455 Vali Acc: 0.924 Test Loss: 0.455 Test Acc: 0.924
Validation loss decreased (-0.905400 --> -0.924320).  Saving model ...
Epoch: 15 cost time: 12.12419605255127
Epoch: 15, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.417 Vali Acc: 0.916 Test Loss: 0.417 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.049499273300171
Epoch: 16, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.330 Vali Acc: 0.943 Test Loss: 0.330 Test Acc: 0.943
Validation loss decreased (-0.924320 --> -0.943240).  Saving model ...
Epoch: 17 cost time: 12.31385850906372
Epoch: 17, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.408859252929688
Epoch: 18, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.241 Vali Acc: 0.959 Test Loss: 0.241 Test Acc: 0.959
Validation loss decreased (-0.943240 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 12.51139760017395
Epoch: 19, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.247 Vali Acc: 0.935 Test Loss: 0.247 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 12.426549911499023
Epoch: 20, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970268).  Saving model ...
Epoch: 21 cost time: 12.534398555755615
Epoch: 21, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.80704665184021
Epoch: 22, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.923142910003662
Epoch: 23, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.74141550064087
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972971).  Saving model ...
Epoch: 25 cost time: 12.675379037857056
Epoch: 25, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 12.751523971557617
Epoch: 26, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
Validation loss decreased (-0.972971 --> -0.975674).  Saving model ...
Epoch: 27 cost time: 12.86699914932251
Epoch: 27, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975674).  Saving model ...
Epoch: 28 cost time: 12.594359397888184
Epoch: 28, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 12.27664303779602
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 12.382651805877686
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 591161
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.74139404296875
Epoch: 1, Steps: 17 | Train Loss: 2.294 Vali Loss: 2.240 Vali Acc: 0.151 Test Loss: 2.240 Test Acc: 0.151
Validation loss decreased (inf --> -0.151329).  Saving model ...
Epoch: 2 cost time: 7.584853887557983
Epoch: 2, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.149 Vali Acc: 0.216 Test Loss: 2.149 Test Acc: 0.216
Validation loss decreased (-0.151329 --> -0.216195).  Saving model ...
Epoch: 3 cost time: 7.683884143829346
Epoch: 3, Steps: 17 | Train Loss: 2.115 Vali Loss: 2.032 Vali Acc: 0.316 Test Loss: 2.032 Test Acc: 0.316
Validation loss decreased (-0.216195 --> -0.316196).  Saving model ...
Epoch: 4 cost time: 7.651421070098877
Epoch: 4, Steps: 17 | Train Loss: 1.977 Vali Loss: 1.897 Vali Acc: 0.454 Test Loss: 1.897 Test Acc: 0.454
Validation loss decreased (-0.316196 --> -0.454035).  Saving model ...
Epoch: 5 cost time: 7.752691984176636
Epoch: 5, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.750 Vali Acc: 0.614 Test Loss: 1.750 Test Acc: 0.614
Validation loss decreased (-0.454035 --> -0.613496).  Saving model ...
Epoch: 6 cost time: 7.7236411571502686
Epoch: 6, Steps: 17 | Train Loss: 1.655 Vali Loss: 1.587 Vali Acc: 0.762 Test Loss: 1.587 Test Acc: 0.762
Validation loss decreased (-0.613496 --> -0.762146).  Saving model ...
Epoch: 7 cost time: 7.681560516357422
Epoch: 7, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.420 Vali Acc: 0.822 Test Loss: 1.420 Test Acc: 0.822
Validation loss decreased (-0.762146 --> -0.821607).  Saving model ...
Epoch: 8 cost time: 7.659945487976074
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.250 Vali Acc: 0.843 Test Loss: 1.250 Test Acc: 0.843
Validation loss decreased (-0.821607 --> -0.843231).  Saving model ...
Epoch: 9 cost time: 7.690554141998291
Epoch: 9, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.091 Vali Acc: 0.846 Test Loss: 1.091 Test Acc: 0.846
Validation loss decreased (-0.843231 --> -0.845935).  Saving model ...
Epoch: 10 cost time: 7.581997632980347
Epoch: 10, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.939 Vali Acc: 0.870 Test Loss: 0.939 Test Acc: 0.870
Validation loss decreased (-0.845935 --> -0.870261).  Saving model ...
Epoch: 11 cost time: 7.726757049560547
Epoch: 11, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.811 Vali Acc: 0.876 Test Loss: 0.811 Test Acc: 0.876
Validation loss decreased (-0.870261 --> -0.875668).  Saving model ...
Epoch: 12 cost time: 7.982726097106934
Epoch: 12, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.699 Vali Acc: 0.897 Test Loss: 0.699 Test Acc: 0.897
Validation loss decreased (-0.875668 --> -0.897290).  Saving model ...
Epoch: 13 cost time: 7.676661968231201
Epoch: 13, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.607 Vali Acc: 0.911 Test Loss: 0.607 Test Acc: 0.911
Validation loss decreased (-0.897290 --> -0.910805).  Saving model ...
Epoch: 14 cost time: 8.044482707977295
Epoch: 14, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.535 Vali Acc: 0.908 Test Loss: 0.535 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.057648658752441
Epoch: 15, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.480 Vali Acc: 0.916 Test Loss: 0.480 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 7.951139688491821
Epoch: 16, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.416 Vali Acc: 0.932 Test Loss: 0.416 Test Acc: 0.932
Validation loss decreased (-0.916211 --> -0.932428).  Saving model ...
Epoch: 17 cost time: 7.70576810836792
Epoch: 17, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.378 Vali Acc: 0.914 Test Loss: 0.378 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.738065004348755
Epoch: 18, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.338 Vali Acc: 0.932 Test Loss: 0.338 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 19 cost time: 7.902469635009766
Epoch: 19, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 20 cost time: 8.014176368713379
Epoch: 20, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.166777610778809
Epoch: 21, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 22 cost time: 8.188217163085938
Epoch: 22, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.252 Vali Acc: 0.938 Test Loss: 0.252 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 8.072328567504883
Epoch: 23, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.236 Vali Acc: 0.938 Test Loss: 0.236 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 24 cost time: 7.950917720794678
Epoch: 24, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 25 cost time: 7.323651552200317
Epoch: 25, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.923130512237549
Epoch: 26, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 27 cost time: 8.12093734741211
Epoch: 27, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.056607723236084
Epoch: 28, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 8.145506620407104
Epoch: 29, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 7.997072219848633
Epoch: 30, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 177273
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 11.387248039245605
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.164 Vali Acc: 0.105 Test Loss: 2.164 Test Acc: 0.105
Validation loss decreased (inf --> -0.105384).  Saving model ...
Epoch: 2 cost time: 9.12162971496582
Epoch: 2, Steps: 17 | Train Loss: 2.154 Vali Loss: 2.089 Vali Acc: 0.200 Test Loss: 2.089 Test Acc: 0.200
Validation loss decreased (-0.105384 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 9.430823564529419
Epoch: 3, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.993 Vali Acc: 0.359 Test Loss: 1.993 Test Acc: 0.359
Validation loss decreased (-0.199979 --> -0.359440).  Saving model ...
Epoch: 4 cost time: 9.443571090698242
Epoch: 4, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.876 Vali Acc: 0.538 Test Loss: 1.876 Test Acc: 0.538
Validation loss decreased (-0.359440 --> -0.537819).  Saving model ...
Epoch: 5 cost time: 9.451595306396484
Epoch: 5, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.745 Vali Acc: 0.649 Test Loss: 1.745 Test Acc: 0.649
Validation loss decreased (-0.537819 --> -0.648631).  Saving model ...
Epoch: 6 cost time: 8.923996210098267
Epoch: 6, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.586 Vali Acc: 0.730 Test Loss: 1.586 Test Acc: 0.730
Validation loss decreased (-0.648631 --> -0.729714).  Saving model ...
Epoch: 7 cost time: 8.986814975738525
Epoch: 7, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.416 Vali Acc: 0.749 Test Loss: 1.416 Test Acc: 0.749
Validation loss decreased (-0.729714 --> -0.748634).  Saving model ...
Epoch: 8 cost time: 8.750249147415161
Epoch: 8, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.232 Vali Acc: 0.800 Test Loss: 1.232 Test Acc: 0.800
Validation loss decreased (-0.748634 --> -0.799988).  Saving model ...
Epoch: 9 cost time: 9.023326635360718
Epoch: 9, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.061 Vali Acc: 0.819 Test Loss: 1.061 Test Acc: 0.819
Validation loss decreased (-0.799988 --> -0.818908).  Saving model ...
Epoch: 10 cost time: 7.528099775314331
Epoch: 10, Steps: 17 | Train Loss: 0.913 Vali Loss: 0.904 Vali Acc: 0.859 Test Loss: 0.904 Test Acc: 0.859
Validation loss decreased (-0.818908 --> -0.859450).  Saving model ...
Epoch: 11 cost time: 9.113348960876465
Epoch: 11, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.772 Vali Acc: 0.865 Test Loss: 0.772 Test Acc: 0.865
Validation loss decreased (-0.859450 --> -0.864857).  Saving model ...
Epoch: 12 cost time: 9.029437780380249
Epoch: 12, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.649 Vali Acc: 0.878 Test Loss: 0.649 Test Acc: 0.878
Validation loss decreased (-0.864857 --> -0.878372).  Saving model ...
Epoch: 13 cost time: 9.083956718444824
Epoch: 13, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.559 Vali Acc: 0.911 Test Loss: 0.559 Test Acc: 0.911
Validation loss decreased (-0.878372 --> -0.910805).  Saving model ...
Epoch: 14 cost time: 8.75191330909729
Epoch: 14, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.455 Vali Acc: 0.927 Test Loss: 0.455 Test Acc: 0.927
Validation loss decreased (-0.910805 --> -0.927022).  Saving model ...
Epoch: 15 cost time: 8.904587268829346
Epoch: 15, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.418 Vali Acc: 0.919 Test Loss: 0.418 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.80839204788208
Epoch: 16, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.330 Vali Acc: 0.943 Test Loss: 0.330 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943240).  Saving model ...
Epoch: 17 cost time: 8.765780210494995
Epoch: 17, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.72743821144104
Epoch: 18, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.241 Vali Acc: 0.959 Test Loss: 0.241 Test Acc: 0.959
Validation loss decreased (-0.943240 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 8.465942144393921
Epoch: 19, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.781785249710083
Epoch: 20, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970268).  Saving model ...
Epoch: 21 cost time: 8.853263139724731
Epoch: 21, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.200 Vali Acc: 0.962 Test Loss: 0.200 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.796114683151245
Epoch: 22, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.814807653427124
Epoch: 23, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.697416543960571
Epoch: 24, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 9.048160552978516
Epoch: 25, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.047747135162354
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 8.936036825180054
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975674).  Saving model ...
Epoch: 28 cost time: 9.136186838150024
Epoch: 28, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 9.114256620407104
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 9.179856061935425
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
Validation loss decreased (-0.975674 --> -0.978377).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 591161
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 8.480933666229248
Epoch: 1, Steps: 17 | Train Loss: 2.294 Vali Loss: 2.240 Vali Acc: 0.151 Test Loss: 2.240 Test Acc: 0.151
Validation loss decreased (inf --> -0.151329).  Saving model ...
Epoch: 2 cost time: 6.084758043289185
Epoch: 2, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.149 Vali Acc: 0.216 Test Loss: 2.149 Test Acc: 0.216
Validation loss decreased (-0.151329 --> -0.216195).  Saving model ...
Epoch: 3 cost time: 6.031416177749634
Epoch: 3, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.032 Vali Acc: 0.314 Test Loss: 2.032 Test Acc: 0.314
Validation loss decreased (-0.216195 --> -0.313493).  Saving model ...
Epoch: 4 cost time: 6.039790868759155
Epoch: 4, Steps: 17 | Train Loss: 1.977 Vali Loss: 1.898 Vali Acc: 0.449 Test Loss: 1.898 Test Acc: 0.449
Validation loss decreased (-0.313493 --> -0.448630).  Saving model ...
Epoch: 5 cost time: 6.053822994232178
Epoch: 5, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.751 Vali Acc: 0.611 Test Loss: 1.751 Test Acc: 0.611
Validation loss decreased (-0.448630 --> -0.610793).  Saving model ...
Epoch: 6 cost time: 6.169928550720215
Epoch: 6, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.589 Vali Acc: 0.765 Test Loss: 1.589 Test Acc: 0.765
Validation loss decreased (-0.610793 --> -0.764849).  Saving model ...
Epoch: 7 cost time: 6.052246332168579
Epoch: 7, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.421 Vali Acc: 0.824 Test Loss: 1.421 Test Acc: 0.824
Validation loss decreased (-0.764849 --> -0.824310).  Saving model ...
Epoch: 8 cost time: 6.112070560455322
Epoch: 8, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.251 Vali Acc: 0.843 Test Loss: 1.251 Test Acc: 0.843
Validation loss decreased (-0.824310 --> -0.843231).  Saving model ...
Epoch: 9 cost time: 6.030466794967651
Epoch: 9, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.093 Vali Acc: 0.843 Test Loss: 1.093 Test Acc: 0.843
Validation loss decreased (-0.843231 --> -0.843232).  Saving model ...
Epoch: 10 cost time: 5.993878364562988
Epoch: 10, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.940 Vali Acc: 0.870 Test Loss: 0.940 Test Acc: 0.870
Validation loss decreased (-0.843232 --> -0.870261).  Saving model ...
Epoch: 11 cost time: 5.971436023712158
Epoch: 11, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.813 Vali Acc: 0.878 Test Loss: 0.813 Test Acc: 0.878
Validation loss decreased (-0.870261 --> -0.878370).  Saving model ...
Epoch: 12 cost time: 6.031022310256958
Epoch: 12, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.701 Vali Acc: 0.897 Test Loss: 0.701 Test Acc: 0.897
Validation loss decreased (-0.878370 --> -0.897290).  Saving model ...
Epoch: 13 cost time: 6.127451658248901
Epoch: 13, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.609 Vali Acc: 0.908 Test Loss: 0.609 Test Acc: 0.908
Validation loss decreased (-0.897290 --> -0.908102).  Saving model ...
Epoch: 14 cost time: 6.124307870864868
Epoch: 14, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.537 Vali Acc: 0.911 Test Loss: 0.537 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 15 cost time: 6.089451551437378
Epoch: 15, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.482 Vali Acc: 0.916 Test Loss: 0.482 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 5.9302284717559814
Epoch: 16, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.418 Vali Acc: 0.932 Test Loss: 0.418 Test Acc: 0.932
Validation loss decreased (-0.916211 --> -0.932428).  Saving model ...
Epoch: 17 cost time: 6.033215284347534
Epoch: 17, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.377 Vali Acc: 0.919 Test Loss: 0.377 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.132647275924683
Epoch: 18, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.338 Vali Acc: 0.932 Test Loss: 0.338 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 19 cost time: 6.127991437911987
Epoch: 19, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.304 Vali Acc: 0.932 Test Loss: 0.304 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 20 cost time: 6.172002077102661
Epoch: 20, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.298 Vali Acc: 0.935 Test Loss: 0.298 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 21 cost time: 6.062565088272095
Epoch: 21, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 22 cost time: 6.046225070953369
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 23 cost time: 6.137986421585083
Epoch: 23, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.013973951339722
Epoch: 24, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 25 cost time: 6.2063844203948975
Epoch: 25, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 26 cost time: 6.161505937576294
Epoch: 26, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 27 cost time: 6.008007287979126
Epoch: 27, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 28 cost time: 5.861367225646973
Epoch: 28, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.976650238037109
Epoch: 29, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.132885932922363
Epoch: 30, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.166 Vali Acc: 0.943 Test Loss: 0.166 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 177273
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.69899582862854
Epoch: 1, Steps: 17 | Train Loss: 2.228 Vali Loss: 2.165 Vali Acc: 0.105 Test Loss: 2.165 Test Acc: 0.105
Validation loss decreased (inf --> -0.105384).  Saving model ...
Epoch: 2 cost time: 5.381911754608154
Epoch: 2, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.092 Vali Acc: 0.192 Test Loss: 2.092 Test Acc: 0.192
Validation loss decreased (-0.105384 --> -0.191871).  Saving model ...
Epoch: 3 cost time: 5.329848527908325
Epoch: 3, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.999 Vali Acc: 0.354 Test Loss: 1.999 Test Acc: 0.354
Validation loss decreased (-0.191871 --> -0.354034).  Saving model ...
Epoch: 4 cost time: 5.352452039718628
Epoch: 4, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.886 Vali Acc: 0.511 Test Loss: 1.886 Test Acc: 0.511
Validation loss decreased (-0.354034 --> -0.510792).  Saving model ...
Epoch: 5 cost time: 5.2912209033966064
Epoch: 5, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.764 Vali Acc: 0.611 Test Loss: 1.764 Test Acc: 0.611
Validation loss decreased (-0.510792 --> -0.610793).  Saving model ...
Epoch: 6 cost time: 5.379747152328491
Epoch: 6, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.618 Vali Acc: 0.722 Test Loss: 1.618 Test Acc: 0.722
Validation loss decreased (-0.610793 --> -0.721605).  Saving model ...
Epoch: 7 cost time: 5.4145731925964355
Epoch: 7, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.463 Vali Acc: 0.762 Test Loss: 1.463 Test Acc: 0.762
Validation loss decreased (-0.721605 --> -0.762148).  Saving model ...
Epoch: 8 cost time: 5.343197584152222
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.299 Vali Acc: 0.797 Test Loss: 1.299 Test Acc: 0.797
Validation loss decreased (-0.762148 --> -0.797284).  Saving model ...
Epoch: 9 cost time: 5.3004372119903564
Epoch: 9, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.135 Vali Acc: 0.816 Test Loss: 1.135 Test Acc: 0.816
Validation loss decreased (-0.797284 --> -0.816205).  Saving model ...
Epoch: 10 cost time: 5.150129318237305
Epoch: 10, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.002 Vali Acc: 0.838 Test Loss: 1.002 Test Acc: 0.838
Validation loss decreased (-0.816205 --> -0.837828).  Saving model ...
Epoch: 11 cost time: 5.338857173919678
Epoch: 11, Steps: 17 | Train Loss: 0.855 Vali Loss: 0.851 Vali Acc: 0.876 Test Loss: 0.851 Test Acc: 0.876
Validation loss decreased (-0.837828 --> -0.875667).  Saving model ...
Epoch: 12 cost time: 5.1505067348480225
Epoch: 12, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.750 Vali Acc: 0.881 Test Loss: 0.750 Test Acc: 0.881
Validation loss decreased (-0.875667 --> -0.881074).  Saving model ...
Epoch: 13 cost time: 5.47896146774292
Epoch: 13, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.636 Vali Acc: 0.914 Test Loss: 0.636 Test Acc: 0.914
Validation loss decreased (-0.881074 --> -0.913507).  Saving model ...
Epoch: 14 cost time: 5.216736555099487
Epoch: 14, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.544 Vali Acc: 0.927 Test Loss: 0.544 Test Acc: 0.927
Validation loss decreased (-0.913507 --> -0.927022).  Saving model ...
Epoch: 15 cost time: 5.28639817237854
Epoch: 15, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.479 Vali Acc: 0.938 Test Loss: 0.479 Test Acc: 0.938
Validation loss decreased (-0.927022 --> -0.937833).  Saving model ...
Epoch: 16 cost time: 5.525169610977173
Epoch: 16, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.392 Vali Acc: 0.957 Test Loss: 0.392 Test Acc: 0.957
Validation loss decreased (-0.937833 --> -0.956753).  Saving model ...
Epoch: 17 cost time: 5.584819078445435
Epoch: 17, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.349 Vali Acc: 0.943 Test Loss: 0.349 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.556968450546265
Epoch: 18, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.296 Vali Acc: 0.959 Test Loss: 0.296 Test Acc: 0.959
Validation loss decreased (-0.956753 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 4.97299599647522
Epoch: 19, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.273 Vali Acc: 0.946 Test Loss: 0.273 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.634995460510254
Epoch: 20, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 21 cost time: 5.637933015823364
Epoch: 21, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.719245433807373
Epoch: 22, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.212 Vali Acc: 0.954 Test Loss: 0.212 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.547692060470581
Epoch: 23, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 24 cost time: 5.559326171875
Epoch: 24, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.590955972671509
Epoch: 25, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.339787483215332
Epoch: 26, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.815020322799683
Epoch: 27, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.80626654624939
Epoch: 28, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 5.8112633228302
Epoch: 29, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.75108528137207
Epoch: 30, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 591161
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.008140802383423
Epoch: 1, Steps: 17 | Train Loss: 2.295 Vali Loss: 2.242 Vali Acc: 0.149 Test Loss: 2.242 Test Acc: 0.149
Validation loss decreased (inf --> -0.148626).  Saving model ...
Epoch: 2 cost time: 3.9459116458892822
Epoch: 2, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.153 Vali Acc: 0.216 Test Loss: 2.153 Test Acc: 0.216
Validation loss decreased (-0.148626 --> -0.216195).  Saving model ...
Epoch: 3 cost time: 4.077841281890869
Epoch: 3, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.039 Vali Acc: 0.305 Test Loss: 2.039 Test Acc: 0.305
Validation loss decreased (-0.216195 --> -0.305385).  Saving model ...
Epoch: 4 cost time: 4.065510511398315
Epoch: 4, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.909 Vali Acc: 0.430 Test Loss: 1.909 Test Acc: 0.430
Validation loss decreased (-0.305385 --> -0.429711).  Saving model ...
Epoch: 5 cost time: 4.031225681304932
Epoch: 5, Steps: 17 | Train Loss: 1.823 Vali Loss: 1.769 Vali Acc: 0.603 Test Loss: 1.769 Test Acc: 0.603
Validation loss decreased (-0.429711 --> -0.602685).  Saving model ...
Epoch: 6 cost time: 4.113081216812134
Epoch: 6, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.617 Vali Acc: 0.754 Test Loss: 1.617 Test Acc: 0.754
Validation loss decreased (-0.602685 --> -0.754038).  Saving model ...
Epoch: 7 cost time: 3.98410964012146
Epoch: 7, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.465 Vali Acc: 0.822 Test Loss: 1.465 Test Acc: 0.822
Validation loss decreased (-0.754038 --> -0.821607).  Saving model ...
Epoch: 8 cost time: 4.067410230636597
Epoch: 8, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.310 Vali Acc: 0.849 Test Loss: 1.310 Test Acc: 0.849
Validation loss decreased (-0.821607 --> -0.848636).  Saving model ...
Epoch: 9 cost time: 4.01927924156189
Epoch: 9, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.161 Vali Acc: 0.849 Test Loss: 1.161 Test Acc: 0.849
Validation loss decreased (-0.848636 --> -0.848637).  Saving model ...
Epoch: 10 cost time: 3.9865224361419678
Epoch: 10, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.016 Vali Acc: 0.878 Test Loss: 1.016 Test Acc: 0.878
Validation loss decreased (-0.848637 --> -0.878368).  Saving model ...
Epoch: 11 cost time: 4.107389450073242
Epoch: 11, Steps: 17 | Train Loss: 0.879 Vali Loss: 0.887 Vali Acc: 0.892 Test Loss: 0.887 Test Acc: 0.892
Validation loss decreased (-0.878368 --> -0.891883).  Saving model ...
Epoch: 12 cost time: 3.9869916439056396
Epoch: 12, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.769 Vali Acc: 0.911 Test Loss: 0.769 Test Acc: 0.911
Validation loss decreased (-0.891883 --> -0.910803).  Saving model ...
Epoch: 13 cost time: 4.003062963485718
Epoch: 13, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.674 Vali Acc: 0.916 Test Loss: 0.674 Test Acc: 0.916
Validation loss decreased (-0.910803 --> -0.916209).  Saving model ...
Epoch: 14 cost time: 4.095725774765015
Epoch: 14, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.598 Vali Acc: 0.919 Test Loss: 0.598 Test Acc: 0.919
Validation loss decreased (-0.916209 --> -0.918913).  Saving model ...
Epoch: 15 cost time: 3.850350856781006
Epoch: 15, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.526 Vali Acc: 0.927 Test Loss: 0.526 Test Acc: 0.927
Validation loss decreased (-0.918913 --> -0.927022).  Saving model ...
Epoch: 16 cost time: 3.8952038288116455
Epoch: 16, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.458 Vali Acc: 0.932 Test Loss: 0.458 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 17 cost time: 4.080892562866211
Epoch: 17, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.413 Vali Acc: 0.946 Test Loss: 0.413 Test Acc: 0.946
Validation loss decreased (-0.932428 --> -0.945942).  Saving model ...
Epoch: 18 cost time: 3.66957950592041
Epoch: 18, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.364 Vali Acc: 0.954 Test Loss: 0.364 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954050).  Saving model ...
Epoch: 19 cost time: 4.064666986465454
Epoch: 19, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.328 Vali Acc: 0.951 Test Loss: 0.328 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.118471622467041
Epoch: 20, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.310 Vali Acc: 0.951 Test Loss: 0.310 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.163262605667114
Epoch: 21, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.274 Vali Acc: 0.959 Test Loss: 0.274 Test Acc: 0.959
Validation loss decreased (-0.954050 --> -0.959457).  Saving model ...
Epoch: 22 cost time: 4.074071645736694
Epoch: 22, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.261 Vali Acc: 0.954 Test Loss: 0.261 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.124317646026611
Epoch: 23, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.237 Vali Acc: 0.957 Test Loss: 0.237 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.997443675994873
Epoch: 24, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.215 Vali Acc: 0.959 Test Loss: 0.215 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 25 cost time: 4.07356595993042
Epoch: 25, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.215 Vali Acc: 0.959 Test Loss: 0.215 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 26 cost time: 4.124992370605469
Epoch: 26, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.099151372909546
Epoch: 27, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.1683971881866455
Epoch: 28, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.130764484405518
Epoch: 29, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.072086811065674
Epoch: 30, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 177273
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 14.559648036956787
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.165 Vali Acc: 0.132 Test Loss: 2.165 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 11.951050996780396
Epoch: 2, Steps: 17 | Train Loss: 2.104 Vali Loss: 2.085 Vali Acc: 0.227 Test Loss: 2.085 Test Acc: 0.227
Validation loss decreased (-0.132411 --> -0.227006).  Saving model ...
Epoch: 3 cost time: 11.604681491851807
Epoch: 3, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.980 Vali Acc: 0.400 Test Loss: 1.980 Test Acc: 0.400
Validation loss decreased (-0.227006 --> -0.399980).  Saving model ...
Epoch: 4 cost time: 11.523256063461304
Epoch: 4, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.856 Vali Acc: 0.570 Test Loss: 1.856 Test Acc: 0.570
Validation loss decreased (-0.399980 --> -0.570252).  Saving model ...
Epoch: 5 cost time: 11.500630617141724
Epoch: 5, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.707 Vali Acc: 0.676 Test Loss: 1.707 Test Acc: 0.676
Validation loss decreased (-0.570252 --> -0.675659).  Saving model ...
Epoch: 6 cost time: 11.470539093017578
Epoch: 6, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.532 Vali Acc: 0.703 Test Loss: 1.532 Test Acc: 0.703
Validation loss decreased (-0.675659 --> -0.702687).  Saving model ...
Epoch: 7 cost time: 10.97892689704895
Epoch: 7, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.339 Vali Acc: 0.776 Test Loss: 1.339 Test Acc: 0.776
Validation loss decreased (-0.702687 --> -0.775662).  Saving model ...
Epoch: 8 cost time: 11.362871170043945
Epoch: 8, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.157 Vali Acc: 0.800 Test Loss: 1.157 Test Acc: 0.800
Validation loss decreased (-0.775662 --> -0.799988).  Saving model ...
Epoch: 9 cost time: 11.254570484161377
Epoch: 9, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.006 Vali Acc: 0.811 Test Loss: 1.006 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.810801).  Saving model ...
Epoch: 10 cost time: 11.550124168395996
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.873 Vali Acc: 0.841 Test Loss: 0.873 Test Acc: 0.841
Validation loss decreased (-0.810801 --> -0.840532).  Saving model ...
Epoch: 11 cost time: 11.866254329681396
Epoch: 11, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.762 Vali Acc: 0.862 Test Loss: 0.762 Test Acc: 0.862
Validation loss decreased (-0.840532 --> -0.862155).  Saving model ...
Epoch: 12 cost time: 11.695012092590332
Epoch: 12, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.646 Vali Acc: 0.886 Test Loss: 0.646 Test Acc: 0.886
Validation loss decreased (-0.862155 --> -0.886480).  Saving model ...
Epoch: 13 cost time: 10.7172372341156
Epoch: 13, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.562 Vali Acc: 0.914 Test Loss: 0.562 Test Acc: 0.914
Validation loss decreased (-0.886480 --> -0.913508).  Saving model ...
Epoch: 14 cost time: 12.300494909286499
Epoch: 14, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.491 Vali Acc: 0.911 Test Loss: 0.491 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.284589529037476
Epoch: 15, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.421 Vali Acc: 0.916 Test Loss: 0.421 Test Acc: 0.916
Validation loss decreased (-0.913508 --> -0.916212).  Saving model ...
Epoch: 16 cost time: 12.055621147155762
Epoch: 16, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.386 Vali Acc: 0.914 Test Loss: 0.386 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.131072759628296
Epoch: 17, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
Validation loss decreased (-0.916212 --> -0.929727).  Saving model ...
Epoch: 18 cost time: 12.522234201431274
Epoch: 18, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.457489013671875
Epoch: 19, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937835).  Saving model ...
Epoch: 20 cost time: 11.729894161224365
Epoch: 20, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 12.067262411117554
Epoch: 21, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 12.116558313369751
Epoch: 22, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 11.668154001235962
Epoch: 23, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 11.456182956695557
Epoch: 24, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 11.93596363067627
Epoch: 25, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 11.794581890106201
Epoch: 26, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 11.707671403884888
Epoch: 27, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 11.984101057052612
Epoch: 28, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.161 Vali Acc: 0.949 Test Loss: 0.161 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 11.970324039459229
Epoch: 29, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 12.313002109527588
Epoch: 30, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 298105
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.676764726638794
Epoch: 1, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.117 Vali Acc: 0.165 Test Loss: 2.117 Test Acc: 0.165
Validation loss decreased (inf --> -0.164844).  Saving model ...
Epoch: 2 cost time: 7.135087013244629
Epoch: 2, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.047 Vali Acc: 0.238 Test Loss: 2.047 Test Acc: 0.238
Validation loss decreased (-0.164844 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 7.729671001434326
Epoch: 3, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.956 Vali Acc: 0.373 Test Loss: 1.956 Test Acc: 0.373
Validation loss decreased (-0.237817 --> -0.372953).  Saving model ...
Epoch: 4 cost time: 7.716206312179565
Epoch: 4, Steps: 17 | Train Loss: 1.902 Vali Loss: 1.852 Vali Acc: 0.500 Test Loss: 1.852 Test Acc: 0.500
Validation loss decreased (-0.372953 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 7.6485700607299805
Epoch: 5, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.733 Vali Acc: 0.619 Test Loss: 1.733 Test Acc: 0.619
Validation loss decreased (-0.499981 --> -0.618902).  Saving model ...
Epoch: 6 cost time: 7.49677038192749
Epoch: 6, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.593 Vali Acc: 0.741 Test Loss: 1.593 Test Acc: 0.741
Validation loss decreased (-0.618902 --> -0.740525).  Saving model ...
Epoch: 7 cost time: 7.590724945068359
Epoch: 7, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.440 Vali Acc: 0.805 Test Loss: 1.440 Test Acc: 0.805
Validation loss decreased (-0.740525 --> -0.805391).  Saving model ...
Epoch: 8 cost time: 7.392543792724609
Epoch: 8, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.283 Vali Acc: 0.843 Test Loss: 1.283 Test Acc: 0.843
Validation loss decreased (-0.805391 --> -0.843230).  Saving model ...
Epoch: 9 cost time: 7.468943357467651
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.136 Vali Acc: 0.849 Test Loss: 1.136 Test Acc: 0.849
Validation loss decreased (-0.843230 --> -0.848637).  Saving model ...
Epoch: 10 cost time: 7.3701605796813965
Epoch: 10, Steps: 17 | Train Loss: 1.027 Vali Loss: 0.996 Vali Acc: 0.870 Test Loss: 0.996 Test Acc: 0.870
Validation loss decreased (-0.848637 --> -0.870260).  Saving model ...
Epoch: 11 cost time: 7.270795583724976
Epoch: 11, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.869 Vali Acc: 0.876 Test Loss: 0.869 Test Acc: 0.876
Validation loss decreased (-0.870260 --> -0.875667).  Saving model ...
Epoch: 12 cost time: 7.1720685958862305
Epoch: 12, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.759 Vali Acc: 0.886 Test Loss: 0.759 Test Acc: 0.886
Validation loss decreased (-0.875667 --> -0.886479).  Saving model ...
Epoch: 13 cost time: 7.448655605316162
Epoch: 13, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.653 Vali Acc: 0.911 Test Loss: 0.653 Test Acc: 0.911
Validation loss decreased (-0.886479 --> -0.910804).  Saving model ...
Epoch: 14 cost time: 7.326444625854492
Epoch: 14, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.577 Vali Acc: 0.911 Test Loss: 0.577 Test Acc: 0.911
Validation loss decreased (-0.910804 --> -0.910805).  Saving model ...
Epoch: 15 cost time: 7.348390817642212
Epoch: 15, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.508 Vali Acc: 0.922 Test Loss: 0.508 Test Acc: 0.922
Validation loss decreased (-0.910805 --> -0.921617).  Saving model ...
Epoch: 16 cost time: 7.132199287414551
Epoch: 16, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.276041269302368
Epoch: 17, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.412 Vali Acc: 0.927 Test Loss: 0.412 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 18 cost time: 7.268526077270508
Epoch: 18, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.361 Vali Acc: 0.932 Test Loss: 0.361 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 19 cost time: 7.625563144683838
Epoch: 19, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.330 Vali Acc: 0.941 Test Loss: 0.330 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940537).  Saving model ...
Epoch: 20 cost time: 7.585717439651489
Epoch: 20, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.306 Vali Acc: 0.943 Test Loss: 0.306 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 21 cost time: 7.481935262680054
Epoch: 21, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.270 Vali Acc: 0.938 Test Loss: 0.270 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.493534088134766
Epoch: 22, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.253 Vali Acc: 0.949 Test Loss: 0.253 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 6.531195163726807
Epoch: 23, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.153221607208252
Epoch: 24, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 25 cost time: 7.53403377532959
Epoch: 25, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.412323474884033
Epoch: 26, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.215809106826782
Epoch: 27, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 7.22526216506958
Epoch: 28, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.471078157424927
Epoch: 29, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 30 cost time: 6.731175422668457
Epoch: 30, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 91129
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 9.97615671157837
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.165 Vali Acc: 0.132 Test Loss: 2.165 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 7.839378356933594
Epoch: 2, Steps: 17 | Train Loss: 2.104 Vali Loss: 2.085 Vali Acc: 0.227 Test Loss: 2.085 Test Acc: 0.227
Validation loss decreased (-0.132411 --> -0.227006).  Saving model ...
Epoch: 3 cost time: 7.617682218551636
Epoch: 3, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.980 Vali Acc: 0.400 Test Loss: 1.980 Test Acc: 0.400
Validation loss decreased (-0.227006 --> -0.399980).  Saving model ...
Epoch: 4 cost time: 7.941223382949829
Epoch: 4, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.856 Vali Acc: 0.570 Test Loss: 1.856 Test Acc: 0.570
Validation loss decreased (-0.399980 --> -0.570252).  Saving model ...
Epoch: 5 cost time: 8.155369281768799
Epoch: 5, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.707 Vali Acc: 0.676 Test Loss: 1.707 Test Acc: 0.676
Validation loss decreased (-0.570252 --> -0.675659).  Saving model ...
Epoch: 6 cost time: 7.709688663482666
Epoch: 6, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.532 Vali Acc: 0.703 Test Loss: 1.532 Test Acc: 0.703
Validation loss decreased (-0.675659 --> -0.702687).  Saving model ...
Epoch: 7 cost time: 8.006039142608643
Epoch: 7, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.339 Vali Acc: 0.776 Test Loss: 1.339 Test Acc: 0.776
Validation loss decreased (-0.702687 --> -0.775662).  Saving model ...
Epoch: 8 cost time: 8.168739080429077
Epoch: 8, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.157 Vali Acc: 0.800 Test Loss: 1.157 Test Acc: 0.800
Validation loss decreased (-0.775662 --> -0.799988).  Saving model ...
Epoch: 9 cost time: 8.045175075531006
Epoch: 9, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.006 Vali Acc: 0.811 Test Loss: 1.006 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.810801).  Saving model ...
Epoch: 10 cost time: 6.936678886413574
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.873 Vali Acc: 0.841 Test Loss: 0.873 Test Acc: 0.841
Validation loss decreased (-0.810801 --> -0.840532).  Saving model ...
Epoch: 11 cost time: 7.898367881774902
Epoch: 11, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.762 Vali Acc: 0.862 Test Loss: 0.762 Test Acc: 0.862
Validation loss decreased (-0.840532 --> -0.862155).  Saving model ...
Epoch: 12 cost time: 7.538204908370972
Epoch: 12, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.646 Vali Acc: 0.886 Test Loss: 0.646 Test Acc: 0.886
Validation loss decreased (-0.862155 --> -0.886480).  Saving model ...
Epoch: 13 cost time: 7.05098032951355
Epoch: 13, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.562 Vali Acc: 0.916 Test Loss: 0.562 Test Acc: 0.916
Validation loss decreased (-0.886480 --> -0.916211).  Saving model ...
Epoch: 14 cost time: 7.913543462753296
Epoch: 14, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.490 Vali Acc: 0.911 Test Loss: 0.490 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.700710773468018
Epoch: 15, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.421 Vali Acc: 0.919 Test Loss: 0.421 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918915).  Saving model ...
Epoch: 16 cost time: 7.70323634147644
Epoch: 16, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.386 Vali Acc: 0.914 Test Loss: 0.386 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.94327449798584
Epoch: 17, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
Validation loss decreased (-0.918915 --> -0.929727).  Saving model ...
Epoch: 18 cost time: 8.541213035583496
Epoch: 18, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.004538536071777
Epoch: 19, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937835).  Saving model ...
Epoch: 20 cost time: 8.049177408218384
Epoch: 20, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.233 Vali Acc: 0.946 Test Loss: 0.233 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 7.891997814178467
Epoch: 21, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 7.762692928314209
Epoch: 22, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 6.801282167434692
Epoch: 23, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.549539804458618
Epoch: 24, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 7.375929832458496
Epoch: 25, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 7.739037752151489
Epoch: 26, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.01405382156372
Epoch: 27, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 8.452332019805908
Epoch: 28, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 8.220582962036133
Epoch: 29, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 8.189329385757446
Epoch: 30, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 298105
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 7.954492807388306
Epoch: 1, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.117 Vali Acc: 0.165 Test Loss: 2.117 Test Acc: 0.165
Validation loss decreased (inf --> -0.164844).  Saving model ...
Epoch: 2 cost time: 5.784911632537842
Epoch: 2, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.047 Vali Acc: 0.238 Test Loss: 2.047 Test Acc: 0.238
Validation loss decreased (-0.164844 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 5.866573810577393
Epoch: 3, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.956 Vali Acc: 0.373 Test Loss: 1.956 Test Acc: 0.373
Validation loss decreased (-0.237817 --> -0.372953).  Saving model ...
Epoch: 4 cost time: 5.868635654449463
Epoch: 4, Steps: 17 | Train Loss: 1.902 Vali Loss: 1.852 Vali Acc: 0.500 Test Loss: 1.852 Test Acc: 0.500
Validation loss decreased (-0.372953 --> -0.499981).  Saving model ...
Epoch: 5 cost time: 5.732924938201904
Epoch: 5, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.733 Vali Acc: 0.619 Test Loss: 1.733 Test Acc: 0.619
Validation loss decreased (-0.499981 --> -0.618902).  Saving model ...
Epoch: 6 cost time: 5.716689825057983
Epoch: 6, Steps: 17 | Train Loss: 1.652 Vali Loss: 1.593 Vali Acc: 0.741 Test Loss: 1.593 Test Acc: 0.741
Validation loss decreased (-0.618902 --> -0.740525).  Saving model ...
Epoch: 7 cost time: 4.928215742111206
Epoch: 7, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.440 Vali Acc: 0.805 Test Loss: 1.440 Test Acc: 0.805
Validation loss decreased (-0.740525 --> -0.805391).  Saving model ...
Epoch: 8 cost time: 5.42280387878418
Epoch: 8, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.283 Vali Acc: 0.843 Test Loss: 1.283 Test Acc: 0.843
Validation loss decreased (-0.805391 --> -0.843230).  Saving model ...
Epoch: 9 cost time: 5.327411651611328
Epoch: 9, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.135 Vali Acc: 0.849 Test Loss: 1.135 Test Acc: 0.849
Validation loss decreased (-0.843230 --> -0.848637).  Saving model ...
Epoch: 10 cost time: 5.158829212188721
Epoch: 10, Steps: 17 | Train Loss: 1.027 Vali Loss: 0.996 Vali Acc: 0.870 Test Loss: 0.996 Test Acc: 0.870
Validation loss decreased (-0.848637 --> -0.870260).  Saving model ...
Epoch: 11 cost time: 5.16740608215332
Epoch: 11, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.869 Vali Acc: 0.876 Test Loss: 0.869 Test Acc: 0.876
Validation loss decreased (-0.870260 --> -0.875667).  Saving model ...
Epoch: 12 cost time: 5.272478818893433
Epoch: 12, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.759 Vali Acc: 0.886 Test Loss: 0.759 Test Acc: 0.886
Validation loss decreased (-0.875667 --> -0.886479).  Saving model ...
Epoch: 13 cost time: 5.120910882949829
Epoch: 13, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.653 Vali Acc: 0.908 Test Loss: 0.653 Test Acc: 0.908
Validation loss decreased (-0.886479 --> -0.908102).  Saving model ...
Epoch: 14 cost time: 5.097319602966309
Epoch: 14, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.577 Vali Acc: 0.911 Test Loss: 0.577 Test Acc: 0.911
Validation loss decreased (-0.908102 --> -0.910805).  Saving model ...
Epoch: 15 cost time: 5.499954700469971
Epoch: 15, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.508 Vali Acc: 0.922 Test Loss: 0.508 Test Acc: 0.922
Validation loss decreased (-0.910805 --> -0.921617).  Saving model ...
Epoch: 16 cost time: 5.402838945388794
Epoch: 16, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.426732778549194
Epoch: 17, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.412 Vali Acc: 0.927 Test Loss: 0.412 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 18 cost time: 5.5663933753967285
Epoch: 18, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.360 Vali Acc: 0.935 Test Loss: 0.360 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935132).  Saving model ...
Epoch: 19 cost time: 5.217867612838745
Epoch: 19, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.330 Vali Acc: 0.941 Test Loss: 0.330 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940537).  Saving model ...
Epoch: 20 cost time: 5.60056734085083
Epoch: 20, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.306 Vali Acc: 0.946 Test Loss: 0.306 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 21 cost time: 5.534693956375122
Epoch: 21, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.269 Vali Acc: 0.938 Test Loss: 0.269 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.373421669006348
Epoch: 22, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.252 Vali Acc: 0.946 Test Loss: 0.252 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 23 cost time: 5.379042863845825
Epoch: 23, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.469938039779663
Epoch: 24, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 25 cost time: 5.471228122711182
Epoch: 25, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.320434808731079
Epoch: 26, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.437077522277832
Epoch: 27, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 5.475186109542847
Epoch: 28, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.093082904815674
Epoch: 29, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 30 cost time: 5.104658603668213
Epoch: 30, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 91129
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.885016918182373
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.165 Vali Acc: 0.132 Test Loss: 2.165 Test Acc: 0.132
Validation loss decreased (inf --> -0.132411).  Saving model ...
Epoch: 2 cost time: 5.1761794090271
Epoch: 2, Steps: 17 | Train Loss: 2.104 Vali Loss: 2.087 Vali Acc: 0.219 Test Loss: 2.087 Test Acc: 0.219
Validation loss decreased (-0.132411 --> -0.218898).  Saving model ...
Epoch: 3 cost time: 5.148139715194702
Epoch: 3, Steps: 17 | Train Loss: 2.027 Vali Loss: 1.985 Vali Acc: 0.384 Test Loss: 1.985 Test Acc: 0.384
Validation loss decreased (-0.218898 --> -0.383764).  Saving model ...
Epoch: 4 cost time: 5.257841348648071
Epoch: 4, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.866 Vali Acc: 0.559 Test Loss: 1.866 Test Acc: 0.559
Validation loss decreased (-0.383764 --> -0.559441).  Saving model ...
Epoch: 5 cost time: 5.322468996047974
Epoch: 5, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.729 Vali Acc: 0.670 Test Loss: 1.729 Test Acc: 0.670
Validation loss decreased (-0.559441 --> -0.670253).  Saving model ...
Epoch: 6 cost time: 5.2215752601623535
Epoch: 6, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.576 Vali Acc: 0.724 Test Loss: 1.576 Test Acc: 0.724
Validation loss decreased (-0.670253 --> -0.724309).  Saving model ...
Epoch: 7 cost time: 4.924378871917725
Epoch: 7, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.412 Vali Acc: 0.792 Test Loss: 1.412 Test Acc: 0.792
Validation loss decreased (-0.724309 --> -0.791878).  Saving model ...
Epoch: 8 cost time: 4.406429052352905
Epoch: 8, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.251 Vali Acc: 0.797 Test Loss: 1.251 Test Acc: 0.797
Validation loss decreased (-0.791878 --> -0.797285).  Saving model ...
Epoch: 9 cost time: 5.091087341308594
Epoch: 9, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.105 Vali Acc: 0.814 Test Loss: 1.105 Test Acc: 0.814
Validation loss decreased (-0.797285 --> -0.813502).  Saving model ...
Epoch: 10 cost time: 5.122495412826538
Epoch: 10, Steps: 17 | Train Loss: 0.967 Vali Loss: 0.981 Vali Acc: 0.832 Test Loss: 0.981 Test Acc: 0.832
Validation loss decreased (-0.813502 --> -0.832423).  Saving model ...
Epoch: 11 cost time: 5.025942325592041
Epoch: 11, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.864 Vali Acc: 0.857 Test Loss: 0.864 Test Acc: 0.857
Validation loss decreased (-0.832423 --> -0.856748).  Saving model ...
Epoch: 12 cost time: 5.130798578262329
Epoch: 12, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.747 Vali Acc: 0.873 Test Loss: 0.747 Test Acc: 0.873
Validation loss decreased (-0.856748 --> -0.872966).  Saving model ...
Epoch: 13 cost time: 5.1696457862854
Epoch: 13, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.665 Vali Acc: 0.903 Test Loss: 0.665 Test Acc: 0.903
Validation loss decreased (-0.872966 --> -0.902696).  Saving model ...
Epoch: 14 cost time: 5.183939695358276
Epoch: 14, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.582 Vali Acc: 0.905 Test Loss: 0.582 Test Acc: 0.905
Validation loss decreased (-0.902696 --> -0.905400).  Saving model ...
Epoch: 15 cost time: 5.061999320983887
Epoch: 15, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.522 Vali Acc: 0.916 Test Loss: 0.522 Test Acc: 0.916
Validation loss decreased (-0.905400 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 4.9312989711761475
Epoch: 16, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.450 Vali Acc: 0.914 Test Loss: 0.450 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.00423264503479
Epoch: 17, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.422 Vali Acc: 0.919 Test Loss: 0.422 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918915).  Saving model ...
Epoch: 18 cost time: 5.422393560409546
Epoch: 18, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.369 Vali Acc: 0.924 Test Loss: 0.369 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924321).  Saving model ...
Epoch: 19 cost time: 5.307063817977905
Epoch: 19, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.328 Vali Acc: 0.927 Test Loss: 0.328 Test Acc: 0.927
Validation loss decreased (-0.924321 --> -0.927024).  Saving model ...
Epoch: 20 cost time: 5.362913370132446
Epoch: 20, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.311 Vali Acc: 0.927 Test Loss: 0.311 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 21 cost time: 5.336292266845703
Epoch: 21, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935132).  Saving model ...
Epoch: 22 cost time: 5.260456323623657
Epoch: 22, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.258 Vali Acc: 0.932 Test Loss: 0.258 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.300145864486694
Epoch: 23, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.245 Vali Acc: 0.938 Test Loss: 0.245 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 24 cost time: 5.161117792129517
Epoch: 24, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 25 cost time: 5.0917418003082275
Epoch: 25, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 4.3572986125946045
Epoch: 26, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 27 cost time: 4.982893228530884
Epoch: 27, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 5.047662019729614
Epoch: 28, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 29 cost time: 4.9646384716033936
Epoch: 29, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.934638023376465
Epoch: 30, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 298105
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.478475093841553
Epoch: 1, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.116 Vali Acc: 0.165 Test Loss: 2.116 Test Acc: 0.165
Validation loss decreased (inf --> -0.164844).  Saving model ...
Epoch: 2 cost time: 3.6755852699279785
Epoch: 2, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.048 Vali Acc: 0.238 Test Loss: 2.048 Test Acc: 0.238
Validation loss decreased (-0.164844 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 3.6541733741760254
Epoch: 3, Steps: 17 | Train Loss: 2.017 Vali Loss: 1.960 Vali Acc: 0.368 Test Loss: 1.960 Test Acc: 0.368
Validation loss decreased (-0.237817 --> -0.367548).  Saving model ...
Epoch: 4 cost time: 3.726344108581543
Epoch: 4, Steps: 17 | Train Loss: 1.906 Vali Loss: 1.858 Vali Acc: 0.495 Test Loss: 1.858 Test Acc: 0.495
Validation loss decreased (-0.367548 --> -0.494576).  Saving model ...
Epoch: 5 cost time: 3.9036331176757812
Epoch: 5, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.743 Vali Acc: 0.616 Test Loss: 1.743 Test Acc: 0.616
Validation loss decreased (-0.494576 --> -0.616199).  Saving model ...
Epoch: 6 cost time: 3.847907304763794
Epoch: 6, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.609 Vali Acc: 0.738 Test Loss: 1.609 Test Acc: 0.738
Validation loss decreased (-0.616199 --> -0.737822).  Saving model ...
Epoch: 7 cost time: 3.899724245071411
Epoch: 7, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.465 Vali Acc: 0.784 Test Loss: 1.465 Test Acc: 0.784
Validation loss decreased (-0.737822 --> -0.783769).  Saving model ...
Epoch: 8 cost time: 3.7201881408691406
Epoch: 8, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.320 Vali Acc: 0.822 Test Loss: 1.320 Test Acc: 0.822
Validation loss decreased (-0.783769 --> -0.821608).  Saving model ...
Epoch: 9 cost time: 3.779676914215088
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.182 Vali Acc: 0.819 Test Loss: 1.182 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.776357650756836
Epoch: 10, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.052 Vali Acc: 0.841 Test Loss: 1.052 Test Acc: 0.841
Validation loss decreased (-0.821608 --> -0.840530).  Saving model ...
Epoch: 11 cost time: 3.7907824516296387
Epoch: 11, Steps: 17 | Train Loss: 0.948 Vali Loss: 0.933 Vali Acc: 0.841 Test Loss: 0.933 Test Acc: 0.841
Validation loss decreased (-0.840530 --> -0.840531).  Saving model ...
Epoch: 12 cost time: 3.7412500381469727
Epoch: 12, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.827 Vali Acc: 0.859 Test Loss: 0.827 Test Acc: 0.859
Validation loss decreased (-0.840531 --> -0.859451).  Saving model ...
Epoch: 13 cost time: 3.6699917316436768
Epoch: 13, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.724 Vali Acc: 0.889 Test Loss: 0.724 Test Acc: 0.889
Validation loss decreased (-0.859451 --> -0.889182).  Saving model ...
Epoch: 14 cost time: 3.608009099960327
Epoch: 14, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
Validation loss decreased (-0.889182 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 3.6862199306488037
Epoch: 15, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.572 Vali Acc: 0.911 Test Loss: 0.572 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.910805).  Saving model ...
Epoch: 16 cost time: 3.5449562072753906
Epoch: 16, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.508 Vali Acc: 0.924 Test Loss: 0.508 Test Acc: 0.924
Validation loss decreased (-0.910805 --> -0.924319).  Saving model ...
Epoch: 17 cost time: 3.4550421237945557
Epoch: 17, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.456 Vali Acc: 0.927 Test Loss: 0.456 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927022).  Saving model ...
Epoch: 18 cost time: 3.34909725189209
Epoch: 18, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.397 Vali Acc: 0.938 Test Loss: 0.397 Test Acc: 0.938
Validation loss decreased (-0.927022 --> -0.937834).  Saving model ...
Epoch: 19 cost time: 3.3366432189941406
Epoch: 19, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.363 Vali Acc: 0.946 Test Loss: 0.363 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945942).  Saving model ...
Epoch: 20 cost time: 3.3329343795776367
Epoch: 20, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.334 Vali Acc: 0.932 Test Loss: 0.334 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.067709445953369
Epoch: 21, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.300 Vali Acc: 0.943 Test Loss: 0.300 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9061505794525146
Epoch: 22, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.281 Vali Acc: 0.949 Test Loss: 0.281 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 3.1287598609924316
Epoch: 23, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 24 cost time: 3.255924701690674
Epoch: 24, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 25 cost time: 3.498981475830078
Epoch: 25, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.232 Vali Acc: 0.951 Test Loss: 0.232 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 3.4563231468200684
Epoch: 26, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3684370517730713
Epoch: 27, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 28 cost time: 3.1514759063720703
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 29 cost time: 3.4807276725769043
Epoch: 29, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5495851039886475
Epoch: 30, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 91129
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.859978199005127
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.201 Vali Acc: 0.108 Test Loss: 2.201 Test Acc: 0.108
Validation loss decreased (inf --> -0.108086).  Saving model ...
Epoch: 2 cost time: 4.70573616027832
Epoch: 2, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.153 Vali Acc: 0.135 Test Loss: 2.153 Test Acc: 0.135
Validation loss decreased (-0.108086 --> -0.135114).  Saving model ...
Epoch: 3 cost time: 4.615056753158569
Epoch: 3, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.088 Vali Acc: 0.195 Test Loss: 2.088 Test Acc: 0.195
Validation loss decreased (-0.135114 --> -0.194574).  Saving model ...
Epoch: 4 cost time: 4.595715045928955
Epoch: 4, Steps: 17 | Train Loss: 2.041 Vali Loss: 2.005 Vali Acc: 0.278 Test Loss: 2.005 Test Acc: 0.278
Validation loss decreased (-0.194574 --> -0.278358).  Saving model ...
Epoch: 5 cost time: 4.609185218811035
Epoch: 5, Steps: 17 | Train Loss: 1.938 Vali Loss: 1.908 Vali Acc: 0.435 Test Loss: 1.908 Test Acc: 0.435
Validation loss decreased (-0.278358 --> -0.435116).  Saving model ...
Epoch: 6 cost time: 4.427663087844849
Epoch: 6, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.790 Vali Acc: 0.543 Test Loss: 1.790 Test Acc: 0.543
Validation loss decreased (-0.435116 --> -0.543225).  Saving model ...
Epoch: 7 cost time: 4.37816309928894
Epoch: 7, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.649 Vali Acc: 0.630 Test Loss: 1.649 Test Acc: 0.630
Validation loss decreased (-0.543225 --> -0.629713).  Saving model ...
Epoch: 8 cost time: 4.3857362270355225
Epoch: 8, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.511 Vali Acc: 0.700 Test Loss: 1.511 Test Acc: 0.700
Validation loss decreased (-0.629713 --> -0.699985).  Saving model ...
Epoch: 9 cost time: 4.179730176925659
Epoch: 9, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.376 Vali Acc: 0.732 Test Loss: 1.376 Test Acc: 0.732
Validation loss decreased (-0.699985 --> -0.732419).  Saving model ...
Epoch: 10 cost time: 4.217195749282837
Epoch: 10, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.257 Vali Acc: 0.738 Test Loss: 1.257 Test Acc: 0.738
Validation loss decreased (-0.732419 --> -0.737825).  Saving model ...
Epoch: 11 cost time: 4.36164116859436
Epoch: 11, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.150 Vali Acc: 0.768 Test Loss: 1.150 Test Acc: 0.768
Validation loss decreased (-0.737825 --> -0.767556).  Saving model ...
Epoch: 12 cost time: 4.48759126663208
Epoch: 12, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.047 Vali Acc: 0.784 Test Loss: 1.047 Test Acc: 0.784
Validation loss decreased (-0.767556 --> -0.783773).  Saving model ...
Epoch: 13 cost time: 4.51665472984314
Epoch: 13, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.951 Vali Acc: 0.795 Test Loss: 0.951 Test Acc: 0.795
Validation loss decreased (-0.783773 --> -0.794585).  Saving model ...
Epoch: 14 cost time: 4.390308618545532
Epoch: 14, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.855 Vali Acc: 0.811 Test Loss: 0.855 Test Acc: 0.811
Validation loss decreased (-0.794585 --> -0.810802).  Saving model ...
Epoch: 15 cost time: 4.399338245391846
Epoch: 15, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.782 Vali Acc: 0.824 Test Loss: 0.782 Test Acc: 0.824
Validation loss decreased (-0.810802 --> -0.824317).  Saving model ...
Epoch: 16 cost time: 4.455685615539551
Epoch: 16, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.704 Vali Acc: 0.857 Test Loss: 0.704 Test Acc: 0.857
Validation loss decreased (-0.824317 --> -0.856750).  Saving model ...
Epoch: 17 cost time: 4.344210147857666
Epoch: 17, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.646 Vali Acc: 0.862 Test Loss: 0.646 Test Acc: 0.862
Validation loss decreased (-0.856750 --> -0.862156).  Saving model ...
Epoch: 18 cost time: 4.2675557136535645
Epoch: 18, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.596 Vali Acc: 0.865 Test Loss: 0.596 Test Acc: 0.865
Validation loss decreased (-0.862156 --> -0.864859).  Saving model ...
Epoch: 19 cost time: 4.5711753368377686
Epoch: 19, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.543 Vali Acc: 0.876 Test Loss: 0.543 Test Acc: 0.876
Validation loss decreased (-0.864859 --> -0.875670).  Saving model ...
Epoch: 20 cost time: 4.432397127151489
Epoch: 20, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.875670 --> -0.889184).  Saving model ...
Epoch: 21 cost time: 4.279759407043457
Epoch: 21, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.472 Vali Acc: 0.892 Test Loss: 0.472 Test Acc: 0.892
Validation loss decreased (-0.889184 --> -0.891887).  Saving model ...
Epoch: 22 cost time: 4.4897301197052
Epoch: 22, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.406 Vali Acc: 0.911 Test Loss: 0.406 Test Acc: 0.911
Validation loss decreased (-0.891887 --> -0.910807).  Saving model ...
Epoch: 23 cost time: 4.398175477981567
Epoch: 23, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.400 Vali Acc: 0.903 Test Loss: 0.400 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.4939000606536865
Epoch: 24, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.379 Vali Acc: 0.911 Test Loss: 0.379 Test Acc: 0.911
Validation loss decreased (-0.910807 --> -0.910807).  Saving model ...
Epoch: 25 cost time: 4.41850209236145
Epoch: 25, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.359 Vali Acc: 0.908 Test Loss: 0.359 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.527651309967041
Epoch: 26, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.340 Vali Acc: 0.914 Test Loss: 0.340 Test Acc: 0.914
Validation loss decreased (-0.910807 --> -0.913510).  Saving model ...
Epoch: 27 cost time: 4.661868572235107
Epoch: 27, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.304 Vali Acc: 0.932 Test Loss: 0.304 Test Acc: 0.932
Validation loss decreased (-0.913510 --> -0.932429).  Saving model ...
Epoch: 28 cost time: 4.599027633666992
Epoch: 28, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 29 cost time: 4.651298522949219
Epoch: 29, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.389044284820557
Epoch: 30, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.295 Vali Acc: 0.932 Test Loss: 0.295 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 589025
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.558961629867554
Epoch: 1, Steps: 17 | Train Loss: 2.176 Vali Loss: 2.115 Vali Acc: 0.284 Test Loss: 2.115 Test Acc: 0.284
Validation loss decreased (inf --> -0.283763).  Saving model ...
Epoch: 2 cost time: 3.6323211193084717
Epoch: 2, Steps: 17 | Train Loss: 2.115 Vali Loss: 2.062 Vali Acc: 0.357 Test Loss: 2.062 Test Acc: 0.357
Validation loss decreased (-0.283763 --> -0.356736).  Saving model ...
Epoch: 3 cost time: 3.546626091003418
Epoch: 3, Steps: 17 | Train Loss: 2.042 Vali Loss: 1.994 Vali Acc: 0.443 Test Loss: 1.994 Test Acc: 0.443
Validation loss decreased (-0.356736 --> -0.443223).  Saving model ...
Epoch: 4 cost time: 3.4608891010284424
Epoch: 4, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.913 Vali Acc: 0.505 Test Loss: 1.913 Test Acc: 0.505
Validation loss decreased (-0.443223 --> -0.505386).  Saving model ...
Epoch: 5 cost time: 3.5089268684387207
Epoch: 5, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.828 Vali Acc: 0.584 Test Loss: 1.828 Test Acc: 0.584
Validation loss decreased (-0.505386 --> -0.583766).  Saving model ...
Epoch: 6 cost time: 3.50907564163208
Epoch: 6, Steps: 17 | Train Loss: 1.810 Vali Loss: 1.745 Vali Acc: 0.630 Test Loss: 1.745 Test Acc: 0.630
Validation loss decreased (-0.583766 --> -0.629712).  Saving model ...
Epoch: 7 cost time: 3.4379024505615234
Epoch: 7, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.654 Vali Acc: 0.670 Test Loss: 1.654 Test Acc: 0.670
Validation loss decreased (-0.629712 --> -0.670254).  Saving model ...
Epoch: 8 cost time: 3.6336934566497803
Epoch: 8, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.562 Vali Acc: 0.692 Test Loss: 1.562 Test Acc: 0.692
Validation loss decreased (-0.670254 --> -0.691876).  Saving model ...
Epoch: 9 cost time: 3.565950632095337
Epoch: 9, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.473 Vali Acc: 0.714 Test Loss: 1.473 Test Acc: 0.714
Validation loss decreased (-0.691876 --> -0.713499).  Saving model ...
Epoch: 10 cost time: 3.8498520851135254
Epoch: 10, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.377 Vali Acc: 0.730 Test Loss: 1.377 Test Acc: 0.730
Validation loss decreased (-0.713499 --> -0.729716).  Saving model ...
Epoch: 11 cost time: 3.949909210205078
Epoch: 11, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.300 Vali Acc: 0.749 Test Loss: 1.300 Test Acc: 0.749
Validation loss decreased (-0.729716 --> -0.748636).  Saving model ...
Epoch: 12 cost time: 3.786785125732422
Epoch: 12, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.224 Vali Acc: 0.759 Test Loss: 1.224 Test Acc: 0.759
Validation loss decreased (-0.748636 --> -0.759447).  Saving model ...
Epoch: 13 cost time: 3.9496781826019287
Epoch: 13, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.143 Vali Acc: 0.770 Test Loss: 1.143 Test Acc: 0.770
Validation loss decreased (-0.759447 --> -0.770259).  Saving model ...
Epoch: 14 cost time: 4.094852447509766
Epoch: 14, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.069 Vali Acc: 0.786 Test Loss: 1.069 Test Acc: 0.786
Validation loss decreased (-0.770259 --> -0.786476).  Saving model ...
Epoch: 15 cost time: 4.118280649185181
Epoch: 15, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.971 Vali Acc: 0.803 Test Loss: 0.971 Test Acc: 0.803
Validation loss decreased (-0.786476 --> -0.802693).  Saving model ...
Epoch: 16 cost time: 4.034599781036377
Epoch: 16, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.898 Vali Acc: 0.814 Test Loss: 0.898 Test Acc: 0.814
Validation loss decreased (-0.802693 --> -0.813505).  Saving model ...
Epoch: 17 cost time: 3.9619300365448
Epoch: 17, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.810 Vali Acc: 0.835 Test Loss: 0.810 Test Acc: 0.835
Validation loss decreased (-0.813505 --> -0.835127).  Saving model ...
Epoch: 18 cost time: 3.8161404132843018
Epoch: 18, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.740 Vali Acc: 0.857 Test Loss: 0.740 Test Acc: 0.857
Validation loss decreased (-0.835127 --> -0.856749).  Saving model ...
Epoch: 19 cost time: 3.6768670082092285
Epoch: 19, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.673 Vali Acc: 0.868 Test Loss: 0.673 Test Acc: 0.868
Validation loss decreased (-0.856749 --> -0.867561).  Saving model ...
Epoch: 20 cost time: 3.8735291957855225
Epoch: 20, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.557 Vali Acc: 0.924 Test Loss: 0.557 Test Acc: 0.924
Validation loss decreased (-0.867561 --> -0.924319).  Saving model ...
Epoch: 21 cost time: 3.7332606315612793
Epoch: 21, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.512 Vali Acc: 0.922 Test Loss: 0.512 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7085776329040527
Epoch: 22, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.478 Vali Acc: 0.914 Test Loss: 0.478 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.8064987659454346
Epoch: 23, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.410 Vali Acc: 0.935 Test Loss: 0.410 Test Acc: 0.935
Validation loss decreased (-0.924319 --> -0.935131).  Saving model ...
Epoch: 24 cost time: 3.6699740886688232
Epoch: 24, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.385 Vali Acc: 0.938 Test Loss: 0.385 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 25 cost time: 3.6191699504852295
Epoch: 25, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.345 Vali Acc: 0.935 Test Loss: 0.345 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.9357829093933105
Epoch: 26, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.312 Vali Acc: 0.941 Test Loss: 0.312 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 27 cost time: 3.812105417251587
Epoch: 27, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.304 Vali Acc: 0.938 Test Loss: 0.304 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.744180917739868
Epoch: 28, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.272 Vali Acc: 0.954 Test Loss: 0.272 Test Acc: 0.954
Validation loss decreased (-0.940537 --> -0.954051).  Saving model ...
Epoch: 29 cost time: 3.8470754623413086
Epoch: 29, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.249 Vali Acc: 0.946 Test Loss: 0.249 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.004310846328735
Epoch: 30, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.242 Vali Acc: 0.954 Test Loss: 0.242 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 175041
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.00688362121582
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.201 Vali Acc: 0.111 Test Loss: 2.201 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 3.6321828365325928
Epoch: 2, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.154 Vali Acc: 0.138 Test Loss: 2.154 Test Acc: 0.138
Validation loss decreased (-0.110789 --> -0.137816).  Saving model ...
Epoch: 3 cost time: 3.6233062744140625
Epoch: 3, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.089 Vali Acc: 0.192 Test Loss: 2.089 Test Acc: 0.192
Validation loss decreased (-0.137816 --> -0.191871).  Saving model ...
Epoch: 4 cost time: 3.6776371002197266
Epoch: 4, Steps: 17 | Train Loss: 2.045 Vali Loss: 2.008 Vali Acc: 0.278 Test Loss: 2.008 Test Acc: 0.278
Validation loss decreased (-0.191871 --> -0.278358).  Saving model ...
Epoch: 5 cost time: 3.539875030517578
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.915 Vali Acc: 0.416 Test Loss: 1.915 Test Acc: 0.416
Validation loss decreased (-0.278358 --> -0.416197).  Saving model ...
Epoch: 6 cost time: 3.4540584087371826
Epoch: 6, Steps: 17 | Train Loss: 1.847 Vali Loss: 1.810 Vali Acc: 0.524 Test Loss: 1.810 Test Acc: 0.524
Validation loss decreased (-0.416197 --> -0.524306).  Saving model ...
Epoch: 7 cost time: 3.5407700538635254
Epoch: 7, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.691 Vali Acc: 0.603 Test Loss: 1.691 Test Acc: 0.603
Validation loss decreased (-0.524306 --> -0.602686).  Saving model ...
Epoch: 8 cost time: 3.5122716426849365
Epoch: 8, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.572 Vali Acc: 0.684 Test Loss: 1.572 Test Acc: 0.684
Validation loss decreased (-0.602686 --> -0.683768).  Saving model ...
Epoch: 9 cost time: 3.5218653678894043
Epoch: 9, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.442 Vali Acc: 0.724 Test Loss: 1.442 Test Acc: 0.724
Validation loss decreased (-0.683768 --> -0.724310).  Saving model ...
Epoch: 10 cost time: 3.3517377376556396
Epoch: 10, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.317 Vali Acc: 0.757 Test Loss: 1.317 Test Acc: 0.757
Validation loss decreased (-0.724310 --> -0.756744).  Saving model ...
Epoch: 11 cost time: 3.519559383392334
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.193 Vali Acc: 0.792 Test Loss: 1.193 Test Acc: 0.792
Validation loss decreased (-0.756744 --> -0.791880).  Saving model ...
Epoch: 12 cost time: 3.5849602222442627
Epoch: 12, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.092 Vali Acc: 0.781 Test Loss: 1.092 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.507394790649414
Epoch: 13, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.988 Vali Acc: 0.811 Test Loss: 0.988 Test Acc: 0.811
Validation loss decreased (-0.791880 --> -0.810801).  Saving model ...
Epoch: 14 cost time: 3.492083787918091
Epoch: 14, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.884 Vali Acc: 0.835 Test Loss: 0.884 Test Acc: 0.835
Validation loss decreased (-0.810801 --> -0.835126).  Saving model ...
Epoch: 15 cost time: 3.437206983566284
Epoch: 15, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.802 Vali Acc: 0.843 Test Loss: 0.802 Test Acc: 0.843
Validation loss decreased (-0.835126 --> -0.843235).  Saving model ...
Epoch: 16 cost time: 3.5643115043640137
Epoch: 16, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.726 Vali Acc: 0.862 Test Loss: 0.726 Test Acc: 0.862
Validation loss decreased (-0.843235 --> -0.862155).  Saving model ...
Epoch: 17 cost time: 3.5016674995422363
Epoch: 17, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.661 Vali Acc: 0.876 Test Loss: 0.661 Test Acc: 0.876
Validation loss decreased (-0.862155 --> -0.875669).  Saving model ...
Epoch: 18 cost time: 3.572197437286377
Epoch: 18, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.610 Vali Acc: 0.876 Test Loss: 0.610 Test Acc: 0.876
Validation loss decreased (-0.875669 --> -0.875670).  Saving model ...
Epoch: 19 cost time: 3.280831813812256
Epoch: 19, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.551 Vali Acc: 0.895 Test Loss: 0.551 Test Acc: 0.895
Validation loss decreased (-0.875670 --> -0.894589).  Saving model ...
Epoch: 20 cost time: 3.2491419315338135
Epoch: 20, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.515 Vali Acc: 0.895 Test Loss: 0.515 Test Acc: 0.895
Validation loss decreased (-0.894589 --> -0.894589).  Saving model ...
Epoch: 21 cost time: 3.335808753967285
Epoch: 21, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.472 Vali Acc: 0.897 Test Loss: 0.472 Test Acc: 0.897
Validation loss decreased (-0.894589 --> -0.897293).  Saving model ...
Epoch: 22 cost time: 3.3823883533477783
Epoch: 22, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.897293 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 3.3823812007904053
Epoch: 23, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.374 Vali Acc: 0.916 Test Loss: 0.374 Test Acc: 0.916
Validation loss decreased (-0.899996 --> -0.916212).  Saving model ...
Epoch: 24 cost time: 3.4237444400787354
Epoch: 24, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.396 Vali Acc: 0.897 Test Loss: 0.396 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3234293460845947
Epoch: 25, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.330 Vali Acc: 0.916 Test Loss: 0.330 Test Acc: 0.916
Validation loss decreased (-0.916212 --> -0.916213).  Saving model ...
Epoch: 26 cost time: 3.085653066635132
Epoch: 26, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.316 Vali Acc: 0.914 Test Loss: 0.316 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3181445598602295
Epoch: 27, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.277 Vali Acc: 0.927 Test Loss: 0.277 Test Acc: 0.927
Validation loss decreased (-0.916213 --> -0.927024).  Saving model ...
Epoch: 28 cost time: 3.5312788486480713
Epoch: 28, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 29 cost time: 3.6414618492126465
Epoch: 29, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.255 Vali Acc: 0.932 Test Loss: 0.255 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7311079502105713
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
Validation loss decreased (-0.935133 --> -0.943241).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 589025
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.637840509414673
Epoch: 1, Steps: 17 | Train Loss: 2.177 Vali Loss: 2.115 Vali Acc: 0.281 Test Loss: 2.115 Test Acc: 0.281
Validation loss decreased (inf --> -0.281060).  Saving model ...
Epoch: 2 cost time: 3.0989911556243896
Epoch: 2, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.064 Vali Acc: 0.357 Test Loss: 2.064 Test Acc: 0.357
Validation loss decreased (-0.281060 --> -0.356736).  Saving model ...
Epoch: 3 cost time: 3.091465950012207
Epoch: 3, Steps: 17 | Train Loss: 2.044 Vali Loss: 1.995 Vali Acc: 0.443 Test Loss: 1.995 Test Acc: 0.443
Validation loss decreased (-0.356736 --> -0.443223).  Saving model ...
Epoch: 4 cost time: 2.9356253147125244
Epoch: 4, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.914 Vali Acc: 0.503 Test Loss: 1.914 Test Acc: 0.503
Validation loss decreased (-0.443223 --> -0.502684).  Saving model ...
Epoch: 5 cost time: 2.9818148612976074
Epoch: 5, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.829 Vali Acc: 0.584 Test Loss: 1.829 Test Acc: 0.584
Validation loss decreased (-0.502684 --> -0.583765).  Saving model ...
Epoch: 6 cost time: 2.9821527004241943
Epoch: 6, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.746 Vali Acc: 0.630 Test Loss: 1.746 Test Acc: 0.630
Validation loss decreased (-0.583765 --> -0.629712).  Saving model ...
Epoch: 7 cost time: 3.0047543048858643
Epoch: 7, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.657 Vali Acc: 0.678 Test Loss: 1.657 Test Acc: 0.678
Validation loss decreased (-0.629712 --> -0.678362).  Saving model ...
Epoch: 8 cost time: 2.8881912231445312
Epoch: 8, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.566 Vali Acc: 0.678 Test Loss: 1.566 Test Acc: 0.678
Validation loss decreased (-0.678362 --> -0.678363).  Saving model ...
Epoch: 9 cost time: 2.993687629699707
Epoch: 9, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.478 Vali Acc: 0.708 Test Loss: 1.478 Test Acc: 0.708
Validation loss decreased (-0.678363 --> -0.708093).  Saving model ...
Epoch: 10 cost time: 2.9934327602386475
Epoch: 10, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.381 Vali Acc: 0.732 Test Loss: 1.381 Test Acc: 0.732
Validation loss decreased (-0.708093 --> -0.732419).  Saving model ...
Epoch: 11 cost time: 2.967414617538452
Epoch: 11, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.304 Vali Acc: 0.749 Test Loss: 1.304 Test Acc: 0.749
Validation loss decreased (-0.732419 --> -0.748636).  Saving model ...
Epoch: 12 cost time: 2.893873929977417
Epoch: 12, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.231 Vali Acc: 0.751 Test Loss: 1.231 Test Acc: 0.751
Validation loss decreased (-0.748636 --> -0.751339).  Saving model ...
Epoch: 13 cost time: 3.2295236587524414
Epoch: 13, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.152 Vali Acc: 0.773 Test Loss: 1.152 Test Acc: 0.773
Validation loss decreased (-0.751339 --> -0.772961).  Saving model ...
Epoch: 14 cost time: 3.2987475395202637
Epoch: 14, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.082 Vali Acc: 0.770 Test Loss: 1.082 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3501906394958496
Epoch: 15, Steps: 17 | Train Loss: 0.939 Vali Loss: 0.987 Vali Acc: 0.786 Test Loss: 0.987 Test Acc: 0.786
Validation loss decreased (-0.772961 --> -0.786477).  Saving model ...
Epoch: 16 cost time: 3.3018884658813477
Epoch: 16, Steps: 17 | Train Loss: 0.860 Vali Loss: 0.924 Vali Acc: 0.795 Test Loss: 0.924 Test Acc: 0.795
Validation loss decreased (-0.786477 --> -0.794585).  Saving model ...
Epoch: 17 cost time: 3.2760062217712402
Epoch: 17, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.835 Vali Acc: 0.811 Test Loss: 0.835 Test Acc: 0.811
Validation loss decreased (-0.794585 --> -0.810802).  Saving model ...
Epoch: 18 cost time: 3.1945862770080566
Epoch: 18, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.784 Vali Acc: 0.816 Test Loss: 0.784 Test Acc: 0.816
Validation loss decreased (-0.810802 --> -0.816208).  Saving model ...
Epoch: 19 cost time: 3.2340943813323975
Epoch: 19, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.723 Vali Acc: 0.816 Test Loss: 0.723 Test Acc: 0.816
Validation loss decreased (-0.816208 --> -0.816209).  Saving model ...
Epoch: 20 cost time: 3.322747230529785
Epoch: 20, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.628 Vali Acc: 0.892 Test Loss: 0.628 Test Acc: 0.892
Validation loss decreased (-0.816209 --> -0.891886).  Saving model ...
Epoch: 21 cost time: 3.2424981594085693
Epoch: 21, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.588 Vali Acc: 0.873 Test Loss: 0.588 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.078763484954834
Epoch: 22, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.542 Vali Acc: 0.886 Test Loss: 0.542 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.103353261947632
Epoch: 23, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.494 Vali Acc: 0.897 Test Loss: 0.494 Test Acc: 0.897
Validation loss decreased (-0.891886 --> -0.897292).  Saving model ...
Epoch: 24 cost time: 3.057302474975586
Epoch: 24, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.453 Vali Acc: 0.914 Test Loss: 0.453 Test Acc: 0.914
Validation loss decreased (-0.897292 --> -0.913509).  Saving model ...
Epoch: 25 cost time: 2.9800777435302734
Epoch: 25, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.437 Vali Acc: 0.892 Test Loss: 0.437 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9313855171203613
Epoch: 26, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 27 cost time: 2.9408295154571533
Epoch: 27, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.383 Vali Acc: 0.905 Test Loss: 0.383 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9359357357025146
Epoch: 28, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.336 Vali Acc: 0.914 Test Loss: 0.336 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.950406312942505
Epoch: 29, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.314 Vali Acc: 0.924 Test Loss: 0.314 Test Acc: 0.924
Validation loss decreased (-0.918915 --> -0.924321).  Saving model ...
Epoch: 30 cost time: 2.8957974910736084
Epoch: 30, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 175041
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.6611292362213135
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.201 Vali Acc: 0.111 Test Loss: 2.201 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 2.263611078262329
Epoch: 2, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.156 Vali Acc: 0.135 Test Loss: 2.156 Test Acc: 0.135
Validation loss decreased (-0.110789 --> -0.135114).  Saving model ...
Epoch: 3 cost time: 2.3060147762298584
Epoch: 3, Steps: 17 | Train Loss: 2.123 Vali Loss: 2.093 Vali Acc: 0.181 Test Loss: 2.093 Test Acc: 0.181
Validation loss decreased (-0.135114 --> -0.181060).  Saving model ...
Epoch: 4 cost time: 2.800323247909546
Epoch: 4, Steps: 17 | Train Loss: 2.050 Vali Loss: 2.015 Vali Acc: 0.259 Test Loss: 2.015 Test Acc: 0.259
Validation loss decreased (-0.181060 --> -0.259439).  Saving model ...
Epoch: 5 cost time: 2.955230236053467
Epoch: 5, Steps: 17 | Train Loss: 1.954 Vali Loss: 1.927 Vali Acc: 0.384 Test Loss: 1.927 Test Acc: 0.384
Validation loss decreased (-0.259439 --> -0.383765).  Saving model ...
Epoch: 6 cost time: 2.9089856147766113
Epoch: 6, Steps: 17 | Train Loss: 1.859 Vali Loss: 1.830 Vali Acc: 0.476 Test Loss: 1.830 Test Acc: 0.476
Validation loss decreased (-0.383765 --> -0.475657).  Saving model ...
Epoch: 7 cost time: 2.88040828704834
Epoch: 7, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.725 Vali Acc: 0.554 Test Loss: 1.725 Test Acc: 0.554
Validation loss decreased (-0.475657 --> -0.554037).  Saving model ...
Epoch: 8 cost time: 2.9558002948760986
Epoch: 8, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.623 Vali Acc: 0.616 Test Loss: 1.623 Test Acc: 0.616
Validation loss decreased (-0.554037 --> -0.616200).  Saving model ...
Epoch: 9 cost time: 2.7063350677490234
Epoch: 9, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.520 Vali Acc: 0.659 Test Loss: 1.520 Test Acc: 0.659
Validation loss decreased (-0.616200 --> -0.659444).  Saving model ...
Epoch: 10 cost time: 2.695413589477539
Epoch: 10, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.411 Vali Acc: 0.662 Test Loss: 1.411 Test Acc: 0.662
Validation loss decreased (-0.659444 --> -0.662148).  Saving model ...
Epoch: 11 cost time: 2.707310438156128
Epoch: 11, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.305 Vali Acc: 0.700 Test Loss: 1.305 Test Acc: 0.700
Validation loss decreased (-0.662148 --> -0.699987).  Saving model ...
Epoch: 12 cost time: 2.6944808959960938
Epoch: 12, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.210 Vali Acc: 0.727 Test Loss: 1.210 Test Acc: 0.727
Validation loss decreased (-0.699987 --> -0.727015).  Saving model ...
Epoch: 13 cost time: 2.701545476913452
Epoch: 13, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.122 Vali Acc: 0.738 Test Loss: 1.122 Test Acc: 0.738
Validation loss decreased (-0.727015 --> -0.737827).  Saving model ...
Epoch: 14 cost time: 2.6921956539154053
Epoch: 14, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.033 Vali Acc: 0.749 Test Loss: 1.033 Test Acc: 0.749
Validation loss decreased (-0.737827 --> -0.748638).  Saving model ...
Epoch: 15 cost time: 2.777967691421509
Epoch: 15, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.963 Vali Acc: 0.759 Test Loss: 0.963 Test Acc: 0.759
Validation loss decreased (-0.748638 --> -0.759450).  Saving model ...
Epoch: 16 cost time: 2.718271017074585
Epoch: 16, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.891 Vali Acc: 0.786 Test Loss: 0.891 Test Acc: 0.786
Validation loss decreased (-0.759450 --> -0.786478).  Saving model ...
Epoch: 17 cost time: 2.6427111625671387
Epoch: 17, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.840 Vali Acc: 0.792 Test Loss: 0.840 Test Acc: 0.792
Validation loss decreased (-0.786478 --> -0.791883).  Saving model ...
Epoch: 18 cost time: 2.667785882949829
Epoch: 18, Steps: 17 | Train Loss: 0.687 Vali Loss: 0.781 Vali Acc: 0.822 Test Loss: 0.781 Test Acc: 0.822
Validation loss decreased (-0.791883 --> -0.821614).  Saving model ...
Epoch: 19 cost time: 2.599473237991333
Epoch: 19, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.718 Vali Acc: 0.832 Test Loss: 0.718 Test Acc: 0.832
Validation loss decreased (-0.821614 --> -0.832425).  Saving model ...
Epoch: 20 cost time: 2.7595102787017822
Epoch: 20, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.671 Vali Acc: 0.851 Test Loss: 0.671 Test Acc: 0.851
Validation loss decreased (-0.832425 --> -0.851345).  Saving model ...
Epoch: 21 cost time: 2.68044376373291
Epoch: 21, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.619 Vali Acc: 0.859 Test Loss: 0.619 Test Acc: 0.859
Validation loss decreased (-0.851345 --> -0.859453).  Saving model ...
Epoch: 22 cost time: 2.765378952026367
Epoch: 22, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
Validation loss decreased (-0.859453 --> -0.859454).  Saving model ...
Epoch: 23 cost time: 2.779442071914673
Epoch: 23, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.530 Vali Acc: 0.886 Test Loss: 0.530 Test Acc: 0.886
Validation loss decreased (-0.859454 --> -0.886481).  Saving model ...
Epoch: 24 cost time: 2.744847536087036
Epoch: 24, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.515 Vali Acc: 0.876 Test Loss: 0.515 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7469322681427
Epoch: 25, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.886481 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 2.67642879486084
Epoch: 26, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.446 Vali Acc: 0.892 Test Loss: 0.446 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7536754608154297
Epoch: 27, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
Validation loss decreased (-0.899995 --> -0.902699).  Saving model ...
Epoch: 28 cost time: 2.8202130794525146
Epoch: 28, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.377 Vali Acc: 0.914 Test Loss: 0.377 Test Acc: 0.914
Validation loss decreased (-0.902699 --> -0.913510).  Saving model ...
Epoch: 29 cost time: 2.6156840324401855
Epoch: 29, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.340 Vali Acc: 0.916 Test Loss: 0.340 Test Acc: 0.916
Validation loss decreased (-0.913510 --> -0.916213).  Saving model ...
Epoch: 30 cost time: 2.7633118629455566
Epoch: 30, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.347 Vali Acc: 0.924 Test Loss: 0.347 Test Acc: 0.924
Validation loss decreased (-0.916213 --> -0.924321).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 589025
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.875058174133301
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.119 Vali Acc: 0.273 Test Loss: 2.119 Test Acc: 0.273
Validation loss decreased (inf --> -0.272952).  Saving model ...
Epoch: 2 cost time: 2.592576026916504
Epoch: 2, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.073 Vali Acc: 0.335 Test Loss: 2.073 Test Acc: 0.335
Validation loss decreased (-0.272952 --> -0.335114).  Saving model ...
Epoch: 3 cost time: 2.6021347045898438
Epoch: 3, Steps: 17 | Train Loss: 2.052 Vali Loss: 2.013 Vali Acc: 0.405 Test Loss: 2.013 Test Acc: 0.405
Validation loss decreased (-0.335114 --> -0.405385).  Saving model ...
Epoch: 4 cost time: 2.6353015899658203
Epoch: 4, Steps: 17 | Train Loss: 1.987 Vali Loss: 1.941 Vali Acc: 0.473 Test Loss: 1.941 Test Acc: 0.473
Validation loss decreased (-0.405385 --> -0.472954).  Saving model ...
Epoch: 5 cost time: 2.664045572280884
Epoch: 5, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.865 Vali Acc: 0.541 Test Loss: 1.865 Test Acc: 0.541
Validation loss decreased (-0.472954 --> -0.540522).  Saving model ...
Epoch: 6 cost time: 2.619295597076416
Epoch: 6, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.788 Vali Acc: 0.581 Test Loss: 1.788 Test Acc: 0.581
Validation loss decreased (-0.540522 --> -0.581063).  Saving model ...
Epoch: 7 cost time: 2.644413709640503
Epoch: 7, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.703 Vali Acc: 0.630 Test Loss: 1.703 Test Acc: 0.630
Validation loss decreased (-0.581063 --> -0.629713).  Saving model ...
Epoch: 8 cost time: 2.733412504196167
Epoch: 8, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.615 Vali Acc: 0.657 Test Loss: 1.615 Test Acc: 0.657
Validation loss decreased (-0.629713 --> -0.656741).  Saving model ...
Epoch: 9 cost time: 2.794748067855835
Epoch: 9, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.527 Vali Acc: 0.684 Test Loss: 1.527 Test Acc: 0.684
Validation loss decreased (-0.656741 --> -0.683769).  Saving model ...
Epoch: 10 cost time: 2.729581832885742
Epoch: 10, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.435 Vali Acc: 0.705 Test Loss: 1.435 Test Acc: 0.705
Validation loss decreased (-0.683769 --> -0.705391).  Saving model ...
Epoch: 11 cost time: 2.761155366897583
Epoch: 11, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.356 Vali Acc: 0.705 Test Loss: 1.356 Test Acc: 0.705
Validation loss decreased (-0.705391 --> -0.705392).  Saving model ...
Epoch: 12 cost time: 2.724456548690796
Epoch: 12, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.284 Vali Acc: 0.716 Test Loss: 1.284 Test Acc: 0.716
Validation loss decreased (-0.705392 --> -0.716203).  Saving model ...
Epoch: 13 cost time: 2.6365976333618164
Epoch: 13, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.207 Vali Acc: 0.727 Test Loss: 1.207 Test Acc: 0.727
Validation loss decreased (-0.716203 --> -0.727015).  Saving model ...
Epoch: 14 cost time: 2.7123236656188965
Epoch: 14, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.132 Vali Acc: 0.765 Test Loss: 1.132 Test Acc: 0.765
Validation loss decreased (-0.727015 --> -0.764854).  Saving model ...
Epoch: 15 cost time: 2.644510269165039
Epoch: 15, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.053 Vali Acc: 0.770 Test Loss: 1.053 Test Acc: 0.770
Validation loss decreased (-0.764854 --> -0.770260).  Saving model ...
Epoch: 16 cost time: 2.638669729232788
Epoch: 16, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.980 Vali Acc: 0.795 Test Loss: 0.980 Test Acc: 0.795
Validation loss decreased (-0.770260 --> -0.794585).  Saving model ...
Epoch: 17 cost time: 2.579289674758911
Epoch: 17, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.892 Vali Acc: 0.822 Test Loss: 0.892 Test Acc: 0.822
Validation loss decreased (-0.794585 --> -0.821613).  Saving model ...
Epoch: 18 cost time: 2.438333034515381
Epoch: 18, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.832 Vali Acc: 0.846 Test Loss: 0.832 Test Acc: 0.846
Validation loss decreased (-0.821613 --> -0.845938).  Saving model ...
Epoch: 19 cost time: 2.442528247833252
Epoch: 19, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.756 Vali Acc: 0.865 Test Loss: 0.756 Test Acc: 0.865
Validation loss decreased (-0.845938 --> -0.864857).  Saving model ...
Epoch: 20 cost time: 2.503187417984009
Epoch: 20, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.697 Vali Acc: 0.884 Test Loss: 0.697 Test Acc: 0.884
Validation loss decreased (-0.864857 --> -0.883777).  Saving model ...
Epoch: 21 cost time: 2.4945852756500244
Epoch: 21, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.643 Vali Acc: 0.876 Test Loss: 0.643 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4809823036193848
Epoch: 22, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.592 Vali Acc: 0.892 Test Loss: 0.592 Test Acc: 0.892
Validation loss decreased (-0.883777 --> -0.891886).  Saving model ...
Epoch: 23 cost time: 2.411665201187134
Epoch: 23, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.509302854537964
Epoch: 24, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.554677963256836
Epoch: 25, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.471 Vali Acc: 0.908 Test Loss: 0.471 Test Acc: 0.908
Validation loss decreased (-0.891886 --> -0.908103).  Saving model ...
Epoch: 26 cost time: 2.5227084159851074
Epoch: 26, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.438 Vali Acc: 0.903 Test Loss: 0.438 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5312917232513428
Epoch: 27, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.418 Vali Acc: 0.908 Test Loss: 0.418 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908104).  Saving model ...
Epoch: 28 cost time: 2.6919004917144775
Epoch: 28, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
Validation loss decreased (-0.908104 --> -0.910807).  Saving model ...
Epoch: 29 cost time: 2.8326594829559326
Epoch: 29, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.910807 --> -0.921618).  Saving model ...
Epoch: 30 cost time: 2.775869369506836
Epoch: 30, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
Validation loss decreased (-0.921618 --> -0.921618).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9216216216216216
model parameter : 175041
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.6219642162323
Epoch: 1, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.234 Vali Acc: 0.114 Test Loss: 2.234 Test Acc: 0.114
Validation loss decreased (inf --> -0.113491).  Saving model ...
Epoch: 2 cost time: 4.045489549636841
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.187 Vali Acc: 0.146 Test Loss: 2.187 Test Acc: 0.146
Validation loss decreased (-0.113491 --> -0.145924).  Saving model ...
Epoch: 3 cost time: 4.007825613021851
Epoch: 3, Steps: 17 | Train Loss: 2.131 Vali Loss: 2.123 Vali Acc: 0.197 Test Loss: 2.123 Test Acc: 0.197
Validation loss decreased (-0.145924 --> -0.197276).  Saving model ...
Epoch: 4 cost time: 4.076744079589844
Epoch: 4, Steps: 17 | Train Loss: 2.037 Vali Loss: 2.045 Vali Acc: 0.295 Test Loss: 2.045 Test Acc: 0.295
Validation loss decreased (-0.197276 --> -0.294574).  Saving model ...
Epoch: 5 cost time: 3.9099528789520264
Epoch: 5, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.956 Vali Acc: 0.370 Test Loss: 1.956 Test Acc: 0.370
Validation loss decreased (-0.294574 --> -0.370251).  Saving model ...
Epoch: 6 cost time: 3.628798246383667
Epoch: 6, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.851 Vali Acc: 0.473 Test Loss: 1.851 Test Acc: 0.473
Validation loss decreased (-0.370251 --> -0.472954).  Saving model ...
Epoch: 7 cost time: 3.742588758468628
Epoch: 7, Steps: 17 | Train Loss: 1.760 Vali Loss: 1.733 Vali Acc: 0.584 Test Loss: 1.733 Test Acc: 0.584
Validation loss decreased (-0.472954 --> -0.583766).  Saving model ...
Epoch: 8 cost time: 3.586038589477539
Epoch: 8, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.596 Vali Acc: 0.689 Test Loss: 1.596 Test Acc: 0.689
Validation loss decreased (-0.583766 --> -0.689173).  Saving model ...
Epoch: 9 cost time: 3.536332130432129
Epoch: 9, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.461 Vali Acc: 0.743 Test Loss: 1.461 Test Acc: 0.743
Validation loss decreased (-0.689173 --> -0.743229).  Saving model ...
Epoch: 10 cost time: 3.5795559883117676
Epoch: 10, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.337 Vali Acc: 0.795 Test Loss: 1.337 Test Acc: 0.795
Validation loss decreased (-0.743229 --> -0.794581).  Saving model ...
Epoch: 11 cost time: 3.4720473289489746
Epoch: 11, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.214 Vali Acc: 0.816 Test Loss: 1.214 Test Acc: 0.816
Validation loss decreased (-0.794581 --> -0.816204).  Saving model ...
Epoch: 12 cost time: 3.5371365547180176
Epoch: 12, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.090 Vali Acc: 0.830 Test Loss: 1.090 Test Acc: 0.830
Validation loss decreased (-0.816204 --> -0.829719).  Saving model ...
Epoch: 13 cost time: 3.4572677612304688
Epoch: 13, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.006 Vali Acc: 0.827 Test Loss: 1.006 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7518670558929443
Epoch: 14, Steps: 17 | Train Loss: 0.959 Vali Loss: 0.892 Vali Acc: 0.857 Test Loss: 0.892 Test Acc: 0.857
Validation loss decreased (-0.829719 --> -0.856748).  Saving model ...
Epoch: 15 cost time: 3.746277332305908
Epoch: 15, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.819 Vali Acc: 0.862 Test Loss: 0.819 Test Acc: 0.862
Validation loss decreased (-0.856748 --> -0.862154).  Saving model ...
Epoch: 16 cost time: 3.8615798950195312
Epoch: 16, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.750 Vali Acc: 0.868 Test Loss: 0.750 Test Acc: 0.868
Validation loss decreased (-0.862154 --> -0.867560).  Saving model ...
Epoch: 17 cost time: 3.777313232421875
Epoch: 17, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.678 Vali Acc: 0.881 Test Loss: 0.678 Test Acc: 0.881
Validation loss decreased (-0.867560 --> -0.881074).  Saving model ...
Epoch: 18 cost time: 3.949352979660034
Epoch: 18, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.617 Vali Acc: 0.897 Test Loss: 0.617 Test Acc: 0.897
Validation loss decreased (-0.881074 --> -0.897291).  Saving model ...
Epoch: 19 cost time: 3.936396598815918
Epoch: 19, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.569 Vali Acc: 0.900 Test Loss: 0.569 Test Acc: 0.900
Validation loss decreased (-0.897291 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 3.865654706954956
Epoch: 20, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.512 Vali Acc: 0.919 Test Loss: 0.512 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918914).  Saving model ...
Epoch: 21 cost time: 3.7474405765533447
Epoch: 21, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.474 Vali Acc: 0.916 Test Loss: 0.474 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.881767511367798
Epoch: 22, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.425 Vali Acc: 0.922 Test Loss: 0.425 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 23 cost time: 3.8453848361968994
Epoch: 23, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.400 Vali Acc: 0.927 Test Loss: 0.400 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 24 cost time: 3.8241989612579346
Epoch: 24, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.358 Vali Acc: 0.935 Test Loss: 0.358 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935132).  Saving model ...
Epoch: 25 cost time: 3.889633893966675
Epoch: 25, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.338 Vali Acc: 0.946 Test Loss: 0.338 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 26 cost time: 3.6652631759643555
Epoch: 26, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.307 Vali Acc: 0.949 Test Loss: 0.307 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 27 cost time: 3.910114049911499
Epoch: 27, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.303 Vali Acc: 0.938 Test Loss: 0.303 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8162496089935303
Epoch: 28, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.266 Vali Acc: 0.946 Test Loss: 0.266 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.8783299922943115
Epoch: 29, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.267 Vali Acc: 0.949 Test Loss: 0.267 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 30 cost time: 3.931300163269043
Epoch: 30, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 295777
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.049502372741699
Epoch: 1, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.172 Vali Acc: 0.181 Test Loss: 2.172 Test Acc: 0.181
Validation loss decreased (inf --> -0.181059).  Saving model ...
Epoch: 2 cost time: 3.5635952949523926
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.143 Vali Acc: 0.205 Test Loss: 2.143 Test Acc: 0.205
Validation loss decreased (-0.181059 --> -0.205384).  Saving model ...
Epoch: 3 cost time: 3.592393636703491
Epoch: 3, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.103 Vali Acc: 0.246 Test Loss: 2.103 Test Acc: 0.246
Validation loss decreased (-0.205384 --> -0.245925).  Saving model ...
Epoch: 4 cost time: 3.41658878326416
Epoch: 4, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.052 Vali Acc: 0.343 Test Loss: 2.052 Test Acc: 0.343
Validation loss decreased (-0.245925 --> -0.343223).  Saving model ...
Epoch: 5 cost time: 3.393476963043213
Epoch: 5, Steps: 17 | Train Loss: 2.020 Vali Loss: 1.990 Vali Acc: 0.405 Test Loss: 1.990 Test Acc: 0.405
Validation loss decreased (-0.343223 --> -0.405386).  Saving model ...
Epoch: 6 cost time: 3.3742120265960693
Epoch: 6, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.921 Vali Acc: 0.495 Test Loss: 1.921 Test Acc: 0.495
Validation loss decreased (-0.405386 --> -0.494575).  Saving model ...
Epoch: 7 cost time: 3.5021374225616455
Epoch: 7, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.837 Vali Acc: 0.570 Test Loss: 1.837 Test Acc: 0.570
Validation loss decreased (-0.494575 --> -0.570252).  Saving model ...
Epoch: 8 cost time: 3.552323579788208
Epoch: 8, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.749 Vali Acc: 0.654 Test Loss: 1.749 Test Acc: 0.654
Validation loss decreased (-0.570252 --> -0.654037).  Saving model ...
Epoch: 9 cost time: 3.736762285232544
Epoch: 9, Steps: 17 | Train Loss: 1.711 Vali Loss: 1.644 Vali Acc: 0.727 Test Loss: 1.644 Test Acc: 0.727
Validation loss decreased (-0.654037 --> -0.727011).  Saving model ...
Epoch: 10 cost time: 3.6594154834747314
Epoch: 10, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.542 Vali Acc: 0.768 Test Loss: 1.542 Test Acc: 0.768
Validation loss decreased (-0.727011 --> -0.767552).  Saving model ...
Epoch: 11 cost time: 3.658339023590088
Epoch: 11, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.425 Vali Acc: 0.795 Test Loss: 1.425 Test Acc: 0.795
Validation loss decreased (-0.767552 --> -0.794580).  Saving model ...
Epoch: 12 cost time: 3.616544723510742
Epoch: 12, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.313 Vali Acc: 0.803 Test Loss: 1.313 Test Acc: 0.803
Validation loss decreased (-0.794580 --> -0.802690).  Saving model ...
Epoch: 13 cost time: 3.774228096008301
Epoch: 13, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.195 Vali Acc: 0.814 Test Loss: 1.195 Test Acc: 0.814
Validation loss decreased (-0.802690 --> -0.813502).  Saving model ...
Epoch: 14 cost time: 3.6727139949798584
Epoch: 14, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.100 Vali Acc: 0.827 Test Loss: 1.100 Test Acc: 0.827
Validation loss decreased (-0.813502 --> -0.827016).  Saving model ...
Epoch: 15 cost time: 3.69543719291687
Epoch: 15, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.013 Vali Acc: 0.816 Test Loss: 1.013 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2421369552612305
Epoch: 16, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.926 Vali Acc: 0.819 Test Loss: 0.926 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.295074939727783
Epoch: 17, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.857 Vali Acc: 0.824 Test Loss: 0.857 Test Acc: 0.824
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.697611093521118
Epoch: 18, Steps: 17 | Train Loss: 0.762 Vali Loss: 0.769 Vali Acc: 0.835 Test Loss: 0.769 Test Acc: 0.835
Validation loss decreased (-0.827016 --> -0.835127).  Saving model ...
Epoch: 19 cost time: 3.6659395694732666
Epoch: 19, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.734 Vali Acc: 0.835 Test Loss: 0.734 Test Acc: 0.835
Validation loss decreased (-0.835127 --> -0.835128).  Saving model ...
Epoch: 20 cost time: 3.754659414291382
Epoch: 20, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.698 Vali Acc: 0.832 Test Loss: 0.698 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.696894884109497
Epoch: 21, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.626 Vali Acc: 0.857 Test Loss: 0.626 Test Acc: 0.857
Validation loss decreased (-0.835128 --> -0.856750).  Saving model ...
Epoch: 22 cost time: 3.632330894470215
Epoch: 22, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.593 Vali Acc: 0.859 Test Loss: 0.593 Test Acc: 0.859
Validation loss decreased (-0.856750 --> -0.859454).  Saving model ...
Epoch: 23 cost time: 3.427950143814087
Epoch: 23, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.554 Vali Acc: 0.873 Test Loss: 0.554 Test Acc: 0.873
Validation loss decreased (-0.859454 --> -0.872967).  Saving model ...
Epoch: 24 cost time: 3.5665314197540283
Epoch: 24, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.505 Vali Acc: 0.895 Test Loss: 0.505 Test Acc: 0.895
Validation loss decreased (-0.872967 --> -0.894590).  Saving model ...
Epoch: 25 cost time: 3.5105791091918945
Epoch: 25, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.477 Vali Acc: 0.905 Test Loss: 0.477 Test Acc: 0.905
Validation loss decreased (-0.894590 --> -0.905401).  Saving model ...
Epoch: 26 cost time: 3.625520944595337
Epoch: 26, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.439 Vali Acc: 0.897 Test Loss: 0.439 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4114601612091064
Epoch: 27, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.424 Vali Acc: 0.892 Test Loss: 0.424 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.475276470184326
Epoch: 28, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.396 Vali Acc: 0.895 Test Loss: 0.396 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.595365047454834
Epoch: 29, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.364 Vali Acc: 0.911 Test Loss: 0.364 Test Acc: 0.911
Validation loss decreased (-0.905401 --> -0.910807).  Saving model ...
Epoch: 30 cost time: 3.581496477127075
Epoch: 30, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.361 Vali Acc: 0.908 Test Loss: 0.361 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9108108108108108
model parameter : 88769
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.015330076217651
Epoch: 1, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.235 Vali Acc: 0.114 Test Loss: 2.235 Test Acc: 0.114
Validation loss decreased (inf --> -0.113491).  Saving model ...
Epoch: 2 cost time: 3.3976521492004395
Epoch: 2, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.188 Vali Acc: 0.146 Test Loss: 2.188 Test Acc: 0.146
Validation loss decreased (-0.113491 --> -0.145924).  Saving model ...
Epoch: 3 cost time: 3.2931199073791504
Epoch: 3, Steps: 17 | Train Loss: 2.132 Vali Loss: 2.124 Vali Acc: 0.197 Test Loss: 2.124 Test Acc: 0.197
Validation loss decreased (-0.145924 --> -0.197276).  Saving model ...
Epoch: 4 cost time: 3.34684157371521
Epoch: 4, Steps: 17 | Train Loss: 2.039 Vali Loss: 2.047 Vali Acc: 0.297 Test Loss: 2.047 Test Acc: 0.297
Validation loss decreased (-0.197276 --> -0.297277).  Saving model ...
Epoch: 5 cost time: 3.5937819480895996
Epoch: 5, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.959 Vali Acc: 0.362 Test Loss: 1.959 Test Acc: 0.362
Validation loss decreased (-0.297277 --> -0.362143).  Saving model ...
Epoch: 6 cost time: 3.6411755084991455
Epoch: 6, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.859 Vali Acc: 0.454 Test Loss: 1.859 Test Acc: 0.454
Validation loss decreased (-0.362143 --> -0.454035).  Saving model ...
Epoch: 7 cost time: 3.6698155403137207
Epoch: 7, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.747 Vali Acc: 0.554 Test Loss: 1.747 Test Acc: 0.554
Validation loss decreased (-0.454035 --> -0.554037).  Saving model ...
Epoch: 8 cost time: 3.657219886779785
Epoch: 8, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.624 Vali Acc: 0.622 Test Loss: 1.624 Test Acc: 0.622
Validation loss decreased (-0.554037 --> -0.621605).  Saving model ...
Epoch: 9 cost time: 3.4907405376434326
Epoch: 9, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.508 Vali Acc: 0.695 Test Loss: 1.508 Test Acc: 0.695
Validation loss decreased (-0.621605 --> -0.694580).  Saving model ...
Epoch: 10 cost time: 3.548306941986084
Epoch: 10, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.395 Vali Acc: 0.768 Test Loss: 1.395 Test Acc: 0.768
Validation loss decreased (-0.694580 --> -0.767554).  Saving model ...
Epoch: 11 cost time: 3.4330990314483643
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.289 Vali Acc: 0.800 Test Loss: 1.289 Test Acc: 0.800
Validation loss decreased (-0.767554 --> -0.799987).  Saving model ...
Epoch: 12 cost time: 3.461925983428955
Epoch: 12, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.182 Vali Acc: 0.824 Test Loss: 1.182 Test Acc: 0.824
Validation loss decreased (-0.799987 --> -0.824313).  Saving model ...
Epoch: 13 cost time: 3.5275657176971436
Epoch: 13, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.099 Vali Acc: 0.830 Test Loss: 1.099 Test Acc: 0.830
Validation loss decreased (-0.824313 --> -0.829719).  Saving model ...
Epoch: 14 cost time: 3.3387820720672607
Epoch: 14, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.009 Vali Acc: 0.846 Test Loss: 1.009 Test Acc: 0.846
Validation loss decreased (-0.829719 --> -0.845936).  Saving model ...
Epoch: 15 cost time: 3.476113796234131
Epoch: 15, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.908 Vali Acc: 0.854 Test Loss: 0.908 Test Acc: 0.854
Validation loss decreased (-0.845936 --> -0.854045).  Saving model ...
Epoch: 16 cost time: 3.337848663330078
Epoch: 16, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.841 Vali Acc: 0.851 Test Loss: 0.841 Test Acc: 0.851
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.394254207611084
Epoch: 17, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.762 Vali Acc: 0.873 Test Loss: 0.762 Test Acc: 0.873
Validation loss decreased (-0.854045 --> -0.872965).  Saving model ...
Epoch: 18 cost time: 3.3330047130584717
Epoch: 18, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.691 Vali Acc: 0.884 Test Loss: 0.691 Test Acc: 0.884
Validation loss decreased (-0.872965 --> -0.883777).  Saving model ...
Epoch: 19 cost time: 3.2770988941192627
Epoch: 19, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.645 Vali Acc: 0.876 Test Loss: 0.645 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.215163469314575
Epoch: 20, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.584 Vali Acc: 0.884 Test Loss: 0.584 Test Acc: 0.884
Validation loss decreased (-0.883777 --> -0.883778).  Saving model ...
Epoch: 21 cost time: 3.286281108856201
Epoch: 21, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.537 Vali Acc: 0.911 Test Loss: 0.537 Test Acc: 0.911
Validation loss decreased (-0.883778 --> -0.910805).  Saving model ...
Epoch: 22 cost time: 3.354456901550293
Epoch: 22, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.478 Vali Acc: 0.905 Test Loss: 0.478 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3346426486968994
Epoch: 23, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 24 cost time: 3.2555603981018066
Epoch: 24, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
Validation loss decreased (-0.910806 --> -0.910807).  Saving model ...
Epoch: 25 cost time: 3.3626506328582764
Epoch: 25, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.392 Vali Acc: 0.932 Test Loss: 0.392 Test Acc: 0.932
Validation loss decreased (-0.910807 --> -0.932429).  Saving model ...
Epoch: 26 cost time: 2.7451155185699463
Epoch: 26, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.366 Vali Acc: 0.930 Test Loss: 0.366 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.957472562789917
Epoch: 27, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.354 Vali Acc: 0.927 Test Loss: 0.354 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6454315185546875
Epoch: 28, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.314 Vali Acc: 0.943 Test Loss: 0.314 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943240).  Saving model ...
Epoch: 29 cost time: 3.5634703636169434
Epoch: 29, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.328 Vali Acc: 0.924 Test Loss: 0.328 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.575354814529419
Epoch: 30, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.276 Vali Acc: 0.951 Test Loss: 0.276 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 295777
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.65639066696167
Epoch: 1, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.172 Vali Acc: 0.178 Test Loss: 2.172 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 3.3926053047180176
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.143 Vali Acc: 0.205 Test Loss: 2.143 Test Acc: 0.205
Validation loss decreased (-0.178357 --> -0.205384).  Saving model ...
Epoch: 3 cost time: 3.354046106338501
Epoch: 3, Steps: 17 | Train Loss: 2.122 Vali Loss: 2.104 Vali Acc: 0.243 Test Loss: 2.104 Test Acc: 0.243
Validation loss decreased (-0.205384 --> -0.243222).  Saving model ...
Epoch: 4 cost time: 3.3453285694122314
Epoch: 4, Steps: 17 | Train Loss: 2.081 Vali Loss: 2.053 Vali Acc: 0.343 Test Loss: 2.053 Test Acc: 0.343
Validation loss decreased (-0.243222 --> -0.343223).  Saving model ...
Epoch: 5 cost time: 3.308974266052246
Epoch: 5, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.992 Vali Acc: 0.405 Test Loss: 1.992 Test Acc: 0.405
Validation loss decreased (-0.343223 --> -0.405385).  Saving model ...
Epoch: 6 cost time: 3.2268545627593994
Epoch: 6, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.926 Vali Acc: 0.492 Test Loss: 1.926 Test Acc: 0.492
Validation loss decreased (-0.405385 --> -0.491873).  Saving model ...
Epoch: 7 cost time: 3.3058738708496094
Epoch: 7, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.846 Vali Acc: 0.565 Test Loss: 1.846 Test Acc: 0.565
Validation loss decreased (-0.491873 --> -0.564846).  Saving model ...
Epoch: 8 cost time: 3.2151622772216797
Epoch: 8, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.760 Vali Acc: 0.649 Test Loss: 1.760 Test Acc: 0.649
Validation loss decreased (-0.564846 --> -0.648631).  Saving model ...
Epoch: 9 cost time: 3.2042787075042725
Epoch: 9, Steps: 17 | Train Loss: 1.721 Vali Loss: 1.658 Vali Acc: 0.705 Test Loss: 1.658 Test Acc: 0.705
Validation loss decreased (-0.648631 --> -0.705389).  Saving model ...
Epoch: 10 cost time: 3.3360867500305176
Epoch: 10, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.557 Vali Acc: 0.746 Test Loss: 1.557 Test Acc: 0.746
Validation loss decreased (-0.705389 --> -0.745930).  Saving model ...
Epoch: 11 cost time: 3.266578197479248
Epoch: 11, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.445 Vali Acc: 0.784 Test Loss: 1.445 Test Acc: 0.784
Validation loss decreased (-0.745930 --> -0.783769).  Saving model ...
Epoch: 12 cost time: 3.2507097721099854
Epoch: 12, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.335 Vali Acc: 0.805 Test Loss: 1.335 Test Acc: 0.805
Validation loss decreased (-0.783769 --> -0.805392).  Saving model ...
Epoch: 13 cost time: 3.123260021209717
Epoch: 13, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.224 Vali Acc: 0.814 Test Loss: 1.224 Test Acc: 0.814
Validation loss decreased (-0.805392 --> -0.813501).  Saving model ...
Epoch: 14 cost time: 3.1401114463806152
Epoch: 14, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.136 Vali Acc: 0.824 Test Loss: 1.136 Test Acc: 0.824
Validation loss decreased (-0.813501 --> -0.824313).  Saving model ...
Epoch: 15 cost time: 3.0941338539123535
Epoch: 15, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.041 Vali Acc: 0.816 Test Loss: 1.041 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.231707811355591
Epoch: 16, Steps: 17 | Train Loss: 0.955 Vali Loss: 0.967 Vali Acc: 0.822 Test Loss: 0.967 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.353661060333252
Epoch: 17, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.880 Vali Acc: 0.830 Test Loss: 0.880 Test Acc: 0.830
Validation loss decreased (-0.824313 --> -0.829721).  Saving model ...
Epoch: 18 cost time: 3.371584892272949
Epoch: 18, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.806 Vali Acc: 0.841 Test Loss: 0.806 Test Acc: 0.841
Validation loss decreased (-0.829721 --> -0.840532).  Saving model ...
Epoch: 19 cost time: 3.3178765773773193
Epoch: 19, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.753 Vali Acc: 0.838 Test Loss: 0.753 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.345444679260254
Epoch: 20, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.725 Vali Acc: 0.835 Test Loss: 0.725 Test Acc: 0.835
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2854418754577637
Epoch: 21, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.660 Vali Acc: 0.838 Test Loss: 0.660 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2699148654937744
Epoch: 22, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.616 Vali Acc: 0.865 Test Loss: 0.616 Test Acc: 0.865
Validation loss decreased (-0.840532 --> -0.864859).  Saving model ...
Epoch: 23 cost time: 3.3417000770568848
Epoch: 23, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.578 Vali Acc: 0.870 Test Loss: 0.578 Test Acc: 0.870
Validation loss decreased (-0.864859 --> -0.870264).  Saving model ...
Epoch: 24 cost time: 3.4956600666046143
Epoch: 24, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.543 Vali Acc: 0.881 Test Loss: 0.543 Test Acc: 0.881
Validation loss decreased (-0.870264 --> -0.881076).  Saving model ...
Epoch: 25 cost time: 3.3740975856781006
Epoch: 25, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.502 Vali Acc: 0.886 Test Loss: 0.502 Test Acc: 0.886
Validation loss decreased (-0.881076 --> -0.886481).  Saving model ...
Epoch: 26 cost time: 3.2949202060699463
Epoch: 26, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.477 Vali Acc: 0.886 Test Loss: 0.477 Test Acc: 0.886
Validation loss decreased (-0.886481 --> -0.886482).  Saving model ...
Epoch: 27 cost time: 3.1948633193969727
Epoch: 27, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.451 Vali Acc: 0.892 Test Loss: 0.451 Test Acc: 0.892
Validation loss decreased (-0.886482 --> -0.891887).  Saving model ...
Epoch: 28 cost time: 3.2003862857818604
Epoch: 28, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4063925743103027
Epoch: 29, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.270481586456299
Epoch: 30, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.375 Vali Acc: 0.908 Test Loss: 0.375 Test Acc: 0.908
Validation loss decreased (-0.891887 --> -0.908104).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9081081081081082
model parameter : 88769
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.214386940002441
Epoch: 1, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.235 Vali Acc: 0.116 Test Loss: 2.235 Test Acc: 0.116
Validation loss decreased (inf --> -0.116194).  Saving model ...
Epoch: 2 cost time: 2.7478246688842773
Epoch: 2, Steps: 17 | Train Loss: 2.168 Vali Loss: 2.189 Vali Acc: 0.146 Test Loss: 2.189 Test Acc: 0.146
Validation loss decreased (-0.116194 --> -0.145924).  Saving model ...
Epoch: 3 cost time: 2.86739444732666
Epoch: 3, Steps: 17 | Train Loss: 2.135 Vali Loss: 2.129 Vali Acc: 0.195 Test Loss: 2.129 Test Acc: 0.195
Validation loss decreased (-0.145924 --> -0.194573).  Saving model ...
Epoch: 4 cost time: 2.8832767009735107
Epoch: 4, Steps: 17 | Train Loss: 2.045 Vali Loss: 2.054 Vali Acc: 0.289 Test Loss: 2.054 Test Acc: 0.289
Validation loss decreased (-0.194573 --> -0.289169).  Saving model ...
Epoch: 5 cost time: 2.8142640590667725
Epoch: 5, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.971 Vali Acc: 0.351 Test Loss: 1.971 Test Acc: 0.351
Validation loss decreased (-0.289169 --> -0.351332).  Saving model ...
Epoch: 6 cost time: 2.760577917098999
Epoch: 6, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.877 Vali Acc: 0.438 Test Loss: 1.877 Test Acc: 0.438
Validation loss decreased (-0.351332 --> -0.437819).  Saving model ...
Epoch: 7 cost time: 2.9203217029571533
Epoch: 7, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.775 Vali Acc: 0.495 Test Loss: 1.775 Test Acc: 0.495
Validation loss decreased (-0.437819 --> -0.494577).  Saving model ...
Epoch: 8 cost time: 2.990074634552002
Epoch: 8, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.664 Vali Acc: 0.551 Test Loss: 1.664 Test Acc: 0.551
Validation loss decreased (-0.494577 --> -0.551335).  Saving model ...
Epoch: 9 cost time: 2.995518445968628
Epoch: 9, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.560 Vali Acc: 0.600 Test Loss: 1.560 Test Acc: 0.600
Validation loss decreased (-0.551335 --> -0.599984).  Saving model ...
Epoch: 10 cost time: 2.980443239212036
Epoch: 10, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.460 Vali Acc: 0.662 Test Loss: 1.460 Test Acc: 0.662
Validation loss decreased (-0.599984 --> -0.662148).  Saving model ...
Epoch: 11 cost time: 3.0936880111694336
Epoch: 11, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.359 Vali Acc: 0.689 Test Loss: 1.359 Test Acc: 0.689
Validation loss decreased (-0.662148 --> -0.689176).  Saving model ...
Epoch: 12 cost time: 3.0542047023773193
Epoch: 12, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.269 Vali Acc: 0.738 Test Loss: 1.269 Test Acc: 0.738
Validation loss decreased (-0.689176 --> -0.737825).  Saving model ...
Epoch: 13 cost time: 3.035311222076416
Epoch: 13, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.177 Vali Acc: 0.749 Test Loss: 1.177 Test Acc: 0.749
Validation loss decreased (-0.737825 --> -0.748637).  Saving model ...
Epoch: 14 cost time: 3.128340482711792
Epoch: 14, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.097 Vali Acc: 0.778 Test Loss: 1.097 Test Acc: 0.778
Validation loss decreased (-0.748637 --> -0.778367).  Saving model ...
Epoch: 15 cost time: 3.1314961910247803
Epoch: 15, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.013 Vali Acc: 0.786 Test Loss: 1.013 Test Acc: 0.786
Validation loss decreased (-0.778367 --> -0.786476).  Saving model ...
Epoch: 16 cost time: 3.0004866123199463
Epoch: 16, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.946 Vali Acc: 0.805 Test Loss: 0.946 Test Acc: 0.805
Validation loss decreased (-0.786476 --> -0.805396).  Saving model ...
Epoch: 17 cost time: 3.0243608951568604
Epoch: 17, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.876 Vali Acc: 0.832 Test Loss: 0.876 Test Acc: 0.832
Validation loss decreased (-0.805396 --> -0.832424).  Saving model ...
Epoch: 18 cost time: 3.001943826675415
Epoch: 18, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.810 Vali Acc: 0.846 Test Loss: 0.810 Test Acc: 0.846
Validation loss decreased (-0.832424 --> -0.845938).  Saving model ...
Epoch: 19 cost time: 2.9243154525756836
Epoch: 19, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.752 Vali Acc: 0.865 Test Loss: 0.752 Test Acc: 0.865
Validation loss decreased (-0.845938 --> -0.864857).  Saving model ...
Epoch: 20 cost time: 2.9268264770507812
Epoch: 20, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.698 Vali Acc: 0.870 Test Loss: 0.698 Test Acc: 0.870
Validation loss decreased (-0.864857 --> -0.870263).  Saving model ...
Epoch: 21 cost time: 2.9048829078674316
Epoch: 21, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.629 Vali Acc: 0.903 Test Loss: 0.629 Test Acc: 0.903
Validation loss decreased (-0.870263 --> -0.902696).  Saving model ...
Epoch: 22 cost time: 2.7578883171081543
Epoch: 22, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.580 Vali Acc: 0.919 Test Loss: 0.580 Test Acc: 0.919
Validation loss decreased (-0.902696 --> -0.918913).  Saving model ...
Epoch: 23 cost time: 2.97914457321167
Epoch: 23, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.535 Vali Acc: 0.914 Test Loss: 0.535 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9986283779144287
Epoch: 24, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.504 Vali Acc: 0.916 Test Loss: 0.504 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.990241527557373
Epoch: 25, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
Validation loss decreased (-0.918913 --> -0.929725).  Saving model ...
Epoch: 26 cost time: 2.999751567840576
Epoch: 26, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.425 Vali Acc: 0.932 Test Loss: 0.425 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932428).  Saving model ...
Epoch: 27 cost time: 3.0525455474853516
Epoch: 27, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.384 Vali Acc: 0.946 Test Loss: 0.384 Test Acc: 0.946
Validation loss decreased (-0.932428 --> -0.945942).  Saving model ...
Epoch: 28 cost time: 3.0054805278778076
Epoch: 28, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.370 Vali Acc: 0.949 Test Loss: 0.370 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 29 cost time: 3.0915114879608154
Epoch: 29, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.337 Vali Acc: 0.943 Test Loss: 0.337 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.936828374862671
Epoch: 30, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.331 Vali Acc: 0.946 Test Loss: 0.331 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 295777
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.316995620727539
Epoch: 1, Steps: 17 | Train Loss: 2.191 Vali Loss: 2.172 Vali Acc: 0.181 Test Loss: 2.172 Test Acc: 0.181
Validation loss decreased (inf --> -0.181059).  Saving model ...
Epoch: 2 cost time: 2.9176626205444336
Epoch: 2, Steps: 17 | Train Loss: 2.171 Vali Loss: 2.144 Vali Acc: 0.208 Test Loss: 2.144 Test Acc: 0.208
Validation loss decreased (-0.181059 --> -0.208087).  Saving model ...
Epoch: 3 cost time: 3.0041420459747314
Epoch: 3, Steps: 17 | Train Loss: 2.123 Vali Loss: 2.105 Vali Acc: 0.246 Test Loss: 2.105 Test Acc: 0.246
Validation loss decreased (-0.208087 --> -0.245925).  Saving model ...
Epoch: 4 cost time: 2.8523952960968018
Epoch: 4, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.055 Vali Acc: 0.346 Test Loss: 2.055 Test Acc: 0.346
Validation loss decreased (-0.245925 --> -0.345925).  Saving model ...
Epoch: 5 cost time: 2.8758058547973633
Epoch: 5, Steps: 17 | Train Loss: 2.024 Vali Loss: 1.996 Vali Acc: 0.400 Test Loss: 1.996 Test Acc: 0.400
Validation loss decreased (-0.345925 --> -0.399980).  Saving model ...
Epoch: 6 cost time: 2.959826946258545
Epoch: 6, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.931 Vali Acc: 0.489 Test Loss: 1.931 Test Acc: 0.489
Validation loss decreased (-0.399980 --> -0.489170).  Saving model ...
Epoch: 7 cost time: 2.877274513244629
Epoch: 7, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.852 Vali Acc: 0.557 Test Loss: 1.852 Test Acc: 0.557
Validation loss decreased (-0.489170 --> -0.556738).  Saving model ...
Epoch: 8 cost time: 2.9291441440582275
Epoch: 8, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.768 Vali Acc: 0.646 Test Loss: 1.768 Test Acc: 0.646
Validation loss decreased (-0.556738 --> -0.645928).  Saving model ...
Epoch: 9 cost time: 2.7626945972442627
Epoch: 9, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.668 Vali Acc: 0.700 Test Loss: 1.668 Test Acc: 0.700
Validation loss decreased (-0.645928 --> -0.699983).  Saving model ...
Epoch: 10 cost time: 2.7320168018341064
Epoch: 10, Steps: 17 | Train Loss: 1.601 Vali Loss: 1.568 Vali Acc: 0.743 Test Loss: 1.568 Test Acc: 0.743
Validation loss decreased (-0.699983 --> -0.743228).  Saving model ...
Epoch: 11 cost time: 2.76115345954895
Epoch: 11, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.459 Vali Acc: 0.792 Test Loss: 1.459 Test Acc: 0.792
Validation loss decreased (-0.743228 --> -0.791877).  Saving model ...
Epoch: 12 cost time: 2.650059700012207
Epoch: 12, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.348 Vali Acc: 0.789 Test Loss: 1.348 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6351969242095947
Epoch: 13, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.240 Vali Acc: 0.795 Test Loss: 1.240 Test Acc: 0.795
Validation loss decreased (-0.791877 --> -0.794582).  Saving model ...
Epoch: 14 cost time: 2.595750093460083
Epoch: 14, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.154 Vali Acc: 0.824 Test Loss: 1.154 Test Acc: 0.824
Validation loss decreased (-0.794582 --> -0.824313).  Saving model ...
Epoch: 15 cost time: 2.6008081436157227
Epoch: 15, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.057 Vali Acc: 0.814 Test Loss: 1.057 Test Acc: 0.814
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7044103145599365
Epoch: 16, Steps: 17 | Train Loss: 0.983 Vali Loss: 0.990 Vali Acc: 0.824 Test Loss: 0.990 Test Acc: 0.824
Validation loss decreased (-0.824313 --> -0.824314).  Saving model ...
Epoch: 17 cost time: 2.6123342514038086
Epoch: 17, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.912 Vali Acc: 0.822 Test Loss: 0.912 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6047396659851074
Epoch: 18, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.840 Vali Acc: 0.832 Test Loss: 0.840 Test Acc: 0.832
Validation loss decreased (-0.824314 --> -0.832424).  Saving model ...
Epoch: 19 cost time: 2.6080613136291504
Epoch: 19, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.788 Vali Acc: 0.819 Test Loss: 0.788 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6025242805480957
Epoch: 20, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.758 Vali Acc: 0.827 Test Loss: 0.758 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.630821466445923
Epoch: 21, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.698 Vali Acc: 0.838 Test Loss: 0.698 Test Acc: 0.838
Validation loss decreased (-0.832424 --> -0.837831).  Saving model ...
Epoch: 22 cost time: 2.5807900428771973
Epoch: 22, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.662 Vali Acc: 0.838 Test Loss: 0.662 Test Acc: 0.838
Validation loss decreased (-0.837831 --> -0.837831).  Saving model ...
Epoch: 23 cost time: 2.6969029903411865
Epoch: 23, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.623 Vali Acc: 0.854 Test Loss: 0.623 Test Acc: 0.854
Validation loss decreased (-0.837831 --> -0.854048).  Saving model ...
Epoch: 24 cost time: 2.833885669708252
Epoch: 24, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.597 Vali Acc: 0.843 Test Loss: 0.597 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9864625930786133
Epoch: 25, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.559 Vali Acc: 0.851 Test Loss: 0.559 Test Acc: 0.851
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7519781589508057
Epoch: 26, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.542 Vali Acc: 0.857 Test Loss: 0.542 Test Acc: 0.857
Validation loss decreased (-0.854048 --> -0.856751).  Saving model ...
Epoch: 27 cost time: 2.773428440093994
Epoch: 27, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.503 Vali Acc: 0.859 Test Loss: 0.503 Test Acc: 0.859
Validation loss decreased (-0.856751 --> -0.859454).  Saving model ...
Epoch: 28 cost time: 2.8114471435546875
Epoch: 28, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.495 Vali Acc: 0.859 Test Loss: 0.495 Test Acc: 0.859
Validation loss decreased (-0.859454 --> -0.859455).  Saving model ...
Epoch: 29 cost time: 2.852385997772217
Epoch: 29, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.468 Vali Acc: 0.868 Test Loss: 0.468 Test Acc: 0.868
Validation loss decreased (-0.859455 --> -0.867563).  Saving model ...
Epoch: 30 cost time: 2.87922739982605
Epoch: 30, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.440 Vali Acc: 0.878 Test Loss: 0.440 Test Acc: 0.878
Validation loss decreased (-0.867563 --> -0.878374).  Saving model ...
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.8783783783783784
model parameter : 88769
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.659632444381714
Epoch: 1, Steps: 17 | Train Loss: 2.248 Vali Loss: 2.223 Vali Acc: 0.159 Test Loss: 2.223 Test Acc: 0.159
Validation loss decreased (inf --> -0.159437).  Saving model ...
Epoch: 2 cost time: 4.364703416824341
Epoch: 2, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.180 Vali Acc: 0.189 Test Loss: 2.180 Test Acc: 0.189
Validation loss decreased (-0.159437 --> -0.189167).  Saving model ...
Epoch: 3 cost time: 4.0236499309539795
Epoch: 3, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.120 Vali Acc: 0.241 Test Loss: 2.120 Test Acc: 0.241
Validation loss decreased (-0.189167 --> -0.240519).  Saving model ...
Epoch: 4 cost time: 4.105032444000244
Epoch: 4, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.051 Vali Acc: 0.300 Test Loss: 2.051 Test Acc: 0.300
Validation loss decreased (-0.240519 --> -0.299979).  Saving model ...
Epoch: 5 cost time: 3.908961772918701
Epoch: 5, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.973 Vali Acc: 0.341 Test Loss: 1.973 Test Acc: 0.341
Validation loss decreased (-0.299979 --> -0.340521).  Saving model ...
Epoch: 6 cost time: 4.17833137512207
Epoch: 6, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.885 Vali Acc: 0.435 Test Loss: 1.885 Test Acc: 0.435
Validation loss decreased (-0.340521 --> -0.435116).  Saving model ...
Epoch: 7 cost time: 4.124502897262573
Epoch: 7, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.786 Vali Acc: 0.554 Test Loss: 1.786 Test Acc: 0.554
Validation loss decreased (-0.435116 --> -0.554036).  Saving model ...
Epoch: 8 cost time: 4.175635814666748
Epoch: 8, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.685 Vali Acc: 0.657 Test Loss: 1.685 Test Acc: 0.657
Validation loss decreased (-0.554036 --> -0.656740).  Saving model ...
Epoch: 9 cost time: 4.378267288208008
Epoch: 9, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.576 Vali Acc: 0.722 Test Loss: 1.576 Test Acc: 0.722
Validation loss decreased (-0.656740 --> -0.721606).  Saving model ...
Epoch: 10 cost time: 4.101016521453857
Epoch: 10, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.445 Vali Acc: 0.768 Test Loss: 1.445 Test Acc: 0.768
Validation loss decreased (-0.721606 --> -0.767553).  Saving model ...
Epoch: 11 cost time: 4.168814420700073
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.328 Vali Acc: 0.800 Test Loss: 1.328 Test Acc: 0.800
Validation loss decreased (-0.767553 --> -0.799987).  Saving model ...
Epoch: 12 cost time: 4.345703601837158
Epoch: 12, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.208 Vali Acc: 0.819 Test Loss: 1.208 Test Acc: 0.819
Validation loss decreased (-0.799987 --> -0.818907).  Saving model ...
Epoch: 13 cost time: 4.279231548309326
Epoch: 13, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.098 Vali Acc: 0.835 Test Loss: 1.098 Test Acc: 0.835
Validation loss decreased (-0.818907 --> -0.835124).  Saving model ...
Epoch: 14 cost time: 4.214396953582764
Epoch: 14, Steps: 17 | Train Loss: 0.988 Vali Loss: 0.996 Vali Acc: 0.854 Test Loss: 0.996 Test Acc: 0.854
Validation loss decreased (-0.835124 --> -0.854044).  Saving model ...
Epoch: 15 cost time: 4.2409656047821045
Epoch: 15, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.901 Vali Acc: 0.873 Test Loss: 0.901 Test Acc: 0.873
Validation loss decreased (-0.854044 --> -0.872964).  Saving model ...
Epoch: 16 cost time: 4.317299842834473
Epoch: 16, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.839 Vali Acc: 0.876 Test Loss: 0.839 Test Acc: 0.876
Validation loss decreased (-0.872964 --> -0.875667).  Saving model ...
Epoch: 17 cost time: 4.29597282409668
Epoch: 17, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.750 Vali Acc: 0.884 Test Loss: 0.750 Test Acc: 0.884
Validation loss decreased (-0.875667 --> -0.883776).  Saving model ...
Epoch: 18 cost time: 4.293110609054565
Epoch: 18, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.697 Vali Acc: 0.884 Test Loss: 0.697 Test Acc: 0.884
Validation loss decreased (-0.883776 --> -0.883777).  Saving model ...
Epoch: 19 cost time: 4.29472541809082
Epoch: 19, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.614 Vali Acc: 0.911 Test Loss: 0.614 Test Acc: 0.911
Validation loss decreased (-0.883777 --> -0.910805).  Saving model ...
Epoch: 20 cost time: 4.403541803359985
Epoch: 20, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.554 Vali Acc: 0.911 Test Loss: 0.554 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910805).  Saving model ...
Epoch: 21 cost time: 4.193178415298462
Epoch: 21, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.517 Vali Acc: 0.911 Test Loss: 0.517 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 22 cost time: 4.082902908325195
Epoch: 22, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.459 Vali Acc: 0.916 Test Loss: 0.459 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916212).  Saving model ...
Epoch: 23 cost time: 4.159484148025513
Epoch: 23, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.415 Vali Acc: 0.924 Test Loss: 0.415 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924320).  Saving model ...
Epoch: 24 cost time: 4.10783576965332
Epoch: 24, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.408 Vali Acc: 0.914 Test Loss: 0.408 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.127234220504761
Epoch: 25, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.363 Vali Acc: 0.919 Test Loss: 0.363 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.172640323638916
Epoch: 26, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.341 Vali Acc: 0.927 Test Loss: 0.341 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927024).  Saving model ...
Epoch: 27 cost time: 4.092404365539551
Epoch: 27, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.317 Vali Acc: 0.924 Test Loss: 0.317 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9993529319763184
Epoch: 28, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.292 Vali Acc: 0.938 Test Loss: 0.292 Test Acc: 0.938
Validation loss decreased (-0.927024 --> -0.937835).  Saving model ...
Epoch: 29 cost time: 4.1281983852386475
Epoch: 29, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.351 Vali Acc: 0.903 Test Loss: 0.351 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.099442481994629
Epoch: 30, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.310 Vali Acc: 0.924 Test Loss: 0.310 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 149153
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 6.2062060832977295
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.233 Vali Acc: 0.105 Test Loss: 2.233 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 3.696465015411377
Epoch: 2, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.193 Vali Acc: 0.141 Test Loss: 2.193 Test Acc: 0.141
Validation loss decreased (-0.105383 --> -0.140519).  Saving model ...
Epoch: 3 cost time: 3.660041332244873
Epoch: 3, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.141 Vali Acc: 0.192 Test Loss: 2.141 Test Acc: 0.192
Validation loss decreased (-0.140519 --> -0.191870).  Saving model ...
Epoch: 4 cost time: 3.7605810165405273
Epoch: 4, Steps: 17 | Train Loss: 2.110 Vali Loss: 2.080 Vali Acc: 0.249 Test Loss: 2.080 Test Acc: 0.249
Validation loss decreased (-0.191870 --> -0.248628).  Saving model ...
Epoch: 5 cost time: 3.7223925590515137
Epoch: 5, Steps: 17 | Train Loss: 2.045 Vali Loss: 2.012 Vali Acc: 0.305 Test Loss: 2.012 Test Acc: 0.305
Validation loss decreased (-0.248628 --> -0.305385).  Saving model ...
Epoch: 6 cost time: 3.7209620475769043
Epoch: 6, Steps: 17 | Train Loss: 1.978 Vali Loss: 1.940 Vali Acc: 0.349 Test Loss: 1.940 Test Acc: 0.349
Validation loss decreased (-0.305385 --> -0.348629).  Saving model ...
Epoch: 7 cost time: 2.8991382122039795
Epoch: 7, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.861 Vali Acc: 0.414 Test Loss: 1.861 Test Acc: 0.414
Validation loss decreased (-0.348629 --> -0.413495).  Saving model ...
Epoch: 8 cost time: 3.784817934036255
Epoch: 8, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.776 Vali Acc: 0.524 Test Loss: 1.776 Test Acc: 0.524
Validation loss decreased (-0.413495 --> -0.524307).  Saving model ...
Epoch: 9 cost time: 3.706209659576416
Epoch: 9, Steps: 17 | Train Loss: 1.739 Vali Loss: 1.687 Vali Acc: 0.616 Test Loss: 1.687 Test Acc: 0.616
Validation loss decreased (-0.524307 --> -0.616199).  Saving model ...
Epoch: 10 cost time: 3.717458724975586
Epoch: 10, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.583 Vali Acc: 0.695 Test Loss: 1.583 Test Acc: 0.695
Validation loss decreased (-0.616199 --> -0.694579).  Saving model ...
Epoch: 11 cost time: 3.7434914112091064
Epoch: 11, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.481 Vali Acc: 0.735 Test Loss: 1.481 Test Acc: 0.735
Validation loss decreased (-0.694579 --> -0.735120).  Saving model ...
Epoch: 12 cost time: 3.6620516777038574
Epoch: 12, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.380 Vali Acc: 0.746 Test Loss: 1.380 Test Acc: 0.746
Validation loss decreased (-0.735120 --> -0.745932).  Saving model ...
Epoch: 13 cost time: 3.7381591796875
Epoch: 13, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.277 Vali Acc: 0.765 Test Loss: 1.277 Test Acc: 0.765
Validation loss decreased (-0.745932 --> -0.764852).  Saving model ...
Epoch: 14 cost time: 3.8538434505462646
Epoch: 14, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.181 Vali Acc: 0.781 Test Loss: 1.181 Test Acc: 0.781
Validation loss decreased (-0.764852 --> -0.781069).  Saving model ...
Epoch: 15 cost time: 3.8124842643737793
Epoch: 15, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.093 Vali Acc: 0.792 Test Loss: 1.093 Test Acc: 0.792
Validation loss decreased (-0.781069 --> -0.791881).  Saving model ...
Epoch: 16 cost time: 4.095982789993286
Epoch: 16, Steps: 17 | Train Loss: 0.998 Vali Loss: 0.992 Vali Acc: 0.800 Test Loss: 0.992 Test Acc: 0.800
Validation loss decreased (-0.791881 --> -0.799990).  Saving model ...
Epoch: 17 cost time: 4.095301389694214
Epoch: 17, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.925 Vali Acc: 0.827 Test Loss: 0.925 Test Acc: 0.827
Validation loss decreased (-0.799990 --> -0.827018).  Saving model ...
Epoch: 18 cost time: 4.022395849227905
Epoch: 18, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.816 Vali Acc: 0.843 Test Loss: 0.816 Test Acc: 0.843
Validation loss decreased (-0.827018 --> -0.843235).  Saving model ...
Epoch: 19 cost time: 4.077846050262451
Epoch: 19, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.731 Vali Acc: 0.862 Test Loss: 0.731 Test Acc: 0.862
Validation loss decreased (-0.843235 --> -0.862155).  Saving model ...
Epoch: 20 cost time: 3.9842851161956787
Epoch: 20, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.666 Vali Acc: 0.873 Test Loss: 0.666 Test Acc: 0.873
Validation loss decreased (-0.862155 --> -0.872966).  Saving model ...
Epoch: 21 cost time: 4.079979658126831
Epoch: 21, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.604 Vali Acc: 0.897 Test Loss: 0.604 Test Acc: 0.897
Validation loss decreased (-0.872966 --> -0.897291).  Saving model ...
Epoch: 22 cost time: 4.009807586669922
Epoch: 22, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.564 Vali Acc: 0.905 Test Loss: 0.564 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905400).  Saving model ...
Epoch: 23 cost time: 3.888286590576172
Epoch: 23, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.499 Vali Acc: 0.914 Test Loss: 0.499 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913509).  Saving model ...
Epoch: 24 cost time: 3.885608434677124
Epoch: 24, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918914).  Saving model ...
Epoch: 25 cost time: 3.7175443172454834
Epoch: 25, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.429 Vali Acc: 0.919 Test Loss: 0.429 Test Acc: 0.919
Validation loss decreased (-0.918914 --> -0.918915).  Saving model ...
Epoch: 26 cost time: 3.8221802711486816
Epoch: 26, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.413 Vali Acc: 0.916 Test Loss: 0.413 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.711630344390869
Epoch: 27, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.348 Vali Acc: 0.932 Test Loss: 0.348 Test Acc: 0.932
Validation loss decreased (-0.918915 --> -0.932429).  Saving model ...
Epoch: 28 cost time: 3.7536494731903076
Epoch: 28, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.344 Vali Acc: 0.935 Test Loss: 0.344 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 29 cost time: 3.6998610496520996
Epoch: 29, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.329 Vali Acc: 0.938 Test Loss: 0.329 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 30 cost time: 3.7187836170196533
Epoch: 30, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.309 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9378378378378378
model parameter : 45633
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.825183868408203
Epoch: 1, Steps: 17 | Train Loss: 2.248 Vali Loss: 2.223 Vali Acc: 0.159 Test Loss: 2.223 Test Acc: 0.159
Validation loss decreased (inf --> -0.159437).  Saving model ...
Epoch: 2 cost time: 3.142341375350952
Epoch: 2, Steps: 17 | Train Loss: 2.206 Vali Loss: 2.180 Vali Acc: 0.189 Test Loss: 2.180 Test Acc: 0.189
Validation loss decreased (-0.159437 --> -0.189167).  Saving model ...
Epoch: 3 cost time: 3.3944931030273438
Epoch: 3, Steps: 17 | Train Loss: 2.144 Vali Loss: 2.120 Vali Acc: 0.241 Test Loss: 2.120 Test Acc: 0.241
Validation loss decreased (-0.189167 --> -0.240519).  Saving model ...
Epoch: 4 cost time: 3.383164882659912
Epoch: 4, Steps: 17 | Train Loss: 2.081 Vali Loss: 2.051 Vali Acc: 0.297 Test Loss: 2.051 Test Acc: 0.297
Validation loss decreased (-0.240519 --> -0.297277).  Saving model ...
Epoch: 5 cost time: 3.4232406616210938
Epoch: 5, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.974 Vali Acc: 0.338 Test Loss: 1.974 Test Acc: 0.338
Validation loss decreased (-0.297277 --> -0.337818).  Saving model ...
Epoch: 6 cost time: 3.3608665466308594
Epoch: 6, Steps: 17 | Train Loss: 1.900 Vali Loss: 1.886 Vali Acc: 0.432 Test Loss: 1.886 Test Acc: 0.432
Validation loss decreased (-0.337818 --> -0.432414).  Saving model ...
Epoch: 7 cost time: 3.4514570236206055
Epoch: 7, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.788 Vali Acc: 0.546 Test Loss: 1.788 Test Acc: 0.546
Validation loss decreased (-0.432414 --> -0.545928).  Saving model ...
Epoch: 8 cost time: 3.3798956871032715
Epoch: 8, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.688 Vali Acc: 0.657 Test Loss: 1.688 Test Acc: 0.657
Validation loss decreased (-0.545928 --> -0.656740).  Saving model ...
Epoch: 9 cost time: 3.33990478515625
Epoch: 9, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.580 Vali Acc: 0.722 Test Loss: 1.580 Test Acc: 0.722
Validation loss decreased (-0.656740 --> -0.721606).  Saving model ...
Epoch: 10 cost time: 3.3433399200439453
Epoch: 10, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.450 Vali Acc: 0.784 Test Loss: 1.450 Test Acc: 0.784
Validation loss decreased (-0.721606 --> -0.783769).  Saving model ...
Epoch: 11 cost time: 3.4490253925323486
Epoch: 11, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.330 Vali Acc: 0.803 Test Loss: 1.330 Test Acc: 0.803
Validation loss decreased (-0.783769 --> -0.802689).  Saving model ...
Epoch: 12 cost time: 3.4277474880218506
Epoch: 12, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.212 Vali Acc: 0.814 Test Loss: 1.212 Test Acc: 0.814
Validation loss decreased (-0.802689 --> -0.813501).  Saving model ...
Epoch: 13 cost time: 3.222384452819824
Epoch: 13, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.109 Vali Acc: 0.827 Test Loss: 1.109 Test Acc: 0.827
Validation loss decreased (-0.813501 --> -0.827016).  Saving model ...
Epoch: 14 cost time: 3.218810558319092
Epoch: 14, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.017 Vali Acc: 0.843 Test Loss: 1.017 Test Acc: 0.843
Validation loss decreased (-0.827016 --> -0.843233).  Saving model ...
Epoch: 15 cost time: 3.220284938812256
Epoch: 15, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.926 Vali Acc: 0.870 Test Loss: 0.926 Test Acc: 0.870
Validation loss decreased (-0.843233 --> -0.870261).  Saving model ...
Epoch: 16 cost time: 3.1630923748016357
Epoch: 16, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.863 Vali Acc: 0.873 Test Loss: 0.863 Test Acc: 0.873
Validation loss decreased (-0.870261 --> -0.872964).  Saving model ...
Epoch: 17 cost time: 3.3331916332244873
Epoch: 17, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.781 Vali Acc: 0.884 Test Loss: 0.781 Test Acc: 0.884
Validation loss decreased (-0.872964 --> -0.883776).  Saving model ...
Epoch: 18 cost time: 3.242934465408325
Epoch: 18, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.728 Vali Acc: 0.892 Test Loss: 0.728 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 19 cost time: 3.28706431388855
Epoch: 19, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.654 Vali Acc: 0.897 Test Loss: 0.654 Test Acc: 0.897
Validation loss decreased (-0.891885 --> -0.897291).  Saving model ...
Epoch: 20 cost time: 3.287933111190796
Epoch: 20, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.592 Vali Acc: 0.905 Test Loss: 0.592 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905399).  Saving model ...
Epoch: 21 cost time: 3.409348487854004
Epoch: 21, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.560 Vali Acc: 0.911 Test Loss: 0.560 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910805).  Saving model ...
Epoch: 22 cost time: 3.2319161891937256
Epoch: 22, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.501 Vali Acc: 0.916 Test Loss: 0.501 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 23 cost time: 3.5261287689208984
Epoch: 23, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918914).  Saving model ...
Epoch: 24 cost time: 3.453658103942871
Epoch: 24, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.428 Vali Acc: 0.916 Test Loss: 0.428 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3923895359039307
Epoch: 25, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.423 Vali Acc: 0.908 Test Loss: 0.423 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.407240629196167
Epoch: 26, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.392 Vali Acc: 0.914 Test Loss: 0.392 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.4901416301727295
Epoch: 27, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
Validation loss decreased (-0.918914 --> -0.929726).  Saving model ...
Epoch: 28 cost time: 3.4181761741638184
Epoch: 28, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.344 Vali Acc: 0.911 Test Loss: 0.344 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.409982442855835
Epoch: 29, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.379 Vali Acc: 0.895 Test Loss: 0.379 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.3777096271514893
Epoch: 30, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.321 Vali Acc: 0.905 Test Loss: 0.321 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9297297297297298
model parameter : 149153
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.396075487136841
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.234 Vali Acc: 0.103 Test Loss: 2.234 Test Acc: 0.103
Validation loss decreased (inf --> -0.102680).  Saving model ...
Epoch: 2 cost time: 3.2220981121063232
Epoch: 2, Steps: 17 | Train Loss: 2.239 Vali Loss: 2.194 Vali Acc: 0.138 Test Loss: 2.194 Test Acc: 0.138
Validation loss decreased (-0.102680 --> -0.137816).  Saving model ...
Epoch: 3 cost time: 3.153660774230957
Epoch: 3, Steps: 17 | Train Loss: 2.177 Vali Loss: 2.143 Vali Acc: 0.192 Test Loss: 2.143 Test Acc: 0.192
Validation loss decreased (-0.137816 --> -0.191870).  Saving model ...
Epoch: 4 cost time: 3.1439905166625977
Epoch: 4, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.083 Vali Acc: 0.249 Test Loss: 2.083 Test Acc: 0.249
Validation loss decreased (-0.191870 --> -0.248628).  Saving model ...
Epoch: 5 cost time: 3.083411455154419
Epoch: 5, Steps: 17 | Train Loss: 2.048 Vali Loss: 2.016 Vali Acc: 0.297 Test Loss: 2.016 Test Acc: 0.297
Validation loss decreased (-0.248628 --> -0.297277).  Saving model ...
Epoch: 6 cost time: 3.1952707767486572
Epoch: 6, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.944 Vali Acc: 0.351 Test Loss: 1.944 Test Acc: 0.351
Validation loss decreased (-0.297277 --> -0.351332).  Saving model ...
Epoch: 7 cost time: 3.19978666305542
Epoch: 7, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.866 Vali Acc: 0.422 Test Loss: 1.866 Test Acc: 0.422
Validation loss decreased (-0.351332 --> -0.421603).  Saving model ...
Epoch: 8 cost time: 3.1031808853149414
Epoch: 8, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.780 Vali Acc: 0.522 Test Loss: 1.780 Test Acc: 0.522
Validation loss decreased (-0.421603 --> -0.521604).  Saving model ...
Epoch: 9 cost time: 3.0806901454925537
Epoch: 9, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.690 Vali Acc: 0.627 Test Loss: 1.690 Test Acc: 0.627
Validation loss decreased (-0.521604 --> -0.627010).  Saving model ...
Epoch: 10 cost time: 2.9680304527282715
Epoch: 10, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.584 Vali Acc: 0.714 Test Loss: 1.584 Test Acc: 0.714
Validation loss decreased (-0.627010 --> -0.713498).  Saving model ...
Epoch: 11 cost time: 2.989561080932617
Epoch: 11, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.480 Vali Acc: 0.746 Test Loss: 1.480 Test Acc: 0.746
Validation loss decreased (-0.713498 --> -0.745931).  Saving model ...
Epoch: 12 cost time: 3.1105995178222656
Epoch: 12, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.382 Vali Acc: 0.741 Test Loss: 1.382 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.092317581176758
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.282 Vali Acc: 0.762 Test Loss: 1.282 Test Acc: 0.762
Validation loss decreased (-0.745931 --> -0.762149).  Saving model ...
Epoch: 14 cost time: 3.121220111846924
Epoch: 14, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.186 Vali Acc: 0.784 Test Loss: 1.186 Test Acc: 0.784
Validation loss decreased (-0.762149 --> -0.783772).  Saving model ...
Epoch: 15 cost time: 3.2092037200927734
Epoch: 15, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.095 Vali Acc: 0.795 Test Loss: 1.095 Test Acc: 0.795
Validation loss decreased (-0.783772 --> -0.794584).  Saving model ...
Epoch: 16 cost time: 3.156646966934204
Epoch: 16, Steps: 17 | Train Loss: 1.005 Vali Loss: 0.993 Vali Acc: 0.805 Test Loss: 0.993 Test Acc: 0.805
Validation loss decreased (-0.794584 --> -0.805395).  Saving model ...
Epoch: 17 cost time: 3.1030023097991943
Epoch: 17, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.925 Vali Acc: 0.814 Test Loss: 0.925 Test Acc: 0.814
Validation loss decreased (-0.805395 --> -0.813504).  Saving model ...
Epoch: 18 cost time: 3.1622395515441895
Epoch: 18, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.820 Vali Acc: 0.846 Test Loss: 0.820 Test Acc: 0.846
Validation loss decreased (-0.813504 --> -0.845938).  Saving model ...
Epoch: 19 cost time: 3.1499671936035156
Epoch: 19, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.735 Vali Acc: 0.862 Test Loss: 0.735 Test Acc: 0.862
Validation loss decreased (-0.845938 --> -0.862155).  Saving model ...
Epoch: 20 cost time: 3.138554334640503
Epoch: 20, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.677 Vali Acc: 0.868 Test Loss: 0.677 Test Acc: 0.868
Validation loss decreased (-0.862155 --> -0.867561).  Saving model ...
Epoch: 21 cost time: 3.052187919616699
Epoch: 21, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.615 Vali Acc: 0.897 Test Loss: 0.615 Test Acc: 0.897
Validation loss decreased (-0.867561 --> -0.897291).  Saving model ...
Epoch: 22 cost time: 3.0422282218933105
Epoch: 22, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.573 Vali Acc: 0.895 Test Loss: 0.573 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.076462984085083
Epoch: 23, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.514 Vali Acc: 0.914 Test Loss: 0.514 Test Acc: 0.914
Validation loss decreased (-0.897291 --> -0.913508).  Saving model ...
Epoch: 24 cost time: 2.7690229415893555
Epoch: 24, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.458 Vali Acc: 0.922 Test Loss: 0.458 Test Acc: 0.922
Validation loss decreased (-0.913508 --> -0.921617).  Saving model ...
Epoch: 25 cost time: 2.9384427070617676
Epoch: 25, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.433 Vali Acc: 0.919 Test Loss: 0.433 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9681849479675293
Epoch: 26, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.407 Vali Acc: 0.916 Test Loss: 0.407 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.157468318939209
Epoch: 27, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.366 Vali Acc: 0.924 Test Loss: 0.366 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924321).  Saving model ...
Epoch: 28 cost time: 3.0964622497558594
Epoch: 28, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1032791137695312
Epoch: 29, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.341 Vali Acc: 0.919 Test Loss: 0.341 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1491589546203613
Epoch: 30, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9243243243243243
model parameter : 45633
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.383955717086792
Epoch: 1, Steps: 17 | Train Loss: 2.248 Vali Loss: 2.223 Vali Acc: 0.159 Test Loss: 2.223 Test Acc: 0.159
Validation loss decreased (inf --> -0.159437).  Saving model ...
Epoch: 2 cost time: 2.9291276931762695
Epoch: 2, Steps: 17 | Train Loss: 2.206 Vali Loss: 2.180 Vali Acc: 0.189 Test Loss: 2.180 Test Acc: 0.189
Validation loss decreased (-0.159437 --> -0.189167).  Saving model ...
Epoch: 3 cost time: 3.0206398963928223
Epoch: 3, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.121 Vali Acc: 0.241 Test Loss: 2.121 Test Acc: 0.241
Validation loss decreased (-0.189167 --> -0.240519).  Saving model ...
Epoch: 4 cost time: 2.9055144786834717
Epoch: 4, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.053 Vali Acc: 0.289 Test Loss: 2.053 Test Acc: 0.289
Validation loss decreased (-0.240519 --> -0.289169).  Saving model ...
Epoch: 5 cost time: 2.907423734664917
Epoch: 5, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.977 Vali Acc: 0.327 Test Loss: 1.977 Test Acc: 0.327
Validation loss decreased (-0.289169 --> -0.327007).  Saving model ...
Epoch: 6 cost time: 2.9453284740448
Epoch: 6, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.890 Vali Acc: 0.427 Test Loss: 1.890 Test Acc: 0.427
Validation loss decreased (-0.327007 --> -0.427008).  Saving model ...
Epoch: 7 cost time: 2.977151870727539
Epoch: 7, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.795 Vali Acc: 0.546 Test Loss: 1.795 Test Acc: 0.546
Validation loss decreased (-0.427008 --> -0.545928).  Saving model ...
Epoch: 8 cost time: 2.997164487838745
Epoch: 8, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.699 Vali Acc: 0.643 Test Loss: 1.699 Test Acc: 0.643
Validation loss decreased (-0.545928 --> -0.643226).  Saving model ...
Epoch: 9 cost time: 2.90535569190979
Epoch: 9, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.600 Vali Acc: 0.700 Test Loss: 1.600 Test Acc: 0.700
Validation loss decreased (-0.643226 --> -0.699984).  Saving model ...
Epoch: 10 cost time: 2.9013993740081787
Epoch: 10, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.489 Vali Acc: 0.738 Test Loss: 1.489 Test Acc: 0.738
Validation loss decreased (-0.699984 --> -0.737823).  Saving model ...
Epoch: 11 cost time: 2.6992673873901367
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.762 Test Loss: 1.386 Test Acc: 0.762
Validation loss decreased (-0.737823 --> -0.762148).  Saving model ...
Epoch: 12 cost time: 2.7254679203033447
Epoch: 12, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.276 Vali Acc: 0.789 Test Loss: 1.276 Test Acc: 0.789
Validation loss decreased (-0.762148 --> -0.789176).  Saving model ...
Epoch: 13 cost time: 2.7531325817108154
Epoch: 13, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.174 Vali Acc: 0.808 Test Loss: 1.174 Test Acc: 0.808
Validation loss decreased (-0.789176 --> -0.808096).  Saving model ...
Epoch: 14 cost time: 2.807460069656372
Epoch: 14, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.086 Vali Acc: 0.827 Test Loss: 1.086 Test Acc: 0.827
Validation loss decreased (-0.808096 --> -0.827016).  Saving model ...
Epoch: 15 cost time: 2.912580728530884
Epoch: 15, Steps: 17 | Train Loss: 0.974 Vali Loss: 0.999 Vali Acc: 0.859 Test Loss: 0.999 Test Acc: 0.859
Validation loss decreased (-0.827016 --> -0.859449).  Saving model ...
Epoch: 16 cost time: 2.7082533836364746
Epoch: 16, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.926 Vali Acc: 0.862 Test Loss: 0.926 Test Acc: 0.862
Validation loss decreased (-0.859449 --> -0.862153).  Saving model ...
Epoch: 17 cost time: 2.873046636581421
Epoch: 17, Steps: 17 | Train Loss: 0.808 Vali Loss: 0.852 Vali Acc: 0.865 Test Loss: 0.852 Test Acc: 0.865
Validation loss decreased (-0.862153 --> -0.864856).  Saving model ...
Epoch: 18 cost time: 2.8074991703033447
Epoch: 18, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.794 Vali Acc: 0.876 Test Loss: 0.794 Test Acc: 0.876
Validation loss decreased (-0.864856 --> -0.875668).  Saving model ...
Epoch: 19 cost time: 2.85107684135437
Epoch: 19, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.730 Vali Acc: 0.886 Test Loss: 0.730 Test Acc: 0.886
Validation loss decreased (-0.875668 --> -0.886479).  Saving model ...
Epoch: 20 cost time: 2.801163673400879
Epoch: 20, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
Validation loss decreased (-0.886479 --> -0.889182).  Saving model ...
Epoch: 21 cost time: 2.778215169906616
Epoch: 21, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.630 Vali Acc: 0.900 Test Loss: 0.630 Test Acc: 0.900
Validation loss decreased (-0.889182 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 2.9887285232543945
Epoch: 22, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.592 Vali Acc: 0.895 Test Loss: 0.592 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.881774425506592
Epoch: 23, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.551 Vali Acc: 0.905 Test Loss: 0.551 Test Acc: 0.905
Validation loss decreased (-0.899994 --> -0.905400).  Saving model ...
Epoch: 24 cost time: 2.9228219985961914
Epoch: 24, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.513 Vali Acc: 0.905 Test Loss: 0.513 Test Acc: 0.905
Validation loss decreased (-0.905400 --> -0.905400).  Saving model ...
Epoch: 25 cost time: 2.893515110015869
Epoch: 25, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.480 Vali Acc: 0.908 Test Loss: 0.480 Test Acc: 0.908
Validation loss decreased (-0.905400 --> -0.908103).  Saving model ...
Epoch: 26 cost time: 2.78227162361145
Epoch: 26, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.471 Vali Acc: 0.908 Test Loss: 0.471 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908103).  Saving model ...
Epoch: 27 cost time: 2.922241449356079
Epoch: 27, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.428 Vali Acc: 0.914 Test Loss: 0.428 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 28 cost time: 2.9794139862060547
Epoch: 28, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.416 Vali Acc: 0.916 Test Loss: 0.416 Test Acc: 0.916
Validation loss decreased (-0.913509 --> -0.916212).  Saving model ...
Epoch: 29 cost time: 2.972325563430786
Epoch: 29, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.397 Vali Acc: 0.922 Test Loss: 0.397 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921618).  Saving model ...
Epoch: 30 cost time: 2.900862455368042
Epoch: 30, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.385 Vali Acc: 0.916 Test Loss: 0.385 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9216216216216216
model parameter : 149153
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.571246147155762
Epoch: 1, Steps: 17 | Train Loss: 2.251 Vali Loss: 2.235 Vali Acc: 0.105 Test Loss: 2.235 Test Acc: 0.105
Validation loss decreased (inf --> -0.105383).  Saving model ...
Epoch: 2 cost time: 2.575033187866211
Epoch: 2, Steps: 17 | Train Loss: 2.240 Vali Loss: 2.196 Vali Acc: 0.138 Test Loss: 2.196 Test Acc: 0.138
Validation loss decreased (-0.105383 --> -0.137816).  Saving model ...
Epoch: 3 cost time: 2.563441514968872
Epoch: 3, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.146 Vali Acc: 0.192 Test Loss: 2.146 Test Acc: 0.192
Validation loss decreased (-0.137816 --> -0.191870).  Saving model ...
Epoch: 4 cost time: 2.5239009857177734
Epoch: 4, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.087 Vali Acc: 0.243 Test Loss: 2.087 Test Acc: 0.243
Validation loss decreased (-0.191870 --> -0.243222).  Saving model ...
Epoch: 5 cost time: 2.4728994369506836
Epoch: 5, Steps: 17 | Train Loss: 2.051 Vali Loss: 2.022 Vali Acc: 0.292 Test Loss: 2.022 Test Acc: 0.292
Validation loss decreased (-0.243222 --> -0.291872).  Saving model ...
Epoch: 6 cost time: 2.5253753662109375
Epoch: 6, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.954 Vali Acc: 0.343 Test Loss: 1.954 Test Acc: 0.343
Validation loss decreased (-0.291872 --> -0.343224).  Saving model ...
Epoch: 7 cost time: 2.5797507762908936
Epoch: 7, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.881 Vali Acc: 0.403 Test Loss: 1.881 Test Acc: 0.403
Validation loss decreased (-0.343224 --> -0.402684).  Saving model ...
Epoch: 8 cost time: 2.531989574432373
Epoch: 8, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.804 Vali Acc: 0.505 Test Loss: 1.804 Test Acc: 0.505
Validation loss decreased (-0.402684 --> -0.505387).  Saving model ...
Epoch: 9 cost time: 2.5639493465423584
Epoch: 9, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.725 Vali Acc: 0.581 Test Loss: 1.725 Test Acc: 0.581
Validation loss decreased (-0.505387 --> -0.581064).  Saving model ...
Epoch: 10 cost time: 2.556143045425415
Epoch: 10, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.633 Vali Acc: 0.651 Test Loss: 1.633 Test Acc: 0.651
Validation loss decreased (-0.581064 --> -0.651335).  Saving model ...
Epoch: 11 cost time: 2.625455617904663
Epoch: 11, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.543 Vali Acc: 0.668 Test Loss: 1.543 Test Acc: 0.668
Validation loss decreased (-0.651335 --> -0.667552).  Saving model ...
Epoch: 12 cost time: 2.680466890335083
Epoch: 12, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.448 Vali Acc: 0.678 Test Loss: 1.448 Test Acc: 0.678
Validation loss decreased (-0.667552 --> -0.678364).  Saving model ...
Epoch: 13 cost time: 2.6205990314483643
Epoch: 13, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.350 Vali Acc: 0.722 Test Loss: 1.350 Test Acc: 0.722
Validation loss decreased (-0.678364 --> -0.721608).  Saving model ...
Epoch: 14 cost time: 2.6713387966156006
Epoch: 14, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.253 Vali Acc: 0.759 Test Loss: 1.253 Test Acc: 0.759
Validation loss decreased (-0.721608 --> -0.759447).  Saving model ...
Epoch: 15 cost time: 2.574190378189087
Epoch: 15, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.163 Vali Acc: 0.762 Test Loss: 1.163 Test Acc: 0.762
Validation loss decreased (-0.759447 --> -0.762151).  Saving model ...
Epoch: 16 cost time: 2.1956775188446045
Epoch: 16, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.069 Vali Acc: 0.773 Test Loss: 1.069 Test Acc: 0.773
Validation loss decreased (-0.762151 --> -0.772962).  Saving model ...
Epoch: 17 cost time: 2.7478630542755127
Epoch: 17, Steps: 17 | Train Loss: 0.959 Vali Loss: 0.995 Vali Acc: 0.795 Test Loss: 0.995 Test Acc: 0.795
Validation loss decreased (-0.772962 --> -0.794585).  Saving model ...
Epoch: 18 cost time: 2.3806722164154053
Epoch: 18, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.900 Vali Acc: 0.819 Test Loss: 0.900 Test Acc: 0.819
Validation loss decreased (-0.794585 --> -0.818910).  Saving model ...
Epoch: 19 cost time: 2.4631826877593994
Epoch: 19, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.816 Vali Acc: 0.841 Test Loss: 0.816 Test Acc: 0.841
Validation loss decreased (-0.818910 --> -0.840532).  Saving model ...
Epoch: 20 cost time: 2.676861047744751
Epoch: 20, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.741 Vali Acc: 0.873 Test Loss: 0.741 Test Acc: 0.873
Validation loss decreased (-0.840532 --> -0.872966).  Saving model ...
Epoch: 21 cost time: 2.674126625061035
Epoch: 21, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.677 Vali Acc: 0.892 Test Loss: 0.677 Test Acc: 0.892
Validation loss decreased (-0.872966 --> -0.891885).  Saving model ...
Epoch: 22 cost time: 2.79128360748291
Epoch: 22, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.625 Vali Acc: 0.892 Test Loss: 0.625 Test Acc: 0.892
Validation loss decreased (-0.891885 --> -0.891886).  Saving model ...
Epoch: 23 cost time: 2.6899333000183105
Epoch: 23, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.568 Vali Acc: 0.905 Test Loss: 0.568 Test Acc: 0.905
Validation loss decreased (-0.891886 --> -0.905400).  Saving model ...
Epoch: 24 cost time: 2.7412493228912354
Epoch: 24, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.513 Vali Acc: 0.914 Test Loss: 0.513 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913508).  Saving model ...
Epoch: 25 cost time: 2.6718273162841797
Epoch: 25, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.475 Vali Acc: 0.924 Test Loss: 0.475 Test Acc: 0.924
Validation loss decreased (-0.913508 --> -0.924320).  Saving model ...
Epoch: 26 cost time: 2.6866002082824707
Epoch: 26, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.452 Vali Acc: 0.916 Test Loss: 0.452 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.633894920349121
Epoch: 27, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.404 Vali Acc: 0.930 Test Loss: 0.404 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 28 cost time: 2.630622625350952
Epoch: 28, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.374 Vali Acc: 0.927 Test Loss: 0.374 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.584334373474121
Epoch: 29, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.356 Vali Acc: 0.927 Test Loss: 0.356 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.585361957550049
Epoch: 30, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.335 Vali Acc: 0.927 Test Loss: 0.335 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_JapaneseVowels_TimesNet_UEA_ftM_sl29_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9297297297297298
model parameter : 45633
model size : 0.34MB
