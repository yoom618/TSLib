Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 411.76822686195374
Epoch: 1, Steps: 89 | Train Loss: 0.954 Vali Loss: 0.388 Vali Acc: 0.866 Test Loss: 0.388 Test Acc: 0.866
Validation loss decreased (inf --> -0.865595).  Saving model ...
Epoch: 2 cost time: 400.2639796733856
Epoch: 2, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.261 Vali Acc: 0.934 Test Loss: 0.261 Test Acc: 0.934
Validation loss decreased (-0.865595 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 391.4797456264496
Epoch: 3, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.347 Vali Acc: 0.906 Test Loss: 0.347 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 457.7532079219818
Epoch: 4, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 451.2942295074463
Epoch: 5, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.384 Vali Acc: 0.927 Test Loss: 0.384 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 385.0594730377197
Epoch: 6, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.374 Vali Acc: 0.923 Test Loss: 0.374 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 387.95645785331726
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.308 Vali Acc: 0.947 Test Loss: 0.308 Test Acc: 0.947
Validation loss decreased (-0.933841 --> -0.947072).  Saving model ...
Epoch: 8 cost time: 357.8528940677643
Epoch: 8, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.419 Vali Acc: 0.939 Test Loss: 0.419 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 391.4182209968567
Epoch: 9, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.403 Vali Acc: 0.936 Test Loss: 0.403 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 374.32530879974365
Epoch: 10, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.516 Vali Acc: 0.911 Test Loss: 0.516 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 368.246524810791
Epoch: 11, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.371 Vali Acc: 0.940 Test Loss: 0.371 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 347.6224443912506
Epoch: 12, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.430 Vali Acc: 0.946 Test Loss: 0.430 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 333.6191174983978
Epoch: 13, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.510 Vali Acc: 0.939 Test Loss: 0.510 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 380.0354223251343
Epoch: 14, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.711 Vali Acc: 0.923 Test Loss: 0.711 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 370.9963433742523
Epoch: 15, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.697 Vali Acc: 0.939 Test Loss: 0.697 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 352.0443580150604
Epoch: 16, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.614 Vali Acc: 0.908 Test Loss: 0.614 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 351.63560819625854
Epoch: 17, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.622 Vali Acc: 0.917 Test Loss: 0.622 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.947075208913649
model parameter : 75450260
model size : 290.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 120.86792826652527
Epoch: 1, Steps: 89 | Train Loss: 0.928 Vali Loss: 0.278 Vali Acc: 0.909 Test Loss: 0.278 Test Acc: 0.909
Validation loss decreased (inf --> -0.908772).  Saving model ...
Epoch: 2 cost time: 118.04082918167114
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.246 Vali Acc: 0.934 Test Loss: 0.246 Test Acc: 0.934
Validation loss decreased (-0.908772 --> -0.933842).  Saving model ...
Epoch: 3 cost time: 115.51725101470947
Epoch: 3, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.933842 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 131.2875964641571
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 122.04165482521057
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 125.35869932174683
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 127.14427900314331
Epoch: 7, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.558 Vali Acc: 0.912 Test Loss: 0.558 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 121.27534103393555
Epoch: 8, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.443 Vali Acc: 0.919 Test Loss: 0.443 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 145.0991530418396
Epoch: 9, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.504 Vali Acc: 0.923 Test Loss: 0.504 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 160.4730348587036
Epoch: 10, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.312 Vali Acc: 0.946 Test Loss: 0.312 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 164.74124383926392
Epoch: 11, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.613 Vali Acc: 0.919 Test Loss: 0.613 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 163.36889910697937
Epoch: 12, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.646 Vali Acc: 0.924 Test Loss: 0.646 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 168.78302431106567
Epoch: 13, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.665 Vali Acc: 0.925 Test Loss: 0.665 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9484679665738162
model parameter : 22494100
model size : 88.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 316.91311621665955
Epoch: 1, Steps: 89 | Train Loss: 0.968 Vali Loss: 0.502 Vali Acc: 0.846 Test Loss: 0.502 Test Acc: 0.846
Validation loss decreased (inf --> -0.846095).  Saving model ...
Epoch: 2 cost time: 313.40350890159607
Epoch: 2, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.344 Vali Acc: 0.921 Test Loss: 0.344 Test Acc: 0.921
Validation loss decreased (-0.846095 --> -0.921306).  Saving model ...
Epoch: 3 cost time: 308.90839743614197
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 307.21165919303894
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.361 Vali Acc: 0.910 Test Loss: 0.361 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 297.31115317344666
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.431 Vali Acc: 0.914 Test Loss: 0.431 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 283.58377385139465
Epoch: 6, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.308 Vali Acc: 0.939 Test Loss: 0.308 Test Acc: 0.939
Validation loss decreased (-0.921306 --> -0.938716).  Saving model ...
Epoch: 7 cost time: 288.6826400756836
Epoch: 7, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 293.1427881717682
Epoch: 8, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 274.8528814315796
Epoch: 9, Steps: 89 | Train Loss: 0.385 Vali Loss: 2.943 Vali Acc: 0.669 Test Loss: 2.943 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 280.35551404953003
Epoch: 10, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.530 Vali Acc: 0.916 Test Loss: 0.530 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 270.05169105529785
Epoch: 11, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.483 Vali Acc: 0.946 Test Loss: 0.483 Test Acc: 0.946
Validation loss decreased (-0.938716 --> -0.946374).  Saving model ...
Epoch: 12 cost time: 302.1812448501587
Epoch: 12, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.332 Vali Acc: 0.949 Test Loss: 0.332 Test Acc: 0.949
Validation loss decreased (-0.946374 --> -0.949161).  Saving model ...
Epoch: 13 cost time: 299.8481755256653
Epoch: 13, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.634 Vali Acc: 0.935 Test Loss: 0.634 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 283.801148891449
Epoch: 14, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.454 Vali Acc: 0.929 Test Loss: 0.454 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 283.561146736145
Epoch: 15, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.300 Vali Acc: 0.963 Test Loss: 0.300 Test Acc: 0.963
Validation loss decreased (-0.949161 --> -0.963089).  Saving model ...
Epoch: 16 cost time: 289.35472321510315
Epoch: 16, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.476 Vali Acc: 0.932 Test Loss: 0.476 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 284.97871923446655
Epoch: 17, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.499 Vali Acc: 0.940 Test Loss: 0.499 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 297.7685079574585
Epoch: 18, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.517 Vali Acc: 0.936 Test Loss: 0.517 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 280.40490317344666
Epoch: 19, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.507 Vali Acc: 0.939 Test Loss: 0.507 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 298.8123109340668
Epoch: 20, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.562 Vali Acc: 0.931 Test Loss: 0.562 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 274.66811323165894
Epoch: 21, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.448 Vali Acc: 0.955 Test Loss: 0.448 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 289.26378321647644
Epoch: 22, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.348 Vali Acc: 0.954 Test Loss: 0.348 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 267.17950415611267
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.318 Vali Acc: 0.962 Test Loss: 0.318 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 264.11483812332153
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.523 Vali Acc: 0.952 Test Loss: 0.523 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 257.2258267402649
Epoch: 25, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.537 Vali Acc: 0.932 Test Loss: 0.537 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 75450260
model size : 290.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 97.26381087303162
Epoch: 1, Steps: 89 | Train Loss: 0.972 Vali Loss: 0.353 Vali Acc: 0.888 Test Loss: 0.353 Test Acc: 0.888
Validation loss decreased (inf --> -0.887879).  Saving model ...
Epoch: 2 cost time: 96.61387920379639
Epoch: 2, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.887879 --> -0.924789).  Saving model ...
Epoch: 3 cost time: 99.12920093536377
Epoch: 3, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 95.40348219871521
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.924789 --> -0.947769).  Saving model ...
Epoch: 5 cost time: 85.58214926719666
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.485 Vali Acc: 0.884 Test Loss: 0.485 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 99.780446767807
Epoch: 6, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.362 Vali Acc: 0.926 Test Loss: 0.362 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 102.86606860160828
Epoch: 7, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 105.14849543571472
Epoch: 8, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.623 Vali Acc: 0.891 Test Loss: 0.623 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 93.73567795753479
Epoch: 9, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 93.06033444404602
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.467 Vali Acc: 0.929 Test Loss: 0.467 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 111.01973247528076
Epoch: 11, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.488 Vali Acc: 0.943 Test Loss: 0.488 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 114.06589245796204
Epoch: 12, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.692 Vali Acc: 0.921 Test Loss: 0.692 Test Acc: 0.921
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 112.43740558624268
Epoch: 13, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.707 Vali Acc: 0.925 Test Loss: 0.707 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 109.67354321479797
Epoch: 14, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.472 Vali Acc: 0.944 Test Loss: 0.472 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9477715877437326
model parameter : 22494100
model size : 88.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 181.48519921302795
Epoch: 1, Steps: 89 | Train Loss: 1.017 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
Validation loss decreased (inf --> -0.931752).  Saving model ...
Epoch: 2 cost time: 193.55606842041016
Epoch: 2, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 184.53950572013855
Epoch: 3, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.402 Vali Acc: 0.894 Test Loss: 0.402 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 189.78353595733643
Epoch: 4, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.360 Vali Acc: 0.912 Test Loss: 0.360 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 195.15366125106812
Epoch: 5, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 190.26242971420288
Epoch: 6, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
Validation loss decreased (-0.931752 --> -0.948465).  Saving model ...
Epoch: 7 cost time: 195.66002798080444
Epoch: 7, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.526 Vali Acc: 0.889 Test Loss: 0.526 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 199.67181873321533
Epoch: 8, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.374 Vali Acc: 0.921 Test Loss: 0.374 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 191.21347665786743
Epoch: 9, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.224 Vali Acc: 0.952 Test Loss: 0.224 Test Acc: 0.952
Validation loss decreased (-0.948465 --> -0.951948).  Saving model ...
Epoch: 10 cost time: 205.24963116645813
Epoch: 10, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.516 Vali Acc: 0.902 Test Loss: 0.516 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 190.0944378376007
Epoch: 11, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.921 Vali Acc: 0.856 Test Loss: 0.921 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 199.1121346950531
Epoch: 12, Steps: 89 | Train Loss: 0.361 Vali Loss: 3.481 Vali Acc: 0.811 Test Loss: 3.481 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 183.21059465408325
Epoch: 13, Steps: 89 | Train Loss: 0.504 Vali Loss: 0.325 Vali Acc: 0.945 Test Loss: 0.325 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 204.9066879749298
Epoch: 14, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
Validation loss decreased (-0.951948 --> -0.952644).  Saving model ...
Epoch: 15 cost time: 184.56178641319275
Epoch: 15, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
Validation loss decreased (-0.952644 --> -0.963786).  Saving model ...
Epoch: 16 cost time: 192.4697265625
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.428 Vali Acc: 0.932 Test Loss: 0.428 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 188.74371314048767
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
Validation loss decreased (-0.963786 --> -0.970750).  Saving model ...
Epoch: 18 cost time: 172.34789967536926
Epoch: 18, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.476 Vali Acc: 0.941 Test Loss: 0.476 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 171.26984238624573
Epoch: 19, Steps: 89 | Train Loss: 0.089 Vali Loss: 1.367 Vali Acc: 0.866 Test Loss: 1.367 Test Acc: 0.866
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 188.76026129722595
Epoch: 20, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.333 Vali Acc: 0.948 Test Loss: 0.333 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 189.83643627166748
Epoch: 21, Steps: 89 | Train Loss: 0.176 Vali Loss: 1.196 Vali Acc: 0.832 Test Loss: 1.196 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 189.19232606887817
Epoch: 22, Steps: 89 | Train Loss: 0.490 Vali Loss: 1.403 Vali Acc: 0.852 Test Loss: 1.403 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 167.54029726982117
Epoch: 23, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.396 Vali Acc: 0.935 Test Loss: 0.396 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 169.34856534004211
Epoch: 24, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 165.67238926887512
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 1.344 Vali Acc: 0.866 Test Loss: 1.344 Test Acc: 0.866
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 146.2720649242401
Epoch: 26, Steps: 89 | Train Loss: 0.195 Vali Loss: 1.126 Vali Acc: 0.847 Test Loss: 1.126 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 136.9300537109375
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.994 Vali Acc: 0.890 Test Loss: 0.994 Test Acc: 0.890
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 75450260
model size : 290.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 66.37141919136047
Epoch: 1, Steps: 89 | Train Loss: 1.042 Vali Loss: 0.313 Vali Acc: 0.904 Test Loss: 0.313 Test Acc: 0.904
Validation loss decreased (inf --> -0.903897).  Saving model ...
Epoch: 2 cost time: 64.06033730506897
Epoch: 2, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.308 Vali Acc: 0.904 Test Loss: 0.308 Test Acc: 0.904
Validation loss decreased (-0.903897 --> -0.903897).  Saving model ...
Epoch: 3 cost time: 64.9967155456543
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.413 Vali Acc: 0.907 Test Loss: 0.413 Test Acc: 0.907
Validation loss decreased (-0.903897 --> -0.907377).  Saving model ...
Epoch: 4 cost time: 68.92506384849548
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 68.23988556861877
Epoch: 5, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.412 Vali Acc: 0.902 Test Loss: 0.412 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 62.56801962852478
Epoch: 6, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.348 Vali Acc: 0.926 Test Loss: 0.348 Test Acc: 0.926
Validation loss decreased (-0.907377 --> -0.926180).  Saving model ...
Epoch: 7 cost time: 63.19746279716492
Epoch: 7, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.540 Vali Acc: 0.903 Test Loss: 0.540 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 62.58512806892395
Epoch: 8, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.870 Vali Acc: 0.848 Test Loss: 0.870 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 58.75105357170105
Epoch: 9, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.529 Vali Acc: 0.918 Test Loss: 0.529 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 62.78241944313049
Epoch: 10, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.371 Vali Acc: 0.926 Test Loss: 0.371 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 60.8968026638031
Epoch: 11, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.692 Vali Acc: 0.881 Test Loss: 0.692 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 58.55296778678894
Epoch: 12, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.605 Vali Acc: 0.913 Test Loss: 0.605 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 61.654513120651245
Epoch: 13, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.851 Vali Acc: 0.868 Test Loss: 0.851 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 57.418529748916626
Epoch: 14, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.451 Vali Acc: 0.931 Test Loss: 0.451 Test Acc: 0.931
Validation loss decreased (-0.926180 --> -0.931054).  Saving model ...
Epoch: 15 cost time: 60.8499174118042
Epoch: 15, Steps: 89 | Train Loss: 0.287 Vali Loss: 1.488 Vali Acc: 0.825 Test Loss: 1.488 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 60.645514249801636
Epoch: 16, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.371 Vali Acc: 0.942 Test Loss: 0.371 Test Acc: 0.942
Validation loss decreased (-0.931054 --> -0.941500).  Saving model ...
Epoch: 17 cost time: 64.73487305641174
Epoch: 17, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.570 Vali Acc: 0.936 Test Loss: 0.570 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 61.48398542404175
Epoch: 18, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.490 Vali Acc: 0.938 Test Loss: 0.490 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 58.59507489204407
Epoch: 19, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.006 Vali Acc: 0.884 Test Loss: 1.006 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 59.611692667007446
Epoch: 20, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.660 Vali Acc: 0.916 Test Loss: 0.660 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 57.25484776496887
Epoch: 21, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.442 Vali Acc: 0.949 Test Loss: 0.442 Test Acc: 0.949
Validation loss decreased (-0.941500 --> -0.949160).  Saving model ...
Epoch: 22 cost time: 58.5665385723114
Epoch: 22, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.929 Vali Acc: 0.905 Test Loss: 0.929 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 60.777358293533325
Epoch: 23, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.526 Vali Acc: 0.946 Test Loss: 0.526 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 60.351059675216675
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.581 Vali Acc: 0.931 Test Loss: 0.581 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 55.902557373046875
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.650 Vali Acc: 0.925 Test Loss: 0.650 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 59.195292472839355
Epoch: 26, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.649 Vali Acc: 0.949 Test Loss: 0.649 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 59.83340287208557
Epoch: 27, Steps: 89 | Train Loss: 0.221 Vali Loss: 1.174 Vali Acc: 0.854 Test Loss: 1.174 Test Acc: 0.854
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 55.14090633392334
Epoch: 28, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.646 Vali Acc: 0.931 Test Loss: 0.646 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 57.06557846069336
Epoch: 29, Steps: 89 | Train Loss: 0.203 Vali Loss: 1.341 Vali Acc: 0.874 Test Loss: 1.341 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 59.53472089767456
Epoch: 30, Steps: 89 | Train Loss: 0.388 Vali Loss: 1.060 Vali Acc: 0.894 Test Loss: 1.060 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9491643454038997
model parameter : 22494100
model size : 88.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 220.87585425376892
Epoch: 1, Steps: 89 | Train Loss: 0.943 Vali Loss: 0.299 Vali Acc: 0.912 Test Loss: 0.299 Test Acc: 0.912
Validation loss decreased (inf --> -0.911557).  Saving model ...
Epoch: 2 cost time: 219.06611466407776
Epoch: 2, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.187 Vali Acc: 0.945 Test Loss: 0.187 Test Acc: 0.945
Validation loss decreased (-0.911557 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 224.69743871688843
Epoch: 3, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 236.55761647224426
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.446 Vali Acc: 0.921 Test Loss: 0.446 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 236.2177300453186
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.390 Vali Acc: 0.915 Test Loss: 0.390 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 240.70445084571838
Epoch: 6, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.477 Vali Acc: 0.906 Test Loss: 0.477 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 249.79359316825867
Epoch: 7, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.838 Vali Acc: 0.900 Test Loss: 0.838 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 240.91189908981323
Epoch: 8, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.316 Vali Acc: 0.955 Test Loss: 0.316 Test Acc: 0.955
Validation loss decreased (-0.944984 --> -0.954732).  Saving model ...
Epoch: 9 cost time: 230.0954625606537
Epoch: 9, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 227.5987024307251
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.553 Vali Acc: 0.895 Test Loss: 0.553 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 220.45578455924988
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.430 Vali Acc: 0.952 Test Loss: 0.430 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 227.0603256225586
Epoch: 12, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.457 Vali Acc: 0.937 Test Loss: 0.457 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 217.8992190361023
Epoch: 13, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.544 Vali Acc: 0.930 Test Loss: 0.544 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 219.11593437194824
Epoch: 14, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.528 Vali Acc: 0.926 Test Loss: 0.528 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 221.56280755996704
Epoch: 15, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.357 Vali Acc: 0.964 Test Loss: 0.357 Test Acc: 0.964
Validation loss decreased (-0.954732 --> -0.964481).  Saving model ...
Epoch: 16 cost time: 220.95986461639404
Epoch: 16, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 205.45143008232117
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.560 Vali Acc: 0.937 Test Loss: 0.560 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 206.5720329284668
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.414 Vali Acc: 0.954 Test Loss: 0.414 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 213.80157256126404
Epoch: 19, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.453 Vali Acc: 0.955 Test Loss: 0.453 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 232.30770254135132
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.309 Vali Acc: 0.969 Test Loss: 0.309 Test Acc: 0.969
Validation loss decreased (-0.964481 --> -0.968660).  Saving model ...
Epoch: 21 cost time: 243.75671815872192
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.478 Vali Acc: 0.941 Test Loss: 0.478 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 240.433922290802
Epoch: 22, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.579 Vali Acc: 0.934 Test Loss: 0.579 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 229.44366192817688
Epoch: 23, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.423 Vali Acc: 0.958 Test Loss: 0.423 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 229.249587059021
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.964 Test Loss: 0.348 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 218.25795936584473
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.370 Vali Acc: 0.959 Test Loss: 0.370 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 216.88505601882935
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.971 Test Loss: 0.308 Test Acc: 0.971
Validation loss decreased (-0.968660 --> -0.971445).  Saving model ...
Epoch: 27 cost time: 218.21812224388123
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.972 Test Loss: 0.309 Test Acc: 0.972
Validation loss decreased (-0.971445 --> -0.972142).  Saving model ...
Epoch: 28 cost time: 229.058438539505
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.973 Test Loss: 0.309 Test Acc: 0.973
Validation loss decreased (-0.972142 --> -0.972838).  Saving model ...
Epoch: 29 cost time: 227.9267978668213
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.973 Test Loss: 0.309 Test Acc: 0.973
Validation loss decreased (-0.972838 --> -0.972838).  Saving model ...
Epoch: 30 cost time: 220.7391173839569
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.309 Vali Acc: 0.973 Test Loss: 0.309 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 37960596
model size : 147.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 83.37823367118835
Epoch: 1, Steps: 89 | Train Loss: 0.962 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (inf --> -0.926181).  Saving model ...
Epoch: 2 cost time: 89.33614158630371
Epoch: 2, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.926181 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 85.7683789730072
Epoch: 3, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 84.16945958137512
Epoch: 4, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.601 Vali Acc: 0.903 Test Loss: 0.601 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 82.15272498130798
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.319 Vali Acc: 0.927 Test Loss: 0.319 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 86.30147624015808
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.368 Vali Acc: 0.921 Test Loss: 0.368 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 87.85963916778564
Epoch: 7, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.485 Vali Acc: 0.899 Test Loss: 0.485 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 85.94652724266052
Epoch: 8, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.336 Vali Acc: 0.952 Test Loss: 0.336 Test Acc: 0.952
Validation loss decreased (-0.927574 --> -0.951946).  Saving model ...
Epoch: 9 cost time: 84.08734059333801
Epoch: 9, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.889 Vali Acc: 0.913 Test Loss: 0.889 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 80.15990376472473
Epoch: 10, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.596 Vali Acc: 0.929 Test Loss: 0.596 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 82.65961956977844
Epoch: 11, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.621 Vali Acc: 0.932 Test Loss: 0.621 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 77.99431681632996
Epoch: 12, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.387 Vali Acc: 0.947 Test Loss: 0.387 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 81.64327669143677
Epoch: 13, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.868 Vali Acc: 0.889 Test Loss: 0.868 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 80.45688915252686
Epoch: 14, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.419 Vali Acc: 0.948 Test Loss: 0.419 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 88.64372134208679
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.370 Vali Acc: 0.949 Test Loss: 0.370 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 89.10709619522095
Epoch: 16, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.228 Vali Acc: 0.969 Test Loss: 0.228 Test Acc: 0.969
Validation loss decreased (-0.951946 --> -0.969357).  Saving model ...
Epoch: 17 cost time: 86.42272925376892
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.223 Vali Acc: 0.968 Test Loss: 0.223 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 83.0797336101532
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.964 Test Loss: 0.248 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 83.66633439064026
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.967 Test Loss: 0.264 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 85.96463418006897
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.560 Vali Acc: 0.942 Test Loss: 0.560 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 86.91478610038757
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.585 Vali Acc: 0.923 Test Loss: 0.585 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 88.84251070022583
Epoch: 22, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.600 Vali Acc: 0.937 Test Loss: 0.600 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 84.16684889793396
Epoch: 23, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.294 Vali Acc: 0.967 Test Loss: 0.294 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 80.53812050819397
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.481 Vali Acc: 0.932 Test Loss: 0.481 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 83.36594796180725
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.304 Vali Acc: 0.962 Test Loss: 0.304 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 77.63345098495483
Epoch: 26, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.334 Vali Acc: 0.953 Test Loss: 0.334 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 11482004
model size : 46.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 155.3139684200287
Epoch: 1, Steps: 89 | Train Loss: 0.969 Vali Loss: 0.331 Vali Acc: 0.904 Test Loss: 0.331 Test Acc: 0.904
Validation loss decreased (inf --> -0.903896).  Saving model ...
Epoch: 2 cost time: 152.1862576007843
Epoch: 2, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.274 Vali Acc: 0.903 Test Loss: 0.274 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 158.08749389648438
Epoch: 3, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.298 Vali Acc: 0.916 Test Loss: 0.298 Test Acc: 0.916
Validation loss decreased (-0.903896 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 146.10934591293335
Epoch: 4, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.377 Vali Acc: 0.915 Test Loss: 0.377 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 153.67106103897095
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.632 Vali Acc: 0.870 Test Loss: 0.632 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 162.27704167366028
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.932 Vali Acc: 0.877 Test Loss: 0.932 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 151.74135446548462
Epoch: 7, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.476 Vali Acc: 0.922 Test Loss: 0.476 Test Acc: 0.922
Validation loss decreased (-0.915735 --> -0.922001).  Saving model ...
Epoch: 8 cost time: 150.82199907302856
Epoch: 8, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.418 Vali Acc: 0.930 Test Loss: 0.418 Test Acc: 0.930
Validation loss decreased (-0.922001 --> -0.930358).  Saving model ...
Epoch: 9 cost time: 155.36899709701538
Epoch: 9, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.714 Vali Acc: 0.921 Test Loss: 0.714 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 155.88417553901672
Epoch: 10, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.435 Vali Acc: 0.927 Test Loss: 0.435 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 159.49479794502258
Epoch: 11, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.312 Vali Acc: 0.946 Test Loss: 0.312 Test Acc: 0.946
Validation loss decreased (-0.930358 --> -0.946376).  Saving model ...
Epoch: 12 cost time: 151.88777828216553
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.355 Vali Acc: 0.949 Test Loss: 0.355 Test Acc: 0.949
Validation loss decreased (-0.946376 --> -0.949161).  Saving model ...
Epoch: 13 cost time: 156.29485440254211
Epoch: 13, Steps: 89 | Train Loss: 0.136 Vali Loss: 1.849 Vali Acc: 0.880 Test Loss: 1.849 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 159.52022075653076
Epoch: 14, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.699 Vali Acc: 0.929 Test Loss: 0.699 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 152.16691827774048
Epoch: 15, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.738 Vali Acc: 0.930 Test Loss: 0.738 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 150.59377884864807
Epoch: 16, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.649 Vali Acc: 0.917 Test Loss: 0.649 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 152.64616465568542
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.439 Vali Acc: 0.940 Test Loss: 0.439 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 177.56062531471252
Epoch: 18, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.496 Vali Acc: 0.942 Test Loss: 0.496 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 175.4929714202881
Epoch: 19, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.825 Vali Acc: 0.907 Test Loss: 0.825 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 176.2822732925415
Epoch: 20, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.525 Vali Acc: 0.932 Test Loss: 0.525 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 169.52720546722412
Epoch: 21, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949161 --> -0.949857).  Saving model ...
Epoch: 22 cost time: 174.2101275920868
Epoch: 22, Steps: 89 | Train Loss: 0.141 Vali Loss: 1.236 Vali Acc: 0.939 Test Loss: 1.236 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 166.75388264656067
Epoch: 23, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.402 Vali Acc: 0.956 Test Loss: 0.402 Test Acc: 0.956
Validation loss decreased (-0.949857 --> -0.956124).  Saving model ...
Epoch: 24 cost time: 169.73333859443665
Epoch: 24, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.344 Vali Acc: 0.961 Test Loss: 0.344 Test Acc: 0.961
Validation loss decreased (-0.956124 --> -0.960999).  Saving model ...
Epoch: 25 cost time: 164.56248950958252
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.463 Vali Acc: 0.947 Test Loss: 0.463 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 165.83383107185364
Epoch: 26, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.393 Vali Acc: 0.961 Test Loss: 0.393 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 167.7378273010254
Epoch: 27, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.314 Vali Acc: 0.952 Test Loss: 0.314 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 168.58330082893372
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.522 Vali Acc: 0.941 Test Loss: 0.522 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 175.33496975898743
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.453 Vali Acc: 0.947 Test Loss: 0.453 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 166.46300172805786
Epoch: 30, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.368 Vali Acc: 0.960 Test Loss: 0.368 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 37960596
model size : 147.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 63.233933210372925
Epoch: 1, Steps: 89 | Train Loss: 1.002 Vali Loss: 0.291 Vali Acc: 0.912 Test Loss: 0.291 Test Acc: 0.912
Validation loss decreased (inf --> -0.912253).  Saving model ...
Epoch: 2 cost time: 64.46301746368408
Epoch: 2, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.302 Vali Acc: 0.907 Test Loss: 0.302 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 66.01577019691467
Epoch: 3, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.912253 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 66.25762104988098
Epoch: 4, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.920 Test Loss: 0.308 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 68.3964729309082
Epoch: 5, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.314 Vali Acc: 0.939 Test Loss: 0.314 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 70.19054245948792
Epoch: 6, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
Validation loss decreased (-0.943591 --> -0.962393).  Saving model ...
Epoch: 7 cost time: 68.18423247337341
Epoch: 7, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.519 Vali Acc: 0.901 Test Loss: 0.519 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 70.85547375679016
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 69.52850985527039
Epoch: 9, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.381 Vali Acc: 0.943 Test Loss: 0.381 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 61.92894721031189
Epoch: 10, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.307 Vali Acc: 0.955 Test Loss: 0.307 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 64.93171072006226
Epoch: 11, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.341 Vali Acc: 0.948 Test Loss: 0.341 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 61.80162596702576
Epoch: 12, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 65.85094261169434
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.280 Vali Acc: 0.967 Test Loss: 0.280 Test Acc: 0.967
Validation loss decreased (-0.962393 --> -0.967267).  Saving model ...
Epoch: 14 cost time: 68.21531295776367
Epoch: 14, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.326 Vali Acc: 0.961 Test Loss: 0.326 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 66.75899767875671
Epoch: 15, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.480 Vali Acc: 0.949 Test Loss: 0.480 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 68.07442307472229
Epoch: 16, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.460 Vali Acc: 0.942 Test Loss: 0.460 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 64.61788892745972
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.383 Vali Acc: 0.963 Test Loss: 0.383 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 70.98417711257935
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.610 Vali Acc: 0.940 Test Loss: 0.610 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 67.3493480682373
Epoch: 19, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.952 Vali Acc: 0.914 Test Loss: 0.952 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 64.62555885314941
Epoch: 20, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.707 Vali Acc: 0.907 Test Loss: 0.707 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 71.28937363624573
Epoch: 21, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.480 Vali Acc: 0.954 Test Loss: 0.480 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 73.54127025604248
Epoch: 22, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.403 Vali Acc: 0.958 Test Loss: 0.403 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 73.05630111694336
Epoch: 23, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.528 Vali Acc: 0.953 Test Loss: 0.528 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 11482004
model size : 46.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 90.39120054244995
Epoch: 1, Steps: 89 | Train Loss: 1.008 Vali Loss: 0.394 Vali Acc: 0.886 Test Loss: 0.394 Test Acc: 0.886
Validation loss decreased (inf --> -0.886486).  Saving model ...
Epoch: 2 cost time: 78.63398289680481
Epoch: 2, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.349 Vali Acc: 0.898 Test Loss: 0.349 Test Acc: 0.898
Validation loss decreased (-0.886486 --> -0.897629).  Saving model ...
Epoch: 3 cost time: 87.68888974189758
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.312 Vali Acc: 0.923 Test Loss: 0.312 Test Acc: 0.923
Validation loss decreased (-0.897629 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 80.40263366699219
Epoch: 4, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 83.07666611671448
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.273 Vali Acc: 0.945 Test Loss: 0.273 Test Acc: 0.945
Validation loss decreased (-0.922699 --> -0.944983).  Saving model ...
Epoch: 6 cost time: 83.58970808982849
Epoch: 6, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.262 Vali Acc: 0.939 Test Loss: 0.262 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 78.06216549873352
Epoch: 7, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.336 Vali Acc: 0.921 Test Loss: 0.336 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 83.37129259109497
Epoch: 8, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 76.61880540847778
Epoch: 9, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.944983 --> -0.947769).  Saving model ...
Epoch: 10 cost time: 80.6160249710083
Epoch: 10, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.462 Vali Acc: 0.907 Test Loss: 0.462 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 80.05363607406616
Epoch: 11, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.300 Vali Acc: 0.948 Test Loss: 0.300 Test Acc: 0.948
Validation loss decreased (-0.947769 --> -0.948465).  Saving model ...
Epoch: 12 cost time: 81.23176503181458
Epoch: 12, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.474 Vali Acc: 0.930 Test Loss: 0.474 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 86.56735110282898
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.384 Vali Acc: 0.943 Test Loss: 0.384 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 85.565012216568
Epoch: 14, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.249 Vali Acc: 0.962 Test Loss: 0.249 Test Acc: 0.962
Validation loss decreased (-0.948465 --> -0.962393).  Saving model ...
Epoch: 15 cost time: 86.07653093338013
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.424 Vali Acc: 0.941 Test Loss: 0.424 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 85.33200693130493
Epoch: 16, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.467 Vali Acc: 0.941 Test Loss: 0.467 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 82.79021000862122
Epoch: 17, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.455 Vali Acc: 0.944 Test Loss: 0.455 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 83.65853762626648
Epoch: 18, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.340 Vali Acc: 0.957 Test Loss: 0.340 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 80.92839908599854
Epoch: 19, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.405 Vali Acc: 0.948 Test Loss: 0.405 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 84.14708805084229
Epoch: 20, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.870 Vali Acc: 0.923 Test Loss: 0.870 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 87.50709414482117
Epoch: 21, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.638 Vali Acc: 0.923 Test Loss: 0.638 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 95.8125548362732
Epoch: 22, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.845 Vali Acc: 0.937 Test Loss: 0.845 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 90.8660478591919
Epoch: 23, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.344 Vali Acc: 0.841 Test Loss: 1.344 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 88.0389039516449
Epoch: 24, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.337 Vali Acc: 0.962 Test Loss: 0.337 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 37960596
model size : 147.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 45.538841247558594
Epoch: 1, Steps: 89 | Train Loss: 1.050 Vali Loss: 0.239 Vali Acc: 0.927 Test Loss: 0.239 Test Acc: 0.927
Validation loss decreased (inf --> -0.926878).  Saving model ...
Epoch: 2 cost time: 43.330658197402954
Epoch: 2, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
Validation loss decreased (-0.926878 --> -0.942199).  Saving model ...
Epoch: 3 cost time: 41.87570095062256
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.471 Vali Acc: 0.898 Test Loss: 0.471 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 40.94631004333496
Epoch: 4, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.380 Vali Acc: 0.895 Test Loss: 0.380 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 43.98180890083313
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.312 Vali Acc: 0.924 Test Loss: 0.312 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 42.86730623245239
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.311 Vali Acc: 0.939 Test Loss: 0.311 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 41.752896547317505
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.419 Vali Acc: 0.920 Test Loss: 0.419 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 41.49872088432312
Epoch: 8, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.284 Vali Acc: 0.945 Test Loss: 0.284 Test Acc: 0.945
Validation loss decreased (-0.942199 --> -0.944983).  Saving model ...
Epoch: 9 cost time: 39.9057822227478
Epoch: 9, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 42.54698300361633
Epoch: 10, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 41.16253876686096
Epoch: 11, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.623 Vali Acc: 0.900 Test Loss: 0.623 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 37.955875873565674
Epoch: 12, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.359 Vali Acc: 0.953 Test Loss: 0.359 Test Acc: 0.953
Validation loss decreased (-0.944983 --> -0.952643).  Saving model ...
Epoch: 13 cost time: 37.90802478790283
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.244 Vali Acc: 0.964 Test Loss: 0.244 Test Acc: 0.964
Validation loss decreased (-0.952643 --> -0.964482).  Saving model ...
Epoch: 14 cost time: 38.85297870635986
Epoch: 14, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.299 Vali Acc: 0.952 Test Loss: 0.299 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 36.4232964515686
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.514 Vali Acc: 0.930 Test Loss: 0.514 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 35.90709352493286
Epoch: 16, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.370 Vali Acc: 0.946 Test Loss: 0.370 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 39.704838275909424
Epoch: 17, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.298 Vali Acc: 0.951 Test Loss: 0.298 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 41.415138244628906
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.498 Vali Acc: 0.934 Test Loss: 0.498 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 38.34884190559387
Epoch: 19, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.514 Vali Acc: 0.939 Test Loss: 0.514 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 40.00902462005615
Epoch: 20, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.328 Vali Acc: 0.952 Test Loss: 0.328 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 40.58314085006714
Epoch: 21, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.407 Vali Acc: 0.949 Test Loss: 0.407 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 41.086042404174805
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.366 Vali Acc: 0.954 Test Loss: 0.366 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 40.89745259284973
Epoch: 23, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.476 Vali Acc: 0.928 Test Loss: 0.476 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 11482004
model size : 46.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 267.6272876262665
Epoch: 1, Steps: 89 | Train Loss: 1.159 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
Validation loss decreased (inf --> -0.891362).  Saving model ...
Epoch: 2 cost time: 256.45050144195557
Epoch: 2, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.244 Vali Acc: 0.923 Test Loss: 0.244 Test Acc: 0.923
Validation loss decreased (-0.891362 --> -0.923396).  Saving model ...
Epoch: 3 cost time: 268.1530706882477
Epoch: 3, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.923396 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 270.2150282859802
Epoch: 4, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 275.0425956249237
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.255 Vali Acc: 0.939 Test Loss: 0.255 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 274.54118251800537
Epoch: 6, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.242 Vali Acc: 0.940 Test Loss: 0.242 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 261.6423466205597
Epoch: 7, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 255.54479265213013
Epoch: 8, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.388 Vali Acc: 0.912 Test Loss: 0.388 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 260.0654790401459
Epoch: 9, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 255.8329153060913
Epoch: 10, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.730 Vali Acc: 0.854 Test Loss: 0.730 Test Acc: 0.854
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 260.89255714416504
Epoch: 11, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.594 Vali Acc: 0.891 Test Loss: 0.594 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 264.5853650569916
Epoch: 12, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 245.9513635635376
Epoch: 13, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.443 Vali Acc: 0.921 Test Loss: 0.443 Test Acc: 0.921
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 37728212
model size : 145.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 110.36888813972473
Epoch: 1, Steps: 89 | Train Loss: 1.163 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
Validation loss decreased (inf --> -0.927574).  Saving model ...
Epoch: 2 cost time: 109.53506278991699
Epoch: 2, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.927574 --> -0.949859).  Saving model ...
Epoch: 3 cost time: 102.28388619422913
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 98.28360652923584
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.949859 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 105.61238932609558
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.191 Vali Acc: 0.940 Test Loss: 0.191 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 105.30608916282654
Epoch: 6, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.316 Vali Acc: 0.915 Test Loss: 0.316 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 107.7246470451355
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.380 Vali Acc: 0.913 Test Loss: 0.380 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 106.94248223304749
Epoch: 8, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.367 Vali Acc: 0.911 Test Loss: 0.367 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 99.87681818008423
Epoch: 9, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.432 Vali Acc: 0.933 Test Loss: 0.432 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 103.50351214408875
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 101.6565170288086
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.235 Vali Acc: 0.955 Test Loss: 0.235 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.955429).  Saving model ...
Epoch: 12 cost time: 101.67889070510864
Epoch: 12, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 98.65810370445251
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.188 Vali Acc: 0.964 Test Loss: 0.188 Test Acc: 0.964
Validation loss decreased (-0.955429 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 96.45736455917358
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.287 Vali Acc: 0.943 Test Loss: 0.287 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 104.22686624526978
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 110.85600543022156
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 109.12660646438599
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 108.12662410736084
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.267 Vali Acc: 0.953 Test Loss: 0.267 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 99.00214624404907
Epoch: 19, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.527 Vali Acc: 0.911 Test Loss: 0.527 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 92.21805953979492
Epoch: 20, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 93.31119346618652
Epoch: 21, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.517 Vali Acc: 0.909 Test Loss: 0.517 Test Acc: 0.909
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 96.4558494091034
Epoch: 22, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.526 Vali Acc: 0.916 Test Loss: 0.526 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 101.45549082756042
Epoch: 23, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.505 Vali Acc: 0.940 Test Loss: 0.505 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 11249108
model size : 44.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 176.7103476524353
Epoch: 1, Steps: 89 | Train Loss: 1.218 Vali Loss: 0.350 Vali Acc: 0.896 Test Loss: 0.350 Test Acc: 0.896
Validation loss decreased (inf --> -0.896236).  Saving model ...
Epoch: 2 cost time: 163.09264850616455
Epoch: 2, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.313 Vali Acc: 0.893 Test Loss: 0.313 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 164.7081561088562
Epoch: 3, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.183 Vali Acc: 0.942 Test Loss: 0.183 Test Acc: 0.942
Validation loss decreased (-0.896236 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 163.98691296577454
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.209 Vali Acc: 0.939 Test Loss: 0.209 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 164.3038945198059
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
Validation loss decreased (-0.941502 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 169.82578492164612
Epoch: 6, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 167.36116695404053
Epoch: 7, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.942895 --> -0.943591).  Saving model ...
Epoch: 8 cost time: 156.69531345367432
Epoch: 8, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.850 Vali Acc: 0.840 Test Loss: 0.850 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 169.08539581298828
Epoch: 9, Steps: 89 | Train Loss: 0.378 Vali Loss: 1.382 Vali Acc: 0.784 Test Loss: 1.382 Test Acc: 0.784
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 162.560729265213
Epoch: 10, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.316 Vali Acc: 0.939 Test Loss: 0.316 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 184.8546543121338
Epoch: 11, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.526 Vali Acc: 0.884 Test Loss: 0.526 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 178.42543125152588
Epoch: 12, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.380 Vali Acc: 0.921 Test Loss: 0.380 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 172.30136251449585
Epoch: 13, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.359 Vali Acc: 0.921 Test Loss: 0.359 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 172.92117714881897
Epoch: 14, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.444 Vali Acc: 0.908 Test Loss: 0.444 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 169.9850549697876
Epoch: 15, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 179.09025049209595
Epoch: 16, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.370 Vali Acc: 0.928 Test Loss: 0.370 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 174.91870379447937
Epoch: 17, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.238 Vali Acc: 0.955 Test Loss: 0.238 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.954733).  Saving model ...
Epoch: 18 cost time: 179.8208303451538
Epoch: 18, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.411 Vali Acc: 0.937 Test Loss: 0.411 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 169.70662426948547
Epoch: 19, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 166.4726481437683
Epoch: 20, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.326 Vali Acc: 0.943 Test Loss: 0.326 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 176.39168620109558
Epoch: 21, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.343 Vali Acc: 0.938 Test Loss: 0.343 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 167.0828402042389
Epoch: 22, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.502 Vali Acc: 0.923 Test Loss: 0.502 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 163.60572981834412
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.483 Vali Acc: 0.928 Test Loss: 0.483 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 151.88851690292358
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.400 Vali Acc: 0.946 Test Loss: 0.400 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 160.96305203437805
Epoch: 25, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.521 Vali Acc: 0.911 Test Loss: 0.521 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 158.9287827014923
Epoch: 26, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.437 Vali Acc: 0.934 Test Loss: 0.437 Test Acc: 0.934
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 152.7329924106598
Epoch: 27, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.363 Vali Acc: 0.947 Test Loss: 0.363 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9547353760445683
model parameter : 37728212
model size : 145.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 61.46585512161255
Epoch: 1, Steps: 89 | Train Loss: 1.216 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (inf --> -0.922003).  Saving model ...
Epoch: 2 cost time: 50.12002778053284
Epoch: 2, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.248 Vali Acc: 0.917 Test Loss: 0.248 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 61.88657212257385
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 60.99130702018738
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
Validation loss decreased (-0.922003 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 62.703357458114624
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.215 Vali Acc: 0.945 Test Loss: 0.215 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 62.95701479911804
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 60.303295373916626
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.946377 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 65.58059215545654
Epoch: 8, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 55.81489706039429
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 56.47196936607361
Epoch: 10, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.349 Vali Acc: 0.924 Test Loss: 0.349 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 61.03792595863342
Epoch: 11, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.512 Vali Acc: 0.903 Test Loss: 0.512 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 52.88689184188843
Epoch: 12, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 71.69718170166016
Epoch: 13, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.359 Vali Acc: 0.946 Test Loss: 0.359 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 67.28491687774658
Epoch: 14, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.279 Vali Acc: 0.954 Test Loss: 0.279 Test Acc: 0.954
Validation loss decreased (-0.950555 --> -0.954036).  Saving model ...
Epoch: 15 cost time: 65.77847123146057
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.356 Vali Acc: 0.938 Test Loss: 0.356 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 66.39948749542236
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 71.82720804214478
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 63.259188652038574
Epoch: 18, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.645 Vali Acc: 0.934 Test Loss: 0.645 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 73.82967352867126
Epoch: 19, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 66.07618594169617
Epoch: 20, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.719 Vali Acc: 0.914 Test Loss: 0.719 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 72.66805720329285
Epoch: 21, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.392 Vali Acc: 0.934 Test Loss: 0.392 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 72.31783270835876
Epoch: 22, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.292 Vali Acc: 0.955 Test Loss: 0.292 Test Acc: 0.955
Validation loss decreased (-0.954036 --> -0.955429).  Saving model ...
Epoch: 23 cost time: 71.57618546485901
Epoch: 23, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.727 Vali Acc: 0.938 Test Loss: 0.727 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 67.75896573066711
Epoch: 24, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.365 Vali Acc: 0.955 Test Loss: 0.365 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 67.86858606338501
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.314 Vali Acc: 0.962 Test Loss: 0.314 Test Acc: 0.962
Validation loss decreased (-0.955429 --> -0.961696).  Saving model ...
Epoch: 26 cost time: 65.96265578269958
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.371 Vali Acc: 0.959 Test Loss: 0.371 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 73.92806005477905
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.366 Vali Acc: 0.955 Test Loss: 0.366 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 65.26866745948792
Epoch: 28, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.421 Vali Acc: 0.949 Test Loss: 0.421 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 69.40193438529968
Epoch: 29, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.500 Vali Acc: 0.939 Test Loss: 0.500 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 67.5380859375
Epoch: 30, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.497 Vali Acc: 0.948 Test Loss: 0.497 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 11249108
model size : 44.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 99.45221471786499
Epoch: 1, Steps: 89 | Train Loss: 1.291 Vali Loss: 0.457 Vali Acc: 0.857 Test Loss: 0.457 Test Acc: 0.857
Validation loss decreased (inf --> -0.856541).  Saving model ...
Epoch: 2 cost time: 88.52694320678711
Epoch: 2, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.856541 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 83.20570635795593
Epoch: 3, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.333 Vali Acc: 0.890 Test Loss: 0.333 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 94.50402784347534
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.261 Vali Acc: 0.921 Test Loss: 0.261 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 91.61913275718689
Epoch: 5, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 96.46918606758118
Epoch: 6, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.858 Vali Acc: 0.817 Test Loss: 0.858 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 90.43217277526855
Epoch: 7, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 96.91259980201721
Epoch: 8, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.619 Vali Acc: 0.852 Test Loss: 0.619 Test Acc: 0.852
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 93.45685315132141
Epoch: 9, Steps: 89 | Train Loss: 0.223 Vali Loss: 1.114 Vali Acc: 0.782 Test Loss: 1.114 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 87.45002317428589
Epoch: 10, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.515 Vali Acc: 0.879 Test Loss: 0.515 Test Acc: 0.879
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 102.92358994483948
Epoch: 11, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 101.03430438041687
Epoch: 12, Steps: 89 | Train Loss: 0.234 Vali Loss: 1.443 Vali Acc: 0.833 Test Loss: 1.443 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 37728212
model size : 145.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 42.0197114944458
Epoch: 1, Steps: 89 | Train Loss: 1.266 Vali Loss: 0.355 Vali Acc: 0.905 Test Loss: 0.355 Test Acc: 0.905
Validation loss decreased (inf --> -0.904593).  Saving model ...
Epoch: 2 cost time: 38.58180904388428
Epoch: 2, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.235 Vali Acc: 0.934 Test Loss: 0.235 Test Acc: 0.934
Validation loss decreased (-0.904593 --> -0.933842).  Saving model ...
Epoch: 3 cost time: 43.644899129867554
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
Validation loss decreased (-0.933842 --> -0.952645).  Saving model ...
Epoch: 4 cost time: 40.981382608413696
Epoch: 4, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.336 Vali Acc: 0.909 Test Loss: 0.336 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.10349082946777
Epoch: 5, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 35.967920780181885
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 38.315075159072876
Epoch: 7, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 36.52959418296814
Epoch: 8, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.417 Vali Acc: 0.905 Test Loss: 0.417 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 40.435811281204224
Epoch: 9, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 38.564512491226196
Epoch: 10, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.258 Vali Acc: 0.939 Test Loss: 0.258 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 40.85703492164612
Epoch: 11, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.529 Vali Acc: 0.886 Test Loss: 0.529 Test Acc: 0.886
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 39.38727283477783
Epoch: 12, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.367 Vali Acc: 0.920 Test Loss: 0.367 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 38.982177734375
Epoch: 13, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.478 Vali Acc: 0.914 Test Loss: 0.478 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9526462395543176
model parameter : 11249108
model size : 44.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 149.35997867584229
Epoch: 1, Steps: 89 | Train Loss: 1.169 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
Validation loss decreased (inf --> -0.915039).  Saving model ...
Epoch: 2 cost time: 150.68355917930603
Epoch: 2, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
Validation loss decreased (-0.915039 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 164.3806939125061
Epoch: 3, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.178 Vali Acc: 0.945 Test Loss: 0.178 Test Acc: 0.945
Validation loss decreased (-0.927574 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 162.4660894870758
Epoch: 4, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.175 Vali Acc: 0.942 Test Loss: 0.175 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 159.44627857208252
Epoch: 5, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 142.77715229988098
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
Validation loss decreased (-0.944984 --> -0.951252).  Saving model ...
Epoch: 7 cost time: 144.8839979171753
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.951252 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 137.6810073852539
Epoch: 8, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 148.9162631034851
Epoch: 9, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.541 Vali Acc: 0.896 Test Loss: 0.541 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 130.40431213378906
Epoch: 10, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.512 Vali Acc: 0.914 Test Loss: 0.512 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 144.29301023483276
Epoch: 11, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 140.50186395645142
Epoch: 12, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 142.1094045639038
Epoch: 13, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.336 Vali Acc: 0.939 Test Loss: 0.336 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 144.2279336452484
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.307 Vali Acc: 0.946 Test Loss: 0.307 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 132.84425377845764
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.264 Vali Acc: 0.957 Test Loss: 0.264 Test Acc: 0.957
Validation loss decreased (-0.953341 --> -0.956822).  Saving model ...
Epoch: 16 cost time: 131.916006565094
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.301 Vali Acc: 0.958 Test Loss: 0.301 Test Acc: 0.958
Validation loss decreased (-0.956822 --> -0.957518).  Saving model ...
Epoch: 17 cost time: 147.1607871055603
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.329 Vali Acc: 0.954 Test Loss: 0.329 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 150.2449107170105
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.326 Vali Acc: 0.951 Test Loss: 0.326 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 182.02013993263245
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.509 Vali Acc: 0.935 Test Loss: 0.509 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 182.16902804374695
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.778 Vali Acc: 0.909 Test Loss: 0.778 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 172.3606414794922
Epoch: 21, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.423 Vali Acc: 0.940 Test Loss: 0.423 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 171.66997075080872
Epoch: 22, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.400 Vali Acc: 0.942 Test Loss: 0.400 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 176.52802872657776
Epoch: 23, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.397 Vali Acc: 0.946 Test Loss: 0.397 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 165.93192172050476
Epoch: 24, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.474 Vali Acc: 0.946 Test Loss: 0.474 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 170.16614890098572
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.358 Vali Acc: 0.955 Test Loss: 0.358 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 172.00073981285095
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.495 Vali Acc: 0.944 Test Loss: 0.495 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 18981844
model size : 73.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 84.27964663505554
Epoch: 1, Steps: 89 | Train Loss: 1.221 Vali Loss: 0.300 Vali Acc: 0.908 Test Loss: 0.300 Test Acc: 0.908
Validation loss decreased (inf --> -0.908075).  Saving model ...
Epoch: 2 cost time: 79.83734798431396
Epoch: 2, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.229 Vali Acc: 0.923 Test Loss: 0.229 Test Acc: 0.923
Validation loss decreased (-0.908075 --> -0.923396).  Saving model ...
Epoch: 3 cost time: 76.33372688293457
Epoch: 3, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.923396 --> -0.949163).  Saving model ...
Epoch: 4 cost time: 84.95336413383484
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
Validation loss decreased (-0.949163 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 78.41588807106018
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.218 Vali Acc: 0.940 Test Loss: 0.218 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 81.01076340675354
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.953341 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 79.13314700126648
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.213 Vali Acc: 0.939 Test Loss: 0.213 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 77.52398371696472
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 72.66229963302612
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 75.55801510810852
Epoch: 10, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 64.21072101593018
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 77.04376244544983
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.304 Vali Acc: 0.958 Test Loss: 0.304 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 75.18329691886902
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.273 Vali Acc: 0.946 Test Loss: 0.273 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 80.20090937614441
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 76.94074869155884
Epoch: 15, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.346 Vali Acc: 0.945 Test Loss: 0.346 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 68.22549390792847
Epoch: 16, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.517 Vali Acc: 0.913 Test Loss: 0.517 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 5742036
model size : 23.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 125.2262773513794
Epoch: 1, Steps: 89 | Train Loss: 1.207 Vali Loss: 0.315 Vali Acc: 0.897 Test Loss: 0.315 Test Acc: 0.897
Validation loss decreased (inf --> -0.896933).  Saving model ...
Epoch: 2 cost time: 121.78279447555542
Epoch: 2, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
Validation loss decreased (-0.896933 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 118.81369972229004
Epoch: 3, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.179 Vali Acc: 0.935 Test Loss: 0.179 Test Acc: 0.935
Validation loss decreased (-0.930360 --> -0.934539).  Saving model ...
Epoch: 4 cost time: 122.1666476726532
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 111.03168749809265
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.233 Vali Acc: 0.942 Test Loss: 0.233 Test Acc: 0.942
Validation loss decreased (-0.934539 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 99.1216287612915
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 108.95506119728088
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
Validation loss decreased (-0.941502 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 98.33995389938354
Epoch: 8, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.306 Vali Acc: 0.931 Test Loss: 0.306 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 117.31348967552185
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.287 Vali Acc: 0.938 Test Loss: 0.287 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 118.14228916168213
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.289 Vali Acc: 0.945 Test Loss: 0.289 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 115.08437204360962
Epoch: 11, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.272 Vali Acc: 0.948 Test Loss: 0.272 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 101.60673236846924
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 122.20426654815674
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.509 Vali Acc: 0.924 Test Loss: 0.509 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 104.59146189689636
Epoch: 14, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 124.0859797000885
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.310 Vali Acc: 0.953 Test Loss: 0.310 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.952643).  Saving model ...
Epoch: 16 cost time: 109.6383159160614
Epoch: 16, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.952643 --> -0.970054).  Saving model ...
Epoch: 17 cost time: 109.97775387763977
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.953 Test Loss: 0.265 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 105.80654907226562
Epoch: 18, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.923 Vali Acc: 0.904 Test Loss: 0.923 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 117.87662720680237
Epoch: 19, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.290 Vali Acc: 0.951 Test Loss: 0.290 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 109.41454982757568
Epoch: 20, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 114.13170862197876
Epoch: 21, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.299 Vali Acc: 0.953 Test Loss: 0.299 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 111.96570038795471
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 107.91371822357178
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.267 Vali Acc: 0.962 Test Loss: 0.267 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 109.02999711036682
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.264 Vali Acc: 0.962 Test Loss: 0.264 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 96.20405435562134
Epoch: 25, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 110.68933153152466
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.280 Vali Acc: 0.957 Test Loss: 0.280 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 18981844
model size : 73.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 52.13415193557739
Epoch: 1, Steps: 89 | Train Loss: 1.266 Vali Loss: 0.298 Vali Acc: 0.920 Test Loss: 0.298 Test Acc: 0.920
Validation loss decreased (inf --> -0.919913).  Saving model ...
Epoch: 2 cost time: 43.870312213897705
Epoch: 2, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.919913 --> -0.945681).  Saving model ...
Epoch: 3 cost time: 51.990379333496094
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.174 Vali Acc: 0.942 Test Loss: 0.174 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 43.34887433052063
Epoch: 4, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.945681 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 45.30057668685913
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.215 Vali Acc: 0.945 Test Loss: 0.215 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 43.31307244300842
Epoch: 6, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
Validation loss decreased (-0.961698 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 44.708808183670044
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.317 Vali Acc: 0.913 Test Loss: 0.317 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 46.5591344833374
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 46.5798659324646
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 46.23103141784668
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 44.32890558242798
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.327 Vali Acc: 0.929 Test Loss: 0.327 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 44.882752656936646
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 44.515201568603516
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.220 Vali Acc: 0.965 Test Loss: 0.220 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 40.63700485229492
Epoch: 14, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 45.26850652694702
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 42.1400089263916
Epoch: 16, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.330 Vali Acc: 0.944 Test Loss: 0.330 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 5742036
model size : 23.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 60.30465579032898
Epoch: 1, Steps: 89 | Train Loss: 1.243 Vali Loss: 0.347 Vali Acc: 0.892 Test Loss: 0.347 Test Acc: 0.892
Validation loss decreased (inf --> -0.892058).  Saving model ...
Epoch: 2 cost time: 54.688944816589355
Epoch: 2, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.245 Vali Acc: 0.918 Test Loss: 0.245 Test Acc: 0.918
Validation loss decreased (-0.892058 --> -0.917825).  Saving model ...
Epoch: 3 cost time: 53.89258813858032
Epoch: 3, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.174 Vali Acc: 0.947 Test Loss: 0.174 Test Acc: 0.947
Validation loss decreased (-0.917825 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 55.01979470252991
Epoch: 4, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 56.074177980422974
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.276 Vali Acc: 0.906 Test Loss: 0.276 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 55.93411827087402
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.202 Vali Acc: 0.939 Test Loss: 0.202 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 58.05223560333252
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.233 Vali Acc: 0.940 Test Loss: 0.233 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 57.1828453540802
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.947073 --> -0.949859).  Saving model ...
Epoch: 9 cost time: 56.07005333900452
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.953341).  Saving model ...
Epoch: 10 cost time: 48.17942452430725
Epoch: 10, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.358 Vali Acc: 0.907 Test Loss: 0.358 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 50.26626706123352
Epoch: 11, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.418 Vali Acc: 0.905 Test Loss: 0.418 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 56.152913093566895
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.350 Vali Acc: 0.918 Test Loss: 0.350 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 59.755791664123535
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 57.63677144050598
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 54.72232437133789
Epoch: 15, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 50.60691237449646
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.263 Vali Acc: 0.945 Test Loss: 0.263 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 53.759111404418945
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 51.58278203010559
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.442 Vali Acc: 0.937 Test Loss: 0.442 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 51.27316355705261
Epoch: 19, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.265 Vali Acc: 0.943 Test Loss: 0.265 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 18981844
model size : 73.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.465299606323242
Epoch: 1, Steps: 89 | Train Loss: 1.298 Vali Loss: 0.374 Vali Acc: 0.886 Test Loss: 0.374 Test Acc: 0.886
Validation loss decreased (inf --> -0.886487).  Saving model ...
Epoch: 2 cost time: 26.12151598930359
Epoch: 2, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.886487 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 23.686960220336914
Epoch: 3, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.819429397583008
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (-0.939413 --> -0.949163).  Saving model ...
Epoch: 5 cost time: 26.65043020248413
Epoch: 5, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.55190873146057
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
Validation loss decreased (-0.949163 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 22.323240280151367
Epoch: 7, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.342 Vali Acc: 0.909 Test Loss: 0.342 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.74630331993103
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.308 Vali Acc: 0.928 Test Loss: 0.308 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.75032877922058
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.39703106880188
Epoch: 10, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.259 Vali Acc: 0.945 Test Loss: 0.259 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 26.4150173664093
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 26.143743991851807
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.70064353942871
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.424 Vali Acc: 0.893 Test Loss: 0.424 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 24.293513536453247
Epoch: 14, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.57700490951538
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 24.327430725097656
Epoch: 16, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.239 Vali Acc: 0.956 Test Loss: 0.239 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 5742036
model size : 23.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 97.1708767414093
Epoch: 1, Steps: 89 | Train Loss: 1.207 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
Validation loss decreased (inf --> -0.931752).  Saving model ...
Epoch: 2 cost time: 94.29292345046997
Epoch: 2, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
Validation loss decreased (-0.931752 --> -0.954734).  Saving model ...
Epoch: 3 cost time: 86.05435919761658
Epoch: 3, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 82.64390063285828
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.370 Vali Acc: 0.903 Test Loss: 0.370 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 89.70844030380249
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 88.89575433731079
Epoch: 6, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 78.28214049339294
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 83.03544092178345
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 84.02716636657715
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 82.61720395088196
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 84.70462274551392
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 91.19659566879272
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.243 Vali Acc: 0.960 Test Loss: 0.243 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 89.30986785888672
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
Validation loss decreased (-0.966572 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 83.35754728317261
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.202 Vali Acc: 0.955 Test Loss: 0.202 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 89.32009100914001
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 87.95976567268372
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.223 Vali Acc: 0.964 Test Loss: 0.223 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 80.31292033195496
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 86.7822916507721
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.257 Vali Acc: 0.956 Test Loss: 0.257 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 83.62128829956055
Epoch: 19, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.264 Vali Acc: 0.959 Test Loss: 0.264 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 84.03786540031433
Epoch: 20, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.545 Vali Acc: 0.895 Test Loss: 0.545 Test Acc: 0.895
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 95.91013288497925
Epoch: 21, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.364 Vali Acc: 0.942 Test Loss: 0.364 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 83.65101480484009
Epoch: 22, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.270 Vali Acc: 0.960 Test Loss: 0.270 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 87.24047684669495
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.285 Vali Acc: 0.957 Test Loss: 0.285 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 9608660
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 46.12811040878296
Epoch: 1, Steps: 89 | Train Loss: 1.198 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (inf --> -0.922003).  Saving model ...
Epoch: 2 cost time: 45.43801784515381
Epoch: 2, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
Validation loss decreased (-0.922003 --> -0.954734).  Saving model ...
Epoch: 3 cost time: 41.28027009963989
Epoch: 3, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 43.266597270965576
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.954734 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 33.579251289367676
Epoch: 5, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 43.10771703720093
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 42.90905547142029
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 41.9807186126709
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 39.90083694458008
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970750).  Saving model ...
Epoch: 10 cost time: 39.71389651298523
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.938 Test Loss: 0.225 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 43.58030915260315
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 44.78023982048035
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.288 Vali Acc: 0.945 Test Loss: 0.288 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 45.745699644088745
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 42.07613229751587
Epoch: 14, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.235 Vali Acc: 0.957 Test Loss: 0.235 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 42.874088764190674
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.250 Vali Acc: 0.958 Test Loss: 0.250 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 40.77614688873291
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.196 Vali Acc: 0.965 Test Loss: 0.196 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 41.15036368370056
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.206 Vali Acc: 0.971 Test Loss: 0.206 Test Acc: 0.971
Validation loss decreased (-0.970750 --> -0.971446).  Saving model ...
Epoch: 18 cost time: 40.9324996471405
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.336 Vali Acc: 0.948 Test Loss: 0.336 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 42.63042593002319
Epoch: 19, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.396 Vali Acc: 0.939 Test Loss: 0.396 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 35.992560386657715
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 41.91799020767212
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.334 Vali Acc: 0.955 Test Loss: 0.334 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 41.323837995529175
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.964 Test Loss: 0.271 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 38.381964683532715
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.297 Vali Acc: 0.956 Test Loss: 0.297 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 40.706196308135986
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.267 Vali Acc: 0.964 Test Loss: 0.267 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 41.76223158836365
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.962 Test Loss: 0.275 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 35.53813934326172
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.962 Test Loss: 0.268 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 37.10045003890991
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.318 Vali Acc: 0.964 Test Loss: 0.318 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 2988500
model size : 12.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 69.66541123390198
Epoch: 1, Steps: 89 | Train Loss: 1.256 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
Validation loss decreased (inf --> -0.927574).  Saving model ...
Epoch: 2 cost time: 61.156458616256714
Epoch: 2, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.927574 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 62.467909812927246
Epoch: 3, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 69.59527111053467
Epoch: 4, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 77.27126216888428
Epoch: 5, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 78.8659827709198
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 75.1949143409729
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.216 Vali Acc: 0.954 Test Loss: 0.216 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 77.3037006855011
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 65.95209193229675
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.293 Vali Acc: 0.938 Test Loss: 0.293 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 72.27016544342041
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.438 Vali Acc: 0.912 Test Loss: 0.438 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 68.58395457267761
Epoch: 11, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.356 Vali Acc: 0.927 Test Loss: 0.356 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 76.10569143295288
Epoch: 12, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.259 Vali Acc: 0.943 Test Loss: 0.259 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 78.41591572761536
Epoch: 13, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.274 Vali Acc: 0.938 Test Loss: 0.274 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 65.56698942184448
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.249 Vali Acc: 0.964 Test Loss: 0.249 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964482).  Saving model ...
Epoch: 15 cost time: 72.60478830337524
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
Validation loss decreased (-0.964482 --> -0.967965).  Saving model ...
Epoch: 16 cost time: 73.55441403388977
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.187 Vali Acc: 0.964 Test Loss: 0.187 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 77.0852563381195
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970750).  Saving model ...
Epoch: 18 cost time: 64.66670298576355
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
Validation loss decreased (-0.970750 --> -0.971447).  Saving model ...
Epoch: 19 cost time: 73.58491015434265
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 74.73130774497986
Epoch: 20, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.360 Vali Acc: 0.945 Test Loss: 0.360 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 62.19560885429382
Epoch: 21, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.401 Vali Acc: 0.945 Test Loss: 0.401 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 69.68481993675232
Epoch: 22, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.327 Vali Acc: 0.955 Test Loss: 0.327 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 66.67552161216736
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.298 Vali Acc: 0.965 Test Loss: 0.298 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 66.46035504341125
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.390 Vali Acc: 0.955 Test Loss: 0.390 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 62.49919128417969
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.971 Test Loss: 0.236 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 66.8750741481781
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 61.32419157028198
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.974 Test Loss: 0.221 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973535).  Saving model ...
Epoch: 28 cost time: 61.84156513214111
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.973 Test Loss: 0.220 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 69.69783592224121
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.974 Test Loss: 0.218 Test Acc: 0.974
Validation loss decreased (-0.973535 --> -0.974232).  Saving model ...
Epoch: 30 cost time: 75.51305603981018
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974232 --> -0.974928).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 9608660
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 33.614298582077026
Epoch: 1, Steps: 89 | Train Loss: 1.236 Vali Loss: 0.284 Vali Acc: 0.912 Test Loss: 0.284 Test Acc: 0.912
Validation loss decreased (inf --> -0.912253).  Saving model ...
Epoch: 2 cost time: 31.32202458381653
Epoch: 2, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.912253 --> -0.954038).  Saving model ...
Epoch: 3 cost time: 27.887404918670654
Epoch: 3, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 33.49335765838623
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 34.41046738624573
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.954038 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 35.60893368721008
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 35.03342032432556
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961002).  Saving model ...
Epoch: 8 cost time: 29.79194712638855
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.503950595855713
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.961002 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 29.843307971954346
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 29.43913722038269
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.311 Vali Acc: 0.934 Test Loss: 0.311 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 32.765270709991455
Epoch: 12, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.361 Vali Acc: 0.940 Test Loss: 0.361 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 33.107897996902466
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.67997646331787
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.282 Vali Acc: 0.953 Test Loss: 0.282 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 26.569105863571167
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.962 Test Loss: 0.198 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 28.27972936630249
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.305 Vali Acc: 0.953 Test Loss: 0.305 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 28.890180110931396
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 34.57077717781067
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 33.18288230895996
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 2988500
model size : 12.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 45.20773363113403
Epoch: 1, Steps: 89 | Train Loss: 1.294 Vali Loss: 0.380 Vali Acc: 0.885 Test Loss: 0.380 Test Acc: 0.885
Validation loss decreased (inf --> -0.885094).  Saving model ...
Epoch: 2 cost time: 36.77177166938782
Epoch: 2, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
Validation loss decreased (-0.885094 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 38.389601945877075
Epoch: 3, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 41.214436769485474
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.580 Vali Acc: 0.885 Test Loss: 0.580 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 44.11716604232788
Epoch: 5, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.866 Vali Acc: 0.855 Test Loss: 0.866 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 41.25266885757446
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 36.98556160926819
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 36.654574394226074
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 40.68668842315674
Epoch: 9, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.672 Vali Acc: 0.872 Test Loss: 0.672 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 42.00095057487488
Epoch: 10, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 38.755091190338135
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.362 Vali Acc: 0.921 Test Loss: 0.362 Test Acc: 0.921
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 36.90444993972778
Epoch: 12, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.440 Vali Acc: 0.904 Test Loss: 0.440 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 9608660
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.257703065872192
Epoch: 1, Steps: 89 | Train Loss: 1.270 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (inf --> -0.903200).  Saving model ...
Epoch: 2 cost time: 11.573957920074463
Epoch: 2, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.187 Vali Acc: 0.935 Test Loss: 0.187 Test Acc: 0.935
Validation loss decreased (-0.903200 --> -0.935235).  Saving model ...
Epoch: 3 cost time: 17.643035411834717
Epoch: 3, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.281 Vali Acc: 0.918 Test Loss: 0.281 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.076738595962524
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.935235 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 18.773338079452515
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.946377 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 19.36881923675537
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.936 Test Loss: 0.226 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.05867624282837
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.348978757858276
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.09779930114746
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.39311718940735
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.670304536819458
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 18.262673139572144
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.266 Vali Acc: 0.938 Test Loss: 0.266 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.09097170829773
Epoch: 13, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.441456079483032
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 17.86680006980896
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.195 Vali Acc: 0.961 Test Loss: 0.195 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 21.510124444961548
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.352 Vali Acc: 0.927 Test Loss: 0.352 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.159186840057373
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.478659629821777
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 18.63269305229187
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.276 Vali Acc: 0.939 Test Loss: 0.276 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 18.910928964614868
Epoch: 20, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.230 Vali Acc: 0.960 Test Loss: 0.230 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.81729221343994
Epoch: 21, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 2988500
model size : 12.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 101.60950350761414
Epoch: 1, Steps: 89 | Train Loss: 1.473 Vali Loss: 0.346 Vali Acc: 0.921 Test Loss: 0.346 Test Acc: 0.921
Validation loss decreased (inf --> -0.921306).  Saving model ...
Epoch: 2 cost time: 97.69252848625183
Epoch: 2, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.312 Vali Acc: 0.907 Test Loss: 0.312 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 89.16506576538086
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
Validation loss decreased (-0.921306 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 97.6490204334259
Epoch: 4, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.263 Vali Acc: 0.907 Test Loss: 0.263 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 86.06572556495667
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
Validation loss decreased (-0.938716 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 98.67248153686523
Epoch: 6, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.940109 --> -0.951948).  Saving model ...
Epoch: 7 cost time: 96.51321077346802
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.184 Vali Acc: 0.942 Test Loss: 0.184 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 92.85730051994324
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 95.16145873069763
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.270 Vali Acc: 0.932 Test Loss: 0.270 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 93.18696641921997
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 84.08718347549438
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.960305 --> -0.960305).  Saving model ...
Epoch: 12 cost time: 90.35265779495239
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.960305 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 89.48800730705261
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 80.36633348464966
Epoch: 14, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 92.99240136146545
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 88.84243750572205
Epoch: 16, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 75.43376159667969
Epoch: 17, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 81.84808993339539
Epoch: 18, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.494 Vali Acc: 0.899 Test Loss: 0.494 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 74.49960803985596
Epoch: 19, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.306 Vali Acc: 0.943 Test Loss: 0.306 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 78.91996550559998
Epoch: 20, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.218 Vali Acc: 0.965 Test Loss: 0.218 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 87.89978313446045
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.951 Test Loss: 0.243 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 87.91416597366333
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 23 cost time: 85.82855415344238
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 81.8155415058136
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.960 Test Loss: 0.219 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 85.44810152053833
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 79.4606249332428
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 77.84523582458496
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 77.04246187210083
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.964 Test Loss: 0.257 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 79.64716410636902
Epoch: 29, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.440 Vali Acc: 0.932 Test Loss: 0.440 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 81.56367659568787
Epoch: 30, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.426 Vali Acc: 0.927 Test Loss: 0.426 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 9492468
model size : 36.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 47.478657484054565
Epoch: 1, Steps: 89 | Train Loss: 1.526 Vali Loss: 0.370 Vali Acc: 0.919 Test Loss: 0.370 Test Acc: 0.919
Validation loss decreased (inf --> -0.919216).  Saving model ...
Epoch: 2 cost time: 49.02466368675232
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.919216 --> -0.956823).  Saving model ...
Epoch: 3 cost time: 43.55907583236694
Epoch: 3, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 47.50947165489197
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 45.231080532073975
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 39.253764152526855
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 44.15121388435364
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 40.558820486068726
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.135 Vali Acc: 0.955 Test Loss: 0.135 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 45.82571196556091
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.959609 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 39.70245146751404
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 40.32028341293335
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 46.051995277404785
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 46.713200092315674
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 44.03349852561951
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 48.776081562042236
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.245 Vali Acc: 0.939 Test Loss: 0.245 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 44.28027153015137
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 41.738725662231445
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 43.13212466239929
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 45.24002814292908
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 2872052
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 61.687727212905884
Epoch: 1, Steps: 89 | Train Loss: 1.531 Vali Loss: 0.389 Vali Acc: 0.905 Test Loss: 0.389 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 60.31414198875427
Epoch: 2, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
Validation loss decreased (-0.905289 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 59.09585905075073
Epoch: 3, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.941502 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 63.75231862068176
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.219 Vali Acc: 0.923 Test Loss: 0.219 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 58.60290884971619
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.342 Vali Acc: 0.927 Test Loss: 0.342 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 58.23211860656738
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.133 Vali Acc: 0.956 Test Loss: 0.133 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 62.181103229522705
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 58.10542035102844
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 61.9163384437561
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 56.92520499229431
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 59.08566117286682
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.958912 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 60.3648726940155
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 54.116251707077026
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 61.35534739494324
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 59.84690475463867
Epoch: 15, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.206 Vali Acc: 0.936 Test Loss: 0.206 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 61.66068506240845
Epoch: 16, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.334 Vali Acc: 0.912 Test Loss: 0.334 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 57.931580543518066
Epoch: 17, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.316 Vali Acc: 0.921 Test Loss: 0.316 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 62.56766486167908
Epoch: 18, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 55.422507762908936
Epoch: 19, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 54.534852504730225
Epoch: 20, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 58.557971477508545
Epoch: 21, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 9492468
model size : 36.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 37.65046739578247
Epoch: 1, Steps: 89 | Train Loss: 1.571 Vali Loss: 0.432 Vali Acc: 0.897 Test Loss: 0.432 Test Acc: 0.897
Validation loss decreased (inf --> -0.896932).  Saving model ...
Epoch: 2 cost time: 30.322826623916626
Epoch: 2, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.896932 --> -0.947770).  Saving model ...
Epoch: 3 cost time: 30.07021999359131
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.142 Vali Acc: 0.953 Test Loss: 0.142 Test Acc: 0.953
Validation loss decreased (-0.947770 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 32.88565158843994
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 32.01798915863037
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 29.188540935516357
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.451413869857788
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 32.50953960418701
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.942 Test Loss: 0.171 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 30.77314853668213
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.724655389785767
Epoch: 10, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.252 Vali Acc: 0.929 Test Loss: 0.252 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 28.87407636642456
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 36.731077432632446
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 32.65726375579834
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 38.153624296188354
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 38.01910972595215
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 2872052
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 37.03376007080078
Epoch: 1, Steps: 89 | Train Loss: 1.552 Vali Loss: 0.432 Vali Acc: 0.896 Test Loss: 0.432 Test Acc: 0.896
Validation loss decreased (inf --> -0.895539).  Saving model ...
Epoch: 2 cost time: 31.371798753738403
Epoch: 2, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.895539 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 32.35362124443054
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.262 Vali Acc: 0.923 Test Loss: 0.262 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.72085213661194
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.930360 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 32.76718473434448
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.56726622581482
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.161 Vali Acc: 0.946 Test Loss: 0.161 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 35.20300078392029
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 33.62062859535217
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.954037 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 39.94558024406433
Epoch: 9, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 30.53352403640747
Epoch: 10, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 33.617682456970215
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.190 Vali Acc: 0.947 Test Loss: 0.190 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 30.672586917877197
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.173 Vali Acc: 0.945 Test Loss: 0.173 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 37.05032753944397
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.963787).  Saving model ...
Epoch: 14 cost time: 30.375593900680542
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.98961615562439
Epoch: 15, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 23.607194185256958
Epoch: 16, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.316 Vali Acc: 0.908 Test Loss: 0.316 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 31.74230456352234
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.369 Vali Acc: 0.914 Test Loss: 0.369 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.975342273712158
Epoch: 18, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.216 Vali Acc: 0.942 Test Loss: 0.216 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 32.22097992897034
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 26.28212857246399
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 28.117186307907104
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.382 Vali Acc: 0.937 Test Loss: 0.382 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 27.108174562454224
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.246 Vali Acc: 0.943 Test Loss: 0.246 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 20.779428243637085
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.955 Test Loss: 0.218 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 9492468
model size : 36.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.932276010513306
Epoch: 1, Steps: 89 | Train Loss: 1.603 Vali Loss: 0.448 Vali Acc: 0.893 Test Loss: 0.448 Test Acc: 0.893
Validation loss decreased (inf --> -0.892753).  Saving model ...
Epoch: 2 cost time: 16.07526159286499
Epoch: 2, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
Validation loss decreased (-0.892753 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 17.70072102546692
Epoch: 3, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.944984 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 19.6076500415802
Epoch: 4, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.173 Vali Acc: 0.945 Test Loss: 0.173 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.148969650268555
Epoch: 5, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
Validation loss decreased (-0.947770 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 23.421967029571533
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.182 Vali Acc: 0.939 Test Loss: 0.182 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.03042483329773
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
Validation loss decreased (-0.951252 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 21.63680386543274
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.664366960525513
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.431077480316162
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 25.22478675842285
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.07903242111206
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 13 cost time: 25.26146101951599
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.889116287231445
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.297 Vali Acc: 0.939 Test Loss: 0.297 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.05898404121399
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.797362327575684
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.289 Vali Acc: 0.942 Test Loss: 0.289 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 18.339842319488525
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 19.077067613601685
Epoch: 18, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.310 Vali Acc: 0.918 Test Loss: 0.310 Test Acc: 0.918
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.141416549682617
Epoch: 19, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 24.13122868537903
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.947 Test Loss: 0.189 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 25.478232622146606
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.257 Vali Acc: 0.942 Test Loss: 0.257 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 24.810792446136475
Epoch: 22, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 2872052
model size : 11.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 58.604092597961426
Epoch: 1, Steps: 89 | Train Loss: 1.682 Vali Loss: 0.485 Vali Acc: 0.857 Test Loss: 0.485 Test Acc: 0.857
Validation loss decreased (inf --> -0.856541).  Saving model ...
Epoch: 2 cost time: 50.72832798957825
Epoch: 2, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
Validation loss decreased (-0.856541 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 59.59120440483093
Epoch: 3, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.203 Vali Acc: 0.932 Test Loss: 0.203 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 55.101704835891724
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 50.2577702999115
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.940109 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 57.99108076095581
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.942895 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 53.92057991027832
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 48.933313608169556
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.235 Vali Acc: 0.935 Test Loss: 0.235 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 60.258599042892456
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 59.96174073219299
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 60.509655237197876
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 12 cost time: 53.610313177108765
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 58.7606406211853
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 62.780457735061646
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 52.85596489906311
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 57.41140174865723
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 59.23414707183838
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 54.73944711685181
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 53.8105309009552
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.329 Vali Acc: 0.944 Test Loss: 0.329 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 56.62741470336914
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.971447).  Saving model ...
Epoch: 21 cost time: 60.04544973373413
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 55.976661682128906
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 50.62191867828369
Epoch: 23, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.398 Vali Acc: 0.928 Test Loss: 0.398 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 58.57060241699219
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.268 Vali Acc: 0.960 Test Loss: 0.268 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 54.195101737976074
Epoch: 25, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.202 Vali Acc: 0.964 Test Loss: 0.202 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 45.2722852230072
Epoch: 26, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.343 Vali Acc: 0.932 Test Loss: 0.343 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 52.7869017124176
Epoch: 27, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 50.2654755115509
Epoch: 28, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.239 Vali Acc: 0.961 Test Loss: 0.239 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 51.94840884208679
Epoch: 29, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.266 Vali Acc: 0.952 Test Loss: 0.266 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 60.21138596534729
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 4805108
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 35.727741956710815
Epoch: 1, Steps: 89 | Train Loss: 1.610 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (inf --> -0.900414).  Saving model ...
Epoch: 2 cost time: 22.721432209014893
Epoch: 2, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.900414 --> -0.951251).  Saving model ...
Epoch: 3 cost time: 30.839939832687378
Epoch: 3, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.951251 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 30.94507670402527
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.172 Vali Acc: 0.947 Test Loss: 0.172 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.627835273742676
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 31.111243724822998
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 29.15054941177368
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.41052484512329
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 28.646952152252197
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 32.59361910820007
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 29.66870403289795
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.967269 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 28.791571140289307
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 27.617165565490723
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.857178926467896
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 28.366628170013428
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 23.048704147338867
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 26.977017402648926
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 18 cost time: 19.344353437423706
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.262086153030396
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 23.7455050945282
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 21.005320072174072
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 24.802366971969604
Epoch: 22, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.270 Vali Acc: 0.951 Test Loss: 0.270 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 28.325132608413696
Epoch: 23, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 25.209228038787842
Epoch: 24, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.284 Vali Acc: 0.955 Test Loss: 0.284 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 25.702820539474487
Epoch: 25, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.381 Vali Acc: 0.939 Test Loss: 0.381 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 24.296557664871216
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 22.228476524353027
Epoch: 27, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1494772
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 37.87089228630066
Epoch: 1, Steps: 89 | Train Loss: 1.685 Vali Loss: 0.518 Vali Acc: 0.852 Test Loss: 0.518 Test Acc: 0.852
Validation loss decreased (inf --> -0.851666).  Saving model ...
Epoch: 2 cost time: 31.66916823387146
Epoch: 2, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
Validation loss decreased (-0.851666 --> -0.952644).  Saving model ...
Epoch: 3 cost time: 32.22033166885376
Epoch: 3, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.265 Vali Acc: 0.912 Test Loss: 0.265 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.108529567718506
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.952644 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 24.728801727294922
Epoch: 5, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 32.51750564575195
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.43496870994568
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.87924027442932
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 30.552486658096313
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 27.744580030441284
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.479963779449463
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 29.515379428863525
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 21.821072816848755
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.954734 --> -0.967269).  Saving model ...
Epoch: 14 cost time: 36.06457233428955
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 15 cost time: 33.8554368019104
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.490 Vali Acc: 0.919 Test Loss: 0.490 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 32.99698066711426
Epoch: 16, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.382 Vali Acc: 0.918 Test Loss: 0.382 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 38.21208310127258
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.371 Vali Acc: 0.916 Test Loss: 0.371 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 34.93762421607971
Epoch: 18, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.325 Vali Acc: 0.945 Test Loss: 0.325 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 35.57274270057678
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 31.88267469406128
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.379 Vali Acc: 0.939 Test Loss: 0.379 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 25.41886043548584
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 37.69368767738342
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.233 Vali Acc: 0.953 Test Loss: 0.233 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 33.21384930610657
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.345 Vali Acc: 0.929 Test Loss: 0.345 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 37.35722851753235
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.252 Vali Acc: 0.946 Test Loss: 0.252 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 4805108
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 20.58152675628662
Epoch: 1, Steps: 89 | Train Loss: 1.634 Vali Loss: 0.464 Vali Acc: 0.896 Test Loss: 0.464 Test Acc: 0.896
Validation loss decreased (inf --> -0.895539).  Saving model ...
Epoch: 2 cost time: 15.954364776611328
Epoch: 2, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.895539 --> -0.960305).  Saving model ...
Epoch: 3 cost time: 17.924561977386475
Epoch: 3, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.051844835281372
Epoch: 4, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.146 Vali Acc: 0.956 Test Loss: 0.146 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.396251201629639
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.960305 --> -0.980501).  Saving model ...
Epoch: 6 cost time: 17.562588691711426
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.022088289260864
Epoch: 7, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.999167442321777
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.538400411605835
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.832901000976562
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.21913743019104
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 15.625342607498169
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.603193998336792
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.357852458953857
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 19.53499698638916
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 1494772
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 20.06530213356018
Epoch: 1, Steps: 89 | Train Loss: 1.787 Vali Loss: 0.595 Vali Acc: 0.830 Test Loss: 0.595 Test Acc: 0.830
Validation loss decreased (inf --> -0.830078).  Saving model ...
Epoch: 2 cost time: 15.960941314697266
Epoch: 2, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.275 Vali Acc: 0.916 Test Loss: 0.275 Test Acc: 0.916
Validation loss decreased (-0.830078 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 18.74195909500122
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.915735 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 19.112487077713013
Epoch: 4, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.170 Vali Acc: 0.942 Test Loss: 0.170 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.517905235290527
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.358 Vali Acc: 0.880 Test Loss: 0.358 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.90394425392151
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.220 Vali Acc: 0.936 Test Loss: 0.220 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 19.546613216400146
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.386382818222046
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (-0.949859 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 14.993331909179688
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.673983812332153
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.299 Vali Acc: 0.909 Test Loss: 0.299 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 16.422418355941772
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.567161798477173
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.107093811035156
Epoch: 13, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 21.022043228149414
Epoch: 14, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 18.87338638305664
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.244 Vali Acc: 0.929 Test Loss: 0.244 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 15.809910774230957
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 1.185 Vali Acc: 0.862 Test Loss: 1.185 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 17.04202938079834
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.434 Vali Acc: 0.909 Test Loss: 0.434 Test Acc: 0.909
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 18.354307889938354
Epoch: 18, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 4805108
model size : 18.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.693309783935547
Epoch: 1, Steps: 89 | Train Loss: 1.685 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
Validation loss decreased (inf --> -0.878128).  Saving model ...
Epoch: 2 cost time: 12.162718057632446
Epoch: 2, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
Validation loss decreased (-0.878128 --> -0.952644).  Saving model ...
Epoch: 3 cost time: 12.21111011505127
Epoch: 3, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.952644 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 13.262242078781128
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.406164407730103
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.151 Vali Acc: 0.953 Test Loss: 0.151 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.00606632232666
Epoch: 6, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.965180 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 10.9711754322052
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 10.722038507461548
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.961 Test Loss: 0.126 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.949014902114868
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 10.571514368057251
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.676335096359253
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 10.371918678283691
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.739890575408936
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.680146217346191
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.373 Vali Acc: 0.905 Test Loss: 0.373 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.563450574874878
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.344905376434326
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.163861274719238
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.79477596282959
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.342072486877441
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.936 Test Loss: 0.227 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.421347856521606
Epoch: 20, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.280 Vali Acc: 0.927 Test Loss: 0.280 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.151732921600342
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.938 Test Loss: 0.301 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1494772
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.2961483001709
Epoch: 1, Steps: 89 | Train Loss: 1.666 Vali Loss: 0.494 Vali Acc: 0.873 Test Loss: 0.494 Test Acc: 0.873
Validation loss decreased (inf --> -0.873254).  Saving model ...
Epoch: 2 cost time: 31.072155952453613
Epoch: 2, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.873254 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 27.60969376564026
Epoch: 3, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.927574 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 25.34313178062439
Epoch: 4, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
Validation loss decreased (-0.954734 --> -0.956127).  Saving model ...
Epoch: 5 cost time: 29.22521448135376
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.148 Vali Acc: 0.948 Test Loss: 0.148 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 38.47482180595398
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.956127 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 36.7482795715332
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 39.993547677993774
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967966).  Saving model ...
Epoch: 9 cost time: 38.09612417221069
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.967966 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 37.05446672439575
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 37.622169733047485
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 40.302518367767334
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 35.82291054725647
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 35.793259620666504
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 39.3606858253479
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 39.51074242591858
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 36.286921977996826
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 38.49293804168701
Epoch: 18, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 39.040374755859375
Epoch: 19, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.936 Test Loss: 0.265 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 27.440689086914062
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 35.180235147476196
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 36.775755643844604
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 2461428
model size : 10.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.153233528137207
Epoch: 1, Steps: 89 | Train Loss: 1.707 Vali Loss: 0.534 Vali Acc: 0.853 Test Loss: 0.534 Test Acc: 0.853
Validation loss decreased (inf --> -0.853059).  Saving model ...
Epoch: 2 cost time: 19.907381772994995
Epoch: 2, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
Validation loss decreased (-0.853059 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 21.508212566375732
Epoch: 3, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.947073 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 21.735405921936035
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.858449935913086
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 20.580154180526733
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.183685302734375
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.962394 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 21.505985498428345
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.129913330078125
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 14.748565912246704
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 20.601521015167236
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.4158353805542
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.205626249313354
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.996963024139404
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 21.455684661865234
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.186028242111206
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 21.035565853118896
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.966 Test Loss: 0.200 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.127765893936157
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.492037534713745
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972839).  Saving model ...
Epoch: 20 cost time: 20.42496371269226
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
Validation loss decreased (-0.972839 --> -0.976321).  Saving model ...
Epoch: 21 cost time: 18.76593279838562
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 19.23637580871582
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.246 Vali Acc: 0.961 Test Loss: 0.246 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 21.37144923210144
Epoch: 23, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 17.748141050338745
Epoch: 24, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.256 Vali Acc: 0.955 Test Loss: 0.256 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 19.16854453086853
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.233 Vali Acc: 0.958 Test Loss: 0.233 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 20.47532296180725
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 10.622555255889893
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.966 Test Loss: 0.208 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 21.000091314315796
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.968 Test Loss: 0.201 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 19.90132737159729
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.971 Test Loss: 0.189 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 17.96196961402893
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 806132
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.62409257888794
Epoch: 1, Steps: 89 | Train Loss: 1.707 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (inf --> -0.866987).  Saving model ...
Epoch: 2 cost time: 22.58786916732788
Epoch: 2, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.201 Vali Acc: 0.943 Test Loss: 0.201 Test Acc: 0.943
Validation loss decreased (-0.866987 --> -0.942895).  Saving model ...
Epoch: 3 cost time: 25.416868925094604
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.942895 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 22.672517776489258
Epoch: 4, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.371244430541992
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.297590732574463
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.472890615463257
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 26.373250722885132
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.718143463134766
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.2774600982666
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 11 cost time: 25.57609748840332
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.00761127471924
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.965180 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 26.50898766517639
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.143019199371338
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 25.381737232208252
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.927176237106323
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.06930708885193
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 25.751404285430908
Epoch: 18, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.301523447036743
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 25.038153409957886
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.293 Vali Acc: 0.946 Test Loss: 0.293 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 26.067368984222412
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 22.984489917755127
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 2461428
model size : 10.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.0085289478302
Epoch: 1, Steps: 89 | Train Loss: 1.739 Vali Loss: 0.541 Vali Acc: 0.852 Test Loss: 0.541 Test Acc: 0.852
Validation loss decreased (inf --> -0.851666).  Saving model ...
Epoch: 2 cost time: 14.069824457168579
Epoch: 2, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
Validation loss decreased (-0.851666 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 14.468904495239258
Epoch: 3, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.193 Vali Acc: 0.947 Test Loss: 0.193 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 12.591945171356201
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.947073 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 16.49132227897644
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 16.435868501663208
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.970751 --> -0.981893).  Saving model ...
Epoch: 7 cost time: 15.078248262405396
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.490518569946289
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.964423418045044
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.503430128097534
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.164236068725586
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.663018226623535
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.136841297149658
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.45267367362976
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.455831289291382
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.30177402496338
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 806132
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.28712296485901
Epoch: 1, Steps: 89 | Train Loss: 1.731 Vali Loss: 0.531 Vali Acc: 0.871 Test Loss: 0.531 Test Acc: 0.871
Validation loss decreased (inf --> -0.871165).  Saving model ...
Epoch: 2 cost time: 14.649621963500977
Epoch: 2, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
Validation loss decreased (-0.871165 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 16.720465421676636
Epoch: 3, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.938716 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 15.691891431808472
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.466930866241455
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.461448907852173
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 16.132247924804688
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.08945107460022
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.17865777015686
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 15.055215835571289
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977019).  Saving model ...
Epoch: 11 cost time: 15.878995180130005
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.844243049621582
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.374216079711914
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.635241031646729
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.86841368675232
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.326 Vali Acc: 0.918 Test Loss: 0.326 Test Acc: 0.918
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.967916011810303
Epoch: 16, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.58631157875061
Epoch: 17, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.63749408721924
Epoch: 18, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.256 Vali Acc: 0.921 Test Loss: 0.256 Test Acc: 0.921
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 15.305127620697021
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 15.024641990661621
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 2461428
model size : 10.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.57011604309082
Epoch: 1, Steps: 89 | Train Loss: 1.791 Vali Loss: 0.641 Vali Acc: 0.841 Test Loss: 0.641 Test Acc: 0.841
Validation loss decreased (inf --> -0.841219).  Saving model ...
Epoch: 2 cost time: 10.667611122131348
Epoch: 2, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.841219 --> -0.947769).  Saving model ...
Epoch: 3 cost time: 10.266809225082397
Epoch: 3, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.347625017166138
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.947769 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 11.215855598449707
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
Validation loss decreased (-0.948466 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 11.350998163223267
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.951220035552979
Epoch: 7, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.958216 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 7.857504606246948
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.698724031448364
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.02187728881836
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.688610076904297
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.275 Vali Acc: 0.916 Test Loss: 0.275 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.099472284317017
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.40229082107544
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.818772315979004
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 10.11305022239685
Epoch: 15, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.40296745300293
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.354552745819092
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.195464134216309
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.90139126777649
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.989978075027466
Epoch: 20, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.416419982910156
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.01949667930603
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.544414758682251
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.469513416290283
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 806132
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 40.22526574134827
Epoch: 1, Steps: 89 | Train Loss: 2.048 Vali Loss: 0.854 Vali Acc: 0.857 Test Loss: 0.854 Test Acc: 0.857
Validation loss decreased (inf --> -0.857234).  Saving model ...
Epoch: 2 cost time: 39.60866951942444
Epoch: 2, Steps: 89 | Train Loss: 0.477 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.857234 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 42.40938138961792
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.933145 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 43.47084999084473
Epoch: 4, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.206 Vali Acc: 0.928 Test Loss: 0.206 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 37.53913640975952
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.951948 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 35.59231734275818
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.954734 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 35.22179651260376
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.127 Vali Acc: 0.953 Test Loss: 0.127 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 38.32997941970825
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.251 Vali Acc: 0.932 Test Loss: 0.251 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 36.997217416763306
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
Validation loss decreased (-0.956823 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 41.14527916908264
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 39.42579388618469
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.178 Vali Acc: 0.947 Test Loss: 0.178 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 39.57687473297119
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 40.46712517738342
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 42.10850143432617
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 42.00450372695923
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 41.46797299385071
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 39.57279825210571
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 38.43174862861633
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 19 cost time: 39.559362173080444
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 40.39475059509277
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 42.10441255569458
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 42.07656979560852
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.216 Vali Acc: 0.947 Test Loss: 0.216 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 38.67511582374573
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 39.06044030189514
Epoch: 24, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 37.61289668083191
Epoch: 25, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 38.69059467315674
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 41.44865036010742
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.947 Test Loss: 0.192 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 38.808067083358765
Epoch: 28, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 2403332
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.92464280128479
Epoch: 1, Steps: 89 | Train Loss: 2.133 Vali Loss: 0.922 Vali Acc: 0.822 Test Loss: 0.922 Test Acc: 0.822
Validation loss decreased (inf --> -0.822414).  Saving model ...
Epoch: 2 cost time: 21.37830138206482
Epoch: 2, Steps: 89 | Train Loss: 0.482 Vali Loss: 0.283 Vali Acc: 0.927 Test Loss: 0.283 Test Acc: 0.927
Validation loss decreased (-0.822414 --> -0.926877).  Saving model ...
Epoch: 3 cost time: 19.86453676223755
Epoch: 3, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
Validation loss decreased (-0.926877 --> -0.938717).  Saving model ...
Epoch: 4 cost time: 22.390113830566406
Epoch: 4, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.938717 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 20.023192882537842
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.861753940582275
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
Validation loss decreased (-0.950555 --> -0.951252).  Saving model ...
Epoch: 7 cost time: 19.49109387397766
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
Validation loss decreased (-0.951252 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 19.090779066085815
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.998360872268677
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 26.522712469100952
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.967269).  Saving model ...
Epoch: 11 cost time: 24.30575442314148
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 27.4859938621521
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.37332797050476
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 24.578306198120117
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973537).  Saving model ...
Epoch: 15 cost time: 27.15805983543396
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 26.798847436904907
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 26.894346237182617
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 27.45527219772339
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 26.13424301147461
Epoch: 19, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 24.946187496185303
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 24.644469022750854
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.214 Vali Acc: 0.945 Test Loss: 0.214 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 27.233274221420288
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 27.610674619674683
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 26.47764539718628
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 747908
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 35.67905306816101
Epoch: 1, Steps: 89 | Train Loss: 2.051 Vali Loss: 0.875 Vali Acc: 0.843 Test Loss: 0.875 Test Acc: 0.843
Validation loss decreased (inf --> -0.842610).  Saving model ...
Epoch: 2 cost time: 34.832765102386475
Epoch: 2, Steps: 89 | Train Loss: 0.486 Vali Loss: 0.269 Vali Acc: 0.939 Test Loss: 0.269 Test Acc: 0.939
Validation loss decreased (-0.842610 --> -0.939412).  Saving model ...
Epoch: 3 cost time: 35.49965858459473
Epoch: 3, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
Validation loss decreased (-0.939412 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 35.99247360229492
Epoch: 4, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.942199 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 37.161691427230835
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.950555 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 33.78092384338379
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.133 Vali Acc: 0.955 Test Loss: 0.133 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 34.6445209980011
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
Validation loss decreased (-0.955430 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 30.69621992111206
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.928 Test Loss: 0.267 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 36.17860794067383
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 36.36866474151611
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 34.5368595123291
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 33.40873837471008
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 13 cost time: 32.79862594604492
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 35.56632661819458
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 36.47830152511597
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 30.906156063079834
Epoch: 16, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 33.5967321395874
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.229 Vali Acc: 0.931 Test Loss: 0.229 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 32.77898836135864
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 34.512895822525024
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 34.65567326545715
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 35.765663623809814
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 32.57330799102783
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 32.68227672576904
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 2403332
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.00357723236084
Epoch: 1, Steps: 89 | Train Loss: 2.147 Vali Loss: 0.963 Vali Acc: 0.829 Test Loss: 0.963 Test Acc: 0.829
Validation loss decreased (inf --> -0.828681).  Saving model ...
Epoch: 2 cost time: 22.556632041931152
Epoch: 2, Steps: 89 | Train Loss: 0.502 Vali Loss: 0.307 Vali Acc: 0.921 Test Loss: 0.307 Test Acc: 0.921
Validation loss decreased (-0.828681 --> -0.921306).  Saving model ...
Epoch: 3 cost time: 21.85256290435791
Epoch: 3, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.219 Vali Acc: 0.939 Test Loss: 0.219 Test Acc: 0.939
Validation loss decreased (-0.921306 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 22.06439971923828
Epoch: 4, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.939413 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 20.194088459014893
Epoch: 5, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.903125762939453
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.174 Vali Acc: 0.947 Test Loss: 0.174 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.81996726989746
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.947770 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 18.589730501174927
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.949859 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 20.46845245361328
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.26517915725708
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.959609).  Saving model ...
Epoch: 11 cost time: 21.096692085266113
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.243937730789185
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.284570932388306
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.152 Vali Acc: 0.953 Test Loss: 0.152 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.836655378341675
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 20.060198307037354
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.806294679641724
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.280 Vali Acc: 0.940 Test Loss: 0.280 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 21.336708307266235
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 21.622532844543457
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 21.44683337211609
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 21.634413719177246
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.222 Vali Acc: 0.936 Test Loss: 0.222 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9596100278551533
model parameter : 747908
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.58920454978943
Epoch: 1, Steps: 89 | Train Loss: 2.075 Vali Loss: 0.985 Vali Acc: 0.852 Test Loss: 0.985 Test Acc: 0.852
Validation loss decreased (inf --> -0.852358).  Saving model ...
Epoch: 2 cost time: 19.773172616958618
Epoch: 2, Steps: 89 | Train Loss: 0.528 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.852358 --> -0.924788).  Saving model ...
Epoch: 3 cost time: 20.825966596603394
Epoch: 3, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.924788 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 21.213162660598755
Epoch: 4, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.225 Vali Acc: 0.929 Test Loss: 0.225 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.92357611656189
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (-0.937324 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 20.347023487091064
Epoch: 6, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.951252 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 20.508711099624634
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.051893949508667
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.009446144104004
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.949 Test Loss: 0.148 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.43533945083618
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 17.59572434425354
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.955 Test Loss: 0.136 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.96201515197754
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 19.061983585357666
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 19.873918533325195
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.102454900741577
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.415 Vali Acc: 0.920 Test Loss: 0.415 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 17.724536418914795
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.271 Vali Acc: 0.927 Test Loss: 0.271 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 2403332
model size : 9.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.083032846450806
Epoch: 1, Steps: 89 | Train Loss: 2.234 Vali Loss: 1.100 Vali Acc: 0.799 Test Loss: 1.100 Test Acc: 0.799
Validation loss decreased (inf --> -0.799432).  Saving model ...
Epoch: 2 cost time: 10.720598220825195
Epoch: 2, Steps: 89 | Train Loss: 0.580 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.799432 --> -0.850274).  Saving model ...
Epoch: 3 cost time: 14.61654257774353
Epoch: 3, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.256 Vali Acc: 0.936 Test Loss: 0.256 Test Acc: 0.936
Validation loss decreased (-0.850274 --> -0.935931).  Saving model ...
Epoch: 4 cost time: 14.720291376113892
Epoch: 4, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.935931 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 14.886478900909424
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.223 Vali Acc: 0.929 Test Loss: 0.223 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.101462125778198
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.946377 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 14.309653997421265
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.44300889968872
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.550009727478027
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.616669654846191
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 13.678263664245605
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.348118543624878
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.845383167266846
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.269515037536621
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.216783046722412
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.184 Vali Acc: 0.945 Test Loss: 0.184 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.68988585472107
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.654210567474365
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 18 cost time: 13.974835872650146
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.966573 --> -0.975626).  Saving model ...
Epoch: 19 cost time: 12.840092420578003
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.7183096408844
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 13.25357174873352
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.309067249298096
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.603838682174683
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.338344097137451
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 14.164544105529785
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 14.370673179626465
Epoch: 26, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 12.374614715576172
Epoch: 27, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 13.595534563064575
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 747908
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 31.106781721115112
Epoch: 1, Steps: 89 | Train Loss: 2.071 Vali Loss: 0.910 Vali Acc: 0.823 Test Loss: 0.910 Test Acc: 0.823
Validation loss decreased (inf --> -0.823111).  Saving model ...
Epoch: 2 cost time: 29.206834316253662
Epoch: 2, Steps: 89 | Train Loss: 0.477 Vali Loss: 0.275 Vali Acc: 0.929 Test Loss: 0.275 Test Acc: 0.929
Validation loss decreased (-0.823111 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 31.74645495414734
Epoch: 3, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
Validation loss decreased (-0.928967 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 31.397783994674683
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
Validation loss decreased (-0.944984 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 25.81869125366211
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.88146734237671
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.843016624450684
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.958216 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 27.986974954605103
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 23.834235429763794
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 30.673209190368652
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 30.64205527305603
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.247 Vali Acc: 0.938 Test Loss: 0.247 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.41865372657776
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.444011688232422
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 30.78308916091919
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 15 cost time: 30.76940655708313
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 25.95167565345764
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 29.961288928985596
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 18 cost time: 30.482144355773926
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 19.324967861175537
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.976322).  Saving model ...
Epoch: 20 cost time: 25.160593032836914
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 29.348820209503174
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 28.960289001464844
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 22.41873049736023
Epoch: 23, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.277 Vali Acc: 0.932 Test Loss: 0.277 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 20.790627002716064
Epoch: 24, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.242 Vali Acc: 0.946 Test Loss: 0.242 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 28.253541707992554
Epoch: 25, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 26.713295936584473
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 25.868111610412598
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 28.76045322418213
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.947 Test Loss: 0.219 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 28.304842948913574
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1231108
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.80413246154785
Epoch: 1, Steps: 89 | Train Loss: 2.105 Vali Loss: 0.905 Vali Acc: 0.822 Test Loss: 0.905 Test Acc: 0.822
Validation loss decreased (inf --> -0.822414).  Saving model ...
Epoch: 2 cost time: 17.745816946029663
Epoch: 2, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
Validation loss decreased (-0.822414 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 18.106186151504517
Epoch: 3, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.926181 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 16.575685024261475
Epoch: 4, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.943591 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 14.782384395599365
Epoch: 5, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.516919374465942
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 17.01219654083252
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.952032327651978
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.97276520729065
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.963787 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 11.753645658493042
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.79144024848938
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.805877923965454
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.557403802871704
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.330806970596313
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.048173189163208
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.205874919891357
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.727080821990967
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 14.74916696548462
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.086567163467407
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 403332
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.64168882369995
Epoch: 1, Steps: 89 | Train Loss: 2.078 Vali Loss: 0.928 Vali Acc: 0.831 Test Loss: 0.928 Test Acc: 0.831
Validation loss decreased (inf --> -0.830771).  Saving model ...
Epoch: 2 cost time: 19.96626114845276
Epoch: 2, Steps: 89 | Train Loss: 0.477 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
Validation loss decreased (-0.830771 --> -0.928270).  Saving model ...
Epoch: 3 cost time: 19.94490385055542
Epoch: 3, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
Validation loss decreased (-0.928270 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 19.93451189994812
Epoch: 4, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.632845640182495
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.942895 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 21.752710103988647
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.917962074279785
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.949859 --> -0.956823).  Saving model ...
Epoch: 8 cost time: 18.87609577178955
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 22.30150842666626
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 22.596724033355713
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.562747955322266
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.245108604431152
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 13 cost time: 18.828919410705566
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.089473009109497
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.30996799468994
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 18.27420711517334
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 18.017020225524902
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 19.294114589691162
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.470 Vali Acc: 0.919 Test Loss: 0.470 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.599040985107422
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.940 Test Loss: 0.208 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 21.62521481513977
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.945 Test Loss: 0.207 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 19.40407395362854
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 19.69729232788086
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 1231108
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.799493074417114
Epoch: 1, Steps: 89 | Train Loss: 2.094 Vali Loss: 0.911 Vali Acc: 0.825 Test Loss: 0.911 Test Acc: 0.825
Validation loss decreased (inf --> -0.825200).  Saving model ...
Epoch: 2 cost time: 14.666327238082886
Epoch: 2, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.307 Vali Acc: 0.923 Test Loss: 0.307 Test Acc: 0.923
Validation loss decreased (-0.825200 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 10.727768898010254
Epoch: 3, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.226 Vali Acc: 0.932 Test Loss: 0.226 Test Acc: 0.932
Validation loss decreased (-0.922699 --> -0.931753).  Saving model ...
Epoch: 4 cost time: 12.146262884140015
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.198 Vali Acc: 0.932 Test Loss: 0.198 Test Acc: 0.932
Validation loss decreased (-0.931753 --> -0.931753).  Saving model ...
Epoch: 5 cost time: 14.373308420181274
Epoch: 5, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.194 Vali Acc: 0.932 Test Loss: 0.194 Test Acc: 0.932
Validation loss decreased (-0.931753 --> -0.931753).  Saving model ...
Epoch: 6 cost time: 14.332040548324585
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (-0.931753 --> -0.947770).  Saving model ...
Epoch: 7 cost time: 14.268919467926025
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.947770 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 12.299520492553711
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.226 Vali Acc: 0.927 Test Loss: 0.226 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.47347903251648
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.674863338470459
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.938979148864746
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.282089948654175
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.307026147842407
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.953 Test Loss: 0.145 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.545998811721802
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.726059913635254
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 14.992169857025146
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 15.044230461120605
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 403332
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.390007257461548
Epoch: 1, Steps: 89 | Train Loss: 2.112 Vali Loss: 1.000 Vali Acc: 0.814 Test Loss: 1.000 Test Acc: 0.814
Validation loss decreased (inf --> -0.814057).  Saving model ...
Epoch: 2 cost time: 10.507715463638306
Epoch: 2, Steps: 89 | Train Loss: 0.503 Vali Loss: 0.329 Vali Acc: 0.926 Test Loss: 0.329 Test Acc: 0.926
Validation loss decreased (-0.814057 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 10.185735702514648
Epoch: 3, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.231 Vali Acc: 0.946 Test Loss: 0.231 Test Acc: 0.946
Validation loss decreased (-0.926181 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 7.3464295864105225
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.946377 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 12.314026832580566
Epoch: 5, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.361148118972778
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.208 Vali Acc: 0.934 Test Loss: 0.208 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.736659288406372
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.960305 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 14.027282953262329
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.600960493087769
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.505404233932495
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.73109769821167
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.184964895248413
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.470815658569336
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.165 Vali Acc: 0.945 Test Loss: 0.165 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 14.613820314407349
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.527611017227173
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.859800100326538
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.820131063461304
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 1231108
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.18140172958374
Epoch: 1, Steps: 89 | Train Loss: 2.190 Vali Loss: 1.051 Vali Acc: 0.802 Test Loss: 1.051 Test Acc: 0.802
Validation loss decreased (inf --> -0.801522).  Saving model ...
Epoch: 2 cost time: 10.29175591468811
Epoch: 2, Steps: 89 | Train Loss: 0.619 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
Validation loss decreased (-0.801522 --> -0.890665).  Saving model ...
Epoch: 3 cost time: 10.003762245178223
Epoch: 3, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.294 Vali Acc: 0.907 Test Loss: 0.294 Test Acc: 0.907
Validation loss decreased (-0.890665 --> -0.906682).  Saving model ...
Epoch: 4 cost time: 7.409255266189575
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
Validation loss decreased (-0.906682 --> -0.951252).  Saving model ...
Epoch: 5 cost time: 9.817626476287842
Epoch: 5, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
Validation loss decreased (-0.951252 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 9.602441787719727
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.86290168762207
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.953341 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 9.80378007888794
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.955 Test Loss: 0.134 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.769919633865356
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 10.881865739822388
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.948179960250854
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.686278581619263
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.971447 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 6.694025993347168
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.699750185012817
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.590822458267212
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 8.650111198425293
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.650613784790039
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.930539608001709
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.118258714675903
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.040254592895508
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.90447211265564
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.434396266937256
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.053127527236938
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.585563898086548
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.418 Vali Acc: 0.914 Test Loss: 0.418 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 10.754021406173706
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.189 Vali Acc: 0.947 Test Loss: 0.189 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 403332
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.615060329437256
Epoch: 1, Steps: 89 | Train Loss: 2.066 Vali Loss: 0.844 Vali Acc: 0.838 Test Loss: 0.844 Test Acc: 0.838
Validation loss decreased (inf --> -0.838432).  Saving model ...
Epoch: 2 cost time: 21.059088706970215
Epoch: 2, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.258 Vali Acc: 0.935 Test Loss: 0.258 Test Acc: 0.935
Validation loss decreased (-0.838432 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 19.822976112365723
Epoch: 3, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.934538 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 25.160600900650024
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.84928035736084
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.954037 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 26.089898586273193
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.384280681610107
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.60705018043518
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.897696256637573
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 23.324868202209473
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 20.797666311264038
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.1536545753479
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.34002375602722
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 25.45294213294983
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.055783987045288
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 21.27863073348999
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.78652048110962
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 23.0757577419281
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 24.373286962509155
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 24.287333726882935
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 644996
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.531462669372559
Epoch: 1, Steps: 89 | Train Loss: 2.179 Vali Loss: 1.058 Vali Acc: 0.747 Test Loss: 1.058 Test Acc: 0.747
Validation loss decreased (inf --> -0.747204).  Saving model ...
Epoch: 2 cost time: 13.932029962539673
Epoch: 2, Steps: 89 | Train Loss: 0.611 Vali Loss: 0.341 Vali Acc: 0.913 Test Loss: 0.341 Test Acc: 0.913
Validation loss decreased (-0.747204 --> -0.912949).  Saving model ...
Epoch: 3 cost time: 15.771997451782227
Epoch: 3, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.912949 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 17.145649909973145
Epoch: 4, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.187 Vali Acc: 0.942 Test Loss: 0.187 Test Acc: 0.942
Validation loss decreased (-0.926181 --> -0.942199).  Saving model ...
Epoch: 5 cost time: 16.47934865951538
Epoch: 5, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.942199 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 16.660329818725586
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.958912 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 16.263351678848267
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.32999849319458
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 17.15610432624817
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 17.81548285484314
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.340158939361572
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.781574010848999
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.819998979568481
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 16.251004934310913
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 15.88350510597229
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.521268367767334
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.407137870788574
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.636208057403564
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.330247640609741
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 16.882563829421997
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 21 cost time: 16.397918462753296
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 14.903691291809082
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 23 cost time: 13.736200332641602
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 13.356440782546997
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 11.820834159851074
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 15.677993535995483
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 16.252530336380005
Epoch: 27, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 16.178316593170166
Epoch: 28, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 14.506644010543823
Epoch: 29, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.418 Vali Acc: 0.907 Test Loss: 0.418 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 10.289473533630371
Epoch: 30, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 231044
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.948552131652832
Epoch: 1, Steps: 89 | Train Loss: 2.073 Vali Loss: 0.890 Vali Acc: 0.835 Test Loss: 0.890 Test Acc: 0.835
Validation loss decreased (inf --> -0.834949).  Saving model ...
Epoch: 2 cost time: 15.538264036178589
Epoch: 2, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.834949 --> -0.924788).  Saving model ...
Epoch: 3 cost time: 18.330655813217163
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.924788 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 17.275145769119263
Epoch: 4, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.943591 --> -0.949859).  Saving model ...
Epoch: 5 cost time: 17.713038682937622
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.949859 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 19.255103588104248
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.918932914733887
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.30079221725464
Epoch: 8, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.851467370986938
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.964 Test Loss: 0.108 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.785994529724121
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 16.376734018325806
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.124748706817627
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.24332284927368
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 18.925585746765137
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.686201333999634
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.435152769088745
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 17.24898052215576
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.876503944396973
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.97731614112854
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.979477643966675
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 644996
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.483556270599365
Epoch: 1, Steps: 89 | Train Loss: 2.182 Vali Loss: 1.079 Vali Acc: 0.743 Test Loss: 1.079 Test Acc: 0.743
Validation loss decreased (inf --> -0.743025).  Saving model ...
Epoch: 2 cost time: 11.675338983535767
Epoch: 2, Steps: 89 | Train Loss: 0.616 Vali Loss: 0.352 Vali Acc: 0.921 Test Loss: 0.352 Test Acc: 0.921
Validation loss decreased (-0.743025 --> -0.921306).  Saving model ...
Epoch: 3 cost time: 11.377746343612671
Epoch: 3, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
Validation loss decreased (-0.921306 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 10.832988262176514
Epoch: 4, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.932449 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 10.625850915908813
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.944288 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 9.861772775650024
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.954037 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 8.023561716079712
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.299214839935303
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.963091 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 11.605715274810791
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.993612289428711
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 10.41139006614685
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.6259765625
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.885687828063965
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.594947338104248
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 15 cost time: 9.993141412734985
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.582281827926636
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.964 Test Loss: 0.105 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.46799898147583
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 18 cost time: 8.303511619567871
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.744923114776611
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.798341989517212
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.954331398010254
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 22 cost time: 9.163350582122803
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.754011154174805
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.523119688034058
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.892491340637207
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 8.768426418304443
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.340723991394043
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 10.234541416168213
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 8.422064304351807
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 8.917292833328247
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.343 Vali Acc: 0.935 Test Loss: 0.343 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 231044
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.838359117507935
Epoch: 1, Steps: 89 | Train Loss: 2.120 Vali Loss: 0.955 Vali Acc: 0.822 Test Loss: 0.955 Test Acc: 0.822
Validation loss decreased (inf --> -0.821717).  Saving model ...
Epoch: 2 cost time: 10.694505453109741
Epoch: 2, Steps: 89 | Train Loss: 0.504 Vali Loss: 0.330 Vali Acc: 0.923 Test Loss: 0.330 Test Acc: 0.923
Validation loss decreased (-0.821717 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 7.057037353515625
Epoch: 3, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.923395 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 7.374301910400391
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.474231243133545
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.943591 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 9.29916524887085
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.4634950160980225
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.604817867279053
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.154 Vali Acc: 0.948 Test Loss: 0.154 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.796144247055054
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.488001346588135
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.961 Test Loss: 0.123 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961002).  Saving model ...
Epoch: 11 cost time: 10.74402642250061
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.953 Test Loss: 0.130 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.077927827835083
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.160031080245972
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.908008575439453
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.911274433135986
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.952 Test Loss: 0.140 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.820249795913696
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.808845281600952
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.189 Vali Acc: 0.945 Test Loss: 0.189 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.699416399002075
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.72114872932434
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.01961064338684
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 644996
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.623548269271851
Epoch: 1, Steps: 89 | Train Loss: 2.242 Vali Loss: 1.176 Vali Acc: 0.749 Test Loss: 1.176 Test Acc: 0.749
Validation loss decreased (inf --> -0.748595).  Saving model ...
Epoch: 2 cost time: 9.514502763748169
Epoch: 2, Steps: 89 | Train Loss: 0.701 Vali Loss: 0.404 Vali Acc: 0.904 Test Loss: 0.404 Test Acc: 0.904
Validation loss decreased (-0.748595 --> -0.903896).  Saving model ...
Epoch: 3 cost time: 8.92855978012085
Epoch: 3, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
Validation loss decreased (-0.903896 --> -0.931056).  Saving model ...
Epoch: 4 cost time: 7.575153112411499
Epoch: 4, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.931056 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 7.0785863399505615
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.940806 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 8.643401861190796
Epoch: 6, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.950555 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 8.70646619796753
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.234076261520386
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 6.592102527618408
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.956 Test Loss: 0.146 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.927808046340942
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.165193796157837
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.069534063339233
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 13 cost time: 6.826338529586792
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.352654933929443
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.960520505905151
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.229052543640137
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.606486558914185
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.945 Test Loss: 0.206 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.476110458374023
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.961 Test Loss: 0.123 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.029515743255615
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970055).  Saving model ...
Epoch: 20 cost time: 8.170444011688232
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 21 cost time: 8.146518468856812
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 4.940279483795166
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.895066738128662
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.750972509384155
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.659805536270142
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.978125333786011
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 8.0635404586792
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.706567049026489
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 8.867519617080688
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.226816177368164
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 231044
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.259462118148804
Epoch: 1, Steps: 89 | Train Loss: 2.398 Vali Loss: 1.400 Vali Acc: 0.820 Test Loss: 1.400 Test Acc: 0.820
Validation loss decreased (inf --> -0.819624).  Saving model ...
Epoch: 2 cost time: 29.450085163116455
Epoch: 2, Steps: 89 | Train Loss: 0.809 Vali Loss: 0.451 Vali Acc: 0.901 Test Loss: 0.451 Test Acc: 0.901
Validation loss decreased (-0.819624 --> -0.901110).  Saving model ...
Epoch: 3 cost time: 25.11729407310486
Epoch: 3, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.307 Vali Acc: 0.931 Test Loss: 0.307 Test Acc: 0.931
Validation loss decreased (-0.901110 --> -0.931055).  Saving model ...
Epoch: 4 cost time: 23.253926992416382
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.249 Vali Acc: 0.925 Test Loss: 0.249 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.743639707565308
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.197 Vali Acc: 0.939 Test Loss: 0.197 Test Acc: 0.939
Validation loss decreased (-0.931055 --> -0.939413).  Saving model ...
Epoch: 6 cost time: 30.073981761932373
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.939413 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 25.306740045547485
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 29.868894815444946
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.166 Vali Acc: 0.942 Test Loss: 0.166 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.870233297348022
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.955430 --> -0.956823).  Saving model ...
Epoch: 10 cost time: 30.33009147644043
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 26.42031693458557
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.956 Test Loss: 0.135 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 28.14350962638855
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.169044017791748
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 29.720065593719482
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.317 Vali Acc: 0.921 Test Loss: 0.317 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.814465522766113
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 25.14208745956421
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 28.969499826431274
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 26.58109951019287
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.961698 --> -0.963091).  Saving model ...
Epoch: 19 cost time: 26.817232131958008
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.963091 --> -0.970751).  Saving model ...
Epoch: 20 cost time: 26.042386293411255
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 23.889193296432495
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.966 Test Loss: 0.106 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 30.791555166244507
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 23.347703218460083
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 26.479248762130737
Epoch: 24, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 20.441335916519165
Epoch: 25, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 25.56205439567566
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 20.898930549621582
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 23.380685567855835
Epoch: 28, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 21.336201667785645
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 21.635468244552612
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1202444
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.662606000900269
Epoch: 1, Steps: 89 | Train Loss: 2.462 Vali Loss: 1.564 Vali Acc: 0.729 Test Loss: 1.564 Test Acc: 0.729
Validation loss decreased (inf --> -0.729093).  Saving model ...
Epoch: 2 cost time: 14.230559825897217
Epoch: 2, Steps: 89 | Train Loss: 0.956 Vali Loss: 0.519 Vali Acc: 0.907 Test Loss: 0.519 Test Acc: 0.907
Validation loss decreased (-0.729093 --> -0.906680).  Saving model ...
Epoch: 3 cost time: 12.216730833053589
Epoch: 3, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.277 Vali Acc: 0.945 Test Loss: 0.277 Test Acc: 0.945
Validation loss decreased (-0.906680 --> -0.944983).  Saving model ...
Epoch: 4 cost time: 12.11535382270813
Epoch: 4, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
Validation loss decreased (-0.944983 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 14.346600770950317
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 13.349878072738647
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.400930643081665
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.200174808502197
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.960305 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 12.152618169784546
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.117902517318726
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 14.259962320327759
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 12.681232452392578
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.137292623519897
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 14 cost time: 12.793438911437988
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 12.208762407302856
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.386494159698486
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.640638589859009
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.956 Test Loss: 0.145 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 13.65041184425354
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 14.31410264968872
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.617203950881958
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 12.255970001220703
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.100205659866333
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 12.270982265472412
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 13.730303525924683
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 13.761608123779297
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.82821774482727
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 14.034111261367798
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.884408473968506
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 12.923640012741089
Epoch: 29, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 14.850983381271362
Epoch: 30, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 374476
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.158982038497925
Epoch: 1, Steps: 89 | Train Loss: 2.394 Vali Loss: 1.409 Vali Acc: 0.830 Test Loss: 1.409 Test Acc: 0.830
Validation loss decreased (inf --> -0.830069).  Saving model ...
Epoch: 2 cost time: 17.07765007019043
Epoch: 2, Steps: 89 | Train Loss: 0.803 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.830069 --> -0.900413).  Saving model ...
Epoch: 3 cost time: 14.046627521514893
Epoch: 3, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.278 Vali Acc: 0.938 Test Loss: 0.278 Test Acc: 0.938
Validation loss decreased (-0.900413 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 16.983714818954468
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.253 Vali Acc: 0.932 Test Loss: 0.253 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.499948024749756
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
Validation loss decreased (-0.938020 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 14.693897724151611
Epoch: 6, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.209 Vali Acc: 0.939 Test Loss: 0.209 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.117490530014038
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.237117767333984
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
Validation loss decreased (-0.951252 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 14.076507091522217
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.958216 --> -0.963787).  Saving model ...
Epoch: 10 cost time: 14.759261846542358
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.138 Vali Acc: 0.955 Test Loss: 0.138 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.7148756980896
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.963787 --> -0.965180).  Saving model ...
Epoch: 12 cost time: 15.170551300048828
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.878805160522461
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.452681303024292
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.284096240997314
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 16 cost time: 15.917633533477783
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.770272970199585
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.961 Test Loss: 0.119 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.054556846618652
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.122690200805664
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.41254472732544
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.861157655715942
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 15.799170732498169
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 13.470097780227661
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.32604694366455
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 13.693336725234985
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 1202444
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.41159725189209
Epoch: 1, Steps: 89 | Train Loss: 2.458 Vali Loss: 1.571 Vali Acc: 0.728 Test Loss: 1.571 Test Acc: 0.728
Validation loss decreased (inf --> -0.728397).  Saving model ...
Epoch: 2 cost time: 7.69133996963501
Epoch: 2, Steps: 89 | Train Loss: 0.959 Vali Loss: 0.533 Vali Acc: 0.897 Test Loss: 0.533 Test Acc: 0.897
Validation loss decreased (-0.728397 --> -0.896931).  Saving model ...
Epoch: 3 cost time: 8.554299592971802
Epoch: 3, Steps: 89 | Train Loss: 0.371 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.896931 --> -0.944287).  Saving model ...
Epoch: 4 cost time: 8.329559564590454
Epoch: 4, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
Validation loss decreased (-0.944287 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 7.853696823120117
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.200 Vali Acc: 0.947 Test Loss: 0.200 Test Acc: 0.947
Validation loss decreased (-0.945680 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 9.951096296310425
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.56553053855896
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.947073 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 9.682371854782104
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 7.8713579177856445
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.961001 --> -0.965180).  Saving model ...
Epoch: 10 cost time: 10.127506494522095
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 8.034599542617798
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.260606050491333
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.776579141616821
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 8.33209490776062
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.964 Test Loss: 0.122 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.778544664382935
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.663024187088013
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.63217043876648
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.288254737854004
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.76164436340332
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.4417359828948975
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.51130723953247
Epoch: 21, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.140 Vali Acc: 0.952 Test Loss: 0.140 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.747318267822266
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.506976127624512
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 374476
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.317430973052979
Epoch: 1, Steps: 89 | Train Loss: 2.353 Vali Loss: 1.518 Vali Acc: 0.801 Test Loss: 1.518 Test Acc: 0.801
Validation loss decreased (inf --> -0.800820).  Saving model ...
Epoch: 2 cost time: 7.7479448318481445
Epoch: 2, Steps: 89 | Train Loss: 0.802 Vali Loss: 0.657 Vali Acc: 0.866 Test Loss: 0.657 Test Acc: 0.866
Validation loss decreased (-0.800820 --> -0.866289).  Saving model ...
Epoch: 3 cost time: 8.199799060821533
Epoch: 3, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
Validation loss decreased (-0.866289 --> -0.878129).  Saving model ...
Epoch: 4 cost time: 7.696159362792969
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.339 Vali Acc: 0.916 Test Loss: 0.339 Test Acc: 0.916
Validation loss decreased (-0.878129 --> -0.915735).  Saving model ...
Epoch: 5 cost time: 6.863678455352783
Epoch: 5, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.266 Vali Acc: 0.932 Test Loss: 0.266 Test Acc: 0.932
Validation loss decreased (-0.915735 --> -0.932449).  Saving model ...
Epoch: 6 cost time: 5.799166440963745
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.278 Vali Acc: 0.920 Test Loss: 0.278 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.674421310424805
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.932449 --> -0.940806).  Saving model ...
Epoch: 8 cost time: 10.45247220993042
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.220 Vali Acc: 0.942 Test Loss: 0.220 Test Acc: 0.942
Validation loss decreased (-0.940806 --> -0.941502).  Saving model ...
Epoch: 9 cost time: 9.757547855377197
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.941502 --> -0.949859).  Saving model ...
Epoch: 10 cost time: 9.934338808059692
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.272643566131592
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.247 Vali Acc: 0.924 Test Loss: 0.247 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.365142345428467
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.32605266571045
Epoch: 13, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.186 Vali Acc: 0.942 Test Loss: 0.186 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.869261741638184
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.985719442367554
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.160884857177734
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.319 Vali Acc: 0.916 Test Loss: 0.319 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.472012996673584
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.144 Vali Acc: 0.953 Test Loss: 0.144 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.953341).  Saving model ...
Epoch: 18 cost time: 8.697198867797852
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.835715770721436
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.259 Vali Acc: 0.920 Test Loss: 0.259 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.15102505683899
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
Validation loss decreased (-0.953341 --> -0.954037).  Saving model ...
Epoch: 21 cost time: 10.431865930557251
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.199138402938843
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.394039154052734
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.509789228439331
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.945 Test Loss: 0.200 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.352656364440918
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.232 Vali Acc: 0.931 Test Loss: 0.232 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.786562442779541
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 10.27161169052124
Epoch: 27, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.450 Vali Acc: 0.882 Test Loss: 0.450 Test Acc: 0.882
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.168452739715576
Epoch: 28, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.177 Vali Acc: 0.940 Test Loss: 0.177 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 10.06144404411316
Epoch: 29, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.6001455783844
Epoch: 30, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 1202444
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.294261693954468
Epoch: 1, Steps: 89 | Train Loss: 2.419 Vali Loss: 1.629 Vali Acc: 0.731 Test Loss: 1.629 Test Acc: 0.731
Validation loss decreased (inf --> -0.730485).  Saving model ...
Epoch: 2 cost time: 8.511804103851318
Epoch: 2, Steps: 89 | Train Loss: 0.942 Vali Loss: 0.589 Vali Acc: 0.903 Test Loss: 0.589 Test Acc: 0.903
Validation loss decreased (-0.730485 --> -0.903197).  Saving model ...
Epoch: 3 cost time: 7.9655139446258545
Epoch: 3, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.388 Vali Acc: 0.921 Test Loss: 0.388 Test Acc: 0.921
Validation loss decreased (-0.903197 --> -0.920609).  Saving model ...
Epoch: 4 cost time: 8.109010934829712
Epoch: 4, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.283 Vali Acc: 0.931 Test Loss: 0.283 Test Acc: 0.931
Validation loss decreased (-0.920609 --> -0.931056).  Saving model ...
Epoch: 5 cost time: 7.196375131607056
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.249 Vali Acc: 0.929 Test Loss: 0.249 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.921705484390259
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.236 Vali Acc: 0.939 Test Loss: 0.236 Test Acc: 0.939
Validation loss decreased (-0.931056 --> -0.939413).  Saving model ...
Epoch: 7 cost time: 7.054110765457153
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.319022178649902
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.046710729598999
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.980976819992065
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.231 Vali Acc: 0.929 Test Loss: 0.231 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.094701051712036
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.939413 --> -0.947770).  Saving model ...
Epoch: 12 cost time: 7.004122018814087
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.996161699295044
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.939 Test Loss: 0.209 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.846404314041138
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.974438190460205
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.944308042526245
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.939 Test Loss: 0.200 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.328233242034912
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.226871490478516
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.947770 --> -0.951252).  Saving model ...
Epoch: 19 cost time: 6.864075660705566
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.162283182144165
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.63598108291626
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.920550346374512
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.891517162322998
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.951252 --> -0.959608).  Saving model ...
Epoch: 24 cost time: 8.091845512390137
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.959608 --> -0.959608).  Saving model ...
Epoch: 25 cost time: 6.910486698150635
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.849737167358398
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.959608 --> -0.970055).  Saving model ...
Epoch: 27 cost time: 6.596399307250977
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.705845832824707
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 7.829991340637207
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 8.269734144210815
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 374476
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.459852695465088
Epoch: 1, Steps: 89 | Train Loss: 2.473 Vali Loss: 1.559 Vali Acc: 0.742 Test Loss: 1.559 Test Acc: 0.742
Validation loss decreased (inf --> -0.742324).  Saving model ...
Epoch: 2 cost time: 14.700520753860474
Epoch: 2, Steps: 89 | Train Loss: 0.973 Vali Loss: 0.529 Vali Acc: 0.892 Test Loss: 0.529 Test Acc: 0.892
Validation loss decreased (-0.742324 --> -0.892056).  Saving model ...
Epoch: 3 cost time: 17.228752851486206
Epoch: 3, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.892056 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 17.191879987716675
Epoch: 4, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
Validation loss decreased (-0.926181 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 15.315536975860596
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 14.499569416046143
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.632422924041748
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.962394 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 17.045772552490234
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.693912506103516
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 14.346664428710938
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.429465293884277
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 12 cost time: 17.785648822784424
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.967269).  Saving model ...
Epoch: 13 cost time: 16.97428250312805
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.961 Test Loss: 0.118 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.633714199066162
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.970751).  Saving model ...
Epoch: 15 cost time: 14.917611598968506
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.963 Test Loss: 0.104 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.96965742111206
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.955 Test Loss: 0.138 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.093356609344482
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 18 cost time: 14.698577404022217
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 19 cost time: 14.48066782951355
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 20 cost time: 17.38902497291565
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 21 cost time: 17.001576900482178
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 14.914548397064209
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 15.067689657211304
Epoch: 23, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 18.10755681991577
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 17.252345085144043
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 15.906780481338501
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.809760808944702
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 15.563479900360107
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 16.97167658805847
Epoch: 29, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 16.933269739151
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 615948
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.602155923843384
Epoch: 1, Steps: 89 | Train Loss: 2.453 Vali Loss: 1.589 Vali Acc: 0.767 Test Loss: 1.589 Test Acc: 0.767
Validation loss decreased (inf --> -0.767394).  Saving model ...
Epoch: 2 cost time: 9.828865051269531
Epoch: 2, Steps: 89 | Train Loss: 0.979 Vali Loss: 0.562 Vali Acc: 0.878 Test Loss: 0.562 Test Acc: 0.878
Validation loss decreased (-0.767394 --> -0.878128).  Saving model ...
Epoch: 3 cost time: 6.21561598777771
Epoch: 3, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.322 Vali Acc: 0.921 Test Loss: 0.322 Test Acc: 0.921
Validation loss decreased (-0.878128 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 7.868801116943359
Epoch: 4, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
Validation loss decreased (-0.920610 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 10.171446084976196
Epoch: 5, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.957765102386475
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.945680 --> -0.951252).  Saving model ...
Epoch: 7 cost time: 7.9206321239471436
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
Validation loss decreased (-0.951252 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 10.08633804321289
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 8.446062564849854
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 7.704613447189331
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 10.01641583442688
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.876381397247314
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.827796936035156
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.39615774154663
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.946377277374268
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 16 cost time: 8.094085216522217
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.173 Vali Acc: 0.942 Test Loss: 0.173 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.287922859191895
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 10.359052181243896
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.072412252426147
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.965975046157837
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.206161975860596
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 22 cost time: 8.9339439868927
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 23 cost time: 8.256340026855469
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.318464279174805
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.133336544036865
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.878572940826416
Epoch: 26, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.466527462005615
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.018217086791992
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 8.113637447357178
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 8.126797437667847
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 201932
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.38655948638916
Epoch: 1, Steps: 89 | Train Loss: 2.474 Vali Loss: 1.583 Vali Acc: 0.748 Test Loss: 1.583 Test Acc: 0.748
Validation loss decreased (inf --> -0.747895).  Saving model ...
Epoch: 2 cost time: 9.55251693725586
Epoch: 2, Steps: 89 | Train Loss: 0.982 Vali Loss: 0.553 Vali Acc: 0.893 Test Loss: 0.553 Test Acc: 0.893
Validation loss decreased (-0.747895 --> -0.892752).  Saving model ...
Epoch: 3 cost time: 11.572630405426025
Epoch: 3, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.892752 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 9.80490517616272
Epoch: 4, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.226 Vali Acc: 0.947 Test Loss: 0.226 Test Acc: 0.947
Validation loss decreased (-0.924788 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 9.491090059280396
Epoch: 5, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.947073 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 12.398807764053345
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 11.123856544494629
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 8.998697519302368
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.734881401062012
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 11.642282485961914
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.144 Vali Acc: 0.951 Test Loss: 0.144 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.061646938323975
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 10.582804441452026
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.31921672821045
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.586472272872925
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.889600038528442
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.974775552749634
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 17 cost time: 9.815083742141724
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.414469242095947
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 10.582486391067505
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.61984133720398
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 12.634547472000122
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 12.264102697372437
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.663585186004639
Epoch: 23, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 10.721892833709717
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 12.771085023880005
Epoch: 25, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.760161638259888
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 10.257566213607788
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 10.654314994812012
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 615948
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.199481725692749
Epoch: 1, Steps: 89 | Train Loss: 2.452 Vali Loss: 1.591 Vali Acc: 0.779 Test Loss: 1.591 Test Acc: 0.779
Validation loss decreased (inf --> -0.779232).  Saving model ...
Epoch: 2 cost time: 7.426048517227173
Epoch: 2, Steps: 89 | Train Loss: 0.978 Vali Loss: 0.566 Vali Acc: 0.877 Test Loss: 0.566 Test Acc: 0.877
Validation loss decreased (-0.779232 --> -0.877432).  Saving model ...
Epoch: 3 cost time: 7.38015604019165
Epoch: 3, Steps: 89 | Train Loss: 0.400 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
Validation loss decreased (-0.877432 --> -0.912949).  Saving model ...
Epoch: 4 cost time: 8.743942260742188
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.265 Vali Acc: 0.931 Test Loss: 0.265 Test Acc: 0.931
Validation loss decreased (-0.912949 --> -0.931056).  Saving model ...
Epoch: 5 cost time: 8.702160596847534
Epoch: 5, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
Validation loss decreased (-0.931056 --> -0.938020).  Saving model ...
Epoch: 6 cost time: 7.611693382263184
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.189 Vali Acc: 0.947 Test Loss: 0.189 Test Acc: 0.947
Validation loss decreased (-0.938020 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 7.46129298210144
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
Validation loss decreased (-0.947073 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 8.850744247436523
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 8.748081684112549
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 7.37665867805481
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.318763256072998
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.686765432357788
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.823087453842163
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.50241756439209
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.188183307647705
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 8.091052293777466
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.804999351501465
Epoch: 17, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.627271890640259
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.4146130084991455
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.440559387207031
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.861387491226196
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.736963987350464
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.374729156494141
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.975626).  Saving model ...
Epoch: 24 cost time: 7.620080947875977
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.75100302696228
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.669853210449219
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.3233559131622314
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.975626).  Saving model ...
Epoch: 28 cost time: 7.167482137680054
Epoch: 28, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 8.460422992706299
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 30 cost time: 8.826259136199951
Epoch: 30, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 201932
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.28580641746521
Epoch: 1, Steps: 89 | Train Loss: 2.452 Vali Loss: 1.627 Vali Acc: 0.740 Test Loss: 1.627 Test Acc: 0.740
Validation loss decreased (inf --> -0.739538).  Saving model ...
Epoch: 2 cost time: 6.990540504455566
Epoch: 2, Steps: 89 | Train Loss: 0.963 Vali Loss: 0.725 Vali Acc: 0.848 Test Loss: 0.725 Test Acc: 0.848
Validation loss decreased (-0.739538 --> -0.848182).  Saving model ...
Epoch: 3 cost time: 8.101215124130249
Epoch: 3, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.535 Vali Acc: 0.860 Test Loss: 0.535 Test Acc: 0.860
Validation loss decreased (-0.848182 --> -0.860023).  Saving model ...
Epoch: 4 cost time: 8.212667465209961
Epoch: 4, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
Validation loss decreased (-0.860023 --> -0.894147).  Saving model ...
Epoch: 5 cost time: 6.737445116043091
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.408515214920044
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.304 Vali Acc: 0.904 Test Loss: 0.304 Test Acc: 0.904
Validation loss decreased (-0.894147 --> -0.903897).  Saving model ...
Epoch: 7 cost time: 6.892171382904053
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.903897 --> -0.905986).  Saving model ...
Epoch: 8 cost time: 8.094808578491211
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.284 Vali Acc: 0.907 Test Loss: 0.284 Test Acc: 0.907
Validation loss decreased (-0.905986 --> -0.906682).  Saving model ...
Epoch: 9 cost time: 8.0572030544281
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
Validation loss decreased (-0.906682 --> -0.944984).  Saving model ...
Epoch: 10 cost time: 7.029406309127808
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.923 Test Loss: 0.248 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.9913413524627686
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.233 Vali Acc: 0.927 Test Loss: 0.233 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.355250835418701
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.30877947807312
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.329466342926025
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.148899078369141
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.278 Vali Acc: 0.915 Test Loss: 0.278 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.091207504272461
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.343871116638184
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.330 Vali Acc: 0.886 Test Loss: 0.330 Test Acc: 0.886
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.239696979522705
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.232 Vali Acc: 0.927 Test Loss: 0.232 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.9765541553497314
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.236 Vali Acc: 0.927 Test Loss: 0.236 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9449860724233984
model parameter : 615948
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.014629125595093
Epoch: 1, Steps: 89 | Train Loss: 2.426 Vali Loss: 1.690 Vali Acc: 0.742 Test Loss: 1.690 Test Acc: 0.742
Validation loss decreased (inf --> -0.741627).  Saving model ...
Epoch: 2 cost time: 6.63807487487793
Epoch: 2, Steps: 89 | Train Loss: 1.011 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
Validation loss decreased (-0.741627 --> -0.855843).  Saving model ...
Epoch: 3 cost time: 6.582068204879761
Epoch: 3, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.426 Vali Acc: 0.881 Test Loss: 0.426 Test Acc: 0.881
Validation loss decreased (-0.855843 --> -0.880915).  Saving model ...
Epoch: 4 cost time: 5.746581554412842
Epoch: 4, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.315 Vali Acc: 0.914 Test Loss: 0.315 Test Acc: 0.914
Validation loss decreased (-0.880915 --> -0.914342).  Saving model ...
Epoch: 5 cost time: 5.5011749267578125
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.295 Vali Acc: 0.906 Test Loss: 0.295 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.657799005508423
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
Validation loss decreased (-0.914342 --> -0.915039).  Saving model ...
Epoch: 7 cost time: 6.447374105453491
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.247 Vali Acc: 0.929 Test Loss: 0.247 Test Acc: 0.929
Validation loss decreased (-0.915039 --> -0.928967).  Saving model ...
Epoch: 8 cost time: 6.631062269210815
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.243 Vali Acc: 0.920 Test Loss: 0.243 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.713698625564575
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.229 Vali Acc: 0.932 Test Loss: 0.229 Test Acc: 0.932
Validation loss decreased (-0.928967 --> -0.932449).  Saving model ...
Epoch: 10 cost time: 5.71561074256897
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.932449 --> -0.943591).  Saving model ...
Epoch: 11 cost time: 5.590887784957886
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.916 Test Loss: 0.263 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.5622398853302
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.346 Vali Acc: 0.883 Test Loss: 0.346 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.740229606628418
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.213 Vali Acc: 0.929 Test Loss: 0.213 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.779444217681885
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.655594348907471
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.746122360229492
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.938 Test Loss: 0.214 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.301141262054443
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.664053678512573
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.940 Test Loss: 0.193 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.291452646255493
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
Validation loss decreased (-0.943591 --> -0.946377).  Saving model ...
Epoch: 20 cost time: 4.212036609649658
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.883989334106445
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.946377 --> -0.947770).  Saving model ...
Epoch: 22 cost time: 4.5826122760772705
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.639653444290161
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.867408275604248
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.405 Vali Acc: 0.910 Test Loss: 0.405 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.684857368469238
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.338 Vali Acc: 0.905 Test Loss: 0.338 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.395642995834351
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.277 Vali Acc: 0.907 Test Loss: 0.277 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.872107744216919
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.275 Vali Acc: 0.921 Test Loss: 0.275 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.64816427230835
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.923 Test Loss: 0.252 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.467061281204224
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.934 Test Loss: 0.228 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.353825569152832
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9477715877437326
model parameter : 201932
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.891344547271729
Epoch: 1, Steps: 89 | Train Loss: 2.524 Vali Loss: 1.663 Vali Acc: 0.731 Test Loss: 1.663 Test Acc: 0.731
Validation loss decreased (inf --> -0.730485).  Saving model ...
Epoch: 2 cost time: 13.040978193283081
Epoch: 2, Steps: 89 | Train Loss: 0.994 Vali Loss: 0.530 Vali Acc: 0.892 Test Loss: 0.530 Test Acc: 0.892
Validation loss decreased (-0.730485 --> -0.892056).  Saving model ...
Epoch: 3 cost time: 10.245495319366455
Epoch: 3, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.326 Vali Acc: 0.921 Test Loss: 0.326 Test Acc: 0.921
Validation loss decreased (-0.892056 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 11.903980016708374
Epoch: 4, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.221 Vali Acc: 0.942 Test Loss: 0.221 Test Acc: 0.942
Validation loss decreased (-0.921306 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 11.166913747787476
Epoch: 5, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.941502 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 11.327960014343262
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.942895 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 12.305418014526367
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.440951347351074
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 12.933609008789062
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.961698 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 10.44232726097107
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.932995080947876
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.963 Test Loss: 0.110 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.293208837509155
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.961686849594116
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.495685815811157
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.228342771530151
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.462620735168457
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.645711898803711
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973536 --> -0.977018).  Saving model ...
Epoch: 18 cost time: 10.970296144485474
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.8368079662323
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.816898345947266
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 10.9299156665802
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.235814332962036
Epoch: 22, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 10.606495380401611
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.950415134429932
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 10.33042049407959
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 8.68796181678772
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 27 cost time: 13.223915815353394
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.941570043563843
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 12.671173810958862
Epoch: 29, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 12.90536904335022
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 322700
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.296953201293945
Epoch: 1, Steps: 89 | Train Loss: 2.510 Vali Loss: 1.633 Vali Acc: 0.751 Test Loss: 1.633 Test Acc: 0.751
Validation loss decreased (inf --> -0.751376).  Saving model ...
Epoch: 2 cost time: 8.578457355499268
Epoch: 2, Steps: 89 | Train Loss: 1.010 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.751376 --> -0.875342).  Saving model ...
Epoch: 3 cost time: 9.812472343444824
Epoch: 3, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.352 Vali Acc: 0.917 Test Loss: 0.352 Test Acc: 0.917
Validation loss decreased (-0.875342 --> -0.917127).  Saving model ...
Epoch: 4 cost time: 8.684705972671509
Epoch: 4, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.250 Vali Acc: 0.939 Test Loss: 0.250 Test Acc: 0.939
Validation loss decreased (-0.917127 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 8.383706331253052
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.939413 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 9.774222373962402
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.954037 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 8.02006459236145
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.956126 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 9.590025186538696
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.197922229766846
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.129611492156982
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 9.823619365692139
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.071388721466064
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.660646915435791
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.22354507446289
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 15 cost time: 8.439969539642334
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.291979789733887
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 8.085248231887817
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.768109560012817
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.185356140136719
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.460524559020996
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.819378614425659
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.952179908752441
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 23 cost time: 8.841924667358398
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.22494912147522
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.460384368896484
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.21407437324524
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.582929611206055
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.149752855300903
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.793231010437012
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 8.288230419158936
Epoch: 30, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 115660
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.86660647392273
Epoch: 1, Steps: 89 | Train Loss: 2.523 Vali Loss: 1.666 Vali Acc: 0.725 Test Loss: 1.666 Test Acc: 0.725
Validation loss decreased (inf --> -0.724914).  Saving model ...
Epoch: 2 cost time: 8.93956708908081
Epoch: 2, Steps: 89 | Train Loss: 1.000 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
Validation loss decreased (-0.724914 --> -0.888574).  Saving model ...
Epoch: 3 cost time: 7.5439324378967285
Epoch: 3, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.343 Vali Acc: 0.912 Test Loss: 0.343 Test Acc: 0.912
Validation loss decreased (-0.888574 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 8.995005369186401
Epoch: 4, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
Validation loss decreased (-0.912253 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 7.408438682556152
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.69383978843689
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.945680 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 8.270967483520508
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 7.084709167480469
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.962394 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 8.895643711090088
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.266195058822632
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.965180 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 8.303617238998413
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 8.852981328964233
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.219649076461792
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.73528265953064
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.499606132507324
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.306893825531006
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.583375453948975
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.235854148864746
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.648898124694824
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.21444845199585
Epoch: 20, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.584859371185303
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 322700
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.632708787918091
Epoch: 1, Steps: 89 | Train Loss: 2.521 Vali Loss: 1.653 Vali Acc: 0.756 Test Loss: 1.653 Test Acc: 0.756
Validation loss decreased (inf --> -0.756251).  Saving model ...
Epoch: 2 cost time: 5.34092378616333
Epoch: 2, Steps: 89 | Train Loss: 1.030 Vali Loss: 0.631 Vali Acc: 0.876 Test Loss: 0.631 Test Acc: 0.876
Validation loss decreased (-0.756251 --> -0.876038).  Saving model ...
Epoch: 3 cost time: 6.135260581970215
Epoch: 3, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.369 Vali Acc: 0.913 Test Loss: 0.369 Test Acc: 0.913
Validation loss decreased (-0.876038 --> -0.912949).  Saving model ...
Epoch: 4 cost time: 5.163459300994873
Epoch: 4, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.255 Vali Acc: 0.940 Test Loss: 0.255 Test Acc: 0.940
Validation loss decreased (-0.912949 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 6.208194017410278
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.940109 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 4.973465442657471
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 6.895831108093262
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 5.912471532821655
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.960305 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 6.79004693031311
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.78575587272644
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.082244634628296
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 5.955103397369385
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 6.423593759536743
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.455316066741943
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.949023008346558
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.681030988693237
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.974233).  Saving model ...
Epoch: 17 cost time: 5.899470806121826
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.00743556022644
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.770659923553467
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.815472602844238
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.273392915725708
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.340703964233398
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.3482584953308105
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.415374994277954
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.280489683151245
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.222557544708252
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 115660
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.434489727020264
Epoch: 1, Steps: 89 | Train Loss: 2.515 Vali Loss: 1.691 Vali Acc: 0.715 Test Loss: 1.691 Test Acc: 0.715
Validation loss decreased (inf --> -0.715164).  Saving model ...
Epoch: 2 cost time: 8.103027582168579
Epoch: 2, Steps: 89 | Train Loss: 0.983 Vali Loss: 0.638 Vali Acc: 0.877 Test Loss: 0.638 Test Acc: 0.877
Validation loss decreased (-0.715164 --> -0.877431).  Saving model ...
Epoch: 3 cost time: 8.67267394065857
Epoch: 3, Steps: 89 | Train Loss: 0.386 Vali Loss: 0.403 Vali Acc: 0.917 Test Loss: 0.403 Test Acc: 0.917
Validation loss decreased (-0.877431 --> -0.917127).  Saving model ...
Epoch: 4 cost time: 7.398186922073364
Epoch: 4, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.314 Vali Acc: 0.924 Test Loss: 0.314 Test Acc: 0.924
Validation loss decreased (-0.917127 --> -0.924092).  Saving model ...
Epoch: 5 cost time: 6.064565181732178
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.924092 --> -0.936627).  Saving model ...
Epoch: 6 cost time: 6.560373544692993
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.936627 --> -0.944287).  Saving model ...
Epoch: 7 cost time: 8.379031896591187
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.236 Vali Acc: 0.934 Test Loss: 0.236 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.723577737808228
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.063059091567993
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.024723529815674
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.231 Vali Acc: 0.938 Test Loss: 0.231 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.4380505084991455
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.239 Vali Acc: 0.932 Test Loss: 0.239 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.326241254806519
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.939 Test Loss: 0.210 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.486350774765015
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.944287 --> -0.954037).  Saving model ...
Epoch: 14 cost time: 6.4813690185546875
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.260 Vali Acc: 0.928 Test Loss: 0.260 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.334619998931885
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.385408878326416
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.665160655975342
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.523425817489624
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.923 Test Loss: 0.264 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.409480094909668
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.202759265899658
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.945 Test Loss: 0.197 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.066292762756348
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.22859787940979
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.916 Test Loss: 0.273 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.127872943878174
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.295 Vali Acc: 0.917 Test Loss: 0.295 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 322700
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.864006519317627
Epoch: 1, Steps: 89 | Train Loss: 2.508 Vali Loss: 1.691 Vali Acc: 0.754 Test Loss: 1.691 Test Acc: 0.754
Validation loss decreased (inf --> -0.754161).  Saving model ...
Epoch: 2 cost time: 7.507079362869263
Epoch: 2, Steps: 89 | Train Loss: 1.051 Vali Loss: 0.701 Vali Acc: 0.852 Test Loss: 0.701 Test Acc: 0.852
Validation loss decreased (-0.754161 --> -0.852361).  Saving model ...
Epoch: 3 cost time: 6.99390172958374
Epoch: 3, Steps: 89 | Train Loss: 0.473 Vali Loss: 0.428 Vali Acc: 0.899 Test Loss: 0.428 Test Acc: 0.899
Validation loss decreased (-0.852361 --> -0.899021).  Saving model ...
Epoch: 4 cost time: 5.31597113609314
Epoch: 4, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.299 Vali Acc: 0.926 Test Loss: 0.299 Test Acc: 0.926
Validation loss decreased (-0.899021 --> -0.926181).  Saving model ...
Epoch: 5 cost time: 5.593480348587036
Epoch: 5, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.926181 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 5.831745862960815
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.954734).  Saving model ...
Epoch: 7 cost time: 7.100882530212402
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 6.584745407104492
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.6181111335754395
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 5.778732538223267
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 11 cost time: 5.545639514923096
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 7.43305230140686
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.710091829299927
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 5.664215803146362
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.061452388763428
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.27919340133667
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.303898334503174
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.707278728485107
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.093894958496094
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.4186108112335205
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.504886627197266
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.116124629974365
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.6509318351745605
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 115660
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 146.75593423843384
Epoch: 1, Steps: 89 | Train Loss: 0.936 Vali Loss: 0.249 Vali Acc: 0.929 Test Loss: 0.249 Test Acc: 0.929
Validation loss decreased (inf --> -0.928967).  Saving model ...
Epoch: 2 cost time: 145.91891837120056
Epoch: 2, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 140.6421127319336
Epoch: 3, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.469 Vali Acc: 0.871 Test Loss: 0.469 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 140.94009351730347
Epoch: 4, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.330 Vali Acc: 0.916 Test Loss: 0.330 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 139.58464074134827
Epoch: 5, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.679 Vali Acc: 0.876 Test Loss: 0.679 Test Acc: 0.876
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 140.17085695266724
Epoch: 6, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.275 Vali Acc: 0.951 Test Loss: 0.275 Test Acc: 0.951
Validation loss decreased (-0.928967 --> -0.951251).  Saving model ...
Epoch: 7 cost time: 137.59974837303162
Epoch: 7, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.321 Vali Acc: 0.945 Test Loss: 0.321 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 126.8154776096344
Epoch: 8, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 123.60898327827454
Epoch: 9, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.367 Vali Acc: 0.942 Test Loss: 0.367 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 122.67645454406738
Epoch: 10, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.443 Vali Acc: 0.934 Test Loss: 0.443 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 121.12075400352478
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.354 Vali Acc: 0.956 Test Loss: 0.354 Test Acc: 0.956
Validation loss decreased (-0.951251 --> -0.956125).  Saving model ...
Epoch: 12 cost time: 125.05190229415894
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.521 Vali Acc: 0.932 Test Loss: 0.521 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 129.27370643615723
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.961 Test Loss: 0.244 Test Acc: 0.961
Validation loss decreased (-0.956125 --> -0.961000).  Saving model ...
Epoch: 14 cost time: 136.56504487991333
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.399 Vali Acc: 0.939 Test Loss: 0.399 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 140.62618350982666
Epoch: 15, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 138.05585646629333
Epoch: 16, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.601 Vali Acc: 0.930 Test Loss: 0.601 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 134.3008689880371
Epoch: 17, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.423 Vali Acc: 0.949 Test Loss: 0.423 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 140.36599922180176
Epoch: 18, Steps: 89 | Train Loss: 0.136 Vali Loss: 1.865 Vali Acc: 0.918 Test Loss: 1.865 Test Acc: 0.918
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 139.40650916099548
Epoch: 19, Steps: 89 | Train Loss: 0.079 Vali Loss: 1.558 Vali Acc: 0.921 Test Loss: 1.558 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 115.32339119911194
Epoch: 20, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.389 Vali Acc: 0.960 Test Loss: 0.389 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 120.71838235855103
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.882 Vali Acc: 0.911 Test Loss: 0.882 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 117.51698732376099
Epoch: 22, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.446 Vali Acc: 0.946 Test Loss: 0.446 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 123.83792924880981
Epoch: 23, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.517 Vali Acc: 0.953 Test Loss: 0.517 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 56704660
model size : 218.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 46.22423815727234
Epoch: 1, Steps: 89 | Train Loss: 0.963 Vali Loss: 0.294 Vali Acc: 0.902 Test Loss: 0.294 Test Acc: 0.902
Validation loss decreased (inf --> -0.901808).  Saving model ...
Epoch: 2 cost time: 46.68972206115723
Epoch: 2, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.901808 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 44.47834849357605
Epoch: 3, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.251 Vali Acc: 0.927 Test Loss: 0.251 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.368072271347046
Epoch: 4, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.343 Vali Acc: 0.908 Test Loss: 0.343 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 46.02020859718323
Epoch: 5, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 42.84819436073303
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.310 Vali Acc: 0.951 Test Loss: 0.310 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 43.5459680557251
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.379 Vali Acc: 0.935 Test Loss: 0.379 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 43.47605061531067
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.488 Vali Acc: 0.926 Test Loss: 0.488 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 41.438108921051025
Epoch: 9, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.378 Vali Acc: 0.932 Test Loss: 0.378 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 43.9132297039032
Epoch: 10, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 41.99464678764343
Epoch: 11, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.454 Vali Acc: 0.937 Test Loss: 0.454 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 41.09760332107544
Epoch: 12, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.619 Vali Acc: 0.928 Test Loss: 0.619 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 16987540
model size : 67.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 83.54098677635193
Epoch: 1, Steps: 89 | Train Loss: 0.992 Vali Loss: 0.311 Vali Acc: 0.909 Test Loss: 0.311 Test Acc: 0.909
Validation loss decreased (inf --> -0.908771).  Saving model ...
Epoch: 2 cost time: 85.37380909919739
Epoch: 2, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.217 Vali Acc: 0.928 Test Loss: 0.217 Test Acc: 0.928
Validation loss decreased (-0.908771 --> -0.928271).  Saving model ...
Epoch: 3 cost time: 80.313068151474
Epoch: 3, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.277 Vali Acc: 0.923 Test Loss: 0.277 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 84.22777152061462
Epoch: 4, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.341 Vali Acc: 0.909 Test Loss: 0.341 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 75.67853999137878
Epoch: 5, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.302 Vali Acc: 0.936 Test Loss: 0.302 Test Acc: 0.936
Validation loss decreased (-0.928271 --> -0.935930).  Saving model ...
Epoch: 6 cost time: 78.43927526473999
Epoch: 6, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
Validation loss decreased (-0.935930 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 76.91990542411804
Epoch: 7, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.356 Vali Acc: 0.928 Test Loss: 0.356 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 73.52048230171204
Epoch: 8, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.392 Vali Acc: 0.924 Test Loss: 0.392 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 73.38908004760742
Epoch: 9, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.378 Vali Acc: 0.921 Test Loss: 0.378 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 73.91153979301453
Epoch: 10, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.614 Vali Acc: 0.903 Test Loss: 0.614 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 95.40696477890015
Epoch: 11, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.503 Vali Acc: 0.916 Test Loss: 0.503 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 99.33270978927612
Epoch: 12, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.928 Vali Acc: 0.894 Test Loss: 0.928 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 100.10059952735901
Epoch: 13, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.476 Vali Acc: 0.937 Test Loss: 0.476 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 97.80143356323242
Epoch: 14, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.342 Vali Acc: 0.953 Test Loss: 0.342 Test Acc: 0.953
Validation loss decreased (-0.952644 --> -0.953339).  Saving model ...
Epoch: 15 cost time: 95.30943179130554
Epoch: 15, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.959 Test Loss: 0.261 Test Acc: 0.959
Validation loss decreased (-0.953339 --> -0.958911).  Saving model ...
Epoch: 16 cost time: 96.96326804161072
Epoch: 16, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.377 Vali Acc: 0.952 Test Loss: 0.377 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 100.89768934249878
Epoch: 17, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.408 Vali Acc: 0.933 Test Loss: 0.408 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 97.41260123252869
Epoch: 18, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 94.15333247184753
Epoch: 19, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.321 Vali Acc: 0.952 Test Loss: 0.321 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 98.72668409347534
Epoch: 20, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.374 Vali Acc: 0.935 Test Loss: 0.374 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 100.46456050872803
Epoch: 21, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.324 Vali Acc: 0.960 Test Loss: 0.324 Test Acc: 0.960
Validation loss decreased (-0.958911 --> -0.959607).  Saving model ...
Epoch: 22 cost time: 97.08310890197754
Epoch: 22, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.314 Vali Acc: 0.951 Test Loss: 0.314 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 94.99372434616089
Epoch: 23, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.295 Vali Acc: 0.956 Test Loss: 0.295 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 95.86126804351807
Epoch: 24, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.232 Vali Acc: 0.966 Test Loss: 0.232 Test Acc: 0.966
Validation loss decreased (-0.959607 --> -0.965875).  Saving model ...
Epoch: 25 cost time: 101.77924060821533
Epoch: 25, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.335 Vali Acc: 0.962 Test Loss: 0.335 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 99.22016882896423
Epoch: 26, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.224 Vali Acc: 0.971 Test Loss: 0.224 Test Acc: 0.971
Validation loss decreased (-0.965875 --> -0.971446).  Saving model ...
Epoch: 27 cost time: 94.51311206817627
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.203 Vali Acc: 0.973 Test Loss: 0.203 Test Acc: 0.973
Validation loss decreased (-0.971446 --> -0.972839).  Saving model ...
Epoch: 28 cost time: 96.6201274394989
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.288 Vali Acc: 0.956 Test Loss: 0.288 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 100.4012188911438
Epoch: 29, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.325 Vali Acc: 0.939 Test Loss: 0.325 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 102.5932469367981
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.321 Vali Acc: 0.951 Test Loss: 0.321 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 56704660
model size : 218.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 35.709733724594116
Epoch: 1, Steps: 89 | Train Loss: 0.989 Vali Loss: 0.250 Vali Acc: 0.923 Test Loss: 0.250 Test Acc: 0.923
Validation loss decreased (inf --> -0.922699).  Saving model ...
Epoch: 2 cost time: 39.714293479919434
Epoch: 2, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.196 Vali Acc: 0.947 Test Loss: 0.196 Test Acc: 0.947
Validation loss decreased (-0.922699 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 34.26245450973511
Epoch: 3, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.947073 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 40.710336446762085
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.643 Vali Acc: 0.867 Test Loss: 0.643 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.90643858909607
Epoch: 5, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.458 Vali Acc: 0.918 Test Loss: 0.458 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.60263419151306
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.448 Vali Acc: 0.920 Test Loss: 0.448 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 30.84962773323059
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.263 Vali Acc: 0.951 Test Loss: 0.263 Test Acc: 0.951
Validation loss decreased (-0.949859 --> -0.950554).  Saving model ...
Epoch: 8 cost time: 31.434813976287842
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.549 Vali Acc: 0.923 Test Loss: 0.549 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 35.32593846321106
Epoch: 9, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.349 Vali Acc: 0.932 Test Loss: 0.349 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 33.715927839279175
Epoch: 10, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.422 Vali Acc: 0.935 Test Loss: 0.422 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 30.282187938690186
Epoch: 11, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.294 Vali Acc: 0.959 Test Loss: 0.294 Test Acc: 0.959
Validation loss decreased (-0.950554 --> -0.958911).  Saving model ...
Epoch: 12 cost time: 29.915971994400024
Epoch: 12, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.348 Vali Acc: 0.948 Test Loss: 0.348 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 33.58049464225769
Epoch: 13, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.512 Vali Acc: 0.947 Test Loss: 0.512 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 36.66916108131409
Epoch: 14, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.516 Vali Acc: 0.941 Test Loss: 0.516 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 32.305628061294556
Epoch: 15, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.565 Vali Acc: 0.938 Test Loss: 0.565 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 30.13736891746521
Epoch: 16, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.590 Vali Acc: 0.939 Test Loss: 0.590 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 33.6164186000824
Epoch: 17, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.552 Vali Acc: 0.954 Test Loss: 0.552 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 35.39692568778992
Epoch: 18, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.598 Vali Acc: 0.950 Test Loss: 0.598 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 33.641359090805054
Epoch: 19, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.539 Vali Acc: 0.951 Test Loss: 0.539 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 30.114326000213623
Epoch: 20, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.492 Vali Acc: 0.962 Test Loss: 0.492 Test Acc: 0.962
Validation loss decreased (-0.958911 --> -0.961694).  Saving model ...
Epoch: 21 cost time: 30.72946310043335
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.402 Vali Acc: 0.967 Test Loss: 0.402 Test Acc: 0.967
Validation loss decreased (-0.961694 --> -0.966570).  Saving model ...
Epoch: 22 cost time: 34.06007695198059
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.442 Vali Acc: 0.971 Test Loss: 0.442 Test Acc: 0.971
Validation loss decreased (-0.966570 --> -0.971444).  Saving model ...
Epoch: 23 cost time: 35.43942713737488
Epoch: 23, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.486 Vali Acc: 0.962 Test Loss: 0.486 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 32.86288809776306
Epoch: 24, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.483 Vali Acc: 0.960 Test Loss: 0.483 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 30.070921659469604
Epoch: 25, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.563 Vali Acc: 0.958 Test Loss: 0.563 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 29.73824167251587
Epoch: 26, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.544 Vali Acc: 0.965 Test Loss: 0.544 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 34.861685037612915
Epoch: 27, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.520 Vali Acc: 0.952 Test Loss: 0.520 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 37.940104246139526
Epoch: 28, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.491 Vali Acc: 0.960 Test Loss: 0.491 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 37.12464880943298
Epoch: 29, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.467 Vali Acc: 0.967 Test Loss: 0.467 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 33.25661849975586
Epoch: 30, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.545 Vali Acc: 0.958 Test Loss: 0.545 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 16987540
model size : 67.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 50.68974304199219
Epoch: 1, Steps: 89 | Train Loss: 1.039 Vali Loss: 0.376 Vali Acc: 0.893 Test Loss: 0.376 Test Acc: 0.893
Validation loss decreased (inf --> -0.893450).  Saving model ...
Epoch: 2 cost time: 43.11131286621094
Epoch: 2, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.366 Vali Acc: 0.887 Test Loss: 0.366 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 43.77049970626831
Epoch: 3, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
Validation loss decreased (-0.893450 --> -0.919217).  Saving model ...
Epoch: 4 cost time: 44.120208501815796
Epoch: 4, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.293 Vali Acc: 0.919 Test Loss: 0.293 Test Acc: 0.919
Validation loss decreased (-0.919217 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 50.333359718322754
Epoch: 5, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.267 Vali Acc: 0.936 Test Loss: 0.267 Test Acc: 0.936
Validation loss decreased (-0.919217 --> -0.935930).  Saving model ...
Epoch: 6 cost time: 52.57329559326172
Epoch: 6, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 49.579939126968384
Epoch: 7, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.322 Vali Acc: 0.923 Test Loss: 0.322 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 48.245391845703125
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.592 Vali Acc: 0.903 Test Loss: 0.592 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 42.340312480926514
Epoch: 9, Steps: 89 | Train Loss: 0.279 Vali Loss: 1.148 Vali Acc: 0.827 Test Loss: 1.148 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 44.30392909049988
Epoch: 10, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.068 Vali Acc: 0.860 Test Loss: 1.068 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 46.83325147628784
Epoch: 11, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.558 Vali Acc: 0.922 Test Loss: 0.558 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 49.915526390075684
Epoch: 12, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.474 Vali Acc: 0.918 Test Loss: 0.474 Test Acc: 0.918
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 39.63948106765747
Epoch: 13, Steps: 89 | Train Loss: 0.215 Vali Loss: 2.785 Vali Acc: 0.877 Test Loss: 2.785 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 39.06217575073242
Epoch: 14, Steps: 89 | Train Loss: 0.744 Vali Loss: 1.169 Vali Acc: 0.870 Test Loss: 1.169 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 39.41266894340515
Epoch: 15, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.979 Vali Acc: 0.882 Test Loss: 0.979 Test Acc: 0.882
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.935933147632312
model parameter : 56704660
model size : 218.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.524477005004883
Epoch: 1, Steps: 89 | Train Loss: 1.038 Vali Loss: 0.296 Vali Acc: 0.915 Test Loss: 0.296 Test Acc: 0.915
Validation loss decreased (inf --> -0.915039).  Saving model ...
Epoch: 2 cost time: 19.757943391799927
Epoch: 2, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.662 Vali Acc: 0.827 Test Loss: 0.662 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.186764240264893
Epoch: 3, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.819 Vali Acc: 0.848 Test Loss: 0.819 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.497401237487793
Epoch: 4, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.343 Vali Acc: 0.909 Test Loss: 0.343 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 20.261882066726685
Epoch: 5, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.356 Vali Acc: 0.909 Test Loss: 0.356 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.676381587982178
Epoch: 6, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
Validation loss decreased (-0.915039 --> -0.933144).  Saving model ...
Epoch: 7 cost time: 20.749263048171997
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.473 Vali Acc: 0.896 Test Loss: 0.473 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.431333780288696
Epoch: 8, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.773 Vali Acc: 0.887 Test Loss: 0.773 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.45977759361267
Epoch: 9, Steps: 89 | Train Loss: 0.203 Vali Loss: 1.125 Vali Acc: 0.824 Test Loss: 1.125 Test Acc: 0.824
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.045389652252197
Epoch: 10, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.798 Vali Acc: 0.881 Test Loss: 0.798 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.881693840026855
Epoch: 11, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.883 Vali Acc: 0.870 Test Loss: 0.883 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 20.458268404006958
Epoch: 12, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.802 Vali Acc: 0.896 Test Loss: 0.802 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.088093519210815
Epoch: 13, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.776 Vali Acc: 0.887 Test Loss: 0.776 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 19.108277082443237
Epoch: 14, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.669 Vali Acc: 0.907 Test Loss: 0.669 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.359935998916626
Epoch: 15, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.567 Vali Acc: 0.922 Test Loss: 0.567 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.612668991088867
Epoch: 16, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.703 Vali Acc: 0.916 Test Loss: 0.703 Test Acc: 0.916
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9331476323119777
model parameter : 16987540
model size : 67.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 66.36922001838684
Epoch: 1, Steps: 89 | Train Loss: 0.996 Vali Loss: 0.295 Vali Acc: 0.915 Test Loss: 0.295 Test Acc: 0.915
Validation loss decreased (inf --> -0.915039).  Saving model ...
Epoch: 2 cost time: 65.49921798706055
Epoch: 2, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.915039 --> -0.949162).  Saving model ...
Epoch: 3 cost time: 65.92800855636597
Epoch: 3, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 64.71889162063599
Epoch: 4, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 73.27452683448792
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.410 Vali Acc: 0.923 Test Loss: 0.410 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 69.45870518684387
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.359 Vali Acc: 0.934 Test Loss: 0.359 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 72.79689741134644
Epoch: 7, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.318 Vali Acc: 0.945 Test Loss: 0.318 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 68.59631204605103
Epoch: 8, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.600 Vali Acc: 0.928 Test Loss: 0.600 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 69.91221928596497
Epoch: 9, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.653 Vali Acc: 0.903 Test Loss: 0.653 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 67.01405930519104
Epoch: 10, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.668 Vali Acc: 0.917 Test Loss: 0.668 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 67.23405528068542
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.410 Vali Acc: 0.951 Test Loss: 0.410 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.951249).  Saving model ...
Epoch: 12 cost time: 66.85035610198975
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.428 Vali Acc: 0.942 Test Loss: 0.428 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 66.7145025730133
Epoch: 13, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.517 Vali Acc: 0.927 Test Loss: 0.517 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 68.19868326187134
Epoch: 14, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.418 Vali Acc: 0.947 Test Loss: 0.418 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 66.33959746360779
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.431 Vali Acc: 0.951 Test Loss: 0.431 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 67.14715623855591
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.452 Vali Acc: 0.953 Test Loss: 0.452 Test Acc: 0.953
Validation loss decreased (-0.951249 --> -0.952642).  Saving model ...
Epoch: 17 cost time: 65.69234037399292
Epoch: 17, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.723 Vali Acc: 0.916 Test Loss: 0.723 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 61.206645488739014
Epoch: 18, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.628 Vali Acc: 0.948 Test Loss: 0.628 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 61.08838868141174
Epoch: 19, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.550 Vali Acc: 0.937 Test Loss: 0.550 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 61.01485729217529
Epoch: 20, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.355 Vali Acc: 0.958 Test Loss: 0.355 Test Acc: 0.958
Validation loss decreased (-0.952642 --> -0.957517).  Saving model ...
Epoch: 21 cost time: 62.77423620223999
Epoch: 21, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.346 Vali Acc: 0.967 Test Loss: 0.346 Test Acc: 0.967
Validation loss decreased (-0.957517 --> -0.967267).  Saving model ...
Epoch: 22 cost time: 59.38105893135071
Epoch: 22, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.342 Vali Acc: 0.962 Test Loss: 0.342 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 59.32131862640381
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.409 Vali Acc: 0.967 Test Loss: 0.409 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 59.76229000091553
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.467 Vali Acc: 0.958 Test Loss: 0.467 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 69.45799255371094
Epoch: 25, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.449 Vali Acc: 0.955 Test Loss: 0.449 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 73.95307421684265
Epoch: 26, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.381 Vali Acc: 0.963 Test Loss: 0.381 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 71.54365468025208
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.446 Vali Acc: 0.955 Test Loss: 0.446 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 70.94617676734924
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.393 Vali Acc: 0.964 Test Loss: 0.393 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 74.10562229156494
Epoch: 29, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.631 Vali Acc: 0.948 Test Loss: 0.631 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 70.96010255813599
Epoch: 30, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.490 Vali Acc: 0.950 Test Loss: 0.490 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 28587412
model size : 111.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 31.585132598876953
Epoch: 1, Steps: 89 | Train Loss: 0.969 Vali Loss: 0.321 Vali Acc: 0.912 Test Loss: 0.321 Test Acc: 0.912
Validation loss decreased (inf --> -0.912253).  Saving model ...
Epoch: 2 cost time: 25.592724561691284
Epoch: 2, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.912253 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 27.53107190132141
Epoch: 3, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.462 Vali Acc: 0.899 Test Loss: 0.462 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.326706647872925
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.246 Vali Acc: 0.946 Test Loss: 0.246 Test Acc: 0.946
Validation loss decreased (-0.939413 --> -0.946376).  Saving model ...
Epoch: 5 cost time: 26.012501001358032
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.427 Vali Acc: 0.921 Test Loss: 0.427 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 30.535232305526733
Epoch: 6, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.259 Vali Acc: 0.946 Test Loss: 0.259 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.989588260650635
Epoch: 7, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.359 Vali Acc: 0.940 Test Loss: 0.359 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 27.565767288208008
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.291 Vali Acc: 0.951 Test Loss: 0.291 Test Acc: 0.951
Validation loss decreased (-0.946376 --> -0.951251).  Saving model ...
Epoch: 9 cost time: 27.390181303024292
Epoch: 9, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.361 Vali Acc: 0.946 Test Loss: 0.361 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.81726837158203
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.368 Vali Acc: 0.948 Test Loss: 0.368 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.47873044013977
Epoch: 11, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.648569583892822
Epoch: 12, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.16701602935791
Epoch: 13, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.619 Vali Acc: 0.932 Test Loss: 0.619 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 23.9998779296875
Epoch: 14, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.361 Vali Acc: 0.955 Test Loss: 0.361 Test Acc: 0.955
Validation loss decreased (-0.951251 --> -0.954732).  Saving model ...
Epoch: 15 cost time: 21.831058502197266
Epoch: 15, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.500 Vali Acc: 0.944 Test Loss: 0.500 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.458560705184937
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.504 Vali Acc: 0.953 Test Loss: 0.504 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 25.05254602432251
Epoch: 17, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.495 Vali Acc: 0.948 Test Loss: 0.495 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 25.085916757583618
Epoch: 18, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.564 Vali Acc: 0.938 Test Loss: 0.564 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.41939640045166
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.453 Vali Acc: 0.955 Test Loss: 0.453 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 21.031358242034912
Epoch: 20, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.477 Vali Acc: 0.954 Test Loss: 0.477 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 24.391632080078125
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.478 Vali Acc: 0.960 Test Loss: 0.478 Test Acc: 0.960
Validation loss decreased (-0.954732 --> -0.959605).  Saving model ...
Epoch: 22 cost time: 23.349618673324585
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.447 Vali Acc: 0.961 Test Loss: 0.447 Test Acc: 0.961
Validation loss decreased (-0.959605 --> -0.960998).  Saving model ...
Epoch: 23 cost time: 21.79836893081665
Epoch: 23, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.787 Vali Acc: 0.926 Test Loss: 0.787 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 21.728490829467773
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.949 Test Loss: 0.564 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 23.869535207748413
Epoch: 25, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.387 Vali Acc: 0.964 Test Loss: 0.387 Test Acc: 0.964
Validation loss decreased (-0.960998 --> -0.963784).  Saving model ...
Epoch: 26 cost time: 23.43573832511902
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.611 Vali Acc: 0.938 Test Loss: 0.611 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 21.01016068458557
Epoch: 27, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.463 Vali Acc: 0.955 Test Loss: 0.463 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 22.43997073173523
Epoch: 28, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.702 Vali Acc: 0.945 Test Loss: 0.702 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 26.105059146881104
Epoch: 29, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.757 Vali Acc: 0.942 Test Loss: 0.757 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 23.079840183258057
Epoch: 30, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.617 Vali Acc: 0.960 Test Loss: 0.617 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 8728468
model size : 35.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 45.59832239151001
Epoch: 1, Steps: 89 | Train Loss: 1.049 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (inf --> -0.925485).  Saving model ...
Epoch: 2 cost time: 40.540770292282104
Epoch: 2, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.925485 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 44.445159673690796
Epoch: 3, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.937324 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 44.89246678352356
Epoch: 4, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.950555 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 42.91120219230652
Epoch: 5, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.519 Vali Acc: 0.904 Test Loss: 0.519 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 44.38672614097595
Epoch: 6, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 46.354201316833496
Epoch: 7, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 46.6773157119751
Epoch: 8, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.377 Vali Acc: 0.927 Test Loss: 0.377 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 51.598190784454346
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.525 Vali Acc: 0.914 Test Loss: 0.525 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 51.61944079399109
Epoch: 10, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.443 Vali Acc: 0.942 Test Loss: 0.443 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 50.25404143333435
Epoch: 11, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.385 Vali Acc: 0.958 Test Loss: 0.385 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 50.78880739212036
Epoch: 12, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.342 Vali Acc: 0.956 Test Loss: 0.342 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 54.463722705841064
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.505 Vali Acc: 0.951 Test Loss: 0.505 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 51.96667981147766
Epoch: 14, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.268 Vali Acc: 0.959 Test Loss: 0.268 Test Acc: 0.959
Validation loss decreased (-0.957519 --> -0.958911).  Saving model ...
Epoch: 15 cost time: 49.36882948875427
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.286 Vali Acc: 0.962 Test Loss: 0.286 Test Acc: 0.962
Validation loss decreased (-0.958911 --> -0.961696).  Saving model ...
Epoch: 16 cost time: 52.32055854797363
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.256 Vali Acc: 0.968 Test Loss: 0.256 Test Acc: 0.968
Validation loss decreased (-0.961696 --> -0.967964).  Saving model ...
Epoch: 17 cost time: 53.46107602119446
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.311 Vali Acc: 0.965 Test Loss: 0.311 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 50.600189447402954
Epoch: 18, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.405 Vali Acc: 0.949 Test Loss: 0.405 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 50.433732748031616
Epoch: 19, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.586 Vali Acc: 0.936 Test Loss: 0.586 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 46.48910570144653
Epoch: 20, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.571 Vali Acc: 0.943 Test Loss: 0.571 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 44.368048429489136
Epoch: 21, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.405 Vali Acc: 0.964 Test Loss: 0.405 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 43.47876501083374
Epoch: 22, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.379 Vali Acc: 0.965 Test Loss: 0.379 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 45.24668860435486
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.399 Vali Acc: 0.971 Test Loss: 0.399 Test Acc: 0.971
Validation loss decreased (-0.967964 --> -0.970748).  Saving model ...
Epoch: 24 cost time: 43.628074169158936
Epoch: 24, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.433 Vali Acc: 0.964 Test Loss: 0.433 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 43.71918535232544
Epoch: 25, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.563 Vali Acc: 0.930 Test Loss: 0.563 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 44.292388916015625
Epoch: 26, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.551 Vali Acc: 0.945 Test Loss: 0.551 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 44.87562370300293
Epoch: 27, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.987 Vali Acc: 0.915 Test Loss: 0.987 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 44.35904097557068
Epoch: 28, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.844 Vali Acc: 0.929 Test Loss: 0.844 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 44.06182885169983
Epoch: 29, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.504 Vali Acc: 0.955 Test Loss: 0.504 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 43.76631951332092
Epoch: 30, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.502 Vali Acc: 0.953 Test Loss: 0.502 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 28587412
model size : 111.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.029892206192017
Epoch: 1, Steps: 89 | Train Loss: 0.993 Vali Loss: 0.367 Vali Acc: 0.905 Test Loss: 0.367 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 16.769684553146362
Epoch: 2, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.905289 --> -0.954734).  Saving model ...
Epoch: 3 cost time: 18.53875994682312
Epoch: 3, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.391 Vali Acc: 0.907 Test Loss: 0.391 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.990160942077637
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.200090885162354
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.002875328063965
Epoch: 6, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.65208864212036
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.261 Vali Acc: 0.946 Test Loss: 0.261 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.326340913772583
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 20.11462664604187
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.545 Vali Acc: 0.921 Test Loss: 0.545 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 17.897773265838623
Epoch: 10, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.472 Vali Acc: 0.933 Test Loss: 0.472 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 17.47470211982727
Epoch: 11, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.532 Vali Acc: 0.930 Test Loss: 0.532 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 19.46823239326477
Epoch: 12, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.380 Vali Acc: 0.953 Test Loss: 0.380 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9547353760445683
model parameter : 8728468
model size : 35.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.38362979888916
Epoch: 1, Steps: 89 | Train Loss: 1.051 Vali Loss: 0.336 Vali Acc: 0.880 Test Loss: 0.336 Test Acc: 0.880
Validation loss decreased (inf --> -0.880219).  Saving model ...
Epoch: 2 cost time: 24.142688989639282
Epoch: 2, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.252 Vali Acc: 0.924 Test Loss: 0.252 Test Acc: 0.924
Validation loss decreased (-0.880219 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 24.608696937561035
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.317 Vali Acc: 0.905 Test Loss: 0.317 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.750011682510376
Epoch: 4, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.796241998672485
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.488 Vali Acc: 0.898 Test Loss: 0.488 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.80102849006653
Epoch: 6, Steps: 89 | Train Loss: 0.198 Vali Loss: 1.255 Vali Acc: 0.852 Test Loss: 1.255 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.19635558128357
Epoch: 7, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.469 Vali Acc: 0.912 Test Loss: 0.469 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.808741331100464
Epoch: 8, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.418 Vali Acc: 0.935 Test Loss: 0.418 Test Acc: 0.935
Validation loss decreased (-0.924092 --> -0.935233).  Saving model ...
Epoch: 9 cost time: 22.642936944961548
Epoch: 9, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
Validation loss decreased (-0.935233 --> -0.947769).  Saving model ...
Epoch: 10 cost time: 21.989527940750122
Epoch: 10, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.475 Vali Acc: 0.917 Test Loss: 0.475 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.120609045028687
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.270 Vali Acc: 0.963 Test Loss: 0.270 Test Acc: 0.963
Validation loss decreased (-0.947769 --> -0.963089).  Saving model ...
Epoch: 12 cost time: 21.942638635635376
Epoch: 12, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.275 Vali Acc: 0.960 Test Loss: 0.275 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.071070432662964
Epoch: 13, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 19.76051115989685
Epoch: 14, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.613 Vali Acc: 0.908 Test Loss: 0.613 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.169373273849487
Epoch: 15, Steps: 89 | Train Loss: 0.261 Vali Loss: 1.660 Vali Acc: 0.873 Test Loss: 1.660 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.201350212097168
Epoch: 16, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.541 Vali Acc: 0.925 Test Loss: 0.541 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 17.922290325164795
Epoch: 17, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.434 Vali Acc: 0.944 Test Loss: 0.434 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.221375942230225
Epoch: 18, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.334 Vali Acc: 0.967 Test Loss: 0.334 Test Acc: 0.967
Validation loss decreased (-0.963089 --> -0.967267).  Saving model ...
Epoch: 19 cost time: 20.6693696975708
Epoch: 19, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.523 Vali Acc: 0.940 Test Loss: 0.523 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 21.283207654953003
Epoch: 20, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.677 Vali Acc: 0.930 Test Loss: 0.677 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 20.790266513824463
Epoch: 21, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.939 Vali Acc: 0.904 Test Loss: 0.939 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 21.34682536125183
Epoch: 22, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.488 Vali Acc: 0.955 Test Loss: 0.488 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 19.92915439605713
Epoch: 23, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.730 Vali Acc: 0.890 Test Loss: 0.730 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 20.377274751663208
Epoch: 24, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.431 Vali Acc: 0.952 Test Loss: 0.431 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 19.693143606185913
Epoch: 25, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.557 Vali Acc: 0.936 Test Loss: 0.557 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 19.424302101135254
Epoch: 26, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.749 Vali Acc: 0.921 Test Loss: 0.749 Test Acc: 0.921
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 19.328274488449097
Epoch: 27, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.438 Vali Acc: 0.952 Test Loss: 0.438 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 18.870201587677002
Epoch: 28, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.515 Vali Acc: 0.951 Test Loss: 0.515 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 28587412
model size : 111.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.164346933364868
Epoch: 1, Steps: 89 | Train Loss: 1.011 Vali Loss: 0.375 Vali Acc: 0.871 Test Loss: 0.375 Test Acc: 0.871
Validation loss decreased (inf --> -0.871166).  Saving model ...
Epoch: 2 cost time: 8.261911630630493
Epoch: 2, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.431 Vali Acc: 0.865 Test Loss: 0.431 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.556551694869995
Epoch: 3, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.598 Vali Acc: 0.868 Test Loss: 0.598 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.696864604949951
Epoch: 4, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.871166 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 7.771950721740723
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.356 Vali Acc: 0.908 Test Loss: 0.356 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.660215377807617
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.662750482559204
Epoch: 7, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.084274530410767
Epoch: 8, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.260 Vali Acc: 0.951 Test Loss: 0.260 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.7419233322143555
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.47652792930603
Epoch: 10, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.583 Vali Acc: 0.914 Test Loss: 0.583 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.50584077835083
Epoch: 11, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.321 Vali Acc: 0.955 Test Loss: 0.321 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.649787902832031
Epoch: 12, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.647 Vali Acc: 0.907 Test Loss: 0.647 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.368181467056274
Epoch: 13, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.577 Vali Acc: 0.916 Test Loss: 0.577 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.166602611541748
Epoch: 14, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.422 Vali Acc: 0.948 Test Loss: 0.422 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 8728468
model size : 35.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 64.38367223739624
Epoch: 1, Steps: 89 | Train Loss: 1.184 Vali Loss: 0.293 Vali Acc: 0.912 Test Loss: 0.293 Test Acc: 0.912
Validation loss decreased (inf --> -0.912253).  Saving model ...
Epoch: 2 cost time: 72.82852005958557
Epoch: 2, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.202 Vali Acc: 0.936 Test Loss: 0.202 Test Acc: 0.936
Validation loss decreased (-0.912253 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 77.70186424255371
Epoch: 3, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
Validation loss decreased (-0.935931 --> -0.949163).  Saving model ...
Epoch: 4 cost time: 80.69105648994446
Epoch: 4, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.949163 --> -0.956127).  Saving model ...
Epoch: 5 cost time: 78.7808723449707
Epoch: 5, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.238 Vali Acc: 0.939 Test Loss: 0.238 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 81.66295647621155
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 79.79424500465393
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.956127 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 79.92901754379272
Epoch: 8, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 79.0762140750885
Epoch: 9, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.428 Vali Acc: 0.907 Test Loss: 0.428 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 79.73838376998901
Epoch: 10, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 70.09937834739685
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 70.41061902046204
Epoch: 12, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 69.60946083068848
Epoch: 13, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.380 Vali Acc: 0.916 Test Loss: 0.380 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 67.74884152412415
Epoch: 14, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 68.48576760292053
Epoch: 15, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.236 Vali Acc: 0.967 Test Loss: 0.236 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967268).  Saving model ...
Epoch: 16 cost time: 69.11077761650085
Epoch: 16, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.386 Vali Acc: 0.935 Test Loss: 0.386 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 70.19104528427124
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.240 Vali Acc: 0.963 Test Loss: 0.240 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 70.04762315750122
Epoch: 18, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.286 Vali Acc: 0.963 Test Loss: 0.286 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 70.46942853927612
Epoch: 19, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.309 Vali Acc: 0.945 Test Loss: 0.309 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 69.65000343322754
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.264 Vali Acc: 0.962 Test Loss: 0.264 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 66.53606796264648
Epoch: 21, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 76.67433977127075
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.964 Test Loss: 0.313 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 78.17828631401062
Epoch: 23, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.339 Vali Acc: 0.962 Test Loss: 0.339 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 76.90390515327454
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.384 Vali Acc: 0.953 Test Loss: 0.384 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 78.31999826431274
Epoch: 25, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.586 Vali Acc: 0.939 Test Loss: 0.586 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 28354644
model size : 109.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.939383268356323
Epoch: 1, Steps: 89 | Train Loss: 1.200 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (inf --> -0.922003).  Saving model ...
Epoch: 2 cost time: 30.03819441795349
Epoch: 2, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
Validation loss decreased (-0.922003 --> -0.942199).  Saving model ...
Epoch: 3 cost time: 31.9343478679657
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.942199 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 32.488906145095825
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.72460126876831
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.949859 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 27.971384286880493
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.230 Vali Acc: 0.936 Test Loss: 0.230 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.635833740234375
Epoch: 7, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.020638465881348
Epoch: 8, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 25.726113080978394
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.291 Vali Acc: 0.939 Test Loss: 0.291 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.16913866996765
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.45190739631653
Epoch: 11, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.418 Vali Acc: 0.932 Test Loss: 0.418 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.91417407989502
Epoch: 12, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.910978317260742
Epoch: 13, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.261 Vali Acc: 0.957 Test Loss: 0.261 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 24.83603262901306
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.247 Vali Acc: 0.957 Test Loss: 0.247 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 24.672743320465088
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.540 Vali Acc: 0.921 Test Loss: 0.540 Test Acc: 0.921
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 8495316
model size : 33.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 45.88006067276001
Epoch: 1, Steps: 89 | Train Loss: 1.230 Vali Loss: 0.330 Vali Acc: 0.886 Test Loss: 0.330 Test Acc: 0.886
Validation loss decreased (inf --> -0.886487).  Saving model ...
Epoch: 2 cost time: 46.704657793045044
Epoch: 2, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.344 Vali Acc: 0.895 Test Loss: 0.344 Test Acc: 0.895
Validation loss decreased (-0.886487 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 47.8250195980072
Epoch: 3, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.196 Vali Acc: 0.940 Test Loss: 0.196 Test Acc: 0.940
Validation loss decreased (-0.894843 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 48.26684093475342
Epoch: 4, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.940109 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 46.75798988342285
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 47.62348437309265
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 47.80485439300537
Epoch: 7, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.345 Vali Acc: 0.939 Test Loss: 0.345 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 47.553839683532715
Epoch: 8, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.232 Vali Acc: 0.945 Test Loss: 0.232 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 48.245015144348145
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.282 Vali Acc: 0.934 Test Loss: 0.282 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 53.16749811172485
Epoch: 10, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.282 Vali Acc: 0.955 Test Loss: 0.282 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 51.543731689453125
Epoch: 11, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.262 Vali Acc: 0.951 Test Loss: 0.262 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 52.46335029602051
Epoch: 12, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 52.29440498352051
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 50.78790616989136
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.572 Vali Acc: 0.917 Test Loss: 0.572 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 28354644
model size : 109.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 20.718917846679688
Epoch: 1, Steps: 89 | Train Loss: 1.249 Vali Loss: 0.399 Vali Acc: 0.866 Test Loss: 0.399 Test Acc: 0.866
Validation loss decreased (inf --> -0.866291).  Saving model ...
Epoch: 2 cost time: 20.93817949295044
Epoch: 2, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.866291 --> -0.922003).  Saving model ...
Epoch: 3 cost time: 20.960631132125854
Epoch: 3, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.922003 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 20.01378035545349
Epoch: 4, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.797629833221436
Epoch: 5, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.252 Vali Acc: 0.936 Test Loss: 0.252 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.53460931777954
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.172628164291382
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
Validation loss decreased (-0.949859 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 18.00722360610962
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.04248833656311
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.780964374542236
Epoch: 10, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.239 Vali Acc: 0.928 Test Loss: 0.239 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 19.123989582061768
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.282 Vali Acc: 0.940 Test Loss: 0.282 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.273120403289795
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.268 Vali Acc: 0.946 Test Loss: 0.268 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 19.370899200439453
Epoch: 13, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.360 Vali Acc: 0.930 Test Loss: 0.360 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 18.653401613235474
Epoch: 14, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.258 Vali Acc: 0.953 Test Loss: 0.258 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 18.494548320770264
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 19.134132623672485
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.304 Vali Acc: 0.939 Test Loss: 0.304 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 18.716817378997803
Epoch: 17, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.353 Vali Acc: 0.942 Test Loss: 0.353 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 8495316
model size : 33.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.16390037536621
Epoch: 1, Steps: 89 | Train Loss: 1.270 Vali Loss: 0.344 Vali Acc: 0.905 Test Loss: 0.344 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 22.68814516067505
Epoch: 2, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.520 Vali Acc: 0.830 Test Loss: 0.520 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 26.462138414382935
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
Validation loss decreased (-0.905289 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 29.842051029205322
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.256 Vali Acc: 0.929 Test Loss: 0.256 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.34033465385437
Epoch: 5, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.814101934432983
Epoch: 6, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.939 Vali Acc: 0.896 Test Loss: 0.939 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 34.85962510108948
Epoch: 7, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.457 Vali Acc: 0.897 Test Loss: 0.457 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 29.318068265914917
Epoch: 8, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.364 Vali Acc: 0.897 Test Loss: 0.364 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 35.131335973739624
Epoch: 9, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.875545263290405
Epoch: 10, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.359 Vali Acc: 0.918 Test Loss: 0.359 Test Acc: 0.918
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 34.65807247161865
Epoch: 11, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.780 Vali Acc: 0.898 Test Loss: 0.780 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 32.23949694633484
Epoch: 12, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
Validation loss decreased (-0.939413 --> -0.940805).  Saving model ...
Epoch: 13 cost time: 31.994697332382202
Epoch: 13, Steps: 89 | Train Loss: 0.126 Vali Loss: 1.425 Vali Acc: 0.831 Test Loss: 1.425 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 33.46344232559204
Epoch: 14, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.604 Vali Acc: 0.884 Test Loss: 0.604 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 31.94776678085327
Epoch: 15, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 35.01600217819214
Epoch: 16, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.674 Vali Acc: 0.875 Test Loss: 0.674 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 29.40852952003479
Epoch: 17, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.933 Vali Acc: 0.847 Test Loss: 0.933 Test Acc: 0.847
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 34.876909017562866
Epoch: 18, Steps: 89 | Train Loss: 0.183 Vali Loss: 1.057 Vali Acc: 0.875 Test Loss: 1.057 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 30.824166297912598
Epoch: 19, Steps: 89 | Train Loss: 0.171 Vali Loss: 1.328 Vali Acc: 0.852 Test Loss: 1.328 Test Acc: 0.852
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 35.40703082084656
Epoch: 20, Steps: 89 | Train Loss: 0.133 Vali Loss: 1.137 Vali Acc: 0.875 Test Loss: 1.137 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 29.226566076278687
Epoch: 21, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.713 Vali Acc: 0.903 Test Loss: 0.713 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 35.242467403411865
Epoch: 22, Steps: 89 | Train Loss: 0.119 Vali Loss: 1.239 Vali Acc: 0.876 Test Loss: 1.239 Test Acc: 0.876
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9408077994428969
model parameter : 28354644
model size : 109.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.634361743927002
Epoch: 1, Steps: 89 | Train Loss: 1.278 Vali Loss: 0.298 Vali Acc: 0.914 Test Loss: 0.298 Test Acc: 0.914
Validation loss decreased (inf --> -0.913646).  Saving model ...
Epoch: 2 cost time: 14.624239444732666
Epoch: 2, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.913646 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 11.51262092590332
Epoch: 3, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.933145 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 13.453333854675293
Epoch: 4, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.83757472038269
Epoch: 5, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.65986967086792
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.190 Vali Acc: 0.942 Test Loss: 0.190 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.19717001914978
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.213812351226807
Epoch: 8, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.270 Vali Acc: 0.932 Test Loss: 0.270 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.472887516021729
Epoch: 9, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.360 Vali Acc: 0.928 Test Loss: 0.360 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.231056690216064
Epoch: 10, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.497 Vali Acc: 0.898 Test Loss: 0.497 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.322781324386597
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.524 Vali Acc: 0.884 Test Loss: 0.524 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.179003477096558
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.358 Vali Acc: 0.924 Test Loss: 0.358 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.681653022766113
Epoch: 13, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.352 Vali Acc: 0.923 Test Loss: 0.352 Test Acc: 0.923
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 8495316
model size : 33.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 53.67348885536194
Epoch: 1, Steps: 89 | Train Loss: 1.212 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
Validation loss decreased (inf --> -0.915039).  Saving model ...
Epoch: 2 cost time: 51.749210357666016
Epoch: 2, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.915039 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 46.37126183509827
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 46.167256593704224
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 40.98445796966553
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.946377 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 45.32684898376465
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 47.4079053401947
Epoch: 7, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 45.232501745224
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.292 Vali Acc: 0.935 Test Loss: 0.292 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 46.564778566360474
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.409 Vali Acc: 0.930 Test Loss: 0.409 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 44.97673034667969
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.229 Vali Acc: 0.953 Test Loss: 0.229 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 43.51890182495117
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 43.16698408126831
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.250 Vali Acc: 0.953 Test Loss: 0.250 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 41.82600736618042
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.271 Vali Acc: 0.962 Test Loss: 0.271 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.962393).  Saving model ...
Epoch: 14 cost time: 41.47944903373718
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.275 Vali Acc: 0.948 Test Loss: 0.275 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 38.99108910560608
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.206 Vali Acc: 0.962 Test Loss: 0.206 Test Acc: 0.962
Validation loss decreased (-0.962393 --> -0.962393).  Saving model ...
Epoch: 16 cost time: 39.00038504600525
Epoch: 16, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.368 Vali Acc: 0.936 Test Loss: 0.368 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 42.309141635894775
Epoch: 17, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 41.45417785644531
Epoch: 18, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.304 Vali Acc: 0.951 Test Loss: 0.304 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 41.65137219429016
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.474 Vali Acc: 0.929 Test Loss: 0.474 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 42.58990430831909
Epoch: 20, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.590 Vali Acc: 0.895 Test Loss: 0.590 Test Acc: 0.895
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 44.114665269851685
Epoch: 21, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.349 Vali Acc: 0.949 Test Loss: 0.349 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 46.53699350357056
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.287 Vali Acc: 0.963 Test Loss: 0.287 Test Acc: 0.963
Validation loss decreased (-0.962393 --> -0.963089).  Saving model ...
Epoch: 23 cost time: 45.05969166755676
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
Validation loss decreased (-0.963089 --> -0.966571).  Saving model ...
Epoch: 24 cost time: 45.88111615180969
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.370 Vali Acc: 0.957 Test Loss: 0.370 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 38.011706590652466
Epoch: 25, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.332 Vali Acc: 0.949 Test Loss: 0.332 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 43.682992935180664
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.287 Vali Acc: 0.961 Test Loss: 0.287 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 45.4862756729126
Epoch: 27, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.452 Vali Acc: 0.937 Test Loss: 0.452 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 44.830177545547485
Epoch: 28, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.427 Vali Acc: 0.939 Test Loss: 0.427 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 44.802326917648315
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.510 Vali Acc: 0.946 Test Loss: 0.510 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 44.333738803863525
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.340 Vali Acc: 0.970 Test Loss: 0.340 Test Acc: 0.970
Validation loss decreased (-0.966571 --> -0.970052).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 14294868
model size : 55.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.71593713760376
Epoch: 1, Steps: 89 | Train Loss: 1.216 Vali Loss: 0.267 Vali Acc: 0.928 Test Loss: 0.267 Test Acc: 0.928
Validation loss decreased (inf --> -0.927574).  Saving model ...
Epoch: 2 cost time: 18.879133939743042
Epoch: 2, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.532308340072632
Epoch: 3, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.283 Vali Acc: 0.910 Test Loss: 0.283 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.71161150932312
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.927574 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 21.404261589050293
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.491230487823486
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.148603677749634
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.380911111831665
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.331 Vali Acc: 0.936 Test Loss: 0.331 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 21.737972259521484
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 17.790331840515137
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.309 Vali Acc: 0.936 Test Loss: 0.309 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.876043558120728
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.370 Vali Acc: 0.917 Test Loss: 0.370 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.098673343658447
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 21.34485173225403
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.267 Vali Acc: 0.962 Test Loss: 0.267 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 17.3375244140625
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.246 Vali Acc: 0.963 Test Loss: 0.246 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 4365012
model size : 17.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 31.477262020111084
Epoch: 1, Steps: 89 | Train Loss: 1.251 Vali Loss: 0.279 Vali Acc: 0.919 Test Loss: 0.279 Test Acc: 0.919
Validation loss decreased (inf --> -0.919217).  Saving model ...
Epoch: 2 cost time: 32.54568529129028
Epoch: 2, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.919217 --> -0.949163).  Saving model ...
Epoch: 3 cost time: 36.22170305252075
Epoch: 3, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
Validation loss decreased (-0.949163 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 30.865326404571533
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.577 Vali Acc: 0.914 Test Loss: 0.577 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.350276708602905
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 35.48031497001648
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.286 Vali Acc: 0.927 Test Loss: 0.286 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 34.788891315460205
Epoch: 7, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.340 Vali Acc: 0.927 Test Loss: 0.340 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 30.413764476776123
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 32.06923484802246
Epoch: 9, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.393 Vali Acc: 0.916 Test Loss: 0.393 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 35.931573152542114
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.240 Vali Acc: 0.938 Test Loss: 0.240 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 33.653427839279175
Epoch: 11, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.369 Vali Acc: 0.932 Test Loss: 0.369 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 30.574637413024902
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.371 Vali Acc: 0.939 Test Loss: 0.371 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 33.53688621520996
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.272 Vali Acc: 0.947 Test Loss: 0.272 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 35.826088190078735
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.262 Vali Acc: 0.946 Test Loss: 0.262 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 31.900707960128784
Epoch: 15, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.232 Vali Acc: 0.947 Test Loss: 0.232 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 14294868
model size : 55.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.276569604873657
Epoch: 1, Steps: 89 | Train Loss: 1.263 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
Validation loss decreased (inf --> -0.919217).  Saving model ...
Epoch: 2 cost time: 15.000834941864014
Epoch: 2, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.919217 --> -0.940806).  Saving model ...
Epoch: 3 cost time: 13.584379434585571
Epoch: 3, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.164 Vali Acc: 0.945 Test Loss: 0.164 Test Acc: 0.945
Validation loss decreased (-0.940806 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 16.28957962989807
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.944984 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 13.212778568267822
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
Validation loss decreased (-0.951948 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 16.368950843811035
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.961 Test Loss: 0.123 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.541812181472778
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.256 Vali Acc: 0.936 Test Loss: 0.256 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.054878234863281
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.825119495391846
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.676701545715332
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.240 Vali Acc: 0.957 Test Loss: 0.240 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.922790288925171
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.300 Vali Acc: 0.944 Test Loss: 0.300 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.674288511276245
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.293 Vali Acc: 0.948 Test Loss: 0.293 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.762338638305664
Epoch: 13, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.301 Vali Acc: 0.946 Test Loss: 0.301 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 14.43306565284729
Epoch: 14, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.300 Vali Acc: 0.955 Test Loss: 0.300 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.311950445175171
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.239 Vali Acc: 0.969 Test Loss: 0.239 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968661).  Saving model ...
Epoch: 16 cost time: 14.592893123626709
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.344 Vali Acc: 0.937 Test Loss: 0.344 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.26228928565979
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.333 Vali Acc: 0.945 Test Loss: 0.333 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.463423013687134
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.415 Vali Acc: 0.943 Test Loss: 0.415 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.678802251815796
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.337 Vali Acc: 0.953 Test Loss: 0.337 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.27871584892273
Epoch: 20, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.505 Vali Acc: 0.940 Test Loss: 0.505 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 12.167810440063477
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.533 Vali Acc: 0.947 Test Loss: 0.533 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 12.942429065704346
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.299 Vali Acc: 0.966 Test Loss: 0.299 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 12.97790265083313
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.280 Vali Acc: 0.961 Test Loss: 0.280 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 12.120072841644287
Epoch: 24, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.327 Vali Acc: 0.960 Test Loss: 0.327 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 14.066112756729126
Epoch: 25, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.502 Vali Acc: 0.948 Test Loss: 0.502 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 4365012
model size : 17.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.186893224716187
Epoch: 1, Steps: 89 | Train Loss: 1.285 Vali Loss: 0.349 Vali Acc: 0.893 Test Loss: 0.349 Test Acc: 0.893
Validation loss decreased (inf --> -0.893451).  Saving model ...
Epoch: 2 cost time: 11.970903635025024
Epoch: 2, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
Validation loss decreased (-0.893451 --> -0.918521).  Saving model ...
Epoch: 3 cost time: 14.306537866592407
Epoch: 3, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.918521 --> -0.930360).  Saving model ...
Epoch: 4 cost time: 13.833048343658447
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.504 Vali Acc: 0.906 Test Loss: 0.504 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.286200523376465
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.930360 --> -0.934538).  Saving model ...
Epoch: 6 cost time: 15.444398641586304
Epoch: 6, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.934538 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 12.483397245407104
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.948 Vali Acc: 0.859 Test Loss: 0.948 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.438192367553711
Epoch: 8, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
Validation loss decreased (-0.949859 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 13.140318155288696
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.955430).  Saving model ...
Epoch: 10 cost time: 14.141287088394165
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.30213713645935
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.041370630264282
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.824893236160278
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.342 Vali Acc: 0.923 Test Loss: 0.342 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.244263887405396
Epoch: 14, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.436 Vali Acc: 0.902 Test Loss: 0.436 Test Acc: 0.902
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.023653507232666
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.324 Vali Acc: 0.946 Test Loss: 0.324 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 16.21796727180481
Epoch: 16, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.570 Vali Acc: 0.901 Test Loss: 0.570 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.582168817520142
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 15.796756744384766
Epoch: 18, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
Validation loss decreased (-0.955430 --> -0.956822).  Saving model ...
Epoch: 19 cost time: 16.093371868133545
Epoch: 19, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.243279218673706
Epoch: 20, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.542 Vali Acc: 0.907 Test Loss: 0.542 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 16.421509504318237
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.508 Vali Acc: 0.922 Test Loss: 0.508 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.804638862609863
Epoch: 22, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.536 Vali Acc: 0.904 Test Loss: 0.536 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 13.773694276809692
Epoch: 23, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.904 Vali Acc: 0.887 Test Loss: 0.904 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 17.935298442840576
Epoch: 24, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 14.527108430862427
Epoch: 25, Steps: 89 | Train Loss: 0.089 Vali Loss: 1.011 Vali Acc: 0.889 Test Loss: 1.011 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 15.733539581298828
Epoch: 26, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.392 Vali Acc: 0.927 Test Loss: 0.392 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 16.595632076263428
Epoch: 27, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.930 Vali Acc: 0.861 Test Loss: 0.930 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 13.168527841567993
Epoch: 28, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.371 Vali Acc: 0.943 Test Loss: 0.371 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 14294868
model size : 55.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.907796382904053
Epoch: 1, Steps: 89 | Train Loss: 1.315 Vali Loss: 0.310 Vali Acc: 0.903 Test Loss: 0.310 Test Acc: 0.903
Validation loss decreased (inf --> -0.902504).  Saving model ...
Epoch: 2 cost time: 8.391347646713257
Epoch: 2, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
Validation loss decreased (-0.902504 --> -0.925485).  Saving model ...
Epoch: 3 cost time: 6.964358329772949
Epoch: 3, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.925485 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 9.144880294799805
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.162 Vali Acc: 0.947 Test Loss: 0.162 Test Acc: 0.947
Validation loss decreased (-0.932449 --> -0.947074).  Saving model ...
Epoch: 5 cost time: 7.112675428390503
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.239 Vali Acc: 0.932 Test Loss: 0.239 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.907427072525024
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.184845209121704
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.722126245498657
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.236 Vali Acc: 0.939 Test Loss: 0.236 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.710313320159912
Epoch: 9, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.947074 --> -0.952644).  Saving model ...
Epoch: 10 cost time: 7.12152361869812
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.415 Vali Acc: 0.919 Test Loss: 0.415 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.676176309585571
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.368 Vali Acc: 0.932 Test Loss: 0.368 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.9139158725738525
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.772804260253906
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.524378061294556
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.333 Vali Acc: 0.938 Test Loss: 0.333 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.224276065826416
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.945 Test Loss: 0.287 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.756207466125488
Epoch: 16, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
Validation loss decreased (-0.952644 --> -0.959608).  Saving model ...
Epoch: 17 cost time: 6.86618971824646
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.288 Vali Acc: 0.957 Test Loss: 0.288 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.821863412857056
Epoch: 18, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.447 Vali Acc: 0.919 Test Loss: 0.447 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.805626392364502
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.648499250411987
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.920 Vali Acc: 0.901 Test Loss: 0.920 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.509159326553345
Epoch: 21, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.570 Vali Acc: 0.913 Test Loss: 0.570 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.288772344589233
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.506 Vali Acc: 0.903 Test Loss: 0.506 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.216216325759888
Epoch: 23, Steps: 89 | Train Loss: 0.082 Vali Loss: 1.264 Vali Acc: 0.886 Test Loss: 1.264 Test Acc: 0.886
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.489286661148071
Epoch: 24, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.471 Vali Acc: 0.928 Test Loss: 0.471 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.25351357460022
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.330 Vali Acc: 0.954 Test Loss: 0.330 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.04032826423645
Epoch: 26, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.628 Vali Acc: 0.916 Test Loss: 0.628 Test Acc: 0.916
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9596100278551533
model parameter : 4365012
model size : 17.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.800564289093018
Epoch: 1, Steps: 89 | Train Loss: 1.267 Vali Loss: 0.362 Vali Acc: 0.895 Test Loss: 0.362 Test Acc: 0.895
Validation loss decreased (inf --> -0.894843).  Saving model ...
Epoch: 2 cost time: 26.323529481887817
Epoch: 2, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.894843 --> -0.943592).  Saving model ...
Epoch: 3 cost time: 25.73153853416443
Epoch: 3, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.281 Vali Acc: 0.929 Test Loss: 0.281 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.236254930496216
Epoch: 4, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
Validation loss decreased (-0.943592 --> -0.956127).  Saving model ...
Epoch: 5 cost time: 25.244033813476562
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.956127 --> -0.963091).  Saving model ...
Epoch: 6 cost time: 26.206550121307373
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.214 Vali Acc: 0.954 Test Loss: 0.214 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.524982929229736
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.216 Vali Acc: 0.947 Test Loss: 0.216 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.554328441619873
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.277435779571533
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.019323587417603
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.202 Vali Acc: 0.962 Test Loss: 0.202 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.926122665405273
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.862475395202637
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.276 Vali Acc: 0.957 Test Loss: 0.276 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 23.302573919296265
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.260 Vali Acc: 0.969 Test Loss: 0.260 Test Acc: 0.969
Validation loss decreased (-0.963091 --> -0.969357).  Saving model ...
Epoch: 14 cost time: 22.947863817214966
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.375 Vali Acc: 0.945 Test Loss: 0.375 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 31.80442237854004
Epoch: 15, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.330 Vali Acc: 0.953 Test Loss: 0.330 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 26.131245613098145
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 28.70351529121399
Epoch: 17, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 31.700950384140015
Epoch: 18, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.294 Vali Acc: 0.948 Test Loss: 0.294 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 27.0997314453125
Epoch: 19, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.268 Vali Acc: 0.963 Test Loss: 0.268 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 29.501044511795044
Epoch: 20, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.439 Vali Acc: 0.939 Test Loss: 0.439 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 31.916423320770264
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 27.45479464530945
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.244 Vali Acc: 0.965 Test Loss: 0.244 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 28.03816032409668
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.405 Vali Acc: 0.955 Test Loss: 0.405 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 7264980
model size : 28.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.507487297058105
Epoch: 1, Steps: 89 | Train Loss: 1.259 Vali Loss: 0.321 Vali Acc: 0.909 Test Loss: 0.321 Test Acc: 0.909
Validation loss decreased (inf --> -0.908771).  Saving model ...
Epoch: 2 cost time: 12.158034324645996
Epoch: 2, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.908771 --> -0.960305).  Saving model ...
Epoch: 3 cost time: 14.560466289520264
Epoch: 3, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.711015224456787
Epoch: 4, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.671864748001099
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
Validation loss decreased (-0.960305 --> -0.963091).  Saving model ...
Epoch: 6 cost time: 14.293470621109009
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 12.001087665557861
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.40558123588562
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.745649576187134
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.173275470733643
Epoch: 10, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.342 Vali Acc: 0.931 Test Loss: 0.342 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.531558990478516
Epoch: 11, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.437 Vali Acc: 0.916 Test Loss: 0.437 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.79352355003357
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.251 Vali Acc: 0.961 Test Loss: 0.251 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.05989956855774
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.40598440170288
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.049701452255249
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.244 Vali Acc: 0.960 Test Loss: 0.244 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.509340047836304
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.336 Vali Acc: 0.948 Test Loss: 0.336 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 2299860
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.357908487319946
Epoch: 1, Steps: 89 | Train Loss: 1.309 Vali Loss: 0.311 Vali Acc: 0.910 Test Loss: 0.311 Test Acc: 0.910
Validation loss decreased (inf --> -0.910164).  Saving model ...
Epoch: 2 cost time: 18.866860389709473
Epoch: 2, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.910164 --> -0.924789).  Saving model ...
Epoch: 3 cost time: 20.854381322860718
Epoch: 3, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.924789 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 19.425163507461548
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.874459505081177
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.956126 --> -0.956127).  Saving model ...
Epoch: 6 cost time: 19.80344843864441
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.646393537521362
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.729020595550537
Epoch: 8, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.468 Vali Acc: 0.914 Test Loss: 0.468 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.231816291809082
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.247708082199097
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.267 Vali Acc: 0.945 Test Loss: 0.267 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 16.79163098335266
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.309 Vali Acc: 0.932 Test Loss: 0.309 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.891059398651123
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.956127 --> -0.959608).  Saving model ...
Epoch: 13 cost time: 18.54430055618286
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.232 Vali Acc: 0.953 Test Loss: 0.232 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.472256660461426
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.956 Test Loss: 0.239 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.56519889831543
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.875944137573242
Epoch: 16, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.275 Vali Acc: 0.955 Test Loss: 0.275 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 17.75459361076355
Epoch: 17, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.270 Vali Acc: 0.955 Test Loss: 0.270 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.292842626571655
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.290 Vali Acc: 0.951 Test Loss: 0.290 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 16.172953128814697
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.968 Test Loss: 0.214 Test Acc: 0.968
Validation loss decreased (-0.959608 --> -0.967964).  Saving model ...
Epoch: 20 cost time: 19.56125569343567
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.557 Vali Acc: 0.926 Test Loss: 0.557 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 16.293102502822876
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.594 Vali Acc: 0.919 Test Loss: 0.594 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 17.463284492492676
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.354 Vali Acc: 0.951 Test Loss: 0.354 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 18.57378339767456
Epoch: 23, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.349 Vali Acc: 0.952 Test Loss: 0.349 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 16.808271646499634
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.276 Vali Acc: 0.964 Test Loss: 0.276 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 19.333439588546753
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.338 Vali Acc: 0.956 Test Loss: 0.338 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 16.340065717697144
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.337 Vali Acc: 0.948 Test Loss: 0.337 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 17.7997727394104
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.359 Vali Acc: 0.955 Test Loss: 0.359 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 18.21292495727539
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.478 Vali Acc: 0.953 Test Loss: 0.478 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 16.46405029296875
Epoch: 29, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.451 Vali Acc: 0.958 Test Loss: 0.451 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 7264980
model size : 28.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.660125255584717
Epoch: 1, Steps: 89 | Train Loss: 1.302 Vali Loss: 0.301 Vali Acc: 0.915 Test Loss: 0.301 Test Acc: 0.915
Validation loss decreased (inf --> -0.915039).  Saving model ...
Epoch: 2 cost time: 8.683544397354126
Epoch: 2, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.915039 --> -0.956823).  Saving model ...
Epoch: 3 cost time: 8.39252781867981
Epoch: 3, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.295120477676392
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.953831195831299
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.956 Test Loss: 0.146 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.143476247787476
Epoch: 6, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 7.551318407058716
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.299 Vali Acc: 0.915 Test Loss: 0.299 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.535185098648071
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.412 Vali Acc: 0.907 Test Loss: 0.412 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.209989309310913
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.213181495666504
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.103940486907959
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.003302812576294
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.799173593521118
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.297 Vali Acc: 0.940 Test Loss: 0.297 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.180123567581177
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.368 Vali Acc: 0.934 Test Loss: 0.368 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.006133079528809
Epoch: 15, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.280 Vali Acc: 0.956 Test Loss: 0.280 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.912958145141602
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 2299860
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.435384273529053
Epoch: 1, Steps: 89 | Train Loss: 1.348 Vali Loss: 0.369 Vali Acc: 0.883 Test Loss: 0.369 Test Acc: 0.883
Validation loss decreased (inf --> -0.883005).  Saving model ...
Epoch: 2 cost time: 9.142624616622925
Epoch: 2, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.263 Vali Acc: 0.916 Test Loss: 0.263 Test Acc: 0.916
Validation loss decreased (-0.883005 --> -0.916432).  Saving model ...
Epoch: 3 cost time: 10.331371307373047
Epoch: 3, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
Validation loss decreased (-0.916432 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 10.634377241134644
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.946377 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 9.48691201210022
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.66171407699585
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.467310905456543
Epoch: 7, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 11.079319715499878
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.328346729278564
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.425824403762817
Epoch: 10, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.966572).  Saving model ...
Epoch: 11 cost time: 11.50834321975708
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 8.940794706344604
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972143).  Saving model ...
Epoch: 13 cost time: 11.652249813079834
Epoch: 13, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.662740230560303
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.988513469696045
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.753056526184082
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.256 Vali Acc: 0.955 Test Loss: 0.256 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.207542896270752
Epoch: 17, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.214 Vali Acc: 0.962 Test Loss: 0.214 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.8411123752594
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.966 Test Loss: 0.203 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.936506986618042
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.477 Vali Acc: 0.952 Test Loss: 0.477 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.679684162139893
Epoch: 20, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.251 Vali Acc: 0.955 Test Loss: 0.251 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.341427564620972
Epoch: 21, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.281 Vali Acc: 0.957 Test Loss: 0.281 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.424949884414673
Epoch: 22, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 7264980
model size : 28.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.046504974365234
Epoch: 1, Steps: 89 | Train Loss: 1.331 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
Validation loss decreased (inf --> -0.905985).  Saving model ...
Epoch: 2 cost time: 4.801711082458496
Epoch: 2, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.199 Test Acc: 0.942
Validation loss decreased (-0.905985 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 5.985540390014648
Epoch: 3, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.204 Vali Acc: 0.935 Test Loss: 0.204 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.778530120849609
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
Validation loss decreased (-0.941502 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 4.797924280166626
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.7963104248046875
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
Validation loss decreased (-0.948466 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 5.90485692024231
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.405 Vali Acc: 0.932 Test Loss: 0.405 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.147895812988281
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6056742668151855
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.960305 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 4.76861834526062
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.725038290023804
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.376251220703125
Epoch: 12, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.167143821716309
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.942 Test Loss: 0.260 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.3176727294921875
Epoch: 14, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.718333721160889
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.865860223770142
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.857895374298096
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.811201810836792
Epoch: 18, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.380 Vali Acc: 0.935 Test Loss: 0.380 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.762466192245483
Epoch: 19, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 2299860
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 34.24452352523804
Epoch: 1, Steps: 89 | Train Loss: 1.560 Vali Loss: 0.404 Vali Acc: 0.902 Test Loss: 0.404 Test Acc: 0.902
Validation loss decreased (inf --> -0.901807).  Saving model ...
Epoch: 2 cost time: 32.73170471191406
Epoch: 2, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.901807 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 31.224549531936646
Epoch: 3, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
Validation loss decreased (-0.936627 --> -0.949163).  Saving model ...
Epoch: 4 cost time: 30.413318395614624
Epoch: 4, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.949163 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 29.015289306640625
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.764015197753906
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 30.996583223342896
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 32.447885274887085
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 33.830825090408325
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 28.482343196868896
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 28.17664361000061
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.209 Vali Acc: 0.940 Test Loss: 0.209 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 27.260210275650024
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 27.638480186462402
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 27.453499794006348
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 27.797024488449097
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 27.844542741775513
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 27.319695711135864
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 27.403119802474976
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 27.23140811920166
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.417 Vali Acc: 0.910 Test Loss: 0.417 Test Acc: 0.910
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 27.76291513442993
Epoch: 20, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 27.540759325027466
Epoch: 21, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.272 Vali Acc: 0.953 Test Loss: 0.272 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 27.709167003631592
Epoch: 22, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.419 Vali Acc: 0.935 Test Loss: 0.419 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 27.281758546829224
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.484 Vali Acc: 0.919 Test Loss: 0.484 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 7148596
model size : 27.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.513980150222778
Epoch: 1, Steps: 89 | Train Loss: 1.555 Vali Loss: 0.391 Vali Acc: 0.896 Test Loss: 0.391 Test Acc: 0.896
Validation loss decreased (inf --> -0.896236).  Saving model ...
Epoch: 2 cost time: 12.80079460144043
Epoch: 2, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
Validation loss decreased (-0.896236 --> -0.954734).  Saving model ...
Epoch: 3 cost time: 14.936663150787354
Epoch: 3, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.246535062789917
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.191 Vali Acc: 0.942 Test Loss: 0.191 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.130064964294434
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.954734 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 14.832449674606323
Epoch: 6, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.113179683685303
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.782662391662598
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.925325155258179
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.356059789657593
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.962394).  Saving model ...
Epoch: 11 cost time: 13.571277141571045
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.219 Vali Acc: 0.955 Test Loss: 0.219 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.030280113220215
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.813318490982056
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 14.159745454788208
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.33209991455078
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.271 Vali Acc: 0.946 Test Loss: 0.271 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.889254093170166
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.934664487838745
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 15.552103996276855
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.825722694396973
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 15.643610954284668
Epoch: 20, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 15.199505805969238
Epoch: 21, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.308 Vali Acc: 0.942 Test Loss: 0.308 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 13.676649332046509
Epoch: 22, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.953 Test Loss: 0.232 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 15.71826696395874
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 2183284
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 20.777445077896118
Epoch: 1, Steps: 89 | Train Loss: 1.599 Vali Loss: 0.450 Vali Acc: 0.888 Test Loss: 0.450 Test Acc: 0.888
Validation loss decreased (inf --> -0.887879).  Saving model ...
Epoch: 2 cost time: 19.799583196640015
Epoch: 2, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.226 Vali Acc: 0.932 Test Loss: 0.226 Test Acc: 0.932
Validation loss decreased (-0.887879 --> -0.931753).  Saving model ...
Epoch: 3 cost time: 20.571233987808228
Epoch: 3, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.931753 --> -0.944288).  Saving model ...
Epoch: 4 cost time: 21.06870198249817
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.944288 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 20.020912170410156
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.193 Vali Acc: 0.940 Test Loss: 0.193 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.726123094558716
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.244 Vali Acc: 0.928 Test Loss: 0.244 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.474924087524414
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.047598361968994
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 20.309892177581787
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.258 Vali Acc: 0.929 Test Loss: 0.258 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.582539081573486
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.263 Vali Acc: 0.939 Test Loss: 0.263 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.201754331588745
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.406 Vali Acc: 0.893 Test Loss: 0.406 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.227675676345825
Epoch: 12, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.351 Vali Acc: 0.924 Test Loss: 0.351 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.491039037704468
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 18.597920417785645
Epoch: 14, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 18.66064715385437
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.441 Vali Acc: 0.929 Test Loss: 0.441 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 18.576642513275146
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.223 Vali Acc: 0.953 Test Loss: 0.223 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 18.51657772064209
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.340 Vali Acc: 0.920 Test Loss: 0.340 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 18.193714380264282
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 7148596
model size : 27.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.822602987289429
Epoch: 1, Steps: 89 | Train Loss: 1.576 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
Validation loss decreased (inf --> -0.899021).  Saving model ...
Epoch: 2 cost time: 10.221063375473022
Epoch: 2, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
Validation loss decreased (-0.899021 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 9.543230772018433
Epoch: 3, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
Validation loss decreased (-0.939413 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 8.532347679138184
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.039042472839355
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
Validation loss decreased (-0.953341 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 8.287792205810547
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.114306211471558
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.269 Vali Acc: 0.928 Test Loss: 0.269 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.421529531478882
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.116411209106445
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.953341 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 7.973703861236572
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.916874647140503
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.48551344871521
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.9625723361969
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.196 Vali Acc: 0.957 Test Loss: 0.196 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.843155860900879
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.390 Vali Acc: 0.923 Test Loss: 0.390 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.24112343788147
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.370 Vali Acc: 0.916 Test Loss: 0.370 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.26305079460144
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.600259780883789
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.962 Test Loss: 0.219 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962393).  Saving model ...
Epoch: 18 cost time: 11.403584003448486
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.964 Test Loss: 0.188 Test Acc: 0.964
Validation loss decreased (-0.962393 --> -0.963786).  Saving model ...
Epoch: 19 cost time: 9.501768589019775
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
Validation loss decreased (-0.963786 --> -0.968661).  Saving model ...
Epoch: 20 cost time: 9.888435125350952
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.958 Test Loss: 0.235 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.480339050292969
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.278 Vali Acc: 0.945 Test Loss: 0.278 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.89099931716919
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.232 Vali Acc: 0.962 Test Loss: 0.232 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.569286346435547
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.555 Vali Acc: 0.917 Test Loss: 0.555 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.294886589050293
Epoch: 24, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.290 Vali Acc: 0.946 Test Loss: 0.290 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 10.00138235092163
Epoch: 25, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 9.585021257400513
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.198 Vali Acc: 0.961 Test Loss: 0.198 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.27423620223999
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.375 Vali Acc: 0.929 Test Loss: 0.375 Test Acc: 0.929
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.933293581008911
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 9.457762718200684
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.287 Vali Acc: 0.948 Test Loss: 0.287 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 2183284
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.064585208892822
Epoch: 1, Steps: 89 | Train Loss: 1.647 Vali Loss: 0.439 Vali Acc: 0.907 Test Loss: 0.439 Test Acc: 0.907
Validation loss decreased (inf --> -0.906681).  Saving model ...
Epoch: 2 cost time: 9.624015092849731
Epoch: 2, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.275 Vali Acc: 0.918 Test Loss: 0.275 Test Acc: 0.918
Validation loss decreased (-0.906681 --> -0.917825).  Saving model ...
Epoch: 3 cost time: 12.367422580718994
Epoch: 3, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.254 Vali Acc: 0.924 Test Loss: 0.254 Test Acc: 0.924
Validation loss decreased (-0.917825 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 10.091004371643066
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.924092 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 9.76671051979065
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.929663 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 12.102945566177368
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.36955189704895
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.47018551826477
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.286 Vali Acc: 0.916 Test Loss: 0.286 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.656735181808472
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.087133407592773
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.14665174484253
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.61451244354248
Epoch: 12, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.281 Vali Acc: 0.912 Test Loss: 0.281 Test Acc: 0.912
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.488933801651001
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.131035566329956
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.054057598114014
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.419 Vali Acc: 0.921 Test Loss: 0.419 Test Acc: 0.921
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 7148596
model size : 27.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.678990840911865
Epoch: 1, Steps: 89 | Train Loss: 1.640 Vali Loss: 0.452 Vali Acc: 0.886 Test Loss: 0.452 Test Acc: 0.886
Validation loss decreased (inf --> -0.885789).  Saving model ...
Epoch: 2 cost time: 6.783637046813965
Epoch: 2, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.885789 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 6.028316497802734
Epoch: 3, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.936627 --> -0.938717).  Saving model ...
Epoch: 4 cost time: 5.977415323257446
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
Validation loss decreased (-0.938717 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 7.276090145111084
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
Validation loss decreased (-0.940109 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 7.007901668548584
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 5.665759563446045
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.5447423458099365
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.687622308731079
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.9476401805877686
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.221 Vali Acc: 0.932 Test Loss: 0.221 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.1353394985198975
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.129136800765991
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.321549415588379
Epoch: 13, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.216 Vali Acc: 0.945 Test Loss: 0.216 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.386388778686523
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970055).  Saving model ...
Epoch: 15 cost time: 7.741675615310669
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.349076271057129
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.790805101394653
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.187412738800049
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.284809589385986
Epoch: 19, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.251844167709351
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.5422682762146
Epoch: 21, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.212 Vali Acc: 0.955 Test Loss: 0.212 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.082960367202759
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.359332084655762
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.395 Vali Acc: 0.910 Test Loss: 0.395 Test Acc: 0.910
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.168287038803101
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 2183284
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.768213510513306
Epoch: 1, Steps: 89 | Train Loss: 1.561 Vali Loss: 0.421 Vali Acc: 0.888 Test Loss: 0.421 Test Acc: 0.888
Validation loss decreased (inf --> -0.887879).  Saving model ...
Epoch: 2 cost time: 18.76789355278015
Epoch: 2, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
Validation loss decreased (-0.887879 --> -0.942199).  Saving model ...
Epoch: 3 cost time: 23.962476015090942
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.942199 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 19.913493156433105
Epoch: 4, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.176 Vali Acc: 0.945 Test Loss: 0.176 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.06651473045349
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.46533513069153
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.505307912826538
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.32897663116455
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 20.574963569641113
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 18.2585232257843
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.715065717697144
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 19.47368597984314
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.786441802978516
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 19.927266597747803
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 19.748997449874878
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 18.46761202812195
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 20.200942516326904
Epoch: 17, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 18.26192569732666
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.293 Vali Acc: 0.939 Test Loss: 0.293 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 18.229270696640015
Epoch: 19, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.973851442337036
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.253 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.397621870040894
Epoch: 21, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.251 Vali Acc: 0.953 Test Loss: 0.251 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 3633076
model size : 14.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.607943534851074
Epoch: 1, Steps: 89 | Train Loss: 1.646 Vali Loss: 0.491 Vali Acc: 0.866 Test Loss: 0.491 Test Acc: 0.866
Validation loss decreased (inf --> -0.866290).  Saving model ...
Epoch: 2 cost time: 11.715373277664185
Epoch: 2, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.236 Vali Acc: 0.936 Test Loss: 0.236 Test Acc: 0.936
Validation loss decreased (-0.866290 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 9.444199323654175
Epoch: 3, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.935931 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 11.376338720321655
Epoch: 4, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.336317777633667
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 10.202105045318604
Epoch: 6, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 10.803441762924194
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.325816869735718
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.744217872619629
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.417397499084473
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.505547761917114
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 11.806206941604614
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.076656341552734
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.399658679962158
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.75272011756897
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.219983577728271
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.608160018920898
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.147427320480347
Epoch: 18, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.862616062164307
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.033400297164917
Epoch: 20, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.93169903755188
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1150324
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.489187717437744
Epoch: 1, Steps: 89 | Train Loss: 1.597 Vali Loss: 0.447 Vali Acc: 0.884 Test Loss: 0.447 Test Acc: 0.884
Validation loss decreased (inf --> -0.884397).  Saving model ...
Epoch: 2 cost time: 14.038562536239624
Epoch: 2, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
Validation loss decreased (-0.884397 --> -0.950555).  Saving model ...
Epoch: 3 cost time: 12.8050057888031
Epoch: 3, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.939547777175903
Epoch: 4, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 13.441365957260132
Epoch: 5, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.955430 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 13.46480655670166
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.133 Vali Acc: 0.958 Test Loss: 0.133 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.32667326927185
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.279563426971436
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.362 Vali Acc: 0.907 Test Loss: 0.362 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.188338994979858
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.167 Vali Acc: 0.942 Test Loss: 0.167 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.553921699523926
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.03141736984253
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 16.012312650680542
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.945122480392456
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.934 Test Loss: 0.235 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.678072214126587
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.942 Test Loss: 0.208 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.50537919998169
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.939999341964722
Epoch: 16, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.277 Vali Acc: 0.934 Test Loss: 0.277 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.8227698802948
Epoch: 17, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.171929359436035
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.364 Vali Acc: 0.945 Test Loss: 0.364 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.463863372802734
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.282 Vali Acc: 0.952 Test Loss: 0.282 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.239447593688965
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.962454080581665
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.357 Vali Acc: 0.936 Test Loss: 0.357 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 3633076
model size : 14.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.343428134918213
Epoch: 1, Steps: 89 | Train Loss: 1.684 Vali Loss: 0.531 Vali Acc: 0.849 Test Loss: 0.531 Test Acc: 0.849
Validation loss decreased (inf --> -0.848880).  Saving model ...
Epoch: 2 cost time: 8.036564588546753
Epoch: 2, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
Validation loss decreased (-0.848880 --> -0.957519).  Saving model ...
Epoch: 3 cost time: 7.003825664520264
Epoch: 3, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.261183023452759
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.162 Vali Acc: 0.947 Test Loss: 0.162 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.66463589668274
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.574479579925537
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.957519 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 6.754395246505737
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.356484413146973
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 7.693231105804443
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.24728798866272
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.159851789474487
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.130906581878662
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.955 Test Loss: 0.156 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.978745222091675
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.484288215637207
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.033719062805176
Epoch: 15, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.194 Vali Acc: 0.953 Test Loss: 0.194 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.875681638717651
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.051013231277466
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.377 Vali Acc: 0.918 Test Loss: 0.377 Test Acc: 0.918
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.994045257568359
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 1150324
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.911606311798096
Epoch: 1, Steps: 89 | Train Loss: 1.615 Vali Loss: 0.492 Vali Acc: 0.869 Test Loss: 0.492 Test Acc: 0.869
Validation loss decreased (inf --> -0.869076).  Saving model ...
Epoch: 2 cost time: 6.9582250118255615
Epoch: 2, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
Validation loss decreased (-0.869076 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 7.419859409332275
Epoch: 3, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.177 Vali Acc: 0.945 Test Loss: 0.177 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.10851526260376
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.0916407108306885
Epoch: 5, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
Validation loss decreased (-0.953341 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 7.661148309707642
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 8.120423316955566
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.497010707855225
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.128 Vali Acc: 0.956 Test Loss: 0.128 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.664856433868408
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.556040048599243
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.304961681365967
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.412994384765625
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.973352432250977
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.419512987136841
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.180 Vali Acc: 0.945 Test Loss: 0.180 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.938364505767822
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.369972467422485
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 3633076
model size : 14.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.5418031215667725
Epoch: 1, Steps: 89 | Train Loss: 1.710 Vali Loss: 0.570 Vali Acc: 0.853 Test Loss: 0.570 Test Acc: 0.853
Validation loss decreased (inf --> -0.853058).  Saving model ...
Epoch: 2 cost time: 4.0032970905303955
Epoch: 2, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
Validation loss decreased (-0.853058 --> -0.951252).  Saving model ...
Epoch: 3 cost time: 3.9781267642974854
Epoch: 3, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.782290935516357
Epoch: 4, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
Validation loss decreased (-0.951252 --> -0.956127).  Saving model ...
Epoch: 5 cost time: 4.964188098907471
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.956127 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 4.281315088272095
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.2480504512786865
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.039483547210693
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.147166013717651
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.136855363845825
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 4.184812784194946
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 5.0209574699401855
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.693706750869751
Epoch: 13, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 3.9046671390533447
Epoch: 14, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.133744716644287
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.97896671295166
Epoch: 16, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.730562210083008
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.927 Test Loss: 0.275 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.191170692443848
Epoch: 18, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.201613664627075
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.231858491897583
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.244617938995361
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.060072660446167
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8574719429016113
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1150324
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.842802286148071
Epoch: 1, Steps: 89 | Train Loss: 1.633 Vali Loss: 0.456 Vali Acc: 0.896 Test Loss: 0.456 Test Acc: 0.896
Validation loss decreased (inf --> -0.896235).  Saving model ...
Epoch: 2 cost time: 10.391909837722778
Epoch: 2, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.896235 --> -0.942895).  Saving model ...
Epoch: 3 cost time: 11.467356204986572
Epoch: 3, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.942895 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 10.619853019714355
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.951948 --> -0.963091).  Saving model ...
Epoch: 5 cost time: 11.880871057510376
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 10.624112844467163
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.955 Test Loss: 0.137 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.326432704925537
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.974896907806396
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 10.288401126861572
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.964483 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 12.42824387550354
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.781169652938843
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.317123174667358
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.08964228630066
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.69710087776184
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.262939214706421
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.61010217666626
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.231 Vali Acc: 0.945 Test Loss: 0.231 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 12.450644493103027
Epoch: 17, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.311486959457397
Epoch: 18, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.352 Vali Acc: 0.912 Test Loss: 0.352 Test Acc: 0.912
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.707139253616333
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.307 Vali Acc: 0.936 Test Loss: 0.307 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1875316
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.013673543930054
Epoch: 1, Steps: 89 | Train Loss: 1.699 Vali Loss: 0.560 Vali Acc: 0.851 Test Loss: 0.560 Test Acc: 0.851
Validation loss decreased (inf --> -0.850969).  Saving model ...
Epoch: 2 cost time: 6.2358691692352295
Epoch: 2, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.222 Vali Acc: 0.942 Test Loss: 0.222 Test Acc: 0.942
Validation loss decreased (-0.850969 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 6.54557991027832
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.184 Vali Acc: 0.945 Test Loss: 0.184 Test Acc: 0.945
Validation loss decreased (-0.941502 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 5.521425485610962
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.944984 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 6.432578086853027
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 5.846874952316284
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.182261943817139
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.33425498008728
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.573487043380737
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.70186185836792
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.902568340301514
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.100919008255005
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.944921016693115
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.661535263061523
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.895982980728149
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 633844
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.642056941986084
Epoch: 1, Steps: 89 | Train Loss: 1.660 Vali Loss: 0.469 Vali Acc: 0.895 Test Loss: 0.469 Test Acc: 0.895
Validation loss decreased (inf --> -0.894842).  Saving model ...
Epoch: 2 cost time: 7.781570196151733
Epoch: 2, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (-0.894842 --> -0.950555).  Saving model ...
Epoch: 3 cost time: 8.71207046508789
Epoch: 3, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.952645).  Saving model ...
Epoch: 4 cost time: 7.33612585067749
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.952645 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 8.44495177268982
Epoch: 5, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 8.23668098449707
Epoch: 6, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.733687400817871
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.191 Vali Acc: 0.938 Test Loss: 0.191 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.325756311416626
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.753732681274414
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.81124496459961
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.505674839019775
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.789609432220459
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.200283765792847
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.167441129684448
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.04820990562439
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 1875316
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.64734411239624
Epoch: 1, Steps: 89 | Train Loss: 1.734 Vali Loss: 0.572 Vali Acc: 0.851 Test Loss: 0.572 Test Acc: 0.851
Validation loss decreased (inf --> -0.850969).  Saving model ...
Epoch: 2 cost time: 5.017606735229492
Epoch: 2, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
Validation loss decreased (-0.850969 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 5.140799045562744
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.7948832511901855
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
Validation loss decreased (-0.944984 --> -0.952645).  Saving model ...
Epoch: 5 cost time: 4.975763559341431
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
Validation loss decreased (-0.952645 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 5.030952453613281
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.041061878204346
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.685988426208496
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 4.91761589050293
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 5.564064025878906
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.9066996574401855
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.223294496536255
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.650800704956055
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.79421854019165
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.585079669952393
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.802617311477661
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.286 Vali Acc: 0.929 Test Loss: 0.286 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.568851709365845
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.9091269969940186
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.624715089797974
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 633844
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.758280992507935
Epoch: 1, Steps: 89 | Train Loss: 1.697 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
Validation loss decreased (inf --> -0.889271).  Saving model ...
Epoch: 2 cost time: 4.68982720375061
Epoch: 2, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.889271 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 4.533305644989014
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
Validation loss decreased (-0.948466 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 4.876699924468994
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 4.5316948890686035
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.611156702041626
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.300348520278931
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 4.830344200134277
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 5.002313613891602
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.345790147781372
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.581435918807983
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.932 Test Loss: 0.228 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.21433687210083
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.526362419128418
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.808617353439331
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.0128493309021
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 4.6723573207855225
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.274520397186279
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.67522931098938
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.217 Vali Acc: 0.955 Test Loss: 0.217 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.407988786697388
Epoch: 19, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.281451940536499
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.068007707595825
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.560367107391357
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.2047624588012695
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.519564151763916
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.16564416885376
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1875316
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.45216178894043
Epoch: 1, Steps: 89 | Train Loss: 1.792 Vali Loss: 0.586 Vali Acc: 0.858 Test Loss: 0.586 Test Acc: 0.858
Validation loss decreased (inf --> -0.857933).  Saving model ...
Epoch: 2 cost time: 3.078322410583496
Epoch: 2, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.857933 --> -0.949859).  Saving model ...
Epoch: 3 cost time: 3.3380351066589355
Epoch: 3, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
Validation loss decreased (-0.949859 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 2.957423686981201
Epoch: 4, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2697317600250244
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.961001 --> -0.977019).  Saving model ...
Epoch: 6 cost time: 3.5077147483825684
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.216602087020874
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3096277713775635
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1627087593078613
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4081926345825195
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.966 Test Loss: 0.103 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.668407678604126
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8350510597229004
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.040122985839844
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 2.8973612785339355
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.29263973236084
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6766912937164307
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8512051105499268
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.0341928005218506
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.613243341445923
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2474522590637207
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.454817771911621
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.284 Vali Acc: 0.938 Test Loss: 0.284 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.366306781768799
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1566174030303955
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 633844
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.83332371711731
Epoch: 1, Steps: 89 | Train Loss: 2.048 Vali Loss: 0.901 Vali Acc: 0.793 Test Loss: 0.901 Test Acc: 0.793
Validation loss decreased (inf --> -0.793166).  Saving model ...
Epoch: 2 cost time: 14.029529333114624
Epoch: 2, Steps: 89 | Train Loss: 0.483 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.793166 --> -0.905986).  Saving model ...
Epoch: 3 cost time: 13.188325881958008
Epoch: 3, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.905986 --> -0.931753).  Saving model ...
Epoch: 4 cost time: 13.80336332321167
Epoch: 4, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.186 Vali Acc: 0.945 Test Loss: 0.186 Test Acc: 0.945
Validation loss decreased (-0.931753 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 14.266852140426636
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.944984 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 14.55681300163269
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.948466 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 13.967793703079224
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 12.957911729812622
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970055).  Saving model ...
Epoch: 9 cost time: 14.240658044815063
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.969690322875977
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.891380548477173
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.543630838394165
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.337694644927979
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 13.834079504013062
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.39804482460022
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.188 Vali Acc: 0.947 Test Loss: 0.188 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.124569654464722
Epoch: 16, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.322 Vali Acc: 0.914 Test Loss: 0.322 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.539458274841309
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.564446449279785
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 13.686091661453247
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.148376703262329
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.554214239120483
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.776569843292236
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 24.993810892105103
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 24 cost time: 25.091322898864746
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 25 cost time: 24.60308027267456
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 25.62926697731018
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 25.091328382492065
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 25.73744297027588
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.176 Vali Acc: 0.966 Test Loss: 0.176 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 24.615496158599854
Epoch: 29, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 24.116819858551025
Epoch: 30, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.405 Vali Acc: 0.903 Test Loss: 0.405 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1817124
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.496309280395508
Epoch: 1, Steps: 89 | Train Loss: 2.091 Vali Loss: 0.871 Vali Acc: 0.843 Test Loss: 0.871 Test Acc: 0.843
Validation loss decreased (inf --> -0.842610).  Saving model ...
Epoch: 2 cost time: 14.630424976348877
Epoch: 2, Steps: 89 | Train Loss: 0.464 Vali Loss: 0.252 Vali Acc: 0.945 Test Loss: 0.252 Test Acc: 0.945
Validation loss decreased (-0.842610 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 14.344106435775757
Epoch: 3, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.944984 --> -0.958215).  Saving model ...
Epoch: 4 cost time: 14.529738187789917
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.958215 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 14.62062382698059
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 14.714284658432007
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.668134212493896
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.88078236579895
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.593115091323853
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.85129427909851
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 15.002013444900513
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.799686908721924
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 15.16990065574646
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.115190744400024
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.74576735496521
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 15.184183835983276
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.413702726364136
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.008002758026123
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.403012990951538
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.442840576171875
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.051815271377563
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.495051860809326
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 575556
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.88488745689392
Epoch: 1, Steps: 89 | Train Loss: 2.044 Vali Loss: 0.923 Vali Acc: 0.808 Test Loss: 0.923 Test Acc: 0.808
Validation loss decreased (inf --> -0.807790).  Saving model ...
Epoch: 2 cost time: 18.785481452941895
Epoch: 2, Steps: 89 | Train Loss: 0.498 Vali Loss: 0.362 Vali Acc: 0.893 Test Loss: 0.362 Test Acc: 0.893
Validation loss decreased (-0.807790 --> -0.892754).  Saving model ...
Epoch: 3 cost time: 18.29026508331299
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
Validation loss decreased (-0.892754 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 17.48937678337097
Epoch: 4, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
Validation loss decreased (-0.927574 --> -0.942895).  Saving model ...
Epoch: 5 cost time: 17.6553475856781
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.942895 --> -0.943592).  Saving model ...
Epoch: 6 cost time: 17.358569383621216
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
Validation loss decreased (-0.943592 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 17.74087166786194
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
Validation loss decreased (-0.948466 --> -0.954734).  Saving model ...
Epoch: 8 cost time: 18.151622772216797
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.176 Vali Acc: 0.940 Test Loss: 0.176 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.448533535003662
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.961698).  Saving model ...
Epoch: 10 cost time: 17.785472631454468
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 17.598459482192993
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 16.30161762237549
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.7409405708313
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.62628984451294
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 16.954601049423218
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.280002117156982
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.70500087738037
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 17.31117081642151
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.545024871826172
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 16.910524129867554
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 17.390727758407593
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 1817124
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.219354152679443
Epoch: 1, Steps: 89 | Train Loss: 2.085 Vali Loss: 0.886 Vali Acc: 0.843 Test Loss: 0.886 Test Acc: 0.843
Validation loss decreased (inf --> -0.842610).  Saving model ...
Epoch: 2 cost time: 12.067352294921875
Epoch: 2, Steps: 89 | Train Loss: 0.468 Vali Loss: 0.326 Vali Acc: 0.909 Test Loss: 0.326 Test Acc: 0.909
Validation loss decreased (-0.842610 --> -0.908771).  Saving model ...
Epoch: 3 cost time: 11.797895908355713
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.908771 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 11.455877542495728
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
Validation loss decreased (-0.950555 --> -0.956127).  Saving model ...
Epoch: 5 cost time: 11.702761173248291
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.956127 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 11.793987274169922
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.968662 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 11.83223271369934
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.205097913742065
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.521143674850464
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.836665153503418
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.366756916046143
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.63432765007019
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.961925029754639
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.96936821937561
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.277562856674194
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.25646686553955
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 575556
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.503226518630981
Epoch: 1, Steps: 89 | Train Loss: 2.163 Vali Loss: 1.067 Vali Acc: 0.765 Test Loss: 1.067 Test Acc: 0.765
Validation loss decreased (inf --> -0.765310).  Saving model ...
Epoch: 2 cost time: 10.96797800064087
Epoch: 2, Steps: 89 | Train Loss: 0.637 Vali Loss: 0.432 Vali Acc: 0.886 Test Loss: 0.432 Test Acc: 0.886
Validation loss decreased (-0.765310 --> -0.886486).  Saving model ...
Epoch: 3 cost time: 7.383179664611816
Epoch: 3, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.277 Vali Acc: 0.921 Test Loss: 0.277 Test Acc: 0.921
Validation loss decreased (-0.886486 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 10.955830097198486
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
Validation loss decreased (-0.920610 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 10.917445659637451
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.147 Vali Acc: 0.955 Test Loss: 0.147 Test Acc: 0.955
Validation loss decreased (-0.939413 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 10.885424375534058
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.955430 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 10.631127119064331
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.153 Vali Acc: 0.955 Test Loss: 0.153 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.773917198181152
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.689452171325684
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.963091 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 10.760235071182251
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.128 Vali Acc: 0.955 Test Loss: 0.128 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.908286571502686
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.050003051757812
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.110449075698853
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.297 Vali Acc: 0.945 Test Loss: 0.297 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.294476509094238
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.308 Vali Acc: 0.916 Test Loss: 0.308 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.974074840545654
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.869184494018555
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.983354568481445
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.692810773849487
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.294567346572876
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 1817124
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.27554440498352
Epoch: 1, Steps: 89 | Train Loss: 2.125 Vali Loss: 0.980 Vali Acc: 0.808 Test Loss: 0.980 Test Acc: 0.808
Validation loss decreased (inf --> -0.808486).  Saving model ...
Epoch: 2 cost time: 6.907568454742432
Epoch: 2, Steps: 89 | Train Loss: 0.497 Vali Loss: 0.362 Vali Acc: 0.901 Test Loss: 0.362 Test Acc: 0.901
Validation loss decreased (-0.808486 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 6.672533988952637
Epoch: 3, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
Validation loss decreased (-0.901111 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 6.617926836013794
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.938020 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 6.661195516586304
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.958216 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 6.664062738418579
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.782461404800415
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.770179033279419
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.6157143115997314
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 6.757110357284546
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.79732084274292
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.82083797454834
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.022253751754761
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.989284038543701
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.91219425201416
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 16 cost time: 6.7841010093688965
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.94709587097168
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.820496559143066
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.850066184997559
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.869683742523193
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.7963173389434814
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.796876907348633
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.885401964187622
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.950931549072266
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.070125341415405
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.347 Vali Acc: 0.916 Test Loss: 0.347 Test Acc: 0.916
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 575556
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.018910884857178
Epoch: 1, Steps: 89 | Train Loss: 2.127 Vali Loss: 0.908 Vali Acc: 0.831 Test Loss: 0.908 Test Acc: 0.831
Validation loss decreased (inf --> -0.830771).  Saving model ...
Epoch: 2 cost time: 16.42773723602295
Epoch: 2, Steps: 89 | Train Loss: 0.471 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.830771 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 16.636937379837036
Epoch: 3, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (-0.930359 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 16.27062201499939
Epoch: 4, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (-0.952644 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 15.930260181427002
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.145646572113037
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 16.413395881652832
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 16.493387699127197
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.00296926498413
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.010706663131714
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.894619464874268
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 12 cost time: 16.539288997650146
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 16.689475059509277
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.610689401626587
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.47293734550476
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.848108768463135
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 16.859893321990967
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 16.694674491882324
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 16.31564688682556
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 16.14128041267395
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 16.048433303833008
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 22 cost time: 15.89248776435852
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.973537 --> -0.979108).  Saving model ...
Epoch: 23 cost time: 15.605801820755005
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 16.456345558166504
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 15.987062692642212
Epoch: 25, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 15.491005659103394
Epoch: 26, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 16.515970945358276
Epoch: 27, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 16.415133714675903
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 16.084831714630127
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 16.234769105911255
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 937956
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.457855939865112
Epoch: 1, Steps: 89 | Train Loss: 2.189 Vali Loss: 1.020 Vali Acc: 0.829 Test Loss: 1.020 Test Acc: 0.829
Validation loss decreased (inf --> -0.828681).  Saving model ...
Epoch: 2 cost time: 9.966481924057007
Epoch: 2, Steps: 89 | Train Loss: 0.551 Vali Loss: 0.292 Vali Acc: 0.936 Test Loss: 0.292 Test Acc: 0.936
Validation loss decreased (-0.828681 --> -0.935930).  Saving model ...
Epoch: 3 cost time: 10.102245092391968
Epoch: 3, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
Validation loss decreased (-0.935930 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 10.134825468063354
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.954733 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 10.129792928695679
Epoch: 5, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 10.114037036895752
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 7 cost time: 10.04706335067749
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.214 Vali Acc: 0.938 Test Loss: 0.214 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.356914520263672
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 9.77306056022644
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.614189863204956
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 9.401915311813354
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.594587326049805
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.036997318267822
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 9.655763864517212
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.619990825653076
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 9.551033020019531
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977018).  Saving model ...
Epoch: 17 cost time: 9.612531185150146
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.912954807281494
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.884376049041748
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.01655387878418
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.549513339996338
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.660274982452393
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.721061706542969
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 9.826596975326538
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 9.623205423355103
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 9.650707006454468
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 317124
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.877272367477417
Epoch: 1, Steps: 89 | Train Loss: 2.124 Vali Loss: 0.920 Vali Acc: 0.841 Test Loss: 0.920 Test Acc: 0.841
Validation loss decreased (inf --> -0.841216).  Saving model ...
Epoch: 2 cost time: 11.909964323043823
Epoch: 2, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
Validation loss decreased (-0.841216 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 12.105984926223755
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.180 Vali Acc: 0.947 Test Loss: 0.180 Test Acc: 0.947
Validation loss decreased (-0.930359 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 11.32027816772461
Epoch: 4, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
Validation loss decreased (-0.947073 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 11.484666585922241
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.954037 --> -0.966573).  Saving model ...
Epoch: 6 cost time: 11.300569534301758
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.985808610916138
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 10.91742753982544
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.042194128036499
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.961 Test Loss: 0.118 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.105151176452637
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.384156703948975
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.244 Vali Acc: 0.932 Test Loss: 0.244 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.349804162979126
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.251456022262573
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.165 Vali Acc: 0.942 Test Loss: 0.165 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.529253005981445
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.013895273208618
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.948995590209961
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.781265497207642
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 18 cost time: 11.680923223495483
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.697868824005127
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.705397605895996
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.480093240737915
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 11.756563901901245
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 11.699235677719116
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.6601243019104
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 11.857112884521484
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 11.874443769454956
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 11.849706172943115
Epoch: 27, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 937956
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.343127250671387
Epoch: 1, Steps: 89 | Train Loss: 2.177 Vali Loss: 1.046 Vali Acc: 0.827 Test Loss: 1.046 Test Acc: 0.827
Validation loss decreased (inf --> -0.827288).  Saving model ...
Epoch: 2 cost time: 7.979169845581055
Epoch: 2, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.401 Vali Acc: 0.902 Test Loss: 0.401 Test Acc: 0.902
Validation loss decreased (-0.827288 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 7.966181039810181
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
Validation loss decreased (-0.901807 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 8.003391742706299
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.952644 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 7.971958637237549
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.958216 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 7.839396238327026
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.965876 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 8.191019296646118
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.112043142318726
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.536754608154297
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.22979998588562
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.281439065933228
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.158210515975952
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968662).  Saving model ...
Epoch: 13 cost time: 8.164795398712158
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 14 cost time: 8.17196774482727
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.937001466751099
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.092252492904663
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 8.039425611495972
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.095239400863647
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.951905250549316
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.073166131973267
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.246448755264282
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.164215803146362
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.20060658454895
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.297787189483643
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 8.033103227615356
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.035378694534302
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 317124
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.495893716812134
Epoch: 1, Steps: 89 | Train Loss: 2.124 Vali Loss: 0.973 Vali Acc: 0.850 Test Loss: 0.973 Test Acc: 0.850
Validation loss decreased (inf --> -0.850269).  Saving model ...
Epoch: 2 cost time: 7.177753686904907
Epoch: 2, Steps: 89 | Train Loss: 0.481 Vali Loss: 0.359 Vali Acc: 0.907 Test Loss: 0.359 Test Acc: 0.907
Validation loss decreased (-0.850269 --> -0.906682).  Saving model ...
Epoch: 3 cost time: 6.154116630554199
Epoch: 3, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.906682 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 7.096453666687012
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 7.165431976318359
Epoch: 5, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.952644 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 7.103790998458862
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 7.037613153457642
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.993320465087891
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.958216 --> -0.958912).  Saving model ...
Epoch: 9 cost time: 6.490683317184448
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.960305).  Saving model ...
Epoch: 10 cost time: 7.334233045578003
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967966).  Saving model ...
Epoch: 11 cost time: 7.335841417312622
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.38425612449646
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.967966 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 7.397229909896851
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.938 Test Loss: 0.180 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.4612650871276855
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.302 Vali Acc: 0.916 Test Loss: 0.302 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.497827768325806
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.265 Vali Acc: 0.923 Test Loss: 0.265 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.492135047912598
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.406 Vali Acc: 0.917 Test Loss: 0.406 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.502010345458984
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.509 Vali Acc: 0.930 Test Loss: 0.509 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.707297086715698
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.599552392959595
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.360191583633423
Epoch: 20, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.213 Vali Acc: 0.936 Test Loss: 0.213 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.394939422607422
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.357260227203369
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 937956
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.968542814254761
Epoch: 1, Steps: 89 | Train Loss: 2.238 Vali Loss: 1.147 Vali Acc: 0.796 Test Loss: 1.147 Test Acc: 0.796
Validation loss decreased (inf --> -0.795950).  Saving model ...
Epoch: 2 cost time: 5.5921289920806885
Epoch: 2, Steps: 89 | Train Loss: 0.637 Vali Loss: 0.377 Vali Acc: 0.905 Test Loss: 0.377 Test Acc: 0.905
Validation loss decreased (-0.795950 --> -0.905289).  Saving model ...
Epoch: 3 cost time: 5.665441036224365
Epoch: 3, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.208 Vali Acc: 0.953 Test Loss: 0.208 Test Acc: 0.953
Validation loss decreased (-0.905289 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 5.619161128997803
Epoch: 4, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
Validation loss decreased (-0.952644 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 5.674636363983154
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 5.68584680557251
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 5.38596510887146
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.391729831695557
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.966573 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 5.6647491455078125
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.564758539199829
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.636291742324829
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.845947265625
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 5.502179145812988
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.524242162704468
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.435979127883911
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.9077372550964355
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 5.647147178649902
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.742232322692871
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 19 cost time: 5.660818338394165
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.95361590385437
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.952 Test Loss: 0.151 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.688122272491455
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.565043687820435
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.709299564361572
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.774651527404785
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.854066610336304
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.771757125854492
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.826673984527588
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.688533544540405
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 29 cost time: 5.727309942245483
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.732684850692749
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 317124
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.00700807571411
Epoch: 1, Steps: 89 | Train Loss: 2.073 Vali Loss: 0.902 Vali Acc: 0.834 Test Loss: 0.902 Test Acc: 0.834
Validation loss decreased (inf --> -0.834253).  Saving model ...
Epoch: 2 cost time: 13.237193584442139
Epoch: 2, Steps: 89 | Train Loss: 0.493 Vali Loss: 0.272 Vali Acc: 0.929 Test Loss: 0.272 Test Acc: 0.929
Validation loss decreased (-0.834253 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 13.793000221252441
Epoch: 3, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.193 Vali Acc: 0.942 Test Loss: 0.193 Test Acc: 0.942
Validation loss decreased (-0.928967 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 13.570553064346313
Epoch: 4, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
Validation loss decreased (-0.942199 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 13.443339824676514
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.955430 --> -0.973537).  Saving model ...
Epoch: 6 cost time: 13.250139236450195
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.960827112197876
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.175350427627563
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.16524624824524
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 14.233779907226562
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.436608791351318
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.071835041046143
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.467865467071533
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.542916059494019
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.784677982330322
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.896271705627441
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.654462337493896
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 18 cost time: 14.965670824050903
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 14.921260118484497
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979804).  Saving model ...
Epoch: 20 cost time: 14.891554117202759
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 21 cost time: 14.447884321212769
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 14.23395037651062
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 14.34205937385559
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 14.333206176757812
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 14.417293787002563
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 14.450037717819214
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.761090993881226
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 14.566837072372437
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 14.555357933044434
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.56618046760559
Epoch: 30, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 498372
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.411513566970825
Epoch: 1, Steps: 89 | Train Loss: 2.181 Vali Loss: 1.092 Vali Acc: 0.781 Test Loss: 1.092 Test Acc: 0.781
Validation loss decreased (inf --> -0.780630).  Saving model ...
Epoch: 2 cost time: 9.087647199630737
Epoch: 2, Steps: 89 | Train Loss: 0.628 Vali Loss: 0.354 Vali Acc: 0.914 Test Loss: 0.354 Test Acc: 0.914
Validation loss decreased (-0.780630 --> -0.913645).  Saving model ...
Epoch: 3 cost time: 9.046533107757568
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
Validation loss decreased (-0.913645 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 9.341637372970581
Epoch: 4, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
Validation loss decreased (-0.939413 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 9.289186000823975
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 9.167502403259277
Epoch: 6, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 9.333877563476562
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 9.150560855865479
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 8.86153769493103
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.866121292114258
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.809452295303345
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 12 cost time: 8.708824634552002
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.597907066345215
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.713398456573486
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 8.789916038513184
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.54545783996582
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.921770334243774
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.322011232376099
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.796130895614624
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.934786319732666
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 21 cost time: 8.55166745185852
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 9.285995721817017
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.059245824813843
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.366 Vali Acc: 0.914 Test Loss: 0.366 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.11359190940857
Epoch: 24, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.152670860290527
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.171632766723633
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.072969913482666
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.962653875350952
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 9.438717603683472
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.727173566818237
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 187908
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.396979331970215
Epoch: 1, Steps: 89 | Train Loss: 2.066 Vali Loss: 0.898 Vali Acc: 0.838 Test Loss: 0.898 Test Acc: 0.838
Validation loss decreased (inf --> -0.837735).  Saving model ...
Epoch: 2 cost time: 11.613308906555176
Epoch: 2, Steps: 89 | Train Loss: 0.483 Vali Loss: 0.277 Vali Acc: 0.932 Test Loss: 0.277 Test Acc: 0.932
Validation loss decreased (-0.837735 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 11.32742190361023
Epoch: 3, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.192 Vali Acc: 0.943 Test Loss: 0.192 Test Acc: 0.943
Validation loss decreased (-0.931752 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 10.558676481246948
Epoch: 4, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
Validation loss decreased (-0.942895 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 10.59495234489441
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.954734 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 10.82672905921936
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.74769401550293
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 10.636406421661377
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.32084345817566
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.62950611114502
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.097951889038086
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.138753414154053
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.018147230148315
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 14 cost time: 10.952706575393677
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.765732526779175
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.022189378738403
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.178615808486938
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.670378684997559
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.307225704193115
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 20 cost time: 11.006518602371216
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.955137014389038
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.112317085266113
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.372730493545532
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 10.48831295967102
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 10.444942951202393
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.40958023071289
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.521854877471924
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 11.929209470748901
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.231098890304565
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 498372
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.669058084487915
Epoch: 1, Steps: 89 | Train Loss: 2.195 Vali Loss: 1.110 Vali Acc: 0.767 Test Loss: 1.110 Test Acc: 0.767
Validation loss decreased (inf --> -0.767398).  Saving model ...
Epoch: 2 cost time: 7.523327112197876
Epoch: 2, Steps: 89 | Train Loss: 0.649 Vali Loss: 0.364 Vali Acc: 0.910 Test Loss: 0.364 Test Acc: 0.910
Validation loss decreased (-0.767398 --> -0.910163).  Saving model ...
Epoch: 3 cost time: 6.9935009479522705
Epoch: 3, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.239 Vali Acc: 0.931 Test Loss: 0.239 Test Acc: 0.931
Validation loss decreased (-0.910163 --> -0.931056).  Saving model ...
Epoch: 4 cost time: 6.914521932601929
Epoch: 4, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.931056 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 6.98569917678833
Epoch: 5, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 6.97737455368042
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.551724672317505
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.963787 --> -0.972144).  Saving model ...
Epoch: 8 cost time: 7.61830997467041
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.87033224105835
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.447594165802002
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.464038610458374
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 7.382706880569458
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.501172304153442
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.092519521713257
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.829621315002441
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.9322874546051025
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.885266065597534
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.352570056915283
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.3523828983306885
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.688125371932983
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 21 cost time: 7.429464817047119
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.3890650272369385
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.397069454193115
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.978255748748779
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.975488662719727
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.509769678115845
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.1259377002716064
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 28 cost time: 6.544680833816528
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.346781969070435
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.5496814250946045
Epoch: 30, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.226 Vali Acc: 0.955 Test Loss: 0.226 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 187908
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.231998682022095
Epoch: 1, Steps: 89 | Train Loss: 2.110 Vali Loss: 0.971 Vali Acc: 0.833 Test Loss: 0.971 Test Acc: 0.833
Validation loss decreased (inf --> -0.832859).  Saving model ...
Epoch: 2 cost time: 7.290147066116333
Epoch: 2, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.332 Vali Acc: 0.923 Test Loss: 0.332 Test Acc: 0.923
Validation loss decreased (-0.832859 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 6.912036657333374
Epoch: 3, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.213 Vali Acc: 0.939 Test Loss: 0.213 Test Acc: 0.939
Validation loss decreased (-0.922699 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 6.326846599578857
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.939413 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 6.421015024185181
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 6.211459398269653
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.282195806503296
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 6.342939853668213
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 6.857252597808838
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.788827419281006
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.908039331436157
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.985367059707642
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.095984935760498
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.733386039733887
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.42154860496521
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.5109477043151855
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.257 Vali Acc: 0.932 Test Loss: 0.257 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.497843503952026
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.634105443954468
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.956 Test Loss: 0.139 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 498372
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.879969358444214
Epoch: 1, Steps: 89 | Train Loss: 2.222 Vali Loss: 1.179 Vali Acc: 0.753 Test Loss: 1.179 Test Acc: 0.753
Validation loss decreased (inf --> -0.753470).  Saving model ...
Epoch: 2 cost time: 5.64126992225647
Epoch: 2, Steps: 89 | Train Loss: 0.685 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.753470 --> -0.900414).  Saving model ...
Epoch: 3 cost time: 5.704386234283447
Epoch: 3, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
Validation loss decreased (-0.900414 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 5.621890306472778
Epoch: 4, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.938020 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 5.591709136962891
Epoch: 5, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.954734 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 6.028167724609375
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.958216 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 6.058306694030762
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.4637720584869385
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 5.529104232788086
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.441243886947632
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.489551544189453
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 5.535693168640137
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.5657336711883545
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.717725515365601
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 5.890379428863525
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.673234462738037
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.778987884521484
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.653991937637329
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.597240924835205
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.08934211730957
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 21 cost time: 5.617950201034546
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.222540378570557
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.895289421081543
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 24 cost time: 5.400479793548584
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.337120056152344
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.61432957649231
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 27 cost time: 5.464037656784058
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.56989312171936
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.550889015197754
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.240 Vali Acc: 0.931 Test Loss: 0.240 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.600996017456055
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.341 Vali Acc: 0.908 Test Loss: 0.341 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 187908
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.890727996826172
Epoch: 1, Steps: 89 | Train Loss: 2.434 Vali Loss: 1.474 Vali Acc: 0.792 Test Loss: 1.474 Test Acc: 0.792
Validation loss decreased (inf --> -0.791768).  Saving model ...
Epoch: 2 cost time: 18.661241054534912
Epoch: 2, Steps: 89 | Train Loss: 0.860 Vali Loss: 0.448 Vali Acc: 0.916 Test Loss: 0.448 Test Acc: 0.916
Validation loss decreased (-0.791768 --> -0.916430).  Saving model ...
Epoch: 3 cost time: 18.326268672943115
Epoch: 3, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
Validation loss decreased (-0.916430 --> -0.948465).  Saving model ...
Epoch: 4 cost time: 18.681058168411255
Epoch: 4, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.948465 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 19.152350425720215
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 19.03507137298584
Epoch: 6, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 18.580843925476074
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 17.953107595443726
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.074166297912598
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.195221662521362
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 19.34589958190918
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.10137391090393
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.694247484207153
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 17.808887004852295
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.972840 --> -0.979108).  Saving model ...
Epoch: 15 cost time: 17.25089979171753
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.09461808204651
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 17 cost time: 19.62145709991455
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 19.762450456619263
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 19.70522689819336
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.894002437591553
Epoch: 20, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.976287126541138
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.987070560455322
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 19.989228010177612
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 19.46315026283264
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 19.635193824768066
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 19.434144735336304
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 909148
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.159255027770996
Epoch: 1, Steps: 89 | Train Loss: 2.547 Vali Loss: 1.761 Vali Acc: 0.687 Test Loss: 1.761 Test Acc: 0.687
Validation loss decreased (inf --> -0.687308).  Saving model ...
Epoch: 2 cost time: 11.123241901397705
Epoch: 2, Steps: 89 | Train Loss: 1.126 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
Validation loss decreased (-0.687308 --> -0.860718).  Saving model ...
Epoch: 3 cost time: 11.007891416549683
Epoch: 3, Steps: 89 | Train Loss: 0.453 Vali Loss: 0.358 Vali Acc: 0.918 Test Loss: 0.358 Test Acc: 0.918
Validation loss decreased (-0.860718 --> -0.917824).  Saving model ...
Epoch: 4 cost time: 12.714705467224121
Epoch: 4, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.266 Vali Acc: 0.938 Test Loss: 0.266 Test Acc: 0.938
Validation loss decreased (-0.917824 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 12.00024700164795
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.938020 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 11.854576349258423
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 11.879035949707031
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.07099437713623
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.962394 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 11.02944540977478
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.95645546913147
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.951560735702515
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.340668678283691
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 12.043177604675293
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.834502220153809
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 12.200056076049805
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.200467348098755
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.290619373321533
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.329448938369751
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 19 cost time: 12.026043176651001
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 20 cost time: 12.05691647529602
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.155855178833008
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.949600219726562
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 12.992616415023804
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.955 Test Loss: 0.157 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.949721574783325
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.907050609588623
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 11.919333219528198
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.946104526519775
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 11.855988502502441
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 12.157469272613525
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 288172
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.390002727508545
Epoch: 1, Steps: 89 | Train Loss: 2.439 Vali Loss: 1.501 Vali Acc: 0.790 Test Loss: 1.501 Test Acc: 0.790
Validation loss decreased (inf --> -0.789679).  Saving model ...
Epoch: 2 cost time: 16.73138689994812
Epoch: 2, Steps: 89 | Train Loss: 0.865 Vali Loss: 0.476 Vali Acc: 0.914 Test Loss: 0.476 Test Acc: 0.914
Validation loss decreased (-0.789679 --> -0.913644).  Saving model ...
Epoch: 3 cost time: 15.378215074539185
Epoch: 3, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.913644 --> -0.948465).  Saving model ...
Epoch: 4 cost time: 15.37413477897644
Epoch: 4, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
Validation loss decreased (-0.948465 --> -0.953340).  Saving model ...
Epoch: 5 cost time: 15.24196481704712
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
Validation loss decreased (-0.953340 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 15.342416048049927
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.216533422470093
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.606346130371094
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.456553936004639
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.195 Vali Acc: 0.934 Test Loss: 0.195 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.357141256332397
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 15.138535976409912
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.212828874588013
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 13 cost time: 14.117459058761597
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.404523611068726
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.89691710472107
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 15.044928073883057
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.91985535621643
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.972919940948486
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 15.208031415939331
Epoch: 19, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 16.04460096359253
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.691396236419678
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 15.018998861312866
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 14.208156108856201
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 14.284019708633423
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 14.211597681045532
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 14.320117712020874
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 14.308910369873047
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 14.254412651062012
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 15.280310153961182
Epoch: 29, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 15.816020250320435
Epoch: 30, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 909148
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.9198157787323
Epoch: 1, Steps: 89 | Train Loss: 2.547 Vali Loss: 1.767 Vali Acc: 0.687 Test Loss: 1.767 Test Acc: 0.687
Validation loss decreased (inf --> -0.687308).  Saving model ...
Epoch: 2 cost time: 10.142294883728027
Epoch: 2, Steps: 89 | Train Loss: 1.125 Vali Loss: 0.649 Vali Acc: 0.859 Test Loss: 0.649 Test Acc: 0.859
Validation loss decreased (-0.687308 --> -0.859325).  Saving model ...
Epoch: 3 cost time: 10.122199296951294
Epoch: 3, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.371 Vali Acc: 0.901 Test Loss: 0.371 Test Acc: 0.901
Validation loss decreased (-0.859325 --> -0.901110).  Saving model ...
Epoch: 4 cost time: 9.94670557975769
Epoch: 4, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.261 Vali Acc: 0.935 Test Loss: 0.261 Test Acc: 0.935
Validation loss decreased (-0.901110 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 9.900956153869629
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.934538 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 10.01274299621582
Epoch: 6, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
Validation loss decreased (-0.949859 --> -0.959608).  Saving model ...
Epoch: 7 cost time: 10.346018075942993
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.06733250617981
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.470756530761719
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.569828510284424
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.959608 --> -0.970055).  Saving model ...
Epoch: 11 cost time: 9.489750146865845
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.621188163757324
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.410866498947144
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.814130067825317
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.32704496383667
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.346930265426636
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 17 cost time: 9.63168978691101
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 18 cost time: 9.596307754516602
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 19 cost time: 9.579730987548828
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.972840 --> -0.981893).  Saving model ...
Epoch: 20 cost time: 9.767993211746216
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.89066195487976
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.941159725189209
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 23 cost time: 9.596404075622559
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.807129144668579
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.896183490753174
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.860469341278076
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 8.800070524215698
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.331306219100952
Epoch: 28, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.367 Vali Acc: 0.904 Test Loss: 0.367 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.504478693008423
Epoch: 29, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.516425132751465
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 288172
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.533984661102295
Epoch: 1, Steps: 89 | Train Loss: 2.421 Vali Loss: 1.501 Vali Acc: 0.790 Test Loss: 1.501 Test Acc: 0.790
Validation loss decreased (inf --> -0.790375).  Saving model ...
Epoch: 2 cost time: 9.255522012710571
Epoch: 2, Steps: 89 | Train Loss: 0.861 Vali Loss: 0.574 Vali Acc: 0.886 Test Loss: 0.574 Test Acc: 0.886
Validation loss decreased (-0.790375 --> -0.885788).  Saving model ...
Epoch: 3 cost time: 8.956957578659058
Epoch: 3, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.885788 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 5.732898235321045
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.247 Vali Acc: 0.945 Test Loss: 0.247 Test Acc: 0.945
Validation loss decreased (-0.924788 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 8.95850658416748
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.944984 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 8.857916355133057
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.566604852676392
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.617166519165039
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.61506462097168
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.181 Vali Acc: 0.939 Test Loss: 0.181 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.578341960906982
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.170 Vali Acc: 0.947 Test Loss: 0.170 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.793809413909912
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.806212902069092
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.693054437637329
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.79993224143982
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.962394).  Saving model ...
Epoch: 15 cost time: 8.673515796661377
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.725707054138184
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.084667205810547
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.283 Vali Acc: 0.913 Test Loss: 0.283 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.270739555358887
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.931 Test Loss: 0.244 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.31109094619751
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.34859561920166
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.5482656955719
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.2684006690979
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.468088150024414
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.51632308959961
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 909148
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.104939937591553
Epoch: 1, Steps: 89 | Train Loss: 2.532 Vali Loss: 1.772 Vali Acc: 0.687 Test Loss: 1.772 Test Acc: 0.687
Validation loss decreased (inf --> -0.686612).  Saving model ...
Epoch: 2 cost time: 7.90387487411499
Epoch: 2, Steps: 89 | Train Loss: 1.106 Vali Loss: 0.716 Vali Acc: 0.851 Test Loss: 0.716 Test Acc: 0.851
Validation loss decreased (-0.686612 --> -0.850968).  Saving model ...
Epoch: 3 cost time: 7.7295732498168945
Epoch: 3, Steps: 89 | Train Loss: 0.449 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.850968 --> -0.900414).  Saving model ...
Epoch: 4 cost time: 7.603152751922607
Epoch: 4, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.344 Vali Acc: 0.909 Test Loss: 0.344 Test Acc: 0.909
Validation loss decreased (-0.900414 --> -0.909467).  Saving model ...
Epoch: 5 cost time: 7.413500070571899
Epoch: 5, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
Validation loss decreased (-0.909467 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 7.276117324829102
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
Validation loss decreased (-0.941502 --> -0.951251).  Saving model ...
Epoch: 7 cost time: 7.415757417678833
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.191 Vali Acc: 0.945 Test Loss: 0.191 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.924105644226074
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.951251 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 7.0191850662231445
Epoch: 9, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.92354416847229
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.963787).  Saving model ...
Epoch: 11 cost time: 6.757320165634155
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.179427146911621
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 13 cost time: 6.829700946807861
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.712206602096558
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.635960578918457
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 16 cost time: 6.962804317474365
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.65662693977356
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.834899663925171
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.783091068267822
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.599465370178223
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.677600622177124
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.87444281578064
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.130843162536621
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.760755300521851
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.730281352996826
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 288172
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.633713245391846
Epoch: 1, Steps: 89 | Train Loss: 2.598 Vali Loss: 1.781 Vali Acc: 0.669 Test Loss: 1.781 Test Acc: 0.669
Validation loss decreased (inf --> -0.668506).  Saving model ...
Epoch: 2 cost time: 14.422802925109863
Epoch: 2, Steps: 89 | Train Loss: 1.105 Vali Loss: 0.618 Vali Acc: 0.862 Test Loss: 0.618 Test Acc: 0.862
Validation loss decreased (-0.668506 --> -0.862111).  Saving model ...
Epoch: 3 cost time: 14.56819748878479
Epoch: 3, Steps: 89 | Train Loss: 0.460 Vali Loss: 0.359 Vali Acc: 0.915 Test Loss: 0.359 Test Acc: 0.915
Validation loss decreased (-0.862111 --> -0.915038).  Saving model ...
Epoch: 4 cost time: 14.6786048412323
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.234 Vali Acc: 0.940 Test Loss: 0.234 Test Acc: 0.940
Validation loss decreased (-0.915038 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 14.236030578613281
Epoch: 5, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
Validation loss decreased (-0.940109 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 14.376194953918457
Epoch: 6, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.11257290840149
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
Validation loss decreased (-0.953341 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 13.713311433792114
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 14.066174030303955
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 13.801614761352539
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.039782285690308
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 14.874722003936768
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.556360721588135
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.953 Test Loss: 0.132 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.927510261535645
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.957770586013794
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.964 Test Loss: 0.107 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.92838740348816
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.159 Vali Acc: 0.942 Test Loss: 0.159 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.931489706039429
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.085716724395752
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 19 cost time: 14.722050666809082
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.866601943969727
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.00310230255127
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.934435844421387
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.115110635757446
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 14.567301988601685
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 14.31658148765564
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 14.809741735458374
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 14.901808023452759
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 28 cost time: 14.841886043548584
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 29 cost time: 14.852462768554688
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 14.89075231552124
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 469276
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.177082538604736
Epoch: 1, Steps: 89 | Train Loss: 2.462 Vali Loss: 1.574 Vali Acc: 0.776 Test Loss: 1.574 Test Acc: 0.776
Validation loss decreased (inf --> -0.776447).  Saving model ...
Epoch: 2 cost time: 9.551822900772095
Epoch: 2, Steps: 89 | Train Loss: 0.942 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
Validation loss decreased (-0.776447 --> -0.894145).  Saving model ...
Epoch: 3 cost time: 9.559768438339233
Epoch: 3, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.294 Vali Acc: 0.932 Test Loss: 0.294 Test Acc: 0.932
Validation loss decreased (-0.894145 --> -0.932448).  Saving model ...
Epoch: 4 cost time: 9.164856195449829
Epoch: 4, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.932448 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 9.413004159927368
Epoch: 5, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.934538 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 9.676495790481567
Epoch: 6, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 8.883176326751709
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959609).  Saving model ...
Epoch: 8 cost time: 9.554769039154053
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.426029205322266
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
Validation loss decreased (-0.959609 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 9.531862258911133
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.959444046020508
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966573).  Saving model ...
Epoch: 12 cost time: 9.381211280822754
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 13 cost time: 9.611339569091797
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 9.297210216522217
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.404587984085083
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 9.379470348358154
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.181328773498535
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.430307388305664
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.807180166244507
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.607747077941895
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.70374321937561
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.958913326263428
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.96030044555664
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.470720052719116
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.372978925704956
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 158764
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.126047849655151
Epoch: 1, Steps: 89 | Train Loss: 2.598 Vali Loss: 1.783 Vali Acc: 0.671 Test Loss: 1.783 Test Acc: 0.671
Validation loss decreased (inf --> -0.670595).  Saving model ...
Epoch: 2 cost time: 10.38783597946167
Epoch: 2, Steps: 89 | Train Loss: 1.110 Vali Loss: 0.617 Vali Acc: 0.863 Test Loss: 0.617 Test Acc: 0.863
Validation loss decreased (-0.670595 --> -0.862807).  Saving model ...
Epoch: 3 cost time: 11.255828142166138
Epoch: 3, Steps: 89 | Train Loss: 0.457 Vali Loss: 0.392 Vali Acc: 0.904 Test Loss: 0.392 Test Acc: 0.904
Validation loss decreased (-0.862807 --> -0.903896).  Saving model ...
Epoch: 4 cost time: 11.096682071685791
Epoch: 4, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.254 Vali Acc: 0.936 Test Loss: 0.254 Test Acc: 0.936
Validation loss decreased (-0.903896 --> -0.935931).  Saving model ...
Epoch: 5 cost time: 11.319932699203491
Epoch: 5, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.935931 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 11.391217947006226
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
Validation loss decreased (-0.942895 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 11.31538701057434
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.400402784347534
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.952644 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 11.599950790405273
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 10.788180112838745
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 11.088568449020386
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.41388487815857
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 10.739211559295654
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.940 Test Loss: 0.168 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.774940729141235
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.174775123596191
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.705490350723267
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.281 Vali Acc: 0.918 Test Loss: 0.281 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.90874457359314
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.953 Test Loss: 0.145 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.81690526008606
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.262614011764526
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.456271409988403
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.156835317611694
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.43131136894226
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 469276
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.356526613235474
Epoch: 1, Steps: 89 | Train Loss: 2.460 Vali Loss: 1.579 Vali Acc: 0.767 Test Loss: 1.579 Test Acc: 0.767
Validation loss decreased (inf --> -0.767394).  Saving model ...
Epoch: 2 cost time: 7.724679470062256
Epoch: 2, Steps: 89 | Train Loss: 0.938 Vali Loss: 0.522 Vali Acc: 0.893 Test Loss: 0.522 Test Acc: 0.893
Validation loss decreased (-0.767394 --> -0.893449).  Saving model ...
Epoch: 3 cost time: 7.623518466949463
Epoch: 3, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.299 Vali Acc: 0.928 Test Loss: 0.299 Test Acc: 0.928
Validation loss decreased (-0.893449 --> -0.928270).  Saving model ...
Epoch: 4 cost time: 7.7920002937316895
Epoch: 4, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
Validation loss decreased (-0.928270 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 7.891204357147217
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.939413 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 7.544042110443115
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.717447519302368
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.956823 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 7.912304162979126
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.958912 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 8.239445686340332
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 7.185200214385986
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.660016775131226
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.654507398605347
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.527267217636108
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 7.022597312927246
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 15 cost time: 8.083858013153076
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.173018455505371
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.071355104446411
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.772483587265015
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.769898891448975
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.9808337688446045
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.882654666900635
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.799748420715332
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.630241394042969
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 24 cost time: 7.977946996688843
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.96116828918457
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.681986331939697
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.694355726242065
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.789780139923096
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.127493619918823
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 7.712397575378418
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 158764
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.763607025146484
Epoch: 1, Steps: 89 | Train Loss: 2.638 Vali Loss: 1.890 Vali Acc: 0.634 Test Loss: 1.890 Test Acc: 0.634
Validation loss decreased (inf --> -0.633686).  Saving model ...
Epoch: 2 cost time: 7.075587272644043
Epoch: 2, Steps: 89 | Train Loss: 1.258 Vali Loss: 0.753 Vali Acc: 0.851 Test Loss: 0.753 Test Acc: 0.851
Validation loss decreased (-0.633686 --> -0.850967).  Saving model ...
Epoch: 3 cost time: 7.5022265911102295
Epoch: 3, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.850967 --> -0.874647).  Saving model ...
Epoch: 4 cost time: 7.611971855163574
Epoch: 4, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.874647 --> -0.930359).  Saving model ...
Epoch: 5 cost time: 7.5360496044158936
Epoch: 5, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.279 Vali Acc: 0.932 Test Loss: 0.279 Test Acc: 0.932
Validation loss decreased (-0.930359 --> -0.932448).  Saving model ...
Epoch: 6 cost time: 7.592012643814087
Epoch: 6, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.229 Vali Acc: 0.938 Test Loss: 0.229 Test Acc: 0.938
Validation loss decreased (-0.932448 --> -0.938020).  Saving model ...
Epoch: 7 cost time: 7.433828592300415
Epoch: 7, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
Validation loss decreased (-0.938020 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 7.411545515060425
Epoch: 8, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.467280387878418
Epoch: 9, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.946377 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 7.3415305614471436
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.216 Vali Acc: 0.940 Test Loss: 0.216 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.348426818847656
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959609).  Saving model ...
Epoch: 12 cost time: 7.513911485671997
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
Validation loss decreased (-0.959609 --> -0.965876).  Saving model ...
Epoch: 13 cost time: 7.425150632858276
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.941921234130859
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.162917375564575
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.14326810836792
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.162 Vali Acc: 0.940 Test Loss: 0.162 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.050607919692993
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.841759204864502
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.0305376052856445
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.1645896434783936
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.0626280307769775
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.932414531707764
Epoch: 22, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 469276
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.647477626800537
Epoch: 1, Steps: 89 | Train Loss: 2.447 Vali Loss: 1.606 Vali Acc: 0.769 Test Loss: 1.606 Test Acc: 0.769
Validation loss decreased (inf --> -0.769483).  Saving model ...
Epoch: 2 cost time: 6.477116346359253
Epoch: 2, Steps: 89 | Train Loss: 0.917 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
Validation loss decreased (-0.769483 --> -0.861414).  Saving model ...
Epoch: 3 cost time: 6.50922155380249
Epoch: 3, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.403 Vali Acc: 0.907 Test Loss: 0.403 Test Acc: 0.907
Validation loss decreased (-0.861414 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 6.152589797973633
Epoch: 4, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.301 Vali Acc: 0.931 Test Loss: 0.301 Test Acc: 0.931
Validation loss decreased (-0.907378 --> -0.931055).  Saving model ...
Epoch: 5 cost time: 6.207539796829224
Epoch: 5, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.931055 --> -0.944288).  Saving model ...
Epoch: 6 cost time: 6.309142827987671
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
Validation loss decreased (-0.944288 --> -0.946377).  Saving model ...
Epoch: 7 cost time: 6.315982818603516
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
Validation loss decreased (-0.946377 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 6.1843647956848145
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.221608877182007
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
Validation loss decreased (-0.955430 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 6.17951226234436
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966572).  Saving model ...
Epoch: 11 cost time: 6.107649803161621
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.183770418167114
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.97740364074707
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.735408306121826
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.989089727401733
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.1790995597839355
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.9940454959869385
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.709737539291382
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.945185422897339
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.956 Test Loss: 0.145 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.875741481781006
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 158764
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.876425743103027
Epoch: 1, Steps: 89 | Train Loss: 2.567 Vali Loss: 1.783 Vali Acc: 0.706 Test Loss: 1.783 Test Acc: 0.706
Validation loss decreased (inf --> -0.706110).  Saving model ...
Epoch: 2 cost time: 12.353161334991455
Epoch: 2, Steps: 89 | Train Loss: 1.085 Vali Loss: 0.568 Vali Acc: 0.866 Test Loss: 0.568 Test Acc: 0.866
Validation loss decreased (-0.706110 --> -0.865593).  Saving model ...
Epoch: 3 cost time: 12.317993879318237
Epoch: 3, Steps: 89 | Train Loss: 0.390 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
Validation loss decreased (-0.865593 --> -0.919217).  Saving model ...
Epoch: 4 cost time: 12.475388050079346
Epoch: 4, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
Validation loss decreased (-0.919217 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 12.40436339378357
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.939413 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 12.315260887145996
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 12.153895378112793
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.143 Vali Acc: 0.956 Test Loss: 0.143 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.88896656036377
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.959609 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 12.183878660202026
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.992507934570312
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 12.298814535140991
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.956 Test Loss: 0.130 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.012816429138184
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.11682415008545
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 12.062586545944214
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.967965 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 12.031996250152588
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.9645094871521
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.234 Vali Acc: 0.932 Test Loss: 0.234 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.418336868286133
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.75811243057251
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 12.198613405227661
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.17959713935852
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 11.978145599365234
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.83558440208435
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.868136167526245
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 24 cost time: 12.14179015159607
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 12.307856321334839
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 11.773735523223877
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 11.516091585159302
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 11.890207290649414
Epoch: 28, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 11.872348546981812
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 12.005794763565063
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 249340
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.718363285064697
Epoch: 1, Steps: 89 | Train Loss: 2.504 Vali Loss: 1.723 Vali Acc: 0.718 Test Loss: 1.723 Test Acc: 0.718
Validation loss decreased (inf --> -0.717949).  Saving model ...
Epoch: 2 cost time: 8.627174377441406
Epoch: 2, Steps: 89 | Train Loss: 1.103 Vali Loss: 0.597 Vali Acc: 0.889 Test Loss: 0.597 Test Acc: 0.889
Validation loss decreased (-0.717949 --> -0.888573).  Saving model ...
Epoch: 3 cost time: 8.712837934494019
Epoch: 3, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
Validation loss decreased (-0.888573 --> -0.930359).  Saving model ...
Epoch: 4 cost time: 5.0987231731414795
Epoch: 4, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.930359 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 5.409895658493042
Epoch: 5, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.943591 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 8.750692367553711
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.65195083618164
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 8.742456436157227
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.957519 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 7.79003643989563
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 8.03136396408081
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 8.142103910446167
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.63085150718689
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 8.644829988479614
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.737056255340576
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.25471806526184
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.888598203659058
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.965152740478516
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.123713970184326
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 19 cost time: 7.837812662124634
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.499470949172974
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.694952964782715
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 22 cost time: 8.387095928192139
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.879849672317505
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.134435892105103
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.072338819503784
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.545179128646851
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 27 cost time: 8.190195322036743
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 8.586954116821289
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 8.255857467651367
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 8.17955207824707
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 94060
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.243352174758911
Epoch: 1, Steps: 89 | Train Loss: 2.566 Vali Loss: 1.800 Vali Acc: 0.708 Test Loss: 1.800 Test Acc: 0.708
Validation loss decreased (inf --> -0.707503).  Saving model ...
Epoch: 2 cost time: 8.283945798873901
Epoch: 2, Steps: 89 | Train Loss: 1.096 Vali Loss: 0.578 Vali Acc: 0.881 Test Loss: 0.578 Test Acc: 0.881
Validation loss decreased (-0.707503 --> -0.880913).  Saving model ...
Epoch: 3 cost time: 9.704855918884277
Epoch: 3, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.322 Vali Acc: 0.921 Test Loss: 0.322 Test Acc: 0.921
Validation loss decreased (-0.880913 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 9.939479351043701
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
Validation loss decreased (-0.921306 --> -0.938716).  Saving model ...
Epoch: 5 cost time: 9.397696018218994
Epoch: 5, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
Validation loss decreased (-0.938716 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 8.688068151473999
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.950555 --> -0.956127).  Saving model ...
Epoch: 7 cost time: 8.649085521697998
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.017485857009888
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.956127 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 9.751737356185913
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.824928283691406
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 9.718724489212036
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 9.42408537864685
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.928020238876343
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 8.606086492538452
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.973537 --> -0.974233).  Saving model ...
Epoch: 15 cost time: 8.70497441291809
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.435322761535645
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.554256916046143
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.901824951171875
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 19 cost time: 9.662153720855713
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.947680950164795
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.494000911712646
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.976228952407837
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.982590).  Saving model ...
Epoch: 23 cost time: 9.749523878097534
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.706323862075806
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.957721471786499
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.142857789993286
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.172780513763428
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.039564609527588
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 8.816637992858887
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.509683847427368
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 249340
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.086380958557129
Epoch: 1, Steps: 89 | Train Loss: 2.505 Vali Loss: 1.728 Vali Acc: 0.708 Test Loss: 1.728 Test Acc: 0.708
Validation loss decreased (inf --> -0.708200).  Saving model ...
Epoch: 2 cost time: 7.425774335861206
Epoch: 2, Steps: 89 | Train Loss: 1.083 Vali Loss: 0.593 Vali Acc: 0.889 Test Loss: 0.593 Test Acc: 0.889
Validation loss decreased (-0.708200 --> -0.888573).  Saving model ...
Epoch: 3 cost time: 6.812003135681152
Epoch: 3, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.328 Vali Acc: 0.933 Test Loss: 0.328 Test Acc: 0.933
Validation loss decreased (-0.888573 --> -0.933144).  Saving model ...
Epoch: 4 cost time: 7.037835597991943
Epoch: 4, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
Validation loss decreased (-0.933144 --> -0.947769).  Saving model ...
Epoch: 5 cost time: 6.980330944061279
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
Validation loss decreased (-0.947769 --> -0.951251).  Saving model ...
Epoch: 6 cost time: 6.664684772491455
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.951251 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 7.472183465957642
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.71226692199707
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.956126 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 7.740199089050293
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.953 Test Loss: 0.144 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.501804828643799
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.956 Test Loss: 0.140 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.4832775592803955
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.957519).  Saving model ...
Epoch: 12 cost time: 7.093814849853516
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.957519 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 6.832599878311157
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.622557640075684
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.306427240371704
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.971447).  Saving model ...
Epoch: 16 cost time: 7.712647438049316
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.66315770149231
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.4885172843933105
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 19 cost time: 6.767784118652344
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.795905351638794
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 21 cost time: 6.862839460372925
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.813629627227783
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 23 cost time: 7.156739711761475
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.708248853683472
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.6334850788116455
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 26 cost time: 7.3249571323394775
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.983060836791992
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.518030881881714
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.673399925231934
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.284002780914307
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 94060
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.556301832199097
Epoch: 1, Steps: 89 | Train Loss: 2.566 Vali Loss: 1.815 Vali Acc: 0.708 Test Loss: 1.815 Test Acc: 0.708
Validation loss decreased (inf --> -0.707503).  Saving model ...
Epoch: 2 cost time: 7.013919115066528
Epoch: 2, Steps: 89 | Train Loss: 1.104 Vali Loss: 0.677 Vali Acc: 0.868 Test Loss: 0.677 Test Acc: 0.868
Validation loss decreased (-0.707503 --> -0.868378).  Saving model ...
Epoch: 3 cost time: 6.644912004470825
Epoch: 3, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.391 Vali Acc: 0.903 Test Loss: 0.391 Test Acc: 0.903
Validation loss decreased (-0.868378 --> -0.903199).  Saving model ...
Epoch: 4 cost time: 6.335140705108643
Epoch: 4, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.328 Vali Acc: 0.905 Test Loss: 0.328 Test Acc: 0.905
Validation loss decreased (-0.903199 --> -0.904593).  Saving model ...
Epoch: 5 cost time: 6.134232521057129
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.230 Vali Acc: 0.936 Test Loss: 0.230 Test Acc: 0.936
Validation loss decreased (-0.904593 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 6.196107625961304
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.225 Vali Acc: 0.928 Test Loss: 0.225 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.204773187637329
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.197 Vali Acc: 0.940 Test Loss: 0.197 Test Acc: 0.940
Validation loss decreased (-0.935931 --> -0.940109).  Saving model ...
Epoch: 8 cost time: 6.466322898864746
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.208 Vali Acc: 0.936 Test Loss: 0.208 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.889858722686768
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.219 Vali Acc: 0.931 Test Loss: 0.219 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.8100996017456055
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.940109 --> -0.945681).  Saving model ...
Epoch: 11 cost time: 6.676177501678467
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.248 Vali Acc: 0.916 Test Loss: 0.248 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.155566930770874
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.945681 --> -0.950555).  Saving model ...
Epoch: 13 cost time: 6.378482103347778
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.262 Vali Acc: 0.919 Test Loss: 0.262 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.737208127975464
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.934 Test Loss: 0.210 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.3431313037872314
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.932 Test Loss: 0.198 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.493765354156494
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.198 Vali Acc: 0.940 Test Loss: 0.198 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.313959121704102
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.950555 --> -0.950556).  Saving model ...
Epoch: 18 cost time: 5.0290374755859375
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
Validation loss decreased (-0.950556 --> -0.953341).  Saving model ...
Epoch: 19 cost time: 3.676058292388916
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.2568440437316895
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.692502021789551
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (-0.953341 --> -0.956823).  Saving model ...
Epoch: 22 cost time: 6.702748537063599
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.942 Test Loss: 0.195 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.86635684967041
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.945 Test Loss: 0.194 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.8514487743377686
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.717518329620361
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.7980875968933105
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.958216).  Saving model ...
Epoch: 27 cost time: 6.255107164382935
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 28 cost time: 6.566712856292725
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.558589458465576
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 30 cost time: 6.55022931098938
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 249340
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.346896648406982
Epoch: 1, Steps: 89 | Train Loss: 2.499 Vali Loss: 1.755 Vali Acc: 0.691 Test Loss: 1.755 Test Acc: 0.691
Validation loss decreased (inf --> -0.690790).  Saving model ...
Epoch: 2 cost time: 6.4866859912872314
Epoch: 2, Steps: 89 | Train Loss: 1.097 Vali Loss: 0.705 Vali Acc: 0.877 Test Loss: 0.705 Test Acc: 0.877
Validation loss decreased (-0.690790 --> -0.876734).  Saving model ...
Epoch: 3 cost time: 6.121322870254517
Epoch: 3, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.423 Vali Acc: 0.912 Test Loss: 0.423 Test Acc: 0.912
Validation loss decreased (-0.876734 --> -0.912252).  Saving model ...
Epoch: 4 cost time: 6.294366836547852
Epoch: 4, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
Validation loss decreased (-0.912252 --> -0.926181).  Saving model ...
Epoch: 5 cost time: 6.508113384246826
Epoch: 5, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.926181 --> -0.944287).  Saving model ...
Epoch: 6 cost time: 5.582728624343872
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.222 Vali Acc: 0.940 Test Loss: 0.222 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.247230529785156
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.334005832672119
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.944287 --> -0.949859).  Saving model ...
Epoch: 9 cost time: 5.708669185638428
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.949859 --> -0.958216).  Saving model ...
Epoch: 10 cost time: 5.962151050567627
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.634122371673584
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.8518781661987305
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.057839870452881
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4199726581573486
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.130263566970825
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
Validation loss decreased (-0.958216 --> -0.965876).  Saving model ...
Epoch: 16 cost time: 6.24495530128479
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.299902439117432
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.0520734786987305
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.309333562850952
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.18825888633728
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.947450160980225
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.771160840988159
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.039371490478516
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.6668102741241455
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.9093406200408936
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 94060
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 106.39708876609802
Epoch: 1, Steps: 89 | Train Loss: 0.964 Vali Loss: 0.242 Vali Acc: 0.929 Test Loss: 0.242 Test Acc: 0.929
Validation loss decreased (inf --> -0.928967).  Saving model ...
Epoch: 2 cost time: 98.20971608161926
Epoch: 2, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.928967 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 105.27566456794739
Epoch: 3, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.400 Vali Acc: 0.905 Test Loss: 0.400 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 101.21287274360657
Epoch: 4, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
Validation loss decreased (-0.951948 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 103.10838294029236
Epoch: 5, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 98.82768511772156
Epoch: 6, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.296 Vali Acc: 0.946 Test Loss: 0.296 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 102.91846489906311
Epoch: 7, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.471 Vali Acc: 0.921 Test Loss: 0.471 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 102.59370684623718
Epoch: 8, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.396 Vali Acc: 0.932 Test Loss: 0.396 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 98.90595984458923
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.903 Vali Acc: 0.884 Test Loss: 0.903 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 103.2729070186615
Epoch: 10, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.688 Vali Acc: 0.916 Test Loss: 0.688 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 96.15399694442749
Epoch: 11, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.417 Vali Acc: 0.934 Test Loss: 0.417 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 103.19187927246094
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.366 Vali Acc: 0.947 Test Loss: 0.366 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 98.74650454521179
Epoch: 13, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.482 Vali Acc: 0.937 Test Loss: 0.482 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 98.41107749938965
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 1.108 Vali Acc: 0.914 Test Loss: 1.108 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 37959060
model size : 147.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 39.99777388572693
Epoch: 1, Steps: 89 | Train Loss: 0.943 Vali Loss: 0.293 Vali Acc: 0.905 Test Loss: 0.293 Test Acc: 0.905
Validation loss decreased (inf --> -0.904593).  Saving model ...
Epoch: 2 cost time: 36.84818649291992
Epoch: 2, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.904593 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 35.64277505874634
Epoch: 3, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.319 Vali Acc: 0.921 Test Loss: 0.319 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 37.67138481140137
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
Validation loss decreased (-0.943591 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 38.5329475402832
Epoch: 5, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.564 Vali Acc: 0.893 Test Loss: 0.564 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 36.26821684837341
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.387 Vali Acc: 0.931 Test Loss: 0.387 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 35.45118594169617
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.436 Vali Acc: 0.927 Test Loss: 0.436 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 37.89762806892395
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.593 Vali Acc: 0.928 Test Loss: 0.593 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 38.58434438705444
Epoch: 9, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.461 Vali Acc: 0.944 Test Loss: 0.461 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 36.27207398414612
Epoch: 10, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.307 Vali Acc: 0.962 Test Loss: 0.307 Test Acc: 0.962
Validation loss decreased (-0.944984 --> -0.962392).  Saving model ...
Epoch: 11 cost time: 35.81911563873291
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.468 Vali Acc: 0.943 Test Loss: 0.468 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 37.78725981712341
Epoch: 12, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.969 Vali Acc: 0.918 Test Loss: 0.969 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 38.295692920684814
Epoch: 13, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 36.02416372299194
Epoch: 14, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.390 Vali Acc: 0.958 Test Loss: 0.390 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 35.87649893760681
Epoch: 15, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.280 Vali Acc: 0.967 Test Loss: 0.280 Test Acc: 0.967
Validation loss decreased (-0.962392 --> -0.966571).  Saving model ...
Epoch: 16 cost time: 37.594494104385376
Epoch: 16, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.600 Vali Acc: 0.937 Test Loss: 0.600 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 38.368054151535034
Epoch: 17, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.403 Vali Acc: 0.960 Test Loss: 0.403 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 36.1331102848053
Epoch: 18, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.474 Vali Acc: 0.955 Test Loss: 0.474 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 34.5041081905365
Epoch: 19, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.952 Test Loss: 0.463 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 37.69364857673645
Epoch: 20, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.430 Vali Acc: 0.958 Test Loss: 0.430 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 37.9532949924469
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 1.046 Vali Acc: 0.921 Test Loss: 1.046 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 35.71065711975098
Epoch: 22, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.624 Vali Acc: 0.949 Test Loss: 0.624 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 36.76898169517517
Epoch: 23, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.661 Vali Acc: 0.944 Test Loss: 0.661 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 37.90927529335022
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.610 Vali Acc: 0.950 Test Loss: 0.610 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 37.11779284477234
Epoch: 25, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.869 Vali Acc: 0.920 Test Loss: 0.869 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 11480980
model size : 46.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 72.98600673675537
Epoch: 1, Steps: 89 | Train Loss: 0.981 Vali Loss: 0.316 Vali Acc: 0.905 Test Loss: 0.316 Test Acc: 0.905
Validation loss decreased (inf --> -0.904593).  Saving model ...
Epoch: 2 cost time: 72.37202310562134
Epoch: 2, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 69.40601015090942
Epoch: 3, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.270 Vali Acc: 0.931 Test Loss: 0.270 Test Acc: 0.931
Validation loss decreased (-0.904593 --> -0.931056).  Saving model ...
Epoch: 4 cost time: 72.840576171875
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
Validation loss decreased (-0.931056 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 68.96690917015076
Epoch: 5, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.372 Vali Acc: 0.919 Test Loss: 0.372 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 72.96682214736938
Epoch: 6, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.494 Vali Acc: 0.893 Test Loss: 0.494 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 68.54724192619324
Epoch: 7, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.471 Vali Acc: 0.925 Test Loss: 0.471 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 73.57740449905396
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.456 Vali Acc: 0.934 Test Loss: 0.456 Test Acc: 0.934
Validation loss decreased (-0.933145 --> -0.933839).  Saving model ...
Epoch: 9 cost time: 68.20134568214417
Epoch: 9, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.387 Vali Acc: 0.932 Test Loss: 0.387 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 74.39677715301514
Epoch: 10, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.528 Vali Acc: 0.921 Test Loss: 0.528 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 68.65679812431335
Epoch: 11, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.605 Vali Acc: 0.914 Test Loss: 0.605 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 75.08486700057983
Epoch: 12, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.430 Vali Acc: 0.948 Test Loss: 0.430 Test Acc: 0.948
Validation loss decreased (-0.933839 --> -0.948464).  Saving model ...
Epoch: 13 cost time: 70.00702118873596
Epoch: 13, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 72.85185146331787
Epoch: 14, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.637 Vali Acc: 0.921 Test Loss: 0.637 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 71.02880764007568
Epoch: 15, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.359 Vali Acc: 0.953 Test Loss: 0.359 Test Acc: 0.953
Validation loss decreased (-0.948464 --> -0.952643).  Saving model ...
Epoch: 16 cost time: 73.92678093910217
Epoch: 16, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.311 Vali Acc: 0.958 Test Loss: 0.311 Test Acc: 0.958
Validation loss decreased (-0.952643 --> -0.957518).  Saving model ...
Epoch: 17 cost time: 72.0827202796936
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.355 Vali Acc: 0.951 Test Loss: 0.355 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 72.47018933296204
Epoch: 18, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.753 Vali Acc: 0.905 Test Loss: 0.753 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 71.98073601722717
Epoch: 19, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.526 Vali Acc: 0.948 Test Loss: 0.526 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 70.45064640045166
Epoch: 20, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.388 Vali Acc: 0.959 Test Loss: 0.388 Test Acc: 0.959
Validation loss decreased (-0.957518 --> -0.958910).  Saving model ...
Epoch: 21 cost time: 74.02040243148804
Epoch: 21, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.335 Vali Acc: 0.966 Test Loss: 0.335 Test Acc: 0.966
Validation loss decreased (-0.958910 --> -0.965874).  Saving model ...
Epoch: 22 cost time: 70.4267110824585
Epoch: 22, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.964 Vali Acc: 0.928 Test Loss: 0.964 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 75.4065330028534
Epoch: 23, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.712 Vali Acc: 0.942 Test Loss: 0.712 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 68.67190790176392
Epoch: 24, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.611 Vali Acc: 0.952 Test Loss: 0.611 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 75.04815244674683
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.731 Vali Acc: 0.937 Test Loss: 0.731 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 68.10015773773193
Epoch: 26, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.462 Vali Acc: 0.959 Test Loss: 0.462 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 62.2885627746582
Epoch: 27, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.522 Vali Acc: 0.948 Test Loss: 0.522 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 67.21851658821106
Epoch: 28, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.564 Vali Acc: 0.948 Test Loss: 0.564 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 66.06284260749817
Epoch: 29, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.689 Vali Acc: 0.950 Test Loss: 0.689 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 66.71082162857056
Epoch: 30, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.668 Vali Acc: 0.953 Test Loss: 0.668 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 37959060
model size : 147.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.807112455368042
Epoch: 1, Steps: 89 | Train Loss: 0.971 Vali Loss: 0.338 Vali Acc: 0.892 Test Loss: 0.338 Test Acc: 0.892
Validation loss decreased (inf --> -0.892058).  Saving model ...
Epoch: 2 cost time: 26.371843099594116
Epoch: 2, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.892058 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 24.068423748016357
Epoch: 3, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
Validation loss decreased (-0.948466 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 25.40880298614502
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.265 Vali Acc: 0.946 Test Loss: 0.265 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.248557090759277
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.399125576019287
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.259 Vali Acc: 0.955 Test Loss: 0.259 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.447088718414307
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.500 Vali Acc: 0.908 Test Loss: 0.500 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.203877925872803
Epoch: 8, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.337 Vali Acc: 0.947 Test Loss: 0.337 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.195912837982178
Epoch: 9, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.467 Vali Acc: 0.931 Test Loss: 0.467 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 25.382213354110718
Epoch: 10, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.554 Vali Acc: 0.919 Test Loss: 0.554 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 23.83470058441162
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.399 Vali Acc: 0.953 Test Loss: 0.399 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 26.46126103401184
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.463 Vali Acc: 0.948 Test Loss: 0.463 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.069161415100098
Epoch: 13, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.563 Vali Acc: 0.937 Test Loss: 0.563 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 11480980
model size : 46.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 34.4089412689209
Epoch: 1, Steps: 89 | Train Loss: 1.037 Vali Loss: 0.308 Vali Acc: 0.905 Test Loss: 0.308 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 34.19689893722534
Epoch: 2, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.255 Vali Acc: 0.936 Test Loss: 0.255 Test Acc: 0.936
Validation loss decreased (-0.905289 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 29.463377475738525
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.388323068618774
Epoch: 4, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.264 Vali Acc: 0.938 Test Loss: 0.264 Test Acc: 0.938
Validation loss decreased (-0.935931 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 30.977011680603027
Epoch: 5, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
Validation loss decreased (-0.938020 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 33.465522050857544
Epoch: 6, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954733).  Saving model ...
Epoch: 7 cost time: 32.32584190368652
Epoch: 7, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.530 Vali Acc: 0.870 Test Loss: 0.530 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 28.524017333984375
Epoch: 8, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.923 Vali Acc: 0.859 Test Loss: 0.923 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 33.70229125022888
Epoch: 9, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.239 Vali Acc: 0.962 Test Loss: 0.239 Test Acc: 0.962
Validation loss decreased (-0.954733 --> -0.962393).  Saving model ...
Epoch: 10 cost time: 29.635637283325195
Epoch: 10, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.445 Vali Acc: 0.930 Test Loss: 0.445 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 32.94853711128235
Epoch: 11, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.365 Vali Acc: 0.936 Test Loss: 0.365 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 29.627245664596558
Epoch: 12, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.59795308113098
Epoch: 13, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.365 Vali Acc: 0.935 Test Loss: 0.365 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 36.2731990814209
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.440 Vali Acc: 0.928 Test Loss: 0.440 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 35.92073106765747
Epoch: 15, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.333 Vali Acc: 0.954 Test Loss: 0.333 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 37.13869595527649
Epoch: 16, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.304 Vali Acc: 0.962 Test Loss: 0.304 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 36.17093205451965
Epoch: 17, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.578 Vali Acc: 0.916 Test Loss: 0.578 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 35.157471656799316
Epoch: 18, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.346 Vali Acc: 0.949 Test Loss: 0.346 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 36.4646897315979
Epoch: 19, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.419 Vali Acc: 0.946 Test Loss: 0.419 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 37959060
model size : 147.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.664121389389038
Epoch: 1, Steps: 89 | Train Loss: 1.001 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (inf --> -0.918521).  Saving model ...
Epoch: 2 cost time: 14.680968284606934
Epoch: 2, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.726358652114868
Epoch: 3, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.918521 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 14.726618766784668
Epoch: 4, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.182201385498047
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.178270101547241
Epoch: 6, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.144546031951904
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.438 Vali Acc: 0.921 Test Loss: 0.438 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.75495433807373
Epoch: 8, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.344 Vali Acc: 0.939 Test Loss: 0.344 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.69600248336792
Epoch: 9, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.328 Vali Acc: 0.943 Test Loss: 0.328 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 13.673832178115845
Epoch: 10, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.294 Vali Acc: 0.953 Test Loss: 0.294 Test Acc: 0.953
Validation loss decreased (-0.943591 --> -0.953340).  Saving model ...
Epoch: 11 cost time: 14.211938858032227
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.957 Test Loss: 0.277 Test Acc: 0.957
Validation loss decreased (-0.953340 --> -0.956822).  Saving model ...
Epoch: 12 cost time: 14.263133764266968
Epoch: 12, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.433 Vali Acc: 0.927 Test Loss: 0.433 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.651145935058594
Epoch: 13, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.299 Vali Acc: 0.958 Test Loss: 0.299 Test Acc: 0.958
Validation loss decreased (-0.956822 --> -0.957518).  Saving model ...
Epoch: 14 cost time: 14.342915534973145
Epoch: 14, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.373 Vali Acc: 0.938 Test Loss: 0.373 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.949661493301392
Epoch: 15, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.290 Vali Acc: 0.964 Test Loss: 0.290 Test Acc: 0.964
Validation loss decreased (-0.957518 --> -0.963785).  Saving model ...
Epoch: 16 cost time: 14.796051263809204
Epoch: 16, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.471 Vali Acc: 0.949 Test Loss: 0.471 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.414126634597778
Epoch: 17, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.608 Vali Acc: 0.924 Test Loss: 0.608 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.180023670196533
Epoch: 18, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.480 Vali Acc: 0.942 Test Loss: 0.480 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.339496850967407
Epoch: 19, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.416 Vali Acc: 0.958 Test Loss: 0.416 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.1280837059021
Epoch: 20, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.960 Vali Acc: 0.928 Test Loss: 0.960 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 13.259938955307007
Epoch: 21, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.654 Vali Acc: 0.950 Test Loss: 0.654 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 14.167764902114868
Epoch: 22, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.673 Vali Acc: 0.941 Test Loss: 0.673 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 14.546451568603516
Epoch: 23, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.702 Vali Acc: 0.943 Test Loss: 0.702 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.171129941940308
Epoch: 24, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.555 Vali Acc: 0.953 Test Loss: 0.555 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 14.373383045196533
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.649 Vali Acc: 0.946 Test Loss: 0.649 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 11480980
model size : 46.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 60.17580556869507
Epoch: 1, Steps: 89 | Train Loss: 1.007 Vali Loss: 0.221 Vali Acc: 0.940 Test Loss: 0.221 Test Acc: 0.940
Validation loss decreased (inf --> -0.940109).  Saving model ...
Epoch: 2 cost time: 54.81612825393677
Epoch: 2, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.283 Vali Acc: 0.912 Test Loss: 0.283 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 56.62607002258301
Epoch: 3, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.940109 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 59.331787109375
Epoch: 4, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 57.150041580200195
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.283 Vali Acc: 0.935 Test Loss: 0.283 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 55.929861545562744
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.496 Vali Acc: 0.912 Test Loss: 0.496 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 57.191980838775635
Epoch: 7, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.297 Vali Acc: 0.948 Test Loss: 0.297 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 57.98190975189209
Epoch: 8, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.534 Vali Acc: 0.921 Test Loss: 0.534 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 57.60860562324524
Epoch: 9, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.462 Vali Acc: 0.944 Test Loss: 0.462 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 55.46913409233093
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.398 Vali Acc: 0.947 Test Loss: 0.398 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 56.23861598968506
Epoch: 11, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.401 Vali Acc: 0.947 Test Loss: 0.401 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 59.06492567062378
Epoch: 12, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.432 Vali Acc: 0.946 Test Loss: 0.432 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 57.52213144302368
Epoch: 13, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.346 Vali Acc: 0.960 Test Loss: 0.346 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.960303).  Saving model ...
Epoch: 14 cost time: 54.79870414733887
Epoch: 14, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.650 Vali Acc: 0.917 Test Loss: 0.650 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 57.65860939025879
Epoch: 15, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.440 Vali Acc: 0.944 Test Loss: 0.440 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 58.708213567733765
Epoch: 16, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.436 Vali Acc: 0.943 Test Loss: 0.436 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 56.025744676589966
Epoch: 17, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.618 Vali Acc: 0.948 Test Loss: 0.618 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 55.4775493144989
Epoch: 18, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.534 Vali Acc: 0.953 Test Loss: 0.534 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 58.359572410583496
Epoch: 19, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.482 Vali Acc: 0.958 Test Loss: 0.482 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 58.109822511672974
Epoch: 20, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.424 Vali Acc: 0.963 Test Loss: 0.424 Test Acc: 0.963
Validation loss decreased (-0.960303 --> -0.963088).  Saving model ...
Epoch: 21 cost time: 57.545878648757935
Epoch: 21, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.289 Vali Acc: 0.964 Test Loss: 0.289 Test Acc: 0.964
Validation loss decreased (-0.963088 --> -0.964482).  Saving model ...
Epoch: 22 cost time: 55.350318908691406
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.275 Vali Acc: 0.974 Test Loss: 0.275 Test Acc: 0.974
Validation loss decreased (-0.964482 --> -0.973535).  Saving model ...
Epoch: 23 cost time: 58.43989896774292
Epoch: 23, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.395 Vali Acc: 0.964 Test Loss: 0.395 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 59.205204486846924
Epoch: 24, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.400 Vali Acc: 0.962 Test Loss: 0.400 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 56.173405170440674
Epoch: 25, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.359 Vali Acc: 0.967 Test Loss: 0.359 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 55.46781849861145
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.528 Vali Acc: 0.957 Test Loss: 0.528 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 59.39352250099182
Epoch: 27, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.362 Vali Acc: 0.965 Test Loss: 0.362 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 58.139270067214966
Epoch: 28, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.416 Vali Acc: 0.954 Test Loss: 0.416 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 57.22222709655762
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.456 Vali Acc: 0.955 Test Loss: 0.456 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 56.13606023788452
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.319 Vali Acc: 0.966 Test Loss: 0.319 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 19214228
model size : 75.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.007420301437378
Epoch: 1, Steps: 89 | Train Loss: 0.997 Vali Loss: 0.274 Vali Acc: 0.916 Test Loss: 0.274 Test Acc: 0.916
Validation loss decreased (inf --> -0.916432).  Saving model ...
Epoch: 2 cost time: 23.904548168182373
Epoch: 2, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.916432 --> -0.956823).  Saving model ...
Epoch: 3 cost time: 22.89456057548523
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.956823 --> -0.966572).  Saving model ...
Epoch: 4 cost time: 21.757984399795532
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.680675983428955
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.383 Vali Acc: 0.928 Test Loss: 0.383 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.584150552749634
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.61581540107727
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.457 Vali Acc: 0.943 Test Loss: 0.457 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.449573040008545
Epoch: 8, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.496 Vali Acc: 0.919 Test Loss: 0.496 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.500043630599976
Epoch: 9, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.429 Vali Acc: 0.936 Test Loss: 0.429 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.5292809009552
Epoch: 10, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.287 Vali Acc: 0.958 Test Loss: 0.287 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.500930547714233
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.468 Vali Acc: 0.928 Test Loss: 0.468 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.589667558670044
Epoch: 12, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.555 Vali Acc: 0.937 Test Loss: 0.555 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.233455419540405
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.500 Vali Acc: 0.928 Test Loss: 0.500 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 5974932
model size : 25.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 41.76659083366394
Epoch: 1, Steps: 89 | Train Loss: 1.024 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (inf --> -0.937324).  Saving model ...
Epoch: 2 cost time: 38.78868651390076
Epoch: 2, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 40.717069149017334
Epoch: 3, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (-0.937324 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 40.93071508407593
Epoch: 4, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.231 Vali Acc: 0.943 Test Loss: 0.231 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 43.047964572906494
Epoch: 5, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.269 Vali Acc: 0.942 Test Loss: 0.269 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 39.08494758605957
Epoch: 6, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.398 Vali Acc: 0.936 Test Loss: 0.398 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 38.99770188331604
Epoch: 7, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.243 Vali Acc: 0.955 Test Loss: 0.243 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 41.015443563461304
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.303 Vali Acc: 0.951 Test Loss: 0.303 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 42.643226861953735
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.792 Vali Acc: 0.923 Test Loss: 0.792 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 40.881808280944824
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.632 Vali Acc: 0.919 Test Loss: 0.632 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 38.93756628036499
Epoch: 11, Steps: 89 | Train Loss: 0.118 Vali Loss: 1.027 Vali Acc: 0.880 Test Loss: 1.027 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 38.76362752914429
Epoch: 12, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.710 Vali Acc: 0.927 Test Loss: 0.710 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 41.575414180755615
Epoch: 13, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.607 Vali Acc: 0.935 Test Loss: 0.607 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 19214228
model size : 75.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.387007474899292
Epoch: 1, Steps: 89 | Train Loss: 1.026 Vali Loss: 0.260 Vali Acc: 0.918 Test Loss: 0.260 Test Acc: 0.918
Validation loss decreased (inf --> -0.917825).  Saving model ...
Epoch: 2 cost time: 15.465357303619385
Epoch: 2, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.917825 --> -0.958216).  Saving model ...
Epoch: 3 cost time: 16.085620641708374
Epoch: 3, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.875751972198486
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.228602647781372
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.266 Vali Acc: 0.942 Test Loss: 0.266 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.952201843261719
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.247 Vali Acc: 0.955 Test Loss: 0.247 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.589515209197998
Epoch: 7, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
Validation loss decreased (-0.958216 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 15.325319766998291
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.306 Vali Acc: 0.940 Test Loss: 0.306 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.839689016342163
Epoch: 9, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.248 Vali Acc: 0.960 Test Loss: 0.248 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.065667629241943
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.01646065711975
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.324 Vali Acc: 0.955 Test Loss: 0.324 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.047916889190674
Epoch: 12, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.402 Vali Acc: 0.936 Test Loss: 0.402 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 16.176414489746094
Epoch: 13, Steps: 89 | Train Loss: 0.161 Vali Loss: 1.302 Vali Acc: 0.923 Test Loss: 1.302 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 16.377764225006104
Epoch: 14, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.499 Vali Acc: 0.943 Test Loss: 0.499 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.233978748321533
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.370 Vali Acc: 0.960 Test Loss: 0.370 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 15.285688638687134
Epoch: 16, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.326 Vali Acc: 0.952 Test Loss: 0.326 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 15.48784613609314
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.593 Vali Acc: 0.938 Test Loss: 0.593 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 5974932
model size : 25.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.290746450424194
Epoch: 1, Steps: 89 | Train Loss: 1.072 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (inf --> -0.917128).  Saving model ...
Epoch: 2 cost time: 19.620687007904053
Epoch: 2, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
Validation loss decreased (-0.917128 --> -0.957519).  Saving model ...
Epoch: 3 cost time: 21.480929613113403
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.418 Vali Acc: 0.896 Test Loss: 0.418 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.66949224472046
Epoch: 4, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.349 Vali Acc: 0.914 Test Loss: 0.349 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.37824010848999
Epoch: 5, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.251 Vali Acc: 0.945 Test Loss: 0.251 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.523662090301514
Epoch: 6, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.435 Vali Acc: 0.899 Test Loss: 0.435 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.925564765930176
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.705355167388916
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 1.302 Vali Acc: 0.868 Test Loss: 1.302 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 20.35879373550415
Epoch: 9, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.275 Vali Acc: 0.953 Test Loss: 0.275 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 21.279568195343018
Epoch: 10, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.429 Vali Acc: 0.931 Test Loss: 0.429 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 21.53660535812378
Epoch: 11, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.433 Vali Acc: 0.927 Test Loss: 0.433 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 21.413359880447388
Epoch: 12, Steps: 89 | Train Loss: 0.247 Vali Loss: 1.416 Vali Acc: 0.838 Test Loss: 1.416 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 19214228
model size : 75.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.538957357406616
Epoch: 1, Steps: 89 | Train Loss: 1.042 Vali Loss: 0.216 Vali Acc: 0.934 Test Loss: 0.216 Test Acc: 0.934
Validation loss decreased (inf --> -0.933842).  Saving model ...
Epoch: 2 cost time: 8.627405166625977
Epoch: 2, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.228 Vali Acc: 0.932 Test Loss: 0.228 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.3870267868042
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.933842 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 8.581782817840576
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.284 Vali Acc: 0.932 Test Loss: 0.284 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.68914008140564
Epoch: 5, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.230 Vali Acc: 0.949 Test Loss: 0.230 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.309587478637695
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.302 Vali Acc: 0.932 Test Loss: 0.302 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.230912446975708
Epoch: 7, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.367 Vali Acc: 0.932 Test Loss: 0.367 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.954811573028564
Epoch: 8, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.860235929489136
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.261135578155518
Epoch: 10, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
Validation loss decreased (-0.956823 --> -0.958911).  Saving model ...
Epoch: 11 cost time: 8.565849781036377
Epoch: 11, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.453 Vali Acc: 0.919 Test Loss: 0.453 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.463631868362427
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.294 Vali Acc: 0.954 Test Loss: 0.294 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.844695568084717
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.291 Vali Acc: 0.969 Test Loss: 0.291 Test Acc: 0.969
Validation loss decreased (-0.958911 --> -0.969356).  Saving model ...
Epoch: 14 cost time: 8.720976829528809
Epoch: 14, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.495 Vali Acc: 0.936 Test Loss: 0.495 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.823988437652588
Epoch: 15, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.546 Vali Acc: 0.932 Test Loss: 0.546 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.852858781814575
Epoch: 16, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.457 Vali Acc: 0.945 Test Loss: 0.457 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.671767950057983
Epoch: 17, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.446 Vali Acc: 0.951 Test Loss: 0.446 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.68109130859375
Epoch: 18, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.497 Vali Acc: 0.932 Test Loss: 0.497 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.608150005340576
Epoch: 19, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.534 Vali Acc: 0.944 Test Loss: 0.534 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.019248008728027
Epoch: 20, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.511 Vali Acc: 0.949 Test Loss: 0.511 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.412066221237183
Epoch: 21, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.706 Vali Acc: 0.928 Test Loss: 0.706 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.825709819793701
Epoch: 22, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.683 Vali Acc: 0.934 Test Loss: 0.683 Test Acc: 0.934
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.367905855178833
Epoch: 23, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.586 Vali Acc: 0.943 Test Loss: 0.586 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 5974932
model size : 25.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 63.00683546066284
Epoch: 1, Steps: 89 | Train Loss: 1.176 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
Validation loss decreased (inf --> -0.919217).  Saving model ...
Epoch: 2 cost time: 66.00568675994873
Epoch: 2, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.919217 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 64.78335928916931
Epoch: 3, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.942198 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 61.974952936172485
Epoch: 4, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.956823 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 64.14138960838318
Epoch: 5, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 64.94027066230774
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.502 Vali Acc: 0.914 Test Loss: 0.502 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 64.04704189300537
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.382 Vali Acc: 0.920 Test Loss: 0.382 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 62.344943046569824
Epoch: 8, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.622 Vali Acc: 0.887 Test Loss: 0.622 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 64.5273506641388
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.352 Vali Acc: 0.931 Test Loss: 0.352 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 65.00398659706116
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.372 Vali Acc: 0.932 Test Loss: 0.372 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 61.70211410522461
Epoch: 11, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.207 Vali Acc: 0.962 Test Loss: 0.207 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 61.830647230148315
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.217 Vali Acc: 0.960 Test Loss: 0.217 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 66.88308262825012
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 65.01501321792603
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.430 Vali Acc: 0.937 Test Loss: 0.430 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 18981076
model size : 73.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.197804927825928
Epoch: 1, Steps: 89 | Train Loss: 1.224 Vali Loss: 0.250 Vali Acc: 0.939 Test Loss: 0.250 Test Acc: 0.939
Validation loss decreased (inf --> -0.939413).  Saving model ...
Epoch: 2 cost time: 26.32104778289795
Epoch: 2, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.173 Vali Acc: 0.947 Test Loss: 0.173 Test Acc: 0.947
Validation loss decreased (-0.939413 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 26.118781328201294
Epoch: 3, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.947073 --> -0.949163).  Saving model ...
Epoch: 4 cost time: 26.036881923675537
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
Validation loss decreased (-0.949163 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 26.057689666748047
Epoch: 5, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.11276888847351
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.953341 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 24.828380584716797
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.180943727493286
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.80720615386963
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
Validation loss decreased (-0.957519 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 25.17128086090088
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.196 Vali Acc: 0.965 Test Loss: 0.196 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 26.096566200256348
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.316 Vali Acc: 0.940 Test Loss: 0.316 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 26.03954029083252
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.369 Vali Acc: 0.923 Test Loss: 0.369 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 26.021162748336792
Epoch: 13, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.440 Vali Acc: 0.932 Test Loss: 0.440 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 26.279606103897095
Epoch: 14, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.222 Vali Acc: 0.962 Test Loss: 0.222 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 24.790662050247192
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 24.352426290512085
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.965 Test Loss: 0.216 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 24.690112113952637
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.969 Test Loss: 0.202 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 25.978047370910645
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.386 Vali Acc: 0.939 Test Loss: 0.386 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 26.862537622451782
Epoch: 19, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.610 Vali Acc: 0.937 Test Loss: 0.610 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 5741524
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 47.84240746498108
Epoch: 1, Steps: 89 | Train Loss: 1.230 Vali Loss: 0.294 Vali Acc: 0.909 Test Loss: 0.294 Test Acc: 0.909
Validation loss decreased (inf --> -0.908771).  Saving model ...
Epoch: 2 cost time: 43.82261276245117
Epoch: 2, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.179 Vali Acc: 0.945 Test Loss: 0.179 Test Acc: 0.945
Validation loss decreased (-0.908771 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 44.15319776535034
Epoch: 3, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
Validation loss decreased (-0.944984 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 45.003878593444824
Epoch: 4, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.234 Vali Acc: 0.931 Test Loss: 0.234 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.787479400634766
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.219 Vali Acc: 0.935 Test Loss: 0.219 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 43.26627564430237
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 42.87113881111145
Epoch: 7, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 43.717214822769165
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 41.13076734542847
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.252 Vali Acc: 0.942 Test Loss: 0.252 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 44.22990345954895
Epoch: 10, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.351 Vali Acc: 0.932 Test Loss: 0.351 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 41.95059633255005
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 44.451688051223755
Epoch: 12, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.332 Vali Acc: 0.939 Test Loss: 0.332 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 40.31579399108887
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 18981076
model size : 73.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.07308554649353
Epoch: 1, Steps: 89 | Train Loss: 1.249 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (inf --> -0.944287).  Saving model ...
Epoch: 2 cost time: 15.271842956542969
Epoch: 2, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.214 Vali Acc: 0.935 Test Loss: 0.214 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.377636432647705
Epoch: 3, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.222 Vali Acc: 0.934 Test Loss: 0.222 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.452463150024414
Epoch: 4, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.944287 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 18.056227207183838
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 16.30893325805664
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.364031314849854
Epoch: 7, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 19.30099892616272
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.178178071975708
Epoch: 9, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.578608989715576
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.57271385192871
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.251 Vali Acc: 0.955 Test Loss: 0.251 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.35493493080139
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 18.37085485458374
Epoch: 13, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.334 Vali Acc: 0.939 Test Loss: 0.334 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 17.09019112586975
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.291 Vali Acc: 0.942 Test Loss: 0.291 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.398772478103638
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.321 Vali Acc: 0.935 Test Loss: 0.321 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.199885606765747
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.368 Vali Acc: 0.923 Test Loss: 0.368 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 18.327820539474487
Epoch: 17, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.272 Vali Acc: 0.945 Test Loss: 0.272 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 5741524
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.165798902511597
Epoch: 1, Steps: 89 | Train Loss: 1.270 Vali Loss: 0.320 Vali Acc: 0.914 Test Loss: 0.320 Test Acc: 0.914
Validation loss decreased (inf --> -0.914342).  Saving model ...
Epoch: 2 cost time: 21.198212385177612
Epoch: 2, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.197 Vali Acc: 0.942 Test Loss: 0.197 Test Acc: 0.942
Validation loss decreased (-0.914342 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 23.227980136871338
Epoch: 3, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.673105478286743
Epoch: 4, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
Validation loss decreased (-0.941502 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 21.13891077041626
Epoch: 5, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.954037 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 23.339030027389526
Epoch: 6, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.351 Vali Acc: 0.912 Test Loss: 0.351 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.11391806602478
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.401 Vali Acc: 0.902 Test Loss: 0.401 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.580519676208496
Epoch: 8, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.404 Vali Acc: 0.898 Test Loss: 0.404 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.463443756103516
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.344 Vali Acc: 0.924 Test Loss: 0.344 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.563528299331665
Epoch: 10, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.340 Vali Acc: 0.938 Test Loss: 0.340 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.120879888534546
Epoch: 11, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 19.78724694252014
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 20.951743602752686
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 21.440743684768677
Epoch: 14, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.861 Vali Acc: 0.919 Test Loss: 0.861 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 20.52341318130493
Epoch: 15, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.233 Vali Acc: 0.954 Test Loss: 0.233 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 18981076
model size : 73.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.102907180786133
Epoch: 1, Steps: 89 | Train Loss: 1.287 Vali Loss: 0.401 Vali Acc: 0.895 Test Loss: 0.401 Test Acc: 0.895
Validation loss decreased (inf --> -0.894843).  Saving model ...
Epoch: 2 cost time: 9.308758974075317
Epoch: 2, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.894843 --> -0.940806).  Saving model ...
Epoch: 3 cost time: 9.435547828674316
Epoch: 3, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.273 Vali Acc: 0.906 Test Loss: 0.273 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.292162656784058
Epoch: 4, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.196 Vali Acc: 0.945 Test Loss: 0.196 Test Acc: 0.945
Validation loss decreased (-0.940806 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 8.571232318878174
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.219 Vali Acc: 0.934 Test Loss: 0.219 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.193519353866577
Epoch: 6, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.441633224487305
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.367528915405273
Epoch: 8, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.183 Vali Acc: 0.947 Test Loss: 0.183 Test Acc: 0.947
Validation loss decreased (-0.944984 --> -0.947073).  Saving model ...
Epoch: 9 cost time: 9.257524251937866
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.415705919265747
Epoch: 10, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.291 Vali Acc: 0.937 Test Loss: 0.291 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.803935050964355
Epoch: 11, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.299 Vali Acc: 0.940 Test Loss: 0.299 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.551311731338501
Epoch: 12, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.304 Vali Acc: 0.936 Test Loss: 0.304 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.733535051345825
Epoch: 13, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.331 Vali Acc: 0.932 Test Loss: 0.331 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.551469802856445
Epoch: 14, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.270 Vali Acc: 0.953 Test Loss: 0.270 Test Acc: 0.953
Validation loss decreased (-0.947073 --> -0.953340).  Saving model ...
Epoch: 15 cost time: 9.245549440383911
Epoch: 15, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.298219203948975
Epoch: 16, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.256824731826782
Epoch: 17, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.379 Vali Acc: 0.924 Test Loss: 0.379 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.48801565170288
Epoch: 18, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.260 Vali Acc: 0.951 Test Loss: 0.260 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.384303092956543
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.301 Vali Acc: 0.952 Test Loss: 0.301 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.614073753356934
Epoch: 20, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.390 Vali Acc: 0.941 Test Loss: 0.390 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.00517988204956
Epoch: 21, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.518 Vali Acc: 0.919 Test Loss: 0.518 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.323586225509644
Epoch: 22, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.737 Vali Acc: 0.899 Test Loss: 0.737 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.464712142944336
Epoch: 23, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.364 Vali Acc: 0.942 Test Loss: 0.364 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.451075792312622
Epoch: 24, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.314 Vali Acc: 0.949 Test Loss: 0.314 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 5741524
model size : 23.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 33.75138759613037
Epoch: 1, Steps: 89 | Train Loss: 1.279 Vali Loss: 0.293 Vali Acc: 0.909 Test Loss: 0.293 Test Acc: 0.909
Validation loss decreased (inf --> -0.909468).  Saving model ...
Epoch: 2 cost time: 35.756072759628296
Epoch: 2, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
Validation loss decreased (-0.909468 --> -0.935235).  Saving model ...
Epoch: 3 cost time: 32.051570415496826
Epoch: 3, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
Validation loss decreased (-0.935235 --> -0.959609).  Saving model ...
Epoch: 4 cost time: 36.12269973754883
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.204 Vali Acc: 0.936 Test Loss: 0.204 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 33.8547203540802
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.959609 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 32.50196957588196
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 36.07374858856201
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 32.01464605331421
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.282 Vali Acc: 0.946 Test Loss: 0.282 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 35.81829309463501
Epoch: 9, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 33.9296669960022
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.367 Vali Acc: 0.932 Test Loss: 0.367 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 32.51423263549805
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 35.775304555892944
Epoch: 12, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.200 Vali Acc: 0.962 Test Loss: 0.200 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 32.30807328224182
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.276 Vali Acc: 0.942 Test Loss: 0.276 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 35.72609519958496
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 33.92605948448181
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 9607892
model size : 37.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.789616584777832
Epoch: 1, Steps: 89 | Train Loss: 1.229 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (inf --> -0.919217).  Saving model ...
Epoch: 2 cost time: 15.43032169342041
Epoch: 2, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.197 Vali Acc: 0.940 Test Loss: 0.197 Test Acc: 0.940
Validation loss decreased (-0.919217 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 14.611775636672974
Epoch: 3, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.940109 --> -0.963091).  Saving model ...
Epoch: 4 cost time: 13.671787023544312
Epoch: 4, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.054141283035278
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.407262802124023
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.391578435897827
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.632751703262329
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
Validation loss decreased (-0.963091 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 13.630791425704956
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.522010803222656
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 11.950957536697388
Epoch: 11, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.653626680374146
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.311 Vali Acc: 0.943 Test Loss: 0.311 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.04765820503235
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.075570821762085
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.170 Vali Acc: 0.974 Test Loss: 0.170 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974232).  Saving model ...
Epoch: 15 cost time: 16.245914220809937
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.395 Vali Acc: 0.941 Test Loss: 0.395 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.20194363594055
Epoch: 16, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.280 Vali Acc: 0.958 Test Loss: 0.280 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.234992980957031
Epoch: 17, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.353 Vali Acc: 0.944 Test Loss: 0.353 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.734339952468872
Epoch: 18, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.306 Vali Acc: 0.954 Test Loss: 0.306 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.151002883911133
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.290 Vali Acc: 0.962 Test Loss: 0.290 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 16.124091386795044
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.964 Test Loss: 0.250 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 16.266260147094727
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.969 Test Loss: 0.234 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 16.09840726852417
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.974 Test Loss: 0.235 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 16.079333543777466
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.971 Test Loss: 0.230 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 15.446728467941284
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.973 Test Loss: 0.232 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 2987988
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.974873781204224
Epoch: 1, Steps: 89 | Train Loss: 1.317 Vali Loss: 0.336 Vali Acc: 0.906 Test Loss: 0.336 Test Acc: 0.906
Validation loss decreased (inf --> -0.905985).  Saving model ...
Epoch: 2 cost time: 25.019274473190308
Epoch: 2, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
Validation loss decreased (-0.905985 --> -0.951252).  Saving model ...
Epoch: 3 cost time: 27.224207639694214
Epoch: 3, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.249665021896362
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.185 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.19442629814148
Epoch: 5, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.480451107025146
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.951252 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 25.905812978744507
Epoch: 7, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.312 Vali Acc: 0.934 Test Loss: 0.312 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.03064274787903
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.235 Vali Acc: 0.953 Test Loss: 0.235 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 27.3369197845459
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.402 Vali Acc: 0.938 Test Loss: 0.402 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.74956464767456
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.961698 --> -0.965180).  Saving model ...
Epoch: 11 cost time: 25.930862426757812
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.217 Vali Acc: 0.958 Test Loss: 0.217 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.50676417350769
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.948838472366333
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.960 Test Loss: 0.219 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 27.84790802001953
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 27.345799684524536
Epoch: 15, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.233 Vali Acc: 0.960 Test Loss: 0.233 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 27.307477474212646
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 17 cost time: 25.778366327285767
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.964 Test Loss: 0.233 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 26.502163887023926
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 25.416255235671997
Epoch: 19, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.418 Vali Acc: 0.944 Test Loss: 0.418 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 27.316520929336548
Epoch: 20, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.229 Vali Acc: 0.964 Test Loss: 0.229 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 27.30431604385376
Epoch: 21, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.277 Vali Acc: 0.960 Test Loss: 0.277 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 27.56141996383667
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.360 Vali Acc: 0.961 Test Loss: 0.360 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 25.819123029708862
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.415 Vali Acc: 0.953 Test Loss: 0.415 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 25.796592950820923
Epoch: 24, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.520 Vali Acc: 0.958 Test Loss: 0.520 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 27.292749881744385
Epoch: 25, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.329 Vali Acc: 0.962 Test Loss: 0.329 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 28.178253889083862
Epoch: 26, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.397 Vali Acc: 0.960 Test Loss: 0.397 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 9607892
model size : 37.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.680131196975708
Epoch: 1, Steps: 89 | Train Loss: 1.260 Vali Loss: 0.244 Vali Acc: 0.942 Test Loss: 0.244 Test Acc: 0.942
Validation loss decreased (inf --> -0.942198).  Saving model ...
Epoch: 2 cost time: 11.386713027954102
Epoch: 2, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.179 Vali Acc: 0.945 Test Loss: 0.179 Test Acc: 0.945
Validation loss decreased (-0.942198 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 11.577374935150146
Epoch: 3, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
Validation loss decreased (-0.944984 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 11.654423952102661
Epoch: 4, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.004127979278564
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.458645820617676
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.954734 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 12.17750334739685
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.318135023117065
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.205 Vali Acc: 0.961 Test Loss: 0.205 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.288031578063965
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.345168352127075
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.284854650497437
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.891101837158203
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.291 Vali Acc: 0.940 Test Loss: 0.291 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.885632038116455
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.68938159942627
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.270 Vali Acc: 0.952 Test Loss: 0.270 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.471328258514404
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.364 Vali Acc: 0.932 Test Loss: 0.364 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.49661135673523
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.224 Vali Acc: 0.962 Test Loss: 0.224 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 2987988
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.63405132293701
Epoch: 1, Steps: 89 | Train Loss: 1.366 Vali Loss: 0.341 Vali Acc: 0.904 Test Loss: 0.341 Test Acc: 0.904
Validation loss decreased (inf --> -0.903896).  Saving model ...
Epoch: 2 cost time: 17.453247547149658
Epoch: 2, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.206 Vali Acc: 0.940 Test Loss: 0.206 Test Acc: 0.940
Validation loss decreased (-0.903896 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 16.933411121368408
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
Validation loss decreased (-0.940109 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 16.202855587005615
Epoch: 4, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.207 Vali Acc: 0.934 Test Loss: 0.207 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.023801565170288
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.197 Vali Acc: 0.939 Test Loss: 0.197 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.805860996246338
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.18233633041382
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.547293663024902
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.680 Vali Acc: 0.809 Test Loss: 0.680 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.00711154937744
Epoch: 9, Steps: 89 | Train Loss: 0.301 Vali Loss: 1.028 Vali Acc: 0.848 Test Loss: 1.028 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.153817892074585
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.267228364944458
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.341 Vali Acc: 0.924 Test Loss: 0.341 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.03810429573059
Epoch: 12, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.549 Vali Acc: 0.874 Test Loss: 0.549 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.071563243865967
Epoch: 13, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 9607892
model size : 37.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.719403982162476
Epoch: 1, Steps: 89 | Train Loss: 1.292 Vali Loss: 0.270 Vali Acc: 0.936 Test Loss: 0.270 Test Acc: 0.936
Validation loss decreased (inf --> -0.935930).  Saving model ...
Epoch: 2 cost time: 6.782639026641846
Epoch: 2, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.935930 --> -0.956823).  Saving model ...
Epoch: 3 cost time: 6.8365442752838135
Epoch: 3, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.089605331420898
Epoch: 4, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 7.134707450866699
Epoch: 5, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.297 Vali Acc: 0.929 Test Loss: 0.297 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.061793327331543
Epoch: 6, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.317 Vali Acc: 0.926 Test Loss: 0.317 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.967106819152832
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.042947292327881
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.373 Vali Acc: 0.928 Test Loss: 0.373 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.112682580947876
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.298 Vali Acc: 0.932 Test Loss: 0.298 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.451701402664185
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.431 Vali Acc: 0.914 Test Loss: 0.431 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.84438419342041
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.451 Vali Acc: 0.891 Test Loss: 0.451 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.530679225921631
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.56861424446106
Epoch: 13, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.574537038803101
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.253 Vali Acc: 0.958 Test Loss: 0.253 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 2987988
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.94467282295227
Epoch: 1, Steps: 89 | Train Loss: 1.294 Vali Loss: 0.313 Vali Acc: 0.902 Test Loss: 0.313 Test Acc: 0.902
Validation loss decreased (inf --> -0.901807).  Saving model ...
Epoch: 2 cost time: 25.698904037475586
Epoch: 2, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
Validation loss decreased (-0.901807 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 25.000951051712036
Epoch: 3, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
Validation loss decreased (-0.938020 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 25.078731775283813
Epoch: 4, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.72631025314331
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.451 Vali Acc: 0.924 Test Loss: 0.451 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.36784863471985
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.913905143737793
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.87555718421936
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 24.889216423034668
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.935668468475342
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.960 Test Loss: 0.238 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.28149676322937
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.222721338272095
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.350 Vali Acc: 0.942 Test Loss: 0.350 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.59252119064331
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.293 Vali Acc: 0.953 Test Loss: 0.293 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 4921300
model size : 20.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.068561315536499
Epoch: 1, Steps: 89 | Train Loss: 1.270 Vali Loss: 0.315 Vali Acc: 0.907 Test Loss: 0.315 Test Acc: 0.907
Validation loss decreased (inf --> -0.907378).  Saving model ...
Epoch: 2 cost time: 12.095511436462402
Epoch: 2, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.907378 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 11.886611223220825
Epoch: 3, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 11.759361505508423
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.19632887840271
Epoch: 5, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.122854709625244
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.038710117340088
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.101143836975098
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.336565017700195
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.961698 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 11.907359838485718
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.599966526031494
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.630223035812378
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.964 Test Loss: 0.209 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.627864599227905
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.314 Vali Acc: 0.942 Test Loss: 0.314 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.619049072265625
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.575603485107422
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.235 Vali Acc: 0.967 Test Loss: 0.235 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.034613609313965
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.971 Test Loss: 0.225 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.345835447311401
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.969 Test Loss: 0.260 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.81426739692688
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.030598878860474
Epoch: 19, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.268 Vali Acc: 0.964 Test Loss: 0.268 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1611220
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.638173580169678
Epoch: 1, Steps: 89 | Train Loss: 1.320 Vali Loss: 0.294 Vali Acc: 0.923 Test Loss: 0.294 Test Acc: 0.923
Validation loss decreased (inf --> -0.922699).  Saving model ...
Epoch: 2 cost time: 18.114047050476074
Epoch: 2, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.922699 --> -0.945681).  Saving model ...
Epoch: 3 cost time: 18.520745277404785
Epoch: 3, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.945681 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 18.142683506011963
Epoch: 4, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.5704448223114
Epoch: 5, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.388510704040527
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.328678846359253
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.655981302261353
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.224 Vali Acc: 0.945 Test Loss: 0.224 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 18.61782145500183
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.520931243896484
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.259 Vali Acc: 0.954 Test Loss: 0.259 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 18.460036754608154
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.182 Vali Acc: 0.961 Test Loss: 0.182 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 18.493371963500977
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 17.453768968582153
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.269 Vali Acc: 0.951 Test Loss: 0.269 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 4921300
model size : 20.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.94641637802124
Epoch: 1, Steps: 89 | Train Loss: 1.294 Vali Loss: 0.304 Vali Acc: 0.924 Test Loss: 0.304 Test Acc: 0.924
Validation loss decreased (inf --> -0.924092).  Saving model ...
Epoch: 2 cost time: 8.529404640197754
Epoch: 2, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.165 Vali Acc: 0.945 Test Loss: 0.165 Test Acc: 0.945
Validation loss decreased (-0.924092 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 9.040486812591553
Epoch: 3, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.944984 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 9.12450122833252
Epoch: 4, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 9.05655574798584
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.071136236190796
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.078085660934448
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.179017543792725
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.381999969482422
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.579899787902832
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.302 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.47197961807251
Epoch: 11, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.402 Vali Acc: 0.926 Test Loss: 0.402 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.494247198104858
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.203 Vali Acc: 0.964 Test Loss: 0.203 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.472447156906128
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.960 Test Loss: 0.236 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.477336168289185
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.204 Vali Acc: 0.960 Test Loss: 0.204 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 1611220
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.339534521102905
Epoch: 1, Steps: 89 | Train Loss: 1.358 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (inf --> -0.899718).  Saving model ...
Epoch: 2 cost time: 10.8752601146698
Epoch: 2, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.250 Vali Acc: 0.917 Test Loss: 0.250 Test Acc: 0.917
Validation loss decreased (-0.899718 --> -0.917128).  Saving model ...
Epoch: 3 cost time: 10.222176551818848
Epoch: 3, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.917128 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 10.19490647315979
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.958912 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 10.164440631866455
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.179359436035156
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 9.650529861450195
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.42570686340332
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.38893175125122
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.973536 --> -0.981197).  Saving model ...
Epoch: 10 cost time: 10.144978046417236
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.825586080551147
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.170375347137451
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.179177045822144
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.266 Vali Acc: 0.946 Test Loss: 0.266 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.317224740982056
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.117628812789917
Epoch: 15, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.22879409790039
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.299 Vali Acc: 0.939 Test Loss: 0.299 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.017703294754028
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.537907123565674
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.960 Test Loss: 0.204 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.441403865814209
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.347 Vali Acc: 0.934 Test Loss: 0.347 Test Acc: 0.934
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 4921300
model size : 20.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.185121536254883
Epoch: 1, Steps: 89 | Train Loss: 1.348 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
Validation loss decreased (inf --> -0.905985).  Saving model ...
Epoch: 2 cost time: 5.6595306396484375
Epoch: 2, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.231 Vali Acc: 0.921 Test Loss: 0.231 Test Acc: 0.921
Validation loss decreased (-0.905985 --> -0.921307).  Saving model ...
Epoch: 3 cost time: 5.678168296813965
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.921307 --> -0.959609).  Saving model ...
Epoch: 4 cost time: 5.965036153793335
Epoch: 4, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.983203172683716
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.05930757522583
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.959609 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 6.227320671081543
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.117161512374878
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.997640609741211
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.089203119277954
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.286 Vali Acc: 0.934 Test Loss: 0.286 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.085047721862793
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.7790687084198
Epoch: 12, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.478 Vali Acc: 0.896 Test Loss: 0.478 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.739113092422485
Epoch: 13, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.525 Vali Acc: 0.882 Test Loss: 0.525 Test Acc: 0.882
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.725194931030273
Epoch: 14, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.444 Vali Acc: 0.927 Test Loss: 0.444 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.6628687381744385
Epoch: 15, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.334 Vali Acc: 0.943 Test Loss: 0.334 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.686742544174194
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1611220
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.953059196472168
Epoch: 1, Steps: 89 | Train Loss: 1.577 Vali Loss: 0.398 Vali Acc: 0.903 Test Loss: 0.398 Test Acc: 0.903
Validation loss decreased (inf --> -0.902503).  Saving model ...
Epoch: 2 cost time: 27.960468530654907
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.218 Vali Acc: 0.935 Test Loss: 0.218 Test Acc: 0.935
Validation loss decreased (-0.902503 --> -0.935235).  Saving model ...
Epoch: 3 cost time: 27.9274263381958
Epoch: 3, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.935235 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 27.35705828666687
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
Validation loss decreased (-0.951948 --> -0.952645).  Saving model ...
Epoch: 5 cost time: 26.825658082962036
Epoch: 5, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
Validation loss decreased (-0.952645 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 26.476792335510254
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.955430 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 27.663158178329468
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.795650720596313
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 28.363558530807495
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.964483).  Saving model ...
Epoch: 10 cost time: 26.505305528640747
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 26.064693689346313
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.28759503364563
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 28.648741006851196
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.234 Vali Acc: 0.946 Test Loss: 0.234 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 28.04031014442444
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.05831503868103
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 26.28860569000244
Epoch: 16, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.336 Vali Acc: 0.940 Test Loss: 0.336 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 26.605529069900513
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 25.825401067733765
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 27.492114543914795
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 27.47179341316223
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 4804724
model size : 18.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.623419046401978
Epoch: 1, Steps: 89 | Train Loss: 1.565 Vali Loss: 0.424 Vali Acc: 0.882 Test Loss: 0.424 Test Acc: 0.882
Validation loss decreased (inf --> -0.881611).  Saving model ...
Epoch: 2 cost time: 14.386701583862305
Epoch: 2, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.881611 --> -0.942199).  Saving model ...
Epoch: 3 cost time: 14.387938261032104
Epoch: 3, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
Validation loss decreased (-0.942199 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 15.611629724502563
Epoch: 4, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.807323932647705
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.961001 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 22.685511589050293
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 16.331279754638672
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.501631259918213
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.714603185653687
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.69447922706604
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.82921576499939
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 22.532952070236206
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.212 Vali Acc: 0.953 Test Loss: 0.212 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 21.657206773757935
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 20.724939584732056
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 20.42923402786255
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.377 Vali Acc: 0.938 Test Loss: 0.377 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.29971170425415
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 1494516
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 30.234113216400146
Epoch: 1, Steps: 89 | Train Loss: 1.626 Vali Loss: 0.396 Vali Acc: 0.914 Test Loss: 0.396 Test Acc: 0.914
Validation loss decreased (inf --> -0.914341).  Saving model ...
Epoch: 2 cost time: 25.792115688323975
Epoch: 2, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.914341 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 27.166147232055664
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
Validation loss decreased (-0.941502 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 28.112760543823242
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
Validation loss decreased (-0.954734 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 26.015393495559692
Epoch: 5, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.003594160079956
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970055).  Saving model ...
Epoch: 7 cost time: 27.87146234512329
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.386652946472168
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.123950481414795
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.69957947731018
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 27.99005961418152
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.17715549468994
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 13 cost time: 26.236459493637085
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 28.228440284729004
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 27.211246728897095
Epoch: 15, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 26.064167499542236
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 28.27248191833496
Epoch: 17, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 28.34895896911621
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.225 Vali Acc: 0.960 Test Loss: 0.225 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 26.183914184570312
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 26.390886068344116
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 28.239707708358765
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.966 Test Loss: 0.184 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 26.580422163009644
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 4804724
model size : 18.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.569478034973145
Epoch: 1, Steps: 89 | Train Loss: 1.596 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
Validation loss decreased (inf --> -0.874647).  Saving model ...
Epoch: 2 cost time: 16.630384922027588
Epoch: 2, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
Validation loss decreased (-0.874647 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 16.31001567840576
Epoch: 3, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.959609).  Saving model ...
Epoch: 4 cost time: 14.907150745391846
Epoch: 4, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.205 Vali Acc: 0.929 Test Loss: 0.205 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.235255002975464
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
Validation loss decreased (-0.959609 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 26.127758026123047
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.015363931655884
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.959609 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 26.83305311203003
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.975626 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 24.569124221801758
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.178183794021606
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.039629697799683
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 25.992660760879517
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 26.10301685333252
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 24.506360054016113
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 23.748188734054565
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 25.265854120254517
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.319227933883667
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 26.32537055015564
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 1494516
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.840762615203857
Epoch: 1, Steps: 89 | Train Loss: 1.654 Vali Loss: 0.454 Vali Acc: 0.903 Test Loss: 0.454 Test Acc: 0.903
Validation loss decreased (inf --> -0.903199).  Saving model ...
Epoch: 2 cost time: 24.903942346572876
Epoch: 2, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.242 Vali Acc: 0.935 Test Loss: 0.242 Test Acc: 0.935
Validation loss decreased (-0.903199 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 23.419028520584106
Epoch: 3, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
Validation loss decreased (-0.935234 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 26.117059469223022
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 25.977071285247803
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.938799142837524
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.97110891342163
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.214 Vali Acc: 0.940 Test Loss: 0.214 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.913979053497314
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.341 Vali Acc: 0.903 Test Loss: 0.341 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 25.48072385787964
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 26.196401596069336
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.960 Test Loss: 0.120 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.800923824310303
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.218 Vali Acc: 0.940 Test Loss: 0.218 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.064670085906982
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.043488264083862
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 26.671984910964966
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.958597898483276
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 24.00703191757202
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 24.017284631729126
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 23.362273931503296
Epoch: 18, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 22.441980600357056
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 4804724
model size : 18.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.732810974121094
Epoch: 1, Steps: 89 | Train Loss: 1.616 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
Validation loss decreased (inf --> -0.855845).  Saving model ...
Epoch: 2 cost time: 17.220418453216553
Epoch: 2, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.855845 --> -0.922003).  Saving model ...
Epoch: 3 cost time: 17.087764501571655
Epoch: 3, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.922003 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 15.947409391403198
Epoch: 4, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.947770 --> -0.949163).  Saving model ...
Epoch: 5 cost time: 17.000853538513184
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.949163 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 16.818084001541138
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.152 Vali Acc: 0.948 Test Loss: 0.152 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.740044593811035
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.154 Vali Acc: 0.948 Test Loss: 0.154 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.69417405128479
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 14.203242301940918
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.539936065673828
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.12804388999939
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.739023685455322
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.357431888580322
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 18.521687507629395
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.356 Vali Acc: 0.929 Test Loss: 0.356 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 17.51244854927063
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 16.917547702789307
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 16.56383728981018
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 18 cost time: 19.363185167312622
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 18.4329993724823
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.434 Vali Acc: 0.913 Test Loss: 0.434 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 19.11637592315674
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 19.17162251472473
Epoch: 21, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 18.04630994796753
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 18.2137930393219
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 18.14707922935486
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.214 Vali Acc: 0.954 Test Loss: 0.214 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 17.367897748947144
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.449 Vali Acc: 0.927 Test Loss: 0.449 Test Acc: 0.927
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 18.258504152297974
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 18.999918222427368
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.428 Vali Acc: 0.920 Test Loss: 0.428 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1494516
model size : 6.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 46.365532875061035
Epoch: 1, Steps: 89 | Train Loss: 1.645 Vali Loss: 0.449 Vali Acc: 0.886 Test Loss: 0.449 Test Acc: 0.886
Validation loss decreased (inf --> -0.885789).  Saving model ...
Epoch: 2 cost time: 44.712806224823
Epoch: 2, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.885789 --> -0.956126).  Saving model ...
Epoch: 3 cost time: 41.488950967788696
Epoch: 3, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.140 Vali Acc: 0.955 Test Loss: 0.140 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 40.3170907497406
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 39.7940239906311
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.956126 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 41.66144800186157
Epoch: 6, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 41.860331773757935
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 41.259785890579224
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 39.29889225959778
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 42.009480476379395
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 41.43745565414429
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 42.45450758934021
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.208 Vali Acc: 0.965 Test Loss: 0.208 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 42.470322608947754
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 41.09160542488098
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 41.00455594062805
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 42.98264217376709
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 41.2763352394104
Epoch: 17, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 33.46794676780701
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 2461044
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.770548343658447
Epoch: 1, Steps: 89 | Train Loss: 1.654 Vali Loss: 0.466 Vali Acc: 0.879 Test Loss: 0.466 Test Acc: 0.879
Validation loss decreased (inf --> -0.878825).  Saving model ...
Epoch: 2 cost time: 21.981029272079468
Epoch: 2, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.878825 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 21.871855974197388
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.157 Vali Acc: 0.955 Test Loss: 0.157 Test Acc: 0.955
Validation loss decreased (-0.939413 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 22.095790147781372
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.190 Vali Acc: 0.932 Test Loss: 0.190 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.918210744857788
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.027589082717896
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.710121154785156
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.954734 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 22.750539541244507
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.953 Test Loss: 0.205 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.253225088119507
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.934820890426636
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.74508285522461
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.122584104537964
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.927791357040405
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.196019887924194
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 23.525392770767212
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.970055 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 25.564924240112305
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.114927053451538
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980500).  Saving model ...
Epoch: 18 cost time: 25.441614627838135
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.980500 --> -0.981893).  Saving model ...
Epoch: 19 cost time: 24.510332584381104
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.647582054138184
Epoch: 20, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 21 cost time: 24.717222690582275
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 22 cost time: 24.24011206626892
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 25.52740716934204
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 22.084052324295044
Epoch: 24, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.289 Vali Acc: 0.939 Test Loss: 0.289 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 23.100403547286987
Epoch: 25, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.320 Vali Acc: 0.945 Test Loss: 0.320 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 19.68758273124695
Epoch: 26, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.436 Vali Acc: 0.931 Test Loss: 0.436 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 20.394367694854736
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.299 Vali Acc: 0.955 Test Loss: 0.299 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 20.846483945846558
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 20.901711463928223
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.969 Test Loss: 0.222 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 22.540838479995728
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.965 Test Loss: 0.215 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 805876
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 30.630207538604736
Epoch: 1, Steps: 89 | Train Loss: 1.670 Vali Loss: 0.516 Vali Acc: 0.869 Test Loss: 0.516 Test Acc: 0.869
Validation loss decreased (inf --> -0.869076).  Saving model ...
Epoch: 2 cost time: 25.1235134601593
Epoch: 2, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.869076 --> -0.949859).  Saving model ...
Epoch: 3 cost time: 27.813026666641235
Epoch: 3, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (-0.949859 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 27.82523274421692
Epoch: 4, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.185852527618408
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
Validation loss decreased (-0.955430 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 31.996875047683716
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.78323769569397
Epoch: 7, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 8 cost time: 30.33175301551819
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 30.384232997894287
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 30.583174228668213
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 31.314414024353027
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 32.35491585731506
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 31.61292314529419
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.30979585647583
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 28.255747318267822
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 27.68054747581482
Epoch: 16, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 28.321869611740112
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 26.710513591766357
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 29.28605604171753
Epoch: 19, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.320 Vali Acc: 0.928 Test Loss: 0.320 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.679787397384644
Epoch: 20, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.307 Vali Acc: 0.938 Test Loss: 0.307 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 28.059779405593872
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.183 Vali Acc: 0.968 Test Loss: 0.183 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 29.053889274597168
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 27.126485109329224
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 27.786831378936768
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 30.097442388534546
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 2461044
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.195099592208862
Epoch: 1, Steps: 89 | Train Loss: 1.671 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
Validation loss decreased (inf --> -0.876736).  Saving model ...
Epoch: 2 cost time: 16.869616508483887
Epoch: 2, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
Validation loss decreased (-0.876736 --> -0.935235).  Saving model ...
Epoch: 3 cost time: 16.312505960464478
Epoch: 3, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (-0.935235 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 16.9281165599823
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.264715433120728
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.152 Vali Acc: 0.945 Test Loss: 0.152 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.029931545257568
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.947770 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 16.106518030166626
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 16.10544729232788
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.077048063278198
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.968662 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 17.02506995201111
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.062337636947632
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.32539200782776
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.078092098236084
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 18.29952073097229
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 18.53281021118164
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 19.610140800476074
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.955 Test Loss: 0.206 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.552088737487793
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.821657180786133
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 17.661604642868042
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 805876
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 20.8715603351593
Epoch: 1, Steps: 89 | Train Loss: 1.723 Vali Loss: 0.509 Vali Acc: 0.880 Test Loss: 0.509 Test Acc: 0.880
Validation loss decreased (inf --> -0.880218).  Saving model ...
Epoch: 2 cost time: 18.966182947158813
Epoch: 2, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.226 Vali Acc: 0.934 Test Loss: 0.226 Test Acc: 0.934
Validation loss decreased (-0.880218 --> -0.933842).  Saving model ...
Epoch: 3 cost time: 17.871607303619385
Epoch: 3, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.933842 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 15.749996423721313
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.675193786621094
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.124 Vali Acc: 0.961 Test Loss: 0.124 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.70119071006775
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.4875009059906
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 13.990206480026245
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 15.891815185546875
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.386280059814453
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.891955852508545
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 12 cost time: 15.127429723739624
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.508430004119873
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.253 Vali Acc: 0.936 Test Loss: 0.253 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.057183027267456
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.896666288375854
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.234102249145508
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.887433052062988
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.511691331863403
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.236 Vali Acc: 0.940 Test Loss: 0.236 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.864553213119507
Epoch: 19, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.190 Vali Acc: 0.947 Test Loss: 0.190 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 14.068466901779175
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.697004318237305
Epoch: 21, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.268 Vali Acc: 0.947 Test Loss: 0.268 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 2461044
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.090830564498901
Epoch: 1, Steps: 89 | Train Loss: 1.712 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (inf --> -0.850273).  Saving model ...
Epoch: 2 cost time: 10.462335109710693
Epoch: 2, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.850273 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 10.637227058410645
Epoch: 3, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.211 Vali Acc: 0.931 Test Loss: 0.211 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.691439628601074
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.943591 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 11.213813304901123
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.179 Vali Acc: 0.931 Test Loss: 0.179 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.525760889053345
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
Validation loss decreased (-0.944288 --> -0.971448).  Saving model ...
Epoch: 7 cost time: 6.276152610778809
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.606091499328613
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.150087356567383
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.089656591415405
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.940601110458374
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.504046440124512
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.971448 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 9.581347465515137
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.530137777328491
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.498528003692627
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.972524642944336
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.851367473602295
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.877300500869751
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.365398168563843
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.848977088928223
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.355751276016235
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.43339729309082
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 805876
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.516654014587402
Epoch: 1, Steps: 89 | Train Loss: 1.730 Vali Loss: 0.532 Vali Acc: 0.870 Test Loss: 0.532 Test Acc: 0.870
Validation loss decreased (inf --> -0.869772).  Saving model ...
Epoch: 2 cost time: 26.278627395629883
Epoch: 2, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.225 Vali Acc: 0.935 Test Loss: 0.225 Test Acc: 0.935
Validation loss decreased (-0.869772 --> -0.935235).  Saving model ...
Epoch: 3 cost time: 24.632571935653687
Epoch: 3, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.935235 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 26.44817614555359
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.948466 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 23.783485412597656
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 23.39228320121765
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.80618667602539
Epoch: 7, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.465469360351562
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.932 Test Loss: 0.245 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.192729473114014
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.937889337539673
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 23.578134536743164
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 21.793023824691772
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 25.584203004837036
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 24.653401613235474
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.023449659347534
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.968662 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 24.071040868759155
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.552567958831787
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.372037172317505
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.42873764038086
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 23.03278613090515
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.790475130081177
Epoch: 21, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 21.459482431411743
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 21.24248480796814
Epoch: 23, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 22.536790370941162
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 21.469929695129395
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1289204
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.022047996520996
Epoch: 1, Steps: 89 | Train Loss: 1.746 Vali Loss: 0.587 Vali Acc: 0.842 Test Loss: 0.587 Test Acc: 0.842
Validation loss decreased (inf --> -0.841916).  Saving model ...
Epoch: 2 cost time: 15.898620128631592
Epoch: 2, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
Validation loss decreased (-0.841916 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 14.640780687332153
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.945680 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 16.361489295959473
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.148 Vali Acc: 0.950 Test Loss: 0.148 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.282607555389404
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 17.63182759284973
Epoch: 6, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.958359479904175
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.962394 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 16.299800634384155
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.916417121887207
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.25894808769226
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.324 Vali Acc: 0.930 Test Loss: 0.324 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.30972695350647
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.811004877090454
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 18.450777769088745
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 17.963349103927612
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.94857621192932
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.8632755279541
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 15.79223918914795
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 461556
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.600964546203613
Epoch: 1, Steps: 89 | Train Loss: 1.746 Vali Loss: 0.561 Vali Acc: 0.854 Test Loss: 0.561 Test Acc: 0.854
Validation loss decreased (inf --> -0.854451).  Saving model ...
Epoch: 2 cost time: 21.758151531219482
Epoch: 2, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
Validation loss decreased (-0.854451 --> -0.942895).  Saving model ...
Epoch: 3 cost time: 20.785499811172485
Epoch: 3, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.032045364379883
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.144 Vali Acc: 0.952 Test Loss: 0.144 Test Acc: 0.952
Validation loss decreased (-0.942895 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 20.30601406097412
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
Validation loss decreased (-0.951948 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 22.029274463653564
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 22.369526624679565
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.04891085624695
Epoch: 8, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.063014268875122
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 21.149482011795044
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.05386734008789
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.16860342025757
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 20.00897526741028
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.975626 --> -0.983286).  Saving model ...
Epoch: 14 cost time: 20.17595076560974
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.348204374313354
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.380659818649292
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.230509996414185
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 18.949407815933228
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 18.747816562652588
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.947 Test Loss: 0.243 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 18.4384708404541
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.936 Test Loss: 0.233 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 18.1585111618042
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 16.47138524055481
Epoch: 22, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 18.459659814834595
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1289204
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.850211381912231
Epoch: 1, Steps: 89 | Train Loss: 1.762 Vali Loss: 0.608 Vali Acc: 0.831 Test Loss: 0.608 Test Acc: 0.831
Validation loss decreased (inf --> -0.830774).  Saving model ...
Epoch: 2 cost time: 11.523819208145142
Epoch: 2, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.830774 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 12.385232210159302
Epoch: 3, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.943591 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 11.123217821121216
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.698182106018066
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 12.816570281982422
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 12.558396339416504
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.02938175201416
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971448).  Saving model ...
Epoch: 9 cost time: 11.62271523475647
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.971448 --> -0.977019).  Saving model ...
Epoch: 10 cost time: 12.337997674942017
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.432003736495972
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.381429433822632
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.41291618347168
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 12.453303098678589
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.516967058181763
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.691995620727539
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.507220268249512
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.919743299484253
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.725211381912231
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 461556
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.638867616653442
Epoch: 1, Steps: 89 | Train Loss: 1.789 Vali Loss: 0.593 Vali Acc: 0.870 Test Loss: 0.593 Test Acc: 0.870
Validation loss decreased (inf --> -0.870468).  Saving model ...
Epoch: 2 cost time: 12.56555461883545
Epoch: 2, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.870468 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 12.309371948242188
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.946377 --> -0.949163).  Saving model ...
Epoch: 4 cost time: 12.574574947357178
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.949163 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 12.237377643585205
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.870086193084717
Epoch: 6, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.901012897491455
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.51363730430603
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.767481565475464
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.210212230682373
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.012383699417114
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.16439175605774
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.253516435623169
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 13.197320938110352
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.385246515274048
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.494438648223877
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.816149950027466
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.041842699050903
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.190713882446289
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.396791219711304
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 13.872108936309814
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 13.6448974609375
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 13.456441164016724
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1289204
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.402676820755005
Epoch: 1, Steps: 89 | Train Loss: 1.809 Vali Loss: 0.686 Vali Acc: 0.804 Test Loss: 0.686 Test Acc: 0.804
Validation loss decreased (inf --> -0.804311).  Saving model ...
Epoch: 2 cost time: 9.624247312545776
Epoch: 2, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.804311 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 9.852182388305664
Epoch: 3, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.943591 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 10.281805038452148
Epoch: 4, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (-0.963787 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 8.682097434997559
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.129 Vali Acc: 0.958 Test Loss: 0.129 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.92369294166565
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 9.003632307052612
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.964 Test Loss: 0.117 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.443886756896973
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 9.851868867874146
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.970751 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 9.532600402832031
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.458338022232056
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.472437143325806
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.687799215316772
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.969577312469482
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.817983150482178
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.615353345870972
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.683707237243652
Epoch: 17, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.682437896728516
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.196554183959961
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.955 Test Loss: 0.206 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 461556
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 31.205179929733276
Epoch: 1, Steps: 89 | Train Loss: 2.160 Vali Loss: 0.922 Vali Acc: 0.840 Test Loss: 0.922 Test Acc: 0.840
Validation loss decreased (inf --> -0.839824).  Saving model ...
Epoch: 2 cost time: 29.81191611289978
Epoch: 2, Steps: 89 | Train Loss: 0.498 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
Validation loss decreased (-0.839824 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 27.929262161254883
Epoch: 3, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.202 Vali Acc: 0.945 Test Loss: 0.202 Test Acc: 0.945
Validation loss decreased (-0.935234 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 28.141876697540283
Epoch: 4, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
Validation loss decreased (-0.944984 --> -0.952645).  Saving model ...
Epoch: 5 cost time: 27.79631543159485
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.952645 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 29.131222009658813
Epoch: 6, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.956823 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 31.274717330932617
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.62135100364685
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 33.92419242858887
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 34.372788190841675
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 33.697322368621826
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 33.99096345901489
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 30.712324380874634
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 32.003737926483154
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 31.73877215385437
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 31.145180702209473
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 30.25530219078064
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 32.1968138217926
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 31.81315541267395
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 28.57608437538147
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 29.397642374038696
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 29.00826668739319
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1230916
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.07585883140564
Epoch: 1, Steps: 89 | Train Loss: 2.145 Vali Loss: 0.978 Vali Acc: 0.804 Test Loss: 0.978 Test Acc: 0.804
Validation loss decreased (inf --> -0.804308).  Saving model ...
Epoch: 2 cost time: 16.83729314804077
Epoch: 2, Steps: 89 | Train Loss: 0.515 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.804308 --> -0.922003).  Saving model ...
Epoch: 3 cost time: 17.114123344421387
Epoch: 3, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.922003 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 17.43554139137268
Epoch: 4, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
Validation loss decreased (-0.951948 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 17.375033378601074
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.951948 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 16.51943564414978
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.958912 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 17.53614115715027
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.967965 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 17.63288903236389
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.655662298202515
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 17.745166540145874
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 17.5189311504364
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 12 cost time: 17.52078866958618
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.490808725357056
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.600483894348145
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 17.39521312713623
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.06644630432129
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.959936618804932
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.649372339248657
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 17.269023418426514
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 17.710426568984985
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 17.431482791900635
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 403204
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.34017539024353
Epoch: 1, Steps: 89 | Train Loss: 2.172 Vali Loss: 0.954 Vali Acc: 0.842 Test Loss: 0.954 Test Acc: 0.842
Validation loss decreased (inf --> -0.841912).  Saving model ...
Epoch: 2 cost time: 24.520476579666138
Epoch: 2, Steps: 89 | Train Loss: 0.511 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.841912 --> -0.924788).  Saving model ...
Epoch: 3 cost time: 23.675437211990356
Epoch: 3, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.217 Vali Acc: 0.940 Test Loss: 0.217 Test Acc: 0.940
Validation loss decreased (-0.924788 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 22.99168086051941
Epoch: 4, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.940109 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 21.91525888442993
Epoch: 5, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.154 Vali Acc: 0.952 Test Loss: 0.154 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.023318767547607
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.899757385253906
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.410127878189087
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.955430 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 22.347743034362793
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 22.054272890090942
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.252027988433838
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 23.98643398284912
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.132021188735962
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.958 Test Loss: 0.127 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 24.059957027435303
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.358 Vali Acc: 0.915 Test Loss: 0.358 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 23.774997234344482
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 23.230735063552856
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.945 Test Loss: 0.162 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 22.96304225921631
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 21.191885709762573
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 20.99687647819519
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.953 Test Loss: 0.158 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 1230916
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.277422666549683
Epoch: 1, Steps: 89 | Train Loss: 2.133 Vali Loss: 0.993 Vali Acc: 0.796 Test Loss: 0.993 Test Acc: 0.796
Validation loss decreased (inf --> -0.795951).  Saving model ...
Epoch: 2 cost time: 12.872455358505249
Epoch: 2, Steps: 89 | Train Loss: 0.516 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
Validation loss decreased (-0.795951 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 14.011008501052856
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.926181 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 13.94664740562439
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.951948 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 14.034311771392822
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.956126 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 14.208643674850464
Epoch: 6, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 13.987895965576172
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.966572 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 13.831395387649536
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.514155626296997
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 13.937993288040161
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 11 cost time: 12.802342653274536
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 14.843915700912476
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 14.831739902496338
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 14.997351169586182
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.740950107574463
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.637155532836914
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.596142292022705
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.839993238449097
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.838744878768921
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 19.646069288253784
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.97950792312622
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 403204
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 20.72349524497986
Epoch: 1, Steps: 89 | Train Loss: 2.247 Vali Loss: 1.068 Vali Acc: 0.818 Test Loss: 1.068 Test Acc: 0.818
Validation loss decreased (inf --> -0.818234).  Saving model ...
Epoch: 2 cost time: 18.227374792099
Epoch: 2, Steps: 89 | Train Loss: 0.565 Vali Loss: 0.383 Vali Acc: 0.896 Test Loss: 0.383 Test Acc: 0.896
Validation loss decreased (-0.818234 --> -0.896236).  Saving model ...
Epoch: 3 cost time: 18.288193702697754
Epoch: 3, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
Validation loss decreased (-0.896236 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 18.121241807937622
Epoch: 4, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.177 Vali Acc: 0.947 Test Loss: 0.177 Test Acc: 0.947
Validation loss decreased (-0.942895 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 18.09065294265747
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.947073 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 17.661818742752075
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 16.792588710784912
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 17.108826160430908
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.963 Test Loss: 0.108 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.823065042495728
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.968662 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 17.611658096313477
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.488912343978882
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.08156967163086
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.50528836250305
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 16.464959859848022
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.955 Test Loss: 0.138 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 16.558907985687256
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 14.84915804862976
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 17.328185319900513
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 17.352723121643066
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 17.40376925468445
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1230916
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.553375720977783
Epoch: 1, Steps: 89 | Train Loss: 2.211 Vali Loss: 1.114 Vali Acc: 0.787 Test Loss: 1.114 Test Acc: 0.787
Validation loss decreased (inf --> -0.786897).  Saving model ...
Epoch: 2 cost time: 12.551789283752441
Epoch: 2, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.338 Vali Acc: 0.914 Test Loss: 0.338 Test Acc: 0.914
Validation loss decreased (-0.786897 --> -0.913646).  Saving model ...
Epoch: 3 cost time: 11.983592510223389
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.913646 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 12.353127002716064
Epoch: 4, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.347065210342407
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.949162 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 12.131951808929443
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.205725193023682
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 12.318536281585693
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.089964628219604
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.502005100250244
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.892066717147827
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.966 Test Loss: 0.100 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.993090391159058
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 11.008668184280396
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.718398571014404
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 15 cost time: 10.79950475692749
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.527621746063232
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.609094858169556
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.958 Test Loss: 0.127 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.34412431716919
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 13.692728519439697
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 13.742938995361328
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 13.531480312347412
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 13.58673620223999
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 13.147802829742432
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 13.641567468643188
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 403204
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.42116618156433
Epoch: 1, Steps: 89 | Train Loss: 2.177 Vali Loss: 0.970 Vali Acc: 0.843 Test Loss: 0.970 Test Acc: 0.843
Validation loss decreased (inf --> -0.843305).  Saving model ...
Epoch: 2 cost time: 26.74959635734558
Epoch: 2, Steps: 89 | Train Loss: 0.531 Vali Loss: 0.313 Vali Acc: 0.918 Test Loss: 0.313 Test Acc: 0.918
Validation loss decreased (-0.843305 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 25.23129677772522
Epoch: 3, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
Validation loss decreased (-0.917824 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 25.28212833404541
Epoch: 4, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 25.002626419067383
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.932538270950317
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.886687755584717
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.367050647735596
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 24.45654821395874
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.219040155410767
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.974233 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 24.485249280929565
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.16443181037903
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.644688844680786
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.198390245437622
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 24.135656595230103
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.961 Test Loss: 0.118 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 23.818094491958618
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 24.038243770599365
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 23.355111598968506
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 24.088014364242554
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 23.492440223693848
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 644804
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.462485313415527
Epoch: 1, Steps: 89 | Train Loss: 2.200 Vali Loss: 1.060 Vali Acc: 0.783 Test Loss: 1.060 Test Acc: 0.783
Validation loss decreased (inf --> -0.782719).  Saving model ...
Epoch: 2 cost time: 15.866885900497437
Epoch: 2, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.782719 --> -0.925485).  Saving model ...
Epoch: 3 cost time: 16.098763942718506
Epoch: 3, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.925485 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 16.042585849761963
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.956823 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 15.691380739212036
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.962394 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 16.929094314575195
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.896610498428345
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.115 Vali Acc: 0.960 Test Loss: 0.115 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.938985109329224
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 18.096200466156006
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 18.090930461883545
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.000786304473877
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 18.020976543426514
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 18.16319966316223
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 14 cost time: 18.105263233184814
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 16.720014333724976
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 16.56929087638855
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.512332916259766
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.425238370895386
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.688921451568604
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.393481016159058
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 15.134368419647217
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 14.622205972671509
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 15.814323425292969
Epoch: 23, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.13953137397766
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.7233943939209
Epoch: 25, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 230916
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.051637887954712
Epoch: 1, Steps: 89 | Train Loss: 2.179 Vali Loss: 0.996 Vali Acc: 0.843 Test Loss: 0.996 Test Acc: 0.843
Validation loss decreased (inf --> -0.843305).  Saving model ...
Epoch: 2 cost time: 20.13600754737854
Epoch: 2, Steps: 89 | Train Loss: 0.540 Vali Loss: 0.324 Vali Acc: 0.932 Test Loss: 0.324 Test Acc: 0.932
Validation loss decreased (-0.843305 --> -0.932448).  Saving model ...
Epoch: 3 cost time: 19.267026901245117
Epoch: 3, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
Validation loss decreased (-0.932448 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 19.5015869140625
Epoch: 4, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 19.558566093444824
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 19.56622624397278
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.64207673072815
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.4636652469635
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.892909288406372
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.4421169757843
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 18.067565202713013
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.98448657989502
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 17.8939311504364
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.86205768585205
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 18.19278621673584
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 644804
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.278452396392822
Epoch: 1, Steps: 89 | Train Loss: 2.194 Vali Loss: 1.062 Vali Acc: 0.781 Test Loss: 1.062 Test Acc: 0.781
Validation loss decreased (inf --> -0.780630).  Saving model ...
Epoch: 2 cost time: 13.511585235595703
Epoch: 2, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.324 Vali Acc: 0.923 Test Loss: 0.324 Test Acc: 0.923
Validation loss decreased (-0.780630 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 13.434773445129395
Epoch: 3, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.923395 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 14.368232727050781
Epoch: 4, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.197 Vali Acc: 0.938 Test Loss: 0.197 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.001466989517212
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.167 Vali Acc: 0.945 Test Loss: 0.167 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.810612916946411
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.951948 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 14.700920343399048
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.142 Vali Acc: 0.952 Test Loss: 0.142 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.962579727172852
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.963091 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 15.272585391998291
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 15.207908153533936
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 15.501577854156494
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.220914363861084
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 14.56039023399353
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 14.631741046905518
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.19130802154541
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 14.112673282623291
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.178020715713501
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.91361117362976
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 14.792845249176025
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 14.113978385925293
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 14.159846067428589
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 14.35255765914917
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 13.963135480880737
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 13.915184497833252
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 13.961790800094604
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.298 Vali Acc: 0.932 Test Loss: 0.298 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 230916
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.948962450027466
Epoch: 1, Steps: 89 | Train Loss: 2.203 Vali Loss: 1.078 Vali Acc: 0.817 Test Loss: 1.078 Test Acc: 0.817
Validation loss decreased (inf --> -0.816842).  Saving model ...
Epoch: 2 cost time: 11.476553440093994
Epoch: 2, Steps: 89 | Train Loss: 0.564 Vali Loss: 0.368 Vali Acc: 0.912 Test Loss: 0.368 Test Acc: 0.912
Validation loss decreased (-0.816842 --> -0.911556).  Saving model ...
Epoch: 3 cost time: 11.791428089141846
Epoch: 3, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
Validation loss decreased (-0.911556 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 11.571465015411377
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.962394 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 11.613744497299194
Epoch: 5, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.573041439056396
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.85847806930542
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.915151357650757
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.967965 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 11.161800146102905
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.173508882522583
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.554235219955444
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.68730092048645
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.958 Test Loss: 0.131 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.650654792785645
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.73845624923706
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.10967469215393
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.364817142486572
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.083170890808105
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.167 Vali Acc: 0.939 Test Loss: 0.167 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.110168218612671
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 644804
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.754102230072021
Epoch: 1, Steps: 89 | Train Loss: 2.189 Vali Loss: 1.101 Vali Acc: 0.776 Test Loss: 1.101 Test Acc: 0.776
Validation loss decreased (inf --> -0.776451).  Saving model ...
Epoch: 2 cost time: 10.170660257339478
Epoch: 2, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.354 Vali Acc: 0.914 Test Loss: 0.354 Test Acc: 0.914
Validation loss decreased (-0.776451 --> -0.913645).  Saving model ...
Epoch: 3 cost time: 10.115886688232422
Epoch: 3, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.234 Vali Acc: 0.940 Test Loss: 0.234 Test Acc: 0.940
Validation loss decreased (-0.913645 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 9.608631134033203
Epoch: 4, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (-0.940109 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 9.690332412719727
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.83281946182251
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.952644 --> -0.970055).  Saving model ...
Epoch: 7 cost time: 10.016336441040039
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.111894845962524
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.006176948547363
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.520120859146118
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 9.688031673431396
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.678386926651001
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.683824300765991
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.110481262207031
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.949682474136353
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.230894804000854
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.066806316375732
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.1326904296875
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.02341365814209
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.507238864898682
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 230916
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.03280544281006
Epoch: 1, Steps: 89 | Train Loss: 2.213 Vali Loss: 1.046 Vali Acc: 0.829 Test Loss: 1.046 Test Acc: 0.829
Validation loss decreased (inf --> -0.829377).  Saving model ...
Epoch: 2 cost time: 22.197700023651123
Epoch: 2, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.323 Vali Acc: 0.918 Test Loss: 0.323 Test Acc: 0.918
Validation loss decreased (-0.829377 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 22.45197367668152
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.213 Vali Acc: 0.945 Test Loss: 0.213 Test Acc: 0.945
Validation loss decreased (-0.917824 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 22.19416856765747
Epoch: 4, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.944984 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 22.987257719039917
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.125768661499023
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 23.135005474090576
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.51218056678772
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.43767023086548
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.169 Vali Acc: 0.942 Test Loss: 0.169 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.367066621780396
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.849018573760986
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 20.959718942642212
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 21.002901077270508
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.953 Test Loss: 0.141 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.78091287612915
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.550883531570435
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.42489242553711
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.18476390838623
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.23352861404419
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 23.070634126663208
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 22.78549027442932
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 22.889078855514526
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.284 Vali Acc: 0.940 Test Loss: 0.284 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 22.846118688583374
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 351748
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.057936429977417
Epoch: 1, Steps: 89 | Train Loss: 2.198 Vali Loss: 1.123 Vali Acc: 0.797 Test Loss: 1.123 Test Acc: 0.797
Validation loss decreased (inf --> -0.796646).  Saving model ...
Epoch: 2 cost time: 15.411967277526855
Epoch: 2, Steps: 89 | Train Loss: 0.625 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
Validation loss decreased (-0.796646 --> -0.919913).  Saving model ...
Epoch: 3 cost time: 14.322422981262207
Epoch: 3, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
Validation loss decreased (-0.919913 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 14.491366386413574
Epoch: 4, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (-0.950555 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 14.483041286468506
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 14.48987889289856
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.959609 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 14.37514066696167
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
Validation loss decreased (-0.965876 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 15.41225814819336
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.395861864089966
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 14.528802633285522
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.130510568618774
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.235691785812378
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.404414176940918
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 14.881724834442139
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 15.020577907562256
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.046560049057007
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.046085834503174
Epoch: 17, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.925748109817505
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.198667287826538
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.040301084518433
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.042285680770874
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.242780923843384
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 14.362982034683228
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980501).  Saving model ...
Epoch: 24 cost time: 14.19471263885498
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 14.121296882629395
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 13.275155067443848
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 14.248388528823853
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 14.213763952255249
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 13.984727621078491
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 14.246129989624023
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 144772
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.18233633041382
Epoch: 1, Steps: 89 | Train Loss: 2.214 Vali Loss: 1.057 Vali Acc: 0.823 Test Loss: 1.057 Test Acc: 0.823
Validation loss decreased (inf --> -0.823109).  Saving model ...
Epoch: 2 cost time: 17.057233810424805
Epoch: 2, Steps: 89 | Train Loss: 0.554 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
Validation loss decreased (-0.823109 --> -0.915038).  Saving model ...
Epoch: 3 cost time: 17.178826093673706
Epoch: 3, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (-0.915038 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 17.160017013549805
Epoch: 4, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.952644 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 17.18876552581787
Epoch: 5, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 17.14799213409424
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 17.03210735321045
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.36609435081482
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.66075372695923
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.939 Test Loss: 0.167 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.904165029525757
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.790282726287842
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.157843112945557
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.358137845993042
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.633089303970337
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.60093402862549
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.199 Vali Acc: 0.935 Test Loss: 0.199 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.67373824119568
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.945 Test Loss: 0.164 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 351748
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.648236751556396
Epoch: 1, Steps: 89 | Train Loss: 2.204 Vali Loss: 1.134 Vali Acc: 0.795 Test Loss: 1.134 Test Acc: 0.795
Validation loss decreased (inf --> -0.795253).  Saving model ...
Epoch: 2 cost time: 12.054229259490967
Epoch: 2, Steps: 89 | Train Loss: 0.642 Vali Loss: 0.347 Vali Acc: 0.914 Test Loss: 0.347 Test Acc: 0.914
Validation loss decreased (-0.795253 --> -0.914342).  Saving model ...
Epoch: 3 cost time: 12.130416631698608
Epoch: 3, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
Validation loss decreased (-0.914342 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 12.254061460494995
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.938020 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 11.83452033996582
Epoch: 5, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.951948 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 11.896329641342163
Epoch: 6, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.83779525756836
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.956823 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 11.57112741470337
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.172245025634766
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 12.189767360687256
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.999876022338867
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.58404016494751
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.955 Test Loss: 0.126 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.80708122253418
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 11.420534372329712
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.818952322006226
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.813761472702026
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.79104995727539
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 12.636813879013062
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 12.596294403076172
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 12.682007789611816
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 12.584368705749512
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.848538398742676
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 12.306491374969482
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 144772
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.569213628768921
Epoch: 1, Steps: 89 | Train Loss: 2.221 Vali Loss: 1.111 Vali Acc: 0.812 Test Loss: 1.111 Test Acc: 0.812
Validation loss decreased (inf --> -0.811967).  Saving model ...
Epoch: 2 cost time: 10.74221420288086
Epoch: 2, Steps: 89 | Train Loss: 0.565 Vali Loss: 0.392 Vali Acc: 0.895 Test Loss: 0.392 Test Acc: 0.895
Validation loss decreased (-0.811967 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 10.362968683242798
Epoch: 3, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.225 Vali Acc: 0.946 Test Loss: 0.225 Test Acc: 0.946
Validation loss decreased (-0.894843 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 10.199479818344116
Epoch: 4, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
Validation loss decreased (-0.946377 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 9.995312929153442
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.953341 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 10.122517347335815
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.392681360244751
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.364782094955444
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.412935018539429
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.171 Vali Acc: 0.942 Test Loss: 0.171 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.846914768218994
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 10.058948516845703
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.994431495666504
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.846359729766846
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.9029541015625
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.758151769638062
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.482730388641357
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.359 Vali Acc: 0.929 Test Loss: 0.359 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.388424634933472
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.265747785568237
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.518213748931885
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.452952861785889
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 351748
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.918851375579834
Epoch: 1, Steps: 89 | Train Loss: 2.233 Vali Loss: 1.196 Vali Acc: 0.799 Test Loss: 1.196 Test Acc: 0.799
Validation loss decreased (inf --> -0.798735).  Saving model ...
Epoch: 2 cost time: 12.136296510696411
Epoch: 2, Steps: 89 | Train Loss: 0.708 Vali Loss: 0.385 Vali Acc: 0.901 Test Loss: 0.385 Test Acc: 0.901
Validation loss decreased (-0.798735 --> -0.901110).  Saving model ...
Epoch: 3 cost time: 12.398608207702637
Epoch: 3, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.901110 --> -0.936627).  Saving model ...
Epoch: 4 cost time: 12.270957469940186
Epoch: 4, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.936627 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 12.54946756362915
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 12.560129642486572
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.959609 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 12.897022724151611
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.963091 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 12.904944896697998
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.213639974594116
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 11.403065919876099
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.960 Test Loss: 0.114 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.197368144989014
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 12 cost time: 12.23933744430542
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.824059009552002
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 14 cost time: 11.147980690002441
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.240360260009766
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.43613314628601
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 17 cost time: 11.73163652420044
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.57643175125122
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.621903657913208
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.408466815948486
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.641366243362427
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.725342035293579
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 23 cost time: 12.572088479995728
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 12.4631986618042
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.117198705673218
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.73173999786377
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.963218688964844
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 13.139191627502441
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 13.271246671676636
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 13.101128816604614
Epoch: 30, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 144772
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 34.702730894088745
Epoch: 1, Steps: 89 | Train Loss: 2.446 Vali Loss: 1.592 Vali Acc: 0.788 Test Loss: 1.592 Test Acc: 0.788
Validation loss decreased (inf --> -0.788285).  Saving model ...
Epoch: 2 cost time: 34.10872411727905
Epoch: 2, Steps: 89 | Train Loss: 0.956 Vali Loss: 0.543 Vali Acc: 0.873 Test Loss: 0.543 Test Acc: 0.873
Validation loss decreased (-0.788285 --> -0.872557).  Saving model ...
Epoch: 3 cost time: 33.48694109916687
Epoch: 3, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.320 Vali Acc: 0.923 Test Loss: 0.320 Test Acc: 0.923
Validation loss decreased (-0.872557 --> -0.923395).  Saving model ...
Epoch: 4 cost time: 28.790451288223267
Epoch: 4, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
Validation loss decreased (-0.923395 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 30.950698375701904
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.240 Vali Acc: 0.934 Test Loss: 0.240 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.194535970687866
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.941502 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 30.501482248306274
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.167 Vali Acc: 0.947 Test Loss: 0.167 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.82823395729065
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 31.35077738761902
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.519213438034058
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.965180 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 31.806610822677612
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.978411).  Saving model ...
Epoch: 12 cost time: 29.737895727157593
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 32.33124232292175
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 33.08694100379944
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 33.230268478393555
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 33.64636254310608
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 31.644888877868652
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981197).  Saving model ...
Epoch: 18 cost time: 31.788363456726074
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 19 cost time: 31.04034185409546
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 31.675793647766113
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 31.918177843093872
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 31.88154935836792
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 31.9287531375885
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 31.795175313949585
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 31.508588790893555
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 31.93919610977173
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.165 Vali Acc: 0.961 Test Loss: 0.165 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 30.559264421463013
Epoch: 27, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 26.80524206161499
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.140 Vali Acc: 0.958 Test Loss: 0.140 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 615852
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.44338345527649
Epoch: 1, Steps: 89 | Train Loss: 2.516 Vali Loss: 1.680 Vali Acc: 0.735 Test Loss: 1.680 Test Acc: 0.735
Validation loss decreased (inf --> -0.734663).  Saving model ...
Epoch: 2 cost time: 20.463655471801758
Epoch: 2, Steps: 89 | Train Loss: 1.046 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
Validation loss decreased (-0.734663 --> -0.900412).  Saving model ...
Epoch: 3 cost time: 20.25538969039917
Epoch: 3, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.313 Vali Acc: 0.932 Test Loss: 0.313 Test Acc: 0.932
Validation loss decreased (-0.900412 --> -0.932448).  Saving model ...
Epoch: 4 cost time: 18.426211833953857
Epoch: 4, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.932448 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 18.749149560928345
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 18.802080869674683
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.959608 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 19.821747064590454
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 20.887236833572388
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.86732029914856
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.767534494400024
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 20.851127862930298
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.302958726882935
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.37290859222412
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.339529752731323
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 19.800745248794556
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 19.868059873580933
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 17 cost time: 21.067427396774292
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 18.021562814712524
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 18.495898246765137
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 18.220362901687622
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.839857578277588
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.43550133705139
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 18.03233551979065
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.877765893936157
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 25 cost time: 20.466604948043823
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 20.7306649684906
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 27 cost time: 20.42278003692627
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 28 cost time: 19.45692777633667
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.987465).  Saving model ...
Epoch: 29 cost time: 19.31998586654663
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 18.082923650741577
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 201868
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.701857805252075
Epoch: 1, Steps: 89 | Train Loss: 2.443 Vali Loss: 1.607 Vali Acc: 0.774 Test Loss: 1.607 Test Acc: 0.774
Validation loss decreased (inf --> -0.774357).  Saving model ...
Epoch: 2 cost time: 23.8034405708313
Epoch: 2, Steps: 89 | Train Loss: 0.960 Vali Loss: 0.569 Vali Acc: 0.870 Test Loss: 0.569 Test Acc: 0.870
Validation loss decreased (-0.774357 --> -0.869771).  Saving model ...
Epoch: 3 cost time: 24.73370623588562
Epoch: 3, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
Validation loss decreased (-0.869771 --> -0.912949).  Saving model ...
Epoch: 4 cost time: 24.429954290390015
Epoch: 4, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.912949 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 21.928163290023804
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.940806 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 22.536813974380493
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 23.595381259918213
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
Validation loss decreased (-0.958216 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 23.295242071151733
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
Validation loss decreased (-0.965876 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 23.383190631866455
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.374063968658447
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.965876 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 21.346203327178955
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 21.027241230010986
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.974770307540894
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.822808265686035
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 21.855870246887207
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 21.851110219955444
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 19.94676184654236
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 18 cost time: 21.614221811294556
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.640608310699463
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 24.50481414794922
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.975961208343506
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 23.69853687286377
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 21.460007667541504
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 20.903711557388306
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 22.774329900741577
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 23.751418590545654
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 24.468355178833008
Epoch: 27, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 615852
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 20.44840097427368
Epoch: 1, Steps: 89 | Train Loss: 2.514 Vali Loss: 1.682 Vali Acc: 0.746 Test Loss: 1.682 Test Acc: 0.746
Validation loss decreased (inf --> -0.745805).  Saving model ...
Epoch: 2 cost time: 14.51494312286377
Epoch: 2, Steps: 89 | Train Loss: 1.045 Vali Loss: 0.571 Vali Acc: 0.893 Test Loss: 0.571 Test Acc: 0.893
Validation loss decreased (-0.745805 --> -0.893448).  Saving model ...
Epoch: 3 cost time: 15.020907878875732
Epoch: 3, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.893448 --> -0.925484).  Saving model ...
Epoch: 4 cost time: 15.893426418304443
Epoch: 4, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.230 Vali Acc: 0.953 Test Loss: 0.230 Test Acc: 0.953
Validation loss decreased (-0.925484 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 15.765006303787231
Epoch: 5, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.952644 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 15.747468948364258
Epoch: 6, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.958912 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 15.946539402008057
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.713454246520996
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.09830927848816
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.318833827972412
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 16.289436101913452
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.718281984329224
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.82833218574524
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.932 Test Loss: 0.208 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.66378664970398
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 15 cost time: 16.010547399520874
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.999576568603516
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.982590).  Saving model ...
Epoch: 17 cost time: 15.40374231338501
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.047353982925415
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 15.350038051605225
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 15.598217964172363
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.870214223861694
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 14.803807258605957
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 14.96984314918518
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 24 cost time: 12.829899072647095
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 15.815504789352417
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 16.66350269317627
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 17.342143774032593
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 17.2498300075531
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 17.747740507125854
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 17.594649076461792
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 201868
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.77927041053772
Epoch: 1, Steps: 89 | Train Loss: 2.439 Vali Loss: 1.655 Vali Acc: 0.774 Test Loss: 1.655 Test Acc: 0.774
Validation loss decreased (inf --> -0.774357).  Saving model ...
Epoch: 2 cost time: 14.608108758926392
Epoch: 2, Steps: 89 | Train Loss: 0.966 Vali Loss: 0.631 Vali Acc: 0.859 Test Loss: 0.631 Test Acc: 0.859
Validation loss decreased (-0.774357 --> -0.859325).  Saving model ...
Epoch: 3 cost time: 15.467172384262085
Epoch: 3, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.388 Vali Acc: 0.912 Test Loss: 0.388 Test Acc: 0.912
Validation loss decreased (-0.859325 --> -0.911556).  Saving model ...
Epoch: 4 cost time: 15.907062292098999
Epoch: 4, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
Validation loss decreased (-0.911556 --> -0.922003).  Saving model ...
Epoch: 5 cost time: 15.444917440414429
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.235 Vali Acc: 0.942 Test Loss: 0.235 Test Acc: 0.942
Validation loss decreased (-0.922003 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 16.129629135131836
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.199 Vali Acc: 0.947 Test Loss: 0.199 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947073).  Saving model ...
Epoch: 7 cost time: 16.164032220840454
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
Validation loss decreased (-0.947073 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 16.26016664505005
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.543632745742798
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (-0.953341 --> -0.961001).  Saving model ...
Epoch: 10 cost time: 14.966058492660522
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.209880590438843
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
Validation loss decreased (-0.961001 --> -0.961001).  Saving model ...
Epoch: 12 cost time: 15.190154314041138
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.574750185012817
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.645412921905518
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.497535228729248
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.955 Test Loss: 0.139 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.24358582496643
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 17 cost time: 13.037578821182251
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.239812135696411
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.956 Test Loss: 0.137 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 14.63895297050476
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.682819843292236
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 14.780003309249878
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 22 cost time: 14.032442092895508
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 13.871164321899414
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.80796480178833
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 12.558973550796509
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 26 cost time: 12.532792806625366
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 13.740153312683105
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.308 Vali Acc: 0.927 Test Loss: 0.308 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 14.309759855270386
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 11.25957179069519
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 15.626709699630737
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 615852
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.993951559066772
Epoch: 1, Steps: 89 | Train Loss: 2.529 Vali Loss: 1.749 Vali Acc: 0.735 Test Loss: 1.749 Test Acc: 0.735
Validation loss decreased (inf --> -0.735359).  Saving model ...
Epoch: 2 cost time: 11.488653659820557
Epoch: 2, Steps: 89 | Train Loss: 1.094 Vali Loss: 0.614 Vali Acc: 0.890 Test Loss: 0.614 Test Acc: 0.890
Validation loss decreased (-0.735359 --> -0.889966).  Saving model ...
Epoch: 3 cost time: 12.28085207939148
Epoch: 3, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.363 Vali Acc: 0.922 Test Loss: 0.363 Test Acc: 0.922
Validation loss decreased (-0.889966 --> -0.922002).  Saving model ...
Epoch: 4 cost time: 12.132989406585693
Epoch: 4, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.253 Vali Acc: 0.951 Test Loss: 0.253 Test Acc: 0.951
Validation loss decreased (-0.922002 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 13.584032535552979
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.951251 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 13.845136165618896
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
Validation loss decreased (-0.955430 --> -0.968661).  Saving model ...
Epoch: 7 cost time: 13.727260828018188
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.454733848571777
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.640207767486572
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.138481855392456
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.968661 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 12.132176876068115
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.379724264144897
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.966876029968262
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.479657649993896
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.51559829711914
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.699843645095825
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 17 cost time: 12.755155086517334
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.694064140319824
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.712325096130371
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 11.723754644393921
Epoch: 20, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 11.164880275726318
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.460481405258179
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 12.332059860229492
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.44472599029541
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.536024570465088
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.571287631988525
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 201868
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.278603553771973
Epoch: 1, Steps: 89 | Train Loss: 2.468 Vali Loss: 1.651 Vali Acc: 0.709 Test Loss: 1.651 Test Acc: 0.709
Validation loss decreased (inf --> -0.708897).  Saving model ...
Epoch: 2 cost time: 20.021167278289795
Epoch: 2, Steps: 89 | Train Loss: 1.014 Vali Loss: 0.557 Vali Acc: 0.877 Test Loss: 0.557 Test Acc: 0.877
Validation loss decreased (-0.708897 --> -0.876735).  Saving model ...
Epoch: 3 cost time: 22.641992330551147
Epoch: 3, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.319 Vali Acc: 0.924 Test Loss: 0.319 Test Acc: 0.924
Validation loss decreased (-0.876735 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 23.306166172027588
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.924092 --> -0.930360).  Saving model ...
Epoch: 5 cost time: 23.58708882331848
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
Validation loss decreased (-0.930360 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 24.386594533920288
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.09736680984497
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 20.919527292251587
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 22.878815412521362
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 10 cost time: 22.821849822998047
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970054).  Saving model ...
Epoch: 11 cost time: 23.001644134521484
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 21.97487711906433
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.934918880462646
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 23.371665954589844
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 24.158642053604126
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 24.145525455474854
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 24.368654012680054
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 18 cost time: 24.305543899536133
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 22.928738355636597
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 24.190603733062744
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 25.111034870147705
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 25.175276517868042
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 26.342376232147217
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 23.52792000770569
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.396 Vali Acc: 0.932 Test Loss: 0.396 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 22.704080820083618
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 26 cost time: 24.158802270889282
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 27 cost time: 23.94233274459839
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 24.217992305755615
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 22.866909980773926
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 23.16720175743103
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 322604
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 18.33977174758911
Epoch: 1, Steps: 89 | Train Loss: 2.510 Vali Loss: 1.705 Vali Acc: 0.747 Test Loss: 1.705 Test Acc: 0.747
Validation loss decreased (inf --> -0.747197).  Saving model ...
Epoch: 2 cost time: 17.60005807876587
Epoch: 2, Steps: 89 | Train Loss: 1.087 Vali Loss: 0.622 Vali Acc: 0.870 Test Loss: 0.622 Test Acc: 0.870
Validation loss decreased (-0.747197 --> -0.869771).  Saving model ...
Epoch: 3 cost time: 17.69587230682373
Epoch: 3, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
Validation loss decreased (-0.869771 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 17.74730944633484
Epoch: 4, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
Validation loss decreased (-0.910860 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 17.543009996414185
Epoch: 5, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
Validation loss decreased (-0.935234 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 17.241129398345947
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.06199026107788
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.952644 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 16.099932432174683
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.620688915252686
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.0378155708313
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.207398653030396
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.979810237884521
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 15.76494288444519
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.60299563407898
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 15.471458673477173
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.86617112159729
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 17.24975895881653
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.159085988998413
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.310861825942993
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 16.96847128868103
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.664957284927368
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 22 cost time: 13.943884372711182
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.024296045303345
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 16.66841983795166
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 25 cost time: 16.640108346939087
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 16.176740884780884
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 17.505630016326904
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 28 cost time: 17.845292329788208
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 17.676965951919556
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 17.92983603477478
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 115596
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.117854595184326
Epoch: 1, Steps: 89 | Train Loss: 2.463 Vali Loss: 1.661 Vali Acc: 0.689 Test Loss: 1.661 Test Acc: 0.689
Validation loss decreased (inf --> -0.688702).  Saving model ...
Epoch: 2 cost time: 20.017940998077393
Epoch: 2, Steps: 89 | Train Loss: 1.031 Vali Loss: 0.587 Vali Acc: 0.866 Test Loss: 0.587 Test Acc: 0.866
Validation loss decreased (-0.688702 --> -0.865593).  Saving model ...
Epoch: 3 cost time: 18.56223440170288
Epoch: 3, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.325 Vali Acc: 0.919 Test Loss: 0.325 Test Acc: 0.919
Validation loss decreased (-0.865593 --> -0.918520).  Saving model ...
Epoch: 4 cost time: 18.54670763015747
Epoch: 4, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
Validation loss decreased (-0.918520 --> -0.938716).  Saving model ...
Epoch: 5 cost time: 17.350242137908936
Epoch: 5, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.938716 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 18.243573665618896
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954734).  Saving model ...
Epoch: 7 cost time: 18.856266736984253
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
Validation loss decreased (-0.954734 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 18.820847511291504
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
Validation loss decreased (-0.965876 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 18.829780340194702
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 18.78526520729065
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.51177144050598
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.97669744491577
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 18.392486572265625
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 18.556053400039673
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 18.313103914260864
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.306697130203247
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 17.867047786712646
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.970055 --> -0.977019).  Saving model ...
Epoch: 18 cost time: 17.34812355041504
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.840970277786255
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 18.12872576713562
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 18.05626082420349
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 18.63389301300049
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 18.765694856643677
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 17.946762084960938
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 19.10304880142212
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 18.447506189346313
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 18.37904453277588
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 322604
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 14.402372360229492
Epoch: 1, Steps: 89 | Train Loss: 2.504 Vali Loss: 1.707 Vali Acc: 0.753 Test Loss: 1.707 Test Acc: 0.753
Validation loss decreased (inf --> -0.752768).  Saving model ...
Epoch: 2 cost time: 11.837984561920166
Epoch: 2, Steps: 89 | Train Loss: 1.072 Vali Loss: 0.642 Vali Acc: 0.864 Test Loss: 0.642 Test Acc: 0.864
Validation loss decreased (-0.752768 --> -0.864200).  Saving model ...
Epoch: 3 cost time: 11.627152442932129
Epoch: 3, Steps: 89 | Train Loss: 0.467 Vali Loss: 0.363 Vali Acc: 0.911 Test Loss: 0.363 Test Acc: 0.911
Validation loss decreased (-0.864200 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 12.822864770889282
Epoch: 4, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.910860 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 13.334211111068726
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.936627 --> -0.947770).  Saving model ...
Epoch: 6 cost time: 13.257765531539917
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
Validation loss decreased (-0.947770 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 12.77502727508545
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 14.361968755722046
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 14.388670206069946
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.337782382965088
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 14.315865993499756
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.272353172302246
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 14.319435358047485
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 14.556271314620972
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.625028610229492
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 13.418665170669556
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 17 cost time: 13.647748231887817
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.362874984741211
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 19 cost time: 13.758679389953613
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 20 cost time: 13.785622119903564
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.664536476135254
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 13.981895923614502
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 14.347445726394653
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 14.352565288543701
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 25 cost time: 14.750615119934082
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 14.869018316268921
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 14.71884298324585
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.958 Test Loss: 0.128 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 14.748759269714355
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 13.84491491317749
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 13.794053554534912
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 115596
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.58087944984436
Epoch: 1, Steps: 89 | Train Loss: 2.436 Vali Loss: 1.692 Vali Acc: 0.691 Test Loss: 1.692 Test Acc: 0.691
Validation loss decreased (inf --> -0.690791).  Saving model ...
Epoch: 2 cost time: 13.642045974731445
Epoch: 2, Steps: 89 | Train Loss: 1.051 Vali Loss: 0.695 Vali Acc: 0.853 Test Loss: 0.695 Test Acc: 0.853
Validation loss decreased (-0.690791 --> -0.853057).  Saving model ...
Epoch: 3 cost time: 12.652674436569214
Epoch: 3, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.417 Vali Acc: 0.912 Test Loss: 0.417 Test Acc: 0.912
Validation loss decreased (-0.853057 --> -0.911556).  Saving model ...
Epoch: 4 cost time: 13.017204284667969
Epoch: 4, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
Validation loss decreased (-0.911556 --> -0.934537).  Saving model ...
Epoch: 5 cost time: 13.005666732788086
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
Validation loss decreased (-0.934537 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 12.897498846054077
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.974900722503662
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.941502 --> -0.949859).  Saving model ...
Epoch: 8 cost time: 12.907185316085815
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
Validation loss decreased (-0.949859 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 12.970473766326904
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.955430 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 13.311500549316406
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.643715381622314
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.559596061706543
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.958912 --> -0.963091).  Saving model ...
Epoch: 13 cost time: 13.376813411712646
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.585890293121338
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.106158971786499
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.696320056915283
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.190524578094482
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.062225580215454
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.18733835220337
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.963091 --> -0.965180).  Saving model ...
Epoch: 20 cost time: 13.075288534164429
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.829320430755615
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 12.72247838973999
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 13.603496789932251
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 13.834866762161255
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 13.604965448379517
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 13.188876152038574
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 13.16407060623169
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 28 cost time: 13.150836944580078
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.947 Test Loss: 0.220 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 12.192553758621216
Epoch: 29, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.279 Vali Acc: 0.940 Test Loss: 0.279 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 12.766282320022583
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 322604
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.464428424835205
Epoch: 1, Steps: 89 | Train Loss: 2.495 Vali Loss: 1.721 Vali Acc: 0.744 Test Loss: 1.721 Test Acc: 0.744
Validation loss decreased (inf --> -0.744412).  Saving model ...
Epoch: 2 cost time: 9.591439723968506
Epoch: 2, Steps: 89 | Train Loss: 1.101 Vali Loss: 0.711 Vali Acc: 0.836 Test Loss: 0.711 Test Acc: 0.836
Validation loss decreased (-0.744412 --> -0.835647).  Saving model ...
Epoch: 3 cost time: 11.382614374160767
Epoch: 3, Steps: 89 | Train Loss: 0.474 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
Validation loss decreased (-0.835647 --> -0.891361).  Saving model ...
Epoch: 4 cost time: 11.410839557647705
Epoch: 4, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.304 Vali Acc: 0.927 Test Loss: 0.304 Test Acc: 0.927
Validation loss decreased (-0.891361 --> -0.926877).  Saving model ...
Epoch: 5 cost time: 11.449481010437012
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.926877 --> -0.929663).  Saving model ...
Epoch: 6 cost time: 11.419190406799316
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.654858827590942
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929663 --> -0.930360).  Saving model ...
Epoch: 8 cost time: 11.503193378448486
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
Validation loss decreased (-0.930360 --> -0.941502).  Saving model ...
Epoch: 9 cost time: 11.747441053390503
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.229 Vali Acc: 0.914 Test Loss: 0.229 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.75411343574524
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.200 Vali Acc: 0.935 Test Loss: 0.200 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.840975999832153
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.045142889022827
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.941502 --> -0.945681).  Saving model ...
Epoch: 13 cost time: 12.034871339797974
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.946 Test Loss: 0.175 Test Acc: 0.946
Validation loss decreased (-0.945681 --> -0.945681).  Saving model ...
Epoch: 14 cost time: 11.58233118057251
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
Validation loss decreased (-0.945681 --> -0.946377).  Saving model ...
Epoch: 15 cost time: 11.123829364776611
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.939 Test Loss: 0.188 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.12495732307434
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.19905972480774
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.818819522857666
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.696340799331665
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
Validation loss decreased (-0.946377 --> -0.954734).  Saving model ...
Epoch: 20 cost time: 11.669813394546509
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.940 Test Loss: 0.189 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 11.745047569274902
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.201452732086182
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.953 Test Loss: 0.154 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 11.447670221328735
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.248 Vali Acc: 0.931 Test Loss: 0.248 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.410438537597656
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.256 Vali Acc: 0.939 Test Loss: 0.256 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.120891809463501
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 11.536139488220215
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.686773300170898
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.437 Vali Acc: 0.902 Test Loss: 0.437 Test Acc: 0.902
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 11.23376178741455
Epoch: 28, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.20519232749939
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.954734 --> -0.962394).  Saving model ...
Epoch: 30 cost time: 10.763804197311401
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 115596
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 19.7029767036438
Epoch: 1, Steps: 89 | Train Loss: 2.567 Vali Loss: 1.794 Vali Acc: 0.647 Test Loss: 1.794 Test Acc: 0.647
Validation loss decreased (inf --> -0.646918).  Saving model ...
Epoch: 2 cost time: 17.40949249267578
Epoch: 2, Steps: 89 | Train Loss: 1.158 Vali Loss: 0.679 Vali Acc: 0.846 Test Loss: 0.679 Test Acc: 0.846
Validation loss decreased (-0.646918 --> -0.846093).  Saving model ...
Epoch: 3 cost time: 19.038572072982788
Epoch: 3, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.370 Vali Acc: 0.913 Test Loss: 0.370 Test Acc: 0.913
Validation loss decreased (-0.846093 --> -0.912949).  Saving model ...
Epoch: 4 cost time: 18.93104338645935
Epoch: 4, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.248 Vali Acc: 0.942 Test Loss: 0.248 Test Acc: 0.942
Validation loss decreased (-0.912949 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 18.946527004241943
Epoch: 5, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
Validation loss decreased (-0.941502 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 20.300700664520264
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (-0.953341 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 20.532779693603516
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.641340255737305
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.967269 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 20.86698865890503
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.970751).  Saving model ...
Epoch: 10 cost time: 20.811403512954712
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 19.348648071289062
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 18.19884991645813
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.782376289367676
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 14 cost time: 18.9504075050354
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.823935508728027
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.950084447860718
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.953736543655396
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 19.78719210624695
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 19 cost time: 20.33396887779236
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 20.083386659622192
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 19.9552161693573
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 17.992498874664307
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 17.796645641326904
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 17.841628551483154
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 19.426886081695557
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 19.22706174850464
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 18.67454433441162
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 18.973232984542847
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 175980
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.48403811454773
Epoch: 1, Steps: 89 | Train Loss: 2.602 Vali Loss: 1.786 Vali Acc: 0.697 Test Loss: 1.786 Test Acc: 0.697
Validation loss decreased (inf --> -0.697057).  Saving model ...
Epoch: 2 cost time: 13.611398458480835
Epoch: 2, Steps: 89 | Train Loss: 1.149 Vali Loss: 0.612 Vali Acc: 0.879 Test Loss: 0.612 Test Acc: 0.879
Validation loss decreased (-0.697057 --> -0.878824).  Saving model ...
Epoch: 3 cost time: 12.49800992012024
Epoch: 3, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.878824 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 13.145400762557983
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.924788 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 13.782902002334595
Epoch: 5, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.940805 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 13.093408584594727
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.026155710220337
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.966572 --> -0.970054).  Saving model ...
Epoch: 8 cost time: 12.922935247421265
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.991777658462524
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970054 --> -0.970055).  Saving model ...
Epoch: 10 cost time: 15.169119834899902
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.206712245941162
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 12 cost time: 15.193156480789185
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.972144 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 18.700515508651733
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.821772575378418
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 18.11237072944641
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.20812678337097
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 17 cost time: 17.51076912879944
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 16.77523159980774
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.198808193206787
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 16.747059106826782
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 15.79622769355774
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.438677310943604
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 17.661274194717407
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 18.128371953964233
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 25 cost time: 18.321178197860718
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 17.90203285217285
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 18.6330623626709
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 17.537217617034912
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 17.786287307739258
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 17.85670304298401
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 72460
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.26540732383728
Epoch: 1, Steps: 89 | Train Loss: 2.566 Vali Loss: 1.797 Vali Acc: 0.655 Test Loss: 1.797 Test Acc: 0.655
Validation loss decreased (inf --> -0.655275).  Saving model ...
Epoch: 2 cost time: 19.703856945037842
Epoch: 2, Steps: 89 | Train Loss: 1.151 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.655275 --> -0.849575).  Saving model ...
Epoch: 3 cost time: 19.32137632369995
Epoch: 3, Steps: 89 | Train Loss: 0.492 Vali Loss: 0.374 Vali Acc: 0.909 Test Loss: 0.374 Test Acc: 0.909
Validation loss decreased (-0.849575 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 18.68320059776306
Epoch: 4, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
Validation loss decreased (-0.908771 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 18.54061532020569
Epoch: 5, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.195 Vali Acc: 0.945 Test Loss: 0.195 Test Acc: 0.945
Validation loss decreased (-0.935234 --> -0.944984).  Saving model ...
Epoch: 6 cost time: 20.523572206497192
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.944984 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 20.13271403312683
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.728925943374634
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.31094527244568
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.962394 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 19.579638719558716
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.757793426513672
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.072284936904907
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.320756673812866
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 19.8661527633667
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 19.338569164276123
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 16 cost time: 17.761030197143555
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 18.108617782592773
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 16.837919235229492
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 18.133429288864136
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 20 cost time: 18.71028470993042
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 18.217809200286865
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 18.290966749191284
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 19.114933252334595
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 19.24757170677185
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 18.968142986297607
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 19.47305202484131
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 27 cost time: 20.035245180130005
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 19.465683698654175
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 18.069448471069336
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 18.45527410507202
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 175980
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.476179838180542
Epoch: 1, Steps: 89 | Train Loss: 2.603 Vali Loss: 1.785 Vali Acc: 0.703 Test Loss: 1.785 Test Acc: 0.703
Validation loss decreased (inf --> -0.702628).  Saving model ...
Epoch: 2 cost time: 15.790500164031982
Epoch: 2, Steps: 89 | Train Loss: 1.146 Vali Loss: 0.619 Vali Acc: 0.882 Test Loss: 0.619 Test Acc: 0.882
Validation loss decreased (-0.702628 --> -0.881609).  Saving model ...
Epoch: 3 cost time: 14.78495192527771
Epoch: 3, Steps: 89 | Train Loss: 0.453 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.881609 --> -0.929662).  Saving model ...
Epoch: 4 cost time: 14.411556959152222
Epoch: 4, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.261 Vali Acc: 0.936 Test Loss: 0.261 Test Acc: 0.936
Validation loss decreased (-0.929662 --> -0.935931).  Saving model ...
Epoch: 5 cost time: 15.3937509059906
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.935931 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 15.631144762039185
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
Validation loss decreased (-0.956126 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 15.806893825531006
Epoch: 7, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 15.47296690940857
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 15.405750274658203
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 14.516194105148315
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.831681728363037
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.308872699737549
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 14.280155897140503
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.793872356414795
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.808396816253662
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 15.094111919403076
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.288636922836304
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 13.977890253067017
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 13.543349981307983
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.975626).  Saving model ...
Epoch: 20 cost time: 13.712244033813477
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 13.687621831893921
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.975626 --> -0.982590).  Saving model ...
Epoch: 22 cost time: 13.294339179992676
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 13.577677726745605
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.596988916397095
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 13.707350492477417
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 13.74798846244812
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 13.17803168296814
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 12.643863439559937
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 13.299039840698242
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 12.659783124923706
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 72460
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 16.17147946357727
Epoch: 1, Steps: 89 | Train Loss: 2.559 Vali Loss: 1.787 Vali Acc: 0.671 Test Loss: 1.787 Test Acc: 0.671
Validation loss decreased (inf --> -0.670595).  Saving model ...
Epoch: 2 cost time: 14.631323099136353
Epoch: 2, Steps: 89 | Train Loss: 1.124 Vali Loss: 0.728 Vali Acc: 0.844 Test Loss: 0.728 Test Acc: 0.844
Validation loss decreased (-0.670595 --> -0.844004).  Saving model ...
Epoch: 3 cost time: 13.971894264221191
Epoch: 3, Steps: 89 | Train Loss: 0.488 Vali Loss: 0.433 Vali Acc: 0.886 Test Loss: 0.433 Test Acc: 0.886
Validation loss decreased (-0.844004 --> -0.885790).  Saving model ...
Epoch: 4 cost time: 13.478829622268677
Epoch: 4, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (-0.885790 --> -0.900414).  Saving model ...
Epoch: 5 cost time: 14.14794373512268
Epoch: 5, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.259 Vali Acc: 0.929 Test Loss: 0.259 Test Acc: 0.929
Validation loss decreased (-0.900414 --> -0.928967).  Saving model ...
Epoch: 6 cost time: 13.167739391326904
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.217 Vali Acc: 0.932 Test Loss: 0.217 Test Acc: 0.932
Validation loss decreased (-0.928967 --> -0.932449).  Saving model ...
Epoch: 7 cost time: 13.118887424468994
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.236 Vali Acc: 0.923 Test Loss: 0.236 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.874289274215698
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.283 Vali Acc: 0.898 Test Loss: 0.283 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.0987389087677
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
Validation loss decreased (-0.932449 --> -0.942895).  Saving model ...
Epoch: 10 cost time: 13.29443621635437
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.942895 --> -0.943592).  Saving model ...
Epoch: 11 cost time: 13.541109323501587
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.943592 --> -0.944288).  Saving model ...
Epoch: 12 cost time: 11.993940591812134
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.191 Vali Acc: 0.931 Test Loss: 0.191 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.631743669509888
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.162 Vali Acc: 0.947 Test Loss: 0.162 Test Acc: 0.947
Validation loss decreased (-0.944288 --> -0.947074).  Saving model ...
Epoch: 14 cost time: 10.17352819442749
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.257907152175903
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
Validation loss decreased (-0.947074 --> -0.953341).  Saving model ...
Epoch: 16 cost time: 12.57650375366211
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
Validation loss decreased (-0.953341 --> -0.961001).  Saving model ...
Epoch: 17 cost time: 12.437834739685059
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.599462509155273
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.564807415008545
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.678619146347046
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.929 Test Loss: 0.232 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.565656185150146
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.180 Vali Acc: 0.947 Test Loss: 0.180 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.311138153076172
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.348342180252075
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 13.223214626312256
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.673829078674316
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.947 Test Loss: 0.183 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 13.917891025543213
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 27 cost time: 13.706578969955444
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 14.259092330932617
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 13.908217191696167
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 13.414302825927734
Epoch: 30, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 175980
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 15.558505058288574
Epoch: 1, Steps: 89 | Train Loss: 2.619 Vali Loss: 1.806 Vali Acc: 0.715 Test Loss: 1.806 Test Acc: 0.715
Validation loss decreased (inf --> -0.715163).  Saving model ...
Epoch: 2 cost time: 13.82119369506836
Epoch: 2, Steps: 89 | Train Loss: 1.174 Vali Loss: 0.662 Vali Acc: 0.866 Test Loss: 0.662 Test Acc: 0.866
Validation loss decreased (-0.715163 --> -0.866289).  Saving model ...
Epoch: 3 cost time: 13.376923561096191
Epoch: 3, Steps: 89 | Train Loss: 0.474 Vali Loss: 0.384 Vali Acc: 0.906 Test Loss: 0.384 Test Acc: 0.906
Validation loss decreased (-0.866289 --> -0.905985).  Saving model ...
Epoch: 4 cost time: 13.083127737045288
Epoch: 4, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.288 Vali Acc: 0.924 Test Loss: 0.288 Test Acc: 0.924
Validation loss decreased (-0.905985 --> -0.924092).  Saving model ...
Epoch: 5 cost time: 13.287952661514282
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.924092 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 13.424834251403809
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 13.356409072875977
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.942895 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 10.463748693466187
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.346003293991089
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
Validation loss decreased (-0.950555 --> -0.950555).  Saving model ...
Epoch: 10 cost time: 13.053784132003784
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 13.190029859542847
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.158863544464111
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.134350299835205
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.046326637268066
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.270547151565552
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.531554698944092
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.945 Test Loss: 0.164 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.529933452606201
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 13.061216115951538
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.186301469802856
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.365030765533447
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_TimesNet_UEA_ftM_sl182_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 72460
model size : 0.44MB
